(self.webpackChunkhasspro=self.webpackChunkhasspro||[]).push([[179],{2011:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{Dh:()=>on,GT:()=>$e,cc:()=>pn,on:()=>It,pX:()=>_,xv:()=>yt});var d=Ae(4650),Ne=Ae(9260);ui=Ae.hmd(ui);const Me=["ngOnDestroy"],_=(vt,Ye,Ft,Jt={})=>new Proxy(vt,{get:(Xt,Ct)=>Ft.runOutsideAngular(()=>{var Pt;if(vt[Ct])return!(null===(Pt=Jt?.spy)||void 0===Pt)&&Pt.get&&Jt.spy.get(Ct,vt[Ct]),vt[Ct];if(Me.indexOf(Ct)>-1)return()=>{};const un=Ye.toPromise().then(tt=>{const pt=tt&&tt[Ct];return"function"==typeof pt?pt.bind(tt):pt&&pt.then?pt.then(zt=>Ft.run(()=>zt)):Ft.run(()=>pt)});return new Proxy(()=>{},{get:(tt,pt)=>un[pt],apply:(tt,pt,zt)=>un.then(Bt=>{var an;const oi=Bt&&Bt(...zt);return!(null===(an=Jt?.spy)||void 0===an)&&an.apply&&Jt.spy.apply(Ct,zt,oi),oi})})})}),$e=(vt,Ye)=>{Ye.forEach(Ft=>{Object.getOwnPropertyNames(Ft.prototype||Ft).forEach(Jt=>{Object.defineProperty(vt.prototype,Jt,Object.getOwnPropertyDescriptor(Ft.prototype||Ft,Jt))})})};class ft{constructor(Ye){return Ye}}const on=new d.OlP("angularfire2.app.options"),yt=new d.OlP("angularfire2.app.name");function It(vt,Ye,Ft){const Xt="object"==typeof Ft&&Ft||{};Xt.name=Xt.name||"string"==typeof Ft&&Ft||"[DEFAULT]";const Pt=Ne.Z.apps.filter(un=>un&&un.name===Xt.name)[0]||Ye.runOutsideAngular(()=>Ne.Z.initializeApp(vt,Xt));try{JSON.stringify(vt)!==JSON.stringify(Pt.options)&&Ve("error",`${Pt.name} Firebase App already initialized with different options${ui.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new ft(Pt)}const Ve=(vt,...Ye)=>{(0,d.X6Q)()&&typeof console<"u"&&console[vt](...Ye)};function pn(vt,Ye,Ft,Jt,Xt){const[,Ct,Pt]=globalThis.\u0275AngularfireInstanceCache.find(un=>un[0]===vt)||[];if(Ct)return function tn(vt,Ye){try{return vt.toString()===Ye.toString()}catch{return vt===Ye}}(Xt,Pt)||(Dn("error",`${Ye} was already initialized on the ${Ft} Firebase App with different settings.${bn?" You may need to reload as Firebase is not HMR aware.":""}`),Dn("warn",{is:Xt,was:Pt})),Ct;{const un=Jt();return globalThis.\u0275AngularfireInstanceCache.push([vt,un,Xt]),un}}const bn=!!ui.hot,Dn=(vt,...Ye)=>{(0,d.X6Q)()&&typeof console<"u"&&console[vt](...Ye)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},3432:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{$:()=>Au,A:()=>je,C:()=>tn,H:()=>hr,I:()=>Ao,K:()=>yi,M:()=>Qr,N:()=>Eu,P:()=>Tf,Q:()=>uf,R:()=>ha,U:()=>jm,V:()=>wp,W:()=>Tl,X:()=>Ka,Y:()=>Su,Z:()=>hf,_:()=>Vc,a:()=>Ol,a0:()=>to,a1:()=>jc,a2:()=>$m,a3:()=>sh,a4:()=>Ii,a5:()=>ah,a6:()=>lh,a7:()=>Ep,a8:()=>wo,a9:()=>qt,aA:()=>at,aB:()=>an,aC:()=>ze,aD:()=>nt,aE:()=>oe,aF:()=>ee,aG:()=>gi,aK:()=>kl,aN:()=>Tu,aa:()=>Tp,ab:()=>Ed,ac:()=>Qa,ad:()=>uh,ae:()=>T_,ah:()=>Ip,ai:()=>Ja,aj:()=>dh,am:()=>ic,an:()=>mf,ap:()=>Td,aq:()=>Al,ar:()=>zt,as:()=>He,at:()=>Oe,au:()=>Jt,av:()=>ma,aw:()=>Xe,ax:()=>it,ay:()=>Xt,az:()=>tt,b:()=>Pl,c:()=>Ym,d:()=>v,e:()=>zp,f:()=>ue,g:()=>De,h:()=>ce,i:()=>gh,j:()=>Ue,k:()=>hc,l:()=>Wm,m:()=>Bp,o:()=>Zu,p:()=>yt,r:()=>Zm,s:()=>Gu,u:()=>Ch,w:()=>_f});var d=Ae(5861),Ne=Ae(2090),Me=Ae(9681),_=Ae(1877),$e=Ae(655),ft=Ae(4859);const yt={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},je={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const tn=function Ke(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},bn=function pn(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Dn=new Ne.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ye=new _.Yd("@firebase/auth");function Ft(j,...P){Ye.logLevel<=_.in.ERROR&&Ye.error(`Auth (${Me.SDK_VERSION}): ${j}`,...P)}function Jt(j,...P){throw un(j,...P)}function Xt(j,...P){return un(j,...P)}function Ct(j,P,R){const q=Object.assign(Object.assign({},bn()),{[P]:R});return new Ne.LL("auth","Firebase",q).create(P,{appName:j.name})}function Pt(j,P,R){if(!(P instanceof R))throw R.name!==P.constructor.name&&Jt(j,"argument-error"),Ct(j,"argument-error",`Type of ${P.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function un(j,...P){if("string"!=typeof j){const R=P[0],q=[...P.slice(1)];return q[0]&&(q[0].appName=j.name),j._errorFactory.create(R,...q)}return Dn.create(j,...P)}function tt(j,P,...R){if(!j)throw un(P,...R)}function pt(j){const P="INTERNAL ASSERTION FAILED: "+j;throw Ft(P),new Error(P)}function zt(j,P){j||pt(P)}const Bt=new Map;function an(j){zt(j instanceof Function,"Expected a class definition");let P=Bt.get(j);return P?(zt(P instanceof j,"Instance stored in cache mismatched with class"),P):(P=new j,Bt.set(j,P),P)}function mt(){var j;return typeof self<"u"&&(null===(j=self.location)||void 0===j?void 0:j.href)||""}function gt(){return"http:"===Dt()||"https:"===Dt()}function Dt(){var j;return typeof self<"u"&&(null===(j=self.location)||void 0===j?void 0:j.protocol)||null}class en{constructor(P,R){this.shortDelay=P,this.longDelay=R,zt(R>P,"Short delay should be less than long delay!"),this.isMobile=(0,Ne.uI)()||(0,Ne.b$)()}get(){return function Ht(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(gt()||(0,Ne.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function wn(j,P){zt(j.emulator,"Emulator should always be set here");const{url:R}=j.emulator;return P?`${R}${P.startsWith("/")?P.slice(1):P}`:R}class Cn{static initialize(P,R,q){this.fetchImpl=P,R&&(this.headersImpl=R),q&&(this.responseImpl=q)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void pt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void pt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void pt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const rr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},qn=new en(3e4,6e4);function zn(j,P){return j.tenantId&&!P.tenantId?Object.assign(Object.assign({},P),{tenantId:j.tenantId}):P}function vn(j,P,R,q){return Qi.apply(this,arguments)}function Qi(){return(Qi=(0,d.Z)(function*(j,P,R,q,le={}){return Pi(j,le,(0,d.Z)(function*(){let _e={},lt={};q&&("GET"===P?lt=q:_e={body:JSON.stringify(q)});const $t=(0,Ne.xO)(Object.assign({key:j.config.apiKey},lt)).slice(1),Tn=yield j._getAdditionalHeaders();return Tn["Content-Type"]="application/json",j.languageCode&&(Tn["X-Firebase-Locale"]=j.languageCode),Cn.fetch()(oo(j,j.config.apiHost,R,$t),Object.assign({method:P,headers:Tn,referrerPolicy:"no-referrer"},_e))}))})).apply(this,arguments)}function Pi(j,P,R){return dr.apply(this,arguments)}function dr(){return(dr=(0,d.Z)(function*(j,P,R){j._canInitEmulator=!1;const q=Object.assign(Object.assign({},rr),P);try{const le=new Ms(j),_e=yield Promise.race([R(),le.promise]);le.clearNetworkTimeout();const lt=yield _e.json();if("needConfirmation"in lt)throw so(j,"account-exists-with-different-credential",lt);if(_e.ok&&!("errorMessage"in lt))return lt;{const $t=_e.ok?lt.errorMessage:lt.error.message,[Tn,ii]=$t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===Tn)throw so(j,"credential-already-in-use",lt);if("EMAIL_EXISTS"===Tn)throw so(j,"email-already-in-use",lt);if("USER_DISABLED"===Tn)throw so(j,"user-disabled",lt);const zi=q[Tn]||Tn.toLowerCase().replace(/[_\s]+/g,"-");if(ii)throw Ct(j,zi,ii);Jt(j,zi)}}catch(le){if(le instanceof Ne.ZR)throw le;Jt(j,"network-request-failed",{message:String(le)})}})).apply(this,arguments)}function Vn(j,P,R,q){return kr.apply(this,arguments)}function kr(){return(kr=(0,d.Z)(function*(j,P,R,q,le={}){const _e=yield vn(j,P,R,q,le);return"mfaPendingCredential"in _e&&Jt(j,"multi-factor-auth-required",{_serverResponse:_e}),_e})).apply(this,arguments)}function oo(j,P,R,q){const le=`${P}${R}?${q}`;return j.config.emulator?wn(j.config,le):`${j.config.apiScheme}://${le}`}class Ms{constructor(P){this.auth=P,this.timer=null,this.promise=new Promise((R,q)=>{this.timer=setTimeout(()=>q(Xt(this.auth,"network-request-failed")),qn.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function so(j,P,R){const q={appName:j.name};R.email&&(q.email=R.email),R.phoneNumber&&(q.phoneNumber=R.phoneNumber);const le=Xt(j,P,q);return le.customData._tokenResponse=R,le}function _s(){return(_s=(0,d.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:delete",P)})).apply(this,arguments)}function jr(){return(jr=(0,d.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:update",P)})).apply(this,arguments)}function zo(){return(zo=(0,d.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:lookup",P)})).apply(this,arguments)}function ls(j){if(j)try{const P=new Date(Number(j));if(!isNaN(P.getTime()))return P.toUTCString()}catch{}}function cs(){return(cs=(0,d.Z)(function*(j,P=!1){const R=(0,Ne.m9)(j),q=yield R.getIdToken(P),le=jn(q);tt(le&&le.exp&&le.auth_time&&le.iat,R.auth,"internal-error");const _e="object"==typeof le.firebase?le.firebase:void 0,lt=_e?.sign_in_provider;return{claims:le,token:q,authTime:ls(pi(le.auth_time)),issuedAtTime:ls(pi(le.iat)),expirationTime:ls(pi(le.exp)),signInProvider:lt||null,signInSecondFactor:_e?.sign_in_second_factor||null}})).apply(this,arguments)}function pi(j){return 1e3*Number(j)}function jn(j){const[P,R,q]=j.split(".");if(void 0===P||void 0===R||void 0===q)return Ft("JWT malformed, contained fewer than 3 sections"),null;try{const le=(0,Ne.tV)(R);return le?JSON.parse(le):(Ft("Failed to decode base64 JWT payload"),null)}catch(le){return Ft("Caught error parsing JWT payload as JSON",le?.toString()),null}}function Nr(j,P){return Sr.apply(this,arguments)}function Sr(){return(Sr=(0,d.Z)(function*(j,P,R=!1){if(R)return P;try{return yield P}catch(q){throw q instanceof Ne.ZR&&function Xr({code:j}){return"auth/user-disabled"===j||"auth/user-token-expired"===j}(q)&&j.auth.currentUser===j&&(yield j.auth.signOut()),q}})).apply(this,arguments)}class Do{constructor(P){this.user=P,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(P){var R;if(P){const q=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),q}{this.errorBackoff=3e4;const le=(null!==(R=this.user.stsTokenManager.expirationTime)&&void 0!==R?R:0)-Date.now()-3e5;return Math.max(0,le)}}schedule(P=!1){var R=this;if(!this.isRunning)return;const q=this.getInterval(P);this.timerId=setTimeout((0,d.Z)(function*(){yield R.iteration()}),q)}iteration(){var P=this;return(0,d.Z)(function*(){try{yield P.user.getIdToken(!0)}catch(R){return void("auth/network-request-failed"===R?.code&&P.schedule(!0))}P.schedule()})()}}class ao{constructor(P,R){this.createdAt=P,this.lastLoginAt=R,this._initializeTime()}_initializeTime(){this.lastSignInTime=ls(this.lastLoginAt),this.creationTime=ls(this.createdAt)}_copy(P){this.createdAt=P.createdAt,this.lastLoginAt=P.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function ys(j){return wi.apply(this,arguments)}function wi(){return wi=(0,d.Z)(function*(j){var P;const R=j.auth,q=yield j.getIdToken(),le=yield Nr(j,function In(j,P){return zo.apply(this,arguments)}(R,{idToken:q}));tt(le?.users.length,R,"internal-error");const _e=le.users[0];j._notifyReloadListener(_e);const lt=null!==(P=_e.providerUserInfo)&&void 0!==P&&P.length?function Hr(j){return j.map(P=>{var{providerId:R}=P,q=(0,$e._T)(P,["providerId"]);return{providerId:R,uid:q.rawId||"",displayName:q.displayName||null,email:q.email||null,phoneNumber:q.phoneNumber||null,photoURL:q.photoUrl||null}})}(_e.providerUserInfo):[],$t=function lo(j,P){return[...j.filter(q=>!P.some(le=>le.providerId===q.providerId)),...P]}(j.providerData,lt),zi=!!j.isAnonymous&&!(j.email&&_e.passwordHash||$t?.length),po={uid:_e.localId,displayName:_e.displayName||null,photoURL:_e.photoUrl||null,email:_e.email||null,emailVerified:_e.emailVerified||!1,phoneNumber:_e.phoneNumber||null,tenantId:_e.tenantId||null,providerData:$t,metadata:new ao(_e.createdAt,_e.lastLoginAt),isAnonymous:zi};Object.assign(j,po)}),wi.apply(this,arguments)}function Ei(){return(Ei=(0,d.Z)(function*(j){const P=(0,Ne.m9)(j);yield ys(P),yield P.auth._persistUserIfCurrent(P),P.auth._notifyListenersIfCurrent(P)})).apply(this,arguments)}function Vt(){return(Vt=(0,d.Z)(function*(j,P){const R=yield Pi(j,{},(0,d.Z)(function*(){const q=(0,Ne.xO)({grant_type:"refresh_token",refresh_token:P}).slice(1),{tokenApiHost:le,apiKey:_e}=j.config,lt=oo(j,le,"/v1/token",`key=${_e}`),$t=yield j._getAdditionalHeaders();return $t["Content-Type"]="application/x-www-form-urlencoded",Cn.fetch()(lt,{method:"POST",headers:$t,body:q})}));return{accessToken:R.access_token,expiresIn:R.expires_in,refreshToken:R.refresh_token}})).apply(this,arguments)}class Sn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(P){tt(P.idToken,"internal-error"),tt(typeof P.idToken<"u","internal-error"),tt(typeof P.refreshToken<"u","internal-error");const R="expiresIn"in P&&typeof P.expiresIn<"u"?Number(P.expiresIn):function Kn(j){const P=jn(j);return tt(P,"internal-error"),tt(typeof P.exp<"u","internal-error"),tt(typeof P.iat<"u","internal-error"),Number(P.exp)-Number(P.iat)}(P.idToken);this.updateTokensAndExpiration(P.idToken,P.refreshToken,R)}getToken(P,R=!1){var q=this;return(0,d.Z)(function*(){return tt(!q.accessToken||q.refreshToken,P,"user-token-expired"),R||!q.accessToken||q.isExpired?q.refreshToken?(yield q.refresh(P,q.refreshToken),q.accessToken):null:q.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(P,R){var q=this;return(0,d.Z)(function*(){const{accessToken:le,refreshToken:_e,expiresIn:lt}=yield function cn(j,P){return Vt.apply(this,arguments)}(P,R);q.updateTokensAndExpiration(le,_e,Number(lt))})()}updateTokensAndExpiration(P,R,q){this.refreshToken=R||null,this.accessToken=P||null,this.expirationTime=Date.now()+1e3*q}static fromJSON(P,R){const{refreshToken:q,accessToken:le,expirationTime:_e}=R,lt=new Sn;return q&&(tt("string"==typeof q,"internal-error",{appName:P}),lt.refreshToken=q),le&&(tt("string"==typeof le,"internal-error",{appName:P}),lt.accessToken=le),_e&&(tt("number"==typeof _e,"internal-error",{appName:P}),lt.expirationTime=_e),lt}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(P){this.accessToken=P.accessToken,this.refreshToken=P.refreshToken,this.expirationTime=P.expirationTime}_clone(){return Object.assign(new Sn,this.toJSON())}_performRefresh(){return pt("not implemented")}}function Zn(j,P){tt("string"==typeof j||typeof j>"u","internal-error",{appName:P})}class ei{constructor(P){var{uid:R,auth:q,stsTokenManager:le}=P,_e=(0,$e._T)(P,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Do(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=R,this.auth=q,this.stsTokenManager=le,this.accessToken=le.accessToken,this.displayName=_e.displayName||null,this.email=_e.email||null,this.emailVerified=_e.emailVerified||!1,this.phoneNumber=_e.phoneNumber||null,this.photoURL=_e.photoURL||null,this.isAnonymous=_e.isAnonymous||!1,this.tenantId=_e.tenantId||null,this.providerData=_e.providerData?[..._e.providerData]:[],this.metadata=new ao(_e.createdAt||void 0,_e.lastLoginAt||void 0)}getIdToken(P){var R=this;return(0,d.Z)(function*(){const q=yield Nr(R,R.stsTokenManager.getToken(R.auth,P));return tt(q,R.auth,"internal-error"),R.accessToken!==q&&(R.accessToken=q,yield R.auth._persistUserIfCurrent(R),R.auth._notifyListenersIfCurrent(R)),q})()}getIdTokenResult(P){return function $r(j){return cs.apply(this,arguments)}(this,P)}reload(){return function Vs(j){return Ei.apply(this,arguments)}(this)}_assign(P){this!==P&&(tt(this.uid===P.uid,this.auth,"internal-error"),this.displayName=P.displayName,this.photoURL=P.photoURL,this.email=P.email,this.emailVerified=P.emailVerified,this.phoneNumber=P.phoneNumber,this.isAnonymous=P.isAnonymous,this.tenantId=P.tenantId,this.providerData=P.providerData.map(R=>Object.assign({},R)),this.metadata._copy(P.metadata),this.stsTokenManager._assign(P.stsTokenManager))}_clone(P){const R=new ei(Object.assign(Object.assign({},this),{auth:P,stsTokenManager:this.stsTokenManager._clone()}));return R.metadata._copy(this.metadata),R}_onReload(P){tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=P,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(P){this.reloadListener?this.reloadListener(P):this.reloadUserInfo=P}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(P,R=!1){var q=this;return(0,d.Z)(function*(){let le=!1;P.idToken&&P.idToken!==q.stsTokenManager.accessToken&&(q.stsTokenManager.updateFromServerResponse(P),le=!0),R&&(yield ys(q)),yield q.auth._persistUserIfCurrent(q),le&&q.auth._notifyListenersIfCurrent(q)})()}delete(){var P=this;return(0,d.Z)(function*(){const R=yield P.getIdToken();return yield Nr(P,function Ds(j,P){return _s.apply(this,arguments)}(P.auth,{idToken:R})),P.stsTokenManager.clearRefreshToken(),P.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(P=>Object.assign({},P)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(P,R){var q,le,_e,lt,$t,Tn,ii,zi;const po=null!==(q=R.displayName)&&void 0!==q?q:void 0,ga=null!==(le=R.email)&&void 0!==le?le:void 0,rl=null!==(_e=R.phoneNumber)&&void 0!==_e?_e:void 0,ol=null!==(lt=R.photoURL)&&void 0!==lt?lt:void 0,pc=null!==($t=R.tenantId)&&void 0!==$t?$t:void 0,La=null!==(Tn=R._redirectEventId)&&void 0!==Tn?Tn:void 0,ru=null!==(ii=R.createdAt)&&void 0!==ii?ii:void 0,ou=null!==(zi=R.lastLoginAt)&&void 0!==zi?zi:void 0,{uid:mc,emailVerified:Dh,isAnonymous:Ah,providerData:Sf,stsTokenManager:Yu}=R;tt(mc&&Yu,P,"internal-error");const jp=Sn.fromJSON(this.name,Yu);tt("string"==typeof mc,P,"internal-error"),Zn(po,P.name),Zn(ga,P.name),tt("boolean"==typeof Dh,P,"internal-error"),tt("boolean"==typeof Ah,P,"internal-error"),Zn(rl,P.name),Zn(ol,P.name),Zn(pc,P.name),Zn(La,P.name),Zn(ru,P.name),Zn(ou,P.name);const Ph=new ei({uid:mc,auth:P,email:ga,emailVerified:Dh,displayName:po,isAnonymous:Ah,photoURL:ol,phoneNumber:rl,tenantId:pc,stsTokenManager:jp,createdAt:ru,lastLoginAt:ou});return Sf&&Array.isArray(Sf)&&(Ph.providerData=Sf.map(Na=>Object.assign({},Na))),La&&(Ph._redirectEventId=La),Ph}static _fromIdTokenResponse(P,R,q=!1){return(0,d.Z)(function*(){const le=new Sn;le.updateFromServerResponse(R);const _e=new ei({uid:R.localId,auth:P,stsTokenManager:le,isAnonymous:q});return yield ys(_e),_e})()}}const Qr=(()=>{class j{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,d.Z)(function*(){return!0})()}_set(R,q){var le=this;return(0,d.Z)(function*(){le.storage[R]=q})()}_get(R){var q=this;return(0,d.Z)(function*(){const le=q.storage[R];return void 0===le?null:le})()}_remove(R){var q=this;return(0,d.Z)(function*(){delete q.storage[R]})()}_addListener(R,q){}_removeListener(R,q){}}return j.type="NONE",j})();function ze(j,P,R){return`firebase:${j}:${P}:${R}`}class ne{constructor(P,R,q){this.persistence=P,this.auth=R,this.userKey=q;const{config:le,name:_e}=this.auth;this.fullUserKey=ze(this.userKey,le.apiKey,_e),this.fullPersistenceKey=ze("persistence",le.apiKey,_e),this.boundEventHandler=R._onStorageEvent.bind(R),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(P){return this.persistence._set(this.fullUserKey,P.toJSON())}getCurrentUser(){var P=this;return(0,d.Z)(function*(){const R=yield P.persistence._get(P.fullUserKey);return R?ei._fromJSON(P.auth,R):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(P){var R=this;return(0,d.Z)(function*(){if(R.persistence===P)return;const q=yield R.getCurrentUser();return yield R.removeCurrentUser(),R.persistence=P,q?R.setCurrentUser(q):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(P,R,q="authUser"){return(0,d.Z)(function*(){if(!R.length)return new ne(an(Qr),P,q);const le=(yield Promise.all(R.map(function(){var ii=(0,d.Z)(function*(zi){if(yield zi._isAvailable())return zi});return function(zi){return ii.apply(this,arguments)}}()))).filter(ii=>ii);let _e=le[0]||an(Qr);const lt=ze(q,P.config.apiKey,P.name);let $t=null;for(const ii of R)try{const zi=yield ii._get(lt);if(zi){const po=ei._fromJSON(P,zi);ii!==_e&&($t=po),_e=ii;break}}catch{}const Tn=le.filter(ii=>ii._shouldAllowMigration);return _e._shouldAllowMigration&&Tn.length?(_e=Tn[0],$t&&(yield _e._set(lt,$t.toJSON())),yield Promise.all(R.map(function(){var ii=(0,d.Z)(function*(zi){if(zi!==_e)try{yield zi._remove(lt)}catch{}});return function(zi){return ii.apply(this,arguments)}}())),new ne(_e,P,q)):new ne(_e,P,q)})()}}function $(j){const P=j.toLowerCase();if(P.includes("opera/")||P.includes("opr/")||P.includes("opios/"))return"Opera";if(fe(P))return"IEMobile";if(P.includes("msie")||P.includes("trident/"))return"IE";if(P.includes("edge/"))return"Edge";if(H(P))return"Firefox";if(P.includes("silk/"))return"Silk";if(Be(P))return"Blackberry";if(Pe(P))return"Webos";if(Y(P))return"Safari";if((P.includes("chrome/")||se(P))&&!P.includes("edge/"))return"Chrome";if(Oe(P))return"Android";{const q=j.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===q?.length)return q[1]}return"Other"}function H(j=(0,Ne.z$)()){return/firefox\//i.test(j)}function Y(j=(0,Ne.z$)()){const P=j.toLowerCase();return P.includes("safari/")&&!P.includes("chrome/")&&!P.includes("crios/")&&!P.includes("android")}function se(j=(0,Ne.z$)()){return/crios\//i.test(j)}function fe(j=(0,Ne.z$)()){return/iemobile/i.test(j)}function Oe(j=(0,Ne.z$)()){return/android/i.test(j)}function Be(j=(0,Ne.z$)()){return/blackberry/i.test(j)}function Pe(j=(0,Ne.z$)()){return/webos/i.test(j)}function He(j=(0,Ne.z$)()){return/iphone|ipad|ipod/i.test(j)||/macintosh/i.test(j)&&/mobile/i.test(j)}function it(j=(0,Ne.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(j)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(j)}function En(j=(0,Ne.z$)()){return He(j)||Oe(j)||Pe(j)||Be(j)||/windows phone/i.test(j)||fe(j)}function Fn(j,P=[]){let R;switch(j){case"Browser":R=$((0,Ne.z$)());break;case"Worker":R=`${$((0,Ne.z$)())}-${j}`;break;default:R=j}const q=P.length?P.join(","):"FirebaseCore-web";return`${R}/JsCore/${Me.SDK_VERSION}/${q}`}class ni{constructor(P){this.auth=P,this.queue=[]}pushCallback(P,R){const q=_e=>new Promise((lt,$t)=>{try{lt(P(_e))}catch(Tn){$t(Tn)}});q.onAbort=R,this.queue.push(q);const le=this.queue.length-1;return()=>{this.queue[le]=()=>Promise.resolve()}}runMiddleware(P){var R=this;return(0,d.Z)(function*(){if(R.auth.currentUser===P)return;const q=[];try{for(const le of R.queue)yield le(P),le.onAbort&&q.push(le.onAbort)}catch(le){q.reverse();for(const _e of q)try{_e()}catch{}throw R.auth._errorFactory.create("login-blocked",{originalMessage:le?.message})}})()}}class Ci{constructor(P,R,q){this.app=P,this.heartbeatServiceProvider=R,this.config=q,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $n(this),this.idTokenSubscription=new $n(this),this.beforeStateQueue=new ni(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Dn,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=P.name,this.clientVersion=q.sdkClientVersion}_initializeWithPersistence(P,R){var q=this;return R&&(this._popupRedirectResolver=an(R)),this._initializationPromise=this.queue((0,d.Z)(function*(){var le,_e;if(!q._deleted&&(q.persistenceManager=yield ne.create(q,P),!q._deleted)){if(null!==(le=q._popupRedirectResolver)&&void 0!==le&&le._shouldInitProactively)try{yield q._popupRedirectResolver._initialize(q)}catch{}yield q.initializeCurrentUser(R),q.lastNotifiedUid=(null===(_e=q.currentUser)||void 0===_e?void 0:_e.uid)||null,!q._deleted&&(q._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var P=this;return(0,d.Z)(function*(){if(P._deleted)return;const R=yield P.assertedPersistence.getCurrentUser();if(P.currentUser||R){if(P.currentUser&&R&&P.currentUser.uid===R.uid)return P._currentUser._assign(R),void(yield P.currentUser.getIdToken());yield P._updateCurrentUser(R,!0)}})()}initializeCurrentUser(P){var R=this;return(0,d.Z)(function*(){var q;const le=yield R.assertedPersistence.getCurrentUser();let _e=le,lt=!1;if(P&&R.config.authDomain){yield R.getOrInitRedirectPersistenceManager();const $t=null===(q=R.redirectUser)||void 0===q?void 0:q._redirectEventId,Tn=_e?._redirectEventId,ii=yield R.tryRedirectSignIn(P);(!$t||$t===Tn)&&ii?.user&&(_e=ii.user,lt=!0)}if(!_e)return R.directlySetCurrentUser(null);if(!_e._redirectEventId){if(lt)try{yield R.beforeStateQueue.runMiddleware(_e)}catch($t){_e=le,R._popupRedirectResolver._overrideRedirectResult(R,()=>Promise.reject($t))}return _e?R.reloadAndSetCurrentUserOrClear(_e):R.directlySetCurrentUser(null)}return tt(R._popupRedirectResolver,R,"argument-error"),yield R.getOrInitRedirectPersistenceManager(),R.redirectUser&&R.redirectUser._redirectEventId===_e._redirectEventId?R.directlySetCurrentUser(_e):R.reloadAndSetCurrentUserOrClear(_e)})()}tryRedirectSignIn(P){var R=this;return(0,d.Z)(function*(){let q=null;try{q=yield R._popupRedirectResolver._completeRedirectFn(R,P,!0)}catch{yield R._setRedirectUser(null)}return q})()}reloadAndSetCurrentUserOrClear(P){var R=this;return(0,d.Z)(function*(){try{yield ys(P)}catch(q){if("auth/network-request-failed"!==q?.code)return R.directlySetCurrentUser(null)}return R.directlySetCurrentUser(P)})()}useDeviceLanguage(){this.languageCode=function nn(){if(typeof navigator>"u")return null;const j=navigator;return j.languages&&j.languages[0]||j.language||null}()}_delete(){var P=this;return(0,d.Z)(function*(){P._deleted=!0})()}updateCurrentUser(P){var R=this;return(0,d.Z)(function*(){const q=P?(0,Ne.m9)(P):null;return q&&tt(q.auth.config.apiKey===R.config.apiKey,R,"invalid-user-token"),R._updateCurrentUser(q&&q._clone(R))})()}_updateCurrentUser(P,R=!1){var q=this;return(0,d.Z)(function*(){if(!q._deleted)return P&&tt(q.tenantId===P.tenantId,q,"tenant-id-mismatch"),R||(yield q.beforeStateQueue.runMiddleware(P)),q.queue((0,d.Z)(function*(){yield q.directlySetCurrentUser(P),q.notifyAuthListeners()}))})()}signOut(){var P=this;return(0,d.Z)(function*(){return yield P.beforeStateQueue.runMiddleware(null),(P.redirectPersistenceManager||P._popupRedirectResolver)&&(yield P._setRedirectUser(null)),P._updateCurrentUser(null,!0)})()}setPersistence(P){var R=this;return this.queue((0,d.Z)(function*(){yield R.assertedPersistence.setPersistence(an(P))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(P){this._errorFactory=new Ne.LL("auth","Firebase",P())}onAuthStateChanged(P,R,q){return this.registerStateListener(this.authStateSubscription,P,R,q)}beforeAuthStateChanged(P,R){return this.beforeStateQueue.pushCallback(P,R)}onIdTokenChanged(P,R,q){return this.registerStateListener(this.idTokenSubscription,P,R,q)}toJSON(){var P;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(P=this._currentUser)||void 0===P?void 0:P.toJSON()}}_setRedirectUser(P,R){var q=this;return(0,d.Z)(function*(){const le=yield q.getOrInitRedirectPersistenceManager(R);return null===P?le.removeCurrentUser():le.setCurrentUser(P)})()}getOrInitRedirectPersistenceManager(P){var R=this;return(0,d.Z)(function*(){if(!R.redirectPersistenceManager){const q=P&&an(P)||R._popupRedirectResolver;tt(q,R,"argument-error"),R.redirectPersistenceManager=yield ne.create(R,[an(q._redirectPersistence)],"redirectUser"),R.redirectUser=yield R.redirectPersistenceManager.getCurrentUser()}return R.redirectPersistenceManager})()}_redirectUserForId(P){var R=this;return(0,d.Z)(function*(){var q,le;return R._isInitialized&&(yield R.queue((0,d.Z)(function*(){}))),(null===(q=R._currentUser)||void 0===q?void 0:q._redirectEventId)===P?R._currentUser:(null===(le=R.redirectUser)||void 0===le?void 0:le._redirectEventId)===P?R.redirectUser:null})()}_persistUserIfCurrent(P){var R=this;return(0,d.Z)(function*(){if(P===R.currentUser)return R.queue((0,d.Z)(function*(){return R.directlySetCurrentUser(P)}))})()}_notifyListenersIfCurrent(P){P===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var P,R;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const q=null!==(R=null===(P=this.currentUser)||void 0===P?void 0:P.uid)&&void 0!==R?R:null;this.lastNotifiedUid!==q&&(this.lastNotifiedUid=q,this.authStateSubscription.next(this.currentUser))}registerStateListener(P,R,q,le){if(this._deleted)return()=>{};const _e="function"==typeof R?R:R.next.bind(R),lt=this._isInitialized?Promise.resolve():this._initializationPromise;return tt(lt,this,"internal-error"),lt.then(()=>_e(this.currentUser)),"function"==typeof R?P.addObserver(R,q,le):P.addObserver(R)}directlySetCurrentUser(P){var R=this;return(0,d.Z)(function*(){R.currentUser&&R.currentUser!==P&&R._currentUser._stopProactiveRefresh(),P&&R.isProactiveRefreshEnabled&&P._startProactiveRefresh(),R.currentUser=P,P?yield R.assertedPersistence.setCurrentUser(P):yield R.assertedPersistence.removeCurrentUser()})()}queue(P){return this.operations=this.operations.then(P,P),this.operations}get assertedPersistence(){return tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(P){!P||this.frameworks.includes(P)||(this.frameworks.push(P),this.frameworks.sort(),this.clientVersion=Fn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var P=this;return(0,d.Z)(function*(){var R;const q={"X-Client-Version":P.clientVersion};P.app.options.appId&&(q["X-Firebase-gmpid"]=P.app.options.appId);const le=yield null===(R=P.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===R?void 0:R.getHeartbeatsHeader();return le&&(q["X-Firebase-Client"]=le),q})()}}function gi(j){return(0,Ne.m9)(j)}class $n{constructor(P){this.auth=P,this.observer=null,this.addObserver=(0,Ne.ne)(R=>this.observer=R)}get next(){return tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function hr(j,P,R){const q=gi(j);tt(q._canInitEmulator,q,"emulator-config-failed"),tt(/^https?:\/\//.test(P),q,"invalid-emulator-scheme");const le=!!R?.disableWarnings,_e=fr(P),{host:lt,port:$t}=function Zi(j){const P=fr(j),R=/(\/\/)?([^?#/]+)/.exec(j.substr(P.length));if(!R)return{host:"",port:null};const q=R[2].split("@").pop()||"",le=/^(\[[^\]]+\])(:|$)/.exec(q);if(le){const _e=le[1];return{host:_e,port:Rr(q.substr(_e.length+1))}}{const[_e,lt]=q.split(":");return{host:_e,port:Rr(lt)}}}(P);q.config.emulator={url:`${_e}//${lt}${null===$t?"":`:${$t}`}/`},q.settings.appVerificationDisabledForTesting=!0,q.emulatorConfig=Object.freeze({host:lt,port:$t,protocol:_e.replace(":",""),options:Object.freeze({disableWarnings:le})}),le||function ut(){function j(){const P=document.createElement("p"),R=P.style;P.innerText="Running in emulator mode. Do not use with production credentials.",R.position="fixed",R.width="100%",R.backgroundColor="#ffffff",R.border=".1em solid #000000",R.color="#b50000",R.bottom="0px",R.left="0px",R.margin="0px",R.zIndex="10000",R.textAlign="center",P.classList.add("firebase-emulator-warning"),document.body.appendChild(P)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",j):j())}()}function fr(j){const P=j.indexOf(":");return P<0?"":j.substr(0,P+1)}function Rr(j){if(!j)return null;const P=Number(j);return isNaN(P)?null:P}class Ao{constructor(P,R){this.providerId=P,this.signInMethod=R}toJSON(){return pt("not implemented")}_getIdTokenResponse(P){return pt("not implemented")}_linkToIdToken(P,R){return pt("not implemented")}_getReauthenticationResolver(P){return pt("not implemented")}}function cr(j,P){return Ya.apply(this,arguments)}function Ya(){return(Ya=(0,d.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:resetPassword",zn(j,P))})).apply(this,arguments)}function oh(j,P){return us.apply(this,arguments)}function us(){return(us=(0,d.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:update",P)})).apply(this,arguments)}function Mn(){return(Mn=(0,d.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:update",zn(j,P))})).apply(this,arguments)}function Nt(){return(Nt=(0,d.Z)(function*(j,P){return Vn(j,"POST","/v1/accounts:signInWithPassword",zn(j,P))})).apply(this,arguments)}function ri(j,P){return _i.apply(this,arguments)}function _i(){return(_i=(0,d.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:sendOobCode",zn(j,P))})).apply(this,arguments)}function Ps(){return(Ps=(0,d.Z)(function*(j,P){return ri(j,P)})).apply(this,arguments)}function Bo(){return(Bo=(0,d.Z)(function*(j,P){return ri(j,P)})).apply(this,arguments)}function bi(){return(bi=(0,d.Z)(function*(j,P){return ri(j,P)})).apply(this,arguments)}function ji(){return(ji=(0,d.Z)(function*(j,P){return ri(j,P)})).apply(this,arguments)}function co(){return(co=(0,d.Z)(function*(j,P){return Vn(j,"POST","/v1/accounts:signInWithEmailLink",zn(j,P))})).apply(this,arguments)}function Us(){return(Us=(0,d.Z)(function*(j,P){return Vn(j,"POST","/v1/accounts:signInWithEmailLink",zn(j,P))})).apply(this,arguments)}class sa extends Ao{constructor(P,R,q,le=null){super("password",q),this._email=P,this._password=R,this._tenantId=le}static _fromEmailAndPassword(P,R){return new sa(P,R,"password")}static _fromEmailAndCode(P,R,q=null){return new sa(P,R,"emailLink",q)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(P){const R="string"==typeof P?JSON.parse(P):P;if(R?.email&&R?.password){if("password"===R.signInMethod)return this._fromEmailAndPassword(R.email,R.password);if("emailLink"===R.signInMethod)return this._fromEmailAndCode(R.email,R.password,R.tenantId)}return null}_getIdTokenResponse(P){var R=this;return(0,d.Z)(function*(){switch(R.signInMethod){case"password":return function Ti(j,P){return Nt.apply(this,arguments)}(P,{returnSecureToken:!0,email:R._email,password:R._password});case"emailLink":return function _d(j,P){return co.apply(this,arguments)}(P,{email:R._email,oobCode:R._password});default:Jt(P,"internal-error")}})()}_linkToIdToken(P,R){var q=this;return(0,d.Z)(function*(){switch(q.signInMethod){case"password":return oh(P,{idToken:R,returnSecureToken:!0,email:q._email,password:q._password});case"emailLink":return function ds(j,P){return Us.apply(this,arguments)}(P,{idToken:R,email:q._email,oobCode:q._password});default:Jt(P,"internal-error")}})()}_getReauthenticationResolver(P){return this._getIdTokenResponse(P)}}function bo(j,P){return aa.apply(this,arguments)}function aa(){return(aa=(0,d.Z)(function*(j,P){return Vn(j,"POST","/v1/accounts:signInWithIdp",zn(j,P))})).apply(this,arguments)}class yi extends Ao{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(P){const R=new yi(P.providerId,P.signInMethod);return P.idToken||P.accessToken?(P.idToken&&(R.idToken=P.idToken),P.accessToken&&(R.accessToken=P.accessToken),P.nonce&&!P.pendingToken&&(R.nonce=P.nonce),P.pendingToken&&(R.pendingToken=P.pendingToken)):P.oauthToken&&P.oauthTokenSecret?(R.accessToken=P.oauthToken,R.secret=P.oauthTokenSecret):Jt("argument-error"),R}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(P){const R="string"==typeof P?JSON.parse(P):P,{providerId:q,signInMethod:le}=R,_e=(0,$e._T)(R,["providerId","signInMethod"]);if(!q||!le)return null;const lt=new yi(q,le);return lt.idToken=_e.idToken||void 0,lt.accessToken=_e.accessToken||void 0,lt.secret=_e.secret,lt.nonce=_e.nonce,lt.pendingToken=_e.pendingToken||null,lt}_getIdTokenResponse(P){return bo(P,this.buildRequest())}_linkToIdToken(P,R){const q=this.buildRequest();return q.idToken=R,bo(P,q)}_getReauthenticationResolver(P){const R=this.buildRequest();return R.autoCreate=!1,bo(P,R)}buildRequest(){const P={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)P.pendingToken=this.pendingToken;else{const R={};this.idToken&&(R.id_token=this.idToken),this.accessToken&&(R.access_token=this.accessToken),this.secret&&(R.oauth_token_secret=this.secret),R.providerId=this.providerId,this.nonce&&!this.pendingToken&&(R.nonce=this.nonce),P.postBody=(0,Ne.xO)(R)}return P}}function Zo(){return(Zo=(0,d.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:sendVerificationCode",zn(j,P))})).apply(this,arguments)}function El(){return(El=(0,d.Z)(function*(j,P){return Vn(j,"POST","/v1/accounts:signInWithPhoneNumber",zn(j,P))})).apply(this,arguments)}function xo(){return(xo=(0,d.Z)(function*(j,P){const R=yield Vn(j,"POST","/v1/accounts:signInWithPhoneNumber",zn(j,P));if(R.temporaryProof)throw so(j,"account-exists-with-different-credential",R);return R})).apply(this,arguments)}const Cr={USER_NOT_FOUND:"user-not-found"};function Yo(){return(Yo=(0,d.Z)(function*(j,P){return Vn(j,"POST","/v1/accounts:signInWithPhoneNumber",zn(j,Object.assign(Object.assign({},P),{operation:"REAUTH"})),Cr)})).apply(this,arguments)}class Ji extends Ao{constructor(P){super("phone","phone"),this.params=P}static _fromVerification(P,R){return new Ji({verificationId:P,verificationCode:R})}static _fromTokenResponse(P,R){return new Ji({phoneNumber:P,temporaryProof:R})}_getIdTokenResponse(P){return function Jr(j,P){return El.apply(this,arguments)}(P,this._makeVerificationRequest())}_linkToIdToken(P,R){return function nc(j,P){return xo.apply(this,arguments)}(P,Object.assign({idToken:R},this._makeVerificationRequest()))}_getReauthenticationResolver(P){return function Um(j,P){return Yo.apply(this,arguments)}(P,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:P,phoneNumber:R,verificationId:q,verificationCode:le}=this.params;return P&&R?{temporaryProof:P,phoneNumber:R}:{sessionInfo:q,code:le}}toJSON(){const P={providerId:this.providerId};return this.params.phoneNumber&&(P.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(P.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(P.verificationCode=this.params.verificationCode),this.params.verificationId&&(P.verificationId=this.params.verificationId),P}static fromJSON(P){"string"==typeof P&&(P=JSON.parse(P));const{verificationId:R,verificationCode:q,phoneNumber:le,temporaryProof:_e}=P;return q||R||le||_e?new Ji({verificationId:R,verificationCode:q,phoneNumber:le,temporaryProof:_e}):null}}class js{constructor(P){var R,q,le,_e,lt,$t;const Tn=(0,Ne.zd)((0,Ne.pd)(P)),ii=null!==(R=Tn.apiKey)&&void 0!==R?R:null,zi=null!==(q=Tn.oobCode)&&void 0!==q?q:null,po=function Lc(j){switch(j){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(le=Tn.mode)&&void 0!==le?le:null);tt(ii&&zi&&po,"argument-error"),this.apiKey=ii,this.operation=po,this.code=zi,this.continueUrl=null!==(_e=Tn.continueUrl)&&void 0!==_e?_e:null,this.languageCode=null!==(lt=Tn.languageCode)&&void 0!==lt?lt:null,this.tenantId=null!==($t=Tn.tenantId)&&void 0!==$t?$t:null}static parseLink(P){const R=function Nc(j){const P=(0,Ne.zd)((0,Ne.pd)(j)).link,R=P?(0,Ne.zd)((0,Ne.pd)(P)).deep_link_id:null,q=(0,Ne.zd)((0,Ne.pd)(j)).deep_link_id;return(q?(0,Ne.zd)((0,Ne.pd)(q)).link:null)||q||R||P||j}(P);try{return new js(R)}catch{return null}}}let Eu=(()=>{class j{constructor(){this.providerId=j.PROVIDER_ID}static credential(R,q){return sa._fromEmailAndPassword(R,q)}static credentialWithLink(R,q){const le=js.parseLink(q);return tt(le,"argument-error"),sa._fromEmailAndCode(R,le.code,le.tenantId)}}return j.PROVIDER_ID="password",j.EMAIL_PASSWORD_SIGN_IN_METHOD="password",j.EMAIL_LINK_SIGN_IN_METHOD="emailLink",j})();class Zs{constructor(P){this.providerId=P,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(P){this.defaultLanguageCode=P}setCustomParameters(P){return this.customParameters=P,this}getCustomParameters(){return this.customParameters}}class $s extends Zs{constructor(){super(...arguments),this.scopes=[]}addScope(P){return this.scopes.includes(P)||this.scopes.push(P),this}getScopes(){return[...this.scopes]}}class Tl extends $s{static credentialFromJSON(P){const R="string"==typeof P?JSON.parse(P):P;return tt("providerId"in R&&"signInMethod"in R,"argument-error"),yi._fromParams(R)}credential(P){return this._credential(Object.assign(Object.assign({},P),{nonce:P.rawNonce}))}_credential(P){return tt(P.idToken||P.accessToken,"argument-error"),yi._fromParams(Object.assign(Object.assign({},P),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(P){return Tl.oauthCredentialFromTaggedObject(P)}static credentialFromError(P){return Tl.oauthCredentialFromTaggedObject(P.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:P}){if(!P)return null;const{oauthIdToken:R,oauthAccessToken:q,oauthTokenSecret:le,pendingToken:_e,nonce:lt,providerId:$t}=P;if(!q&&!le&&!R&&!_e||!$t)return null;try{return new Tl($t)._credential({idToken:R,accessToken:q,nonce:lt,pendingToken:_e})}catch{return null}}}let uf=(()=>{class j extends $s{constructor(){super("facebook.com")}static credential(R){return yi._fromParams({providerId:j.PROVIDER_ID,signInMethod:j.FACEBOOK_SIGN_IN_METHOD,accessToken:R})}static credentialFromResult(R){return j.credentialFromTaggedObject(R)}static credentialFromError(R){return j.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R||!("oauthAccessToken"in R)||!R.oauthAccessToken)return null;try{return j.credential(R.oauthAccessToken)}catch{return null}}}return j.FACEBOOK_SIGN_IN_METHOD="facebook.com",j.PROVIDER_ID="facebook.com",j})(),jm=(()=>{class j extends $s{constructor(){super("google.com"),this.addScope("profile")}static credential(R,q){return yi._fromParams({providerId:j.PROVIDER_ID,signInMethod:j.GOOGLE_SIGN_IN_METHOD,idToken:R,accessToken:q})}static credentialFromResult(R){return j.credentialFromTaggedObject(R)}static credentialFromError(R){return j.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R)return null;const{oauthIdToken:q,oauthAccessToken:le}=R;if(!q&&!le)return null;try{return j.credential(q,le)}catch{return null}}}return j.GOOGLE_SIGN_IN_METHOD="google.com",j.PROVIDER_ID="google.com",j})(),wp=(()=>{class j extends $s{constructor(){super("github.com")}static credential(R){return yi._fromParams({providerId:j.PROVIDER_ID,signInMethod:j.GITHUB_SIGN_IN_METHOD,accessToken:R})}static credentialFromResult(R){return j.credentialFromTaggedObject(R)}static credentialFromError(R){return j.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R||!("oauthAccessToken"in R)||!R.oauthAccessToken)return null;try{return j.credential(R.oauthAccessToken)}catch{return null}}}return j.GITHUB_SIGN_IN_METHOD="github.com",j.PROVIDER_ID="github.com",j})();class Tu extends Ao{constructor(P,R){super(P,P),this.pendingToken=R}_getIdTokenResponse(P){return bo(P,this.buildRequest())}_linkToIdToken(P,R){const q=this.buildRequest();return q.idToken=R,bo(P,q)}_getReauthenticationResolver(P){const R=this.buildRequest();return R.autoCreate=!1,bo(P,R)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(P){const R="string"==typeof P?JSON.parse(P):P,{providerId:q,signInMethod:le,pendingToken:_e}=R;return q&&le&&_e&&q===le?new Tu(q,_e):null}static _create(P,R){return new Tu(P,R)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Ka extends Zs{constructor(P){tt(P.startsWith("saml."),"argument-error"),super(P)}static credentialFromResult(P){return Ka.samlCredentialFromTaggedObject(P)}static credentialFromError(P){return Ka.samlCredentialFromTaggedObject(P.customData||{})}static credentialFromJSON(P){const R=Tu.fromJSON(P);return tt(R,"argument-error"),R}static samlCredentialFromTaggedObject({_tokenResponse:P}){if(!P)return null;const{pendingToken:R,providerId:q}=P;if(!R||!q)return null;try{return Tu._create(q,R)}catch{return null}}}let Su=(()=>{class j extends $s{constructor(){super("twitter.com")}static credential(R,q){return yi._fromParams({providerId:j.PROVIDER_ID,signInMethod:j.TWITTER_SIGN_IN_METHOD,oauthToken:R,oauthTokenSecret:q})}static credentialFromResult(R){return j.credentialFromTaggedObject(R)}static credentialFromError(R){return j.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R)return null;const{oauthAccessToken:q,oauthTokenSecret:le}=R;if(!q||!le)return null;try{return j.credential(q,le)}catch{return null}}}return j.TWITTER_SIGN_IN_METHOD="twitter.com",j.PROVIDER_ID="twitter.com",j})();function df(j,P){return vs.apply(this,arguments)}function vs(){return(vs=(0,d.Z)(function*(j,P){return Vn(j,"POST","/v1/accounts:signUp",zn(j,P))})).apply(this,arguments)}class eo{constructor(P){this.user=P.user,this.providerId=P.providerId,this._tokenResponse=P._tokenResponse,this.operationType=P.operationType}static _fromIdTokenResponse(P,R,q,le=!1){return(0,d.Z)(function*(){const _e=yield ei._fromIdTokenResponse(P,q,le),lt=vd(q);return new eo({user:_e,providerId:lt,_tokenResponse:q,operationType:R})})()}static _forOperation(P,R,q){return(0,d.Z)(function*(){yield P._updateTokensIfNecessary(q,!0);const le=vd(q);return new eo({user:P,providerId:le,_tokenResponse:q,operationType:R})})()}}function vd(j){return j.providerId?j.providerId:"phoneNumber"in j?"phone":null}function hf(j){return bd.apply(this,arguments)}function bd(){return(bd=(0,d.Z)(function*(j){var P;const R=gi(j);if(yield R._initializationPromise,null!==(P=R.currentUser)&&void 0!==P&&P.isAnonymous)return new eo({user:R.currentUser,providerId:null,operationType:"signIn"});const q=yield df(R,{returnSecureToken:!0}),le=yield eo._fromIdTokenResponse(R,"signIn",q,!0);return yield R._updateCurrentUser(le.user),le})).apply(this,arguments)}class Mu extends Ne.ZR{constructor(P,R,q,le){var _e;super(R.code,R.message),this.operationType=q,this.user=le,Object.setPrototypeOf(this,Mu.prototype),this.customData={appName:P.name,tenantId:null!==(_e=P.tenantId)&&void 0!==_e?_e:void 0,_serverResponse:R.customData._serverResponse,operationType:q}}static _fromErrorAndOperation(P,R,q,le){return new Mu(P,R,q,le)}}function ff(j,P,R,q){return("reauthenticate"===P?R._getReauthenticationResolver(j):R._getIdTokenResponse(j)).catch(_e=>{throw"auth/multi-factor-auth-required"===_e.code?Mu._fromErrorAndOperation(j,_e,P,q):_e})}function Cp(j){return new Set(j.map(({providerId:P})=>P).filter(P=>!!P))}function ic(j,P){return zc.apply(this,arguments)}function zc(){return zc=(0,d.Z)(function*(j,P){const R=(0,Ne.m9)(j);yield rc(!0,R,P);const{providerUserInfo:q}=yield function Ir(j,P){return jr.apply(this,arguments)}(R.auth,{idToken:yield R.getIdToken(),deleteProvider:[P]}),le=Cp(q||[]);return R.providerData=R.providerData.filter(_e=>le.has(_e.providerId)),le.has("phone")||(R.phoneNumber=null),yield R.auth._persistUserIfCurrent(R),R}),zc.apply(this,arguments)}function Du(j,P){return Bc.apply(this,arguments)}function Bc(){return(Bc=(0,d.Z)(function*(j,P,R=!1){const q=yield Nr(j,P._linkToIdToken(j.auth,yield j.getIdToken()),R);return eo._forOperation(j,"link",q)})).apply(this,arguments)}function rc(j,P,R){return xd.apply(this,arguments)}function xd(){return(xd=(0,d.Z)(function*(j,P,R){yield ys(P);const le=!1===j?"provider-already-linked":"no-such-provider";tt(Cp(P.providerData).has(R)===j,P.auth,le)})).apply(this,arguments)}function oc(j,P){return Yi.apply(this,arguments)}function Yi(){return(Yi=(0,d.Z)(function*(j,P,R=!1){const{auth:q}=j,le="reauthenticate";try{const _e=yield Nr(j,ff(q,le,P,j),R);tt(_e.idToken,q,"internal-error");const lt=jn(_e.idToken);tt(lt,q,"internal-error");const{sub:$t}=lt;return tt(j.uid===$t,q,"user-mismatch"),eo._forOperation(j,le,_e)}catch(_e){throw"auth/user-not-found"===_e?.code&&Jt(q,"user-mismatch"),_e}})).apply(this,arguments)}function wd(j,P){return Il.apply(this,arguments)}function Il(){return(Il=(0,d.Z)(function*(j,P,R=!1){const q="signIn",le=yield ff(j,q,P),_e=yield eo._fromIdTokenResponse(j,q,le);return R||(yield j._updateCurrentUser(_e.user)),_e})).apply(this,arguments)}function Vc(j,P){return Ko.apply(this,arguments)}function Ko(){return(Ko=(0,d.Z)(function*(j,P){return wd(gi(j),P)})).apply(this,arguments)}function Au(j,P){return Uc.apply(this,arguments)}function Uc(){return(Uc=(0,d.Z)(function*(j,P){const R=(0,Ne.m9)(j);return yield rc(!1,R,P.providerId),Du(R,P)})).apply(this,arguments)}function to(j,P){return Pu.apply(this,arguments)}function Pu(){return(Pu=(0,d.Z)(function*(j,P){return oc((0,Ne.m9)(j),P)})).apply(this,arguments)}function uo(){return(uo=(0,d.Z)(function*(j,P){return Vn(j,"POST","/v1/accounts:signInWithCustomToken",zn(j,P))})).apply(this,arguments)}function jc(j,P){return Ou.apply(this,arguments)}function Ou(){return Ou=(0,d.Z)(function*(j,P){const R=gi(j),q=yield function Sl(j,P){return uo.apply(this,arguments)}(R,{token:P,returnSecureToken:!0}),le=yield eo._fromIdTokenResponse(R,"signIn",q);return yield R._updateCurrentUser(le.user),le}),Ou.apply(this,arguments)}class la{constructor(P,R){this.factorId=P,this.uid=R.mfaEnrollmentId,this.enrollmentTime=new Date(R.enrolledAt).toUTCString(),this.displayName=R.displayName}static _fromServerResponse(P,R){return"phoneInfo"in R?di._fromServerResponse(P,R):"totpInfo"in R?$c._fromServerResponse(P,R):Jt(P,"internal-error")}}class di extends la{constructor(P){super("phone",P),this.phoneNumber=P.phoneInfo}static _fromServerResponse(P,R){return new di(R)}}class $c extends la{constructor(P){super("totp",P)}static _fromServerResponse(P,R){return new $c(R)}}function sc(j,P,R){var q;tt((null===(q=R.url)||void 0===q?void 0:q.length)>0,j,"invalid-continue-uri"),tt(typeof R.dynamicLinkDomain>"u"||R.dynamicLinkDomain.length>0,j,"invalid-dynamic-link-domain"),P.continueUrl=R.url,P.dynamicLinkDomain=R.dynamicLinkDomain,P.canHandleCodeInApp=R.handleCodeInApp,R.iOS&&(tt(R.iOS.bundleId.length>0,j,"missing-ios-bundle-id"),P.iOSBundleId=R.iOS.bundleId),R.android&&(tt(R.android.packageName.length>0,j,"missing-android-pkg-name"),P.androidInstallApp=R.android.installApp,P.androidMinimumVersionCode=R.android.minimumVersion,P.androidPackageName=R.android.packageName)}function $m(j,P,R){return ca.apply(this,arguments)}function ca(){return ca=(0,d.Z)(function*(j,P,R){const q=(0,Ne.m9)(j),le={requestType:"PASSWORD_RESET",email:P};R&&sc(q,le,R),yield function Gn(j,P){return Bo.apply(this,arguments)}(q,le)}),ca.apply(this,arguments)}function sh(j,P,R){return Gc.apply(this,arguments)}function Gc(){return(Gc=(0,d.Z)(function*(j,P,R){yield cr((0,Ne.m9)(j),{oobCode:P,newPassword:R})})).apply(this,arguments)}function Ii(j,P){return pf.apply(this,arguments)}function pf(){return pf=(0,d.Z)(function*(j,P){yield function As(j,P){return Mn.apply(this,arguments)}((0,Ne.m9)(j),{oobCode:P})}),pf.apply(this,arguments)}function ah(j,P){return Cd.apply(this,arguments)}function Cd(){return(Cd=(0,d.Z)(function*(j,P){const R=(0,Ne.m9)(j),q=yield cr(R,{oobCode:P}),le=q.requestType;switch(tt(le,R,"internal-error"),le){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":tt(q.newEmail,R,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":tt(q.mfaInfo,R,"internal-error");default:tt(q.email,R,"internal-error")}let _e=null;return q.mfaInfo&&(_e=la._fromServerResponse(gi(R),q.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===q.requestType?q.newEmail:q.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===q.requestType?q.email:q.newEmail)||null,multiFactorInfo:_e},operation:le}})).apply(this,arguments)}function lh(j,P){return ku.apply(this,arguments)}function ku(){return(ku=(0,d.Z)(function*(j,P){const{data:R}=yield ah((0,Ne.m9)(j),P);return R.email})).apply(this,arguments)}function Ep(j,P,R){return ch.apply(this,arguments)}function ch(){return(ch=(0,d.Z)(function*(j,P,R){const q=gi(j),le=yield df(q,{returnSecureToken:!0,email:P,password:R}),_e=yield eo._fromIdTokenResponse(q,"signIn",le);return yield q._updateCurrentUser(_e.user),_e})).apply(this,arguments)}function wo(j,P,R){return Vc((0,Ne.m9)(j),Eu.credential(P,R))}function qt(j,P,R){return $i.apply(this,arguments)}function $i(){return $i=(0,d.Z)(function*(j,P,R){const q=(0,Ne.m9)(j),le={requestType:"EMAIL_SIGNIN",email:P};tt(R.handleCodeInApp,q,"argument-error"),R&&sc(q,le,R),yield function Cl(j,P){return bi.apply(this,arguments)}(q,le)}),$i.apply(this,arguments)}function Tp(j,P){return"EMAIL_SIGNIN"===js.parseLink(P)?.operation}function Ed(j,P,R){return Po.apply(this,arguments)}function Po(){return(Po=(0,d.Z)(function*(j,P,R){const q=(0,Ne.m9)(j),le=Eu.credentialWithLink(P,R||mt());return tt(le._tenantId===(q.tenantId||null),q,"tenant-id-mismatch"),Vc(q,le)})).apply(this,arguments)}function Ml(){return(Ml=(0,d.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:createAuthUri",zn(j,P))})).apply(this,arguments)}function Qa(j,P){return Hc.apply(this,arguments)}function Hc(){return Hc=(0,d.Z)(function*(j,P){const q={identifier:P,continueUri:gt()?mt():"http://localhost"},{signinMethods:le}=yield function Xa(j,P){return Ml.apply(this,arguments)}((0,Ne.m9)(j),q);return le||[]}),Hc.apply(this,arguments)}function uh(j,P){return qc.apply(this,arguments)}function qc(){return qc=(0,d.Z)(function*(j,P){const R=(0,Ne.m9)(j),le={requestType:"VERIFY_EMAIL",idToken:yield j.getIdToken()};P&&sc(R.auth,le,P);const{email:_e}=yield function ur(j,P){return Ps.apply(this,arguments)}(R.auth,le);_e!==j.email&&(yield j.reload())}),qc.apply(this,arguments)}function T_(j,P,R){return Ru.apply(this,arguments)}function Ru(){return Ru=(0,d.Z)(function*(j,P,R){const q=(0,Ne.m9)(j),_e={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield j.getIdToken(),newEmail:P};R&&sc(q.auth,_e,R);const{email:lt}=yield function Vo(j,P){return ji.apply(this,arguments)}(q.auth,_e);lt!==j.email&&(yield j.reload())}),Ru.apply(this,arguments)}function Uo(){return(Uo=(0,d.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:update",P)})).apply(this,arguments)}function Ip(j,P){return Dl.apply(this,arguments)}function Dl(){return Dl=(0,d.Z)(function*(j,{displayName:P,photoURL:R}){if(void 0===P&&void 0===R)return;const q=(0,Ne.m9)(j),_e={idToken:yield q.getIdToken(),displayName:P,photoUrl:R,returnSecureToken:!0},lt=yield Nr(q,function Xo(j,P){return Uo.apply(this,arguments)}(q.auth,_e));q.displayName=lt.displayName||null,q.photoURL=lt.photoUrl||null;const $t=q.providerData.find(({providerId:Tn})=>"password"===Tn);$t&&($t.displayName=q.displayName,$t.photoURL=q.photoURL),yield q._updateTokensIfNecessary(lt)}),Dl.apply(this,arguments)}function Ja(j,P){return Sp((0,Ne.m9)(j),P,null)}function dh(j,P){return Sp((0,Ne.m9)(j),null,P)}function Sp(j,P,R){return ac.apply(this,arguments)}function ac(){return(ac=(0,d.Z)(function*(j,P,R){const{auth:q}=j,_e={idToken:yield j.getIdToken(),returnSecureToken:!0};P&&(_e.email=P),R&&(_e.password=R);const lt=yield Nr(j,oh(q,_e));yield j._updateTokensIfNecessary(lt,!0)})).apply(this,arguments)}class Ma{constructor(P,R,q={}){this.isNewUser=P,this.providerId=R,this.profile=q}}class hh extends Ma{constructor(P,R,q,le){super(P,R,q),this.username=le}}class Fu extends Ma{constructor(P,R){super(P,"facebook.com",R)}}class Dp extends hh{constructor(P,R){super(P,"github.com",R,"string"==typeof R?.login?R?.login:null)}}class Gm extends Ma{constructor(P,R){super(P,"google.com",R)}}class Ap extends hh{constructor(P,R,q){super(P,"twitter.com",R,q)}}function mf(j){const{user:P,_tokenResponse:R}=j;return P.isAnonymous&&!R?{providerId:null,isNewUser:!1,profile:null}:function Mp(j){var P,R;if(!j)return null;const{providerId:q}=j,le=j.rawUserInfo?JSON.parse(j.rawUserInfo):{},_e=j.isNewUser||"identitytoolkit#SignupNewUserResponse"===j.kind;if(!q&&j?.idToken){const lt=null===(R=null===(P=jn(j.idToken))||void 0===P?void 0:P.firebase)||void 0===R?void 0:R.sign_in_provider;if(lt)return new Ma(_e,"anonymous"!==lt&&"custom"!==lt?lt:null)}if(!q)return null;switch(q){case"facebook.com":return new Fu(_e,le);case"github.com":return new Dp(_e,le);case"google.com":return new Gm(_e,le);case"twitter.com":return new Ap(_e,le,j.screenName||null);case"custom":case"anonymous":return new Ma(_e,null);default:return new Ma(_e,q,le)}}(R)}function _f(j,P,R,q){return(0,Ne.m9)(j).onAuthStateChanged(P,R,q)}class pr{constructor(P,R,q){this.type=P,this.credential=R,this.auth=q}static _fromIdtoken(P,R){return new pr("enroll",P,R)}static _fromMfaPendingCredential(P){return new pr("signin",P)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(P){var R,q;if(P?.multiFactorSession){if(null!==(R=P.multiFactorSession)&&void 0!==R&&R.pendingCredential)return pr._fromMfaPendingCredential(P.multiFactorSession.pendingCredential);if(null!==(q=P.multiFactorSession)&&void 0!==q&&q.idToken)return pr._fromIdtoken(P.multiFactorSession.idToken)}return null}}class Wc{constructor(P,R,q){this.session=P,this.hints=R,this.signInResolver=q}static _fromError(P,R){const q=gi(P),le=R.customData._serverResponse,_e=(le.mfaInfo||[]).map($t=>la._fromServerResponse(q,$t));tt(le.mfaPendingCredential,q,"internal-error");const lt=pr._fromMfaPendingCredential(le.mfaPendingCredential);return new Wc(lt,_e,function(){var $t=(0,d.Z)(function*(Tn){const ii=yield Tn._process(q,lt);delete le.mfaInfo,delete le.mfaPendingCredential;const zi=Object.assign(Object.assign({},le),{idToken:ii.idToken,refreshToken:ii.refreshToken});switch(R.operationType){case"signIn":const po=yield eo._fromIdTokenResponse(q,R.operationType,zi);return yield q._updateCurrentUser(po.user),po;case"reauthenticate":return tt(R.user,q,"internal-error"),eo._forOperation(R.user,R.operationType,zi);default:Jt(q,"internal-error")}});return function(Tn){return $t.apply(this,arguments)}}())}resolveSignIn(P){var R=this;return(0,d.Z)(function*(){return R.signInResolver(P)})()}}function Td(j,P){var R;const q=(0,Ne.m9)(j),le=P;return tt(P.customData.operationType,q,"argument-error"),tt(null===(R=le.customData._serverResponse)||void 0===R?void 0:R.mfaPendingCredential,q,"argument-error"),Wc._fromError(q,le)}class Id{constructor(P){this.user=P,this.enrolledFactors=[],P._onReload(R=>{R.mfaInfo&&(this.enrolledFactors=R.mfaInfo.map(q=>la._fromServerResponse(P.auth,q)))})}static _fromUser(P){return new Id(P)}getSession(){var P=this;return(0,d.Z)(function*(){return pr._fromIdtoken(yield P.user.getIdToken(),P.user.auth)})()}enroll(P,R){var q=this;return(0,d.Z)(function*(){const le=P,_e=yield q.getSession(),lt=yield Nr(q.user,le._process(q.user.auth,_e,R));return yield q.user._updateTokensIfNecessary(lt),q.user.reload()})()}unenroll(P){var R=this;return(0,d.Z)(function*(){const q="string"==typeof P?P:P.uid,le=yield R.user.getIdToken();try{const _e=yield Nr(R.user,function Nu(j,P){return vn(j,"POST","/v2/accounts/mfaEnrollment:withdraw",zn(j,P))}(R.user.auth,{idToken:le,mfaEnrollmentId:q}));R.enrolledFactors=R.enrolledFactors.filter(({uid:lt})=>lt!==q),yield R.user._updateTokensIfNecessary(_e),yield R.user.reload()}catch(_e){throw _e}})()}}const cc=new WeakMap;function Al(j){const P=(0,Ne.m9)(j);return cc.has(P)||cc.set(P,Id._fromUser(P)),cc.get(P)}const Da="__sak";class vf{constructor(P,R){this.storageRetriever=P,this.type=R}_isAvailable(){try{return this.storage?(this.storage.setItem(Da,"1"),this.storage.removeItem(Da),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(P,R){return this.storage.setItem(P,JSON.stringify(R)),Promise.resolve()}_get(P){const R=this.storage.getItem(P);return Promise.resolve(R?JSON.parse(R):null)}_remove(P){return this.storage.removeItem(P),Promise.resolve()}get storage(){return this.storageRetriever()}}const Pl=(()=>{class j extends vf{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(R,q)=>this.onStorageEvent(R,q),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function ua(){const j=(0,Ne.z$)();return Y(j)||He(j)}()&&function Ln(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=En(),this._shouldAllowMigration=!0}forAllChangedKeys(R){for(const q of Object.keys(this.listeners)){const le=this.storage.getItem(q),_e=this.localCache[q];le!==_e&&R(q,_e,le)}}onStorageEvent(R,q=!1){if(!R.key)return void this.forAllChangedKeys(($t,Tn,ii)=>{this.notifyListeners($t,ii)});const le=R.key;if(q?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const $t=this.storage.getItem(le);if(R.newValue!==$t)null!==R.newValue?this.storage.setItem(le,R.newValue):this.storage.removeItem(le);else if(this.localCache[le]===R.newValue&&!q)return}const _e=()=>{const $t=this.storage.getItem(le);!q&&this.localCache[le]===$t||this.notifyListeners(le,$t)},lt=this.storage.getItem(le);!function _t(){return(0,Ne.w1)()&&10===document.documentMode}()||lt===R.newValue||R.newValue===R.oldValue?_e():setTimeout(_e,10)}notifyListeners(R,q){this.localCache[R]=q;const le=this.listeners[R];if(le)for(const _e of Array.from(le))_e(q&&JSON.parse(q))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((R,q,le)=>{this.onStorageEvent(new StorageEvent("storage",{key:R,oldValue:q,newValue:le}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(R,q){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[R]||(this.listeners[R]=new Set,this.localCache[R]=this.storage.getItem(R)),this.listeners[R].add(q)}_removeListener(R,q){this.listeners[R]&&(this.listeners[R].delete(q),0===this.listeners[R].size&&delete this.listeners[R]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(R,q){var le=()=>super._set,_e=this;return(0,d.Z)(function*(){yield le().call(_e,R,q),_e.localCache[R]=JSON.stringify(q)})()}_get(R){var q=()=>super._get,le=this;return(0,d.Z)(function*(){const _e=yield q().call(le,R);return le.localCache[R]=JSON.stringify(_e),_e})()}_remove(R){var q=()=>super._remove,le=this;return(0,d.Z)(function*(){yield q().call(le,R),delete le.localCache[R]})()}}return j.type="LOCAL",j})(),Ol=(()=>{class j extends vf{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(R,q){}_removeListener(R,q){}}return j.type="SESSION",j})();let Zc=(()=>{class j{constructor(R){this.eventTarget=R,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(R){const q=this.receivers.find(_e=>_e.isListeningto(R));if(q)return q;const le=new j(R);return this.receivers.push(le),le}isListeningto(R){return this.eventTarget===R}handleEvent(R){var q=this;return(0,d.Z)(function*(){const le=R,{eventId:_e,eventType:lt,data:$t}=le.data,Tn=q.handlersMap[lt];if(!Tn?.size)return;le.ports[0].postMessage({status:"ack",eventId:_e,eventType:lt});const ii=Array.from(Tn).map(function(){var po=(0,d.Z)(function*(ga){return ga(le.origin,$t)});return function(ga){return po.apply(this,arguments)}}()),zi=yield function el(j){return Promise.all(j.map(function(){var P=(0,d.Z)(function*(R){try{return{fulfilled:!0,value:yield R}}catch(q){return{fulfilled:!1,reason:q}}});return function(R){return P.apply(this,arguments)}}()))}(ii);le.ports[0].postMessage({status:"done",eventId:_e,eventType:lt,response:zi})})()}_subscribe(R,q){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[R]||(this.handlersMap[R]=new Set),this.handlersMap[R].add(q)}_unsubscribe(R,q){this.handlersMap[R]&&q&&this.handlersMap[R].delete(q),(!q||0===this.handlersMap[R].size)&&delete this.handlersMap[R],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return j.receivers=[],j})();function kl(j="",P=10){let R="";for(let q=0;q<P;q++)R+=Math.floor(10*Math.random());return j+R}class hn{constructor(P){this.target=P,this.handlers=new Set}removeMessageHandler(P){P.messageChannel&&(P.messageChannel.port1.removeEventListener("message",P.onMessage),P.messageChannel.port1.close()),this.handlers.delete(P)}_send(P,R,q=50){var le=this;return(0,d.Z)(function*(){const _e=typeof MessageChannel<"u"?new MessageChannel:null;if(!_e)throw new Error("connection_unavailable");let lt,$t;return new Promise((Tn,ii)=>{const zi=kl("",20);_e.port1.start();const po=setTimeout(()=>{ii(new Error("unsupported_event"))},q);$t={messageChannel:_e,onMessage(ga){const rl=ga;if(rl.data.eventId===zi)switch(rl.data.status){case"ack":clearTimeout(po),lt=setTimeout(()=>{ii(new Error("timeout"))},3e3);break;case"done":clearTimeout(lt),Tn(rl.data.response);break;default:clearTimeout(po),clearTimeout(lt),ii(new Error("invalid_response"))}}},le.handlers.add($t),_e.port1.addEventListener("message",$t.onMessage),le.target.postMessage({eventType:P,eventId:zi,data:R},[_e.port2])}).finally(()=>{$t&&le.removeMessageHandler($t)})})()}}function or(){return window}function Aa(){return typeof or().WorkerGlobalScope<"u"&&"function"==typeof or().importScripts}function tl(){return(tl=(0,d.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Kc="firebaseLocalStorageDb",Xc=1,Pa="firebaseLocalStorage",Ad="fbase_key";class qr{constructor(P){this.request=P}toPromise(){return new Promise((P,R)=>{this.request.addEventListener("success",()=>{P(this.request.result)}),this.request.addEventListener("error",()=>{R(this.request.error)})})}}function Rl(j,P){return j.transaction([Pa],P?"readwrite":"readonly").objectStore(Pa)}function ks(){const j=indexedDB.open(Kc,Xc);return new Promise((P,R)=>{j.addEventListener("error",()=>{R(j.error)}),j.addEventListener("upgradeneeded",()=>{const q=j.result;try{q.createObjectStore(Pa,{keyPath:Ad})}catch(le){R(le)}}),j.addEventListener("success",(0,d.Z)(function*(){const q=j.result;q.objectStoreNames.contains(Pa)?P(q):(q.close(),yield function mh(){const j=indexedDB.deleteDatabase(Kc);return new qr(j).toPromise()}(),P(yield ks()))}))})}function Pd(j,P,R){return Fl.apply(this,arguments)}function Fl(){return(Fl=(0,d.Z)(function*(j,P,R){const q=Rl(j,!0).put({[Ad]:P,value:R});return new qr(q).toPromise()})).apply(this,arguments)}function Od(){return(Od=(0,d.Z)(function*(j,P){const R=Rl(j,!1).get(P),q=yield new qr(R).toPromise();return void 0===q?null:q.value})).apply(this,arguments)}function Oa(j,P){const R=Rl(j,!0).delete(P);return new qr(R).toPromise()}const gh=(()=>{class j{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var R=this;return(0,d.Z)(function*(){return R.db||(R.db=yield ks()),R.db})()}_withRetries(R){var q=this;return(0,d.Z)(function*(){let le=0;for(;;)try{const _e=yield q._openDb();return yield R(_e)}catch(_e){if(le++>3)throw _e;q.db&&(q.db.close(),q.db=void 0)}})()}initializeServiceWorkerMessaging(){var R=this;return(0,d.Z)(function*(){return Aa()?R.initializeReceiver():R.initializeSender()})()}initializeReceiver(){var R=this;return(0,d.Z)(function*(){R.receiver=Zc._getInstance(function ph(){return Aa()?self:null}()),R.receiver._subscribe("keyChanged",function(){var q=(0,d.Z)(function*(le,_e){return{keyProcessed:(yield R._poll()).includes(_e.key)}});return function(le,_e){return q.apply(this,arguments)}}()),R.receiver._subscribe("ping",function(){var q=(0,d.Z)(function*(le,_e){return["keyChanged"]});return function(le,_e){return q.apply(this,arguments)}}())})()}initializeSender(){var R=this;return(0,d.Z)(function*(){var q,le;if(R.activeServiceWorker=yield function Yc(){return tl.apply(this,arguments)}(),!R.activeServiceWorker)return;R.sender=new hn(R.activeServiceWorker);const _e=yield R.sender._send("ping",{},800);_e&&null!==(q=_e[0])&&void 0!==q&&q.fulfilled&&null!==(le=_e[0])&&void 0!==le&&le.value.includes("keyChanged")&&(R.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(R){var q=this;return(0,d.Z)(function*(){if(q.sender&&q.activeServiceWorker&&function Dd(){var j;return(null===(j=navigator?.serviceWorker)||void 0===j?void 0:j.controller)||null}()===q.activeServiceWorker)try{yield q.sender._send("keyChanged",{key:R},q.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,d.Z)(function*(){try{if(!indexedDB)return!1;const R=yield ks();return yield Pd(R,Da,"1"),yield Oa(R,Da),!0}catch{}return!1})()}_withPendingWrite(R){var q=this;return(0,d.Z)(function*(){q.pendingWrites++;try{yield R()}finally{q.pendingWrites--}})()}_set(R,q){var le=this;return(0,d.Z)(function*(){return le._withPendingWrite((0,d.Z)(function*(){return yield le._withRetries(_e=>Pd(_e,R,q)),le.localCache[R]=q,le.notifyServiceWorker(R)}))})()}_get(R){var q=this;return(0,d.Z)(function*(){const le=yield q._withRetries(_e=>function Qc(j,P){return Od.apply(this,arguments)}(_e,R));return q.localCache[R]=le,le})()}_remove(R){var q=this;return(0,d.Z)(function*(){return q._withPendingWrite((0,d.Z)(function*(){return yield q._withRetries(le=>Oa(le,R)),delete q.localCache[R],q.notifyServiceWorker(R)}))})()}_poll(){var R=this;return(0,d.Z)(function*(){const q=yield R._withRetries(lt=>{const $t=Rl(lt,!1).getAll();return new qr($t).toPromise()});if(!q)return[];if(0!==R.pendingWrites)return[];const le=[],_e=new Set;for(const{fbase_key:lt,value:$t}of q)_e.add(lt),JSON.stringify(R.localCache[lt])!==JSON.stringify($t)&&(R.notifyListeners(lt,$t),le.push(lt));for(const lt of Object.keys(R.localCache))R.localCache[lt]&&!_e.has(lt)&&(R.notifyListeners(lt,null),le.push(lt));return le})()}notifyListeners(R,q){this.localCache[R]=q;const le=this.listeners[R];if(le)for(const _e of Array.from(le))_e(q)}startPolling(){var R=this;this.stopPolling(),this.pollTimer=setInterval((0,d.Z)(function*(){return R._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(R,q){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[R]||(this.listeners[R]=new Set,this._get(R)),this.listeners[R].add(q)}_removeListener(R,q){this.listeners[R]&&(this.listeners[R].delete(q),0===this.listeners[R].size&&delete this.listeners[R]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return j.type="LOCAL",j})();function da(){return(da=(0,d.Z)(function*(j){return(yield vn(j,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function xf(j){return new Promise((P,R)=>{const q=document.createElement("script");q.setAttribute("src",j),q.onload=P,q.onerror=le=>{const _e=Xt("internal-error");_e.customData=le,R(_e)},q.type="text/javascript",q.charset="UTF-8",function bf(){var j,P;return null!==(P=null===(j=document.getElementsByTagName("head"))||void 0===j?void 0:j[0])&&void 0!==P?P:document}().appendChild(q)})}function Rd(j){return`__${j}${Math.floor(1e6*Math.random())}`}const Co=1e12;class wf{constructor(P){this.auth=P,this.counter=Co,this._widgets=new Map}render(P,R){const q=this.counter;return this._widgets.set(q,new Cf(P,this.auth.name,R||{})),this.counter++,q}reset(P){var R;const q=P||Co;null===(R=this._widgets.get(q))||void 0===R||R.delete(),this._widgets.delete(q)}getResponse(P){var R;return(null===(R=this._widgets.get(P||Co))||void 0===R?void 0:R.getResponse())||""}execute(P){var R=this;return(0,d.Z)(function*(){var q;return null===(q=R._widgets.get(P||Co))||void 0===q||q.execute(),""})()}}class Cf{constructor(P,R,q){this.params=q,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const le="string"==typeof P?document.getElementById(P):P;tt(le,"argument-error",{appName:R}),this.container=le,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Ef(j){const P=[],R="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let q=0;q<j;q++)P.push(R.charAt(Math.floor(Math.random()*R.length)));return P.join("")}(50);const{callback:P,"expired-callback":R}=this.params;if(P)try{P(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,R)try{R()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const eu=Rd("rcb"),Rs=new en(3e4,6e4);class ka{constructor(){var P;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(P=or().grecaptcha)||void 0===P||!P.render)}load(P,R=""){return tt(function nl(j){return j.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(j)}(R),P,"argument-error"),this.shouldResolveImmediately(R)?Promise.resolve(or().grecaptcha):new Promise((q,le)=>{const _e=or().setTimeout(()=>{le(Xt(P,"network-request-failed"))},Rs.get());or()[eu]=()=>{or().clearTimeout(_e),delete or()[eu];const $t=or().grecaptcha;if(!$t)return void le(Xt(P,"internal-error"));const Tn=$t.render;$t.render=(ii,zi)=>{const po=Tn(ii,zi);return this.counter++,po},this.hostLanguage=R,q($t)},xf(`https://www.google.com/recaptcha/api.js??${(0,Ne.xO)({onload:eu,render:"explicit",hl:R})}`).catch(()=>{clearTimeout(_e),le(Xt(P,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(P){var R;return!(null===(R=or().grecaptcha)||void 0===R||!R.render)&&(P===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class ju{load(P){return(0,d.Z)(function*(){return new wf(P)})()}clearedOneInstance(){}}const mn="recaptcha",Fp={theme:"light",type:"image"};class ha{constructor(P,R=Object.assign({},Fp),q){this.parameters=R,this.type=mn,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=gi(q),this.isInvisible="invisible"===this.parameters.size,tt(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const le="string"==typeof P?document.getElementById(P):P;tt(le,this.auth,"argument-error"),this.container=le,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ju:new ka,this.validateStartingState()}verify(){var P=this;return(0,d.Z)(function*(){P.assertNotDestroyed();const R=yield P.render(),q=P.getAssertedRecaptcha();return q.getResponse(R)||new Promise(_e=>{const lt=$t=>{$t&&(P.tokenChangeListeners.delete(lt),_e($t))};P.tokenChangeListeners.add(lt),P.isInvisible&&q.execute(R)})})()}render(){try{this.assertNotDestroyed()}catch(P){return Promise.reject(P)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(P=>{throw this.renderPromise=null,P})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(P=>{this.container.removeChild(P)})}validateStartingState(){tt(!this.parameters.sitekey,this.auth,"argument-error"),tt(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),tt(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(P){return R=>{if(this.tokenChangeListeners.forEach(q=>q(R)),"function"==typeof P)P(R);else if("string"==typeof P){const q=or()[P];"function"==typeof q&&q(R)}}}assertNotDestroyed(){tt(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var P=this;return(0,d.Z)(function*(){if(yield P.init(),!P.widgetId){let R=P.container;if(!P.isInvisible){const q=document.createElement("div");R.appendChild(q),R=q}P.widgetId=P.getAssertedRecaptcha().render(R,P.parameters)}return P.widgetId})()}init(){var P=this;return(0,d.Z)(function*(){tt(gt()&&!Aa(),P.auth,"internal-error"),yield function xr(){let j=null;return new Promise(P=>{"complete"!==document.readyState?(j=()=>P(),window.addEventListener("load",j)):P()}).catch(P=>{throw j&&window.removeEventListener("load",j),P})}(),P.recaptcha=yield P._recaptchaLoader.load(P.auth,P.auth.languageCode||void 0);const R=yield function Vu(j){return da.apply(this,arguments)}(P.auth);tt(R,P.auth,"internal-error"),P.parameters.sitekey=R})()}getAssertedRecaptcha(){return tt(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class $u{constructor(P,R){this.verificationId=P,this.onConfirmation=R}confirm(P){const R=Ji._fromVerification(this.verificationId,P);return this.onConfirmation(R)}}function Gu(j,P,R){return bh.apply(this,arguments)}function bh(){return(bh=(0,d.Z)(function*(j,P,R){const q=gi(j),le=yield Ra(q,P,(0,Ne.m9)(R));return new $u(le,_e=>Vc(q,_e))})).apply(this,arguments)}function Wm(j,P,R){return Lp.apply(this,arguments)}function Lp(){return(Lp=(0,d.Z)(function*(j,P,R){const q=(0,Ne.m9)(j);yield rc(!1,q,"phone");const le=yield Ra(q.auth,P,(0,Ne.m9)(R));return new $u(le,_e=>Au(q,_e))})).apply(this,arguments)}function Zm(j,P,R){return xh.apply(this,arguments)}function xh(){return(xh=(0,d.Z)(function*(j,P,R){const q=(0,Ne.m9)(j),le=yield Ra(q.auth,P,(0,Ne.m9)(R));return new $u(le,_e=>to(q,_e))})).apply(this,arguments)}function Ra(j,P,R){return wh.apply(this,arguments)}function wh(){return wh=(0,d.Z)(function*(j,P,R){var q;const le=yield R.verify();try{let _e;if(tt("string"==typeof le,j,"argument-error"),tt(R.type===mn,j,"argument-error"),_e="string"==typeof P?{phoneNumber:P}:P,"session"in _e){const lt=_e.session;if("phoneNumber"in _e)return tt("enroll"===lt.type,j,"internal-error"),(yield function Lu(j,P){return vn(j,"POST","/v2/accounts/mfaEnrollment:start",zn(j,P))}(j,{idToken:lt.credential,phoneEnrollmentInfo:{phoneNumber:_e.phoneNumber,recaptchaToken:le}})).phoneSessionInfo.sessionInfo;{tt("signin"===lt.type,j,"internal-error");const $t=(null===(q=_e.multiFactorHint)||void 0===q?void 0:q.uid)||_e.multiFactorUid;return tt($t,j,"missing-multi-factor-info"),(yield function _h(j,P){return vn(j,"POST","/v2/accounts/mfaSignIn:start",zn(j,P))}(j,{mfaPendingCredential:lt.credential,mfaEnrollmentId:$t,phoneSignInInfo:{recaptchaToken:le}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:lt}=yield function xp(j,P){return Zo.apply(this,arguments)}(j,{phoneNumber:_e.phoneNumber,recaptchaToken:le});return lt}}finally{R._reset()}}),wh.apply(this,arguments)}function Ch(j,P){return no.apply(this,arguments)}function no(){return(no=(0,d.Z)(function*(j,P){yield Du((0,Ne.m9)(j),P)})).apply(this,arguments)}let Tf=(()=>{class j{constructor(R){this.providerId=j.PROVIDER_ID,this.auth=gi(R)}verifyPhoneNumber(R,q){return Ra(this.auth,R,(0,Ne.m9)(q))}static credential(R,q){return Ji._fromVerification(R,q)}static credentialFromResult(R){return j.credentialFromTaggedObject(R)}static credentialFromError(R){return j.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R)return null;const{phoneNumber:q,temporaryProof:le}=R;return q&&le?Ji._fromTokenResponse(q,le):null}}return j.PROVIDER_ID="phone",j.PHONE_SIGN_IN_METHOD="phone",j})();function fa(j,P){return P?an(P):(tt(j._popupRedirectResolver,j,"argument-error"),j._popupRedirectResolver)}class Eh extends Ao{constructor(P){super("custom","custom"),this.params=P}_getIdTokenResponse(P){return bo(P,this._buildIdpRequest())}_linkToIdToken(P,R){return bo(P,this._buildIdpRequest(R))}_getReauthenticationResolver(P){return bo(P,this._buildIdpRequest())}_buildIdpRequest(P){const R={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return P&&(R.idToken=P),R}}function pa(j){return wd(j.auth,new Eh(j),j.bypassAuthState)}function tu(j){const{auth:P,user:R}=j;return tt(R,P,"internal-error"),oc(R,new Eh(j),j.bypassAuthState)}function Np(j){return nu.apply(this,arguments)}function nu(){return(nu=(0,d.Z)(function*(j){const{auth:P,user:R}=j;return tt(R,P,"internal-error"),Du(R,new Eh(j),j.bypassAuthState)})).apply(this,arguments)}class Hu{constructor(P,R,q,le,_e=!1){this.auth=P,this.resolver=q,this.user=le,this.bypassAuthState=_e,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(R)?R:[R]}execute(){var P=this;return new Promise(function(){var R=(0,d.Z)(function*(q,le){P.pendingPromise={resolve:q,reject:le};try{P.eventManager=yield P.resolver._initialize(P.auth),yield P.onExecution(),P.eventManager.registerConsumer(P)}catch(_e){P.reject(_e)}});return function(q,le){return R.apply(this,arguments)}}())}onAuthEvent(P){var R=this;return(0,d.Z)(function*(){const{urlResponse:q,sessionId:le,postBody:_e,tenantId:lt,error:$t,type:Tn}=P;if($t)return void R.reject($t);const ii={auth:R.auth,requestUri:q,sessionId:le,tenantId:lt||void 0,postBody:_e||void 0,user:R.user,bypassAuthState:R.bypassAuthState};try{R.resolve(yield R.getIdpTask(Tn)(ii))}catch(zi){R.reject(zi)}})()}onError(P){this.reject(P)}getIdpTask(P){switch(P){case"signInViaPopup":case"signInViaRedirect":return pa;case"linkViaPopup":case"linkViaRedirect":return Np;case"reauthViaPopup":case"reauthViaRedirect":return tu;default:Jt(this.auth,"internal-error")}}resolve(P){zt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(P),this.unregisterAndCleanUp()}reject(P){zt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(P),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Th=new en(2e3,1e4);function Ym(j,P,R){return Fd.apply(this,arguments)}function Fd(){return(Fd=(0,d.Z)(function*(j,P,R){const q=gi(j);Pt(j,P,Zs);const le=fa(q,R);return new g(q,"signInViaPopup",P,le).executeNotNull()})).apply(this,arguments)}function zp(j,P,R){return Mi.apply(this,arguments)}function Mi(){return(Mi=(0,d.Z)(function*(j,P,R){const q=(0,Ne.m9)(j);Pt(q.auth,P,Zs);const le=fa(q.auth,R);return new g(q.auth,"reauthViaPopup",P,le,q).executeNotNull()})).apply(this,arguments)}function v(j,P,R){return c.apply(this,arguments)}function c(){return(c=(0,d.Z)(function*(j,P,R){const q=(0,Ne.m9)(j);Pt(q.auth,P,Zs);const le=fa(q.auth,R);return new g(q.auth,"linkViaPopup",P,le,q).executeNotNull()})).apply(this,arguments)}let g=(()=>{class j extends Hu{constructor(R,q,le,_e,lt){super(R,q,_e,lt),this.provider=le,this.authWindow=null,this.pollId=null,j.currentPopupAction&&j.currentPopupAction.cancel(),j.currentPopupAction=this}executeNotNull(){var R=this;return(0,d.Z)(function*(){const q=yield R.execute();return tt(q,R.auth,"internal-error"),q})()}onExecution(){var R=this;return(0,d.Z)(function*(){zt(1===R.filter.length,"Popup operations only handle one event");const q=kl();R.authWindow=yield R.resolver._openPopup(R.auth,R.provider,R.filter[0],q),R.authWindow.associatedEvent=q,R.resolver._originValidation(R.auth).catch(le=>{R.reject(le)}),R.resolver._isIframeWebStorageSupported(R.auth,le=>{le||R.reject(Xt(R.auth,"web-storage-unsupported"))}),R.pollUserCancellation()})()}get eventId(){var R;return(null===(R=this.authWindow)||void 0===R?void 0:R.associatedEvent)||null}cancel(){this.reject(Xt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,j.currentPopupAction=null}pollUserCancellation(){const R=()=>{var q,le;this.pollId=null!==(le=null===(q=this.authWindow)||void 0===q?void 0:q.window)&&void 0!==le&&le.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Xt(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(R,Th.get())};R()}}return j.currentPopupAction=null,j})();const C="pendingRedirect",S=new Map;class D extends Hu{constructor(P,R,q=!1){super(P,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],R,void 0,q),this.eventId=null}execute(){var P=()=>super.execute,R=this;return(0,d.Z)(function*(){let q=S.get(R.auth._key());if(!q){try{const _e=(yield function L(j,P){return B.apply(this,arguments)}(R.resolver,R.auth))?yield P().call(R):null;q=()=>Promise.resolve(_e)}catch(le){q=()=>Promise.reject(le)}S.set(R.auth._key(),q)}return R.bypassAuthState||S.set(R.auth._key(),()=>Promise.resolve(null)),q()})()}onAuthEvent(P){var R=()=>super.onAuthEvent,q=this;return(0,d.Z)(function*(){if("signInViaRedirect"===P.type)return R().call(q,P);if("unknown"!==P.type){if(P.eventId){const le=yield q.auth._redirectUserForId(P.eventId);if(le)return q.user=le,R().call(q,P);q.resolve(null)}}else q.resolve(null)})()}onExecution(){return(0,d.Z)(function*(){})()}cleanUp(){}}function B(){return(B=(0,d.Z)(function*(j,P){const R=ge(P),q=de(j);if(!(yield q._isAvailable()))return!1;const le="true"===(yield q._get(R));return yield q._remove(R),le})).apply(this,arguments)}function G(j,P){return J.apply(this,arguments)}function J(){return(J=(0,d.Z)(function*(j,P){return de(j)._set(ge(P),"true")})).apply(this,arguments)}function ee(){S.clear()}function oe(j,P){S.set(j._key(),P)}function de(j){return an(j._redirectPersistence)}function ge(j){return ze(C,j.config.apiKey,j.name)}function ue(j,P,R){return function ye(j,P,R){return be.apply(this,arguments)}(j,P,R)}function be(){return(be=(0,d.Z)(function*(j,P,R){const q=gi(j);Pt(j,P,Zs),yield q._initializationPromise;const le=fa(q,R);return yield G(le,q),le._openRedirect(q,P,"signInViaRedirect")})).apply(this,arguments)}function ce(j,P,R){return function Te(j,P,R){return ve.apply(this,arguments)}(j,P,R)}function ve(){return(ve=(0,d.Z)(function*(j,P,R){const q=(0,Ne.m9)(j);Pt(q.auth,P,Zs),yield q.auth._initializationPromise;const le=fa(q.auth,R);yield G(le,q.auth);const _e=yield Ut(q);return le._openRedirect(q.auth,P,"reauthViaRedirect",_e)})).apply(this,arguments)}function De(j,P,R){return function Fe(j,P,R){return Re.apply(this,arguments)}(j,P,R)}function Re(){return(Re=(0,d.Z)(function*(j,P,R){const q=(0,Ne.m9)(j);Pt(q.auth,P,Zs),yield q.auth._initializationPromise;const le=fa(q.auth,R);yield rc(!1,q,P.providerId),yield G(le,q.auth);const _e=yield Ut(q);return le._openRedirect(q.auth,P,"linkViaRedirect",_e)})).apply(this,arguments)}function Ue(j,P){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,d.Z)(function*(j,P){return yield gi(j)._initializationPromise,nt(j,P,!1)})).apply(this,arguments)}function nt(j,P){return ot.apply(this,arguments)}function ot(){return(ot=(0,d.Z)(function*(j,P,R=!1){const q=gi(j),le=fa(q,P),lt=yield new D(q,le,R).execute();return lt&&!R&&(delete lt.user._redirectEventId,yield q._persistUserIfCurrent(lt.user),yield q._setRedirectUser(null,P)),lt})).apply(this,arguments)}function Ut(j){return Qe.apply(this,arguments)}function Qe(){return(Qe=(0,d.Z)(function*(j){const P=kl(`${j.uid}:::`);return j._redirectEventId=P,yield j.auth._setRedirectUser(j),yield j.auth._persistUserIfCurrent(j),P})).apply(this,arguments)}class at{constructor(P){this.auth=P,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(P){this.consumers.add(P),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,P)&&(this.sendToConsumer(this.queuedRedirectEvent,P),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(P){this.consumers.delete(P)}onEvent(P){if(this.hasEventBeenHandled(P))return!1;let R=!1;return this.consumers.forEach(q=>{this.isEventForConsumer(P,q)&&(R=!0,this.sendToConsumer(P,q),this.saveEventToCache(P))}),this.hasHandledPotentialRedirect||!function qe(j){switch(j.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return et(j);default:return!1}}(P)||(this.hasHandledPotentialRedirect=!0,R||(this.queuedRedirectEvent=P,R=!0)),R}sendToConsumer(P,R){var q;if(P.error&&!et(P)){const le=(null===(q=P.error.code)||void 0===q?void 0:q.split("auth/")[1])||"internal-error";R.onError(Xt(this.auth,le))}else R.onAuthEvent(P)}isEventForConsumer(P,R){const q=null===R.eventId||!!P.eventId&&P.eventId===R.eventId;return R.filter.includes(P.type)&&q}hasEventBeenHandled(P){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ot(P))}saveEventToCache(P){this.cachedEventUids.add(Ot(P)),this.lastProcessedEventTime=Date.now()}}function Ot(j){return[j.type,j.eventId,j.sessionId,j.tenantId].filter(P=>P).join("-")}function et({type:j,error:P}){return"unknown"===j&&"auth/no-auth-event"===P?.code}function Xe(j){return Mt.apply(this,arguments)}function Mt(){return(Mt=(0,d.Z)(function*(j,P={}){return vn(j,"GET","/v1/projects",P)})).apply(this,arguments)}const Lt=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dn=/^https?/;function gn(){return(gn=(0,d.Z)(function*(j){if(j.config.emulator)return;const{authorizedDomains:P}=yield Xe(j);for(const R of P)try{if(Yt(R))return}catch{}Jt(j,"unauthorized-domain")})).apply(this,arguments)}function Yt(j){const P=mt(),{protocol:R,hostname:q}=new URL(P);if(j.startsWith("chrome-extension://")){const lt=new URL(j);return""===lt.hostname&&""===q?"chrome-extension:"===R&&j.replace("chrome-extension://","")===P.replace("chrome-extension://",""):"chrome-extension:"===R&&lt.hostname===q}if(!dn.test(R))return!1;if(Lt.test(j))return q===j;const le=j.replace(/\./g,"\\.");return new RegExp("^(.+\\."+le+"|"+le+")$","i").test(q)}const yn=new en(3e4,6e4);function xi(){const j=or().___jsl;if(j?.H)for(const P of Object.keys(j.H))if(j.H[P].r=j.H[P].r||[],j.H[P].L=j.H[P].L||[],j.H[P].r=[...j.H[P].L],j.CP)for(let R=0;R<j.CP.length;R++)j.CP[R]=null}let er=null;const sr=new en(5e3,15e3),vi="__/auth/iframe",Mr="emulator/auth/iframe",Ys={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Gs=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fa(j){const P=j.config;tt(P.authDomain,j,"auth-domain-config-required");const R=P.emulator?wn(P,Mr):`https://${j.config.authDomain}/${vi}`,q={apiKey:P.apiKey,appName:j.name,v:Me.SDK_VERSION},le=Gs.get(j.config.apiHost);le&&(q.eid=le);const _e=j._getFrameworks();return _e.length&&(q.fw=_e.join(",")),`${R}?${(0,Ne.xO)(q).slice(1)}`}function ar(){return ar=(0,d.Z)(function*(j){const P=yield function Fi(j){return er=er||function Bn(j){return new Promise((P,R)=>{var q,le,_e;function lt(){xi(),gapi.load("gapi.iframes",{callback:()=>{P(gapi.iframes.getContext())},ontimeout:()=>{xi(),R(Xt(j,"network-request-failed"))},timeout:yn.get()})}if(null!==(le=null===(q=or().gapi)||void 0===q?void 0:q.iframes)&&void 0!==le&&le.Iframe)P(gapi.iframes.getContext());else{if(null===(_e=or().gapi)||void 0===_e||!_e.load){const $t=Rd("iframefcb");return or()[$t]=()=>{gapi.load?lt():R(Xt(j,"network-request-failed"))},xf(`https://apis.google.com/js/api.js?onload=${$t}`).catch(Tn=>R(Tn))}lt()}}).catch(P=>{throw er=null,P})}(j),er}(j),R=or().gapi;return tt(R,j,"internal-error"),P.open({where:document.body,url:Fa(j),messageHandlersFilter:R.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ys,dontclear:!0},q=>new Promise(function(){var le=(0,d.Z)(function*(_e,lt){yield q.restyle({setHideOnLeave:!1});const $t=Xt(j,"network-request-failed"),Tn=or().setTimeout(()=>{lt($t)},sr.get());function ii(){or().clearTimeout(Tn),_e(q)}q.ping(ii).then(ii,()=>{lt($t)})});return function(_e,lt){return le.apply(this,arguments)}}()))}),ar.apply(this,arguments)}const Ki={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Fr=500,Xn=600,Li="_blank",xs="http://localhost";class ho{constructor(P){this.window=P,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const Wr="__/auth/handler",Ks="emulator/auth/handler";function ma(j,P,R,q,le,_e){tt(j.config.authDomain,j,"auth-domain-config-required"),tt(j.config.apiKey,j,"invalid-api-key");const lt={apiKey:j.config.apiKey,appName:j.name,authType:R,redirectUrl:q,v:Me.SDK_VERSION,eventId:le};if(P instanceof Zs){P.setDefaultLanguage(j.languageCode),lt.providerId=P.providerId||"",(0,Ne.xb)(P.getCustomParameters())||(lt.customParameters=JSON.stringify(P.getCustomParameters()));for(const[Tn,ii]of Object.entries(_e||{}))lt[Tn]=ii}if(P instanceof $s){const Tn=P.getScopes().filter(ii=>""!==ii);Tn.length>0&&(lt.scopes=Tn.join(","))}j.tenantId&&(lt.tid=j.tenantId);const $t=lt;for(const Tn of Object.keys($t))void 0===$t[Tn]&&delete $t[Tn];return`${function Ll({config:j}){return j.emulator?wn(j,Ks):`https://${j.authDomain}/${Wr}`}(j)}?${(0,Ne.xO)($t).slice(1)}`}const il="webStorageSupport",hc=class fo{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ol,this._completeRedirectFn=nt,this._overrideRedirectResult=oe}_openPopup(P,R,q,le){var _e=this;return(0,d.Z)(function*(){var lt;zt(null===(lt=_e.eventManagers[P._key()])||void 0===lt?void 0:lt.manager,"_initialize() not called before _openPopup()");const $t=ma(P,R,q,mt(),le);return function dc(j,P,R,q=Fr,le=Xn){const _e=Math.max((window.screen.availHeight-le)/2,0).toString(),lt=Math.max((window.screen.availWidth-q)/2,0).toString();let $t="";const Tn=Object.assign(Object.assign({},Ki),{width:q.toString(),height:le.toString(),top:_e,left:lt}),ii=(0,Ne.z$)().toLowerCase();R&&($t=se(ii)?Li:R),H(ii)&&(P=P||xs,Tn.scrollbars="yes");const zi=Object.entries(Tn).reduce((ga,[rl,ol])=>`${ga}${rl}=${ol},`,"");if(function jt(j=(0,Ne.z$)()){var P;return He(j)&&!(null===(P=window.navigator)||void 0===P||!P.standalone)}(ii)&&"_self"!==$t)return function iu(j,P){const R=document.createElement("a");R.href=j,R.target=P;const q=document.createEvent("MouseEvent");q.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),R.dispatchEvent(q)}(P||"",$t),new ho(null);const po=window.open(P||"",$t,zi);tt(po,j,"popup-blocked");try{po.focus()}catch{}return new ho(po)}(P,$t,kl())})()}_openRedirect(P,R,q,le){var _e=this;return(0,d.Z)(function*(){return yield _e._originValidation(P),function Md(j){or().location.href=j}(ma(P,R,q,mt(),le)),new Promise(()=>{})})()}_initialize(P){const R=P._key();if(this.eventManagers[R]){const{manager:le,promise:_e}=this.eventManagers[R];return le?Promise.resolve(le):(zt(_e,"If manager is not set, promise should be"),_e)}const q=this.initAndGetManager(P);return this.eventManagers[R]={promise:q},q.catch(()=>{delete this.eventManagers[R]}),q}initAndGetManager(P){var R=this;return(0,d.Z)(function*(){const q=yield function Er(j){return ar.apply(this,arguments)}(P),le=new at(P);return q.register("authEvent",_e=>(tt(_e?.authEvent,P,"invalid-auth-event"),{status:le.onEvent(_e.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),R.eventManagers[P._key()]={manager:le},R.iframes[P._key()]=q,le})()}_isIframeWebStorageSupported(P,R){this.iframes[P._key()].send(il,{type:il},le=>{var _e;const lt=null===(_e=le?.[0])||void 0===_e?void 0:_e[il];void 0!==lt&&R(!!lt),Jt(P,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(P){const R=P._key();return this.originValidationPromises[R]||(this.originValidationPromises[R]=function Yn(j){return gn.apply(this,arguments)}(P)),this.originValidationPromises[R]}get _shouldInitProactively(){return En()||Y()||He()}};class hs{constructor(P){this.factorId=P}_process(P,R,q){switch(R.type){case"enroll":return this._finalizeEnroll(P,R.credential,q);case"signin":return this._finalizeSignIn(P,R.credential);default:return pt("unexpected MultiFactorSessionType")}}}class Ih extends hs{constructor(P){super("phone"),this.credential=P}static _fromCredential(P){return new Ih(P)}_finalizeEnroll(P,R,q){return function lc(j,P){return vn(j,"POST","/v2/accounts/mfaEnrollment:finalize",zn(j,P))}(P,{idToken:R,displayName:q,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(P,R){return function yh(j,P){return vn(j,"POST","/v2/accounts/mfaSignIn:finalize",zn(j,P))}(P,{mfaPendingCredential:R,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Bp=(()=>{class j{constructor(){}static assertion(R){return Ih._fromCredential(R)}}return j.FACTOR_ID="phone",j})();var If="@firebase/auth";class Mh{constructor(P){this.auth=P,this.internalListeners=new Map}getUid(){var P;return this.assertAuthConfigured(),(null===(P=this.auth.currentUser)||void 0===P?void 0:P.uid)||null}getToken(P){var R=this;return(0,d.Z)(function*(){return R.assertAuthConfigured(),yield R.auth._initializationPromise,R.auth.currentUser?{accessToken:yield R.auth.currentUser.getIdToken(P)}:null})()}addAuthTokenListener(P){if(this.assertAuthConfigured(),this.internalListeners.has(P))return;const R=this.auth.onIdTokenChanged(q=>{P(q?.stsTokenManager.accessToken||null)});this.internalListeners.set(P,R),this.updateProactiveRefresh()}removeAuthTokenListener(P){this.assertAuthConfigured();const R=this.internalListeners.get(P);R&&(this.internalListeners.delete(P),R(),this.updateProactiveRefresh())}assertAuthConfigured(){tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const S_=(0,Ne.Pz)("authIdTokenMaxAge")||300;let fc=null;const Km=j=>function(){var P=(0,d.Z)(function*(R){const q=R&&(yield R.getIdTokenResult()),le=q&&((new Date).getTime()-Date.parse(q.issuedAtTime))/1e3;if(le&&le>S_)return;const _e=q?.token;fc!==_e&&(fc=_e,yield fetch(j,{method:_e?"POST":"DELETE",headers:_e?{Authorization:`Bearer ${_e}`}:{}}))});return function(R){return P.apply(this,arguments)}}();function Zu(j=(0,Me.getApp)()){const P=(0,Me._getProvider)(j,"auth");if(P.isInitialized())return P.getImmediate();const R=function oi(j,P){const R=(0,Me._getProvider)(j,"auth");if(R.isInitialized()){const le=R.getImmediate(),_e=R.getOptions();if((0,Ne.vZ)(_e,P??{}))return le;Jt(le,"already-initialized")}return R.initialize({options:P})}(j,{popupRedirectResolver:hc,persistence:[gh,Pl,Ol]}),q=(0,Ne.Pz)("authTokenSyncURL");if(q){const _e=Km(q);(function gf(j,P,R){(0,Ne.m9)(j).beforeAuthStateChanged(P,R)})(R,_e,()=>_e(R.currentUser)),function Hm(j,P,R,q){(0,Ne.m9)(j).onIdTokenChanged(P,R,q)}(R,lt=>_e(lt))}const le=(0,Ne.q4)("auth");return le&&hr(R,`http://${le}`),R}!function Wi(j){(0,Me._registerComponent)(new ft.wA("auth",(P,{options:R})=>{const q=P.getProvider("app").getImmediate(),le=P.getProvider("heartbeat"),{apiKey:_e,authDomain:lt}=q.options;return(($t,Tn)=>{tt(_e&&!_e.includes(":"),"invalid-api-key",{appName:$t.name}),tt(!lt?.includes(":"),"argument-error",{appName:$t.name});const ii={apiKey:_e,authDomain:lt,clientPlatform:j,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Fn(j)},zi=new Ci($t,Tn,ii);return function On(j,P){const R=P?.persistence||[],q=(Array.isArray(R)?R:[R]).map(an);P?.errorMap&&j._updateErrorMap(P.errorMap),j._initializeWithPersistence(q,P?.popupRedirectResolver)}(zi,R),zi})(q,le)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((P,R,q)=>{P.getProvider("auth-internal").initialize()})),(0,Me._registerComponent)(new ft.wA("auth-internal",P=>{const R=gi(P.getProvider("auth").getImmediate());return new Mh(R)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,Me.registerVersion)(If,"0.22.0",function Wu(j){switch(j){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(j)),(0,Me.registerVersion)(If,"0.22.0","esm2017")}("Browser")},2090:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{$s:()=>Zn,BH:()=>Pt,DV:()=>Ds,G6:()=>Ht,GJ:()=>Ms,L:()=>It,LL:()=>qn,P0:()=>Jt,Pz:()=>Ct,Sg:()=>un,UG:()=>zt,UI:()=>Ir,US:()=>ft,Wl:()=>Pi,Yr:()=>Dt,ZB:()=>Ke,ZR:()=>rr,aH:()=>Xt,b$:()=>oi,cI:()=>Qi,dS:()=>Vs,eu:()=>en,g5:()=>Me,gK:()=>Do,gQ:()=>cs,h$:()=>yt,hl:()=>nn,hu:()=>Ne,jU:()=>Bt,m9:()=>Qr,ne:()=>pi,p$:()=>je,pd:()=>$r,q4:()=>Ft,r3:()=>so,ru:()=>an,tV:()=>Ve,uI:()=>pt,ug:()=>Ei,vZ:()=>jr,w1:()=>mt,w9:()=>oo,xO:()=>ls,xb:()=>_s,z$:()=>tt,zI:()=>wn,zd:()=>vo});const d={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Ne=function(ze,ne){if(!ze)throw Me(ne)},Me=function(ze){return new Error("Firebase Database ("+d.SDK_VERSION+") INTERNAL ASSERT FAILED: "+ze)},_=function(ze){const ne=[];let $=0;for(let H=0;H<ze.length;H++){let Y=ze.charCodeAt(H);Y<128?ne[$++]=Y:Y<2048?(ne[$++]=Y>>6|192,ne[$++]=63&Y|128):55296==(64512&Y)&&H+1<ze.length&&56320==(64512&ze.charCodeAt(H+1))?(Y=65536+((1023&Y)<<10)+(1023&ze.charCodeAt(++H)),ne[$++]=Y>>18|240,ne[$++]=Y>>12&63|128,ne[$++]=Y>>6&63|128,ne[$++]=63&Y|128):(ne[$++]=Y>>12|224,ne[$++]=Y>>6&63|128,ne[$++]=63&Y|128)}return ne},ft={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(ze,ne){if(!Array.isArray(ze))throw Error("encodeByteArray takes an array as a parameter");this.init_();const $=ne?this.byteToCharMapWebSafe_:this.byteToCharMap_,H=[];for(let Y=0;Y<ze.length;Y+=3){const se=ze[Y],fe=Y+1<ze.length,Oe=fe?ze[Y+1]:0,Be=Y+2<ze.length,Pe=Be?ze[Y+2]:0;let jt=(15&Oe)<<2|Pe>>6,_t=63&Pe;Be||(_t=64,fe||(jt=64)),H.push($[se>>2],$[(3&se)<<4|Oe>>4],$[jt],$[_t])}return H.join("")},encodeString(ze,ne){return this.HAS_NATIVE_SUPPORT&&!ne?btoa(ze):this.encodeByteArray(_(ze),ne)},decodeString(ze,ne){return this.HAS_NATIVE_SUPPORT&&!ne?atob(ze):function(ze){const ne=[];let $=0,H=0;for(;$<ze.length;){const Y=ze[$++];if(Y<128)ne[H++]=String.fromCharCode(Y);else if(Y>191&&Y<224){const se=ze[$++];ne[H++]=String.fromCharCode((31&Y)<<6|63&se)}else if(Y>239&&Y<365){const Be=((7&Y)<<18|(63&ze[$++])<<12|(63&ze[$++])<<6|63&ze[$++])-65536;ne[H++]=String.fromCharCode(55296+(Be>>10)),ne[H++]=String.fromCharCode(56320+(1023&Be))}else{const se=ze[$++],fe=ze[$++];ne[H++]=String.fromCharCode((15&Y)<<12|(63&se)<<6|63&fe)}}return ne.join("")}(this.decodeStringToByteArray(ze,ne))},decodeStringToByteArray(ze,ne){this.init_();const $=ne?this.charToByteMapWebSafe_:this.charToByteMap_,H=[];for(let Y=0;Y<ze.length;){const se=$[ze.charAt(Y++)],Oe=Y<ze.length?$[ze.charAt(Y)]:0;++Y;const Pe=Y<ze.length?$[ze.charAt(Y)]:64;++Y;const it=Y<ze.length?$[ze.charAt(Y)]:64;if(++Y,null==se||null==Oe||null==Pe||null==it)throw new on;H.push(se<<2|Oe>>4),64!==Pe&&(H.push(Oe<<4&240|Pe>>2),64!==it&&H.push(Pe<<6&192|it))}return H},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let ze=0;ze<this.ENCODED_VALS.length;ze++)this.byteToCharMap_[ze]=this.ENCODED_VALS.charAt(ze),this.charToByteMap_[this.byteToCharMap_[ze]]=ze,this.byteToCharMapWebSafe_[ze]=this.ENCODED_VALS_WEBSAFE.charAt(ze),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[ze]]=ze,ze>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(ze)]=ze,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(ze)]=ze)}}};class on extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yt=function(ze){const ne=_(ze);return ft.encodeByteArray(ne,!0)},It=function(ze){return yt(ze).replace(/\./g,"")},Ve=function(ze){try{return ft.decodeString(ze,!0)}catch(ne){console.error("base64Decode failed: ",ne)}return null};function je(ze){return Ke(void 0,ze)}function Ke(ze,ne){if(!(ne instanceof Object))return ne;switch(ne.constructor){case Date:return new Date(ne.getTime());case Object:void 0===ze&&(ze={});break;case Array:ze=[];break;default:return ne}for(const $ in ne)!ne.hasOwnProperty($)||!pn($)||(ze[$]=Ke(ze[$],ne[$]));return ze}function pn(ze){return"__proto__"!==ze}const Ye=()=>{try{return function tn(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const ze=process.env.__FIREBASE_DEFAULTS__;return ze?JSON.parse(ze):void 0})()||(()=>{if(typeof document>"u")return;let ze;try{ze=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const ne=ze&&Ve(ze[1]);return ne&&JSON.parse(ne)})()}catch(ze){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${ze}`)}},Ft=ze=>{var ne,$;return null===($=null===(ne=Ye())||void 0===ne?void 0:ne.emulatorHosts)||void 0===$?void 0:$[ze]},Jt=ze=>{const ne=Ft(ze);if(!ne)return;const $=ne.lastIndexOf(":");if($<=0||$+1===ne.length)throw new Error(`Invalid host ${ne} with no separate hostname and port!`);const H=parseInt(ne.substring($+1),10);return"["===ne[0]?[ne.substring(1,$-1),H]:[ne.substring(0,$),H]},Xt=()=>{var ze;return null===(ze=Ye())||void 0===ze?void 0:ze.config},Ct=ze=>{var ne;return null===(ne=Ye())||void 0===ne?void 0:ne[`_${ze}`]};class Pt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((ne,$)=>{this.resolve=ne,this.reject=$})}wrapCallback(ne){return($,H)=>{$?this.reject($):this.resolve(H),"function"==typeof ne&&(this.promise.catch(()=>{}),1===ne.length?ne($):ne($,H))}}}function un(ze,ne){if(ze.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const H=ne||"demo-project",Y=ze.iat||0,se=ze.sub||ze.user_id;if(!se)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const fe=Object.assign({iss:`https://securetoken.google.com/${H}`,aud:H,iat:Y,exp:Y+3600,auth_time:Y,sub:se,user_id:se,firebase:{sign_in_provider:"custom",identities:{}}},ze);return[It(JSON.stringify({alg:"none",type:"JWT"})),It(JSON.stringify(fe)),""].join(".")}function tt(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function pt(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tt())}function zt(){var ze;const ne=null===(ze=Ye())||void 0===ze?void 0:ze.forceEnvironment;if("node"===ne)return!0;if("browser"===ne)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function Bt(){return"object"==typeof self&&self.self===self}function an(){const ze="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof ze&&void 0!==ze.id}function oi(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function mt(){const ze=tt();return ze.indexOf("MSIE ")>=0||ze.indexOf("Trident/")>=0}function Dt(){return!0===d.NODE_CLIENT||!0===d.NODE_ADMIN}function Ht(){return!zt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nn(){try{return"object"==typeof indexedDB}catch{return!1}}function en(){return new Promise((ze,ne)=>{try{let $=!0;const H="validate-browser-context-for-indexeddb-analytics-module",Y=self.indexedDB.open(H);Y.onsuccess=()=>{Y.result.close(),$||self.indexedDB.deleteDatabase(H),ze(!0)},Y.onupgradeneeded=()=>{$=!1},Y.onerror=()=>{var se;ne((null===(se=Y.error)||void 0===se?void 0:se.message)||"")}}catch($){ne($)}})}function wn(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class rr extends Error{constructor(ne,$,H){super($),this.code=ne,this.customData=H,this.name="FirebaseError",Object.setPrototypeOf(this,rr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qn.prototype.create)}}class qn{constructor(ne,$,H){this.service=ne,this.serviceName=$,this.errors=H}create(ne,...$){const H=$[0]||{},Y=`${this.service}/${ne}`,se=this.errors[ne],fe=se?function zn(ze,ne){return ze.replace(vn,($,H)=>{const Y=ne[H];return null!=Y?String(Y):`<${H}?>`})}(se,H):"Error";return new rr(Y,`${this.serviceName}: ${fe} (${Y}).`,H)}}const vn=/\{\$([^}]+)}/g;function Qi(ze){return JSON.parse(ze)}function Pi(ze){return JSON.stringify(ze)}const dr=function(ze){let ne={},$={},H={},Y="";try{const se=ze.split(".");ne=Qi(Ve(se[0])||""),$=Qi(Ve(se[1])||""),Y=se[2],H=$.d||{},delete $.d}catch{}return{header:ne,claims:$,data:H,signature:Y}},oo=function(ze){const $=dr(ze).claims;return!!$&&"object"==typeof $&&$.hasOwnProperty("iat")},Ms=function(ze){const ne=dr(ze).claims;return"object"==typeof ne&&!0===ne.admin};function so(ze,ne){return Object.prototype.hasOwnProperty.call(ze,ne)}function Ds(ze,ne){if(Object.prototype.hasOwnProperty.call(ze,ne))return ze[ne]}function _s(ze){for(const ne in ze)if(Object.prototype.hasOwnProperty.call(ze,ne))return!1;return!0}function Ir(ze,ne,$){const H={};for(const Y in ze)Object.prototype.hasOwnProperty.call(ze,Y)&&(H[Y]=ne.call($,ze[Y],Y,ze));return H}function jr(ze,ne){if(ze===ne)return!0;const $=Object.keys(ze),H=Object.keys(ne);for(const Y of $){if(!H.includes(Y))return!1;const se=ze[Y],fe=ne[Y];if(In(se)&&In(fe)){if(!jr(se,fe))return!1}else if(se!==fe)return!1}for(const Y of H)if(!$.includes(Y))return!1;return!0}function In(ze){return null!==ze&&"object"==typeof ze}function ls(ze){const ne=[];for(const[$,H]of Object.entries(ze))Array.isArray(H)?H.forEach(Y=>{ne.push(encodeURIComponent($)+"="+encodeURIComponent(Y))}):ne.push(encodeURIComponent($)+"="+encodeURIComponent(H));return ne.length?"&"+ne.join("&"):""}function vo(ze){const ne={};return ze.replace(/^\?/,"").split("&").forEach(H=>{if(H){const[Y,se]=H.split("=");ne[decodeURIComponent(Y)]=decodeURIComponent(se)}}),ne}function $r(ze){const ne=ze.indexOf("?");if(!ne)return"";const $=ze.indexOf("#",ne);return ze.substring(ne,$>0?$:void 0)}class cs{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let ne=1;ne<this.blockSize;++ne)this.pad_[ne]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(ne,$){$||($=0);const H=this.W_;if("string"==typeof ne)for(let it=0;it<16;it++)H[it]=ne.charCodeAt($)<<24|ne.charCodeAt($+1)<<16|ne.charCodeAt($+2)<<8|ne.charCodeAt($+3),$+=4;else for(let it=0;it<16;it++)H[it]=ne[$]<<24|ne[$+1]<<16|ne[$+2]<<8|ne[$+3],$+=4;for(let it=16;it<80;it++){const jt=H[it-3]^H[it-8]^H[it-14]^H[it-16];H[it]=4294967295&(jt<<1|jt>>>31)}let Pe,He,Y=this.chain_[0],se=this.chain_[1],fe=this.chain_[2],Oe=this.chain_[3],Be=this.chain_[4];for(let it=0;it<80;it++){it<40?it<20?(Pe=Oe^se&(fe^Oe),He=1518500249):(Pe=se^fe^Oe,He=1859775393):it<60?(Pe=se&fe|Oe&(se|fe),He=2400959708):(Pe=se^fe^Oe,He=3395469782);const jt=(Y<<5|Y>>>27)+Pe+Be+He+H[it]&4294967295;Be=Oe,Oe=fe,fe=4294967295&(se<<30|se>>>2),se=Y,Y=jt}this.chain_[0]=this.chain_[0]+Y&4294967295,this.chain_[1]=this.chain_[1]+se&4294967295,this.chain_[2]=this.chain_[2]+fe&4294967295,this.chain_[3]=this.chain_[3]+Oe&4294967295,this.chain_[4]=this.chain_[4]+Be&4294967295}update(ne,$){if(null==ne)return;void 0===$&&($=ne.length);const H=$-this.blockSize;let Y=0;const se=this.buf_;let fe=this.inbuf_;for(;Y<$;){if(0===fe)for(;Y<=H;)this.compress_(ne,Y),Y+=this.blockSize;if("string"==typeof ne){for(;Y<$;)if(se[fe]=ne.charCodeAt(Y),++fe,++Y,fe===this.blockSize){this.compress_(se),fe=0;break}}else for(;Y<$;)if(se[fe]=ne[Y],++fe,++Y,fe===this.blockSize){this.compress_(se),fe=0;break}}this.inbuf_=fe,this.total_+=$}digest(){const ne=[];let $=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let Y=this.blockSize-1;Y>=56;Y--)this.buf_[Y]=255&$,$/=256;this.compress_(this.buf_);let H=0;for(let Y=0;Y<5;Y++)for(let se=24;se>=0;se-=8)ne[H]=this.chain_[Y]>>se&255,++H;return ne}}function pi(ze,ne){const $=new jn(ze,ne);return $.subscribe.bind($)}class jn{constructor(ne,$){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=$,this.task.then(()=>{ne(this)}).catch(H=>{this.error(H)})}next(ne){this.forEachObserver($=>{$.next(ne)})}error(ne){this.forEachObserver($=>{$.error(ne)}),this.close(ne)}complete(){this.forEachObserver(ne=>{ne.complete()}),this.close()}subscribe(ne,$,H){let Y;if(void 0===ne&&void 0===$&&void 0===H)throw new Error("Missing Observer.");Y=function Nr(ze,ne){if("object"!=typeof ze||null===ze)return!1;for(const $ of ne)if($ in ze&&"function"==typeof ze[$])return!0;return!1}(ne,["next","error","complete"])?ne:{next:ne,error:$,complete:H},void 0===Y.next&&(Y.next=Sr),void 0===Y.error&&(Y.error=Sr),void 0===Y.complete&&(Y.complete=Sr);const se=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?Y.error(this.finalError):Y.complete()}catch{}}),this.observers.push(Y),se}unsubscribeOne(ne){void 0===this.observers||void 0===this.observers[ne]||(delete this.observers[ne],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(ne){if(!this.finalized)for(let $=0;$<this.observers.length;$++)this.sendOne($,ne)}sendOne(ne,$){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[ne])try{$(this.observers[ne])}catch(H){typeof console<"u"&&console.error&&console.error(H)}})}close(ne){this.finalized||(this.finalized=!0,void 0!==ne&&(this.finalError=ne),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Sr(){}function Do(ze,ne){return`${ze} failed: ${ne} argument `}const Vs=function(ze){const ne=[];let $=0;for(let H=0;H<ze.length;H++){let Y=ze.charCodeAt(H);if(Y>=55296&&Y<=56319){const se=Y-55296;H++,Ne(H<ze.length,"Surrogate pair missing trail surrogate."),Y=65536+(se<<10)+(ze.charCodeAt(H)-56320)}Y<128?ne[$++]=Y:Y<2048?(ne[$++]=Y>>6|192,ne[$++]=63&Y|128):Y<65536?(ne[$++]=Y>>12|224,ne[$++]=Y>>6&63|128,ne[$++]=63&Y|128):(ne[$++]=Y>>18|240,ne[$++]=Y>>12&63|128,ne[$++]=Y>>6&63|128,ne[$++]=63&Y|128)}return ne},Ei=function(ze){let ne=0;for(let $=0;$<ze.length;$++){const H=ze.charCodeAt($);H<128?ne++:H<2048?ne+=2:H>=55296&&H<=56319?(ne+=4,$++):ne+=3}return ne},Hr=1e3,cn=2,Vt=144e5,Sn=.5;function Zn(ze,ne=Hr,$=cn){const H=ne*Math.pow($,ze),Y=Math.round(Sn*H*(Math.random()-.5)*2);return Math.min(Vt,H+Y)}function Qr(ze){return ze&&ze._delegate?ze._delegate:ze}},3682:(ui,Kt,Ae)=>{"use strict";var d=Ae(4650);let Ne=null;function Me(){return Ne}class $e{}const ft=new d.OlP("DocumentToken");let on=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:function(){return function yt(){return(0,d.LFG)(Ve)}()},providedIn:"platform"}),n})();const It=new d.OlP("Location Initialized");let Ve=(()=>{class n extends on{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Me().getBaseHref(this._doc)}onPopState(t){const i=Me().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Me().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){je()?this._history.pushState(t,i,r):this._location.hash=r}replaceState(t,i,r){je()?this._history.replaceState(t,i,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ft))},n.\u0275prov=d.Yz7({token:n,factory:function(){return function Ke(){return new Ve((0,d.LFG)(ft))}()},providedIn:"platform"}),n})();function je(){return!!window.history.pushState}function pn(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function tn(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function bn(n){return n&&"?"!==n[0]?"?"+n:n}let Dn=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:function(){return(0,d.f3M)(Ye)},providedIn:"root"}),n})();const vt=new d.OlP("appBaseHref");let Ye=(()=>{class n extends Dn{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??(0,d.f3M)(ft).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return pn(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+bn(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const f=this.prepareExternalUrl(r+bn(s));this._platformLocation.pushState(t,i,f)}replaceState(t,i,r,s){const f=this.prepareExternalUrl(r+bn(s));this._platformLocation.replaceState(t,i,f)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(on),d.LFG(vt,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ft=(()=>{class n extends Dn{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=pn(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let f=this.prepareExternalUrl(r+bn(s));0==f.length&&(f=this._platformLocation.pathname),this._platformLocation.pushState(t,i,f)}replaceState(t,i,r,s){let f=this.prepareExternalUrl(r+bn(s));0==f.length&&(f=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,f)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(on),d.LFG(vt,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})(),Jt=(()=>{class n{constructor(t){this._subject=new d.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function un(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(tn(Pt(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+bn(i))}normalize(t){return n.stripTrailingSlash(function Ct(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,Pt(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+bn(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+bn(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=bn,n.joinWithSlash=pn,n.stripTrailingSlash=tn,n.\u0275fac=function(t){return new(t||n)(d.LFG(Dn))},n.\u0275prov=d.Yz7({token:n,factory:function(){return function Xt(){return new Jt((0,d.LFG)(Dn))}()},providedIn:"root"}),n})();function Pt(n){return n.replace(/\/index.html$/,"")}var Bt=(()=>((Bt=Bt||{})[Bt.Format=0]="Format",Bt[Bt.Standalone=1]="Standalone",Bt))(),an=(()=>((an=an||{})[an.Narrow=0]="Narrow",an[an.Abbreviated=1]="Abbreviated",an[an.Wide=2]="Wide",an[an.Short=3]="Short",an))(),oi=(()=>((oi=oi||{})[oi.Short=0]="Short",oi[oi.Medium=1]="Medium",oi[oi.Long=2]="Long",oi[oi.Full=3]="Full",oi))(),On=(()=>((On=On||{})[On.Decimal=0]="Decimal",On[On.Group=1]="Group",On[On.List=2]="List",On[On.PercentSign=3]="PercentSign",On[On.PlusSign=4]="PlusSign",On[On.MinusSign=5]="MinusSign",On[On.Exponential=6]="Exponential",On[On.SuperscriptingExponent=7]="SuperscriptingExponent",On[On.PerMille=8]="PerMille",On[On.Infinity=9]="Infinity",On[On.NaN=10]="NaN",On[On.TimeSeparator=11]="TimeSeparator",On[On.CurrencyDecimal=12]="CurrencyDecimal",On[On.CurrencyGroup=13]="CurrencyGroup",On))();function rr(n,e){return Ir((0,d.cg1)(n)[d.wAp.DateFormat],e)}function qn(n,e){return Ir((0,d.cg1)(n)[d.wAp.TimeFormat],e)}function zn(n,e){return Ir((0,d.cg1)(n)[d.wAp.DateTimeFormat],e)}function vn(n,e){const t=(0,d.cg1)(n),i=t[d.wAp.NumberSymbols][e];if(typeof i>"u"){if(e===On.CurrencyDecimal)return t[d.wAp.NumberSymbols][On.Decimal];if(e===On.CurrencyGroup)return t[d.wAp.NumberSymbols][On.Group]}return i}function Ms(n){if(!n[d.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[d.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Ir(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function jr(n){const[e,t]=n.split(":");return{hours:+e,minutes:+t}}const vo=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,$r={},cs=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var pi=(()=>((pi=pi||{})[pi.Short=0]="Short",pi[pi.ShortGMT=1]="ShortGMT",pi[pi.Long=2]="Long",pi[pi.Extended=3]="Extended",pi))(),jn=(()=>((jn=jn||{})[jn.FullYear=0]="FullYear",jn[jn.Month=1]="Month",jn[jn.Date=2]="Date",jn[jn.Hours=3]="Hours",jn[jn.Minutes=4]="Minutes",jn[jn.Seconds=5]="Seconds",jn[jn.FractionalSeconds=6]="FractionalSeconds",jn[jn.Day=7]="Day",jn))(),Kn=(()=>((Kn=Kn||{})[Kn.DayPeriods=0]="DayPeriods",Kn[Kn.Days=1]="Days",Kn[Kn.Months=2]="Months",Kn[Kn.Eras=3]="Eras",Kn))();function Nr(n,e,t,i){let r=function Y(n){if(fe(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[r,s=1,f=1]=n.split("-").map(b=>+b);return Sr(r,s-1,f)}const t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(vo))return function se(n){const e=new Date(0);let t=0,i=0;const r=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));const f=Number(n[4]||0)-t,b=Number(n[5]||0)-i,I=Number(n[6]||0),O=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return s.call(e,f,b,I,O),e}(i)}const e=new Date(n);if(!fe(e))throw new Error(`Unable to convert "${n}" into a date`);return e}(n);e=Xr(t,e)||e;let b,f=[];for(;e;){if(b=cs.exec(e),!b){f.push(e);break}{f=f.concat(b.slice(1));const V=f.pop();if(!V)break;e=V}}let I=r.getTimezoneOffset();i&&(I=ne(i,I),r=function H(n,e,t){const i=t?-1:1,r=n.getTimezoneOffset();return function $(n,e){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+e),n}(n,i*(ne(e,r)-r))}(r,i,!0));let O="";return f.forEach(V=>{const X=function ze(n){if(Qr[n])return Qr[n];let e;switch(n){case"G":case"GG":case"GGG":e=Ei(Kn.Eras,an.Abbreviated);break;case"GGGG":e=Ei(Kn.Eras,an.Wide);break;case"GGGGG":e=Ei(Kn.Eras,an.Narrow);break;case"y":e=wi(jn.FullYear,1,0,!1,!0);break;case"yy":e=wi(jn.FullYear,2,0,!0,!0);break;case"yyy":e=wi(jn.FullYear,3,0,!1,!0);break;case"yyyy":e=wi(jn.FullYear,4,0,!1,!0);break;case"Y":e=ki(1);break;case"YY":e=ki(2,!0);break;case"YYY":e=ki(3);break;case"YYYY":e=ki(4);break;case"M":case"L":e=wi(jn.Month,1,1);break;case"MM":case"LL":e=wi(jn.Month,2,1);break;case"MMM":e=Ei(Kn.Months,an.Abbreviated);break;case"MMMM":e=Ei(Kn.Months,an.Wide);break;case"MMMMM":e=Ei(Kn.Months,an.Narrow);break;case"LLL":e=Ei(Kn.Months,an.Abbreviated,Bt.Standalone);break;case"LLLL":e=Ei(Kn.Months,an.Wide,Bt.Standalone);break;case"LLLLL":e=Ei(Kn.Months,an.Narrow,Bt.Standalone);break;case"w":e=ei(1);break;case"ww":e=ei(2);break;case"W":e=ei(1,!0);break;case"d":e=wi(jn.Date,1);break;case"dd":e=wi(jn.Date,2);break;case"c":case"cc":e=wi(jn.Day,1);break;case"ccc":e=Ei(Kn.Days,an.Abbreviated,Bt.Standalone);break;case"cccc":e=Ei(Kn.Days,an.Wide,Bt.Standalone);break;case"ccccc":e=Ei(Kn.Days,an.Narrow,Bt.Standalone);break;case"cccccc":e=Ei(Kn.Days,an.Short,Bt.Standalone);break;case"E":case"EE":case"EEE":e=Ei(Kn.Days,an.Abbreviated);break;case"EEEE":e=Ei(Kn.Days,an.Wide);break;case"EEEEE":e=Ei(Kn.Days,an.Narrow);break;case"EEEEEE":e=Ei(Kn.Days,an.Short);break;case"a":case"aa":case"aaa":e=Ei(Kn.DayPeriods,an.Abbreviated);break;case"aaaa":e=Ei(Kn.DayPeriods,an.Wide);break;case"aaaaa":e=Ei(Kn.DayPeriods,an.Narrow);break;case"b":case"bb":case"bbb":e=Ei(Kn.DayPeriods,an.Abbreviated,Bt.Standalone,!0);break;case"bbbb":e=Ei(Kn.DayPeriods,an.Wide,Bt.Standalone,!0);break;case"bbbbb":e=Ei(Kn.DayPeriods,an.Narrow,Bt.Standalone,!0);break;case"B":case"BB":case"BBB":e=Ei(Kn.DayPeriods,an.Abbreviated,Bt.Format,!0);break;case"BBBB":e=Ei(Kn.DayPeriods,an.Wide,Bt.Format,!0);break;case"BBBBB":e=Ei(Kn.DayPeriods,an.Narrow,Bt.Format,!0);break;case"h":e=wi(jn.Hours,1,-12);break;case"hh":e=wi(jn.Hours,2,-12);break;case"H":e=wi(jn.Hours,1);break;case"HH":e=wi(jn.Hours,2);break;case"m":e=wi(jn.Minutes,1);break;case"mm":e=wi(jn.Minutes,2);break;case"s":e=wi(jn.Seconds,1);break;case"ss":e=wi(jn.Seconds,2);break;case"S":e=wi(jn.FractionalSeconds,1);break;case"SS":e=wi(jn.FractionalSeconds,2);break;case"SSS":e=wi(jn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=Hr(pi.Short);break;case"ZZZZZ":e=Hr(pi.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Hr(pi.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=Hr(pi.Long);break;default:return null}return Qr[n]=e,e}(V);O+=X?X(r,t,I):"''"===V?"'":V.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),O}function Sr(n,e,t){const i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function Xr(n,e){const t=function gt(n){return(0,d.cg1)(n)[d.wAp.LocaleId]}(n);if($r[t]=$r[t]||{},$r[t][e])return $r[t][e];let i="";switch(e){case"shortDate":i=rr(n,oi.Short);break;case"mediumDate":i=rr(n,oi.Medium);break;case"longDate":i=rr(n,oi.Long);break;case"fullDate":i=rr(n,oi.Full);break;case"shortTime":i=qn(n,oi.Short);break;case"mediumTime":i=qn(n,oi.Medium);break;case"longTime":i=qn(n,oi.Long);break;case"fullTime":i=qn(n,oi.Full);break;case"short":const r=Xr(n,"shortTime"),s=Xr(n,"shortDate");i=Do(zn(n,oi.Short),[r,s]);break;case"medium":const f=Xr(n,"mediumTime"),b=Xr(n,"mediumDate");i=Do(zn(n,oi.Medium),[f,b]);break;case"long":const I=Xr(n,"longTime"),O=Xr(n,"longDate");i=Do(zn(n,oi.Long),[I,O]);break;case"full":const V=Xr(n,"fullTime"),X=Xr(n,"fullDate");i=Do(zn(n,oi.Full),[V,X])}return i&&($r[t][e]=i),i}function Do(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return null!=e&&i in e?e[i]:t})),n}function ao(n,e,t="-",i,r){let s="";(n<0||r&&n<=0)&&(r?n=1-n:(n=-n,s=t));let f=String(n);for(;f.length<e;)f="0"+f;return i&&(f=f.slice(f.length-e)),s+f}function wi(n,e,t=0,i=!1,r=!1){return function(s,f){let b=function Vs(n,e){switch(n){case jn.FullYear:return e.getFullYear();case jn.Month:return e.getMonth();case jn.Date:return e.getDate();case jn.Hours:return e.getHours();case jn.Minutes:return e.getMinutes();case jn.Seconds:return e.getSeconds();case jn.FractionalSeconds:return e.getMilliseconds();case jn.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,s);if((t>0||b>-t)&&(b+=t),n===jn.Hours)0===b&&-12===t&&(b=12);else if(n===jn.FractionalSeconds)return function ys(n,e){return ao(n,3).substring(0,e)}(b,e);const I=vn(f,On.MinusSign);return ao(b,e,I,i,r)}}function Ei(n,e,t=Bt.Format,i=!1){return function(r,s){return function lo(n,e,t,i,r,s){switch(t){case Kn.Months:return function nn(n,e,t){const i=(0,d.cg1)(n),s=Ir([i[d.wAp.MonthsFormat],i[d.wAp.MonthsStandalone]],e);return Ir(s,t)}(e,r,i)[n.getMonth()];case Kn.Days:return function Ht(n,e,t){const i=(0,d.cg1)(n),s=Ir([i[d.wAp.DaysFormat],i[d.wAp.DaysStandalone]],e);return Ir(s,t)}(e,r,i)[n.getDay()];case Kn.DayPeriods:const f=n.getHours(),b=n.getMinutes();if(s){const O=function so(n){const e=(0,d.cg1)(n);return Ms(e),(e[d.wAp.ExtraData][2]||[]).map(i=>"string"==typeof i?jr(i):[jr(i[0]),jr(i[1])])}(e),V=function Ds(n,e,t){const i=(0,d.cg1)(n);Ms(i);const s=Ir([i[d.wAp.ExtraData][0],i[d.wAp.ExtraData][1]],e)||[];return Ir(s,t)||[]}(e,r,i),X=O.findIndex(ae=>{if(Array.isArray(ae)){const[me,Ie]=ae,Ge=f>=me.hours&&b>=me.minutes,Je=f<Ie.hours||f===Ie.hours&&b<Ie.minutes;if(me.hours<Ie.hours){if(Ge&&Je)return!0}else if(Ge||Je)return!0}else if(ae.hours===f&&ae.minutes===b)return!0;return!1});if(-1!==X)return V[X]}return function Dt(n,e,t){const i=(0,d.cg1)(n),s=Ir([i[d.wAp.DayPeriodsFormat],i[d.wAp.DayPeriodsStandalone]],e);return Ir(s,t)}(e,r,i)[f<12?0:1];case Kn.Eras:return function en(n,e){return Ir((0,d.cg1)(n)[d.wAp.Eras],e)}(e,i)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(r,s,n,e,t,i)}}function Hr(n){return function(e,t,i){const r=-1*i,s=vn(t,On.MinusSign),f=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case pi.Short:return(r>=0?"+":"")+ao(f,2,s)+ao(Math.abs(r%60),2,s);case pi.ShortGMT:return"GMT"+(r>=0?"+":"")+ao(f,1,s);case pi.Long:return"GMT"+(r>=0?"+":"")+ao(f,2,s)+":"+ao(Math.abs(r%60),2,s);case pi.Extended:return 0===i?"Z":(r>=0?"+":"")+ao(f,2,s)+":"+ao(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}const cn=0,Vt=4;function Zn(n){return Sr(n.getFullYear(),n.getMonth(),n.getDate()+(Vt-n.getDay()))}function ei(n,e=!1){return function(t,i){let r;if(e){const s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,f=t.getDate();r=1+Math.floor((f+s)/7)}else{const s=Zn(t),f=function Sn(n){const e=Sr(n,cn,1).getDay();return Sr(n,0,1+(e<=Vt?Vt:Vt+7)-e)}(s.getFullYear()),b=s.getTime()-f.getTime();r=1+Math.round(b/6048e5)}return ao(r,n,vn(i,On.MinusSign))}}function ki(n,e=!1){return function(t,i){return ao(Zn(t).getFullYear(),n,vn(i,On.MinusSign),e)}}const Qr={};function ne(n,e){n=n.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function fe(n){return n instanceof Date&&!isNaN(n.valueOf())}const us=/\s+/,As=[];let Mn=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this.initialClasses=As,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(us):As}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(us):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,Boolean(t[i]));this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(us).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.ZZ4),d.Y36(d.aQg),d.Y36(d.SBq),d.Y36(d.Qsj))},n.\u0275dir=d.lG2({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class _i{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ur=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,f)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new _i(r.item,this._ngForOf,-1,-1),null===f?void 0:f);else if(null==f)i.remove(null===s?void 0:s);else if(null!==s){const b=i.get(s);i.move(b,f),Ps(b,r)}});for(let r=0,s=i.length;r<s;r++){const b=i.get(r).context;b.index=r,b.count=s,b.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{Ps(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.s_b),d.Y36(d.Rgc),d.Y36(d.ZZ4))},n.\u0275dir=d.lG2({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function Ps(n,e){n.context.$implicit=e.item}let Bo=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new Cl,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){bi("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){bi("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.s_b),d.Y36(d.Rgc))},n.\u0275dir=d.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class Cl{constructor(){this.$implicit=null,this.ngIf=null}}function bi(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,d.AaK)(e)}'.`)}class Vo{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let ji=(()=>{class n{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews.push(t)}_matchCase(t){const i=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(t){if(this._defaultViews.length>0&&t!==this._defaultUsed){this._defaultUsed=t;for(const i of this._defaultViews)i.enforceState(t)}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=d.lG2({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),n})(),_d=(()=>{class n{constructor(t,i,r){this.ngSwitch=r,r._addCase(),this._view=new Vo(t,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.s_b),d.Y36(d.Rgc),d.Y36(ji,9))},n.\u0275dir=d.lG2({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),n})(),co=(()=>{class n{constructor(t,i,r){r._addDefault(new Vo(t,i))}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.s_b),d.Y36(d.Rgc),d.Y36(ji,9))},n.\u0275dir=d.lG2({type:n,selectors:[["","ngSwitchDefault",""]],standalone:!0}),n})(),aa=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(t.ngTemplateOutlet||t.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:f}=this;this._viewRef=i.createEmbeddedView(r,s,f?{injector:f}:void 0)}else this._viewRef=null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.s_b))},n.\u0275dir=d.lG2({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[d.TTD]}),n})();const Lc=new d.OlP("DATE_PIPE_DEFAULT_TIMEZONE"),Nc=new d.OlP("DATE_PIPE_DEFAULT_OPTIONS");let js=(()=>{class n{constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,s){if(null==t||""===t||t!=t)return null;try{return Nr(t,i??this.defaultOptions?.dateFormat??"mediumDate",s||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(f){throw function yi(n,e){return new d.vHH(2100,!1)}()}}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.soG,16),d.Y36(Lc,24),d.Y36(Nc,24))},n.\u0275pipe=d.Yjl({name:"date",type:n,pure:!0,standalone:!0}),n})(),vs=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({}),n})();const eo="browser",vd="server";function ff(n){return n===vd}let Du=(()=>{class n{}return n.\u0275prov=(0,d.Yz7)({token:n,providedIn:"root",factory:()=>new Bc((0,d.LFG)(ft),window)}),n})();class Bc{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function xd(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const f=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(f)return f}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=rc(this.window.history)||rc(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function rc(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class cc extends $e{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Al extends cc{static makeCurrent(){!function _(n){Ne||(Ne=n)}(new Al)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function vf(){return Da=Da||document.querySelector("base"),Da?Da.getAttribute("href"):null}();return null==t?null:function zu(n){ua=ua||document.createElement("a"),ua.setAttribute("href",n);const e=ua.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Da=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function oh(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let ua,Da=null;const Sd=new d.OlP("TRANSITION_ID"),Pl=[{provide:d.ip1,useFactory:function fh(n,e,t){return()=>{t.get(d.CZH).donePromise.then(()=>{const i=Me(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[Sd,ft,d.zs3],multi:!0}];let Ol=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();const el=new d.OlP("EventManagerPlugins");let Zc=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const f=r[s];if(f.supports(t))return this._eventNameToPlugin.set(t,f),f}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(el),d.LFG(d.R0b))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();class kl{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Me().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let hn=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,i){const r=this.usageCount;let s=r.get(t)??0;return s+=i,s>0?r.set(t,s):r.delete(t),s}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})(),or=(()=>{class n extends hn{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.forEach(s=>s.remove()),i.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,i){const r=this.doc.createElement("style");r.textContent=i,t.appendChild(r);const s=this.styleRef.get(i);s?s.push(r):this.styleRef.set(i,[r])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ft))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();const Md={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Aa=/%COMP%/g,Xc=new d.OlP("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function qr(n,e){return e.flat(100).map(t=>t.replace(Aa,n))}function Rl(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let mh=(()=>{class n{constructor(t,i,r,s){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new ks(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;const r=this.getOrCreateRenderer(t,i);return r instanceof Bu?r.applyToHost(t):r instanceof Oa&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const f=this.eventManager,b=this.sharedStylesHost,I=this.removeStylesOnCompDestory;switch(i.encapsulation){case d.ifc.Emulated:s=new Bu(f,b,i,this.appId,I);break;case d.ifc.ShadowDom:return new Od(f,b,t,i);default:s=new Oa(f,b,i,I)}s.onDestroy=()=>r.delete(i.id),r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(Zc),d.LFG(or),d.LFG(d.AFp),d.LFG(Xc))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();class ks{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Md[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(Qc(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(Qc(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=Md[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=Md[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(d.JOm.DashCase|d.JOm.Important)?e.style.setProperty(t,i,r&d.JOm.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&d.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Rl(i)):this.eventManager.addEventListener(e,t,Rl(i))}}function Qc(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Od extends ks{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=qr(r.id,r.styles);for(const f of s){const b=document.createElement("style");b.textContent=f,this.shadowRoot.appendChild(b)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Oa extends ks{constructor(e,t,i,r,s=i.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=qr(s,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class Bu extends Oa{constructor(e,t,i,r,s){const f=r+"-"+i.id;super(e,t,i,s,f),this.contentAttr=function Pa(n){return"_ngcontent-%COMP%".replace(Aa,n)}(f),this.hostAttr=function Ad(n){return"_nghost-%COMP%".replace(Aa,n)}(f)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let Rp=(()=>{class n extends kl{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ft))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();const kd=["alt","control","meta","shift"],gh={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},_h={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let yh=(()=>{class n extends kl{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),f=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Me().onAndCancel(t,s.domEventName,f))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let f="",b=i.indexOf("code");if(b>-1&&(i.splice(b,1),f="code."),kd.forEach(O=>{const V=i.indexOf(O);V>-1&&(i.splice(V,1),f+=O+".")}),f+=s,0!=i.length||0===s.length)return null;const I={};return I.domEventName=r,I.fullKey=f,I}static matchEventFullKeyCode(t,i){let r=gh[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),kd.forEach(f=>{f!==r&&(0,_h[f])(t)&&(s+=f+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ft))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();const wf=(0,d.eFA)(d._c5,"browser",[{provide:d.Lbi,useValue:eo},{provide:d.g9A,useValue:function Rd(){Al.makeCurrent()},multi:!0},{provide:ft,useFactory:function vh(){return(0,d.RDi)(document),document},deps:[]}]),Cf=new d.OlP(""),Ef=[{provide:d.rWj,useClass:class kp{addToWindow(e){d.dqk.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},d.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),d.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),d.dqk.frameworkStabilizers||(d.dqk.frameworkStabilizers=[]),d.dqk.frameworkStabilizers.push(i=>{const r=d.dqk.getAllAngularTestabilities();let s=r.length,f=!1;const b=function(I){f=f||I,s--,0==s&&i(f)};r.forEach(function(I){I.whenStable(b)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Me().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:d.lri,useClass:d.dDg,deps:[d.R0b,d.eoX,d.rWj]},{provide:d.dDg,useClass:d.dDg,deps:[d.R0b,d.eoX,d.rWj]}],eu=[{provide:d.zSh,useValue:"root"},{provide:d.qLn,useFactory:function Jc(){return new d.qLn},deps:[]},{provide:el,useClass:Rp,multi:!0,deps:[ft,d.R0b,d.Lbi]},{provide:el,useClass:yh,multi:!0,deps:[ft]},{provide:mh,useClass:mh,deps:[Zc,or,d.AFp,Xc]},{provide:d.FYo,useExisting:mh},{provide:hn,useExisting:or},{provide:or,useClass:or,deps:[ft]},{provide:Zc,useClass:Zc,deps:[el,d.R0b]},{provide:class Yi{},useClass:Ol,deps:[]},[]];let Rs=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:d.AFp,useValue:t.appId},{provide:Sd,useExisting:d.AFp},Pl]}}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(Cf,12))},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[...eu,...Ef],imports:[vs,d.hGG]}),n})(),mn=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ft))},n.\u0275prov=d.Yz7({token:n,factory:function(t){let i=null;return i=t?new t:function ju(){return new mn((0,d.LFG)(ft))}(),i},providedIn:"root"}),n})();typeof window<"u"&&window;let Th=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:function(t){let i=null;return i=t?new(t||n):d.LFG(Fd),i},providedIn:"root"}),n})(),Fd=(()=>{class n extends Th{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case d.q3G.NONE:return i;case d.q3G.HTML:return(0,d.qzn)(i,"HTML")?(0,d.z3N)(i):(0,d.EiD)(this._doc,String(i)).toString();case d.q3G.STYLE:return(0,d.qzn)(i,"Style")?(0,d.z3N)(i):i;case d.q3G.SCRIPT:if((0,d.qzn)(i,"Script"))return(0,d.z3N)(i);throw new Error("unsafe value used in a script context");case d.q3G.URL:return(0,d.qzn)(i,"URL")?(0,d.z3N)(i):(0,d.mCW)(String(i));case d.q3G.RESOURCE_URL:if((0,d.qzn)(i,"ResourceURL"))return(0,d.z3N)(i);throw new Error(`unsafe value used in a resource URL context (see ${d.JZr})`);default:throw new Error(`Unexpected SecurityContext ${t} (see ${d.JZr})`)}}bypassSecurityTrustHtml(t){return(0,d.JVY)(t)}bypassSecurityTrustStyle(t){return(0,d.L6k)(t)}bypassSecurityTrustScript(t){return(0,d.eBb)(t)}bypassSecurityTrustUrl(t){return(0,d.LAX)(t)}bypassSecurityTrustResourceUrl(t){return(0,d.pB0)(t)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ft))},n.\u0275prov=d.Yz7({token:n,factory:function(t){let i=null;return i=t?new t:function Ym(n){return new Fd(n.get(ft))}(d.LFG(d.zs3)),i},providedIn:"root"}),n})();var Mi=Ae(8996),v=Ae(3269);function c(...n){const e=(0,v.yG)(n);return(0,Mi.D)(n,e)}var g=Ae(7579);class C extends g.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const D=(0,Ae(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var L=Ae(9751);const{isArray:B}=Array,{getPrototypeOf:G,prototype:J,keys:ee}=Object;function oe(n){if(1===n.length){const e=n[0];if(B(e))return{args:e,keys:null};if(function de(n){return n&&"object"==typeof n&&G(n)===J}(e)){const t=ee(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}var ge=Ae(4671),ue=Ae(4004);const{isArray:ye}=Array;function ce(n){return(0,ue.U)(e=>function be(n,e){return ye(e)?n(...e):n(e)}(n,e))}function Te(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}var ve=Ae(5403),De=Ae(9672);function Fe(...n){const e=(0,v.yG)(n),t=(0,v.jO)(n),{args:i,keys:r}=oe(n);if(0===i.length)return(0,Mi.D)([],e);const s=new L.y(function Re(n,e,t=ge.y){return i=>{Ue(e,()=>{const{length:r}=n,s=new Array(r);let f=r,b=r;for(let I=0;I<r;I++)Ue(e,()=>{const O=(0,Mi.D)(n[I],e);let V=!1;O.subscribe((0,ve.x)(i,X=>{s[I]=X,V||(V=!0,b--),b||i.next(t(s.slice()))},()=>{--f||i.complete()}))},i)},i)}}(i,e,r?f=>Te(r,f):ge.y));return t?s.pipe(ce(t)):s}function Ue(n,e,t){n?(0,De.f)(t,n,e):e()}var Ze=Ae(8189);function ot(...n){return function nt(){return(0,Ze.J)(1)}()((0,Mi.D)(n,(0,v.yG)(n)))}var Ut=Ae(8421);function Qe(n){return new L.y(e=>{(0,Ut.Xf)(n()).subscribe(e)})}var St=Ae(9635),at=Ae(576);function Ot(n,e){const t=(0,at.m)(n)?n:()=>n,i=r=>r.error(t());return new L.y(e?r=>e.schedule(i,0,r):i)}var et=Ae(515),qe=Ae(727),Xe=Ae(4482);function Mt(){return(0,Xe.e)((n,e)=>{let t=null;n._refCount++;const i=(0,ve.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class Lt extends L.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,Xe.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new qe.w0;const t=this.getSubject();e.add(this.source.subscribe((0,ve.x)(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=qe.w0.EMPTY)}return e}refCount(){return Mt()(this)}}function dn(n,e){return(0,Xe.e)((t,i)=>{let r=null,s=0,f=!1;const b=()=>f&&!r&&i.complete();t.subscribe((0,ve.x)(i,I=>{r?.unsubscribe();let O=0;const V=s++;(0,Ut.Xf)(n(I,V)).subscribe(r=(0,ve.x)(i,X=>i.next(e?e(I,X,V,O++):X),()=>{r=null,b()}))},()=>{f=!0,b()}))})}function Yn(n){return n<=0?()=>et.E:(0,Xe.e)((e,t)=>{let i=0;e.subscribe((0,ve.x)(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function gn(...n){const e=(0,v.yG)(n);return(0,Xe.e)((t,i)=>{(e?ot(n,t,e):ot(n,t)).subscribe(i)})}function Yt(n,e){return(0,Xe.e)((t,i)=>{let r=0;t.subscribe((0,ve.x)(i,s=>n.call(e,s,r++)&&i.next(s)))})}var yn=Ae(5577);function xi(n){return(0,Xe.e)((e,t)=>{let i=!1;e.subscribe((0,ve.x)(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function Bn(n=er){return(0,Xe.e)((e,t)=>{let i=!1;e.subscribe((0,ve.x)(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function er(){return new D}function Fi(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Yt((r,s)=>n(r,s,i)):ge.y,Yn(1),t?xi(e):Bn(()=>new D))}function sr(n,e){return(0,at.m)(e)?(0,yn.z)(n,e,1):(0,yn.z)(n,1)}function vi(n,e,t){const i=(0,at.m)(n)||e||t?{next:n,error:e,complete:t}:n;return i?(0,Xe.e)((r,s)=>{var f;null===(f=i.subscribe)||void 0===f||f.call(i);let b=!0;r.subscribe((0,ve.x)(s,I=>{var O;null===(O=i.next)||void 0===O||O.call(i,I),s.next(I)},()=>{var I;b=!1,null===(I=i.complete)||void 0===I||I.call(i),s.complete()},I=>{var O;b=!1,null===(O=i.error)||void 0===O||O.call(i,I),s.error(I)},()=>{var I,O;b&&(null===(I=i.unsubscribe)||void 0===I||I.call(i)),null===(O=i.finalize)||void 0===O||O.call(i)}))}):ge.y}function Mr(n){return(0,Xe.e)((e,t)=>{let s,i=null,r=!1;i=e.subscribe((0,ve.x)(t,void 0,void 0,f=>{s=(0,Ut.Xf)(n(f,Mr(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function Gs(n,e){return(0,Xe.e)(function Ys(n,e,t,i,r){return(s,f)=>{let b=t,I=e,O=0;s.subscribe((0,ve.x)(f,V=>{const X=O++;I=b?n(I,V,X):(b=!0,V),i&&f.next(I)},r&&(()=>{b&&f.next(I),f.complete()})))}}(n,e,arguments.length>=2,!0))}function Fa(n){return n<=0?()=>et.E:(0,Xe.e)((e,t)=>{let i=[];e.subscribe((0,ve.x)(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Er(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Yt((r,s)=>n(r,s,i)):ge.y,Fa(1),t?xi(e):Bn(()=>new D))}function ar(n,e=!1){return(0,Xe.e)((t,i)=>{let r=0;t.subscribe((0,ve.x)(i,s=>{const f=n(s,r++);(f||e)&&i.next(s),!f&&i.complete()}))})}function Fr(n){return(0,Xe.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const Xn="primary",Li=Symbol("RouteTitle");class xs{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function ho(n){return new xs(n)}function dc(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const f=i[s],b=n[s];if(f.startsWith(":"))r[f.substring(1)]=b;else if(f!==b.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Wr(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!Ks(n[r],e[r]))return!1;return!0}function Ks(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function ma(n){return Array.prototype.concat.apply([],n)}function Ll(n){return n.length>0?n[n.length-1]:null}function fo(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function hc(n){return(0,d.CqO)(n)?n:(0,d.QGY)(n)?(0,Mi.D)(Promise.resolve(n)):c(n)}const hs=!1,Ih={exact:function qu(n,e,t){if(!fc(n.segments,e.segments)||!Mh(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!qu(n.children[i],e.children[i],t))return!1;return!0},subset:If},Bp={exact:function fs(n,e){return Wr(n,e)},subset:function Sh(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Ks(n[t],e[t]))},ignored:()=>!0};function Vp(n,e,t){return Ih[t.paths](n.root,e.root,t.matrixParams)&&Bp[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function If(n,e,t){return Up(n,e,e.segments,t)}function Up(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!fc(r,t)||e.hasChildren()||!Mh(r,t,i))}if(n.segments.length===t.length){if(!fc(n.segments,t)||!Mh(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!If(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(fc(n.segments,r)&&Mh(n.segments,r,i)&&n.children[Xn])&&Up(n.children[Xn],e,s,i)}}function Mh(n,e,t){return e.every((i,r)=>Bp[t](n[r].parameters,i.parameters))}class Wu{constructor(e=new Wi([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ho(this.queryParams)),this._queryParamMap}toString(){return P.serialize(this)}}class Wi{constructor(e,t){this.segments=e,this.children=t,this.parent=null,fo(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return R(this)}}class Nl{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=ho(this.parameters)),this._parameterMap}toString(){return zi(this)}}function fc(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let Zu=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:function(){return new j},providedIn:"root"}),n})();class j{parse(e){const t=new mc(e);return new Wu(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${q(e.root,!0)}`,i=function ga(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${_e(t)}=${_e(r)}`).join("&"):`${_e(t)}=${_e(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function lt(n){return encodeURI(n)}(e.fragment)}`:""}`}}const P=new j;function R(n){return n.segments.map(e=>zi(e)).join("/")}function q(n,e){if(!n.hasChildren())return R(n);if(e){const t=n.children[Xn]?q(n.children[Xn],!1):"",i=[];return fo(n.children,(r,s)=>{s!==Xn&&i.push(`${s}:${q(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function Km(n,e){let t=[];return fo(n.children,(i,r)=>{r===Xn&&(t=t.concat(e(i,r)))}),fo(n.children,(i,r)=>{r!==Xn&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===Xn?[q(n.children[Xn],!1)]:[`${r}:${q(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Xn]?`${R(n)}/${t[0]}`:`${R(n)}/(${t.join("//")})`}}function le(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function _e(n){return le(n).replace(/%3B/gi,";")}function $t(n){return le(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Tn(n){return decodeURIComponent(n)}function ii(n){return Tn(n.replace(/\+/g,"%20"))}function zi(n){return`${$t(n.path)}${function po(n){return Object.keys(n).map(e=>`;${$t(e)}=${$t(n[e])}`).join("")}(n.parameters)}`}const rl=/^[^\/()?;=#]+/;function ol(n){const e=n.match(rl);return e?e[0]:""}const pc=/^[^=?&#]+/,ru=/^[^&#]+/;class mc{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Wi([],{}):new Wi([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Xn]=new Wi(e,t)),i}parseSegment(){const e=ol(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new d.vHH(4009,hs);return this.capture(e),new Nl(Tn(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=ol(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=ol(this.remaining);r&&(i=r,this.capture(i))}e[Tn(t)]=Tn(i)}parseQueryParam(e){const t=function La(n){const e=n.match(pc);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const f=function ou(n){const e=n.match(ru);return e?e[0]:""}(this.remaining);f&&(i=f,this.capture(i))}const r=ii(t),s=ii(i);if(e.hasOwnProperty(r)){let f=e[r];Array.isArray(f)||(f=[f],e[r]=f),f.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=ol(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new d.vHH(4010,hs);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Xn);const f=this.parseChildren();t[s]=1===Object.keys(f).length?f[Xn]:new Wi([],f),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new d.vHH(4011,hs)}}function Dh(n){return n.segments.length>0?new Wi([],{[Xn]:n}):n}function Ah(n){const e={};for(const i of Object.keys(n.children)){const s=Ah(n.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function Sf(n){if(1===n.numberOfChildren&&n.children[Xn]){const e=n.children[Xn];return new Wi(n.segments.concat(e.segments),e.children)}return n}(new Wi(n.segments,e))}function Yu(n){return n instanceof Wu}const jp=!1;function ex(n,e,t,i,r){if(0===t.length)return gc(e.root,e.root,e.root,i,r);const s=function M_(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new za(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,f)=>{if("object"==typeof s&&null!=s){if(s.outlets){const b={};return fo(s.outlets,(I,O)=>{b[O]="string"==typeof I?I.split("/"):I}),[...r,{outlets:b}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===f?(s.split("/").forEach((b,I)=>{0==I&&"."===b||(0==I&&""===b?t=!0:".."===b?e++:""!=b&&r.push(b))}),r):[...r,s]},[]);return new za(t,e,i)}(t);return s.toRoot()?gc(e.root,e.root,new Wi([],{}),i,r):function f(I){const O=function Xm(n,e,t,i){if(n.isAbsolute)return new Rh(e.root,!0,0);if(-1===i)return new Rh(t,t===e.root,0);return function Ld(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new d.vHH(4005,jp&&"Invalid number of '../'");r=i.segments.length}return new Rh(i,!1,r-s)}(t,i+(Zr(n.commands[0])?0:1),n.numberOfDoubleDots)}(s,e,n.snapshot?._urlSegment,I),V=O.processChildren?Nd(O.segmentGroup,O.index,s.commands):yc(O.segmentGroup,O.index,s.commands);return gc(e.root,O.segmentGroup,V,i,r)}(n.snapshot?._lastPathIndex)}function Zr(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Qn(n){return"object"==typeof n&&null!=n&&n.outlets}function gc(n,e,t,i,r){let f,s={};i&&fo(i,(I,O)=>{s[O]=Array.isArray(I)?I.map(V=>`${V}`):`${I}`}),f=n===e?t:kh(n,e,t);const b=Dh(Ah(f));return new Wu(b,s,r)}function kh(n,e,t){const i={};return fo(n.children,(r,s)=>{i[s]=r===e?t:kh(r,e,t)}),new Wi(n.segments,i)}class za{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Zr(i[0]))throw new d.vHH(4003,jp&&"Root segment cannot have matrix parameters");const r=i.find(Qn);if(r&&r!==Ll(i))throw new d.vHH(4004,jp&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Rh{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function yc(n,e,t){if(n||(n=new Wi([],{})),0===n.segments.length&&n.hasChildren())return Nd(n,e,t);const i=function $p(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const f=n.segments[r],b=t[i];if(Qn(b))break;const I=`${b}`,O=i<t.length-1?t[i+1]:null;if(r>0&&void 0===I)break;if(I&&O&&"object"==typeof O&&void 0===O.outlets){if(!A_(I,O,f))return s;i+=2}else{if(!A_(I,{},f))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new Wi(n.segments.slice(0,i.pathIndex),{});return s.children[Xn]=new Wi(n.segments.slice(i.pathIndex),n.children),Nd(s,0,r)}return i.match&&0===r.length?new Wi(n.segments,{}):i.match&&!n.hasChildren()?Gp(n,e,t):i.match?Nd(n,0,r):Gp(n,e,t)}function Nd(n,e,t){if(0===t.length)return new Wi(n.segments,{});{const i=function Fh(n){return Qn(n[0])?n[0].outlets:{[Xn]:n}}(t),r={};if(!i[Xn]&&n.children[Xn]&&1===n.numberOfChildren&&0===n.children[Xn].segments.length){const s=Nd(n.children[Xn],e,t);return new Wi(n.segments,s.children)}return fo(i,(s,f)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[f]=yc(n.children[f],e,s))}),fo(n.children,(s,f)=>{void 0===i[f]&&(r[f]=s)}),new Wi(n.segments,r)}}function Gp(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Qn(s)){const I=D_(s.outlets);return new Wi(i,I)}if(0===r&&Zr(t[0])){i.push(new Nl(n.segments[e].path,Hp(t[0]))),r++;continue}const f=Qn(s)?s.outlets[Xn]:`${s}`,b=r<t.length-1?t[r+1]:null;f&&b&&Zr(b)?(i.push(new Nl(f,Hp(b))),r+=2):(i.push(new Nl(f,{})),r++)}return new Wi(i,{})}function D_(n){const e={};return fo(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=Gp(new Wi([],{}),0,t))}),e}function Hp(n){const e={};return fo(n,(t,i)=>e[i]=`${t}`),e}function A_(n,e,t){return n==t.path&&Wr(e,t.parameters)}const Mf="imperative";class sl{constructor(e,t){this.id=e,this.url=t}}class Lh extends sl{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ba extends sl{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Df extends sl{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class qp extends sl{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class Ku extends sl{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Af extends sl{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Hs extends sl{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qm extends sl{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class _a extends sl{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class su extends sl{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Mv{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class mo{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class tx{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Wp{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class al{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class P_{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Dv{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let zl=(()=>{class n{createUrlTree(t,i,r,s,f,b){return ex(t||i.root,r,s,f,b)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})(),ix=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:function(e){return zl.\u0275fac(e)},providedIn:"root"}),n})();class Ov{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=O_(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=O_(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=kv(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return kv(e,this._root).map(t=>t.value)}}function O_(n,e){if(n===e.value)return e;for(const t of e.children){const i=O_(n,t);if(i)return i}return null}function kv(n,e){if(n===e.value)return[e];for(const t of e.children){const i=kv(n,t);if(i.length)return i.unshift(e),i}return[]}class Xs{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function vc(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class Rv extends Ov{constructor(e,t){super(e),this.snapshot=t,Pf(this,e)}toString(){return this.snapshot.toString()}}function Zp(n,e){const t=function Fv(n,e){const f=new ll([],{},{},"",{},Xn,e,null,n.root,-1,{});return new zh("",new Xs(f,[]))}(n,e),i=new C([new Nl("",{})]),r=new C({}),s=new C({}),f=new C({}),b=new C(""),I=new Nh(i,r,f,b,s,Xn,e,t.root);return I.snapshot=t.root,new Rv(new Xs(I,[]),t)}class Nh{constructor(e,t,i,r,s,f,b,I){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=f,this.component=b,this.title=this.data?.pipe((0,ue.U)(O=>O[Li]))??c(void 0),this._futureSnapshot=I}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,ue.U)(e=>ho(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,ue.U)(e=>ho(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function k_(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function ya(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class ll{get title(){return this.data?.[Li]}constructor(e,t,i,r,s,f,b,I,O,V,X){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=f,this.component=b,this.routeConfig=I,this._urlSegment=O,this._lastPathIndex=V,this._resolve=X}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ho(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ho(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class zh extends Ov{constructor(e,t){super(t),this.url=e,Pf(this,t)}toString(){return Bl(this._root)}}function Pf(n,e){e.value._routerState=n,e.children.forEach(t=>Pf(n,t))}function Bl(n){const e=n.children.length>0?` { ${n.children.map(Bl).join(", ")} } `:"";return`${n.value}${e}`}function cl(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Wr(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),Wr(e.params,t.params)||n.params.next(t.params),function iu(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Wr(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),Wr(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function Yp(n,e){const t=Wr(n.params,e.params)&&function S_(n,e){return fc(n,e)&&n.every((t,i)=>Wr(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||Yp(n.parent,e.parent))}function Xu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function rx(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Xu(n,i,r);return Xu(n,i)})}(n,e,t);return new Xs(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const f=s.route;return f.value._futureSnapshot=e.value,f.children=e.children.map(b=>Xu(n,b)),f}}const i=function R_(n){return new Nh(new C(n.url),new C(n.params),new C(n.queryParams),new C(n.fragment),new C(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>Xu(n,s));return new Xs(i,r)}}const Vl="ngNavigationCancelingError";function Of(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=Yu(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=ox(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function ox(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[Vl]=!0,i.cancellationCode=e,t&&(i.url=t),i}function sx(n){return F_(n)&&Yu(n.url)}function F_(n){return n&&n[Vl]}class Kp{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Xp,this.attachRef=null}}let Xp=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Kp,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Bh=!1;let Qu=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Xn,this.activateEvents=new d.vpe,this.deactivateEvents=new d.vpe,this.attachEvents=new d.vpe,this.detachEvents=new d.vpe,this.parentContexts=(0,d.f3M)(Xp),this.location=(0,d.f3M)(d.s_b),this.changeDetector=(0,d.f3M)(d.sBO),this.environmentInjector=(0,d.f3M)(d.lqb)}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new d.vHH(4012,Bh);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new d.vHH(4012,Bh);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new d.vHH(4012,Bh);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new d.vHH(4013,Bh);this._activatedRoute=t;const r=this.location,f=t.snapshot.component,b=this.parentContexts.getOrCreateContext(this.name).children,I=new Jm(t,b,r.injector);if(i&&function L_(n){return!!n.resolveComponentFactory}(i)){const O=i.resolveComponentFactory(f);this.activated=r.createComponent(O,r.length,I)}else this.activated=r.createComponent(f,{index:r.length,injector:I,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=d.lG2({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[d.TTD]}),n})();class Jm{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Nh?this.route:e===Xp?this.childContexts:this.parent.get(e,t)}}let eg=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=d.Xpm({type:n,selectors:[["ng-component"]],standalone:!0,features:[d.jDz],decls:1,vars:0,template:function(t,i){1&t&&d._UZ(0,"router-outlet")},dependencies:[Qu],encapsulation:2}),n})();function Qp(n,e){return n.providers&&!n._injector&&(n._injector=(0,d.MMx)(n.providers,e,`Route: ${n.path}`)),n._injector??e}function zd(n){const e=n.children&&n.children.map(zd),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Xn&&(t.component=eg),t}function ul(n){return n.outlet||Xn}function tr(n,e){const t=n.filter(i=>ul(i)===e);return t.push(...n.filter(i=>ul(i)!==e)),t}function kf(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class ed{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),cl(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=vc(t);e.children.forEach(s=>{const f=s.value.outlet;this.deactivateRoutes(s,r[f],i),delete r[f]}),fo(r,(s,f)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const f=i.getContext(r.outlet);f&&this.deactivateChildRoutes(e,t,f.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=vc(e);for(const f of Object.keys(s))this.deactivateRouteAndItsChildren(s[f],r);if(i&&i.outlet){const f=i.outlet.detach(),b=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:f,route:e,contexts:b})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=vc(e);for(const f of Object.keys(s))this.deactivateRouteAndItsChildren(s[f],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=vc(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new P_(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Wp(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(cl(r),r===s)if(r.component){const f=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,f.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const f=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const b=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),f.children.onOutletReAttached(b.contexts),f.attachRef=b.componentRef,f.route=b.route.value,f.outlet&&f.outlet.attach(b.componentRef,b.route.value),cl(b.route.value),this.activateChildRoutes(e,null,f.children)}else{const b=kf(r.snapshot),I=b?.get(d._Vd)??null;f.attachRef=null,f.route=r,f.resolver=I,f.injector=b,f.outlet&&f.outlet.activateWith(r,f.injector),this.activateChildRoutes(e,null,f.children)}}else this.activateChildRoutes(e,null,i)}}class Ul{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Va{constructor(e,t){this.component=e,this.route=t}}function Qs(n,e,t){const i=n._root;return Rf(i,e?e._root:null,t,[i.value])}function Eo(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||(0,d.Z0I)(n)?e.get(n):n:i}function Rf(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=vc(e);return n.children.forEach(f=>{(function Ff(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,f=e?e.value:null,b=t?t.getContext(n.value.outlet):null;if(f&&s.routeConfig===f.routeConfig){const I=function z_(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!fc(n.url,e.url);case"pathParamsOrQueryParamsChange":return!fc(n.url,e.url)||!Wr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Yp(n,e)||!Wr(n.queryParams,e.queryParams);default:return!Yp(n,e)}}(f,s,s.routeConfig.runGuardsAndResolvers);I?r.canActivateChecks.push(new Ul(i)):(s.data=f.data,s._resolvedData=f._resolvedData),Rf(n,e,s.component?b?b.children:null:t,i,r),I&&b&&b.outlet&&b.outlet.isActivated&&r.canDeactivateChecks.push(new Va(b.outlet.component,f))}else f&&ng(e,b,r),r.canActivateChecks.push(new Ul(i)),Rf(n,null,s.component?b?b.children:null:t,i,r)})(f,s[f.value.outlet],t,i.concat([f.value]),r),delete s[f.value.outlet]}),fo(s,(f,b)=>ng(f,t.getContext(b),r)),r}function ng(n,e,t){const i=vc(n),r=n.value;fo(i,(s,f)=>{ng(s,r.component?e?e.children.getContext(f):null:e,t)}),t.canDeactivateChecks.push(new Va(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function Lf(n){return"function"==typeof n}function tm(n){return n instanceof D||"EmptyError"===n?.name}const lu=Symbol("INITIAL_VALUE");function nm(){return dn(n=>Fe(n.map(e=>e.pipe(Yn(1),gn(lu)))).pipe((0,ue.U)(e=>{for(const t of e)if(!0!==t){if(t===lu)return lu;if(!1===t||t instanceof Wu)return t}return!0}),Yt(e=>e!==lu),Yn(1)))}function cx(n){return(0,St.z)(vi(e=>{if(Yu(e))throw Of(0,e)}),(0,ue.U)(e=>!0===e))}const cu={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Uv(n,e,t,i,r){const s=$_(n,e,t);return s.matched?function zf(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?c(r.map(f=>{const b=Eo(f,n);return hc(function Nf(n){return n&&Lf(n.canMatch)}(b)?b.canMatch(e,t):n.runInContext(()=>b(e,t)))})).pipe(nm(),cx()):c(!0)}(i=Qp(e,i),e,t).pipe((0,ue.U)(f=>!0===f?s:{...cu})):c(s)}function $_(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...cu}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||dc)(t,n,e);if(!r)return{...cu};const s={};fo(r.posParams,(b,I)=>{s[I]=b.path});const f=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:f,positionalParamSegments:r.posParams??{}}}function G_(n,e,t,i){if(t.length>0&&function dx(n,e,t){return t.some(i=>og(n,e,i)&&ul(i)!==Xn)}(n,t,i)){const s=new Wi(e,function ux(n,e,t,i){const r={};r[Xn]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&ul(s)!==Xn){const f=new Wi([],{});f._sourceSegment=n,f._segmentIndexShift=e.length,r[ul(s)]=f}return r}(n,e,i,new Wi(t,n.children)));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function hx(n,e,t){return t.some(i=>og(n,e,i))}(n,t,i)){const s=new Wi(n.segments,function jv(n,e,t,i,r){const s={};for(const f of i)if(og(n,t,f)&&!r[ul(f)]){const b=new Wi([],{});b._sourceSegment=n,b._segmentIndexShift=e.length,s[ul(f)]=b}return{...r,...s}}(n,e,t,i,n.children));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const r=new Wi(n.segments,n.children);return r._sourceSegment=n,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:t}}function og(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function L1(n,e,t,i){return!!(ul(n)===i||i!==Xn&&og(e,t,n))&&("**"===n.path||$_(e,n,t).matched)}function $v(n,e,t){return 0===e.length&&!n.children[t]}const Vd=!1;class sg{constructor(e){this.segmentGroup=e||null}}class Ud{constructor(e){this.urlTree=e}}function Js(n){return Ot(new sg(n))}function Ua(n){return Ot(new Ud(n))}class z1{constructor(e,t,i,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=G_(this.urlTree.root,[],[],this.config).segmentGroup,t=new Wi(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Xn).pipe((0,ue.U)(s=>this.createUrlTree(Ah(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Mr(s=>{if(s instanceof Ud)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof sg?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Xn).pipe((0,ue.U)(r=>this.createUrlTree(Ah(r),e.queryParams,e.fragment))).pipe(Mr(r=>{throw r instanceof sg?this.noMatchError(r):r}))}noMatchError(e){return new d.vHH(4002,Vd)}createUrlTree(e,t,i){const r=Dh(e);return new Wu(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe((0,ue.U)(s=>new Wi([],s))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return(0,Mi.D)(r).pipe(sr(s=>{const f=i.children[s],b=tr(t,s);return this.expandSegmentGroup(e,b,f,s).pipe((0,ue.U)(I=>({segment:I,outlet:s})))}),Gs((s,f)=>(s[f.outlet]=f.segment,s),{}),Er())}expandSegment(e,t,i,r,s,f){return(0,Mi.D)(i).pipe(sr(b=>this.expandSegmentAgainstRoute(e,t,i,b,r,s,f).pipe(Mr(O=>{if(O instanceof sg)return c(null);throw O}))),Fi(b=>!!b),Mr((b,I)=>{if(tm(b))return $v(t,r,s)?c(new Wi([],{})):Js(t);throw b}))}expandSegmentAgainstRoute(e,t,i,r,s,f,b){return L1(r,t,s,f)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,f):b&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,f):Js(t):Js(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,f){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,f):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,f)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?Ua(s):this.lineralizeSegments(i,s).pipe((0,yn.z)(f=>{const b=new Wi(f,{});return this.expandSegment(e,b,t,f,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,f){const{matched:b,consumedSegments:I,remainingSegments:O,positionalParamSegments:V}=$_(t,r,s);if(!b)return Js(t);const X=this.applyRedirectCommands(I,r.redirectTo,V);return r.redirectTo.startsWith("/")?Ua(X):this.lineralizeSegments(r,X).pipe((0,yn.z)(ae=>this.expandSegment(e,t,i,ae.concat(O),f,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){return"**"===i.path?(e=Qp(i,e),i.loadChildren?(i._loadedRoutes?c({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(e,i)).pipe((0,ue.U)(b=>(i._loadedRoutes=b.routes,i._loadedInjector=b.injector,new Wi(r,{})))):c(new Wi(r,{}))):Uv(t,i,r,e).pipe(dn(({matched:f,consumedSegments:b,remainingSegments:I})=>f?this.getChildConfig(e=i._injector??e,i,r).pipe((0,yn.z)(V=>{const X=V.injector??e,ae=V.routes,{segmentGroup:me,slicedSegments:Ie}=G_(t,b,I,ae),Ge=new Wi(me.segments,me.children);if(0===Ie.length&&Ge.hasChildren())return this.expandChildren(X,ae,Ge).pipe((0,ue.U)(Nn=>new Wi(b,Nn)));if(0===ae.length&&0===Ie.length)return c(new Wi(b,{}));const Je=ul(i)===s;return this.expandSegment(X,Ge,ae,Ie,Je?Xn:s,!0).pipe((0,ue.U)(xn=>new Wi(b.concat(xn.segments),xn.children)))})):Js(t)))}getChildConfig(e,t,i){return t.children?c({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?c({routes:t._loadedRoutes,injector:t._loadedInjector}):function lx(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?c(!0):c(r.map(f=>{const b=Eo(f,n);return hc(function B_(n){return n&&Lf(n.canLoad)}(b)?b.canLoad(e,t):n.runInContext(()=>b(e,t)))})).pipe(nm(),cx())}(e,t,i).pipe((0,yn.z)(r=>r?this.configLoader.loadChildren(e,t).pipe(vi(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function Gv(n){return Ot(ox(Vd,3))}())):c({routes:[],injector:e})}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return c(i);if(r.numberOfChildren>1||!r.children[Xn])return e.redirectTo,Ot(new d.vHH(4e3,Vd));r=r.children[Xn]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Wu(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return fo(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const b=r.substring(1);i[s]=t[b]}else i[s]=r}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let f={};return fo(t.children,(b,I)=>{f[I]=this.createSegmentGroup(e,b,i,r)}),new Wi(s,f)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new d.vHH(4001,Vd);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}class rm{}class Vf{constructor(e,t,i,r,s,f,b){this.injector=e,this.rootComponentType=t,this.config=i,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=f,this.urlSerializer=b}recognize(){const e=G_(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Xn).pipe((0,ue.U)(t=>{if(null===t)return null;const i=new ll([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Xn,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Xs(i,t),s=new zh(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,i=k_(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r)}processChildren(e,t,i){return(0,Mi.D)(Object.keys(i.children)).pipe(sr(r=>{const s=i.children[r],f=tr(t,r);return this.processSegmentGroup(e,f,s,r)}),Gs((r,s)=>r&&s?(r.push(...s),r):null),ar(r=>null!==r),xi(null),Er(),(0,ue.U)(r=>{if(null===r)return null;const s=mx(r);return function ag(n){n.sort((e,t)=>e.value.outlet===Xn?-1:t.value.outlet===Xn?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,i,r,s){return(0,Mi.D)(t).pipe(sr(f=>this.processSegmentAgainstRoute(f._injector??e,f,i,r,s)),Fi(f=>!!f),Mr(f=>{if(tm(f))return $v(i,r,s)?c([]):c(null);throw f}))}processSegmentAgainstRoute(e,t,i,r,s){if(t.redirectTo||!L1(t,i,r,s))return c(null);let f;if("**"===t.path){const b=r.length>0?Ll(r).parameters:{},I=gx(i)+r.length;f=c({snapshot:new ll(r,b,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Uf(t),ul(t),t.component??t._loadedComponent??null,t,Hv(i),I,ja(t)),consumedSegments:[],remainingSegments:[]})}else f=Uv(i,t,r,e).pipe((0,ue.U)(({matched:b,consumedSegments:I,remainingSegments:O,parameters:V})=>{if(!b)return null;const X=gx(i)+I.length;return{snapshot:new ll(I,V,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Uf(t),ul(t),t.component??t._loadedComponent??null,t,Hv(i),X,ja(t)),consumedSegments:I,remainingSegments:O}}));return f.pipe(dn(b=>{if(null===b)return c(null);const{snapshot:I,consumedSegments:O,remainingSegments:V}=b;e=t._injector??e;const X=t._loadedInjector??e,ae=function B1(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:me,slicedSegments:Ie}=G_(i,O,V,ae.filter(Je=>void 0===Je.redirectTo));if(0===Ie.length&&me.hasChildren())return this.processChildren(X,ae,me).pipe((0,ue.U)(Je=>null===Je?null:[new Xs(I,Je)]));if(0===ae.length&&0===Ie.length)return c([new Xs(I,[])]);const Ge=ul(t)===s;return this.processSegment(X,ae,me,Ie,Ge?Xn:s).pipe((0,ue.U)(Je=>null===Je?null:[new Xs(I,Je)]))}))}}function V1(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function mx(n){const e=[],t=new Set;for(const i of n){if(!V1(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=mx(i.children);e.push(new Xs(i.value,r))}return e.filter(i=>!t.has(i))}function Hv(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function gx(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function Uf(n){return n.data||{}}function ja(n){return n.resolve||{}}function jf(n){return"string"==typeof n.title||null===n.title}function cg(n){return dn(e=>{const t=n(e);return t?(0,Mi.D)(t).pipe((0,ue.U)(()=>e)):c(e)})}const uu=new d.OlP("ROUTES");let ug=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,d.f3M)(d.Sil)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return c(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=hc(t.loadComponent()).pipe((0,ue.U)(xc),vi(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Fr(()=>{this.componentLoaders.delete(t)})),r=new Lt(i,()=>new g.x).pipe(Mt());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return c({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe((0,ue.U)(b=>{this.onLoadEndListener&&this.onLoadEndListener(i);let I,O,V=!1;Array.isArray(b)?O=b:(I=b.create(t).injector,O=ma(I.get(uu,[],d.XFs.Self|d.XFs.Optional)));return{routes:O.map(zd),injector:I}}),Fr(()=>{this.childrenLoaders.delete(i)})),f=new Lt(s,()=>new g.x).pipe(Mt());return this.childrenLoaders.set(i,f),f}loadModuleFactoryOrRoutes(t){return hc(t()).pipe((0,ue.U)(xc),(0,yn.z)(i=>i instanceof d.YKP||Array.isArray(i)?c(i):(0,Mi.D)(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function xc(n){return function Yv(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let jd=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new g.x,this.configLoader=(0,d.f3M)(ug),this.environmentInjector=(0,d.f3M)(d.lqb),this.urlSerializer=(0,d.f3M)(Zu),this.rootContexts=(0,d.f3M)(Xp),this.navigationId=0,this.afterPreactivation=()=>c(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new mo(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Mv(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t){return this.transitions=new C({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Mf,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Yt(i=>0!==i.id),(0,ue.U)(i=>({...i,extractedUrl:t.urlHandlingStrategy.extract(i.rawUrl)})),dn(i=>{let r=!1,s=!1;return c(i).pipe(vi(f=>{this.currentNavigation={id:f.id,initialUrl:f.rawUrl,extractedUrl:f.extractedUrl,trigger:f.source,extras:f.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),dn(f=>{const b=t.browserUrlTree.toString(),I=!t.navigated||f.extractedUrl.toString()!==b||b!==t.currentUrlTree.toString();if(!I&&"reload"!==(f.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const V="";return this.events.next(new qp(f.id,t.serializeUrl(i.rawUrl),V,0)),t.rawUrlTree=f.rawUrl,f.resolve(null),et.E}if(t.urlHandlingStrategy.shouldProcessUrl(f.rawUrl))return yx(f.source)&&(t.browserUrlTree=f.extractedUrl),c(f).pipe(dn(V=>{const X=this.transitions?.getValue();return this.events.next(new Lh(V.id,this.urlSerializer.serialize(V.extractedUrl),V.source,V.restoredState)),X!==this.transitions?.getValue()?et.E:Promise.resolve(V)}),function px(n,e,t,i){return dn(r=>function N1(n,e,t,i,r){return new z1(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe((0,ue.U)(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),vi(V=>{this.currentNavigation={...this.currentNavigation,finalUrl:V.urlAfterRedirects},i.urlAfterRedirects=V.urlAfterRedirects}),function j1(n,e,t,i,r){return(0,yn.z)(s=>function Bf(n,e,t,i,r,s,f="emptyOnly"){return new Vf(n,e,t,i,r,f,s).recognize().pipe(dn(b=>null===b?function H_(n){return new L.y(e=>e.error(n))}(new rm):c(b)))}(n,e,t,s.urlAfterRedirects,i.serialize(s.urlAfterRedirects),i,r).pipe((0,ue.U)(f=>({...s,targetSnapshot:f}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),vi(V=>{if(i.targetSnapshot=V.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!V.extras.skipLocationChange){const ae=t.urlHandlingStrategy.merge(V.urlAfterRedirects,V.rawUrl);t.setBrowserUrl(ae,V)}t.browserUrlTree=V.urlAfterRedirects}const X=new Af(V.id,this.urlSerializer.serialize(V.extractedUrl),this.urlSerializer.serialize(V.urlAfterRedirects),V.targetSnapshot);this.events.next(X)}));if(I&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:V,extractedUrl:X,source:ae,restoredState:me,extras:Ie}=f,Ge=new Lh(V,this.urlSerializer.serialize(X),ae,me);this.events.next(Ge);const Je=Zp(X,this.rootComponentType).snapshot;return c(i={...f,targetSnapshot:Je,urlAfterRedirects:X,extras:{...Ie,skipLocationChange:!1,replaceUrl:!1}})}{const V="";return this.events.next(new qp(f.id,t.serializeUrl(i.extractedUrl),V,1)),t.rawUrlTree=f.rawUrl,f.resolve(null),et.E}}),vi(f=>{const b=new Hs(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(b)}),(0,ue.U)(f=>i={...f,guards:Qs(f.targetSnapshot,f.currentSnapshot,this.rootContexts)}),function U_(n,e){return(0,yn.z)(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:f}}=t;return 0===f.length&&0===s.length?c({...t,guardsResult:!0}):function j_(n,e,t,i){return(0,Mi.D)(n).pipe((0,yn.z)(r=>function Bd(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?c(s.map(b=>{const I=kf(e)??r,O=Eo(b,I);return hc(function au(n){return n&&Lf(n.canDeactivate)}(O)?O.canDeactivate(n,e,t,i):I.runInContext(()=>O(n,e,t,i))).pipe(Fi())})).pipe(nm()):c(!0)}(r.component,r.route,t,e,i)),Fi(r=>!0!==r,!0))}(f,i,r,n).pipe((0,yn.z)(b=>b&&function ax(n){return"boolean"==typeof n}(b)?function zv(n,e,t,i){return(0,Mi.D)(e).pipe(sr(r=>ot(function im(n,e){return null!==n&&e&&e(new tx(n)),c(!0)}(r.route.parent,i),function Bv(n,e){return null!==n&&e&&e(new al(n)),c(!0)}(r.route,i),function Vv(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(f=>function em(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(f)).filter(f=>null!==f).map(f=>Qe(()=>c(f.guards.map(I=>{const O=kf(f.node)??t,V=Eo(I,O);return hc(function HT(n){return n&&Lf(n.canActivateChild)}(V)?V.canActivateChild(i,n):O.runInContext(()=>V(i,n))).pipe(Fi())})).pipe(nm())));return c(s).pipe(nm())}(n,r.path,t),function Vh(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return c(!0);const r=i.map(s=>Qe(()=>{const f=kf(e)??t,b=Eo(s,f);return hc(function V_(n){return n&&Lf(n.canActivate)}(b)?b.canActivate(e,n):f.runInContext(()=>b(e,n))).pipe(Fi())}));return c(r).pipe(nm())}(n,r.route,t))),Fi(r=>!0!==r,!0))}(i,s,n,e):c(b)),(0,ue.U)(b=>({...t,guardsResult:b})))})}(this.environmentInjector,f=>this.events.next(f)),vi(f=>{if(i.guardsResult=f.guardsResult,Yu(f.guardsResult))throw Of(0,f.guardsResult);const b=new Qm(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot,!!f.guardsResult);this.events.next(b)}),Yt(f=>!!f.guardsResult||(t.restoreHistory(f),this.cancelNavigationTransition(f,"",3),!1)),cg(f=>{if(f.guards.canActivateChecks.length)return c(f).pipe(vi(b=>{const I=new _a(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot);this.events.next(I)}),dn(b=>{let I=!1;return c(b).pipe(function jo(n,e){return(0,yn.z)(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return c(t);let s=0;return(0,Mi.D)(r).pipe(sr(f=>function qv(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!jf(r)&&(s[Li]=r.title),function $1(n,e,t,i){const r=function lg(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return c({});const s={};return(0,Mi.D)(r).pipe((0,yn.z)(f=>function Wv(n,e,t,i){const r=kf(e)??i,s=Eo(n,r);return hc(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[f],e,t,i).pipe(Fi(),vi(b=>{s[f]=b}))),Fa(1),function Ki(n){return(0,ue.U)(()=>n)}(s),Mr(f=>tm(f)?et.E:Ot(f)))}(s,n,e,i).pipe((0,ue.U)(f=>(n._resolvedData=f,n.data=k_(n,t).resolve,r&&jf(r)&&(n.data[Li]=r.title),null)))}(f.route,i,n,e)),vi(()=>s++),Fa(1),(0,yn.z)(f=>s===r.length?c(t):et.E))})}(t.paramsInheritanceStrategy,this.environmentInjector),vi({next:()=>I=!0,complete:()=>{I||(t.restoreHistory(b),this.cancelNavigationTransition(b,"",2))}}))}),vi(b=>{const I=new su(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot);this.events.next(I)}))}),cg(f=>{const b=I=>{const O=[];I.routeConfig?.loadComponent&&!I.routeConfig._loadedComponent&&O.push(this.configLoader.loadComponent(I.routeConfig).pipe(vi(V=>{I.component=V}),(0,ue.U)(()=>{})));for(const V of I.children)O.push(...b(V));return O};return Fe(b(f.targetSnapshot.root)).pipe(xi(),Yn(1))}),cg(()=>this.afterPreactivation()),(0,ue.U)(f=>{const b=function bc(n,e,t){const i=Xu(n,e._root,t?t._root:void 0);return new Rv(i,e)}(t.routeReuseStrategy,f.targetSnapshot,f.currentRouterState);return i={...f,targetRouterState:b}}),vi(f=>{t.currentUrlTree=f.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(f.urlAfterRedirects,f.rawUrl),t.routerState=f.targetRouterState,"deferred"===t.urlUpdateStrategy&&(f.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,f),t.browserUrlTree=f.urlAfterRedirects)}),((n,e,t)=>(0,ue.U)(i=>(new ed(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,t.routeReuseStrategy,f=>this.events.next(f)),Yn(1),vi({next:f=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new Ba(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(f.targetRouterState.snapshot),f.resolve(!0)},complete:()=>{r=!0}}),Fr(()=>{r||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),Mr(f=>{if(s=!0,F_(f)){sx(f)||(t.navigated=!0,t.restoreHistory(i,!0));const b=new Df(i.id,this.urlSerializer.serialize(i.extractedUrl),f.message,f.cancellationCode);if(this.events.next(b),sx(f)){const I=t.urlHandlingStrategy.merge(f.url,t.rawUrlTree),O={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||yx(i.source)};t.scheduleNavigation(I,Mf,null,O,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{t.restoreHistory(i,!0);const b=new Ku(i.id,this.urlSerializer.serialize(i.extractedUrl),f,i.targetSnapshot??void 0);this.events.next(b);try{i.resolve(t.errorHandler(f))}catch(I){i.reject(I)}}return et.E}))}))}cancelNavigationTransition(t,i,r){const s=new Df(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function yx(n){return n!==Mf}let q_=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Xn);return i}getResolvedTitleForRoute(t){return t.data[Li]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:function(){return(0,d.f3M)(G1)},providedIn:"root"}),n})(),G1=(()=>{class n extends q_{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(mn))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Kv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:function(){return(0,d.f3M)(Z_)},providedIn:"root"}),n})();class W_{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let Z_=(()=>{class n extends W_{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Y_=new d.OlP("",{providedIn:"root",factory:()=>({})});let Bi=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:function(){return(0,d.f3M)(vx)},providedIn:"root"}),n})(),vx=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function bx(n){throw n}function X_(n,e,t){return e.parse("/")}const q1={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Xv={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Oo=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,d.f3M)(d.c2e),this.isNgZoneEnabled=!1,this.options=(0,d.f3M)(Y_,{optional:!0})||{},this.errorHandler=this.options.errorHandler||bx,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||X_,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,d.f3M)(Bi),this.routeReuseStrategy=(0,d.f3M)(Kv),this.urlCreationStrategy=(0,d.f3M)(ix),this.titleStrategy=(0,d.f3M)(q_),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=ma((0,d.f3M)(uu,{optional:!0})??[]),this.navigationTransitions=(0,d.f3M)(jd),this.urlSerializer=(0,d.f3M)(Zu),this.location=(0,d.f3M)(Jt),this.isNgZoneEnabled=(0,d.f3M)(d.R0b)instanceof d.R0b&&d.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Wu,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Zp(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Mf,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},f=r?.navigationId?r:null;if(r){const I={...r};delete I.navigationId,delete I.\u0275routerPageId,0!==Object.keys(I).length&&(s.state=I)}const b=this.parseUrl(t);this.scheduleNavigation(b,i,f,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(zd),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:f,queryParamsHandling:b,preserveFragment:I}=i,O=I?this.currentUrlTree.fragment:f;let V=null;switch(b){case"merge":V={...this.currentUrlTree.queryParams,...s};break;case"preserve":V=this.currentUrlTree.queryParams;break;default:V=s||null}return null!==V&&(V=this.removeEmptyProps(V)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,t,V,O??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Yu(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,Mf,null,i)}navigate(t,i={skipLocationChange:!1}){return function xx(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new d.vHH(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...q1}:!1===i?{...Xv}:i,Yu(t))return Vp(this.currentUrlTree,t,r);const s=this.parseUrl(t);return Vp(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,f){if(this.disposed)return Promise.resolve(!1);let b,I,O,V;return f?(b=f.resolve,I=f.reject,O=f.promise):O=new Promise((X,ae)=>{b=X,I=ae}),V="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:V,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:b,reject:I,promise:O,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),O.catch(X=>Promise.reject(X))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t),s={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===r?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===r&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),om=(()=>{class n{constructor(t,i,r,s,f,b){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=s,this.el=f,this.locationStrategy=b,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new g.x;const I=f.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===I||"area"===I,this.isAnchorElement?this.subscription=t.events.subscribe(O=>{O instanceof Ba&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=(0,d.D6c)(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=(0,d.D6c)(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=(0,d.D6c)(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,i,r,s,f){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||i||r||s||f||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:(0,d.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,i){const r=this.renderer,s=this.el.nativeElement;null!==i?r.setAttribute(s,t,i):r.removeAttribute(s,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(Oo),d.Y36(Nh),d.$8M("tabindex"),d.Y36(d.Qsj),d.Y36(d.SBq),d.Y36(Dn))},n.\u0275dir=d.lG2({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,i){1&t&&d.NdJ("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&t&&d.uIk("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[d.TTD]}),n})(),wx=(()=>{class n{get isActive(){return this._isActive}constructor(t,i,r,s,f){this.router=t,this.element=i,this.renderer=r,this.cdr=s,this.link=f,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new d.vpe,this.routerEventsSubscription=t.events.subscribe(b=>{b instanceof Ba&&this.update()})}ngAfterContentInit(){c(this.links.changes,c(null)).pipe((0,Ze.J)()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const t=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=(0,Mi.D)(t).pipe((0,Ze.J)()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(t){const i=Array.isArray(t)?t:t.split(" ");this.classes=i.filter(r=>!!r)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||Promise.resolve().then(()=>{const t=this.hasActiveLinks();this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.classes.forEach(i=>{t?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),t&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(t))})}isLinkActive(t){const i=function W1(n){return!!n.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>!!r.urlTree&&t.isActive(r.urlTree,i)}hasActiveLinks(){const t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(Oo),d.Y36(d.SBq),d.Y36(d.Qsj),d.Y36(d.sBO),d.Y36(om,8))},n.\u0275dir=d.lG2({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(t,i,r){if(1&t&&d.Suo(r,om,5),2&t){let s;d.iGM(s=d.CRH())&&(i.links=s)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[d.TTD]}),n})();class Q_{}let Y1=(()=>{class n{constructor(t,i,r,s,f){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=f}setUpPreloading(){this.subscription=this.router.events.pipe(Yt(t=>t instanceof Ba),sr(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=(0,d.MMx)(s.providers,t,`Route: ${s.path}`));const f=s._injector??t,b=s._loadedInjector??f;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(f,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(b,s.children??s._loadedRoutes))}return(0,Mi.D)(r).pipe((0,Ze.J)())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):c(null);const s=r.pipe((0,yn.z)(f=>null===f?c(void 0):(i._loadedRoutes=f.routes,i._loadedInjector=f.injector,this.processRoutes(f.injector??t,f.routes))));if(i.loadComponent&&!i._loadedComponent){const f=this.loader.loadComponent(i);return(0,Mi.D)([s,f]).pipe((0,Ze.J)())}return s})}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(Oo),d.LFG(d.Sil),d.LFG(d.lqb),d.LFG(Q_),d.LFG(ug))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const $f=new d.OlP("");let Gf=(()=>{class n{constructor(t,i,r,s,f={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=f,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},f.scrollPositionRestoration=f.scrollPositionRestoration||"disabled",f.anchorScrolling=f.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Lh?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Ba&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Dv&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Dv(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){d.$Z()},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();var va=(()=>((va=va||{})[va.COMPLETE=0]="COMPLETE",va[va.FAILED=1]="FAILED",va[va.REDIRECTING=2]="REDIRECTING",va))();const hg=!1;function td(n,e){return{\u0275kind:n,\u0275providers:e}}const lm=new d.OlP("",{providedIn:"root",factory:()=>!1});function J_(){const n=(0,d.f3M)(d.zs3);return e=>{const t=n.get(d.z2F);if(e!==t.components[0])return;const i=n.get(Oo),r=n.get(cm);1===n.get(ey)&&i.initialNavigation(),n.get(Tx,null,d.XFs.Optional)?.setUpPreloading(),n.get($f,null,d.XFs.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const cm=new d.OlP(hg?"bootstrap done indicator":"",{factory:()=>new g.x}),ey=new d.OlP(hg?"initial navigation":"",{providedIn:"root",factory:()=>1});function X1(){let n=[];return n=hg?[{provide:d.Xts,multi:!0,useFactory:()=>{const e=(0,d.f3M)(Oo);return()=>e.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function Av(n){if(!("type"in n))return`Unknown Router Event: ${n.constructor.name}`;switch(n.type){case 14:return`ActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state}, shouldActivate: ${n.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 2:return`NavigationCancel(id: ${n.id}, url: '${n.url}')`;case 16:return`NavigationSkipped(id: ${n.id}, url: '${n.url}')`;case 1:return`NavigationEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${n.id}, url: '${n.url}', error: ${n.error})`;case 0:return`NavigationStart(id: ${n.id}, url: '${n.url}')`;case 6:return`ResolveEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 5:return`ResolveStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 10:return`RouteConfigLoadEnd(path: ${n.route.path})`;case 9:return`RouteConfigLoadStart(path: ${n.route.path})`;case 4:return`RoutesRecognized(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 15:return`Scroll(anchor: '${n.anchor}', position: '${n.position?`${n.position[0]}, ${n.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],td(1,n)}const Tx=new d.OlP(hg?"router preloader":"");function Ix(n){return td(0,[{provide:Tx,useExisting:Y1},{provide:Q_,useExisting:n}])}const nd=!1,jh=new d.OlP(nd?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),Q1=[Jt,{provide:Zu,useClass:j},Oo,Xp,{provide:Nh,useFactory:function am(n){return n.routerState.root},deps:[Oo]},ug,nd?{provide:lm,useValue:!0}:[]];function ty(){return new d.PXZ("Router",Oo)}let Mx=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[Q1,nd&&i?.enableTracing?X1().\u0275providers:[],{provide:uu,multi:!0,useValue:t},{provide:jh,useFactory:J1,deps:[[Oo,new d.FiY,new d.tp0]]},{provide:Y_,useValue:i||{}},i?.useHash?{provide:Dn,useClass:Ft}:{provide:Dn,useClass:Ye},{provide:$f,useFactory:()=>{const n=(0,d.f3M)(Du),e=(0,d.f3M)(d.R0b),t=(0,d.f3M)(Y_),i=(0,d.f3M)(jd),r=(0,d.f3M)(Zu);return t.scrollOffset&&n.setOffset(t.scrollOffset),new Gf(r,i,n,e,t)}},i?.preloadingStrategy?Ix(i.preloadingStrategy).\u0275providers:[],{provide:d.PXZ,multi:!0,useFactory:ty},i?.initialNavigation?Ax(i):[],[{provide:pg,useFactory:J_},{provide:d.tb,multi:!0,useExisting:pg}]]}}static forChild(t){return{ngModule:n,providers:[{provide:uu,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(jh,8))},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[eg]}),n})();function J1(n){if(nd&&n)throw new d.vHH(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Ax(n){return["disabled"===n.initialNavigation?td(3,[{provide:d.ip1,multi:!0,useFactory:()=>{const e=(0,d.f3M)(Oo);return()=>{e.setUpLocationChangeListener()}}},{provide:ey,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?td(2,[{provide:ey,useValue:0},{provide:d.ip1,multi:!0,deps:[d.zs3],useFactory:e=>{const t=e.get(It,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(Oo),s=e.get(cm);(function qT(n,e){n.events.pipe(Yt(t=>t instanceof Ba||t instanceof Df||t instanceof Ku||t instanceof qp),(0,ue.U)(t=>t instanceof Ba||t instanceof qp?va.COMPLETE:t instanceof Df&&(0===t.code||1===t.code)?va.REDIRECTING:va.FAILED),Yt(t=>t!==va.REDIRECTING),Yn(1)).subscribe(()=>{e()})})(r,()=>{i(!0)}),e.get(jd).afterPreactivation=()=>(i(!0),s.closed?c(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const pg=new d.OlP(nd?"Router Initializer":"");var wc=Ae(9898);const mg_mapboxToken="pk.eyJ1Ijoic2VyZ2lvZ2RldiIsImEiOiJja3J2eW9zcGIwYmR2MnVxamJ3MGk0djRiIn0.R1ANSOBYyCstt-QxZcI5pg";function gg(n,e){if(1&n&&(d.TgZ(0,"div",19)(1,"div",20),d._UZ(2,"img",21),d.qZA(),d.TgZ(3,"div",22),d._uU(4),d.qZA()()),2&n){const t=e.$implicit,i=d.oxw();d.xp6(2),d.Q6J("src",i.iconPath+t.icon,d.LSH),d.xp6(2),d.hij(" ",t.text," ")}}function t0(n,e){if(1&n&&(d.TgZ(0,"div",23)(1,"div",20),d._UZ(2,"img",21),d.qZA(),d.TgZ(3,"div",24),d._uU(4),d.qZA()()),2&n){const t=e.$implicit,i=d.oxw();d.xp6(2),d.Q6J("src",i.iconPath+t.icon,d.LSH),d.xp6(2),d.hij(" ",t.text," ")}}let iy=(()=>{class n{constructor(){this.tituloMensajes="Hosteler\xeda, nuestra raz\xf3n de ser",this.vMensajes=[{text:"Nos dedicamos a mejorar el servicio de locales dedicados al sector hostelero.",icon:"icon-upgrade.png"},{text:"Aportamos creatividad, profesionalidad, planificaci\xf3n y soporte a las necesidades del negocio. ",icon:"icon-creativity.png"},{text:"Ofrecemos informaci\xf3n sobre las diferentes funciones y tramitaciones que pueden llevar a cabo.",icon:"icon-information.png"},{text:"Aplicamos nuevos mecanismos de trabajo al establecimiento.",icon:"icon-renew.png"},{text:"Ayudamos a plantear objetivos ambiciosos, viables y establecer   estrategias adecuadas exigiendo rigor en su cumplimiento.",icon:"icon-steps.png"},{text:"Acompa\xf1amiento de  adaptaci\xf3n  en el proceso.",icon:"icon-company.png"}],this.iconPath="../../../assets/icons/",this.vDondeEncontrarnos=[{text:"Ronda del Carmen, 13. C\xe1ceres (CP: 10002)",icon:"icon-map.png"},{text:"640 90 36 70",icon:"icon-phone.png"},{text:"contacto@hasspro.es",icon:"icon-email.png"},{text:"Hasspro_es",icon:"icon-instagram.png"},{text:"Hasspro \xc1vila",icon:"icon-facebook.png"},{text:"hasspro.es",icon:"icon-website.png"}],this.center=[-6.3757,39.4684],this.zoom=16,this.container="mapa-container"}ngOnInit(){window.scroll({top:0,left:0})}ngAfterViewInit(){wc.accessToken=mg_mapboxToken;var t=new wc.Map({container:"mapa-container",style:"mapbox://styles/mapbox/streets-v11",center:this.center,zoom:this.zoom,scrollZoom:!1});t.scrollZoom.disable(),t.boxZoom.disable(),t.dragRotate.disable(),t.dragPan.disable(),t.keyboard.disable(),t.doubleClickZoom.disable(),t.touchZoomRotate.disable(),(new wc.Marker).setLngLat(this.center).addTo(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-home"]],decls:26,vars:3,consts:[[1,"home-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"messages-container"],[1,"title","animate__animated","animate__fadeIn","animate__delay-1s"],[1,"mensajes-container","animate__animated","animate__fadeIn","animate__delay-1s"],["class","item-mensaje",4,"ngFor","ngForOf"],[1,"button-service","animate__animated","animate__fadeIn","animate__delay-1s"],[1,"direccion-container"],[1,"nos-conocemos-container","animate__animated","animate__fadeIn","animate__delay-1s"],[1,"title"],[1,"subtitle"],[1,"contact-list"],["class","item-contacto",4,"ngFor","ngForOf"],[1,"map-container"],["id","mapa-container"],[1,"item-mensaje"],[1,"icon"],[3,"src"],[1,"texto"],[1,"item-contacto"],[1,"text"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),d._UZ(4,"img",4),d.qZA(),d.TgZ(5,"h1",5),d._uU(6,"ASISTENTE PROFESIONAL DE HOSTELER\xcdA"),d.qZA()()(),d.TgZ(7,"div",6)(8,"div",7)(9,"h1"),d._uU(10),d.qZA()(),d.TgZ(11,"div",8),d.YNc(12,gg,5,2,"div",9),d.qZA(),d.TgZ(13,"div",10)(14,"button"),d._uU(15,"Encuentra tu servicio"),d.qZA()()(),d.TgZ(16,"div",11)(17,"div",12)(18,"div",13),d._uU(19," \xbfNos conocemos? "),d.qZA(),d.TgZ(20,"div",14),d._uU(21," Queremos escucharte y compartir nuestra experiencia contigo. Puedes encontrarnos en todos estos sitios: "),d.qZA(),d.TgZ(22,"div",15),d.YNc(23,t0,5,2,"div",16),d.qZA()(),d.TgZ(24,"div",17),d._UZ(25,"div",18),d.qZA()()()),2&t&&(d.xp6(10),d.Oqu(i.tituloMensajes),d.xp6(2),d.Q6J("ngForOf",i.vMensajes),d.xp6(11),d.Q6J("ngForOf",i.vDondeEncontrarnos))},dependencies:[ur],styles:[".home-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;width:100%;padding:80px 0}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;color:var(--principal-color);text-align:center;text-shadow:1px 1px 5px var(--principal-color-40);border-bottom:1px solid var(--principal-color);padding:8px 20px;margin-bottom:60px}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .mensajes-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;flex-wrap:wrap;gap:10px;max-width:1200px}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .mensajes-container[_ngcontent-%COMP%]   .item-mensaje[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:30px;width:270px;height:250px;border:1px solid var(--principal-color-light);border-radius:10px;padding:50px 30px 20px;background-color:var(--principal-color-light-20);box-shadow:1px 1px 10px var(--principal-color-40)}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .mensajes-container[_ngcontent-%COMP%]   .item-mensaje[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:auto}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .mensajes-container[_ngcontent-%COMP%]   .item-mensaje[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]{font-size:18px;font-weight:800;color:var(--principal-color);text-align:center}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .button-service[_ngcontent-%COMP%]{margin-top:80px}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .button-service[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 30px;background-color:transparent;color:var(--principal-color);border:2px solid var(--principal-color);font-size:24px;border-radius:5px;cursor:pointer;transition:.2s}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .button-service[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:var(--principal-color);color:var(--principal-color-light);border:2px solid var(--principal-color);transition:.2s}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;width:100%;background-color:var(--principal-color);color:var(--white-color)}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;padding:100px 40px;width:calc(50% - 80px);box-sizing:border-box}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:2.2rem;font-weight:700;text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-bottom:1px solid var(--principal-color-light);padding:8px 20px}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1.2rem;max-width:600px;font-weight:700;text-align:start;padding:8px 20px}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:20px}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .item-contacto[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;flex-direction:row;gap:20px}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .item-contacto[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:30px;height:auto}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .item-contacto[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:1rem;font-weight:700}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:50%;height:710px;box-sizing:border-box}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   #mapa-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column}@media screen and (min-width: 600px) and (max-width: 959px){.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;width:calc(100% - 16px);padding:8px 20px}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]{flex-direction:column}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%], .home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:100%}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]{padding:60px 20px}}@media screen and (max-width: 599px){.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]{flex-direction:column}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%], .home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:100%}}"]}),n})();function n0(...n){const e=(0,v.jO)(n),{args:t,keys:i}=oe(n),r=new L.y(s=>{const{length:f}=t;if(!f)return void s.complete();const b=new Array(f);let I=f,O=f;for(let V=0;V<f;V++){let X=!1;(0,Ut.Xf)(t[V]).subscribe((0,ve.x)(s,ae=>{X||(X=!0,O--),b[V]=ae},()=>I--,void 0,()=>{(!I||!X)&&(O||s.next(i?Te(i,b):b),s.complete())}))}});return e?r.pipe(ce(e)):r}let ry=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.Qsj),d.Y36(d.SBq))},n.\u0275dir=d.lG2({type:n}),n})(),id=(()=>{class n extends ry{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275dir=d.lG2({type:n,features:[d.qOj]}),n})();const Cc=new d.OlP("NgValueAccessor"),r0={provide:Cc,useExisting:(0,d.Gpc)(()=>_g),multi:!0},Hf=new d.OlP("CompositionEventMode");let _g=(()=>{class n extends ry{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function oy(){const n=Me()?Me().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.Qsj),d.Y36(d.SBq),d.Y36(Hf,8))},n.\u0275dir=d.lG2({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,i){1&t&&d.NdJ("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[d._Bn([r0]),d.qOj]}),n})();const Px=!1;function $l(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function Ox(n){return null!=n&&"number"==typeof n.length}const ba=new d.OlP("NgValidators"),ko=new d.OlP("NgAsyncValidators"),o0=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class du{static min(e){return function Lr(n){return e=>{if($l(e.value)||$l(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}(e)}static max(e){return function hm(n){return e=>{if($l(e.value)||$l(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}(e)}static required(e){return function sy(n){return $l(n.value)?{required:!0}:null}(e)}static requiredTrue(e){return function s0(n){return!0===n.value?null:{required:!0}}(e)}static email(e){return function rd(n){return $l(n.value)||o0.test(n.value)?null:{email:!0}}(e)}static minLength(e){return function qf(n){return e=>$l(e.value)||!Ox(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static maxLength(e){return function ay(n){return e=>Ox(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static pattern(e){return function kx(n){if(!n)return ly;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if($l(i.value))return null;const r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}(e)}static nullValidator(e){return null}static compose(e){return hu(e)}static composeAsync(e){return Wf(e)}}function ly(n){return null}function cy(n){return null!=n}function Rx(n){const e=(0,d.QGY)(n)?(0,Mi.D)(n):n;if(Px&&!(0,d.CqO)(e)){let t="Expected async validator to return Promise or Observable.";throw"object"==typeof n&&(t+=" Are you using a synchronous validator where an async validator is expected?"),new d.vHH(-1101,t)}return e}function Fx(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function Lx(n,e){return e.map(t=>t(n))}function Nx(n){return n.map(e=>function tC(n){return!n.validate}(e)?e:t=>e.validate(t))}function hu(n){if(!n)return null;const e=n.filter(cy);return 0==e.length?null:function(t){return Fx(Lx(t,e))}}function $h(n){return null!=n?hu(Nx(n)):null}function Wf(n){if(!n)return null;const e=n.filter(cy);return 0==e.length?null:function(t){return n0(Lx(t,e).map(Rx)).pipe((0,ue.U)(Fx))}}function uy(n){return null!=n?Wf(Nx(n)):null}function a0(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function zx(n){return n._rawValidators}function Bx(n){return n._rawAsyncValidators}function yg(n){return n?Array.isArray(n)?n:[n]:[]}function Gh(n,e){return Array.isArray(n)?n.includes(e):n===e}function l0(n,e){const t=yg(e);return yg(n).forEach(r=>{Gh(t,r)||t.push(r)}),t}function dl(n,e){return yg(e).filter(t=>!Gh(n,t))}class $d{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=$h(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=uy(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Jo extends $d{get formDirective(){return null}get path(){return null}}class hl extends $d{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class dy{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let vg=(()=>{class n extends dy{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(hl,2))},n.\u0275dir=d.lG2({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,i){2&t&&d.ekj("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[d.qOj]}),n})(),hy=(()=>{class n extends dy{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(Jo,10))},n.\u0275dir=d.lG2({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,i){2&t&&d.ekj("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[d.qOj]}),n})();function c0(n,e){return n?`with name: '${e}'`:`at index: ${e}`}const my=!1,Zf="VALID",Gd="INVALID",Yf="PENDING",Hh="DISABLED";function Eg(n){return(gy(n)?n.validators:n)||null}function mm(n,e){return(gy(e)?e.asyncValidators:n)||null}function gy(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function Gx(n,e,t){const i=n.controls;if(!(e?Object.keys(i):i).length)throw new d.vHH(1e3,my?function rC(n){return`\n    There are no form controls registered with this ${n?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(e):"");if(!i[t])throw new d.vHH(1001,my?function Cg(n,e){return`Cannot find form control ${c0(n,e)}`}(e,t):"")}function Hx(n,e,t){n._forEachChild((i,r)=>{if(void 0===t[r])throw new d.vHH(1002,my?function $x(n,e){return`Must supply a value for form control ${c0(n,e)}`}(e,r):"")})}class _y{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Zf}get invalid(){return this.status===Gd}get pending(){return this.status==Yf}get disabled(){return this.status===Hh}get enabled(){return this.status!==Hh}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(l0(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(l0(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(dl(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(dl(e,this._rawAsyncValidators))}hasValidator(e){return Gh(this._rawValidators,e)}hasAsyncValidator(e){return Gh(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Yf,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Hh,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Zf,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Zf||this.status===Yf)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Hh:Zf}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Yf,this._hasOwnPendingAsyncValidator=!0;const t=Rx(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new d.vpe,this.statusChanges=new d.vpe}_calculateStatus(){return this._allControlsDisabled()?Hh:this.errors?Gd:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Yf)?Yf:this._anyControlsHaveStatus(Gd)?Gd:Zf}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){gy(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function pm(n){return Array.isArray(n)?$h(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function u0(n){return Array.isArray(n)?uy(n):n||null}(this._rawAsyncValidators)}}class od extends _y{constructor(e,t,i){super(Eg(t),mm(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){Hx(this,!0,e),Object.keys(e).forEach(i=>{Gx(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(i=>{const r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,s)=>{i=t(i,r,s)}),i}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class yy extends od{}const Hd=new d.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>vy}),vy="always";function Tg(n,e,t=vy){Ig(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function xa(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&Ro(n,e)})}(n,e),function Xf(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function Mg(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&Ro(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function d0(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function qh(n,e,t=!0){const i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),Sg(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Kf(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function Ig(n,e){const t=zx(n);null!==e.validator?n.setValidators(a0(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=Bx(n);null!==e.asyncValidator?n.setAsyncValidators(a0(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();Kf(e._rawValidators,r),Kf(e._rawAsyncValidators,r)}function Sg(n,e){let t=!1;if(null!==n){if(null!==e.validator){const r=zx(n);if(Array.isArray(r)&&r.length>0){const s=r.filter(f=>f!==e.validator);s.length!==r.length&&(t=!0,n.setValidators(s))}}if(null!==e.asyncValidator){const r=Bx(n);if(Array.isArray(r)&&r.length>0){const s=r.filter(f=>f!==e.asyncValidator);s.length!==r.length&&(t=!0,n.setAsyncValidators(s))}}}const i=()=>{};return Kf(e._rawValidators,i),Kf(e._rawAsyncValidators,i),t}function Ro(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function qd(n,e){Ig(n,e)}function Qf(n,e){n._syncPendingControls(),e.forEach(t=>{const i=t.control;"submit"===i.updateOn&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}const h0={provide:Jo,useExisting:(0,d.Gpc)(()=>ym)},_m=(()=>Promise.resolve())();let ym=(()=>{class n extends Jo{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new d.vpe,this.form=new od({},$h(t),uy(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){_m.then(()=>{const i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),Tg(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){_m.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){_m.then(()=>{const i=this._findContainer(t.path),r=new od({});qd(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){_m.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){_m.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,Qf(this.form,this._directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(ba,10),d.Y36(ko,10),d.Y36(Hd,8))},n.\u0275dir=d.lG2({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,i){1&t&&d.NdJ("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[d._Bn([h0]),d.qOj]}),n})();function f0(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function by(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const vm=class extends _y{constructor(e=null,t,i){super(Eg(t),mm(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),gy(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=by(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){f0(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){f0(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){by(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};let kg=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=d.lG2({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),_0=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({}),n})();const Ey=new d.OlP("NgModelWithFormControlWarning"),pu={provide:Jo,useExisting:(0,d.Gpc)(()=>pl)};let pl=(()=>{class n extends Jo{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new d.vpe,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Sg(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const i=this.form.get(t.path);return Tg(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){qh(t.control||null,t,!1),function Jf(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this.submitted=!0,Qf(this.form,this.directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const i=t.control,r=this.form.get(t.path);i!==r&&(qh(i||null,t),(n=>n instanceof vm)(r)&&(Tg(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const i=this.form.get(t.path);qd(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const i=this.form.get(t.path);i&&function wa(n,e){return Sg(n,e)}(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Ig(this.form,this),this._oldForm&&Sg(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(ba,10),d.Y36(ko,10),d.Y36(Hd,8))},n.\u0275dir=d.lG2({type:n,selectors:[["","formGroup",""]],hostBindings:function(t,i){1&t&&d.NdJ("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[d._Bn([pu]),d.qOj,d.TTD]}),n})();const Ty={provide:hl,useExisting:(0,d.Gpc)(()=>tp)};let tp=(()=>{class n extends hl{set isDisabled(t){}constructor(t,i,r,s,f){super(),this._ngModelWarningConfig=f,this._added=!1,this.update=new d.vpe,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function Zd(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===_g?t=s:function Wd(n){return Object.getPrototypeOf(n.constructor)===id}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){this._added||this._setUpControl(),function Gl(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return function Ic(n,e){return[...e.path,n]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(t){return new(t||n)(d.Y36(Jo,13),d.Y36(ba,10),d.Y36(ko,10),d.Y36(Cc,10),d.Y36(Ey,8))},n.\u0275dir=d.lG2({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[d._Bn([Ty]),d.qOj,d.TTD]}),n})(),a=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[_0]}),n})();class o extends _y{constructor(e,t,i){super(Eg(t),mm(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){Hx(this,!1,e),e.forEach((i,r)=>{Gx(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>!!i._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function y(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let w=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const t=new n;return t.useNonNullable=!0,t}group(t,i=null){const r=this._reduceControls(t);let s={};return y(i)?s=i:null!==i&&(s.validators=i.validator,s.asyncValidators=i.asyncValidator),new od(r,s)}record(t,i=null){const r=this._reduceControls(t);return new yy(r,i)}control(t,i,r){let s={};return this.useNonNullable?(y(i)?s=i:(s.validators=i,s.asyncValidators=r),new vm(t,{...s,nonNullable:!0})):new vm(t,i,r)}array(t,i,r){const s=t.map(f=>this._createControl(f));return new o(s,i,r)}_reduceControls(t){const i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){return t instanceof vm||t instanceof _y?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),F=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Hd,useValue:t.callSetDisabledState??vy}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[a]}),n})(),U=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Ey,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Hd,useValue:t.callSetDisabledState??vy}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[a]}),n})();var xe,z=Ae(5861),Z=Ae(9681),te=Ae(4859),ie=Ae(1877),K=Ae(2090),pe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ee={},we=we||{},Ce=pe||self;function Le(){}function ke(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function st(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var bt="closure_uid_"+(1e9*Math.random()>>>0),Gt=0;function ht(n,e,t){return n.call.apply(n.bind,arguments)}function Tt(n,e,t){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),n.apply(e,r)}}return function(){return n.apply(e,arguments)}}function xt(n,e,t){return(xt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ht:Tt).apply(null,arguments)}function kt(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function At(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(i,r,s){for(var f=Array(arguments.length-2),b=2;b<arguments.length;b++)f[b-2]=arguments[b];return e.prototype[r].apply(i,f)}}function ct(){this.s=this.s,this.o=this.o}ct.prototype.s=!1,ct.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function rt(n){Object.prototype.hasOwnProperty.call(n,bt)&&n[bt]||(n[bt]=++Gt)}(this)},ct.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Wn=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function fn(n){const e=n.length;if(0<e){const t=Array(e);for(let i=0;i<e;i++)t[i]=n[i];return t}return[]}function An(n,e){for(let t=1;t<arguments.length;t++){const i=arguments[t];if(ke(i)){const r=n.length||0,s=i.length||0;n.length=r+s;for(let f=0;f<s;f++)n[r+f]=i[f]}else n.push(i)}}function Wt(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Wt.prototype.h=function(){this.defaultPrevented=!0};var ti=function(){if(!Ce.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{Ce.addEventListener("test",Le,e),Ce.removeEventListener("test",Le,e)}catch{}return n}();function Di(n){return/^[\s\xa0]*$/.test(n)}var Ri=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function Ai(n,e){return n<e?-1:n>e?1:0}function Jn(){var n=Ce.navigator;return n&&(n=n.userAgent)?n:""}function Gi(n){return-1!=Jn().indexOf(n)}function hi(n){return hi[" "](n),n}hi[" "]=Le;var mr,n,Tr=Gi("Opera"),yr=Gi("Trident")||Gi("MSIE"),Dr=Gi("Edge"),Ar=Dr||yr,Br=Gi("Gecko")&&!(-1!=Jn().toLowerCase().indexOf("webkit")&&!Gi("Edge"))&&!(Gi("Trident")||Gi("MSIE"))&&!Gi("Edge"),To=-1!=Jn().toLowerCase().indexOf("webkit")&&!Gi("Edge");function ws(){var n=Ce.document;return n?n.documentMode:void 0}e:{var Fo="",Io=(n=Jn(),Br?/rv:([^\);]+)(\)|;)/.exec(n):Dr?/Edge\/([\d\.]+)/.exec(n):yr?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):To?/WebKit\/(\S+)/.exec(n):Tr?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(Io&&(Fo=Io?Io[1]:""),yr){var nr=ws();if(null!=nr&&nr>parseFloat(Fo)){mr=String(nr);break e}}mr=Fo}var Yr={};var qs=Ce.document&&yr&&(ws()||parseInt(mr,10))||void 0;function Lo(n,e){if(Wt.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(Br){e:{try{hi(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Cs[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Lo.X.h.call(this)}}At(Lo,Wt);var Cs={2:"touch",3:"pen",4:"mouse"};Lo.prototype.h=function(){Lo.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var ps="closure_listenable_"+(1e6*Math.random()|0),Es=0;function yu(n,e,t,i,r){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!i,this.ha=r,this.key=++Es,this.ba=this.ea=!1}function cd(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function Wl(n,e,t){for(const i in n)e.call(t,n[i],i,n)}function wm(n){const e={};for(const t in n)e[t]=n[t];return e}const D0="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Zh(n,e){let t,i;for(let r=1;r<arguments.length;r++){for(t in i=arguments[r],i)n[t]=i[t];for(let s=0;s<D0.length;s++)t=D0[s],Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}}function Py(n){this.src=n,this.g={},this.h=0}function rp(n,e){var t=e.type;if(t in n.g){var s,i=n.g[t],r=Wn(i,e);(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(cd(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Oy(n,e,t,i){for(var r=0;r<n.length;++r){var s=n[r];if(!s.ba&&s.listener==e&&s.capture==!!t&&s.ha==i)return r}return-1}Py.prototype.add=function(n,e,t,i,r){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var f=Oy(n,e,i,r);return-1<f?(e=n[f],t||(e.ea=!1)):((e=new yu(e,this.src,s,!!i,r)).ea=t,n.push(e)),e};var Zl="closure_lm_"+(1e6*Math.random()|0),jg={};function op(n,e,t,i,r){if(i&&i.once)return Yd(n,e,t,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)op(n,e[s],t,i,r);return null}return t=P0(t),n&&n[ps]?n.N(e,t,st(i)?!!i.capture:!!i,r):mi(n,e,t,!1,i,r)}function mi(n,e,t,i,r,s){if(!e)throw Error("Invalid event type");var f=st(r)?!!r.capture:!!r,b=ud(n);if(b||(n[Zl]=b=new Py(n)),(t=b.add(e,t,i,f,s)).proxy)return t;if(i=function A0(){const e=ea;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=i,i.src=n,i.listener=t,n.addEventListener)ti||(r=f),void 0===r&&(r=!1),n.addEventListener(e.toString(),i,r);else if(n.attachEvent)n.attachEvent(Ga(e.toString()),i);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(i)}return t}function Yd(n,e,t,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Yd(n,e[s],t,i,r);return null}return t=P0(t),n&&n[ps]?n.O(e,t,st(i)?!!i.capture:!!i,r):mi(n,e,t,!0,i,r)}function ky(n,e,t,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)ky(n,e[s],t,i,r);else i=st(i)?!!i.capture:!!i,t=P0(t),n&&n[ps]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Oy(s=n.g[e],t,i,r))&&(cd(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=ud(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Oy(e,t,i,r)),(t=-1<n?e[n]:null)&&Yh(t))}function Yh(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[ps])rp(e.i,n);else{var t=n.type,i=n.proxy;e.removeEventListener?e.removeEventListener(t,i,n.capture):e.detachEvent?e.detachEvent(Ga(t),i):e.addListener&&e.removeListener&&e.removeListener(i),(t=ud(e))?(rp(t,n),0==t.h&&(t.src=null,e[Zl]=null)):cd(n)}}}function Ga(n){return n in jg?jg[n]:jg[n]="on"+n}function ea(n,e){if(n.ba)n=!0;else{e=new Lo(e,this);var t=n.listener,i=n.ha||n.src;n.ea&&Yh(n),n=t.call(i,e)}return n}function ud(n){return(n=n[Zl])instanceof Py?n:null}var _o="__closure_events_fn_"+(1e9*Math.random()>>>0);function P0(n){return"function"==typeof n?n:(n[_o]||(n[_o]=function(e){return n.handleEvent(e)}),n[_o])}function So(){ct.call(this),this.i=new Py(this),this.P=this,this.I=null}function Ca(n,e){var t,i=n.I;if(i)for(t=[];i;i=i.I)t.push(i);if(n=n.P,i=e.type||e,"string"==typeof e)e=new Wt(e,n);else if(e instanceof Wt)e.target=e.target||n;else{var r=e;Zh(e=new Wt(i,n),r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var f=e.g=t[s];r=ew(f,i,!0,e)&&r}if(r=ew(f=e.g=n,i,!0,e)&&r,r=ew(f,i,!1,e)&&r,t)for(s=0;s<t.length;s++)r=ew(f=e.g=t[s],i,!1,e)&&r}function ew(n,e,t,i){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var f=e[s];if(f&&!f.ba&&f.capture==t){var b=f.listener,I=f.ha||f.src;f.ea&&rp(n.i,f),r=!1!==b.call(I,i)&&r}}return r&&!i.defaultPrevented}At(So,ct),So.prototype[ps]=!0,So.prototype.removeEventListener=function(n,e,t,i){ky(this,n,e,t,i)},So.prototype.M=function(){if(So.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],i=0;i<t.length;i++)cd(t[i]);delete n.g[e],n.h--}}this.I=null},So.prototype.N=function(n,e,t,i){return this.i.add(String(n),e,!1,t,i)},So.prototype.O=function(n,e,t,i){return this.i.add(String(n),e,!0,t,i)};var tw=Ce.JSON.stringify;function XT(){var n=eI;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var $g,hC=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new QD,n=>n.reset());class QD{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function JD(n){Ce.setTimeout(()=>{throw n},0)}function JT(n,e){$g||function eA(){var n=Ce.Promise.resolve(void 0);$g=function(){n.then(nw)}}(),fC||($g(),fC=!0),eI.add(n,e)}var fC=!1,eI=new class QT{constructor(){this.h=this.g=null}add(e,t){const i=hC.get();i.set(e,t),this.h?this.h.next=i:this.g=i,this.h=i}};function nw(){for(var n;n=XT();){try{n.h.call(n.g)}catch(t){JD(t)}var e=hC;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}fC=!1}function O0(n,e){So.call(this),this.h=n||1,this.g=e||Ce,this.j=xt(this.lb,this),this.l=Date.now()}function iw(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function rw(n,e,t){if("function"==typeof n)t&&(n=xt(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=xt(n.handleEvent,n)}return 2147483647<Number(e)?-1:Ce.setTimeout(n,e||0)}function tI(n){n.g=rw(()=>{n.g=null,n.i&&(n.i=!1,tI(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}At(O0,So),(xe=O0.prototype).ca=!1,xe.R=null,xe.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Ca(this,"tick"),this.ca&&(iw(this),this.start()))}},xe.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},xe.M=function(){O0.X.M.call(this),iw(this),delete this.g};class k0 extends ct{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:tI(this)}M(){super.M(),this.g&&(Ce.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function sp(n){ct.call(this),this.h=n,this.g={}}At(sp,ct);var nI=[];function iI(n,e,t,i){Array.isArray(t)||(t&&(nI[0]=t.toString()),t=nI);for(var r=0;r<t.length;r++){var s=op(e,t[r],i||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function rI(n){Wl(n.g,function(e,t){this.g.hasOwnProperty(t)&&Yh(e)},n),n.g={}}function R0(){this.g=!0}function Ry(n,e,t,i){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function tA(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var i=t[n];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var f=1;f<r.length;f++)r[f]=""}}}return tw(t)}catch{return e}}(n,t)+(i?" "+i:"")})}sp.prototype.M=function(){sp.X.M.call(this),rI(this)},sp.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},R0.prototype.Aa=function(){this.g=!1},R0.prototype.info=function(){};var Gg={},nA=null;function pC(){return nA=nA||new So}function iA(n){Wt.call(this,Gg.Pa,n)}function ow(n){const e=pC();Ca(e,new iA(e))}function mC(n,e){Wt.call(this,Gg.STAT_EVENT,n),this.stat=e}function Ea(n){const e=pC();Ca(e,new mC(e,n))}function lI(n,e){Wt.call(this,Gg.Qa,n),this.size=e}function F0(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Ce.setTimeout(function(){n()},e)}Gg.Pa="serverreachability",At(iA,Wt),Gg.STAT_EVENT="statevent",At(mC,Wt),Gg.Qa="timingevent",At(lI,Wt);var L0={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},Fy={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function gC(){}function uI(){}gC.prototype.h=null;var sw,N0={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function dI(){Wt.call(this,"d")}function _C(){Wt.call(this,"c")}function aw(){}function z0(n,e,t,i){this.l=n,this.j=e,this.m=t,this.U=i||1,this.S=new sp(this),this.O=rA,this.T=new O0(n=Ar?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Ly}function Ly(){this.i=null,this.g="",this.h=!1}At(dI,Wt),At(_C,Wt),At(aw,gC),aw.prototype.g=function(){return new XMLHttpRequest},aw.prototype.i=function(){return{}},sw=new aw;var rA=45e3,lw={},cw={};function uw(n,e,t){n.K=1,n.v=j0(ap(e)),n.s=t,n.P=!0,hI(n,null)}function hI(n,e){n.F=Date.now(),B0(n),n.A=ap(n.v);var t=n.A,i=n.U;Array.isArray(i)||(i=[String(i)]),_I(t.i,"t",i),n.C=0,t=n.l.H,n.h=new Ly,n.g=Xd(n.l,t?e:null,!n.s),0<n.N&&(n.L=new k0(xt(n.La,n,n.g),n.N)),iI(n.S,n.g,"readystatechange",n.ib),e=n.H?wm(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),ow(),function oI(n,e,t,i,r,s){n.info(function(){if(n.g)if(s)for(var f="",b=s.split("&"),I=0;I<b.length;I++){var O=b[I].split("=");if(1<O.length){var V=O[0];O=O[1];var X=V.split("_");f=2<=X.length&&"type"==X[1]?f+(V+"=")+O+"&":f+(V+"=redacted&")}}else f=null;else f=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+t+"\n"+f})}(n.j,n.u,n.A,n.m,n.U,n.s)}function yC(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function fI(n,e,t){let r,i=!0;for(;!n.I&&n.C<t.length;){if(r=vC(n,t),r==cw){4==e&&(n.o=4,Ea(14),i=!1),Ry(n.j,n.m,null,"[Incomplete Response]");break}if(r==lw){n.o=4,Ea(15),Ry(n.j,n.m,t,"[Invalid Chunk]"),i=!1;break}Ry(n.j,n.m,r,null),xC(n,r)}yC(n)&&r!=cw&&r!=lw&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Ea(16),i=!1),n.i=n.i&&i,i?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),LC(e),e.K=!0,Ea(11))):(Ry(n.j,n.m,t,"[Invalid Chunked Response]"),Hg(n),U0(n))}function vC(n,e){var t=n.C,i=e.indexOf("\n",t);return-1==i?cw:(t=Number(e.substring(t,i)),isNaN(t)?lw:(i+=1)+t>e.length?cw:(e=e.substr(i,t),n.C=i+t,e))}function B0(n){n.V=Date.now()+n.O,bC(n,n.O)}function bC(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=F0(xt(n.gb,n),e)}function V0(n){n.B&&(Ce.clearTimeout(n.B),n.B=null)}function U0(n){0==n.l.G||n.I||FI(n.l,n)}function Hg(n){V0(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,iw(n.T),rI(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function xC(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||pw(t.h,n)))if(!n.J&&pw(t.h,n)&&3==t.G){try{var i=t.Fa.g.parse(e)}catch{i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;gw(t),Em(t)}RI(t),Ea(18)}}else t.Ba=r[1],0<t.Ba-t.T&&37500>r[2]&&t.L&&0==t.A&&!t.v&&(t.v=F0(xt(t.cb,t),6e3));if(1>=hA(t.h)&&t.ja){try{t.ja()}catch{}t.ja=void 0}}else Kd(t,11)}else if((n.J||t.g==n)&&gw(t),!Di(e))for(r=t.Fa.g.parse(e),e=0;e<r.length;e++){let O=r[e];if(t.T=O[0],O=O[1],2==t.G)if("c"==O[0]){t.I=O[1],t.ka=O[2];const V=O[3];null!=V&&(t.ma=V,t.j.info("VER="+t.ma));const X=O[4];null!=X&&(t.Ca=X,t.j.info("SVER="+t.Ca));const ae=O[5];null!=ae&&"number"==typeof ae&&0<ae&&(t.J=i=1.5*ae,t.j.info("backChannelRequestTimeoutMs_="+i)),i=t;const me=n.g;if(me){const Ie=me.g?me.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ie){var s=i.h;s.g||-1==Ie.indexOf("spdy")&&-1==Ie.indexOf("quic")&&-1==Ie.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(G0(s,s.h),s.h=null))}if(i.D){const Ge=me.g?me.g.getResponseHeader("X-HTTP-Session-Id"):null;Ge&&(i.za=Ge,ts(i.F,i.D,Ge))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var f=n;if((i=t).sa=_w(i,i.H?i.ka:null,i.V),f.J){xI(i.h,f);var b=f,I=i.J;I&&b.setTimeout(I),b.B&&(V0(b),B0(b)),i.g=f}else kI(i);0<t.i.length&&X0(t)}else"stop"!=O[0]&&"close"!=O[0]||Kd(t,7);else 3==t.G&&("stop"==O[0]||"close"==O[0]?"stop"==O[0]?Kd(t,7):OC(t):"noop"!=O[0]&&t.l&&t.l.wa(O),t.A=0)}ow()}catch{}}function CC(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(ke(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function oA(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(ke(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const i in n)e[t++]=i;return e}}}(n),i=function wC(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(ke(n)){for(var e=[],t=n.length,i=0;i<t;i++)e.push(n[i]);return e}for(i in e=[],t=0,n)e[t++]=n[i];return e}(n),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],t&&t[s],n)}(xe=z0.prototype).setTimeout=function(n){this.O=n},xe.ib=function(n){n=n.target;const e=this.L;e&&3==cp(n)?e.l():this.La(n)},xe.La=function(n){try{if(n==this.g)e:{const V=cp(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>V)&&(3!=V||Ar||this.g&&(this.h.h||this.g.fa()||DI(this.g)))){this.I||4!=V||7==e||ow(),V0(this);var t=this.g.aa();this.Y=t;t:if(yC(this)){var i=DI(this.g);n="";var r=i.length,s=4==cp(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Hg(this),U0(this);var f="";break t}this.h.i=new Ce.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,n+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=n,this.C=0,f=this.h.g}else f=this.g.fa();if(this.i=200==t,function sI(n,e,t,i,r,s,f){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+t+"\n"+s+" "+f})}(this.j,this.u,this.A,this.m,this.U,V,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var b,I=this.g;if((b=I.g?I.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Di(b)){var O=b;break t}}O=null}if(!(t=O)){this.i=!1,this.o=3,Ea(12),Hg(this),U0(this);break e}Ry(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,xC(this,t)}this.P?(fI(this,V,f),Ar&&this.i&&3==V&&(iI(this.S,this.T,"tick",this.hb),this.T.start())):(Ry(this.j,this.m,f,null),xC(this,f)),4==V&&Hg(this),this.i&&!this.I&&(4==V?FI(this.l,this):(this.i=!1,B0(this)))}else 400==t&&0<f.indexOf("Unknown SID")?(this.o=3,Ea(12)):(this.o=0,Ea(13)),Hg(this),U0(this)}}}catch{}},xe.hb=function(){if(this.g){var n=cp(this.g),e=this.g.fa();this.C<e.length&&(V0(this),fI(this,n,e),this.i&&4!=n&&B0(this))}},xe.cancel=function(){this.I=!0,Hg(this)},xe.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function aI(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(ow(),Ea(17)),Hg(this),this.o=2,U0(this)):bC(this,this.V-n)};var pI=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qg(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof qg){this.h=void 0!==e?e:n.h,dw(this,n.j),this.s=n.s,this.g=n.g,hw(this,n.m),this.l=n.l,e=n.i;var t=new Wg;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),mI(this,t),this.o=n.o}else n&&(t=String(n).match(pI))?(this.h=!!e,dw(this,t[1]||"",!0),this.s=Ny(t[2]||""),this.g=Ny(t[3]||"",!0),hw(this,t[4]),this.l=Ny(t[5]||"",!0),mI(this,t[6]||"",!0),this.o=Ny(t[7]||"")):(this.h=!!e,this.i=new Wg(null,this.h))}function ap(n){return new qg(n)}function dw(n,e,t){n.j=t?Ny(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function hw(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function mI(n,e,t){e instanceof Wg?(n.i=e,function dA(n,e){e&&!n.j&&(lp(n),n.i=null,n.g.forEach(function(t,i){var r=i.toLowerCase();i!=r&&(fw(this,i),_I(this,r,t))},n)),n.j=e}(n.i,n.h)):(t||(e=$0(e,uA)),n.i=new Wg(e,n.h))}function ts(n,e,t){n.i.set(e,t)}function j0(n){return ts(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Ny(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function $0(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,aA),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function aA(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}qg.prototype.toString=function(){var n=[],e=this.j;e&&n.push($0(e,EC,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push($0(e,EC,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push($0(t,"/"==t.charAt(0)?cA:lA,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",$0(t,TC)),n.join("")};var EC=/[#\/\?@]/g,lA=/[#\?:]/g,cA=/[#\?]/g,uA=/[#\?@]/g,TC=/#/g;function Wg(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function lp(n){n.g||(n.g=new Map,n.h=0,n.i&&function sA(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var i=n[t].indexOf("="),r=null;if(0<=i){var s=n[t].substring(0,i);r=n[t].substring(i+1)}else s=n[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function fw(n,e){lp(n),e=Cm(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function gI(n,e){return lp(n),e=Cm(n,e),n.g.has(e)}function _I(n,e,t){fw(n,e),0<t.length&&(n.i=null,n.g.set(Cm(n,e),fn(t)),n.h+=t.length)}function Cm(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function Zg(n){this.l=n||vI,n=Ce.PerformanceNavigationTiming?0<(n=Ce.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Ce.g&&Ce.g.Ga&&Ce.g.Ga()&&Ce.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(xe=Wg.prototype).add=function(n,e){lp(this),this.i=null,n=Cm(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},xe.forEach=function(n,e){lp(this),this.g.forEach(function(t,i){t.forEach(function(r){n.call(e,r,i,this)},this)},this)},xe.oa=function(){lp(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let i=0;i<e.length;i++){const r=n[i];for(let s=0;s<r.length;s++)t.push(e[i])}return t},xe.W=function(n){lp(this);let e=[];if("string"==typeof n)gI(this,n)&&(e=e.concat(this.g.get(Cm(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},xe.set=function(n,e){return lp(this),this.i=null,gI(this,n=Cm(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},xe.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},xe.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var i=e[t];const s=encodeURIComponent(String(i)),f=this.W(i);for(i=0;i<f.length;i++){var r=s;""!==f[i]&&(r+="="+encodeURIComponent(String(f[i]))),n.push(r)}}return this.i=n.join("&")};var vI=10;function bI(n){return!!n.h||!!n.g&&n.g.size>=n.j}function hA(n){return n.h?1:n.g?n.g.size:0}function pw(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function G0(n,e){n.g?n.g.add(e):n.h=e}function xI(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function mw(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return fn(n.i)}function IC(){}function wI(){this.g=new IC}function SC(n,e,t){const i=t||"";try{CC(n,function(r,s){let f=r;st(r)&&(f=tw(r)),e.push(i+s+"="+encodeURIComponent(f))})}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function H0(n,e,t,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch{}}function zy(n){this.l=n.ac||null,this.j=n.jb||!1}function q0(n,e){So.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=MC,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Zg.prototype.cancel=function(){if(this.i=mw(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},IC.prototype.stringify=function(n){return Ce.JSON.stringify(n,void 0)},IC.prototype.parse=function(n){return Ce.JSON.parse(n,void 0)},At(zy,gC),zy.prototype.g=function(){return new q0(this.l,this.j)},zy.prototype.i=function(n){return function(){return n}}({}),At(q0,So);var MC=0;function EI(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function W0(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Z0(n)}function Z0(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(xe=q0.prototype).open=function(n,e){if(this.readyState!=MC)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Z0(this)},xe.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||Ce).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},xe.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,W0(this)),this.readyState=MC},xe.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Z0(this)),this.g&&(this.readyState=3,Z0(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof Ce.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;EI(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},xe.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?W0(this):Z0(this),3==this.readyState&&EI(this)}},xe.Va=function(n){this.g&&(this.response=this.responseText=n,W0(this))},xe.Ua=function(n){this.g&&(this.response=n,W0(this))},xe.ga=function(){this.g&&W0(this)},xe.setRequestHeader=function(n,e){this.v.append(n,e)},xe.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},xe.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(q0.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var TI=Ce.JSON.parse;function Ls(n){So.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=DC,this.K=this.L=!1}At(Ls,So);var DC="",fA=/^https?$/i,pA=["POST","PUT"];function II(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,SI(n),Y0(n)}function SI(n){n.D||(n.D=!0,Ca(n,"complete"),Ca(n,"error"))}function AC(n){if(n.h&&typeof we<"u"&&(!n.C[1]||4!=cp(n)||2!=n.aa()))if(n.v&&4==cp(n))rw(n.Ha,0,n);else if(Ca(n,"readystatechange"),4==cp(n)){n.h=!1;try{const b=n.aa();e:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var i;if(i=0===b){var r=String(n.H).match(pI)[1]||null;if(!r&&Ce.self&&Ce.self.location){var s=Ce.self.location.protocol;r=s.substr(0,s.length-1)}i=!fA.test(r?r.toLowerCase():"")}t=i}if(t)Ca(n,"complete"),Ca(n,"success");else{n.m=6;try{var f=2<cp(n)?n.g.statusText:""}catch{f=""}n.j=f+" ["+n.aa()+"]",SI(n)}}finally{Y0(n)}}}function Y0(n,e){if(n.g){MI(n);const t=n.g,i=n.C[0]?Le:null;n.g=null,n.C=null,e||Ca(n,"ready");try{t.onreadystatechange=i}catch{}}}function MI(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(Ce.clearTimeout(n.A),n.A=null)}function cp(n){return n.g?n.g.readyState:0}function DI(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case DC:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function AI(n){let e="";return Wl(n,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function PC(n,e,t){e:{for(i in t){var i=!1;break e}i=!0}i||(t=AI(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):ts(n,e,t))}function K0(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function PI(n){this.Ca=0,this.i=[],this.j=new R0,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=K0("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=K0("baseRetryDelayMs",5e3,n),this.bb=K0("retryDelaySeedMs",1e4,n),this.$a=K0("forwardChannelMaxRetries",2,n),this.ta=K0("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new Zg(n&&n.concurrentRequestLimit),this.Fa=new wI,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function OC(n){if(kC(n),3==n.G){var e=n.U++,t=ap(n.F);ts(t,"SID",n.I),ts(t,"RID",e),ts(t,"TYPE","terminate"),By(n,t),(e=new z0(n,n.j,e,void 0)).K=2,e.v=j0(ap(t)),t=!1,Ce.navigator&&Ce.navigator.sendBeacon&&(t=Ce.navigator.sendBeacon(e.v.toString(),"")),!t&&Ce.Image&&((new Image).src=e.v,t=!0),t||(e.g=Xd(e.l,null),e.g.da(e.v)),e.F=Date.now(),B0(e)}NI(n)}function Em(n){n.g&&(LC(n),n.g.cancel(),n.g=null)}function kC(n){Em(n),n.u&&(Ce.clearTimeout(n.u),n.u=null),gw(n),n.h.cancel(),n.m&&("number"==typeof n.m&&Ce.clearTimeout(n.m),n.m=null)}function X0(n){bI(n.h)||n.m||(n.m=!0,JT(n.Ja,n),n.C=0)}function RC(n,e){var t;t=e?e.m:n.U++;const i=ap(n.F);ts(i,"SID",n.I),ts(i,"RID",t),ts(i,"AID",n.T),By(n,i),n.o&&n.s&&PC(i,n.o,n.s),t=new z0(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=FC(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),G0(n.h,t),uw(t,i,e)}function By(n,e){n.ia&&Wl(n.ia,function(t,i){ts(e,i,t)}),n.l&&CC({},function(t,i){ts(e,i,t)})}function FC(n,e,t){t=Math.min(n.i.length,t);var i=n.l?xt(n.l.Ra,n.l,n):null;e:{var r=n.i;let s=-1;for(;;){const f=["count="+t];-1==s?0<t?(s=r[0].h,f.push("ofs="+s)):s=0:f.push("ofs="+s);let b=!0;for(let I=0;I<t;I++){let O=r[I].h;const V=r[I].g;if(O-=s,0>O)s=Math.max(0,r[I].h-100),b=!1;else try{SC(V,f,"req"+O+"_")}catch{i&&i(V)}}if(b){i=f.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,i}function kI(n){n.g||n.u||(n.Z=1,JT(n.Ia,n),n.A=0)}function RI(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=F0(xt(n.Ia,n),LI(n,n.A)),n.A++,0))}function LC(n){null!=n.B&&(Ce.clearTimeout(n.B),n.B=null)}function NC(n){n.g=new z0(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=ap(n.sa);ts(e,"RID","rpc"),ts(e,"SID",n.I),ts(e,"CI",n.L?"0":"1"),ts(e,"AID",n.T),ts(e,"TYPE","xmlhttp"),By(n,e),n.o&&n.s&&PC(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=j0(ap(e)),t.s=null,t.P=!0,hI(t,n)}function gw(n){null!=n.v&&(Ce.clearTimeout(n.v),n.v=null)}function FI(n,e){var t=null;if(n.g==e){gw(n),LC(n),n.g=null;var i=2}else{if(!pw(n.h,e))return;t=e.D,xI(n.h,e),i=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==i){t=e.s?e.s.length:0,e=Date.now()-e.F;var r=n.C;Ca(i=pC(),new lI(i,t)),X0(n)}else kI(n);else if(3==(r=e.o)||0==r&&0<n.pa||!(1==i&&function OI(n,e){return!(hA(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=F0(xt(n.Ja,n,e),LI(n,n.C)),n.C++,0)))}(n,e)||2==i&&RI(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),r){case 1:Kd(n,5);break;case 4:Kd(n,10);break;case 3:Kd(n,6);break;default:Kd(n,2)}}function LI(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function Kd(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var i=xt(n.kb,n);t||(t=new qg("//www.google.com/images/cleardot.gif"),Ce.location&&"http"==Ce.location.protocol||dw(t,"https"),j0(t)),function CI(n,e){const t=new R0;if(Ce.Image){const i=new Image;i.onload=kt(H0,t,i,"TestLoadImage: loaded",!0,e),i.onerror=kt(H0,t,i,"TestLoadImage: error",!1,e),i.onabort=kt(H0,t,i,"TestLoadImage: abort",!1,e),i.ontimeout=kt(H0,t,i,"TestLoadImage: timeout",!1,e),Ce.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else e(!1)}(t.toString(),i)}else Ea(2);n.G=0,n.l&&n.l.va(e),NI(n),kC(n)}function NI(n){if(n.G=0,n.la=[],n.l){const e=mw(n.h);(0!=e.length||0!=n.i.length)&&(An(n.la,e),An(n.la,n.i),n.h.i.length=0,fn(n.i),n.i.length=0),n.l.ua()}}function _w(n,e,t){var i=t instanceof qg?ap(t):new qg(t,void 0);if(""!=i.g)e&&(i.g=e+"."+i.g),hw(i,i.m);else{var r=Ce.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new qg(null,void 0);i&&dw(s,i),e&&(s.g=e),r&&hw(s,r),t&&(s.l=t),i=s}return e=n.za,(t=n.D)&&e&&ts(i,t,e),ts(i,"VER",n.ma),By(n,i),i}function Xd(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ls(t&&n.Da&&!n.ra?new zy({jb:!0}):n.ra)).Ka(n.H),e}function zI(){}function Yg(){if(yr&&!(10<=Number(qs)))throw Error("Environmental error: no available transport.")}function Ha(n,e){So.call(this),this.g=new PI(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!Di(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Di(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Vy(this)}function BI(n){dI.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function VI(){_C.call(this),this.status=1}function Vy(n){this.g=n}(xe=Ls.prototype).Ka=function(n){this.L=n},xe.da=function(n,e,t,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():sw.g(),this.C=function cI(n){return n.h||(n.h=n.i())}(this.u?this.u:sw),this.g.onreadystatechange=xt(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(s){return void II(this,s)}if(n=t||"",t=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)t.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const s of i.keys())t.set(s,i.get(s))}i=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),r=Ce.FormData&&n instanceof Ce.FormData,!(0<=Wn(pA,e))||i||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,f]of t)this.g.setRequestHeader(s,f);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{MI(this),0<this.B&&((this.K=function AL(n){return yr&&function es(){return function Vi(n){var e=Yr;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=Ri(String(mr)).split("."),t=Ri("9").split("."),i=Math.max(e.length,t.length);for(let f=0;0==n&&f<i;f++){var r=e[f]||"",s=t[f]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==r[0].length&&0==s[0].length)break;n=Ai(0==r[1].length?0:parseInt(r[1],10),0==s[1].length?0:parseInt(s[1],10))||Ai(0==r[2].length,0==s[2].length)||Ai(r[2],s[2]),r=r[3],s=s[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=xt(this.qa,this)):this.A=rw(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){II(this,s)}},xe.qa=function(){typeof we<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ca(this,"timeout"),this.abort(8))},xe.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Ca(this,"complete"),Ca(this,"abort"),Y0(this))},xe.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Y0(this,!0)),Ls.X.M.call(this)},xe.Ha=function(){this.s||(this.F||this.v||this.l?AC(this):this.fb())},xe.fb=function(){AC(this)},xe.aa=function(){try{return 2<cp(this)?this.g.status:-1}catch{return-1}},xe.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},xe.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),TI(e)}},xe.Ea=function(){return this.m},xe.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(xe=PI.prototype).ma=8,xe.G=1,xe.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const r=new z0(this,this.j,n,void 0);let s=this.s;if(this.S&&(s?(s=wm(s),Zh(s,this.S)):s=this.S),null!==this.o||this.N||(r.H=s,s=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var i=this.i[t];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=FC(this,r,e),ts(t=ap(this.F),"RID",n),ts(t,"CVER",22),this.D&&ts(t,"X-HTTP-Session-Id",this.D),By(this,t),s&&(this.N?e="headers="+encodeURIComponent(String(AI(s)))+"&"+e:this.o&&PC(t,this.o,s)),G0(this.h,r),this.Ya&&ts(t,"TYPE","init"),this.O?(ts(t,"$req",e),ts(t,"SID","null"),r.Z=!0,uw(r,t,null)):uw(r,t,e),this.G=2}}else 3==this.G&&(n?RC(this,n):0==this.i.length||bI(this.h)||RC(this))},xe.Ia=function(){if(this.u=null,NC(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=F0(xt(this.eb,this),n)}},xe.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Ea(10),Em(this),NC(this))},xe.cb=function(){null!=this.v&&(this.v=null,Em(this),RI(this),Ea(19))},xe.kb=function(n){n?(this.j.info("Successfully pinged google.com"),Ea(2)):(this.j.info("Failed to ping google.com"),Ea(1))},(xe=zI.prototype).xa=function(){},xe.wa=function(){},xe.va=function(){},xe.ua=function(){},xe.Ra=function(){},Yg.prototype.g=function(n,e){return new Ha(n,e)},At(Ha,So),Ha.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;Ea(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=_w(n,null,n.V),X0(n)},Ha.prototype.close=function(){OC(this.g)},Ha.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=tw(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.ab++,n)),3==e.G&&X0(e)},Ha.prototype.M=function(){this.g.l=null,delete this.j,OC(this.g),delete this.g,Ha.X.M.call(this)},At(BI,dI),At(VI,_C),At(Vy,zI),Vy.prototype.xa=function(){Ca(this.g,"a")},Vy.prototype.wa=function(n){Ca(this.g,new BI(n))},Vy.prototype.va=function(n){Ca(this.g,new VI)},Vy.prototype.ua=function(){Ca(this.g,"b")},Yg.prototype.createWebChannel=Yg.prototype.g,Ha.prototype.send=Ha.prototype.u,Ha.prototype.open=Ha.prototype.m,Ha.prototype.close=Ha.prototype.close,L0.NO_ERROR=0,L0.TIMEOUT=8,L0.HTTP_ERROR=6,Fy.COMPLETE="complete",uI.EventType=N0,N0.OPEN="a",N0.CLOSE="b",N0.ERROR="c",N0.MESSAGE="d",So.prototype.listen=So.prototype.N,Ls.prototype.listenOnce=Ls.prototype.O,Ls.prototype.getLastError=Ls.prototype.Oa,Ls.prototype.getLastErrorCode=Ls.prototype.Ea,Ls.prototype.getStatus=Ls.prototype.aa,Ls.prototype.getResponseJson=Ls.prototype.Sa,Ls.prototype.getResponseText=Ls.prototype.fa,Ls.prototype.send=Ls.prototype.da,Ls.prototype.setWithCredentials=Ls.prototype.Ka;var yw=Ee.createWebChannelTransport=function(){return new Yg},vw=Ee.getStatEventTarget=function(){return pC()},zC=Ee.ErrorCode=L0,mA=Ee.EventType=Fy,UI=Ee.Event=Gg,BC=Ee.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},VC=Ee.FetchXmlHttpFactory=zy,Q0=Ee.WebChannel=uI,UC=Ee.XhrIo=Ls;const bw="@firebase/firestore";class ta{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ta.UNAUTHENTICATED=new ta(null),ta.GOOGLE_CREDENTIALS=new ta("google-credentials-uid"),ta.FIRST_PARTY=new ta("first-party-uid"),ta.MOCK_USER=new ta("mock-user");let Tm="9.19.0";const Kh=new ie.Yd("@firebase/firestore");function jC(){return Kh.logLevel}function sn(n,...e){if(Kh.logLevel<=ie.in.DEBUG){const t=e.map(J0);Kh.debug(`Firestore (${Tm}): ${n}`,...t)}}function Ns(n,...e){if(Kh.logLevel<=ie.in.ERROR){const t=e.map(J0);Kh.error(`Firestore (${Tm}): ${n}`,...t)}}function Qd(n,...e){if(Kh.logLevel<=ie.in.WARN){const t=e.map(J0);Kh.warn(`Firestore (${Tm}): ${n}`,...t)}}function J0(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Hn(n="Unexpected state"){const e=`FIRESTORE (${Tm}) INTERNAL ASSERTION FAILED: `+n;throw Ns(e),new Error(e)}function si(n,e){n||Hn()}function kn(n,e){return n}const Et={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Zt extends K.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ws{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class $I{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class GI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ta.UNAUTHENTICATED))}shutdown(){}}class HI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Yl{constructor(e){this.t=e,this.currentUser=ta.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var i=this;let r=this.i;const s=O=>this.i!==r?(r=this.i,t(O)):Promise.resolve();let f=new Ws;this.o=()=>{this.i++,this.currentUser=this.u(),f.resolve(),f=new Ws,e.enqueueRetryable(()=>s(this.currentUser))};const b=()=>{const O=f;e.enqueueRetryable((0,z.Z)(function*(){yield O.promise,yield s(i.currentUser)}))},I=O=>{sn("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=O,this.auth.addAuthTokenListener(this.o),b()};this.t.onInit(O=>I(O)),setTimeout(()=>{if(!this.auth){const O=this.t.getImmediate({optional:!0});O?I(O):(sn("FirebaseAuthCredentialsProvider","Auth not yet detected"),f.resolve(),f=new Ws)}},0),b()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(sn("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(si("string"==typeof i.accessToken),new $I(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return si(null===e||"string"==typeof e),new ta(e)}}class Uy{constructor(e,t,i){this.h=e,this.l=t,this.m=i,this.type="FirstParty",this.user=ta.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class _A{constructor(e,t,i){this.h=e,this.l=t,this.m=i}getToken(){return Promise.resolve(new Uy(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(ta.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class qI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class PL{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const i=s=>{null!=s.error&&sn("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const f=s.token!==this.T;return this.T=s.token,sn("FirebaseAppCheckTokenProvider",`Received ${f?"new":"existing"} token.`),f?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{sn("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?r(s):sn("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(si("string"==typeof t.token),this.T=t.token,new qI(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function WI(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class xw{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const r=WI(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}}function Oi(n,e){return n<e?-1:n>e?1:0}function jy(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}function ww(n){return n+"\0"}class Go{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Zt(Et.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Zt(Et.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Zt(Et.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Zt(Et.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Go.fromMillis(Date.now())}static fromDate(e){return Go.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Go(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Oi(this.nanoseconds,e.nanoseconds):Oi(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class fi{constructor(e){this.timestamp=e}static fromTimestamp(e){return new fi(e)}static min(){return new fi(new Go(0,0))}static max(){return new fi(new Go(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class eb{constructor(e,t,i){void 0===t?t=0:t>e.length&&Hn(),void 0===i?i=e.length-t:i>e.length-t&&Hn(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return 0===eb.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof eb?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=e.get(r),f=t.get(r);if(s<f)return-1;if(s>f)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Pr extends eb{construct(e,t,i){return new Pr(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Zt(Et.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new Pr(t)}static emptyPath(){return new Pr([])}}const yA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ns extends eb{construct(e,t,i){return new ns(e,t,i)}static isValidIdentifier(e){return yA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ns.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ns(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(0===i.length)throw new Zt(Et.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let f=!1;for(;r<e.length;){const b=e[r];if("\\"===b){if(r+1===e.length)throw new Zt(Et.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const I=e[r+1];if("\\"!==I&&"."!==I&&"`"!==I)throw new Zt(Et.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=I,r+=2}else"`"===b?(f=!f,r++):"."!==b||f?(i+=b,r++):(s(),r++)}if(s(),f)throw new Zt(Et.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ns(t)}static emptyPath(){return new ns([])}}class Pn{constructor(e){this.path=e}static fromPath(e){return new Pn(Pr.fromString(e))}static fromName(e){return new Pn(Pr.fromString(e).popFirst(5))}static empty(){return new Pn(Pr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Pr.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Pr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Pn(new Pr(e.slice()))}}class tb{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function $y(n){return n.fields.find(e=>2===e.kind)}function up(n){return n.fields.filter(e=>2!==e.kind)}tb.UNKNOWN_ID=-1;class nb{constructor(e,t){this.fieldPath=e,this.kind=t}}class Gy{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Gy(0,Sc.min())}}function Kg(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=fi.fromTimestamp(1e9===i?new Go(t+1,0):new Go(t,i));return new Sc(r,Pn.empty(),e)}function ZI(n){return new Sc(n.readTime,n.key,-1)}class Sc{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Sc(fi.min(),Pn.empty(),-1)}static max(){return new Sc(fi.max(),Pn.empty(),-1)}}function ib(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=Pn.comparator(n.documentKey,e.documentKey),0!==t?t:Oi(n.largestBatchId,e.largestBatchId))}const bA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class YI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Xg(n){return $C.apply(this,arguments)}function $C(){return $C=(0,z.Z)(function*(n){if(n.code!==Et.FAILED_PRECONDITION||n.message!==bA)throw n;sn("LocalStore","Unexpectedly lost primary lease")}),$C.apply(this,arguments)}class wt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Hn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new wt((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof wt?t:wt.resolve(t)}catch(t){return wt.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):wt.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):wt.reject(t)}static resolve(e){return new wt((t,i)=>{t(e)})}static reject(e){return new wt((t,i)=>{i(e)})}static waitFor(e){return new wt((t,i)=>{let r=0,s=0,f=!1;e.forEach(b=>{++r,b.next(()=>{++s,f&&s===r&&t()},I=>i(I))}),f=!0,s===r&&t()})}static or(e){let t=wt.resolve(!1);for(const i of e)t=t.next(r=>r?wt.resolve(r):i());return t}static forEach(e,t){const i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new wt((i,r)=>{const s=e.length,f=new Array(s);let b=0;for(let I=0;I<s;I++){const O=I;t(e[O]).next(V=>{f[O]=V,++b,b===s&&i(f)},V=>r(V))}})}static doWhile(e,t){return new wt((i,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):i()};s()})}}class Cw{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.R=new Ws,this.transaction.oncomplete=()=>{this.R.resolve()},this.transaction.onabort=()=>{t.error?this.R.reject(new rb(e,t.error)):this.R.resolve()},this.transaction.onerror=i=>{const r=Ew(i.target.error);this.R.reject(new rb(e,r))}}static open(e,t,i,r){try{return new Cw(t,e.transaction(r,i))}catch(s){throw new rb(t,s)}}get v(){return this.R.promise}abort(e){e&&this.R.reject(e),this.aborted||(sn("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new XI(t)}}class dd{constructor(e,t,i){this.name=e,this.version=t,this.V=i,12.2===dd.S((0,K.z$)())&&Ns("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return sn("SimpleDb","Removing database:",e),Qg(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,K.hl)())return!1;if(dd.C())return!0;const e=(0,K.z$)(),t=dd.S(e),i=0<t&&t<10,r=dd.N(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.k)}static O(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}static N(e){const t=e.match(/Android ([\d.]+)/i),i=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(i)}$(e){var t=this;return(0,z.Z)(function*(){return t.db||(sn("SimpleDb","Opening database:",t.name),t.db=yield new Promise((i,r)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=f=>{i(f.target.result)},s.onblocked=()=>{r(new rb(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=f=>{const b=f.target.error;r("VersionError"===b.name?new Zt(Et.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===b.name?new Zt(Et.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+b):new rb(e,b))},s.onupgradeneeded=f=>{sn("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',f.oldVersion),t.V.M(f.target.result,s.transaction,f.oldVersion,t.version).next(()=>{sn("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.F&&(t.db.onversionchange=i=>t.F(i)),t.db})()}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,r){var s=this;return(0,z.Z)(function*(){const f="readonly"===t;let b=0;for(;;){++b;try{s.db=yield s.$(e);const I=Cw.open(s.db,e,f?"readonly":"readwrite",i),O=r(I).next(V=>(I.P(),V)).catch(V=>(I.abort(V),wt.reject(V))).toPromise();return O.catch(()=>{}),yield I.v,O}catch(I){const O=I,V="FirebaseError"!==O.name&&b<3;if(sn("SimpleDb","Transaction failed with error:",O.message,"Retrying:",V),s.close(),!V)return Promise.reject(O)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class KI{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return Qg(this.L.delete())}}class rb extends Zt{constructor(e,t){super(Et.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function dp(n){return"IndexedDbTransactionError"===n.name}class XI{constructor(e){this.store=e}put(e,t){let i;return void 0!==t?(sn("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(sn("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Qg(i)}add(e){return sn("SimpleDb","ADD",this.store.name,e,e),Qg(this.store.add(e))}get(e){return Qg(this.store.get(e)).next(t=>(void 0===t&&(t=null),sn("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return sn("SimpleDb","DELETE",this.store.name,e),Qg(this.store.delete(e))}count(){return sn("SimpleDb","COUNT",this.store.name),Qg(this.store.count())}j(e,t){const i=this.options(e,t);if(i.index||"function"!=typeof this.store.getAll){const r=this.cursor(i),s=[];return this.W(r,(f,b)=>{s.push(b)}).next(()=>s)}{const r=this.store.getAll(i.range);return new wt((s,f)=>{r.onerror=b=>{f(b.target.error)},r.onsuccess=b=>{s(b.target.result)}})}}H(e,t){const i=this.store.getAll(e,null===t?void 0:t);return new wt((r,s)=>{i.onerror=f=>{s(f.target.error)},i.onsuccess=f=>{r(f.target.result)}})}J(e,t){sn("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,t);i.Y=!1;const r=this.cursor(i);return this.W(r,(s,f,b)=>b.delete())}Z(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.W(r,t)}X(e){const t=this.cursor({});return new wt((i,r)=>{t.onerror=s=>{const f=Ew(s.target.error);r(f)},t.onsuccess=s=>{const f=s.target.result;f?e(f.primaryKey,f.value).next(b=>{b?f.continue():i()}):i()}})}W(e,t){const i=[];return new wt((r,s)=>{e.onerror=f=>{s(f.target.error)},e.onsuccess=f=>{const b=f.target.result;if(!b)return void r();const I=new KI(b),O=t(b.primaryKey,b.value,I);if(O instanceof wt){const V=O.catch(X=>(I.done(),wt.reject(X)));i.push(V)}I.isDone?r():null===I.K?b.continue():b.continue(I.K)}}).next(()=>wt.waitFor(i))}options(e,t){let i;return void 0!==e&&("string"==typeof e?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.Y?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Qg(n){return new wt((e,t)=>{n.onsuccess=i=>{e(i.target.result)},n.onerror=i=>{const r=Ew(i.target.error);t(r)}})}let QI=!1;function Ew(n){const e=dd.S((0,K.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Zt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return QI||(QI=!0,setTimeout(()=>{throw i},0)),i}}return n}class xA{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){var t=this;sn("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,z.Z)(function*(){t.task=null;try{sn("IndexBackiller",`Documents written: ${yield t.tt.nt()}`)}catch(i){dp(i)?sn("IndexBackiller","Ignoring IndexedDB error during index backfill: ",i):yield Xg(i)}yield t.et(6e4)}))}}class JI{constructor(e,t){this.localStore=e,this.persistence=t}nt(e=50){var t=this;return(0,z.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",i=>t.st(i,e))})()}st(e,t){const i=new Set;let r=t,s=!0;return wt.doWhile(()=>!0===s&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(f=>{if(null!==f&&!i.has(f))return sn("IndexBackiller",`Processing collection: ${f}`),this.it(e,f,r).next(b=>{r-=b,i.add(f)});s=!1})).next(()=>t-r)}it(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(s=>{const f=s.changes;return this.localStore.indexManager.updateIndexEntries(e,f).next(()=>this.rt(r,s)).next(b=>(sn("IndexBackiller",`Updating offset: ${b}`),this.localStore.indexManager.updateCollectionGroup(e,t,b))).next(()=>f.size)}))}rt(e,t){let i=e;return t.changes.forEach((r,s)=>{const f=ZI(s);ib(f,i)>0&&(i=f)}),new Sc(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}let Mc=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>i.writeSequenceNumber(r))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return n.ct=-1,n})();function Hy(n){return null==n}function qy(n){return 0===n&&1/n==-1/0}function eS(n){return"number"==typeof n&&Number.isInteger(n)&&!qy(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Kl(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=GC(e)),e=kL(n.get(t),e);return GC(e)}function kL(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function GC(n){return n+"\x01\x01"}function hp(n){const e=n.length;if(si(e>=2),2===e)return si("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Pr.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const f=n.indexOf("\x01",s);switch((f<0||f>t)&&Hn(),n.charAt(f+1)){case"\x01":const b=n.substring(s,f);let I;0===r.length?I=b:(r+=b,I=r,r=""),i.push(I);break;case"\x10":r+=n.substring(s,f),r+="\0";break;case"\x11":r+=n.substring(s,f+1);break;default:Hn()}s=f+2}return new Pr(i)}const wA=["userId","batchId"];function HC(n,e){return[n,Kl(e)]}function CA(n,e,t){return[n,Kl(e),t]}const RL={},FL=["prefixPath","collectionGroup","readTime","documentId"],LL=["prefixPath","collectionGroup","documentId"],NL=["collectionGroup","readTime","prefixPath","documentId"],Tw=["canonicalId","targetId"],zL=["targetId","path"],tS=["path","targetId"],Iw=["collectionId","parent"],nS=["indexId","uid"],iS=["uid","sequenceNumber"],BL=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],qC=["indexId","uid","orderedDocumentKey"],rS=["userId","collectionPath","documentId"],EA=["userId","collectionPath","largestBatchId"],VL=["userId","collectionGroup","largestBatchId"],oS=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],TA=[...oS,"documentOverlays"],sS=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ob=sS,IA=[...ob,"indexConfiguration","indexState","indexEntries"];class aS extends YI{constructor(e,t){super(),this.at=e,this.currentSequenceNumber=t}}function qa(n,e){const t=kn(n);return dd.O(t.at,e)}function SA(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Jg(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function lS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Ts{constructor(e,t){this.comparator=e,this.root=t||Wa.EMPTY}insert(e,t){return new Ts(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Wa.BLACK,null,null))}remove(e){return new Ts(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wa.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(0===i)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(0===r)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new WC(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new WC(this.root,e,this.comparator,!1)}getReverseIterator(){return new WC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new WC(this.root,e,this.comparator,!0)}}class WC{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Wa{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??Wa.RED,this.left=r??Wa.EMPTY,this.right=s??Wa.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new Wa(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Wa.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Wa.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Wa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Wa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Hn();const e=this.left.check();if(e!==this.right.check())throw Hn();return e+(this.isRed()?0:1)}}Wa.EMPTY=null,Wa.RED=!0,Wa.BLACK=!1,Wa.EMPTY=new class{constructor(){this.size=0}get key(){throw Hn()}get value(){throw Hn()}get color(){throw Hn()}get left(){throw Hn()}get right(){throw Hn()}copy(n,e,t,i,r){return this}insert(n,e,t){return new Wa(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class io{constructor(e){this.comparator=e,this.data=new Ts(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ZC(this.data.getIterator())}getIteratorFrom(e){return new ZC(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof io)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(0!==this.comparator(r,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new io(this.comparator);return t.data=e,t}}class ZC{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function sb(n){return n.hasNext()?n.getNext():void 0}class is{constructor(e){this.fields=e,e.sort(ns.comparator)}static empty(){return new is([])}unionWith(e){let t=new io(ns.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new is(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return jy(this.fields,e.fields,(t,i)=>t.isEqual(i))}}class MA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class na{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new MA("Invalid base64 string: "+r):r}}(e);return new na(t)}static fromUint8Array(e){const t=function(i){let r="";for(let s=0;s<i.length;++s)r+=String.fromCharCode(i[s]);return r}(e);return new na(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Oi(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}na.EMPTY_BYTE_STRING=new na("");const UL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ia(n){if(si(!!n),"string"==typeof n){let e=0;const t=UL.exec(n);if(si(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Is(n.seconds),nanos:Is(n.nanos)}}function Is(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function fp(n){return"string"==typeof n?na.fromBase64String(n):na.fromUint8Array(n)}function KC(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function cS(n){const e=n.mapValue.fields.__previous_value__;return KC(e)?cS(e):e}function e_(n){const e=ia(n.mapValue.fields.__local_write_time__.timestampValue);return new Go(e.seconds,e.nanos)}class uS{constructor(e,t,i,r,s,f,b,I){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=f,this.autoDetectLongPolling=b,this.useFetchStreams=I}}class pp{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new pp("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof pp&&e.projectId===this.projectId&&e.database===this.database}}const Im={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ab={nullValue:"NULL_VALUE"};function Sm(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?KC(n)?4:hS(n)?9007199254740991:10:Hn()}function Xh(n,e){if(n===e)return!0;const t=Sm(n);if(t!==Sm(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return e_(n).isEqual(e_(e));case 3:return function(i,r){if("string"==typeof i.timestampValue&&"string"==typeof r.timestampValue&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const s=ia(i.timestampValue),f=ia(r.timestampValue);return s.seconds===f.seconds&&s.nanos===f.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return r=e,fp(n.bytesValue).isEqual(fp(r.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,r){return Is(i.geoPointValue.latitude)===Is(r.geoPointValue.latitude)&&Is(i.geoPointValue.longitude)===Is(r.geoPointValue.longitude)}(n,e);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return Is(i.integerValue)===Is(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const s=Is(i.doubleValue),f=Is(r.doubleValue);return s===f?qy(s)===qy(f):isNaN(s)&&isNaN(f)}return!1}(n,e);case 9:return jy(n.arrayValue.values||[],e.arrayValue.values||[],Xh);case 10:return function(i,r){const s=i.mapValue.fields||{},f=r.mapValue.fields||{};if(SA(s)!==SA(f))return!1;for(const b in s)if(s.hasOwnProperty(b)&&(void 0===f[b]||!Xh(s[b],f[b])))return!1;return!0}(n,e);default:return Hn()}var r}function Wy(n,e){return void 0!==(n.values||[]).find(t=>Xh(t,e))}function Mm(n,e){if(n===e)return 0;const t=Sm(n),i=Sm(e);if(t!==i)return Oi(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Oi(n.booleanValue,e.booleanValue);case 2:return function(r,s){const f=Is(r.integerValue||r.doubleValue),b=Is(s.integerValue||s.doubleValue);return f<b?-1:f>b?1:f===b?0:isNaN(f)?isNaN(b)?0:-1:1}(n,e);case 3:return Sw(n.timestampValue,e.timestampValue);case 4:return Sw(e_(n),e_(e));case 5:return Oi(n.stringValue,e.stringValue);case 6:return function(r,s){const f=fp(r),b=fp(s);return f.compareTo(b)}(n.bytesValue,e.bytesValue);case 7:return function(r,s){const f=r.split("/"),b=s.split("/");for(let I=0;I<f.length&&I<b.length;I++){const O=Oi(f[I],b[I]);if(0!==O)return O}return Oi(f.length,b.length)}(n.referenceValue,e.referenceValue);case 8:return function(r,s){const f=Oi(Is(r.latitude),Is(s.latitude));return 0!==f?f:Oi(Is(r.longitude),Is(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(r,s){const f=r.values||[],b=s.values||[];for(let I=0;I<f.length&&I<b.length;++I){const O=Mm(f[I],b[I]);if(O)return O}return Oi(f.length,b.length)}(n.arrayValue,e.arrayValue);case 10:return function(r,s){if(r===Im.mapValue&&s===Im.mapValue)return 0;if(r===Im.mapValue)return 1;if(s===Im.mapValue)return-1;const f=r.fields||{},b=Object.keys(f),I=s.fields||{},O=Object.keys(I);b.sort(),O.sort();for(let V=0;V<b.length&&V<O.length;++V){const X=Oi(b[V],O[V]);if(0!==X)return X;const ae=Mm(f[b[V]],I[O[V]]);if(0!==ae)return ae}return Oi(b.length,O.length)}(n.mapValue,e.mapValue);default:throw Hn()}}function Sw(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Oi(n,e);const t=ia(n),i=ia(e),r=Oi(t.seconds,i.seconds);return 0!==r?r:Oi(t.nanos,i.nanos)}function Dc(n){return Qh(n)}function Qh(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(i){const r=ia(i);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?fp(n.bytesValue).toBase64():"referenceValue"in n?Pn.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(i){let r="[",s=!0;for(const f of i.values||[])s?s=!1:r+=",",r+=Qh(f);return r+"]"}(n.arrayValue):"mapValue"in n?function(i){const r=Object.keys(i.fields||{}).sort();let s="{",f=!0;for(const b of r)f?f=!1:s+=",",s+=`${b}:${Qh(i.fields[b])}`;return s+"}"}(n.mapValue):Hn();var e}function Dm(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function lb(n){return!!n&&"integerValue"in n}function Zy(n){return!!n&&"arrayValue"in n}function dS(n){return!!n&&"nullValue"in n}function DA(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Mw(n){return!!n&&"mapValue"in n}function cb(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Jg(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=cb(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=cb(n.arrayValue.values[t]);return e}return Object.assign({},n)}function hS(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function AA(n){return"nullValue"in n?ab:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Dm(pp.empty(),Pn.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Hn()}function fS(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Dm(pp.empty(),Pn.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Im:Hn()}function PA(n,e){const t=Mm(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function XC(n,e){const t=Mm(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Ta{constructor(e){this.value=e}static empty(){return new Ta({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Mw(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cb(t)}setAll(e){let t=ns.emptyPath(),i={},r=[];e.forEach((f,b)=>{if(!t.isImmediateParentOf(b)){const I=this.getFieldsMap(t);this.applyChanges(I,i,r),i={},r=[],t=b.popLast()}f?i[b.lastSegment()]=cb(f):r.push(b.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());Mw(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xh(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Mw(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Jg(t,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new Ta(cb(this.value))}}function QC(n){const e=[];return Jg(n.fields,(t,i)=>{const r=new ns([t]);if(Mw(i)){const s=QC(i.mapValue).fields;if(0===s.length)e.push(r);else for(const f of s)e.push(r.child(f))}else e.push(r)}),new is(e)}class rs{constructor(e,t,i,r,s,f,b){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=f,this.documentState=b}static newInvalidDocument(e){return new rs(e,0,fi.min(),fi.min(),fi.min(),Ta.empty(),0)}static newFoundDocument(e,t,i,r){return new rs(e,1,t,fi.min(),i,r,0)}static newNoDocument(e,t){return new rs(e,2,t,fi.min(),fi.min(),Ta.empty(),0)}static newUnknownDocument(e,t){return new rs(e,3,t,fi.min(),fi.min(),Ta.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(fi.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ta.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ta.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fi.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof rs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Jh{constructor(e,t){this.position=e,this.inclusive=t}}function JC(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],f=n.position[r];if(i=s.field.isKeyField()?Pn.comparator(Pn.fromName(f.referenceValue),t.key):Mm(f,t.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function eE(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Xh(n.position[t],e.position[t]))return!1;return!0}class t_{constructor(e,t="asc"){this.field=e,this.dir=t}}function pS(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class tE{}class gr extends tE{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,i):new RA(e,t,i):"array-contains"===t?new $L(e,i):"in"===t?new NA(e,i):"not-in"===t?new GL(e,i):"array-contains-any"===t?new zA(e,i):new gr(e,t,i)}static createKeyFieldInFilter(e,t,i){return"in"===t?new FA(e,i):new jL(e,i)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Mm(t,this.value)):null!==t&&Sm(this.value)===Sm(t)&&this.matchesComparison(Mm(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Hn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Vr extends tE{constructor(e,t){super(),this.filters=e,this.op=t,this.ht=null}static create(e,t){return new Vr(e,t)}matches(e){return n_(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.lt(t=>t.isInequality());return null!==e?e.field:null}lt(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function n_(n){return"and"===n.op}function nE(n){return"or"===n.op}function iE(n){return OA(n)&&n_(n)}function OA(n){for(const e of n.filters)if(e instanceof Vr)return!1;return!0}function mS(n){if(n instanceof gr)return n.field.canonicalString()+n.op.toString()+Dc(n.value);if(iE(n))return n.filters.map(e=>mS(e)).join(",");{const e=n.filters.map(t=>mS(t)).join(",");return`${n.op}(${e})`}}function kA(n,e){return n instanceof gr?(t=n,(i=e)instanceof gr&&t.op===i.op&&t.field.isEqual(i.field)&&Xh(t.value,i.value)):n instanceof Vr?function(t,i){return i instanceof Vr&&t.op===i.op&&t.filters.length===i.filters.length&&t.filters.reduce((r,s,f)=>r&&kA(s,i.filters[f]),!0)}(n,e):void Hn();var t,i}function rE(n,e){const t=n.filters.concat(e);return Vr.create(t,n.op)}function gS(n){return n instanceof gr?`${(e=n).field.canonicalString()} ${e.op} ${Dc(e.value)}`:n instanceof Vr?function(e){return e.op.toString()+" {"+e.getFilters().map(gS).join(" ,")+"}"}(n):"Filter";var e}class RA extends gr{constructor(e,t,i){super(e,t,i),this.key=Pn.fromName(i.referenceValue)}matches(e){const t=Pn.comparator(e.key,this.key);return this.matchesComparison(t)}}class FA extends gr{constructor(e,t){super(e,"in",t),this.keys=LA(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class jL extends gr{constructor(e,t){super(e,"not-in",t),this.keys=LA(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function LA(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(i=>Pn.fromName(i.referenceValue))}class $L extends gr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zy(t)&&Wy(t.arrayValue,this.value)}}class NA extends gr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Wy(this.value.arrayValue,t)}}class GL extends gr{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wy(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Wy(this.value.arrayValue,t)}}class zA extends gr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zy(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Wy(this.value.arrayValue,i))}}class Dw{constructor(e,t=null,i=[],r=[],s=null,f=null,b=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=f,this.endAt=b,this.ft=null}}function oE(n,e=null,t=[],i=[],r=null,s=null,f=null){return new Dw(n,e,t,i,r,s,f)}function i_(n){const e=kn(n);if(null===e.ft){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>mS(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>{return(r=i).field.canonicalString()+r.dir;var r}).join(","),Hy(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Dc(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Dc(i)).join(",")),e.ft=t}return e.ft}function Yy(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!pS(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!kA(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!eE(n.startAt,e.startAt)&&eE(n.endAt,e.endAt)}function ef(n){return Pn.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function ub(n,e){return n.filters.filter(t=>t instanceof gr&&t.field.isEqual(e))}function Aw(n,e,t){let i=ab,r=!0;for(const s of ub(n,e)){let f=ab,b=!0;switch(s.op){case"<":case"<=":f=AA(s.value);break;case"==":case"in":case">=":f=s.value;break;case">":f=s.value,b=!1;break;case"!=":case"not-in":f=ab}PA({value:i,inclusive:r},{value:f,inclusive:b})<0&&(i=f,r=b)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const f=t.position[s];PA({value:i,inclusive:r},{value:f,inclusive:t.inclusive})<0&&(i=f,r=t.inclusive);break}return{value:i,inclusive:r}}function Pw(n,e,t){let i=Im,r=!0;for(const s of ub(n,e)){let f=Im,b=!0;switch(s.op){case">=":case">":f=fS(s.value),b=!1;break;case"==":case"in":case"<=":f=s.value;break;case"<":f=s.value,b=!1;break;case"!=":case"not-in":f=Im}XC({value:i,inclusive:r},{value:f,inclusive:b})>0&&(i=f,r=b)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const f=t.position[s];XC({value:i,inclusive:r},{value:f,inclusive:t.inclusive})>0&&(i=f,r=t.inclusive);break}return{value:i,inclusive:r}}class mp{constructor(e,t=null,i=[],r=[],s=null,f="F",b=null,I=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=f,this.startAt=b,this.endAt=I,this.dt=null,this.wt=null}}function Ow(n,e,t,i,r,s,f,b){return new mp(n,e,t,i,r,s,f,b)}function Am(n){return new mp(n)}function db(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function _S(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function sE(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function yS(n){return null!==n.collectionGroup}function Ky(n){const e=kn(n);if(null===e.dt){e.dt=[];const t=sE(e),i=_S(e);if(null!==t&&null===i)t.isKeyField()||e.dt.push(new t_(t)),e.dt.push(new t_(ns.keyField(),"asc"));else{let r=!1;for(const s of e.explicitOrderBy)e.dt.push(s),s.field.isKeyField()&&(r=!0);if(!r){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new t_(ns.keyField(),s))}}}return e.dt}function gl(n){const e=kn(n);if(!e.wt)if("F"===e.limitType)e.wt=oE(e.path,e.collectionGroup,Ky(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of Ky(e))t.push(new t_(s.field,"desc"===s.dir?"asc":"desc"));const i=e.endAt?new Jh(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Jh(e.startAt.position,e.startAt.inclusive):null;e.wt=oE(e.path,e.collectionGroup,t,e.filters,e.limit,i,r)}return e.wt}function aE(n,e){e.getFirstInequalityField(),sE(n);const t=n.filters.concat([e]);return new mp(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function kw(n,e,t){return new mp(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function hb(n,e){return Yy(gl(n),gl(e))&&n.limitType===e.limitType}function vS(n){return`${i_(gl(n))}|lt:${n.limitType}`}function Rw(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(i=>gS(i)).join(", ")}]`),Hy(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(i=>{return`${(r=i).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Dc(i)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Dc(i)).join(",")),`Target(${t})`}(gl(n))}; limitType=${n.limitType})`}function Xy(n,e){return e.isFoundDocument()&&function(t,i){const r=i.key.path;return null!==t.collectionGroup?i.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(r):Pn.isDocumentKey(t.path)?t.path.isEqual(r):t.path.isImmediateParentOf(r)}(n,e)&&function(t,i){for(const r of Ky(t))if(!r.field.isKeyField()&&null===i.data.field(r.field))return!1;return!0}(n,e)&&function(t,i){for(const r of t.filters)if(!r.matches(i))return!1;return!0}(n,e)&&(i=e,!((t=n).startAt&&!function(r,s,f){const b=JC(r,s,f);return r.inclusive?b<=0:b<0}(t.startAt,Ky(t),i)||t.endAt&&!function(r,s,f){const b=JC(r,s,f);return r.inclusive?b>=0:b>0}(t.endAt,Ky(t),i)));var t,i}function lE(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function bS(n){return(e,t)=>{let i=!1;for(const r of Ky(n)){const s=BA(r,e,t);if(0!==s)return s;i=i||r.field.isKeyField()}return 0}}function BA(n,e,t){const i=n.field.isKeyField()?Pn.comparator(e.key,t.key):function(r,s,f){const b=s.data.field(r),I=f.data.field(r);return null!==b&&null!==I?Mm(b,I):Hn()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Hn()}}class gp{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0!==i)for(const[r,s]of i)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(void 0===r)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0===i)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return 1===i.length?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Jg(this.inner,(t,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return lS(this.inner)}size(){return this.innerSize}}const cE=new Ts(Pn.comparator);function vu(){return cE}const uE=new Ts(Pn.comparator);function r_(...n){let e=uE;for(const t of n)e=e.insert(t.key,t);return e}function xS(n){let e=uE;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function tf(){return Fw()}function VA(){return Fw()}function Fw(){return new gp(n=>n.toString(),(n,e)=>n.isEqual(e))}const UA=new Ts(Pn.comparator),jA=new io(Pn.comparator);function ir(...n){let e=jA;for(const t of n)e=e.add(t);return e}const HL=new io(Oi);function dE(){return HL}function $A(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qy(e)?"-0":e}}function GA(n){return{integerValue:""+n}}function wS(n,e){return eS(e)?GA(e):$A(n,e)}class hE{constructor(){this._=void 0}}function qL(n,e,t){return n instanceof fb?function(i,r){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&(s.fields.__previous_value__=r),{mapValue:s}}(t,e):n instanceof Qy?u(n,e):n instanceof h?m(n,e):function(i,r){const s=HA(i,r),f=T(s)+T(i._t);return lb(s)&&lb(i._t)?GA(f):$A(i.serializer,f)}(n,e)}function WL(n,e,t){return n instanceof Qy?u(n,e):n instanceof h?m(n,e):t}function HA(n,e){return n instanceof x?lb(t=e)||(i=t)&&"doubleValue"in i?e:{integerValue:0}:null;var i,t}class fb extends hE{}class Qy extends hE{constructor(e){super(),this.elements=e}}function u(n,e){const t=A(e);for(const i of n.elements)t.some(r=>Xh(r,i))||t.push(i);return{arrayValue:{values:t}}}class h extends hE{constructor(e){super(),this.elements=e}}function m(n,e){let t=A(e);for(const i of n.elements)t=t.filter(r=>!Xh(r,i));return{arrayValue:{values:t}}}class x extends hE{constructor(e,t){super(),this.serializer=e,this._t=t}}function T(n){return Is(n.integerValue||n.doubleValue)}function A(n){return Zy(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class N{constructor(e,t){this.field=e,this.transform=t}}class Q{constructor(e,t){this.version=e,this.transformResults=t}}class re{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new re}static exists(e){return new re(void 0,e)}static updateTime(e){return new re(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function he(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Se{}function We(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new No(n.key,re.none()):new Un(n.key,n.data,re.none());{const t=n.data,i=Ta.empty();let r=new io(ns.comparator);for(let s of e.fields)if(!r.has(s)){let f=t.field(s);null===f&&s.length>1&&(s=s.popLast(),f=t.field(s)),null===f?i.delete(s):i.set(s,f),r=r.add(s)}return new ci(n.key,i,new is(r.toArray()),re.none())}}function dt(n,e,t){n instanceof Un?function(i,r,s){const f=i.value.clone(),b=Ui(i.fieldTransforms,r,s.transformResults);f.setAll(b),r.convertToFoundDocument(s.version,f).setHasCommittedMutations()}(n,e,t):n instanceof ci?function(i,r,s){if(!he(i.precondition,r))return void r.convertToUnknownDocument(s.version);const f=Ui(i.fieldTransforms,r,s.transformResults),b=r.data;b.setAll(rn(i)),b.setAll(f),r.convertToFoundDocument(s.version,b).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Rt(n,e,t,i){return n instanceof Un?function(r,s,f,b){if(!he(r.precondition,s))return f;const I=r.value.clone(),O=Ho(r.fieldTransforms,b,s);return I.setAll(O),s.convertToFoundDocument(s.version,I).setHasLocalMutations(),null}(n,e,t,i):n instanceof ci?function(r,s,f,b){if(!he(r.precondition,s))return f;const I=Ho(r.fieldTransforms,b,s),O=s.data;return O.setAll(rn(r)),O.setAll(I),s.convertToFoundDocument(s.version,O).setHasLocalMutations(),null===f?null:f.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(V=>V.field))}(n,e,t,i):(f=t,he(n.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):f);var s,f}function _n(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=HA(i.transform,r||null);null!=s&&(null===t&&(t=Ta.empty()),t.set(i.field,s))}return t||null}function Rn(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===i||t&&i&&jy(t,i,(r,s)=>function W(n,e){return n.field.isEqual(e.field)&&(i=e.transform,(t=n.transform)instanceof Qy&&i instanceof Qy||t instanceof h&&i instanceof h?jy(t.elements,i.elements,Xh):t instanceof x&&i instanceof x?Xh(t._t,i._t):t instanceof fb&&i instanceof fb);var t,i}(r,s))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,i}class Un extends Se{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ci extends Se{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function rn(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function Ui(n,e,t){const i=new Map;si(n.length===t.length);for(let r=0;r<t.length;r++){const s=n[r],f=s.transform,b=e.data.field(s.field);i.set(s.field,WL(f,b,t[r]))}return i}function Ho(n,e,t){const i=new Map;for(const r of n){const s=r.transform,f=t.data.field(r.field);i.set(r.field,qL(s,f,e))}return i}class No extends Se{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class CS extends Se{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class qA{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&dt(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Rt(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Rt(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=VA();return this.mutations.forEach(r=>{const s=e.get(r.key),f=s.overlayedDocument;let b=this.applyToLocalView(f,s.mutatedFields);b=t.has(r.key)?null:b;const I=We(f,b);null!==I&&i.set(r.key,I),f.isValidDocument()||f.convertToNoDocument(fi.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ir())}isEqual(e){return this.batchId===e.batchId&&jy(this.mutations,e.mutations,(t,i)=>Rn(t,i))&&jy(this.baseMutations,e.baseMutations,(t,i)=>Rn(t,i))}}class WA{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){si(e.mutations.length===i.length);let r=UA;const s=e.mutations;for(let f=0;f<s.length;f++)r=r.insert(s[f].key,i[f].version);return new WA(e,t,i,r)}}class ZA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Y5{constructor(e){this.count=e}}var Ia,Ur;function ZL(n){switch(n){default:return Hn();case Et.CANCELLED:case Et.UNKNOWN:case Et.DEADLINE_EXCEEDED:case Et.RESOURCE_EXHAUSTED:case Et.INTERNAL:case Et.UNAVAILABLE:case Et.UNAUTHENTICATED:return!1;case Et.INVALID_ARGUMENT:case Et.NOT_FOUND:case Et.ALREADY_EXISTS:case Et.PERMISSION_DENIED:case Et.FAILED_PRECONDITION:case Et.ABORTED:case Et.OUT_OF_RANGE:case Et.UNIMPLEMENTED:case Et.DATA_LOSS:return!0}}function YL(n){if(void 0===n)return Ns("GRPC error has no .code"),Et.UNKNOWN;switch(n){case Ia.OK:return Et.OK;case Ia.CANCELLED:return Et.CANCELLED;case Ia.UNKNOWN:return Et.UNKNOWN;case Ia.DEADLINE_EXCEEDED:return Et.DEADLINE_EXCEEDED;case Ia.RESOURCE_EXHAUSTED:return Et.RESOURCE_EXHAUSTED;case Ia.INTERNAL:return Et.INTERNAL;case Ia.UNAVAILABLE:return Et.UNAVAILABLE;case Ia.UNAUTHENTICATED:return Et.UNAUTHENTICATED;case Ia.INVALID_ARGUMENT:return Et.INVALID_ARGUMENT;case Ia.NOT_FOUND:return Et.NOT_FOUND;case Ia.ALREADY_EXISTS:return Et.ALREADY_EXISTS;case Ia.PERMISSION_DENIED:return Et.PERMISSION_DENIED;case Ia.FAILED_PRECONDITION:return Et.FAILED_PRECONDITION;case Ia.ABORTED:return Et.ABORTED;case Ia.OUT_OF_RANGE:return Et.OUT_OF_RANGE;case Ia.UNIMPLEMENTED:return Et.UNIMPLEMENTED;case Ia.DATA_LOSS:return Et.DATA_LOSS;default:return Hn()}}(Ur=Ia||(Ia={}))[Ur.OK=0]="OK",Ur[Ur.CANCELLED=1]="CANCELLED",Ur[Ur.UNKNOWN=2]="UNKNOWN",Ur[Ur.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ur[Ur.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ur[Ur.NOT_FOUND=5]="NOT_FOUND",Ur[Ur.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ur[Ur.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ur[Ur.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ur[Ur.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ur[Ur.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ur[Ur.ABORTED=10]="ABORTED",Ur[Ur.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ur[Ur.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ur[Ur.INTERNAL=13]="INTERNAL",Ur[Ur.UNAVAILABLE=14]="UNAVAILABLE",Ur[Ur.DATA_LOSS=15]="DATA_LOSS";class KA{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return ES}static getOrCreateInstance(){return null===ES&&(ES=new KA),ES}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let ES=null;class fE{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,pE.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new fE(fi.min(),r,dE(),vu(),ir())}}class pE{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new pE(i,t,ir(),ir(),ir())}}class TS{constructor(e,t,i,r){this.It=e,this.removedTargetIds=t,this.key=i,this.Tt=r}}class KL{constructor(e,t){this.targetId=e,this.Et=t}}class XL{constructor(e,t,i=na.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class QL{constructor(){this.At=0,this.Rt=eN(),this.vt=na.EMPTY_BYTE_STRING,this.bt=!1,this.Pt=!0}get current(){return this.bt}get resumeToken(){return this.vt}get Vt(){return 0!==this.At}get St(){return this.Pt}Dt(e){e.approximateByteSize()>0&&(this.Pt=!0,this.vt=e)}Ct(){let e=ir(),t=ir(),i=ir();return this.Rt.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Hn()}}),new pE(this.vt,this.bt,e,t,i)}xt(){this.Pt=!1,this.Rt=eN()}Nt(e,t){this.Pt=!0,this.Rt=this.Rt.insert(e,t)}kt(e){this.Pt=!0,this.Rt=this.Rt.remove(e)}Ot(){this.At+=1}$t(){this.At-=1}Mt(){this.Pt=!0,this.bt=!0}}class K5{constructor(e){this.Ft=e,this.Bt=new Map,this.Lt=vu(),this.qt=JL(),this.Ut=new io(Oi)}Kt(e){for(const t of e.It)e.Tt&&e.Tt.isFoundDocument()?this.Gt(t,e.Tt):this.Qt(t,e.key,e.Tt);for(const t of e.removedTargetIds)this.Qt(t,e.key,e.Tt)}zt(e){this.forEachTarget(e,t=>{const i=this.jt(t);switch(e.state){case 0:this.Wt(t)&&i.Dt(e.resumeToken);break;case 1:i.$t(),i.Vt||i.xt(),i.Dt(e.resumeToken);break;case 2:i.$t(),i.Vt||this.removeTarget(t);break;case 3:this.Wt(t)&&(i.Mt(),i.Dt(e.resumeToken));break;case 4:this.Wt(t)&&(this.Ht(t),i.Dt(e.resumeToken));break;default:Hn()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Bt.forEach((i,r)=>{this.Wt(r)&&t(r)})}Jt(e){var t;const i=e.targetId,r=e.Et.count,s=this.Yt(i);if(s){const f=s.target;if(ef(f))if(0===r){const b=new Pn(f.path);this.Qt(i,b,rs.newNoDocument(b,fi.min()))}else si(1===r);else{const b=this.Zt(i);b!==r&&(this.Ht(i),this.Ut=this.Ut.add(i),null===(t=KA.instance)||void 0===t||t.notifyOnExistenceFilterMismatch({localCacheCount:b,existenceFilterCount:e.Et.count}))}}}Xt(e){const t=new Map;this.Bt.forEach((s,f)=>{const b=this.Yt(f);if(b){if(s.current&&ef(b.target)){const I=new Pn(b.target.path);null!==this.Lt.get(I)||this.te(f,I)||this.Qt(f,I,rs.newNoDocument(I,e))}s.St&&(t.set(f,s.Ct()),s.xt())}});let i=ir();this.qt.forEach((s,f)=>{let b=!0;f.forEachWhile(I=>{const O=this.Yt(I);return!O||2===O.purpose||(b=!1,!1)}),b&&(i=i.add(s))}),this.Lt.forEach((s,f)=>f.setReadTime(e));const r=new fE(e,t,this.Ut,this.Lt,i);return this.Lt=vu(),this.qt=JL(),this.Ut=new io(Oi),r}Gt(e,t){if(!this.Wt(e))return;const i=this.te(e,t.key)?2:0;this.jt(e).Nt(t.key,i),this.Lt=this.Lt.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ee(t.key).add(e))}Qt(e,t,i){if(!this.Wt(e))return;const r=this.jt(e);this.te(e,t)?r.Nt(t,1):r.kt(t),this.qt=this.qt.insert(t,this.ee(t).delete(e)),i&&(this.Lt=this.Lt.insert(t,i))}removeTarget(e){this.Bt.delete(e)}Zt(e){const t=this.jt(e).Ct();return this.Ft.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ot(e){this.jt(e).Ot()}jt(e){let t=this.Bt.get(e);return t||(t=new QL,this.Bt.set(e,t)),t}ee(e){let t=this.qt.get(e);return t||(t=new io(Oi),this.qt=this.qt.insert(e,t)),t}Wt(e){const t=null!==this.Yt(e);return t||sn("WatchChangeAggregator","Detected inactive target",e),t}Yt(e){const t=this.Bt.get(e);return t&&t.Vt?null:this.Ft.ne(e)}Ht(e){this.Bt.set(e,new QL),this.Ft.getRemoteKeysForTarget(e).forEach(t=>{this.Qt(e,t,null)})}te(e,t){return this.Ft.getRemoteKeysForTarget(e).has(t)}}function JL(){return new Ts(Pn.comparator)}function eN(){return new Ts(Pn.comparator)}const X5={asc:"ASCENDING",desc:"DESCENDING"},Q5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},J5={and:"AND",or:"OR"};class e6{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Lw(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function tN(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function t6(n,e){return Lw(n,e.toTimestamp())}function ra(n){return si(!!n),fi.fromTimestamp(function(e){const t=ia(e);return new Go(t.seconds,t.nanos)}(n))}function XA(n,e){return(t=n,new Pr(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function nN(n){const e=Pr.fromString(n);return si(dN(e)),e}function mE(n,e){return XA(n.databaseId,e.path)}function Pm(n,e){const t=nN(e);if(t.get(1)!==n.databaseId.projectId)throw new Zt(Et.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Zt(Et.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Pn(rN(t))}function QA(n,e){return XA(n.databaseId,e)}function iN(n){const e=nN(n);return 4===e.length?Pr.emptyPath():rN(e)}function gE(n){return new Pr(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function rN(n){return si(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function oN(n,e,t){return{name:mE(n,e),fields:t.value.mapValue.fields}}function sN(n,e,t){const i=Pm(n,e.name),r=ra(e.updateTime),s=e.createTime?ra(e.createTime):fi.min(),f=new Ta({mapValue:{fields:e.fields}}),b=rs.newFoundDocument(i,r,s,f);return t&&b.setHasCommittedMutations(),t?b.setHasCommittedMutations():b}function _E(n,e){let t;if(e instanceof Un)t={update:oN(n,e.key,e.value)};else if(e instanceof No)t={delete:mE(n,e.key)};else if(e instanceof ci)t={update:oN(n,e.key,e.data),updateMask:c6(e.fieldMask)};else{if(!(e instanceof CS))return Hn();t={verify:mE(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(r,s){const f=s.transform;if(f instanceof fb)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Qy)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof h)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof x)return{fieldPath:s.field.canonicalString(),increment:f._t};throw Hn()}(0,i))),e.precondition.isNone||(t.currentDocument=void 0!==(r=e.precondition).updateTime?{updateTime:t6(n,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:Hn()),t;var r}function JA(n,e){const t=e.currentDocument?void 0!==(r=e.currentDocument).updateTime?re.updateTime(ra(r.updateTime)):void 0!==r.exists?re.exists(r.exists):re.none():re.none(),i=e.updateTransforms?e.updateTransforms.map(r=>function(s,f){let b=null;"setToServerValue"in f?(si("REQUEST_TIME"===f.setToServerValue),b=new fb):"appendMissingElements"in f?b=new Qy(f.appendMissingElements.values||[]):"removeAllFromArray"in f?b=new h(f.removeAllFromArray.values||[]):"increment"in f?b=new x(s,f.increment):Hn();const I=ns.fromServerFormat(f.fieldPath);return new N(I,b)}(n,r)):[];var r;if(e.update){const r=Pm(n,e.update.name),s=new Ta({mapValue:{fields:e.update.fields}});if(e.updateMask){const f=new is((e.updateMask.fieldPaths||[]).map(O=>ns.fromServerFormat(O)));return new ci(r,s,f,t,i)}return new Un(r,s,t,i)}if(e.delete){const r=Pm(n,e.delete);return new No(r,t)}if(e.verify){const r=Pm(n,e.verify);return new CS(r,t)}return Hn()}function aN(n,e){return{documents:[QA(n,e.path)]}}function eP(n,e){const t={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(t.parent=QA(n,i),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=QA(n,i.popLast()),t.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(I){if(0!==I.length)return uN(Vr.create(I,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const s=function(I){if(0!==I.length)return I.map(O=>{return{field:Jy((V=O).field),direction:s6(V.dir)};var V})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const f=(O=e.limit,n.useProto3Json||Hy(O)?O:{value:O});var O,b,I;return null!==f&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt={before:(b=e.startAt).inclusive,values:b.position}),e.endAt&&(t.structuredQuery.endAt={before:!(I=e.endAt).inclusive,values:I.position}),t}function lN(n){let e=iN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){si(1===i);const V=t.from[0];V.allDescendants?r=V.collectionId:e=e.child(V.collectionId)}let s=[];t.where&&(s=function(V){const X=cN(V);return X instanceof Vr&&iE(X)?X.getFilters():[X]}(t.where));let f=[];t.orderBy&&(f=t.orderBy.map(V=>{return new t_(Nw((X=V).field),function(ae){switch(ae){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(X.direction));var X}));let b=null;t.limit&&(b=function(V){let X;return X="object"==typeof V?V.value:V,Hy(X)?null:X}(t.limit));let I=null;var V;t.startAt&&(I=new Jh((V=t.startAt).values||[],!!V.before));let O=null;return t.endAt&&(O=function(V){return new Jh(V.values||[],!V.before)}(t.endAt)),Ow(e,r,f,s,b,"F",I,O)}function cN(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Nw(e.unaryFilter.field);return gr.create(t,"==",{doubleValue:NaN});case"IS_NULL":const i=Nw(e.unaryFilter.field);return gr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Nw(e.unaryFilter.field);return gr.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Nw(e.unaryFilter.field);return gr.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Hn()}}(n):void 0!==n.fieldFilter?gr.create(Nw((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Hn()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return Vr.create(e.compositeFilter.filters.map(t=>cN(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Hn()}}(e.compositeFilter.op))}(n):Hn();var e}function s6(n){return X5[n]}function a6(n){return Q5[n]}function l6(n){return J5[n]}function Jy(n){return{fieldPath:n.canonicalString()}}function Nw(n){return ns.fromServerFormat(n.fieldPath)}function uN(n){return n instanceof gr?function(e){if("=="===e.op){if(DA(e.value))return{unaryFilter:{field:Jy(e.field),op:"IS_NAN"}};if(dS(e.value))return{unaryFilter:{field:Jy(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(DA(e.value))return{unaryFilter:{field:Jy(e.field),op:"IS_NOT_NAN"}};if(dS(e.value))return{unaryFilter:{field:Jy(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jy(e.field),op:a6(e.op),value:e.value}}}(n):n instanceof Vr?function(e){const t=e.getFilters().map(i=>uN(i));return 1===t.length?t[0]:{compositeFilter:{op:l6(e.op),filters:t}}}(n):Hn()}function c6(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function dN(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class ev{constructor(e,t,i,r,s=fi.min(),f=fi.min(),b=na.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=f,this.resumeToken=b}withSequenceNumber(e){return new ev(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new ev(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new ev(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class hN{constructor(e){this.se=e}}function fN(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:IS(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document={name:mE(r=n.se,(s=e).key),fields:s.data.value.mapValue.fields,updateTime:Lw(r,s.version.toTimestamp()),createTime:Lw(r,s.createTime.toTimestamp())};else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:pb(e.version)};else{if(!e.isUnknownDocument())return Hn();i.unknownDocument={path:t.path.toArray(),version:pb(e.version)}}var r,s;return i}function IS(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function pb(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function mb(n){const e=new Go(n.seconds,n.nanoseconds);return fi.fromTimestamp(e)}function gb(n,e){const t=(e.baseMutations||[]).map(s=>JA(n.se,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const i=e.mutations.map(s=>JA(n.se,s)),r=Go.fromMillis(e.localWriteTimeMs);return new qA(e.batchId,r,t,i)}function yE(n){const e=mb(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?mb(n.lastLimboFreeSnapshotVersion):fi.min();let i;var r;return void 0!==n.query.documents?(si(1===(r=n.query).documents.length),i=gl(Am(iN(r.documents[0])))):i=gl(lN(n.query)),new ev(i,n.targetId,0,n.lastListenSequenceNumber,e,t,na.fromBase64String(n.resumeToken))}function pN(n,e){const t=pb(e.snapshotVersion),i=pb(e.lastLimboFreeSnapshotVersion);let r;r=ef(e.target)?aN(n.se,e.target):eP(n.se,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:i_(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function tP(n){const e=lN({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?kw(e,e.limit,"L"):e}function nP(n,e){return new ZA(e.largestBatchId,JA(n.se,e.overlayMutation))}function mN(n,e){const t=e.path.lastSegment();return[n,Kl(e.path.popLast()),t]}function gN(n,e,t,i){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:pb(i.readTime),documentKey:Kl(i.documentKey.path),largestBatchId:i.largestBatchId}}class d6{getBundleMetadata(e,t){return _N(e).get(t).next(i=>{if(i)return{id:(r=i).bundleId,createTime:mb(r.createTime),version:r.version};var r})}saveBundleMetadata(e,t){return _N(e).put({bundleId:(i=t).id,createTime:pb(ra(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return yN(e).get(t).next(i=>{if(i)return{name:(r=i).name,query:tP(r.bundledQuery),readTime:mb(r.readTime)};var r})}saveNamedQuery(e,t){return yN(e).put({name:(i=t).name,readTime:pb(ra(i.readTime)),bundledQuery:i.bundledQuery});var i}}function _N(n){return qa(n,"bundles")}function yN(n){return qa(n,"namedQueries")}class SS{constructor(e,t){this.serializer=e,this.userId=t}static ie(e,t){return new SS(e,t.uid||"")}getOverlay(e,t){return vE(e).get(mN(this.userId,t)).next(i=>i?nP(this.serializer,i):null)}getOverlays(e,t){const i=tf();return wt.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){const r=[];return i.forEach((s,f)=>{const b=new ZA(t,f);r.push(this.re(e,b))}),wt.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach(f=>r.add(Kl(f.getCollectionPath())));const s=[];return r.forEach(f=>{const b=IDBKeyRange.bound([this.userId,f,i],[this.userId,f,i+1],!1,!0);s.push(vE(e).J("collectionPathOverlayIndex",b))}),wt.waitFor(s)}getOverlaysForCollection(e,t,i){const r=tf(),s=Kl(t),f=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return vE(e).j("collectionPathOverlayIndex",f).next(b=>{for(const I of b){const O=nP(this.serializer,I);r.set(O.getKey(),O)}return r})}getOverlaysForCollectionGroup(e,t,i,r){const s=tf();let f;const b=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return vE(e).Z({index:"collectionGroupOverlayIndex",range:b},(I,O,V)=>{const X=nP(this.serializer,O);s.size()<r||X.largestBatchId===f?(s.set(X.getKey(),X),f=X.largestBatchId):V.done()}).next(()=>s)}re(e,t){return vE(e).put(function(i,r,s){const[f,b,I]=mN(r,s.mutation.key);return{userId:r,collectionPath:b,documentId:I,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:_E(i.se,s.mutation)}}(this.serializer,this.userId,t))}}function vE(n){return qa(n,"documentOverlays")}class _b{constructor(){}oe(e,t){this.ue(e,t),t.ce()}ue(e,t){if("nullValue"in e)this.ae(t,5);else if("booleanValue"in e)this.ae(t,10),t.he(e.booleanValue?1:0);else if("integerValue"in e)this.ae(t,15),t.he(Is(e.integerValue));else if("doubleValue"in e){const i=Is(e.doubleValue);isNaN(i)?this.ae(t,13):(this.ae(t,15),qy(i)?t.he(0):t.he(i))}else if("timestampValue"in e){const i=e.timestampValue;this.ae(t,20),"string"==typeof i?t.le(i):(t.le(`${i.seconds||""}`),t.he(i.nanos||0))}else if("stringValue"in e)this.fe(e.stringValue,t),this.de(t);else if("bytesValue"in e)this.ae(t,30),t.we(fp(e.bytesValue)),this.de(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.ae(t,45),t.he(i.latitude||0),t.he(i.longitude||0)}else"mapValue"in e?hS(e)?this.ae(t,Number.MAX_SAFE_INTEGER):(this.me(e.mapValue,t),this.de(t)):"arrayValue"in e?(this.ge(e.arrayValue,t),this.de(t)):Hn()}fe(e,t){this.ae(t,25),this.ye(e,t)}ye(e,t){t.le(e)}me(e,t){const i=e.fields||{};this.ae(t,55);for(const r of Object.keys(i))this.fe(r,t),this.ue(i[r],t)}ge(e,t){const i=e.values||[];this.ae(t,50);for(const r of i)this.ue(r,t)}_e(e,t){this.ae(t,37),Pn.fromName(e).path.forEach(i=>{this.ae(t,60),this.ye(i,t)})}ae(e,t){e.he(t)}de(e){e.he(2)}}function h6(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function vN(n){const e=64-function(t){let i=0;for(let r=0;r<8;++r){const s=h6(255&t[r]);if(i+=s,8!==s)break}return i}(n);return Math.ceil(e/8)}_b.pe=new _b;class f6{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ie(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Te(i.value),i=t.next();this.Ee()}Ae(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Re(i.value),i=t.next();this.ve()}be(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Te(i);else if(i<2048)this.Te(960|i>>>6),this.Te(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.Te(480|i>>>12),this.Te(128|63&i>>>6),this.Te(128|63&i);else{const r=t.codePointAt(0);this.Te(240|r>>>18),this.Te(128|63&r>>>12),this.Te(128|63&r>>>6),this.Te(128|63&r)}}this.Ee()}Pe(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Re(i);else if(i<2048)this.Re(960|i>>>6),this.Re(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.Re(480|i>>>12),this.Re(128|63&i>>>6),this.Re(128|63&i);else{const r=t.codePointAt(0);this.Re(240|r>>>18),this.Re(128|63&r>>>12),this.Re(128|63&r>>>6),this.Re(128|63&r)}}this.ve()}Ve(e){const t=this.Se(e),i=vN(t);this.De(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Ce(e){const t=this.Se(e),i=vN(t);this.De(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}xe(){this.Ne(255),this.Ne(255)}ke(){this.Oe(255),this.Oe(255)}reset(){this.position=0}seed(e){this.De(e.length),this.buffer.set(e,this.position),this.position+=e.length}$e(){return this.buffer.slice(0,this.position)}Se(e){const t=function(r){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,r,!1),new Uint8Array(s.buffer)}(e),i=0!=(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Te(e){const t=255&e;0===t?(this.Ne(0),this.Ne(255)):255===t?(this.Ne(255),this.Ne(0)):this.Ne(t)}Re(e){const t=255&e;0===t?(this.Oe(0),this.Oe(255)):255===t?(this.Oe(255),this.Oe(0)):this.Oe(e)}Ee(){this.Ne(0),this.Ne(1)}ve(){this.Oe(0),this.Oe(1)}Ne(e){this.De(1),this.buffer[this.position++]=e}Oe(e){this.De(1),this.buffer[this.position++]=~e}De(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class p6{constructor(e){this.Me=e}we(e){this.Me.Ie(e)}le(e){this.Me.be(e)}he(e){this.Me.Ve(e)}ce(){this.Me.xe()}}class m6{constructor(e){this.Me=e}we(e){this.Me.Ae(e)}le(e){this.Me.Pe(e)}he(e){this.Me.Ce(e)}ce(){this.Me.ke()}}class bE{constructor(){this.Me=new f6,this.Fe=new p6(this.Me),this.Be=new m6(this.Me)}seed(e){this.Me.seed(e)}Le(e){return 0===e?this.Fe:this.Be}$e(){return this.Me.$e()}reset(){this.Me.reset()}}class yb{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}qe(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new yb(this.indexId,this.documentKey,this.arrayValue,i)}}function tv(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=bN(n.arrayValue,e.arrayValue),0!==t?t:(t=bN(n.directionalValue,e.directionalValue),0!==t?t:Pn.comparator(n.documentKey,e.documentKey)))}function bN(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(0!==i)return i}return n.length-e.length}class g6{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.Ke=[];for(const t of e.filters){const i=t;i.isInequality()?this.Ge=i:this.Ke.push(i)}}Qe(e){si(e.collectionGroup===this.collectionId);const t=$y(e);if(void 0!==t&&!this.ze(t))return!1;const i=up(e);let r=0,s=0;for(;r<i.length&&this.ze(i[r]);++r);if(r===i.length)return!0;if(void 0!==this.Ge){const f=i[r];if(!this.je(this.Ge,f)||!this.We(this.Ue[s++],f))return!1;++r}for(;r<i.length;++r)if(s>=this.Ue.length||!this.We(this.Ue[s++],i[r]))return!1;return!0}ze(e){for(const t of this.Ke)if(this.je(t,e))return!0;return!1}je(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}We(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function xN(n){var e,t;if(si(n instanceof gr||n instanceof Vr),n instanceof gr){if(n instanceof NA){const r=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>gr.create(n.field,"==",s)))||[];return Vr.create(r,"or")}return n}const i=n.filters.map(r=>xN(r));return Vr.create(i,n.op)}function _6(n){if(0===n.getFilters().length)return[];const e=oP(xN(n));return si(wN(e)),iP(e)||rP(e)?[e]:e.getFilters()}function iP(n){return n instanceof gr}function rP(n){return n instanceof Vr&&iE(n)}function wN(n){return iP(n)||rP(n)||function(e){if(e instanceof Vr&&nE(e)){for(const t of e.getFilters())if(!iP(t)&&!rP(t))return!1;return!0}return!1}(n)}function oP(n){if(si(n instanceof gr||n instanceof Vr),n instanceof gr)return n;if(1===n.filters.length)return oP(n.filters[0]);const e=n.filters.map(i=>oP(i));let t=Vr.create(e,n.op);return t=MS(t),wN(t)?t:(si(t instanceof Vr),si(n_(t)),si(t.filters.length>1),t.filters.reduce((i,r)=>sP(i,r)))}function sP(n,e){let t;return si(n instanceof gr||n instanceof Vr),si(e instanceof gr||e instanceof Vr),t=n instanceof gr?e instanceof gr?Vr.create([n,e],"and"):CN(n,e):e instanceof gr?CN(e,n):function(i,r){if(si(i.filters.length>0&&r.filters.length>0),n_(i)&&n_(r))return rE(i,r.getFilters());const s=nE(i)?i:r,f=nE(i)?r:i,b=s.filters.map(I=>sP(I,f));return Vr.create(b,"or")}(n,e),MS(t)}function CN(n,e){if(n_(e))return rE(e,n.getFilters());{const t=e.filters.map(i=>sP(n,i));return Vr.create(t,"or")}}function MS(n){if(si(n instanceof gr||n instanceof Vr),n instanceof gr)return n;const e=n.getFilters();if(1===e.length)return MS(e[0]);if(OA(n))return n;const t=e.map(r=>MS(r)),i=[];return t.forEach(r=>{r instanceof gr?i.push(r):r instanceof Vr&&(r.op===n.op?i.push(...r.filters):i.push(r))}),1===i.length?i[0]:Vr.create(i,n.op)}class y6{constructor(){this.He=new aP}addToCollectionParentIndex(e,t){return this.He.add(t),wt.resolve()}getCollectionParents(e,t){return wt.resolve(this.He.getEntries(t))}addFieldIndex(e,t){return wt.resolve()}deleteFieldIndex(e,t){return wt.resolve()}getDocumentsMatchingTarget(e,t){return wt.resolve(null)}getIndexType(e,t){return wt.resolve(0)}getFieldIndexes(e,t){return wt.resolve([])}getNextCollectionGroupToUpdate(e){return wt.resolve(null)}getMinOffset(e,t){return wt.resolve(Sc.min())}getMinOffsetFromCollectionGroup(e,t){return wt.resolve(Sc.min())}updateCollectionGroup(e,t,i){return wt.resolve()}updateIndexEntries(e,t){return wt.resolve()}}class aP{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new io(Pr.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new io(Pr.comparator)).toArray()}}const DS=new Uint8Array(0);class v6{constructor(e,t){this.user=e,this.databaseId=t,this.Je=new aP,this.Ye=new gp(i=>i_(i),(i,r)=>Yy(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Je.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.Je.add(t)});const s={collectionId:i,parent:Kl(r)};return EN(e).put(s)}return wt.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[ww(t),""],!1,!0);return EN(e).j(r).next(s=>{for(const f of s){if(f.collectionId!==t)break;i.push(hp(f.parent))}return i})}addFieldIndex(e,t){const i=AS(e),r={indexId:(f=t).indexId,collectionGroup:f.collectionGroup,fields:f.fields.map(b=>[b.fieldPath.canonicalString(),b.kind])};var f;delete r.indexId;const s=i.add(r);if(t.indexState){const f=wE(e);return s.next(b=>{f.put(gN(b,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const i=AS(e),r=wE(e),s=xE(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const i=xE(e);let r=!0;const s=new Map;return wt.forEach(this.Ze(t),f=>this.Xe(e,f).next(b=>{r&&(r=!!b),s.set(f,b)})).next(()=>{if(r){let f=ir();const b=[];return wt.forEach(s,(I,O)=>{var V;sn("IndexedDbIndexManager",`Using index ${V=I,`id=${V.indexId}|cg=${V.collectionGroup}|f=${V.fields.map(Nn=>`${Nn.fieldPath}:${Nn.kind}`).join(",")}`} to execute ${i_(t)}`);const X=function(Nn,ai){const Hi=$y(ai);if(void 0===Hi)return null;for(const Xi of ub(Nn,Hi.fieldPath))switch(Xi.op){case"array-contains-any":return Xi.value.arrayValue.values||[];case"array-contains":return[Xi.value]}return null}(O,I),ae=function(Nn,ai){const Hi=new Map;for(const Xi of up(ai))for(const ro of ub(Nn,Xi.fieldPath))switch(ro.op){case"==":case"in":Hi.set(Xi.fieldPath.canonicalString(),ro.value);break;case"not-in":case"!=":return Hi.set(Xi.fieldPath.canonicalString(),ro.value),Array.from(Hi.values())}return null}(O,I),me=function(Nn,ai){const Hi=[];let Xi=!0;for(const ro of up(ai)){const xl=0===ro.kind?Aw(Nn,ro.fieldPath,Nn.startAt):Pw(Nn,ro.fieldPath,Nn.startAt);Hi.push(xl.value),Xi&&(Xi=xl.inclusive)}return new Jh(Hi,Xi)}(O,I),Ie=function(Nn,ai){const Hi=[];let Xi=!0;for(const ro of up(ai)){const xl=0===ro.kind?Pw(Nn,ro.fieldPath,Nn.endAt):Aw(Nn,ro.fieldPath,Nn.endAt);Hi.push(xl.value),Xi&&(Xi=xl.inclusive)}return new Jh(Hi,Xi)}(O,I),Ge=this.tn(I,O,me),Je=this.tn(I,O,Ie),Qt=this.en(I,O,ae),xn=this.nn(I.indexId,X,Ge,me.inclusive,Je,Ie.inclusive,Qt);return wt.forEach(xn,Nn=>i.H(Nn,t.limit).next(ai=>{ai.forEach(Hi=>{const Xi=Pn.fromSegments(Hi.documentKey);f.has(Xi)||(f=f.add(Xi),b.push(Xi))})}))}).next(()=>b)}return wt.resolve(null)})}Ze(e){let t=this.Ye.get(e);return t||(t=0===e.filters.length?[e]:_6(Vr.create(e.filters,"and")).map(i=>oE(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.Ye.set(e,t),t)}nn(e,t,i,r,s,f,b){const I=(null!=t?t.length:1)*Math.max(i.length,s.length),O=I/(null!=t?t.length:1),V=[];for(let X=0;X<I;++X){const ae=t?this.sn(t[X/O]):DS,me=this.rn(e,ae,i[X%O],r),Ie=this.on(e,ae,s[X%O],f),Ge=b.map(Je=>this.rn(e,ae,Je,!0));V.push(...this.createRange(me,Ie,Ge))}return V}rn(e,t,i,r){const s=new yb(e,Pn.empty(),t,i);return r?s:s.qe()}on(e,t,i,r){const s=new yb(e,Pn.empty(),t,i);return r?s.qe():s}Xe(e,t){const i=new g6(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let f=null;for(const b of s)i.Qe(b)&&(!f||b.fields.length>f.fields.length)&&(f=b);return f})}getIndexType(e,t){let i=2;const r=this.Ze(t);return wt.forEach(r,s=>this.Xe(e,s).next(f=>{f?0!==i&&f.fields.length<function(b){let I=new io(ns.comparator),O=!1;for(const V of b.filters)for(const X of V.getFlattenedFilters())X.field.isKeyField()||("array-contains"===X.op||"array-contains-any"===X.op?O=!0:I=I.add(X.field));for(const V of b.orderBy)V.field.isKeyField()||(I=I.add(V.field));return I.size+(O?1:0)}(s)&&(i=1):i=0})).next(()=>null!==t.limit&&r.length>1&&2===i?1:i)}un(e,t){const i=new bE;for(const r of up(e)){const s=t.data.field(r.fieldPath);if(null==s)return null;const f=i.Le(r.kind);_b.pe.oe(s,f)}return i.$e()}sn(e){const t=new bE;return _b.pe.oe(e,t.Le(0)),t.$e()}cn(e,t){const i=new bE;return _b.pe.oe(Dm(this.databaseId,t),i.Le(function(r){const s=up(r);return 0===s.length?0:s[s.length-1].kind}(e))),i.$e()}en(e,t,i){if(null===i)return[];let r=[];r.push(new bE);let s=0;for(const f of up(e)){const b=i[s++];for(const I of r)if(this.an(t,f.fieldPath)&&Zy(b))r=this.hn(r,f,b);else{const O=I.Le(f.kind);_b.pe.oe(b,O)}}return this.ln(r)}tn(e,t,i){return this.en(e,t,i.position)}ln(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].$e();return t}hn(e,t,i){const r=[...e],s=[];for(const f of i.arrayValue.values||[])for(const b of r){const I=new bE;I.seed(b.$e()),_b.pe.oe(f,I.Le(t.kind)),s.push(I)}return s}an(e,t){return!!e.filters.find(i=>i instanceof gr&&i.field.isEqual(t)&&("in"===i.op||"not-in"===i.op))}getFieldIndexes(e,t){const i=AS(e),r=wE(e);return(t?i.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.j()).next(s=>{const f=[];return wt.forEach(s,b=>r.get([b.indexId,this.uid]).next(I=>{f.push(function(O,V){const X=V?new Gy(V.sequenceNumber,new Sc(mb(V.readTime),new Pn(hp(V.documentKey)),V.largestBatchId)):Gy.empty(),ae=O.fields.map(([me,Ie])=>new nb(ns.fromServerFormat(me),Ie));return new tb(O.indexId,O.collectionGroup,ae,X)}(b,I))})).next(()=>f)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==s?s:Oi(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){const r=AS(e),s=wE(e);return this.fn(e).next(f=>r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(b=>wt.forEach(b,I=>s.put(gN(I.indexId,this.user,f,i)))))}updateIndexEntries(e,t){const i=new Map;return wt.forEach(t,(r,s)=>{const f=i.get(r.collectionGroup);return(f?wt.resolve(f):this.getFieldIndexes(e,r.collectionGroup)).next(b=>(i.set(r.collectionGroup,b),wt.forEach(b,I=>this.dn(e,r,I).next(O=>{const V=this.wn(s,I);return O.isEqual(V)?wt.resolve():this._n(e,s,I,O,V)}))))})}mn(e,t,i,r){return xE(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.cn(i,t.key),documentKey:t.key.path.toArray()})}gn(e,t,i,r){return xE(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.cn(i,t.key),t.key.path.toArray()])}dn(e,t,i){const r=xE(e);let s=new io(tv);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.cn(i,t)])},(f,b)=>{s=s.add(new yb(i.indexId,t,b.arrayValue,b.directionalValue))}).next(()=>s)}wn(e,t){let i=new io(tv);const r=this.un(t,e);if(null==r)return i;const s=$y(t);if(null!=s){const f=e.data.field(s.fieldPath);if(Zy(f))for(const b of f.arrayValue.values||[])i=i.add(new yb(t.indexId,e.key,this.sn(b),r))}else i=i.add(new yb(t.indexId,e.key,DS,r));return i}_n(e,t,i,r,s){sn("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const f=[];return function(b,I,O,V,X){const ae=b.getIterator(),me=I.getIterator();let Ie=sb(ae),Ge=sb(me);for(;Ie||Ge;){let Je=!1,Qt=!1;if(Ie&&Ge){const xn=O(Ie,Ge);xn<0?Qt=!0:xn>0&&(Je=!0)}else null!=Ie?Qt=!0:Je=!0;Je?(V(Ge),Ge=sb(me)):Qt?(X(Ie),Ie=sb(ae)):(Ie=sb(ae),Ge=sb(me))}}(r,s,tv,b=>{f.push(this.mn(e,t,i,b))},b=>{f.push(this.gn(e,t,i,b))}),wt.waitFor(f)}fn(e){let t=1;return wE(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((f,b)=>tv(f,b)).filter((f,b,I)=>!b||0!==tv(f,I[b-1]));const r=[];r.push(e);for(const f of i){const b=tv(f,e),I=tv(f,t);if(0===b)r[0]=e.qe();else if(b>0&&I<0)r.push(f),r.push(f.qe());else if(I>0)break}r.push(t);const s=[];for(let f=0;f<r.length;f+=2){if(this.yn(r[f],r[f+1]))return[];s.push(IDBKeyRange.bound([r[f].indexId,this.uid,r[f].arrayValue,r[f].directionalValue,DS,[]],[r[f+1].indexId,this.uid,r[f+1].arrayValue,r[f+1].directionalValue,DS,[]]))}return s}yn(e,t){return tv(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(TN)}getMinOffset(e,t){return wt.mapArray(this.Ze(t),i=>this.Xe(e,i).next(r=>r||Hn())).next(TN)}}function EN(n){return qa(n,"collectionParents")}function xE(n){return qa(n,"indexEntries")}function AS(n){return qa(n,"indexConfiguration")}function wE(n){return qa(n,"indexState")}function TN(n){si(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;ib(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Sc(e.readTime,e.documentKey,t)}const IN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class hd{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new hd(e,hd.DEFAULT_COLLECTION_PERCENTILE,hd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function SN(n,e,t){const i=n.store("mutations"),r=n.store("documentMutations"),s=[],f=IDBKeyRange.only(t.batchId);let b=0;const I=i.Z({range:f},(V,X,ae)=>(b++,ae.delete()));s.push(I.next(()=>{si(1===b)}));const O=[];for(const V of t.mutations){const X=CA(e,V.key.path,t.batchId);s.push(r.delete(X)),O.push(V.key)}return wt.waitFor(s).next(()=>O)}function PS(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Hn();e=n.noDocument}return JSON.stringify(e).length}hd.DEFAULT_COLLECTION_PERCENTILE=10,hd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hd.DEFAULT=new hd(41943040,hd.DEFAULT_COLLECTION_PERCENTILE,hd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hd.DISABLED=new hd(-1,0,0);class OS{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.pn={}}static ie(e,t,i,r){si(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new OS(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return nv(e).Z({index:"userMutationsIndex",range:i},(r,s,f)=>{t=!1,f.done()}).next(()=>t)}addMutationBatch(e,t,i,r){const s=zw(e),f=nv(e);return f.add({}).next(b=>{si("number"==typeof b);const I=new qA(b,t,i,r),O=function(ae,me,Ie){const Ge=Ie.baseMutations.map(Qt=>_E(ae.se,Qt)),Je=Ie.mutations.map(Qt=>_E(ae.se,Qt));return{userId:me,batchId:Ie.batchId,localWriteTimeMs:Ie.localWriteTime.toMillis(),baseMutations:Ge,mutations:Je}}(this.serializer,this.userId,I),V=[];let X=new io((ae,me)=>Oi(ae.canonicalString(),me.canonicalString()));for(const ae of r){const me=CA(this.userId,ae.key.path,b);X=X.add(ae.key.path.popLast()),V.push(f.put(O)),V.push(s.put(me,RL))}return X.forEach(ae=>{V.push(this.indexManager.addToCollectionParentIndex(e,ae))}),e.addOnCommittedListener(()=>{this.pn[b]=I.keys()}),wt.waitFor(V).next(()=>I)})}lookupMutationBatch(e,t){return nv(e).get(t).next(i=>i?(si(i.userId===this.userId),gb(this.serializer,i)):null)}In(e,t){return this.pn[t]?wt.resolve(this.pn[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){const r=i.keys();return this.pn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return nv(e).Z({index:"userMutationsIndex",range:r},(f,b,I)=>{b.userId===this.userId&&(si(b.batchId>=i),s=gb(this.serializer,b)),I.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return nv(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(r,s,f)=>{i=s.batchId,f.done()}).next(()=>i)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return nv(e).j("userMutationsIndex",t).next(i=>i.map(r=>gb(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=HC(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return zw(e).Z({range:r},(f,b,I)=>{const[O,V,X]=f,ae=hp(V);if(O===this.userId&&t.path.isEqual(ae))return nv(e).get(X).next(me=>{if(!me)throw Hn();si(me.userId===this.userId),s.push(gb(this.serializer,me))});I.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new io(Oi);const r=[];return t.forEach(s=>{const f=HC(this.userId,s.path),b=IDBKeyRange.lowerBound(f),I=zw(e).Z({range:b},(O,V,X)=>{const[ae,me,Ie]=O,Ge=hp(me);ae===this.userId&&s.path.isEqual(Ge)?i=i.add(Ie):X.done()});r.push(I)}),wt.waitFor(r).next(()=>this.Tn(e,i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=HC(this.userId,i),f=IDBKeyRange.lowerBound(s);let b=new io(Oi);return zw(e).Z({range:f},(I,O,V)=>{const[X,ae,me]=I,Ie=hp(ae);X===this.userId&&i.isPrefixOf(Ie)?Ie.length===r&&(b=b.add(me)):V.done()}).next(()=>this.Tn(e,b))}Tn(e,t){const i=[],r=[];return t.forEach(s=>{r.push(nv(e).get(s).next(f=>{if(null===f)throw Hn();si(f.userId===this.userId),i.push(gb(this.serializer,f))}))}),wt.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return SN(e.at,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.En(t.batchId)}),wt.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}En(e){delete this.pn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return wt.resolve();const i=IDBKeyRange.lowerBound([this.userId]),r=[];return zw(e).Z({range:i},(s,f,b)=>{if(s[0]===this.userId){const I=hp(s[1]);r.push(I)}else b.done()}).next(()=>{si(0===r.length)})})}containsKey(e,t){return MN(e,this.userId,t)}An(e){return DN(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function MN(n,e,t){const i=HC(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let f=!1;return zw(n).Z({range:s,Y:!0},(b,I,O)=>{const[V,X,ae]=b;V===e&&X===r&&(f=!0),O.done()}).next(()=>f)}function nv(n){return qa(n,"mutations")}function zw(n){return qa(n,"documentMutations")}function DN(n){return qa(n,"mutationQueues")}class vb{constructor(e){this.Rn=e}next(){return this.Rn+=2,this.Rn}static vn(){return new vb(0)}static bn(){return new vb(-1)}}class b6{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Pn(e).next(t=>{const i=new vb(t.highestTargetId);return t.highestTargetId=i.next(),this.Vn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Pn(e).next(t=>fi.fromTimestamp(new Go(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Pn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.Pn(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Vn(e,r)))}addTargetData(e,t){return this.Sn(e,t).next(()=>this.Pn(e).next(i=>(i.targetCount+=1,this.Dn(t,i),this.Vn(e,i))))}updateTargetData(e,t){return this.Sn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Bw(e).delete(t.targetId)).next(()=>this.Pn(e)).next(i=>(si(i.targetCount>0),i.targetCount-=1,this.Vn(e,i)))}removeTargets(e,t,i){let r=0;const s=[];return Bw(e).Z((f,b)=>{const I=yE(b);I.sequenceNumber<=t&&null===i.get(I.targetId)&&(r++,s.push(this.removeTargetData(e,I)))}).next(()=>wt.waitFor(s)).next(()=>r)}forEachTarget(e,t){return Bw(e).Z((i,r)=>{const s=yE(r);t(s)})}Pn(e){return AN(e).get("targetGlobalKey").next(t=>(si(null!==t),t))}Vn(e,t){return AN(e).put("targetGlobalKey",t)}Sn(e,t){return Bw(e).put(pN(this.serializer,t))}Dn(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.Pn(e).next(t=>t.targetCount)}getTargetData(e,t){const i=i_(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Bw(e).Z({range:r,index:"queryTargetsIndex"},(f,b,I)=>{const O=yE(b);Yy(t,O.target)&&(s=O,I.done())}).next(()=>s)}addMatchingKeys(e,t,i){const r=[],s=iv(e);return t.forEach(f=>{const b=Kl(f.path);r.push(s.put({targetId:i,path:b})),r.push(this.referenceDelegate.addReference(e,i,f))}),wt.waitFor(r)}removeMatchingKeys(e,t,i){const r=iv(e);return wt.forEach(t,s=>{const f=Kl(s.path);return wt.waitFor([r.delete([i,f]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,t){const i=iv(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=iv(e);let s=ir();return r.Z({range:i,Y:!0},(f,b,I)=>{const O=hp(f[1]),V=new Pn(O);s=s.add(V)}).next(()=>s)}containsKey(e,t){const i=Kl(t.path),r=IDBKeyRange.bound([i],[ww(i)],!1,!0);let s=0;return iv(e).Z({index:"documentTargetsIndex",Y:!0,range:r},([f,b],I,O)=>{0!==f&&(s++,O.done())}).next(()=>s>0)}ne(e,t){return Bw(e).get(t).next(i=>i?yE(i):null)}}function Bw(n){return qa(n,"targets")}function AN(n){return qa(n,"targetGlobal")}function iv(n){return qa(n,"targetDocuments")}function PN([n,e],[t,i]){const r=Oi(n,t);return 0===r?Oi(e,i):r}class x6{constructor(e){this.Cn=e,this.buffer=new io(PN),this.xn=0}Nn(){return++this.xn}kn(e){const t=[e,this.Nn()];if(this.buffer.size<this.Cn)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();PN(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class w6{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.On=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.$n(6e4)}stop(){this.On&&(this.On.cancel(),this.On=null)}get started(){return null!==this.On}$n(e){var t=this;sn("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.On=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,z.Z)(function*(){t.On=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(i){dp(i)?sn("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",i):yield Xg(i)}yield t.$n(3e5)}))}}class C6{constructor(e,t){this.Mn=e,this.params=t}calculateTargetCount(e,t){return this.Mn.Fn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(0===t)return wt.resolve(Mc.ct);const i=new x6(t);return this.Mn.forEachTarget(e,r=>i.kn(r.sequenceNumber)).next(()=>this.Mn.Bn(e,r=>i.kn(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Mn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Mn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(sn("LruGarbageCollector","Garbage collection skipped; disabled"),wt.resolve(IN)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(sn("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),IN):this.Ln(e,t))}getCacheSize(e){return this.Mn.getCacheSize(e)}Ln(e,t){let i,r,s,f,b,I,O;const V=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(X=>(X>this.params.maximumSequenceNumbersToCollect?(sn("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${X}`),r=this.params.maximumSequenceNumbersToCollect):r=X,f=Date.now(),this.nthSequenceNumber(e,r))).next(X=>(i=X,b=Date.now(),this.removeTargets(e,i,t))).next(X=>(s=X,I=Date.now(),this.removeOrphanedDocuments(e,i))).next(X=>(O=Date.now(),jC()<=ie.in.DEBUG&&sn("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${f-V}ms\n\tDetermined least recently used ${r} in `+(b-f)+`ms\n\tRemoved ${s} targets in `+(I-b)+`ms\n\tRemoved ${X} documents in `+(O-I)+`ms\nTotal Duration: ${O-V}ms`),wt.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:X})))}}class E6{constructor(e,t){this.db=e,this.garbageCollector=new C6(this,t)}Fn(e){const t=this.qn(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}qn(e){let t=0;return this.Bn(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Bn(e,t){return this.Un(e,(i,r)=>t(r))}addReference(e,t,i){return kS(e,i)}removeReference(e,t,i){return kS(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return kS(e,t)}Kn(e,t){return function(i,r){let s=!1;return DN(i).X(f=>MN(i,f,r).next(b=>(b&&(s=!0),wt.resolve(!b)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Un(e,(f,b)=>{if(b<=t){const I=this.Kn(e,f).next(O=>{if(!O)return s++,i.getEntry(e,f).next(()=>(i.removeEntry(f,fi.min()),iv(e).delete([0,Kl(f.path)])))});r.push(I)}}).next(()=>wt.waitFor(r)).next(()=>i.apply(e)).next(()=>s)}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return kS(e,t)}Un(e,t){const i=iv(e);let r,s=Mc.ct;return i.Z({index:"documentTargetsIndex"},([f,b],{path:I,sequenceNumber:O})=>{0===f?(s!==Mc.ct&&t(new Pn(hp(r)),s),s=O,r=I):s=Mc.ct}).next(()=>{s!==Mc.ct&&t(new Pn(hp(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function kS(n,e){return iv(n).put((i=n.currentSequenceNumber,{targetId:0,path:Kl(e.path),sequenceNumber:i}));var i}class ON{constructor(){this.changes=new gp(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,rs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return void 0!==i?wt.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class T6{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return bb(e).put(i)}removeEntry(e,t,i){return bb(e).delete(function(r,s){const f=r.path.toArray();return[f.slice(0,f.length-2),f[f.length-2],IS(s),f[f.length-1]]}(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.Gn(e,i)))}getEntry(e,t){let i=rs.newInvalidDocument(t);return bb(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(CE(t))},(r,s)=>{i=this.Qn(t,s)}).next(()=>i)}zn(e,t){let i={size:0,document:rs.newInvalidDocument(t)};return bb(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(CE(t))},(r,s)=>{i={document:this.Qn(t,s),size:PS(s)}}).next(()=>i)}getEntries(e,t){let i=vu();return this.jn(e,t,(r,s)=>{const f=this.Qn(r,s);i=i.insert(r,f)}).next(()=>i)}Wn(e,t){let i=vu(),r=new Ts(Pn.comparator);return this.jn(e,t,(s,f)=>{const b=this.Qn(s,f);i=i.insert(s,b),r=r.insert(s,PS(f))}).next(()=>({documents:i,Hn:r}))}jn(e,t,i){if(t.isEmpty())return wt.resolve();let r=new io(LN);t.forEach(I=>r=r.add(I));const s=IDBKeyRange.bound(CE(r.first()),CE(r.last())),f=r.getIterator();let b=f.getNext();return bb(e).Z({index:"documentKeyIndex",range:s},(I,O,V)=>{const X=Pn.fromSegments([...O.prefixPath,O.collectionGroup,O.documentId]);for(;b&&LN(b,X)<0;)i(b,null),b=f.getNext();b&&b.isEqual(X)&&(i(b,O),b=f.hasNext()?f.getNext():null),b?V.G(CE(b)):V.done()}).next(()=>{for(;b;)i(b,null),b=f.hasNext()?f.getNext():null})}getDocumentsMatchingQuery(e,t,i,r){const s=t.path,f=[s.popLast().toArray(),s.lastSegment(),IS(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],b=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return bb(e).j(IDBKeyRange.bound(f,b,!0)).next(I=>{let O=vu();for(const V of I){const X=this.Qn(Pn.fromSegments(V.prefixPath.concat(V.collectionGroup,V.documentId)),V);X.isFoundDocument()&&(Xy(t,X)||r.has(X.key))&&(O=O.insert(X.key,X))}return O})}getAllFromCollectionGroup(e,t,i,r){let s=vu();const f=FN(t,i),b=FN(t,Sc.max());return bb(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(f,b,!0)},(I,O,V)=>{const X=this.Qn(Pn.fromSegments(O.prefixPath.concat(O.collectionGroup,O.documentId)),O);s=s.insert(X.key,X),s.size===r&&V.done()}).next(()=>s)}newChangeBuffer(e){return new I6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return RN(e).get("remoteDocumentGlobalKey").next(t=>(si(!!t),t))}Gn(e,t){return RN(e).put("remoteDocumentGlobalKey",t)}Qn(e,t){if(t){const i=function u6(n,e){let t;if(e.document)t=sN(n.se,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Pn.fromSegments(e.noDocument.path),r=mb(e.noDocument.readTime);t=rs.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Hn();{const i=Pn.fromSegments(e.unknownDocument.path),r=mb(e.unknownDocument.version);t=rs.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime(function(i){const r=new Go(i[0],i[1]);return fi.fromTimestamp(r)}(e.readTime)),t}(this.serializer,t);if(!i.isNoDocument()||!i.version.isEqual(fi.min()))return i}return rs.newInvalidDocument(e)}}function kN(n){return new T6(n)}class I6 extends ON{constructor(e,t){super(),this.Jn=e,this.trackRemovals=t,this.Yn=new gp(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){const t=[];let i=0,r=new io((s,f)=>Oi(s.canonicalString(),f.canonicalString()));return this.changes.forEach((s,f)=>{const b=this.Yn.get(s);if(t.push(this.Jn.removeEntry(e,s,b.readTime)),f.isValidDocument()){const I=fN(this.Jn.serializer,f);r=r.add(s.path.popLast());const O=PS(I);i+=O-b.size,t.push(this.Jn.addEntry(e,s,I))}else if(i-=b.size,this.trackRemovals){const I=fN(this.Jn.serializer,f.convertToNoDocument(fi.min()));t.push(this.Jn.addEntry(e,s,I))}}),r.forEach(s=>{t.push(this.Jn.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.Jn.updateMetadata(e,i)),wt.waitFor(t)}getFromCache(e,t){return this.Jn.zn(e,t).next(i=>(this.Yn.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.Jn.Wn(e,t).next(({documents:i,Hn:r})=>(r.forEach((s,f)=>{this.Yn.set(s,{size:f,readTime:i.get(s).readTime})}),i))}}function RN(n){return qa(n,"remoteDocumentGlobal")}function bb(n){return qa(n,"remoteDocumentsV14")}function CE(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function FN(n,e){const t=e.documentKey.path.toArray();return[n,IS(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function LN(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=Oi(t[s],i[s]),r)return r;return r=Oi(t.length,i.length),r||(r=Oi(t[t.length-2],i[i.length-2]),r||Oi(t[t.length-1],i[i.length-1]))}class S6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class NN{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(null!==i&&Rt(i.mutation,r,is.empty(),Go.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,ir()).next(()=>i))}getLocalViewOfDocuments(e,t,i=ir()){const r=tf();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let f=r_();return s.forEach((b,I)=>{f=f.insert(b,I.overlayedDocument)}),f}))}getOverlayedDocuments(e,t){const i=tf();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,ir()))}populateOverlays(e,t,i){const r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((f,b)=>{t.set(f,b)})})}computeViews(e,t,i,r){let s=vu();const f=Fw(),b=Fw();return t.forEach((I,O)=>{const V=i.get(O.key);r.has(O.key)&&(void 0===V||V.mutation instanceof ci)?s=s.insert(O.key,O):void 0!==V?(f.set(O.key,V.mutation.getFieldMask()),Rt(V.mutation,O,V.mutation.getFieldMask(),Go.now())):f.set(O.key,is.empty())}),this.recalculateAndSaveOverlays(e,s).next(I=>(I.forEach((O,V)=>f.set(O,V)),t.forEach((O,V)=>{var X;return b.set(O,new S6(V,null!==(X=f.get(O))&&void 0!==X?X:null))}),b))}recalculateAndSaveOverlays(e,t){const i=Fw();let r=new Ts((f,b)=>f-b),s=ir();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(f=>{for(const b of f)b.keys().forEach(I=>{const O=t.get(I);if(null===O)return;let V=i.get(I)||is.empty();V=b.applyToLocalView(O,V),i.set(I,V);const X=(r.get(b.batchId)||ir()).add(I);r=r.insert(b.batchId,X)})}).next(()=>{const f=[],b=r.getReverseIterator();for(;b.hasNext();){const I=b.getNext(),O=I.key,V=I.value,X=VA();V.forEach(ae=>{if(!s.has(ae)){const me=We(t.get(ae),i.get(ae));null!==me&&X.set(ae,me),s=s.add(ae)}}),f.push(this.documentOverlayCache.saveOverlays(e,O,X))}return wt.waitFor(f)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i){return Pn.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):yS(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i):this.getDocumentsMatchingCollectionQuery(e,t,i);var r}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{const f=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):wt.resolve(tf());let b=-1,I=s;return f.next(O=>wt.forEach(O,(V,X)=>(b<X.largestBatchId&&(b=X.largestBatchId),s.get(V)?wt.resolve():this.remoteDocumentCache.getEntry(e,V).next(ae=>{I=I.insert(V,ae)}))).next(()=>this.populateOverlays(e,O,s)).next(()=>this.computeViews(e,I,O,ir())).next(V=>({batchId:b,changes:xS(V)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Pn(t)).next(i=>{let r=r_();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i){const r=t.collectionGroup;let s=r_();return this.indexManager.getCollectionParents(e,r).next(f=>wt.forEach(f,b=>{const I=(O=t,V=b.child(r),new mp(V,null,O.explicitOrderBy.slice(),O.filters.slice(),O.limit,O.limitType,O.startAt,O.endAt));var O,V;return this.getDocumentsMatchingCollectionQuery(e,I,i).next(O=>{O.forEach((V,X)=>{s=s.insert(V,X)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,r))).next(s=>{r.forEach((b,I)=>{const O=I.getKey();null===s.get(O)&&(s=s.insert(O,rs.newInvalidDocument(O)))});let f=r_();return s.forEach((b,I)=>{const O=r.get(b);void 0!==O&&Rt(O.mutation,I,is.empty(),Go.now()),Xy(t,I)&&(f=f.insert(b,I))}),f})}}class M6{constructor(e){this.serializer=e,this.Zn=new Map,this.Xn=new Map}getBundleMetadata(e,t){return wt.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var i;return this.Zn.set(t.id,{id:(i=t).id,version:i.version,createTime:ra(i.createTime)}),wt.resolve()}getNamedQuery(e,t){return wt.resolve(this.Xn.get(t))}saveNamedQuery(e,t){return this.Xn.set(t.name,{name:(i=t).name,query:tP(i.bundledQuery),readTime:ra(i.readTime)}),wt.resolve();var i}}class D6{constructor(){this.overlays=new Ts(Pn.comparator),this.ts=new Map}getOverlay(e,t){return wt.resolve(this.overlays.get(t))}getOverlays(e,t){const i=tf();return wt.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.re(e,t,s)}),wt.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.ts.get(i);return void 0!==r&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.ts.delete(i)),wt.resolve()}getOverlaysForCollection(e,t,i){const r=tf(),s=t.length+1,f=new Pn(t.child("")),b=this.overlays.getIteratorFrom(f);for(;b.hasNext();){const I=b.getNext().value,O=I.getKey();if(!t.isPrefixOf(O.path))break;O.path.length===s&&I.largestBatchId>i&&r.set(I.getKey(),I)}return wt.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new Ts((O,V)=>O-V);const f=this.overlays.getIterator();for(;f.hasNext();){const O=f.getNext().value;if(O.getKey().getCollectionGroup()===t&&O.largestBatchId>i){let V=s.get(O.largestBatchId);null===V&&(V=tf(),s=s.insert(O.largestBatchId,V)),V.set(O.getKey(),O)}}const b=tf(),I=s.getIterator();for(;I.hasNext()&&(I.getNext().value.forEach((O,V)=>b.set(O,V)),!(b.size()>=r)););return wt.resolve(b)}re(e,t,i){const r=this.overlays.get(i.key);if(null!==r){const f=this.ts.get(r.largestBatchId).delete(i.key);this.ts.set(r.largestBatchId,f)}this.overlays=this.overlays.insert(i.key,new ZA(t,i));let s=this.ts.get(t);void 0===s&&(s=ir(),this.ts.set(t,s)),this.ts.set(t,s.add(i.key))}}class lP{constructor(){this.es=new io(_l.ns),this.ss=new io(_l.rs)}isEmpty(){return this.es.isEmpty()}addReference(e,t){const i=new _l(e,t);this.es=this.es.add(i),this.ss=this.ss.add(i)}os(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.us(new _l(e,t))}cs(e,t){e.forEach(i=>this.removeReference(i,t))}hs(e){const t=new Pn(new Pr([])),i=new _l(t,e),r=new _l(t,e+1),s=[];return this.ss.forEachInRange([i,r],f=>{this.us(f),s.push(f.key)}),s}ls(){this.es.forEach(e=>this.us(e))}us(e){this.es=this.es.delete(e),this.ss=this.ss.delete(e)}fs(e){const t=new Pn(new Pr([])),i=new _l(t,e),r=new _l(t,e+1);let s=ir();return this.ss.forEachInRange([i,r],f=>{s=s.add(f.key)}),s}containsKey(e){const t=new _l(e,0),i=this.es.firstAfterOrEqual(t);return null!==i&&e.isEqual(i.key)}}class _l{constructor(e,t){this.key=e,this.ds=t}static ns(e,t){return Pn.comparator(e.key,t.key)||Oi(e.ds,t.ds)}static rs(e,t){return Oi(e.ds,t.ds)||Pn.comparator(e.key,t.key)}}class A6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this._s=new io(_l.ns)}checkEmpty(e){return wt.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,i,r){const s=this.ws;this.ws++;const f=new qA(s,t,i,r);this.mutationQueue.push(f);for(const b of r)this._s=this._s.add(new _l(b.key,s)),this.indexManager.addToCollectionParentIndex(e,b.key.path.popLast());return wt.resolve(f)}lookupMutationBatch(e,t){return wt.resolve(this.gs(t))}getNextMutationBatchAfterBatchId(e,t){const r=this.ys(t+1),s=r<0?0:r;return wt.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return wt.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return wt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new _l(t,0),r=new _l(t,Number.POSITIVE_INFINITY),s=[];return this._s.forEachInRange([i,r],f=>{const b=this.gs(f.ds);s.push(b)}),wt.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new io(Oi);return t.forEach(r=>{const s=new _l(r,0),f=new _l(r,Number.POSITIVE_INFINITY);this._s.forEachInRange([s,f],b=>{i=i.add(b.ds)})}),wt.resolve(this.ps(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Pn.isDocumentKey(s)||(s=s.child(""));const f=new _l(new Pn(s),0);let b=new io(Oi);return this._s.forEachWhile(I=>{const O=I.key.path;return!!i.isPrefixOf(O)&&(O.length===r&&(b=b.add(I.ds)),!0)},f),wt.resolve(this.ps(b))}ps(e){const t=[];return e.forEach(i=>{const r=this.gs(i);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){si(0===this.Is(t.batchId,"removed")),this.mutationQueue.shift();let i=this._s;return wt.forEach(t.mutations,r=>{const s=new _l(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this._s=i})}En(e){}containsKey(e,t){const i=new _l(t,0),r=this._s.firstAfterOrEqual(i);return wt.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return wt.resolve()}Is(e,t){return this.ys(e)}ys(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}gs(e){const t=this.ys(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class P6{constructor(e){this.Ts=e,this.docs=new Ts(Pn.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,f=this.Ts(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:f}),this.size+=f-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return wt.resolve(i?i.document.mutableCopy():rs.newInvalidDocument(t))}getEntries(e,t){let i=vu();return t.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():rs.newInvalidDocument(r))}),wt.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=vu();const f=t.path,b=new Pn(f.child("")),I=this.docs.getIteratorFrom(b);for(;I.hasNext();){const{key:O,value:{document:V}}=I.getNext();if(!f.isPrefixOf(O.path))break;O.path.length>f.length+1||ib(ZI(V),i)<=0||(r.has(V.key)||Xy(t,V))&&(s=s.insert(V.key,V.mutableCopy()))}return wt.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Hn()}Es(e,t){return wt.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new O6(this)}getSize(e){return wt.resolve(this.size)}}class O6 extends ON{constructor(e){super(),this.Jn=e}applyChanges(e){const t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Jn.addEntry(e,r)):this.Jn.removeEntry(i)}),wt.waitFor(t)}getFromCache(e,t){return this.Jn.getEntry(e,t)}getAllFromCache(e,t){return this.Jn.getEntries(e,t)}}class k6{constructor(e){this.persistence=e,this.As=new gp(t=>i_(t),Yy),this.lastRemoteSnapshotVersion=fi.min(),this.highestTargetId=0,this.Rs=0,this.vs=new lP,this.targetCount=0,this.bs=vb.vn()}forEachTarget(e,t){return this.As.forEach((i,r)=>t(r)),wt.resolve()}getLastRemoteSnapshotVersion(e){return wt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return wt.resolve(this.Rs)}allocateTargetId(e){return this.highestTargetId=this.bs.next(),wt.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Rs&&(this.Rs=t),wt.resolve()}Sn(e){this.As.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.bs=new vb(t),this.highestTargetId=t),e.sequenceNumber>this.Rs&&(this.Rs=e.sequenceNumber)}addTargetData(e,t){return this.Sn(t),this.targetCount+=1,wt.resolve()}updateTargetData(e,t){return this.Sn(t),wt.resolve()}removeTargetData(e,t){return this.As.delete(t.target),this.vs.hs(t.targetId),this.targetCount-=1,wt.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.As.forEach((f,b)=>{b.sequenceNumber<=t&&null===i.get(b.targetId)&&(this.As.delete(f),s.push(this.removeMatchingKeysForTargetId(e,b.targetId)),r++)}),wt.waitFor(s).next(()=>r)}getTargetCount(e){return wt.resolve(this.targetCount)}getTargetData(e,t){const i=this.As.get(t)||null;return wt.resolve(i)}addMatchingKeys(e,t,i){return this.vs.os(t,i),wt.resolve()}removeMatchingKeys(e,t,i){this.vs.cs(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(f=>{s.push(r.markPotentiallyOrphaned(e,f))}),wt.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.vs.hs(t),wt.resolve()}getMatchingKeysForTargetId(e,t){const i=this.vs.fs(t);return wt.resolve(i)}containsKey(e,t){return wt.resolve(this.vs.containsKey(t))}}class zN{constructor(e,t){this.Ps={},this.overlays={},this.Vs=new Mc(0),this.Ss=!1,this.Ss=!0,this.referenceDelegate=e(this),this.Ds=new k6(this),this.indexManager=new y6,this.remoteDocumentCache=new P6(i=>this.referenceDelegate.Cs(i)),this.serializer=new hN(t),this.xs=new M6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ss=!1,Promise.resolve()}get started(){return this.Ss}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new D6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Ps[e.toKey()];return i||(i=new A6(t,this.referenceDelegate),this.Ps[e.toKey()]=i),i}getTargetCache(){return this.Ds}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.xs}runTransaction(e,t,i){sn("MemoryPersistence","Starting transaction:",e);const r=new R6(this.Vs.next());return this.referenceDelegate.Ns(),i(r).next(s=>this.referenceDelegate.ks(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Os(e,t){return wt.or(Object.values(this.Ps).map(i=>()=>i.containsKey(e,t)))}}class R6 extends YI{constructor(e){super(),this.currentSequenceNumber=e}}class RS{constructor(e){this.persistence=e,this.$s=new lP,this.Ms=null}static Fs(e){return new RS(e)}get Bs(){if(this.Ms)return this.Ms;throw Hn()}addReference(e,t,i){return this.$s.addReference(i,t),this.Bs.delete(i.toString()),wt.resolve()}removeReference(e,t,i){return this.$s.removeReference(i,t),this.Bs.add(i.toString()),wt.resolve()}markPotentiallyOrphaned(e,t){return this.Bs.add(t.toString()),wt.resolve()}removeTarget(e,t){this.$s.hs(t.targetId).forEach(r=>this.Bs.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Bs.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}Ns(){this.Ms=new Set}ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return wt.forEach(this.Bs,i=>{const r=Pn.fromPath(i);return this.Ls(e,r).next(s=>{s||t.removeEntry(r,fi.min())})}).next(()=>(this.Ms=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ls(e,t).next(i=>{i?this.Bs.delete(t.toString()):this.Bs.add(t.toString())})}Cs(e){return 0}Ls(e,t){return wt.or([()=>wt.resolve(this.$s.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Os(e,t)])}}class F6{constructor(e){this.serializer=e}M(e,t,i,r){const s=new Cw("createOrUpgrade",t);var b;i<1&&r>=1&&(e.createObjectStore("owner"),(b=e).createObjectStore("mutationQueues",{keyPath:"userId"}),b.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",wA,{unique:!0}),b.createObjectStore("documentMutations"),BN(e),function(b){b.createObjectStore("remoteDocuments")}(e));let f=wt.resolve();return i<3&&r>=3&&(0!==i&&(function(b){b.deleteObjectStore("targetDocuments"),b.deleteObjectStore("targets"),b.deleteObjectStore("targetGlobal")}(e),BN(e)),f=f.next(()=>function(b){const I=b.store("targetGlobal"),O={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:fi.min().toTimestamp(),targetCount:0};return I.put("targetGlobalKey",O)}(s))),i<4&&r>=4&&(0!==i&&(f=f.next(()=>function(b,I){return I.store("mutations").j().next(O=>{b.deleteObjectStore("mutations"),b.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",wA,{unique:!0});const V=I.store("mutations"),X=O.map(ae=>V.put(ae));return wt.waitFor(X)})}(e,s))),f=f.next(()=>{!function(b){b.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),i<5&&r>=5&&(f=f.next(()=>this.qs(s))),i<6&&r>=6&&(f=f.next(()=>(function(b){b.createObjectStore("remoteDocumentGlobal")}(e),this.Us(s)))),i<7&&r>=7&&(f=f.next(()=>this.Ks(s))),i<8&&r>=8&&(f=f.next(()=>this.Gs(e,s))),i<9&&r>=9&&(f=f.next(()=>{!function(b){b.objectStoreNames.contains("remoteDocumentChanges")&&b.deleteObjectStore("remoteDocumentChanges")}(e)})),i<10&&r>=10&&(f=f.next(()=>this.Qs(s))),i<11&&r>=11&&(f=f.next(()=>{(function(b){b.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(b){b.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),i<12&&r>=12&&(f=f.next(()=>{!function(b){const I=b.createObjectStore("documentOverlays",{keyPath:rS});I.createIndex("collectionPathOverlayIndex",EA,{unique:!1}),I.createIndex("collectionGroupOverlayIndex",VL,{unique:!1})}(e)})),i<13&&r>=13&&(f=f.next(()=>function(b){const I=b.createObjectStore("remoteDocumentsV14",{keyPath:FL});I.createIndex("documentKeyIndex",LL),I.createIndex("collectionGroupIndex",NL)}(e)).next(()=>this.zs(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(f=f.next(()=>this.js(e,s))),i<15&&r>=15&&(f=f.next(()=>function(b){b.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),b.createObjectStore("indexState",{keyPath:nS}).createIndex("sequenceNumberIndex",iS,{unique:!1}),b.createObjectStore("indexEntries",{keyPath:BL}).createIndex("documentKeyIndex",qC,{unique:!1})}(e))),f}Us(e){let t=0;return e.store("remoteDocuments").Z((i,r)=>{t+=PS(r)}).next(()=>{const i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}qs(e){const t=e.store("mutationQueues"),i=e.store("mutations");return t.j().next(r=>wt.forEach(r,s=>{const f=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.j("userMutationsIndex",f).next(b=>wt.forEach(b,I=>{si(I.userId===s.userId);const O=gb(this.serializer,I);return SN(e,s.userId,O).next(()=>{})}))}))}Ks(e){const t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return i.Z((f,b)=>{const I=new Pr(f),O=[0,Kl(I)];s.push(t.get(O).next(V=>V?wt.resolve():t.put({targetId:0,path:Kl(I),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>wt.waitFor(s))})}Gs(e,t){e.createObjectStore("collectionParents",{keyPath:Iw});const i=t.store("collectionParents"),r=new aP,s=f=>{if(r.add(f)){const b=f.lastSegment(),I=f.popLast();return i.put({collectionId:b,parent:Kl(I)})}};return t.store("remoteDocuments").Z({Y:!0},(f,b)=>{const I=new Pr(f);return s(I.popLast())}).next(()=>t.store("documentMutations").Z({Y:!0},([f,b,I],O)=>{const V=hp(b);return s(V.popLast())}))}Qs(e){const t=e.store("targets");return t.Z((i,r)=>{const s=yE(r),f=pN(this.serializer,s);return t.put(f)})}zs(e,t){const i=t.store("remoteDocuments"),r=[];return i.Z((s,f)=>{const b=t.store("remoteDocumentsV14"),I=(O=f,O.document?new Pn(Pr.fromString(O.document.name).popFirst(5)):O.noDocument?Pn.fromSegments(O.noDocument.path):O.unknownDocument?Pn.fromSegments(O.unknownDocument.path):Hn()).path.toArray();var O;const V={prefixPath:I.slice(0,I.length-2),collectionGroup:I[I.length-2],documentId:I[I.length-1],readTime:f.readTime||[0,0],unknownDocument:f.unknownDocument,noDocument:f.noDocument,document:f.document,hasCommittedMutations:!!f.hasCommittedMutations};r.push(b.put(V))}).next(()=>wt.waitFor(r))}js(e,t){const i=t.store("mutations"),r=kN(this.serializer),s=new zN(RS.Fs,this.serializer.se);return i.j().next(f=>{const b=new Map;return f.forEach(I=>{var O;let V=null!==(O=b.get(I.userId))&&void 0!==O?O:ir();gb(this.serializer,I).keys().forEach(X=>V=V.add(X)),b.set(I.userId,V)}),wt.forEach(b,(I,O)=>{const V=new ta(O),X=SS.ie(this.serializer,V),ae=s.getIndexManager(V),me=OS.ie(V,this.serializer,ae,s.referenceDelegate);return new NN(r,me,X,ae).recalculateAndSaveOverlaysForDocumentKeys(new aS(t,Mc.ct),I).next()})})}}function BN(n){n.createObjectStore("targetDocuments",{keyPath:zL}).createIndex("documentTargetsIndex",tS,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Tw,{unique:!0}),n.createObjectStore("targetGlobal")}const cP="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class uP{constructor(e,t,i,r,s,f,b,I,O,V,X=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Ws=s,this.window=f,this.document=b,this.Hs=O,this.Js=V,this.Ys=X,this.Vs=null,this.Ss=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.Xs=null,this.ti=null,this.ei=Number.NEGATIVE_INFINITY,this.ni=ae=>Promise.resolve(),!uP.D())throw new Zt(Et.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new E6(this,r),this.si=t+"main",this.serializer=new hN(I),this.ii=new dd(this.si,this.Ys,new F6(this.serializer)),this.Ds=new b6(this.referenceDelegate,this.serializer),this.remoteDocumentCache=kN(this.serializer),this.xs=new d6,this.window&&this.window.localStorage?this.ri=this.window.localStorage:(this.ri=null,!1===V&&Ns("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.oi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Zt(Et.FAILED_PRECONDITION,cP);return this.ui(),this.ci(),this.ai(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ds.getHighestSequenceNumber(e))}).then(e=>{this.Vs=new Mc(e,this.Hs)}).then(()=>{this.Ss=!0}).catch(e=>(this.ii&&this.ii.close(),Promise.reject(e)))}hi(e){var t=this;return this.ni=function(){var i=(0,z.Z)(function*(r){if(t.started)return e(r)});return function(r){return i.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ii.B(function(){var t=(0,z.Z)(function*(i){null===i.newVersion&&(yield e())});return function(i){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Ws.enqueueAndForget((0,z.Z)(function*(){t.started&&(yield t.oi())})))}oi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>FS(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.li(e).next(t=>{t||(this.isPrimary=!1,this.Ws.enqueueRetryable(()=>this.ni(!1)))})}).next(()=>this.fi(e)).next(t=>this.isPrimary&&!t?this.di(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(dp(e))return sn("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return sn("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ws.enqueueRetryable(()=>this.ni(e)),this.isPrimary=e})}li(e){return EE(e).get("owner").next(t=>wt.resolve(this._i(t)))}mi(e){return FS(e).delete(this.clientId)}gi(){var e=this;return(0,z.Z)(function*(){if(e.isPrimary&&!e.yi(e.ei,18e5)){e.ei=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",i=>{const r=qa(i,"clientMetadata");return r.j().next(s=>{const f=e.pi(s,18e5),b=s.filter(I=>-1===f.indexOf(I));return wt.forEach(b,I=>r.delete(I.clientId)).next(()=>b)})}).catch(()=>[]);if(e.ri)for(const i of t)e.ri.removeItem(e.Ii(i.clientId))}})()}ai(){this.ti=this.Ws.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.oi().then(()=>this.gi()).then(()=>this.ai()))}_i(e){return!!e&&e.ownerId===this.clientId}fi(e){return this.Js?wt.resolve(!0):EE(e).get("owner").next(t=>{if(null!==t&&this.yi(t.leaseTimestampMs,5e3)&&!this.Ti(t.ownerId)){if(this._i(t)&&this.networkEnabled)return!0;if(!this._i(t)){if(!t.allowTabSynchronization)throw new Zt(Et.FAILED_PRECONDITION,cP);return!1}}return!(!this.networkEnabled||!this.inForeground)||FS(e).j().next(i=>void 0===this.pi(i,5e3).find(r=>!(this.clientId===r.clientId||!(!this.networkEnabled&&r.networkEnabled||!this.inForeground&&r.inForeground&&this.networkEnabled===r.networkEnabled))))}).next(t=>(this.isPrimary!==t&&sn("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,z.Z)(function*(){e.Ss=!1,e.Ei(),e.ti&&(e.ti.cancel(),e.ti=null),e.Ai(),e.Ri(),yield e.ii.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const i=new aS(t,Mc.ct);return e.di(i).next(()=>e.mi(i))}),e.ii.close(),e.vi()})()}pi(e,t){return e.filter(i=>this.yi(i.updateTimeMs,t)&&!this.Ti(i.clientId))}bi(){return this.runTransaction("getActiveClients","readonly",e=>FS(e).j().next(t=>this.pi(t,18e5).map(i=>i.clientId)))}get started(){return this.Ss}getMutationQueue(e,t){return OS.ie(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ds}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new v6(e,this.serializer.se.databaseId)}getDocumentOverlayCache(e){return SS.ie(this.serializer,e)}getBundleCache(){return this.xs}runTransaction(e,t,i){sn("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",s=15===(f=this.Ys)?IA:14===f?ob:13===f?sS:12===f?TA:11===f?oS:void Hn();var f;let b;return this.ii.runTransaction(e,r,s,I=>(b=new aS(I,this.Vs?this.Vs.next():Mc.ct),"readwrite-primary"===t?this.li(b).next(O=>!!O||this.fi(b)).next(O=>{if(!O)throw Ns(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ws.enqueueRetryable(()=>this.ni(!1)),new Zt(Et.FAILED_PRECONDITION,bA);return i(b)}).next(O=>this.wi(b).next(()=>O)):this.Pi(b).next(()=>i(b)))).then(I=>(b.raiseOnCommittedEvent(),I))}Pi(e){return EE(e).get("owner").next(t=>{if(null!==t&&this.yi(t.leaseTimestampMs,5e3)&&!this.Ti(t.ownerId)&&!this._i(t)&&!(this.Js||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Zt(Et.FAILED_PRECONDITION,cP)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return EE(e).put("owner",t)}static D(){return dd.D()}di(e){const t=EE(e);return t.get("owner").next(i=>this._i(i)?(sn("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):wt.resolve())}yi(e,t){const i=Date.now();return!(e<i-t||e>i&&(Ns(`Detected an update time that is in the future: ${e} > ${i}`),1))}ui(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Xs=()=>{this.Ws.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.oi()))},this.document.addEventListener("visibilitychange",this.Xs),this.inForeground="visible"===this.document.visibilityState)}Ai(){this.Xs&&(this.document.removeEventListener("visibilitychange",this.Xs),this.Xs=null)}ci(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=()=>{this.Ei();const t=/(?:Version|Mobile)\/1[456]/;(0,K.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ws.enterRestrictedMode(!0),this.Ws.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}Ri(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ti(e){var t;try{const i=null!==(null===(t=this.ri)||void 0===t?void 0:t.getItem(this.Ii(e)));return sn("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Ns("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Ei(){if(this.ri)try{this.ri.setItem(this.Ii(this.clientId),String(Date.now()))}catch(e){Ns("Failed to set zombie client id.",e)}}vi(){if(this.ri)try{this.ri.removeItem(this.Ii(this.clientId))}catch{}}Ii(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function EE(n){return qa(n,"owner")}function FS(n){return qa(n,"clientMetadata")}function dP(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class hP{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Vi=i,this.Si=r}static Di(e,t){let i=ir(),r=ir();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new hP(e,t.fromCache,i,r)}}class VN{constructor(){this.Ci=!1}initialize(e,t){this.xi=e,this.indexManager=t,this.Ci=!0}getDocumentsMatchingQuery(e,t,i,r){return this.Ni(e,t).next(s=>s||this.ki(e,t,r,i)).next(s=>s||this.Oi(e,t))}Ni(e,t){if(db(t))return wt.resolve(null);let i=gl(t);return this.indexManager.getIndexType(e,i).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=kw(t,null,"F"),i=gl(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const f=ir(...s);return this.xi.getDocuments(e,f).next(b=>this.indexManager.getMinOffset(e,i).next(I=>{const O=this.$i(t,b);return this.Mi(t,O,f,I.readTime)?this.Ni(e,kw(t,null,"F")):this.Fi(e,O,t,I)}))})))}ki(e,t,i,r){return db(t)||r.isEqual(fi.min())?this.Oi(e,t):this.xi.getDocuments(e,i).next(s=>{const f=this.$i(t,s);return this.Mi(t,f,i,r)?this.Oi(e,t):(jC()<=ie.in.DEBUG&&sn("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Rw(t)),this.Fi(e,f,t,Kg(r,-1)))})}$i(e,t){let i=new io(bS(e));return t.forEach((r,s)=>{Xy(e,s)&&(i=i.add(s))}),i}Mi(e,t,i,r){if(null===e.limit)return!1;if(i.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Oi(e,t){return jC()<=ie.in.DEBUG&&sn("QueryEngine","Using full collection scan to execute query:",Rw(t)),this.xi.getDocumentsMatchingQuery(e,t,Sc.min())}Fi(e,t,i,r){return this.xi.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(f=>{s=s.insert(f.key,f)}),s))}}class L6{constructor(e,t,i,r){this.persistence=e,this.Bi=t,this.serializer=r,this.Li=new Ts(Oi),this.qi=new gp(s=>i_(s),Yy),this.Ui=new Map,this.Ki=e.getRemoteDocumentCache(),this.Ds=e.getTargetCache(),this.xs=e.getBundleCache(),this.Gi(i)}Gi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new NN(this.Ki,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ki.setIndexManager(this.indexManager),this.Bi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Li))}}function UN(n,e,t,i){return new L6(n,e,t,i)}function jN(n,e){return fP.apply(this,arguments)}function fP(){return fP=(0,z.Z)(function*(n,e){const t=kn(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.Gi(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{const f=[],b=[];let I=ir();for(const O of r){f.push(O.batchId);for(const V of O.mutations)I=I.add(V.key)}for(const O of s){b.push(O.batchId);for(const V of O.mutations)I=I.add(V.key)}return t.localDocuments.getDocuments(i,I).next(O=>({Qi:O,removedBatchIds:f,addedBatchIds:b}))})})}),fP.apply(this,arguments)}function $N(n){const e=kn(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ds.getLastRemoteSnapshotVersion(t))}function GN(n,e,t){let i=ir(),r=ir();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let f=vu();return t.forEach((b,I)=>{const O=s.get(b);I.isFoundDocument()!==O.isFoundDocument()&&(r=r.add(b)),I.isNoDocument()&&I.version.isEqual(fi.min())?(e.removeEntry(b,I.readTime),f=f.insert(b,I)):!O.isValidDocument()||I.version.compareTo(O.version)>0||0===I.version.compareTo(O.version)&&O.hasPendingWrites?(e.addEntry(I),f=f.insert(b,I)):sn("LocalStore","Ignoring outdated watch update for ",b,". Current version:",O.version," Watch version:",I.version)}),{zi:f,ji:r}})}function B6(n,e){const t=kn(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Vw(n,e){const t=kn(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Ds.getTargetData(i,e).next(s=>s?(r=s,wt.resolve(r)):t.Ds.allocateTargetId(i).next(f=>(r=new ev(e,f,0,i.currentSequenceNumber),t.Ds.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=t.Li.get(i.targetId);return(null===r||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Li=t.Li.insert(i.targetId,i),t.qi.set(e,i.targetId)),i})}function Uw(n,e,t){return pP.apply(this,arguments)}function pP(){return pP=(0,z.Z)(function*(n,e,t){const i=kn(n),r=i.Li.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,f=>i.persistence.referenceDelegate.removeTarget(f,r)))}catch(f){if(!dp(f))throw f;sn("LocalStore",`Failed to update sequence numbers for target ${e}: ${f}`)}i.Li=i.Li.remove(e),i.qi.delete(r.target)}),pP.apply(this,arguments)}function LS(n,e,t){const i=kn(n);let r=fi.min(),s=ir();return i.persistence.runTransaction("Execute query","readonly",f=>function(b,I,O){const V=kn(b),X=V.qi.get(O);return void 0!==X?wt.resolve(V.Li.get(X)):V.Ds.getTargetData(I,O)}(i,f,gl(e)).next(b=>{if(b)return r=b.lastLimboFreeSnapshotVersion,i.Ds.getMatchingKeysForTargetId(f,b.targetId).next(I=>{s=I})}).next(()=>i.Bi.getDocumentsMatchingQuery(f,e,t?r:fi.min(),t?s:ir())).next(b=>(WN(i,lE(e),b),{documents:b,Wi:s})))}function HN(n,e){const t=kn(n),i=kn(t.Ds),r=t.Li.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>i.ne(s,e).next(f=>f?f.target:null))}function qN(n,e){const t=kn(n),i=t.Ui.get(e)||fi.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.Ki.getAllFromCollectionGroup(r,e,Kg(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(WN(t,e,r),r))}function WN(n,e,t){let i=n.Ui.get(e)||fi.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.Ui.set(e,i)}function mP(){return mP=(0,z.Z)(function*(n,e,t,i){const r=kn(n);let s=ir(),f=vu();for(const O of t){const V=e.Hi(O.metadata.name);O.document&&(s=s.add(V));const X=e.Ji(O);X.setReadTime(e.Yi(O.metadata.readTime)),f=f.insert(V,X)}const b=r.Ki.newChangeBuffer({trackRemovals:!0}),I=yield Vw(r,(O=i,gl(Am(Pr.fromString(`__bundle__/docs/${O}`)))));var O;return r.persistence.runTransaction("Apply bundle documents","readwrite",O=>GN(O,b,f).next(V=>(b.apply(O),V)).next(V=>r.Ds.removeMatchingKeysForTargetId(O,I.targetId).next(()=>r.Ds.addMatchingKeys(O,s,I.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(O,V.zi,V.ji)).next(()=>V.zi)))}),mP.apply(this,arguments)}function U6(n,e){return gP.apply(this,arguments)}function gP(){return gP=(0,z.Z)(function*(n,e,t=ir()){const i=yield Vw(n,gl(tP(e.bundledQuery))),r=kn(n);return r.persistence.runTransaction("Save named query","readwrite",s=>{const f=ra(e.readTime);if(i.snapshotVersion.compareTo(f)>=0)return r.xs.saveNamedQuery(s,e);const b=i.withResumeToken(na.EMPTY_BYTE_STRING,f);return r.Li=r.Li.insert(b.targetId,b),r.Ds.updateTargetData(s,b).next(()=>r.Ds.removeMatchingKeysForTargetId(s,i.targetId)).next(()=>r.Ds.addMatchingKeys(s,t,i.targetId)).next(()=>r.xs.saveNamedQuery(s,e))})}),gP.apply(this,arguments)}function ZN(n,e){return`firestore_clients_${n}_${e}`}function YN(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function _P(n,e){return`firestore_targets_${n}_${e}`}class NS{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static Zi(e,t,i){const r=JSON.parse(i);let s,f="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return f&&r.error&&(f="string"==typeof r.error.message&&"string"==typeof r.error.code,f&&(s=new Zt(r.error.code,r.error.message))),f?new NS(e,t,r.state,s):(Ns("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}Xi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class TE{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Zi(e,t){const i=JSON.parse(t);let r,s="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return s&&i.error&&(s="string"==typeof i.error.message&&"string"==typeof i.error.code,s&&(r=new Zt(i.error.code,i.error.message))),s?new TE(e,i.state,r):(Ns("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Xi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class zS{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Zi(e,t){const i=JSON.parse(t);let r="object"==typeof i&&i.activeTargetIds instanceof Array,s=dE();for(let f=0;r&&f<i.activeTargetIds.length;++f)r=eS(i.activeTargetIds[f]),s=s.add(i.activeTargetIds[f]);return r?new zS(e,s):(Ns("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class yP{constructor(e,t){this.clientId=e,this.onlineState=t}static Zi(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new yP(t.clientId,t.onlineState):(Ns("SharedClientState",`Failed to parse online state: ${e}`),null)}}class vP{constructor(){this.activeTargetIds=dE()}tr(e){this.activeTargetIds=this.activeTargetIds.add(e)}er(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Xi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class bP{constructor(e,t,i,r,s){this.window=e,this.Ws=t,this.persistenceKey=i,this.nr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.sr=this.ir.bind(this),this.rr=new Ts(Oi),this.started=!1,this.ur=[];const f=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.cr=ZN(this.persistenceKey,this.nr),this.ar=`firestore_sequence_number_${this.persistenceKey}`,this.rr=this.rr.insert(this.nr,new vP),this.hr=new RegExp(`^firestore_clients_${f}_([^_]*)$`),this.lr=new RegExp(`^firestore_mutations_${f}_(\\d+)(?:_(.*))?$`),this.dr=new RegExp(`^firestore_targets_${f}_(\\d+)$`),this.wr=`firestore_online_state_${this.persistenceKey}`,this._r=function(b){return`firestore_bundle_loaded_v2_${b}`}(this.persistenceKey),this.window.addEventListener("storage",this.sr)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,z.Z)(function*(){const t=yield e.syncEngine.bi();for(const r of t){if(r===e.nr)continue;const s=e.getItem(ZN(e.persistenceKey,r));if(s){const f=zS.Zi(r,s);f&&(e.rr=e.rr.insert(f.clientId,f))}}e.mr();const i=e.storage.getItem(e.wr);if(i){const r=e.gr(i);r&&e.yr(r)}for(const r of e.ur)e.ir(r);e.ur=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ar,JSON.stringify(e))}getAllActiveQueryTargets(){return this.pr(this.rr)}isActiveQueryTarget(e){let t=!1;return this.rr.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ir(e,"pending")}updateMutationState(e,t,i){this.Ir(e,t,i),this.Tr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(_P(this.persistenceKey,e));if(i){const r=TE.Zi(e,i);r&&(t=r.state)}}return this.Er.tr(e),this.mr(),t}removeLocalQueryTarget(e){this.Er.er(e),this.mr()}isLocalQueryTarget(e){return this.Er.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(_P(this.persistenceKey,e))}updateQueryState(e,t,i){this.Ar(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.Tr(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Rr(e)}notifyBundleLoaded(e){this.vr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.sr),this.removeItem(this.cr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return sn("SharedClientState","READ",e,t),t}setItem(e,t){sn("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){sn("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ir(e){var t=this;const i=e;if(i.storageArea===this.storage){if(sn("SharedClientState","EVENT",i.key,i.newValue),i.key===this.cr)return void Ns("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ws.enqueueRetryable((0,z.Z)(function*(){if(t.started){if(null!==i.key)if(t.hr.test(i.key)){if(null==i.newValue){const r=t.br(i.key);return t.Pr(r,null)}{const r=t.Vr(i.key,i.newValue);if(r)return t.Pr(r.clientId,r)}}else if(t.lr.test(i.key)){if(null!==i.newValue){const r=t.Sr(i.key,i.newValue);if(r)return t.Dr(r)}}else if(t.dr.test(i.key)){if(null!==i.newValue){const r=t.Cr(i.key,i.newValue);if(r)return t.Nr(r)}}else if(i.key===t.wr){if(null!==i.newValue){const r=t.gr(i.newValue);if(r)return t.yr(r)}}else if(i.key===t.ar){const r=function(s){let f=Mc.ct;if(null!=s)try{const b=JSON.parse(s);si("number"==typeof b),f=b}catch(b){Ns("SharedClientState","Failed to read sequence number from WebStorage",b)}return f}(i.newValue);r!==Mc.ct&&t.sequenceNumberHandler(r)}else if(i.key===t._r){const r=t.kr(i.newValue);yield Promise.all(r.map(s=>t.syncEngine.Or(s)))}}else t.ur.push(i)}))}}get Er(){return this.rr.get(this.nr)}mr(){this.setItem(this.cr,this.Er.Xi())}Ir(e,t,i){const r=new NS(this.currentUser,e,t,i),s=YN(this.persistenceKey,this.currentUser,e);this.setItem(s,r.Xi())}Tr(e){const t=YN(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Rr(e){this.storage.setItem(this.wr,JSON.stringify({clientId:this.nr,onlineState:e}))}Ar(e,t,i){const r=_P(this.persistenceKey,e),s=new TE(e,t,i);this.setItem(r,s.Xi())}vr(e){const t=JSON.stringify(Array.from(e));this.setItem(this._r,t)}br(e){const t=this.hr.exec(e);return t?t[1]:null}Vr(e,t){const i=this.br(e);return zS.Zi(i,t)}Sr(e,t){const i=this.lr.exec(e),r=Number(i[1]);return NS.Zi(new ta(void 0!==i[2]?i[2]:null),r,t)}Cr(e,t){const i=this.dr.exec(e),r=Number(i[1]);return TE.Zi(r,t)}gr(e){return yP.Zi(e)}kr(e){return JSON.parse(e)}Dr(e){var t=this;return(0,z.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.$r(e.batchId,e.state,e.error);sn("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Nr(e){return this.syncEngine.Mr(e.targetId,e.state,e.error)}Pr(e,t){const i=t?this.rr.insert(e,t):this.rr.remove(e),r=this.pr(this.rr),s=this.pr(i),f=[],b=[];return s.forEach(I=>{r.has(I)||f.push(I)}),r.forEach(I=>{s.has(I)||b.push(I)}),this.syncEngine.Fr(f,b).then(()=>{this.rr=i})}yr(e){this.rr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}pr(e){let t=dE();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class KN{constructor(){this.Br=new vP,this.Lr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.Br.tr(e),this.Lr[e]||"not-current"}updateQueryState(e,t,i){this.Lr[e]=t}removeLocalQueryTarget(e){this.Br.er(e)}isLocalQueryTarget(e){return this.Br.activeTargetIds.has(e)}clearQueryState(e){delete this.Lr[e]}getAllActiveQueryTargets(){return this.Br.activeTargetIds}isActiveQueryTarget(e){return this.Br.activeTargetIds.has(e)}start(){return this.Br=new vP,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class j6{qr(e){}shutdown(){}}class XN{constructor(){this.Ur=()=>this.Kr(),this.Gr=()=>this.Qr(),this.zr=[],this.jr()}qr(e){this.zr.push(e)}shutdown(){window.removeEventListener("online",this.Ur),window.removeEventListener("offline",this.Gr)}jr(){window.addEventListener("online",this.Ur),window.addEventListener("offline",this.Gr)}Kr(){sn("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.zr)e(0)}Qr(){sn("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.zr)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let BS=null;function xP(){return null===BS?BS=268435456+Math.round(2147483648*Math.random()):BS++,"0x"+BS.toString(16)}const $6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class G6{constructor(e){this.Wr=e.Wr,this.Hr=e.Hr}Jr(e){this.Yr=e}Zr(e){this.Xr=e}onMessage(e){this.eo=e}close(){this.Hr()}send(e){this.Wr(e)}no(){this.Yr()}so(e){this.Xr(e)}io(e){this.eo(e)}}const Ac="WebChannelConnection";class H6 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.ro=(e.ssl?"https":"http")+"://"+e.host,this.oo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get uo(){return!1}co(e,t,i,r,s){const f=xP(),b=this.ao(e,t);sn("RestConnection",`Sending RPC '${e}' ${f}:`,b,i);const I={};return this.ho(I,r,s),this.lo(e,b,I,i).then(O=>(sn("RestConnection",`Received RPC '${e}' ${f}: `,O),O),O=>{throw Qd("RestConnection",`RPC '${e}' ${f} failed with error: `,O,"url: ",b,"request:",i),O})}fo(e,t,i,r,s,f){return this.co(e,t,i,r,s)}ho(e,t,i){e["X-Goog-Api-Client"]="gl-js/ fire/"+Tm,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),i&&i.headers.forEach((r,s)=>e[s]=r)}ao(e,t){return`${this.ro}/v1/${t}:${$6[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}lo(e,t,i,r){const s=xP();return new Promise((f,b)=>{const I=new UC;I.setWithCredentials(!0),I.listenOnce(mA.COMPLETE,()=>{try{switch(I.getLastErrorCode()){case zC.NO_ERROR:const V=I.getResponseJson();sn(Ac,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(V)),f(V);break;case zC.TIMEOUT:sn(Ac,`RPC '${e}' ${s} timed out`),b(new Zt(Et.DEADLINE_EXCEEDED,"Request time out"));break;case zC.HTTP_ERROR:const X=I.getStatus();if(sn(Ac,`RPC '${e}' ${s} failed with status:`,X,"response text:",I.getResponseText()),X>0){let ae=I.getResponseJson();Array.isArray(ae)&&(ae=ae[0]);const me=ae?.error;if(me&&me.status&&me.message){const Ie=function(Ge){const Je=Ge.toLowerCase().replace(/_/g,"-");return Object.values(Et).indexOf(Je)>=0?Je:Et.UNKNOWN}(me.status);b(new Zt(Ie,me.message))}else b(new Zt(Et.UNKNOWN,"Server responded with status "+I.getStatus()))}else b(new Zt(Et.UNAVAILABLE,"Connection failed."));break;default:Hn()}}finally{sn(Ac,`RPC '${e}' ${s} completed.`)}});const O=JSON.stringify(r);sn(Ac,`RPC '${e}' ${s} sending request:`,r),I.send(t,"POST",O,i,15)})}wo(e,t,i){const r=xP(),s=[this.ro,"/","google.firestore.v1.Firestore","/",e,"/channel"],f=yw(),b=vw(),I={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(I.xmlHttpFactory=new VC({})),this.ho(I.initMessageHeaders,t,i),I.encodeInitMessageHeaders=!0;const O=s.join("");sn(Ac,`Creating RPC '${e}' stream ${r}: ${O}`,I);const V=f.createWebChannel(O,I);let X=!1,ae=!1;const me=new G6({Wr:Ge=>{ae?sn(Ac,`Not sending because RPC '${e}' stream ${r} is closed:`,Ge):(X||(sn(Ac,`Opening RPC '${e}' stream ${r} transport.`),V.open(),X=!0),sn(Ac,`RPC '${e}' stream ${r} sending:`,Ge),V.send(Ge))},Hr:()=>V.close()}),Ie=(Ge,Je,Qt)=>{Ge.listen(Je,xn=>{try{Qt(xn)}catch(Nn){setTimeout(()=>{throw Nn},0)}})};return Ie(V,Q0.EventType.OPEN,()=>{ae||sn(Ac,`RPC '${e}' stream ${r} transport opened.`)}),Ie(V,Q0.EventType.CLOSE,()=>{ae||(ae=!0,sn(Ac,`RPC '${e}' stream ${r} transport closed`),me.so())}),Ie(V,Q0.EventType.ERROR,Ge=>{ae||(ae=!0,Qd(Ac,`RPC '${e}' stream ${r} transport errored:`,Ge),me.so(new Zt(Et.UNAVAILABLE,"The operation could not be completed")))}),Ie(V,Q0.EventType.MESSAGE,Ge=>{var Je;if(!ae){const Qt=Ge.data[0];si(!!Qt);const Nn=Qt.error||(null===(Je=Qt[0])||void 0===Je?void 0:Je.error);if(Nn){sn(Ac,`RPC '${e}' stream ${r} received error:`,Nn);const ai=Nn.status;let Hi=function(ro){const xl=Ia[ro];if(void 0!==xl)return YL(xl)}(ai),Xi=Nn.message;void 0===Hi&&(Hi=Et.INTERNAL,Xi="Unknown error status: "+ai+" with message "+Nn.message),ae=!0,me.so(new Zt(Hi,Xi)),V.close()}else sn(Ac,`RPC '${e}' stream ${r} received:`,Qt),me.io(Qt)}}),Ie(b,UI.STAT_EVENT,Ge=>{Ge.stat===BC.PROXY?sn(Ac,`RPC '${e}' stream ${r} detected buffering proxy`):Ge.stat===BC.NOPROXY&&sn(Ac,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{me.no()},0),me}}function QN(){return typeof window<"u"?window:null}function VS(){return typeof document<"u"?document:null}function IE(n){return new e6(n,!0)}class wP{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Ws=e,this.timerId=t,this._o=i,this.mo=r,this.yo=s,this.po=0,this.Io=null,this.To=Date.now(),this.reset()}reset(){this.po=0}Eo(){this.po=this.yo}Ao(e){this.cancel();const t=Math.floor(this.po+this.Ro()),i=Math.max(0,Date.now()-this.To),r=Math.max(0,t-i);r>0&&sn("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.po} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.Io=this.Ws.enqueueAfterDelay(this.timerId,r,()=>(this.To=Date.now(),e())),this.po*=this.mo,this.po<this._o&&(this.po=this._o),this.po>this.yo&&(this.po=this.yo)}vo(){null!==this.Io&&(this.Io.skipDelay(),this.Io=null)}cancel(){null!==this.Io&&(this.Io.cancel(),this.Io=null)}Ro(){return(Math.random()-.5)*this.po}}class JN{constructor(e,t,i,r,s,f,b,I){this.Ws=e,this.bo=i,this.Po=r,this.connection=s,this.authCredentialsProvider=f,this.appCheckCredentialsProvider=b,this.listener=I,this.state=0,this.Vo=0,this.So=null,this.Do=null,this.stream=null,this.Co=new wP(e,t)}xo(){return 1===this.state||5===this.state||this.No()}No(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.ko()}stop(){var e=this;return(0,z.Z)(function*(){e.xo()&&(yield e.close(0))})()}Oo(){this.state=0,this.Co.reset()}$o(){this.No()&&null===this.So&&(this.So=this.Ws.enqueueAfterDelay(this.bo,6e4,()=>this.Mo()))}Fo(e){this.Bo(),this.stream.send(e)}Mo(){var e=this;return(0,z.Z)(function*(){if(e.No())return e.close(0)})()}Bo(){this.So&&(this.So.cancel(),this.So=null)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}close(e,t){var i=this;return(0,z.Z)(function*(){i.Bo(),i.Lo(),i.Co.cancel(),i.Vo++,4!==e?i.Co.reset():t&&t.code===Et.RESOURCE_EXHAUSTED?(Ns(t.toString()),Ns("Using maximum backoff delay to prevent overloading the backend."),i.Co.Eo()):t&&t.code===Et.UNAUTHENTICATED&&3!==i.state&&(i.authCredentialsProvider.invalidateToken(),i.appCheckCredentialsProvider.invalidateToken()),null!==i.stream&&(i.qo(),i.stream.close(),i.stream=null),i.state=e,yield i.listener.Zr(t)})()}qo(){}auth(){this.state=1;const e=this.Uo(this.Vo),t=this.Vo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Vo===t&&this.Ko(i,r)},i=>{e(()=>{const r=new Zt(Et.UNKNOWN,"Fetching auth token failed: "+i.message);return this.Go(r)})})}Ko(e,t){const i=this.Uo(this.Vo);this.stream=this.Qo(e,t),this.stream.Jr(()=>{i(()=>(this.state=2,this.Do=this.Ws.enqueueAfterDelay(this.Po,1e4,()=>(this.No()&&(this.state=3),Promise.resolve())),this.listener.Jr()))}),this.stream.Zr(r=>{i(()=>this.Go(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}ko(){var e=this;this.state=5,this.Co.Ao((0,z.Z)(function*(){e.state=0,e.start()}))}Go(e){return sn("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Uo(e){return t=>{this.Ws.enqueueAndForget(()=>this.Vo===e?t():(sn("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class q6 extends JN{constructor(e,t,i,r,s,f){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,f),this.serializer=s}Qo(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.Co.reset();const t=function i6(n,e){let t;if("targetChange"in e){const i="NO_CHANGE"===(I=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===I?1:"REMOVE"===I?2:"CURRENT"===I?3:"RESET"===I?4:Hn(),r=e.targetChange.targetIds||[],s=function(I,O){return I.useProto3Json?(si(void 0===O||"string"==typeof O),na.fromBase64String(O||"")):(si(void 0===O||O instanceof Uint8Array),na.fromUint8Array(O||new Uint8Array))}(n,e.targetChange.resumeToken),f=e.targetChange.cause,b=f&&function(I){const O=void 0===I.code?Et.UNKNOWN:YL(I.code);return new Zt(O,I.message||"")}(f);t=new XL(i,r,s,b||null)}else if("documentChange"in e){const i=e.documentChange,r=Pm(n,i.document.name),s=ra(i.document.updateTime),f=i.document.createTime?ra(i.document.createTime):fi.min(),b=new Ta({mapValue:{fields:i.document.fields}}),I=rs.newFoundDocument(r,s,f,b);t=new TS(i.targetIds||[],i.removedTargetIds||[],I.key,I)}else if("documentDelete"in e){const i=e.documentDelete,r=Pm(n,i.document),s=i.readTime?ra(i.readTime):fi.min(),f=rs.newNoDocument(r,s);t=new TS([],i.removedTargetIds||[],f.key,f)}else if("documentRemove"in e){const i=e.documentRemove,r=Pm(n,i.document);t=new TS([],i.removedTargetIds||[],r,null)}else{if(!("filter"in e))return Hn();{const i=e.filter,s=new Y5(i.count||0);t=new KL(i.targetId,s)}}var I;return t}(this.serializer,e),i=function(r){if(!("targetChange"in r))return fi.min();const s=r.targetChange;return s.targetIds&&s.targetIds.length?fi.min():s.readTime?ra(s.readTime):fi.min()}(e);return this.listener.zo(t,i)}jo(e){const t={};t.database=gE(this.serializer),t.addTarget=function(r,s){let f;const b=s.target;return f=ef(b)?{documents:aN(r,b)}:{query:eP(r,b)},f.targetId=s.targetId,s.resumeToken.approximateByteSize()>0?f.resumeToken=tN(r,s.resumeToken):s.snapshotVersion.compareTo(fi.min())>0&&(f.readTime=Lw(r,s.snapshotVersion.toTimestamp())),f}(this.serializer,e);const i=function o6(n,e){const t=function(i,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Hn()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);i&&(t.labels=i),this.Fo(t)}Wo(e){const t={};t.database=gE(this.serializer),t.removeTarget=e,this.Fo(t)}}class W6 extends JN{constructor(e,t,i,r,s,f){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,f),this.serializer=s,this.Ho=!1}get Jo(){return this.Ho}start(){this.Ho=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Ho&&this.Yo([])}Qo(e,t){return this.connection.wo("Write",e,t)}onMessage(e){if(si(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Ho){this.Co.reset();const t=function r6(n,e){return n&&n.length>0?(si(void 0!==e),n.map(t=>function(i,r){let s=ra(i.updateTime?i.updateTime:r);return s.isEqual(fi.min())&&(s=ra(r)),new Q(s,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),i=ra(e.commitTime);return this.listener.Zo(i,t)}return si(!e.writeResults||0===e.writeResults.length),this.Ho=!0,this.listener.Xo()}tu(){const e={};e.database=gE(this.serializer),this.Fo(e)}Yo(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>_E(this.serializer,i))};this.Fo(t)}}class Z6 extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.eu=!1}nu(){if(this.eu)throw new Zt(Et.FAILED_PRECONDITION,"The client has already been terminated.")}co(e,t,i){return this.nu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.co(e,t,i,r,s)).catch(r=>{throw"FirebaseError"===r.name?(r.code===Et.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Zt(Et.UNKNOWN,r.toString())})}fo(e,t,i,r){return this.nu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,f])=>this.connection.fo(e,t,i,s,f,r)).catch(s=>{throw"FirebaseError"===s.name?(s.code===Et.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Zt(Et.UNKNOWN,s.toString())})}terminate(){this.eu=!0}}class K6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.su=0,this.iu=null,this.ru=!0}ou(){0===this.su&&(this.uu("Unknown"),this.iu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.iu=null,this.cu("Backend didn't respond within 10 seconds."),this.uu("Offline"),Promise.resolve())))}au(e){"Online"===this.state?this.uu("Unknown"):(this.su++,this.su>=1&&(this.hu(),this.cu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.uu("Offline")))}set(e){this.hu(),this.su=0,"Online"===e&&(this.ru=!1),this.uu(e)}uu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}cu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ru?(Ns(t),this.ru=!1):sn("OnlineStateTracker",t)}hu(){null!==this.iu&&(this.iu.cancel(),this.iu=null)}}class X6{constructor(e,t,i,r,s){var f=this;this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.lu=[],this.fu=new Map,this.du=new Set,this.wu=[],this._u=s,this._u.qr(b=>{i.enqueueAndForget((0,z.Z)(function*(){var I;o_(f)&&(sn("RemoteStore","Restarting streams for network reachability change."),yield(I=(0,z.Z)(function*(O){const V=kn(O);V.du.add(4),yield jw(V),V.mu.set("Unknown"),V.du.delete(4),yield SE(V)}),function(O){return I.apply(this,arguments)})(f))}))}),this.mu=new K6(i,r)}}function SE(n){return EP.apply(this,arguments)}function EP(){return EP=(0,z.Z)(function*(n){if(o_(n))for(const e of n.wu)yield e(!0)}),EP.apply(this,arguments)}function jw(n){return TP.apply(this,arguments)}function TP(){return TP=(0,z.Z)(function*(n){for(const e of n.wu)yield e(!1)}),TP.apply(this,arguments)}function US(n,e){const t=kn(n);t.fu.has(e.targetId)||(t.fu.set(e.targetId,e),MP(t)?SP(t):Gw(t).No()&&IP(t,e))}function ME(n,e){const t=kn(n),i=Gw(t);t.fu.delete(e),i.No()&&ez(t,e),0===t.fu.size&&(i.No()?i.$o():o_(t)&&t.mu.set("Unknown"))}function IP(n,e){n.gu.Ot(e.targetId),Gw(n).jo(e)}function ez(n,e){n.gu.Ot(e),Gw(n).Wo(e)}function SP(n){n.gu=new K5({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ne:e=>n.fu.get(e)||null}),Gw(n).start(),n.mu.ou()}function MP(n){return o_(n)&&!Gw(n).xo()&&n.fu.size>0}function o_(n){return 0===kn(n).du.size}function tz(n){n.gu=void 0}function Q6(n){return DP.apply(this,arguments)}function DP(){return DP=(0,z.Z)(function*(n){n.fu.forEach((e,t)=>{IP(n,e)})}),DP.apply(this,arguments)}function J6(n,e){return AP.apply(this,arguments)}function AP(){return AP=(0,z.Z)(function*(n,e){tz(n),MP(n)?(n.mu.au(e),SP(n)):n.mu.set("Unknown")}),AP.apply(this,arguments)}function e$(n,e,t){return PP.apply(this,arguments)}function PP(){return PP=(0,z.Z)(function*(n,e,t){if(n.mu.set("Online"),e instanceof XL&&2===e.state&&e.cause)try{yield(i=(0,z.Z)(function*(r,s){const f=s.cause;for(const b of s.targetIds)r.fu.has(b)&&(yield r.remoteSyncer.rejectListen(b,f),r.fu.delete(b),r.gu.removeTarget(b))}),function(r,s){return i.apply(this,arguments)})(n,e)}catch(i){sn("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield jS(n,i)}else if(e instanceof TS?n.gu.Kt(e):e instanceof KL?n.gu.Jt(e):n.gu.zt(e),!t.isEqual(fi.min()))try{const i=yield $N(n.localStore);t.compareTo(i)>=0&&(yield function(r,s){const f=r.gu.Xt(s);return f.targetChanges.forEach((b,I)=>{if(b.resumeToken.approximateByteSize()>0){const O=r.fu.get(I);O&&r.fu.set(I,O.withResumeToken(b.resumeToken,s))}}),f.targetMismatches.forEach(b=>{const I=r.fu.get(b);if(!I)return;r.fu.set(b,I.withResumeToken(na.EMPTY_BYTE_STRING,I.snapshotVersion)),ez(r,b);const O=new ev(I.target,b,1,I.sequenceNumber);IP(r,O)}),r.remoteSyncer.applyRemoteEvent(f)}(n,t))}catch(i){sn("RemoteStore","Failed to raise snapshot:",i),yield jS(n,i)}var i}),PP.apply(this,arguments)}function jS(n,e,t){return OP.apply(this,arguments)}function OP(){return OP=(0,z.Z)(function*(n,e,t){if(!dp(e))throw e;n.du.add(1),yield jw(n),n.mu.set("Offline"),t||(t=()=>$N(n.localStore)),n.asyncQueue.enqueueRetryable((0,z.Z)(function*(){sn("RemoteStore","Retrying IndexedDB access"),yield t(),n.du.delete(1),yield SE(n)}))}),OP.apply(this,arguments)}function nz(n,e){return e().catch(t=>jS(n,t,e))}function $w(n){return kP.apply(this,arguments)}function kP(){return kP=(0,z.Z)(function*(n){const e=kn(n),t=rv(e);let i=e.lu.length>0?e.lu[e.lu.length-1].batchId:-1;for(;t$(e);)try{const r=yield B6(e.localStore,i);if(null===r){0===e.lu.length&&t.$o();break}i=r.batchId,n$(e,r)}catch(r){yield jS(e,r)}iz(e)&&rz(e)}),kP.apply(this,arguments)}function t$(n){return o_(n)&&n.lu.length<10}function n$(n,e){n.lu.push(e);const t=rv(n);t.No()&&t.Jo&&t.Yo(e.mutations)}function iz(n){return o_(n)&&!rv(n).xo()&&n.lu.length>0}function rz(n){rv(n).start()}function i$(n){return RP.apply(this,arguments)}function RP(){return RP=(0,z.Z)(function*(n){rv(n).tu()}),RP.apply(this,arguments)}function r$(n){return FP.apply(this,arguments)}function FP(){return FP=(0,z.Z)(function*(n){const e=rv(n);for(const t of n.lu)e.Yo(t.mutations)}),FP.apply(this,arguments)}function o$(n,e,t){return LP.apply(this,arguments)}function LP(){return LP=(0,z.Z)(function*(n,e,t){const i=n.lu.shift(),r=WA.from(i,e,t);yield nz(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield $w(n)}),LP.apply(this,arguments)}function s$(n,e){return NP.apply(this,arguments)}function NP(){return NP=(0,z.Z)(function*(n,e){var t;e&&rv(n).Jo&&(yield(t=(0,z.Z)(function*(i,r){if(ZL(s=r.code)&&s!==Et.ABORTED){const f=i.lu.shift();rv(i).Oo(),yield nz(i,()=>i.remoteSyncer.rejectFailedWrite(f.batchId,r)),yield $w(i)}var s}),function(i,r){return t.apply(this,arguments)})(n,e)),iz(n)&&rz(n)}),NP.apply(this,arguments)}function oz(n,e){return zP.apply(this,arguments)}function zP(){return zP=(0,z.Z)(function*(n,e){const t=kn(n);t.asyncQueue.verifyOperationInProgress(),sn("RemoteStore","RemoteStore received new credentials");const i=o_(t);t.du.add(3),yield jw(t),i&&t.mu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.du.delete(3),yield SE(t)}),zP.apply(this,arguments)}function BP(n,e){return VP.apply(this,arguments)}function VP(){return VP=(0,z.Z)(function*(n,e){const t=kn(n);e?(t.du.delete(2),yield SE(t)):e||(t.du.add(2),yield jw(t),t.mu.set("Unknown"))}),VP.apply(this,arguments)}function Gw(n){return n.yu||(n.yu=function(e,t,i){const r=kn(e);return r.nu(),new q6(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{Jr:Q6.bind(null,n),Zr:J6.bind(null,n),zo:e$.bind(null,n)}),n.wu.push(function(){var e=(0,z.Z)(function*(t){t?(n.yu.Oo(),MP(n)?SP(n):n.mu.set("Unknown")):(yield n.yu.stop(),tz(n))});return function(t){return e.apply(this,arguments)}}())),n.yu}function rv(n){return n.pu||(n.pu=function(e,t,i){const r=kn(e);return r.nu(),new W6(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{Jr:i$.bind(null,n),Zr:s$.bind(null,n),Xo:r$.bind(null,n),Zo:o$.bind(null,n)}),n.wu.push(function(){var e=(0,z.Z)(function*(t){t?(n.pu.Oo(),yield $w(n)):(yield n.pu.stop(),n.lu.length>0&&(sn("RemoteStore",`Stopping write stream with ${n.lu.length} pending writes`),n.lu=[]))});return function(t){return e.apply(this,arguments)}}())),n.pu}class UP{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new Ws,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(f=>{})}static createAndSchedule(e,t,i,r,s){const f=Date.now()+i,b=new UP(e,t,f,r,s);return b.start(i),b}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Zt(Et.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hw(n,e){if(Ns("AsyncQueue",`${e}: ${n}`),dp(n))return new Zt(Et.UNAVAILABLE,`${e}: ${n}`);throw n}class qw{constructor(e){this.comparator=e?(t,i)=>e(t,i)||Pn.comparator(t.key,i.key):(t,i)=>Pn.comparator(t.key,i.key),this.keyedMap=r_(),this.sortedSet=new Ts(this.comparator)}static emptySet(e){return new qw(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof qw)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const i=new qw;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class sz{constructor(){this.Iu=new Ts(Pn.comparator)}track(e){const t=e.doc.key,i=this.Iu.get(t);i?0!==e.type&&3===i.type?this.Iu=this.Iu.insert(t,e):3===e.type&&1!==i.type?this.Iu=this.Iu.insert(t,{type:i.type,doc:e.doc}):2===e.type&&2===i.type?this.Iu=this.Iu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===i.type?this.Iu=this.Iu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===i.type?this.Iu=this.Iu.remove(t):1===e.type&&2===i.type?this.Iu=this.Iu.insert(t,{type:1,doc:i.doc}):0===e.type&&1===i.type?this.Iu=this.Iu.insert(t,{type:2,doc:e.doc}):Hn():this.Iu=this.Iu.insert(t,e)}Tu(){const e=[];return this.Iu.inorderTraversal((t,i)=>{e.push(i)}),e}}class Ww{constructor(e,t,i,r,s,f,b,I,O){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=f,this.syncStateChanged=b,this.excludesMetadataChanges=I,this.hasCachedResults=O}static fromInitialDocuments(e,t,i,r,s){const f=[];return t.forEach(b=>{f.push({type:0,doc:b})}),new Ww(e,t,qw.emptySet(t),f,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hb(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}class a${constructor(){this.Eu=void 0,this.listeners=[]}}class l${constructor(){this.queries=new gp(e=>vS(e),hb),this.onlineState="Unknown",this.Au=new Set}}function jP(n,e){return $P.apply(this,arguments)}function $P(){return $P=(0,z.Z)(function*(n,e){const t=kn(n),i=e.query;let r=!1,s=t.queries.get(i);if(s||(r=!0,s=new a$),r)try{s.Eu=yield t.onListen(i)}catch(f){const b=Hw(f,`Initialization of query '${Rw(e.query)}' failed`);return void e.onError(b)}t.queries.set(i,s),s.listeners.push(e),e.Ru(t.onlineState),s.Eu&&e.vu(s.Eu)&&qP(t)}),$P.apply(this,arguments)}function GP(n,e){return HP.apply(this,arguments)}function HP(){return HP=(0,z.Z)(function*(n,e){const t=kn(n),i=e.query;let r=!1;const s=t.queries.get(i);if(s){const f=s.listeners.indexOf(e);f>=0&&(s.listeners.splice(f,1),r=0===s.listeners.length)}if(r)return t.queries.delete(i),t.onUnlisten(i)}),HP.apply(this,arguments)}function c$(n,e){const t=kn(n);let i=!1;for(const r of e){const f=t.queries.get(r.query);if(f){for(const b of f.listeners)b.vu(r)&&(i=!0);f.Eu=r}}i&&qP(t)}function u$(n,e,t){const i=kn(n),r=i.queries.get(e);if(r)for(const s of r.listeners)s.onError(t);i.queries.delete(e)}function qP(n){n.Au.forEach(e=>{e.next()})}class WP{constructor(e,t,i){this.query=e,this.bu=t,this.Pu=!1,this.Vu=null,this.onlineState="Unknown",this.options=i||{}}vu(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)3!==r.type&&i.push(r);e=new Ww(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Pu?this.Su(e)&&(this.bu.next(e),t=!0):this.Du(e,this.onlineState)&&(this.Cu(e),t=!0),this.Vu=e,t}onError(e){this.bu.error(e)}Ru(e){this.onlineState=e;let t=!1;return this.Vu&&!this.Pu&&this.Du(this.Vu,e)&&(this.Cu(this.Vu),t=!0),t}Du(e,t){return!e.fromCache||(!this.options.xu||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Su(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Vu&&this.Vu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Cu(e){e=Ww.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Pu=!0,this.bu.next(e)}}class d${constructor(e,t){this.Nu=e,this.byteLength=t}ku(){return"metadata"in this.Nu}}class az{constructor(e){this.serializer=e}Hi(e){return Pm(this.serializer,e)}Ji(e){return e.metadata.exists?sN(this.serializer,e.document,!1):rs.newNoDocument(this.Hi(e.metadata.name),this.Yi(e.metadata.readTime))}Yi(e){return ra(e)}}class h${constructor(e,t,i){this.Ou=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=lz(e)}$u(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Nu.namedQuery)this.queries.push(e.Nu.namedQuery);else if(e.Nu.documentMetadata){this.documents.push({metadata:e.Nu.documentMetadata}),e.Nu.documentMetadata.exists||++t;const i=Pr.fromString(e.Nu.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.Nu.document&&(this.documents[this.documents.length-1].document=e.Nu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Mu(e){const t=new Map,i=new az(this.serializer);for(const r of e)if(r.metadata.queries){const s=i.Hi(r.metadata.name);for(const f of r.metadata.queries){const b=(t.get(f)||ir()).add(s);t.set(f,b)}}return t}complete(){var e=this;return(0,z.Z)(function*(){const t=yield function V6(n,e,t,i){return mP.apply(this,arguments)}(e.localStore,new az(e.serializer),e.documents,e.Ou.id),i=e.Mu(e.documents);for(const r of e.queries)yield U6(e.localStore,r,i.get(r.name));return e.progress.taskState="Success",{progress:e.progress,Fu:e.collectionGroups,Bu:t}})()}}function lz(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class cz{constructor(e){this.key=e}}class uz{constructor(e){this.key=e}}class dz{constructor(e,t){this.query=e,this.Lu=t,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Uu=ir(),this.mutatedKeys=ir(),this.Ku=bS(e),this.Gu=new qw(this.Ku)}get Qu(){return this.Lu}zu(e,t){const i=t?t.ju:new sz,r=t?t.Gu:this.Gu;let s=t?t.mutatedKeys:this.mutatedKeys,f=r,b=!1;const I="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,O="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((V,X)=>{const ae=r.get(V),me=Xy(this.query,X)?X:null,Ie=!!ae&&this.mutatedKeys.has(ae.key),Ge=!!me&&(me.hasLocalMutations||this.mutatedKeys.has(me.key)&&me.hasCommittedMutations);let Je=!1;ae&&me?ae.data.isEqual(me.data)?Ie!==Ge&&(i.track({type:3,doc:me}),Je=!0):this.Wu(ae,me)||(i.track({type:2,doc:me}),Je=!0,(I&&this.Ku(me,I)>0||O&&this.Ku(me,O)<0)&&(b=!0)):!ae&&me?(i.track({type:0,doc:me}),Je=!0):ae&&!me&&(i.track({type:1,doc:ae}),Je=!0,(I||O)&&(b=!0)),Je&&(me?(f=f.add(me),s=Ge?s.add(V):s.delete(V)):(f=f.delete(V),s=s.delete(V)))}),null!==this.query.limit)for(;f.size>this.query.limit;){const V="F"===this.query.limitType?f.last():f.first();f=f.delete(V.key),s=s.delete(V.key),i.track({type:1,doc:V})}return{Gu:f,ju:i,Mi:b,mutatedKeys:s}}Wu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i){const r=this.Gu;this.Gu=e.Gu,this.mutatedKeys=e.mutatedKeys;const s=e.ju.Tu();s.sort((O,V)=>function(X,ae){const me=Ie=>{switch(Ie){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Hn()}};return me(X)-me(ae)}(O.type,V.type)||this.Ku(O.doc,V.doc)),this.Hu(i);const f=t?this.Ju():[],b=0===this.Uu.size&&this.current?1:0,I=b!==this.qu;return this.qu=b,0!==s.length||I?{snapshot:new Ww(this.query,e.Gu,r,s,e.mutatedKeys,0===b,I,!1,!!i&&i.resumeToken.approximateByteSize()>0),Yu:f}:{Yu:f}}Ru(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Gu:this.Gu,ju:new sz,mutatedKeys:this.mutatedKeys,Mi:!1},!1)):{Yu:[]}}Zu(e){return!this.Lu.has(e)&&!!this.Gu.has(e)&&!this.Gu.get(e).hasLocalMutations}Hu(e){e&&(e.addedDocuments.forEach(t=>this.Lu=this.Lu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Lu=this.Lu.delete(t)),this.current=e.current)}Ju(){if(!this.current)return[];const e=this.Uu;this.Uu=ir(),this.Gu.forEach(i=>{this.Zu(i.key)&&(this.Uu=this.Uu.add(i.key))});const t=[];return e.forEach(i=>{this.Uu.has(i)||t.push(new uz(i))}),this.Uu.forEach(i=>{e.has(i)||t.push(new cz(i))}),t}Xu(e){this.Lu=e.Wi,this.Uu=ir();const t=this.zu(e.documents);return this.applyChanges(t,!0)}tc(){return Ww.fromInitialDocuments(this.query,this.Gu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class f${constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class p${constructor(e){this.key=e,this.ec=!1}}class m${constructor(e,t,i,r,s,f){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=f,this.nc={},this.sc=new gp(b=>vS(b),hb),this.ic=new Map,this.rc=new Set,this.oc=new Ts(Pn.comparator),this.uc=new Map,this.cc=new lP,this.ac={},this.hc=new Map,this.lc=vb.bn(),this.onlineState="Unknown",this.fc=void 0}get isPrimaryClient(){return!0===this.fc}}function g$(n,e){return ZP.apply(this,arguments)}function ZP(){return ZP=(0,z.Z)(function*(n,e){const t=_O(n);let i,r;const s=t.sc.get(e);if(s)i=s.targetId,t.sharedClientState.addLocalQueryTarget(i),r=s.view.tc();else{const f=yield Vw(t.localStore,gl(e));t.isPrimaryClient&&US(t.remoteStore,f);const b=t.sharedClientState.addLocalQueryTarget(f.targetId);i=f.targetId,r=yield YP(t,e,i,"current"===b,f.resumeToken)}return r}),ZP.apply(this,arguments)}function YP(n,e,t,i,r){return KP.apply(this,arguments)}function KP(){return KP=(0,z.Z)(function*(n,e,t,i,r){n.dc=(X,ae,me)=>{return(Ie=(0,z.Z)(function*(Ge,Je,Qt,xn){let Nn=Je.view.zu(Qt);Nn.Mi&&(Nn=yield LS(Ge.localStore,Je.query,!1).then(({documents:Xi})=>Je.view.zu(Xi,Nn)));const ai=xn&&xn.targetChanges.get(Je.targetId),Hi=Je.view.applyChanges(Nn,Ge.isPrimaryClient,ai);return sO(Ge,Je.targetId,Hi.Yu),Hi.snapshot}),function(Ge,Je,Qt,xn){return Ie.apply(this,arguments)})(n,X,ae,me);var Ie};const s=yield LS(n.localStore,e,!0),f=new dz(e,s.Wi),b=f.zu(s.documents),I=pE.createSynthesizedTargetChangeForCurrentChange(t,i&&"Offline"!==n.onlineState,r),O=f.applyChanges(b,n.isPrimaryClient,I);sO(n,t,O.Yu);const V=new f$(e,t,f);return n.sc.set(e,V),n.ic.has(t)?n.ic.get(t).push(e):n.ic.set(t,[e]),O.snapshot}),KP.apply(this,arguments)}function _$(n,e){return XP.apply(this,arguments)}function XP(){return XP=(0,z.Z)(function*(n,e){const t=kn(n),i=t.sc.get(e),r=t.ic.get(i.targetId);if(r.length>1)return t.ic.set(i.targetId,r.filter(s=>!hb(s,e))),void t.sc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(i.targetId),t.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Uw(t.localStore,i.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(i.targetId),ME(t.remoteStore,i.targetId),Zw(t,i.targetId)}).catch(Xg))):(Zw(t,i.targetId),yield Uw(t.localStore,i.targetId,!0))}),XP.apply(this,arguments)}function QP(){return QP=(0,z.Z)(function*(n,e,t){const i=yO(n);try{const r=yield function(s,f){const b=kn(s),I=Go.now(),O=f.reduce((ae,me)=>ae.add(me.key),ir());let V,X;return b.persistence.runTransaction("Locally write mutations","readwrite",ae=>{let me=vu(),Ie=ir();return b.Ki.getEntries(ae,O).next(Ge=>{me=Ge,me.forEach((Je,Qt)=>{Qt.isValidDocument()||(Ie=Ie.add(Je))})}).next(()=>b.localDocuments.getOverlayedDocuments(ae,me)).next(Ge=>{V=Ge;const Je=[];for(const Qt of f){const xn=_n(Qt,V.get(Qt.key).overlayedDocument);null!=xn&&Je.push(new ci(Qt.key,xn,QC(xn.value.mapValue),re.exists(!0)))}return b.mutationQueue.addMutationBatch(ae,I,Je,f)}).next(Ge=>{X=Ge;const Je=Ge.applyToLocalDocumentSet(V,Ie);return b.documentOverlayCache.saveOverlays(ae,Ge.batchId,Je)})}).then(()=>({batchId:X.batchId,changes:xS(V)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(s,f,b){let I=s.ac[s.currentUser.toKey()];I||(I=new Ts(Oi)),I=I.insert(f,b),s.ac[s.currentUser.toKey()]=I}(i,r.batchId,t),yield s_(i,r.changes),yield $w(i.remoteStore)}catch(r){const s=Hw(r,"Failed to persist write");t.reject(s)}}),QP.apply(this,arguments)}function hz(n,e){return JP.apply(this,arguments)}function JP(){return JP=(0,z.Z)(function*(n,e){const t=kn(n);try{const i=yield function z6(n,e){const t=kn(n),i=e.snapshotVersion;let r=t.Li;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const f=t.Ki.newChangeBuffer({trackRemovals:!0});r=t.Li;const b=[];e.targetChanges.forEach((V,X)=>{const ae=r.get(X);if(!ae)return;b.push(t.Ds.removeMatchingKeys(s,V.removedDocuments,X).next(()=>t.Ds.addMatchingKeys(s,V.addedDocuments,X)));let me=ae.withSequenceNumber(s.currentSequenceNumber);var Ie,Ge,Je;e.targetMismatches.has(X)?me=me.withResumeToken(na.EMPTY_BYTE_STRING,fi.min()).withLastLimboFreeSnapshotVersion(fi.min()):V.resumeToken.approximateByteSize()>0&&(me=me.withResumeToken(V.resumeToken,i)),r=r.insert(X,me),Ge=me,Je=V,(0===(Ie=ae).resumeToken.approximateByteSize()||Ge.snapshotVersion.toMicroseconds()-Ie.snapshotVersion.toMicroseconds()>=3e8||Je.addedDocuments.size+Je.modifiedDocuments.size+Je.removedDocuments.size>0)&&b.push(t.Ds.updateTargetData(s,me))});let I=vu(),O=ir();if(e.documentUpdates.forEach(V=>{e.resolvedLimboDocuments.has(V)&&b.push(t.persistence.referenceDelegate.updateLimboDocument(s,V))}),b.push(GN(s,f,e.documentUpdates).next(V=>{I=V.zi,O=V.ji})),!i.isEqual(fi.min())){const V=t.Ds.getLastRemoteSnapshotVersion(s).next(X=>t.Ds.setTargetsMetadata(s,s.currentSequenceNumber,i));b.push(V)}return wt.waitFor(b).next(()=>f.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,I,O)).next(()=>I)}).then(s=>(t.Li=r,s))}(t.localStore,e);e.targetChanges.forEach((r,s)=>{const f=t.uc.get(s);f&&(si(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?f.ec=!0:r.modifiedDocuments.size>0?si(f.ec):r.removedDocuments.size>0&&(si(f.ec),f.ec=!1))}),yield s_(t,i,e)}catch(i){yield Xg(i)}}),JP.apply(this,arguments)}function fz(n,e,t){const i=kn(n);if(i.isPrimaryClient&&0===t||!i.isPrimaryClient&&1===t){const r=[];i.sc.forEach((s,f)=>{const b=f.view.Ru(e);b.snapshot&&r.push(b.snapshot)}),function(s,f){const b=kn(s);b.onlineState=f;let I=!1;b.queries.forEach((O,V)=>{for(const X of V.listeners)X.Ru(f)&&(I=!0)}),I&&qP(b)}(i.eventManager,e),r.length&&i.nc.zo(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function v$(n,e,t){return eO.apply(this,arguments)}function eO(){return eO=(0,z.Z)(function*(n,e,t){const i=kn(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.uc.get(e),s=r&&r.key;if(s){let f=new Ts(Pn.comparator);f=f.insert(s,rs.newNoDocument(s,fi.min()));const b=ir().add(s),I=new fE(fi.min(),new Map,new io(Oi),f,b);yield hz(i,I),i.oc=i.oc.remove(s),i.uc.delete(e),aO(i)}else yield Uw(i.localStore,e,!1).then(()=>Zw(i,e,t)).catch(Xg)}),eO.apply(this,arguments)}function b$(n,e){return tO.apply(this,arguments)}function tO(){return tO=(0,z.Z)(function*(n,e){const t=kn(n),i=e.batch.batchId;try{const r=yield function N6(n,e){const t=kn(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=t.Ki.newChangeBuffer({trackRemovals:!0});return function(f,b,I,O){const V=I.batch,X=V.keys();let ae=wt.resolve();return X.forEach(me=>{ae=ae.next(()=>O.getEntry(b,me)).next(Ie=>{const Ge=I.docVersions.get(me);si(null!==Ge),Ie.version.compareTo(Ge)<0&&(V.applyToRemoteDocument(Ie,I),Ie.isValidDocument()&&(Ie.setReadTime(I.commitVersion),O.addEntry(Ie)))})}),ae.next(()=>f.mutationQueue.removeMutationBatch(b,V))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(f){let b=ir();for(let I=0;I<f.mutationResults.length;++I)f.mutationResults[I].transformResults.length>0&&(b=b.add(f.batch.mutations[I].key));return b}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}(t.localStore,e);oO(t,i,null),rO(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield s_(t,r)}catch(r){yield Xg(r)}}),tO.apply(this,arguments)}function x$(n,e,t){return nO.apply(this,arguments)}function nO(){return nO=(0,z.Z)(function*(n,e,t){const i=kn(n);try{const r=yield function(s,f){const b=kn(s);return b.persistence.runTransaction("Reject batch","readwrite-primary",I=>{let O;return b.mutationQueue.lookupMutationBatch(I,f).next(V=>(si(null!==V),O=V.keys(),b.mutationQueue.removeMutationBatch(I,V))).next(()=>b.mutationQueue.performConsistencyCheck(I)).next(()=>b.documentOverlayCache.removeOverlaysForBatchId(I,O,f)).next(()=>b.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(I,O)).next(()=>b.localDocuments.getDocuments(I,O))})}(i.localStore,e);oO(i,e,t),rO(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield s_(i,r)}catch(r){yield Xg(r)}}),nO.apply(this,arguments)}function iO(){return iO=(0,z.Z)(function*(n,e){const t=kn(n);o_(t.remoteStore)||sn("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=yield function(s){const f=kn(s);return f.persistence.runTransaction("Get highest unacknowledged batch id","readonly",b=>f.mutationQueue.getHighestUnacknowledgedBatchId(b))}(t.localStore);if(-1===i)return void e.resolve();const r=t.hc.get(i)||[];r.push(e),t.hc.set(i,r)}catch(i){const r=Hw(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}),iO.apply(this,arguments)}function rO(n,e){(n.hc.get(e)||[]).forEach(t=>{t.resolve()}),n.hc.delete(e)}function oO(n,e,t){const i=kn(n);let r=i.ac[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.ac[i.currentUser.toKey()]=r}}function Zw(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.ic.get(e))n.sc.delete(i),t&&n.nc.wc(i,t);n.ic.delete(e),n.isPrimaryClient&&n.cc.hs(e).forEach(i=>{n.cc.containsKey(i)||pz(n,i)})}function pz(n,e){n.rc.delete(e.path.canonicalString());const t=n.oc.get(e);null!==t&&(ME(n.remoteStore,t),n.oc=n.oc.remove(e),n.uc.delete(t),aO(n))}function sO(n,e,t){for(const i of t)i instanceof cz?(n.cc.addReference(i.key,e),C$(n,i)):i instanceof uz?(sn("SyncEngine","Document no longer in limbo: "+i.key),n.cc.removeReference(i.key,e),n.cc.containsKey(i.key)||pz(n,i.key)):Hn()}function C$(n,e){const t=e.key,i=t.path.canonicalString();n.oc.get(t)||n.rc.has(i)||(sn("SyncEngine","New document in limbo: "+t),n.rc.add(i),aO(n))}function aO(n){for(;n.rc.size>0&&n.oc.size<n.maxConcurrentLimboResolutions;){const e=n.rc.values().next().value;n.rc.delete(e);const t=new Pn(Pr.fromString(e)),i=n.lc.next();n.uc.set(i,new p$(t)),n.oc=n.oc.insert(t,i),US(n.remoteStore,new ev(gl(Am(t.path)),i,2,Mc.ct))}}function s_(n,e,t){return lO.apply(this,arguments)}function lO(){return lO=(0,z.Z)(function*(n,e,t){const i=kn(n),r=[],s=[],f=[];var b;i.sc.isEmpty()||(i.sc.forEach((b,I)=>{f.push(i.dc(I,e,t).then(O=>{if((O||t)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(I.targetId,O?.fromCache?"not-current":"current"),O){r.push(O);const V=hP.Di(I.targetId,O);s.push(V)}}))}),yield Promise.all(f),i.nc.zo(r),yield(b=(0,z.Z)(function*(I,O){const V=kn(I);try{yield V.persistence.runTransaction("notifyLocalViewChanges","readwrite",X=>wt.forEach(O,ae=>wt.forEach(ae.Vi,me=>V.persistence.referenceDelegate.addReference(X,ae.targetId,me)).next(()=>wt.forEach(ae.Si,me=>V.persistence.referenceDelegate.removeReference(X,ae.targetId,me)))))}catch(X){if(!dp(X))throw X;sn("LocalStore","Failed to update sequence numbers: "+X)}for(const X of O){const ae=X.targetId;if(!X.fromCache){const me=V.Li.get(ae),Ge=me.withLastLimboFreeSnapshotVersion(me.snapshotVersion);V.Li=V.Li.insert(ae,Ge)}}}),function(I,O){return b.apply(this,arguments)})(i.localStore,s))}),lO.apply(this,arguments)}function E$(n,e){return cO.apply(this,arguments)}function cO(){return cO=(0,z.Z)(function*(n,e){const t=kn(n);if(!t.currentUser.isEqual(e)){sn("SyncEngine","User change. New user:",e.toKey());const i=yield jN(t.localStore,e);t.currentUser=e,(r=t).hc.forEach(f=>{f.forEach(b=>{b.reject(new Zt(Et.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.hc.clear(),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield s_(t,i.Qi)}var r}),cO.apply(this,arguments)}function T$(n,e){const t=kn(n),i=t.uc.get(e);if(i&&i.ec)return ir().add(i.key);{let r=ir();const s=t.ic.get(e);if(!s)return r;for(const f of s){const b=t.sc.get(f);r=r.unionWith(b.view.Qu)}return r}}function I$(n,e){return uO.apply(this,arguments)}function uO(){return uO=(0,z.Z)(function*(n,e){const t=kn(n),i=yield LS(t.localStore,e.query,!0),r=e.view.Xu(i);return t.isPrimaryClient&&sO(t,e.targetId,r.Yu),r}),uO.apply(this,arguments)}function S$(n,e){return dO.apply(this,arguments)}function dO(){return dO=(0,z.Z)(function*(n,e){const t=kn(n);return qN(t.localStore,e).then(i=>s_(t,i))}),dO.apply(this,arguments)}function M$(n,e,t,i){return hO.apply(this,arguments)}function hO(){return hO=(0,z.Z)(function*(n,e,t,i){const r=kn(n),s=yield function(f,b){const I=kn(f),O=kn(I.mutationQueue);return I.persistence.runTransaction("Lookup mutation documents","readonly",V=>O.In(V,b).next(X=>X?I.localDocuments.getDocuments(V,X):wt.resolve(null)))}(r.localStore,e);var b;null!==s?("pending"===t?yield $w(r.remoteStore):"acknowledged"===t||"rejected"===t?(oO(r,e,i||null),rO(r,e),b=e,kn(kn(r.localStore).mutationQueue).En(b)):Hn(),yield s_(r,s)):sn("SyncEngine","Cannot apply mutation batch with id: "+e)}),hO.apply(this,arguments)}function fO(){return fO=(0,z.Z)(function*(n,e){const t=kn(n);if(_O(t),yO(t),!0===e&&!0!==t.fc){const i=t.sharedClientState.getAllActiveQueryTargets(),r=yield mz(t,i.toArray());t.fc=!0,yield BP(t.remoteStore,!0);for(const s of r)US(t.remoteStore,s)}else if(!1===e&&!1!==t.fc){const i=[];let r=Promise.resolve();t.ic.forEach((s,f)=>{t.sharedClientState.isLocalQueryTarget(f)?i.push(f):r=r.then(()=>(Zw(t,f),Uw(t.localStore,f,!0))),ME(t.remoteStore,f)}),yield r,yield mz(t,i),function(s){const f=kn(s);f.uc.forEach((b,I)=>{ME(f.remoteStore,I)}),f.cc.ls(),f.uc=new Map,f.oc=new Ts(Pn.comparator)}(t),t.fc=!1,yield BP(t.remoteStore,!1)}}),fO.apply(this,arguments)}function mz(n,e,t){return pO.apply(this,arguments)}function pO(){return pO=(0,z.Z)(function*(n,e,t){const i=kn(n),r=[],s=[];for(const f of e){let b;const I=i.ic.get(f);if(I&&0!==I.length){b=yield Vw(i.localStore,gl(I[0]));for(const O of I){const V=i.sc.get(O),X=yield I$(i,V);X.snapshot&&s.push(X.snapshot)}}else{const O=yield HN(i.localStore,f);b=yield Vw(i.localStore,O),yield YP(i,gz(O),f,!1,b.resumeToken)}r.push(b)}return i.nc.zo(s),r}),pO.apply(this,arguments)}function gz(n){return Ow(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function A$(n){const e=kn(n);return kn(kn(e.localStore).persistence).bi()}function P$(n,e,t,i){return mO.apply(this,arguments)}function mO(){return mO=(0,z.Z)(function*(n,e,t,i){const r=kn(n);if(r.fc)return void sn("SyncEngine","Ignoring unexpected query state notification.");const s=r.ic.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const f=yield qN(r.localStore,lE(s[0])),b=fE.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,na.EMPTY_BYTE_STRING);yield s_(r,f,b);break}case"rejected":yield Uw(r.localStore,e,!0),Zw(r,e,i);break;default:Hn()}}),mO.apply(this,arguments)}function O$(n,e,t){return gO.apply(this,arguments)}function gO(){return gO=(0,z.Z)(function*(n,e,t){const i=_O(n);if(i.fc){for(const r of e){if(i.ic.has(r)){sn("SyncEngine","Adding an already active target "+r);continue}const s=yield HN(i.localStore,r),f=yield Vw(i.localStore,s);yield YP(i,gz(s),f.targetId,!1,f.resumeToken),US(i.remoteStore,f)}for(const r of t)i.ic.has(r)&&(yield Uw(i.localStore,r,!1).then(()=>{ME(i.remoteStore,r),Zw(i,r)}).catch(Xg))}}),gO.apply(this,arguments)}function _O(n){const e=kn(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=hz.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=T$.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=v$.bind(null,e),e.nc.zo=c$.bind(null,e.eventManager),e.nc.wc=u$.bind(null,e.eventManager),e}function yO(n){const e=kn(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=b$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=x$.bind(null,e),e}class $S{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,z.Z)(function*(){t.serializer=IE(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return UN(this.persistence,new VN,e.initialUser,this.serializer)}createPersistence(e){return new zN(RS.Fs,this.serializer)}createSharedClientState(e){return new KN}terminate(){var e=this;return(0,z.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class vO extends $S{constructor(e,t,i){super(),this.mc=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,i=this;return(0,z.Z)(function*(){yield t().call(i,e),yield i.mc.initialize(i,e),yield yO(i.mc.syncEngine),yield $w(i.mc.remoteStore),yield i.persistence.hi(()=>(i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(),i.indexBackfillerScheduler&&!i.indexBackfillerScheduler.started&&i.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return UN(this.persistence,new VN,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new w6(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const i=new JI(t,this.persistence);return new xA(e.asyncQueue,i)}createPersistence(e){const t=dP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=void 0!==this.cacheSizeBytes?hd.withCacheSize(this.cacheSizeBytes):hd.DEFAULT;return new uP(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,QN(),VS(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new KN}}class _z extends vO{constructor(e,t){super(e,t,!1),this.mc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,i=this;return(0,z.Z)(function*(){yield t().call(i,e);const r=i.mc.syncEngine;i.sharedClientState instanceof bP&&(i.sharedClientState.syncEngine={$r:M$.bind(null,r),Mr:P$.bind(null,r),Fr:O$.bind(null,r),bi:A$.bind(null,r),Or:S$.bind(null,r)},yield i.sharedClientState.start()),yield i.persistence.hi(function(){var s=(0,z.Z)(function*(f){yield function D$(n,e){return fO.apply(this,arguments)}(i.mc.syncEngine,f),i.gcScheduler&&(f&&!i.gcScheduler.started?i.gcScheduler.start():f||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(f&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():f||i.indexBackfillerScheduler.stop())});return function(f){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=QN();if(!bP.D(t))throw new Zt(Et.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=dP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new bP(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Yw{initialize(e,t){var i=this;return(0,z.Z)(function*(){i.localStore||(i.localStore=e.localStore,i.sharedClientState=e.sharedClientState,i.datastore=i.createDatastore(t),i.remoteStore=i.createRemoteStore(t),i.eventManager=i.createEventManager(t),i.syncEngine=i.createSyncEngine(t,!e.synchronizeTabs),i.sharedClientState.onlineStateHandler=r=>fz(i.syncEngine,r,1),i.remoteStore.remoteSyncer.handleCredentialChange=E$.bind(null,i.syncEngine),yield BP(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(e){return new l$}createDatastore(e){const t=IE(e.databaseInfo.databaseId),i=new H6(e.databaseInfo);return new Z6(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return t=this.localStore,i=this.datastore,r=e.asyncQueue,s=b=>fz(this.syncEngine,b,0),f=XN.D()?new XN:new j6,new X6(t,i,r,s,f);var t,i,r,s,f}createSyncEngine(e,t){return function(i,r,s,f,b,I,O){const V=new m$(i,r,s,f,b,I);return O&&(V.fc=!0),V}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,z.Z)(function*(t){const i=kn(t);sn("RemoteStore","RemoteStore shutting down."),i.du.add(5),yield jw(i),i._u.shutdown(),i.mu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function yz(n,e=10240){let t=0;return{read:()=>(0,z.Z)(function*(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})(),cancel:()=>(0,z.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class GS{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.gc(this.observer.next,e)}error(e){this.observer.error?this.gc(this.observer.error,e):Ns("Uncaught Error in snapshot listener:",e.toString())}yc(){this.muted=!0}gc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class R${constructor(e,t){this.Ic=e,this.serializer=t,this.metadata=new Ws,this.buffer=new Uint8Array,this.Tc=new TextDecoder("utf-8"),this.Ec().then(i=>{i&&i.ku()?this.metadata.resolve(i.Nu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(i?.Nu)}`))},i=>this.metadata.reject(i))}close(){return this.Ic.cancel()}getMetadata(){var e=this;return(0,z.Z)(function*(){return e.metadata.promise})()}_c(){var e=this;return(0,z.Z)(function*(){return yield e.getMetadata(),e.Ec()})()}Ec(){var e=this;return(0,z.Z)(function*(){const t=yield e.Ac();if(null===t)return null;const i=e.Tc.decode(t),r=Number(i);isNaN(r)&&e.Rc(`length string (${i}) is not valid number`);const s=yield e.vc(r);return new d$(JSON.parse(s),t.length+r)})()}bc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Ac(){var e=this;return(0,z.Z)(function*(){for(;e.bc()<0&&!(yield e.Pc()););if(0===e.buffer.length)return null;const t=e.bc();t<0&&e.Rc("Reached the end of bundle when a length string is expected.");const i=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),i})()}vc(e){var t=this;return(0,z.Z)(function*(){for(;t.buffer.length<e;)(yield t.Pc())&&t.Rc("Reached the end of bundle when more is expected.");const i=t.Tc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),i})()}Rc(e){throw this.Ic.cancel(),new Error(`Invalid bundle format: ${e}`)}Pc(){var e=this;return(0,z.Z)(function*(){const t=yield e.Ic.read();if(!t.done){const i=new Uint8Array(e.buffer.length+t.value.length);i.set(e.buffer),i.set(t.value,e.buffer.length),e.buffer=i}return t.done})()}}class F${constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,z.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Zt(Et.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const i=yield(r=(0,z.Z)(function*(s,f){const b=kn(s),I=gE(b.serializer)+"/documents",O={documents:f.map(me=>mE(b.serializer,me))},V=yield b.fo("BatchGetDocuments",I,O,f.length),X=new Map;V.forEach(me=>{const Ie=function n6(n,e){return"found"in e?function(t,i){si(!!i.found);const r=Pm(t,i.found.name),s=ra(i.found.updateTime),f=i.found.createTime?ra(i.found.createTime):fi.min(),b=new Ta({mapValue:{fields:i.found.fields}});return rs.newFoundDocument(r,s,f,b)}(n,e):"missing"in e?function(t,i){si(!!i.missing),si(!!i.readTime);const r=Pm(t,i.missing),s=ra(i.readTime);return rs.newNoDocument(r,s)}(n,e):Hn()}(b.serializer,me);X.set(Ie.key.toString(),Ie)});const ae=[];return f.forEach(me=>{const Ie=X.get(me.toString());si(!!Ie),ae.push(Ie)}),ae}),function(s,f){return r.apply(this,arguments)})(t.datastore,e);var r;return i.forEach(r=>t.recordVersion(r)),i})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastWriteError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new No(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,z.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var i;e.mutations.forEach(i=>{t.delete(i.key.toString())}),t.forEach((i,r)=>{const s=Pn.fromPath(r);e.mutations.push(new CS(s,e.precondition(s)))}),yield(i=(0,z.Z)(function*(r,s){const f=kn(r),b=gE(f.serializer)+"/documents",I={writes:s.map(O=>_E(f.serializer,O))};yield f.co("Commit",b,I)}),function(r,s){return i.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Hn();t=fi.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new Zt(Et.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(fi.min())?re.exists(!1):re.updateTime(t):re.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(fi.min()))throw new Zt(Et.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return re.updateTime(t)}return re.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class L${constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.Vc=i.maxAttempts,this.Co=new wP(this.asyncQueue,"transaction_retry")}run(){this.Vc-=1,this.Sc()}Sc(){var e=this;this.Co.Ao((0,z.Z)(function*(){const t=new F$(e.datastore),i=e.Dc(t);i&&i.then(r=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(r)}).catch(s=>{e.Cc(s)}))}).catch(r=>{e.Cc(r)})}))}Dc(e){try{const t=this.updateFunction(e);return!Hy(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Cc(e){this.Vc>0&&this.xc(e)?(this.Vc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Sc(),Promise.resolve()))):this.deferred.reject(e)}xc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!ZL(t)}return!1}}class N${constructor(e,t,i,r){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=ta.UNAUTHENTICATED,this.clientId=xw.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,function(){var f=(0,z.Z)(function*(b){sn("FirestoreClient","Received user=",b.uid),yield s.authCredentialListener(b),s.user=b});return function(b){return f.apply(this,arguments)}}()),this.appCheckCredentials.start(i,f=>(sn("FirestoreClient","Received new app check token=",f),this.appCheckCredentialListener(f,this.user)))}getConfiguration(){var e=this;return(0,z.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Zt(Et.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Ws;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,z.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(i){const r=Hw(i,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}function HS(n,e){return bO.apply(this,arguments)}function bO(){return bO=(0,z.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),sn("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(function(){var r=(0,z.Z)(function*(s){i.isEqual(s)||(yield jN(e.localStore,s),i=s)});return function(s){return r.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),bO.apply(this,arguments)}function xO(n,e){return wO.apply(this,arguments)}function wO(){return wO=(0,z.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield CO(n);sn("FirestoreClient","Initializing OnlineComponentProvider");const i=yield n.getConfiguration();yield e.initialize(t,i),n.setCredentialChangeListener(r=>oz(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>oz(e.remoteStore,s)),n._onlineComponents=e}),wO.apply(this,arguments)}function vz(n){return"FirebaseError"===n.name?n.code===Et.FAILED_PRECONDITION||n.code===Et.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function CO(n){return EO.apply(this,arguments)}function EO(){return EO=(0,z.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){sn("FirestoreClient","Using user provided OfflineComponentProvider");try{yield HS(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!vz(t))throw t;Qd("Error using user provided cache. Falling back to memory cache: "+t),yield HS(n,new $S)}}else sn("FirestoreClient","Using default OfflineComponentProvider"),yield HS(n,new $S);return n._offlineComponents}),EO.apply(this,arguments)}function qS(n){return TO.apply(this,arguments)}function TO(){return TO=(0,z.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(sn("FirestoreClient","Using user provided OnlineComponentProvider"),yield xO(n,n._uninitializedComponentsProvider._online)):(sn("FirestoreClient","Using default OnlineComponentProvider"),yield xO(n,new Yw))),n._onlineComponents}),TO.apply(this,arguments)}function bz(n){return CO(n).then(e=>e.persistence)}function WS(n){return CO(n).then(e=>e.localStore)}function IO(n){return qS(n).then(e=>e.remoteStore)}function SO(n){return qS(n).then(e=>e.syncEngine)}function Kw(n){return MO.apply(this,arguments)}function MO(){return MO=(0,z.Z)(function*(n){const e=yield qS(n),t=e.eventManager;return t.onListen=g$.bind(null,e.syncEngine),t.onUnlisten=_$.bind(null,e.syncEngine),t}),MO.apply(this,arguments)}function wz(n,e,t={}){const i=new Ws;return n.asyncQueue.enqueueAndForget((0,z.Z)(function*(){return function(r,s,f,b,I){const O=new GS({next:X=>{s.enqueueAndForget(()=>GP(r,V));const ae=X.docs.has(f);!ae&&X.fromCache?I.reject(new Zt(Et.UNAVAILABLE,"Failed to get document because the client is offline.")):ae&&X.fromCache&&b&&"server"===b.source?I.reject(new Zt(Et.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):I.resolve(X)},error:X=>I.reject(X)}),V=new WP(Am(f.path),O,{includeMetadataChanges:!0,xu:!0});return jP(r,V)}(yield Kw(n),n.asyncQueue,e,t,i)})),i.promise}function Cz(n,e,t={}){const i=new Ws;return n.asyncQueue.enqueueAndForget((0,z.Z)(function*(){return function(r,s,f,b,I){const O=new GS({next:X=>{s.enqueueAndForget(()=>GP(r,V)),X.fromCache&&"server"===b.source?I.reject(new Zt(Et.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):I.resolve(X)},error:X=>I.reject(X)}),V=new WP(f,O,{includeMetadataChanges:!0,xu:!0});return jP(r,V)}(yield Kw(n),n.asyncQueue,e,t,i)})),i.promise}const Ez=new Map;function DO(n,e,t){if(!t)throw new Zt(Et.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Tz(n,e,t,i){if(!0===e&&!0===i)throw new Zt(Et.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Iz(n){if(!Pn.isDocumentKey(n))throw new Zt(Et.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Sz(n){if(Pn.isDocumentKey(n))throw new Zt(Et.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ZS(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":Hn()}function Or(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Zt(Et.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ZS(n);throw new Zt(Et.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Mz(n,e){if(e<=0)throw new Zt(Et.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class Dz{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Zt(Et.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Zt(Et.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,Tz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class DE{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dz({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Zt(Et.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Zt(Et.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dz(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new GI;switch(t.type){case"firstParty":return new _A(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Zt(Et.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Ez.get(e);t&&(sn("ComponentProvider","Removing Datastore"),Ez.delete(e),t.terminate())}(this),Promise.resolve()}}function Az(n,e,t,i={}){var r;const s=(n=Or(n,DE))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==e&&Qd("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${t}`,ssl:!1})),i.mockUserToken){let f,b;if("string"==typeof i.mockUserToken)f=i.mockUserToken,b=ta.MOCK_USER;else{f=(0,K.Sg)(i.mockUserToken,null===(r=n._app)||void 0===r?void 0:r.options.projectId);const I=i.mockUserToken.sub||i.mockUserToken.user_id;if(!I)throw new Zt(Et.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new ta(I)}n._authCredentials=new HI(new $I(f,b))}}class ms{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Om(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ms(this.firestore,e,this._key)}}class Xl{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Xl(this.firestore,e,this._query)}}class Om extends Xl{constructor(e,t,i){super(e,t,Am(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ms(this.firestore,null,new Pn(e))}withConverter(e){return new Om(this.firestore,e,this._path)}}function AO(n,e,...t){if(n=(0,K.m9)(n),DO("collection","path",e),n instanceof DE){const i=Pr.fromString(e,...t);return Sz(i),new Om(n,null,i)}{if(!(n instanceof ms||n instanceof Om))throw new Zt(Et.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Pr.fromString(e,...t));return Sz(i),new Om(n.firestore,null,i)}}function YS(n,e,...t){if(n=(0,K.m9)(n),1===arguments.length&&(e=xw.A()),DO("doc","path",e),n instanceof DE){const i=Pr.fromString(e,...t);return Iz(i),new ms(n,null,new Pn(i))}{if(!(n instanceof ms||n instanceof Om))throw new Zt(Et.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Pr.fromString(e,...t));return Iz(i),new ms(n.firestore,n instanceof Om?n.converter:null,new Pn(i))}}function Pz(n,e){return n=(0,K.m9)(n),e=(0,K.m9)(e),(n instanceof ms||n instanceof Om)&&(e instanceof ms||e instanceof Om)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function PO(n,e){return n=(0,K.m9)(n),e=(0,K.m9)(e),n instanceof Xl&&e instanceof Xl&&n.firestore===e.firestore&&hb(n._query,e._query)&&n.converter===e.converter}class W${constructor(){this.Nc=Promise.resolve(),this.kc=[],this.Oc=!1,this.$c=[],this.Mc=null,this.Fc=!1,this.Bc=!1,this.Lc=[],this.Co=new wP(this,"async_queue_retry"),this.qc=()=>{const t=VS();t&&sn("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Co.vo()};const e=VS();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.qc)}get isShuttingDown(){return this.Oc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Uc(),this.Kc(e)}enterRestrictedMode(e){if(!this.Oc){this.Oc=!0,this.Bc=e||!1;const t=VS();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.qc)}}enqueue(e){if(this.Uc(),this.Oc)return new Promise(()=>{});const t=new Ws;return this.Kc(()=>this.Oc&&this.Bc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.kc.push(e),this.Gc()))}Gc(){var e=this;return(0,z.Z)(function*(){if(0!==e.kc.length){try{yield e.kc[0](),e.kc.shift(),e.Co.reset()}catch(t){if(!dp(t))throw t;sn("AsyncQueue","Operation failed with retryable error: "+t)}e.kc.length>0&&e.Co.Ao(()=>e.Gc())}})()}Kc(e){const t=this.Nc.then(()=>(this.Fc=!0,e().catch(i=>{throw this.Mc=i,this.Fc=!1,Ns("INTERNAL UNHANDLED ERROR: ",function(s){let f=s.message||"";return s.stack&&(f=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),f}(i)),i}).then(i=>(this.Fc=!1,i))));return this.Nc=t,t}enqueueAfterDelay(e,t,i){this.Uc(),this.Lc.indexOf(e)>-1&&(t=0);const r=UP.createAndSchedule(this,e,t,i,s=>this.Qc(s));return this.$c.push(r),r}Uc(){this.Mc&&Hn()}verifyOperationInProgress(){}zc(){var e=this;return(0,z.Z)(function*(){let t;do{t=e.Nc,yield t}while(t!==e.Nc)})()}jc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Wc(e){return this.zc().then(()=>{this.$c.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()})}Hc(e){this.Lc.push(e)}Qc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}function OO(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const i=e;for(const r of["next","error","complete"])if(r in i&&"function"==typeof i[r])return!0;return!1}(n)}class Z${constructor(){this._progressObserver={},this._taskCompletionResolver=new Ws,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class gs extends DE{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new W$,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Oz(this),this._firestoreClient.terminate()}}function K$(n,e){const t="object"==typeof n?n:(0,Z.getApp)(),i="string"==typeof n?n:e||"(default)",r=(0,Z._getProvider)(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=(0,K.P0)("firestore");s&&Az(r,...s)}return r}function oa(n){return n._firestoreClient||Oz(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Oz(n){var e,t,i;const r=n._freezeSettings(),s=(b=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new uS(n._databaseId,b,n._persistenceKey,(O=r).host,O.ssl,O.experimentalForceLongPolling,O.experimentalAutoDetectLongPolling,O.useFetchStreams));var b,O;n._firestoreClient=new N$(n._authCredentials,n._appCheckCredentials,n._queue,s),null!==(t=r.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(i=r.cache)&&void 0!==i&&i._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.cache.kind,_offline:r.cache._offlineComponentProvider,_online:r.cache._onlineComponentProvider})}function kz(n,e,t){const i=new Ws;return n.asyncQueue.enqueue((0,z.Z)(function*(){try{yield HS(n,t),yield xO(n,e),i.resolve()}catch(r){const s=r;if(!vz(s))throw s;Qd("Error enabling indexeddb cache. Falling back to memory cache: "+s),i.reject(s)}})).then(()=>i.promise)}function Rz(n){if(n._initialized||n._terminated)throw new Zt(Et.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class km{constructor(e){this._byteString=e}static fromBase64String(e){try{return new km(na.fromBase64String(e))}catch(t){throw new Zt(Et.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new km(na.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class a_{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Zt(Et.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ns(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class xb{constructor(e){this._methodName=e}}class KS{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Zt(Et.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Zt(Et.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Oi(this._lat,e._lat)||Oi(this._long,e._long)}}const sG=/^__.*__$/;class aG{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return null!==this.fieldMask?new ci(e,this.data,this.fieldMask,t,this.fieldTransforms):new Un(e,this.data,t,this.fieldTransforms)}}class Fz{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new ci(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Lz(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Hn()}}class XS{constructor(e,t,i,r,s,f){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,void 0===s&&this.Jc(),this.fieldTransforms=s||[],this.fieldMask=f||[]}get path(){return this.settings.path}get Yc(){return this.settings.Yc}Zc(e){return new XS(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Xc(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Zc({path:i,ta:!1});return r.ea(e),r}na(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Zc({path:i,ta:!1});return r.Jc(),r}sa(e){return this.Zc({path:void 0,ta:!0})}ia(e){return eM(e,this.settings.methodName,this.settings.ra||!1,this.path,this.settings.oa)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Jc(){if(this.path)for(let e=0;e<this.path.length;e++)this.ea(this.path.get(e))}ea(e){if(0===e.length)throw this.ia("Document fields must not be empty");if(Lz(this.Yc)&&sG.test(e))throw this.ia('Document fields cannot begin and end with "__"')}}class lG{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||IE(e)}ua(e,t,i,r=!1){return new XS({Yc:e,methodName:t,oa:i,path:ns.emptyPath(),ta:!1,ra:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function wb(n){const e=n._freezeSettings(),t=IE(n._databaseId);return new lG(n._databaseId,!!e.ignoreUndefinedProperties,t)}function QS(n,e,t,i,r,s={}){const f=n.ua(s.merge||s.mergeFields?2:0,e,t,r);LO("Data must be an object, but it was:",f,i);const b=Bz(i,f);let I,O;if(s.merge)I=new is(f.fieldMask),O=f.fieldTransforms;else if(s.mergeFields){const V=[];for(const X of s.mergeFields){const ae=OE(e,X,t);if(!f.contains(ae))throw new Zt(Et.INVALID_ARGUMENT,`Field '${ae}' is specified in your field mask but missing from your input data.`);Uz(V,ae)||V.push(ae)}I=new is(V),O=f.fieldTransforms.filter(X=>I.covers(X.field))}else I=null,O=f.fieldTransforms;return new aG(new Ta(b),I,O)}class PE extends xb{_toFieldTransform(e){if(2!==e.Yc)throw e.ia(1===e.Yc?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof PE}}function Nz(n,e,t){return new XS({Yc:3,oa:e.settings.oa,methodName:n._methodName,ta:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class kO extends xb{_toFieldTransform(e){return new N(e.path,new fb)}isEqual(e){return e instanceof kO}}class cG extends xb{constructor(e,t){super(e),this.ca=t}_toFieldTransform(e){const t=Nz(this,e,!0),i=this.ca.map(s=>Cb(s,t)),r=new Qy(i);return new N(e.path,r)}isEqual(e){return this===e}}class uG extends xb{constructor(e,t){super(e),this.ca=t}_toFieldTransform(e){const t=Nz(this,e,!0),i=this.ca.map(s=>Cb(s,t)),r=new h(i);return new N(e.path,r)}isEqual(e){return this===e}}class dG extends xb{constructor(e,t){super(e),this.aa=t}_toFieldTransform(e){const t=new x(e.serializer,wS(e.serializer,this.aa));return new N(e.path,t)}isEqual(e){return this===e}}function RO(n,e,t,i){const r=n.ua(1,e,t);LO("Data must be an object, but it was:",r,i);const s=[],f=Ta.empty();Jg(i,(I,O)=>{const V=JS(e,I,t);O=(0,K.m9)(O);const X=r.na(V);if(O instanceof PE)s.push(V);else{const ae=Cb(O,X);null!=ae&&(s.push(V),f.set(V,ae))}});const b=new is(s);return new Fz(f,b,r.fieldTransforms)}function FO(n,e,t,i,r,s){const f=n.ua(1,e,t),b=[OE(e,i,t)],I=[r];if(s.length%2!=0)throw new Zt(Et.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let ae=0;ae<s.length;ae+=2)b.push(OE(e,s[ae])),I.push(s[ae+1]);const O=[],V=Ta.empty();for(let ae=b.length-1;ae>=0;--ae)if(!Uz(O,b[ae])){const me=b[ae];let Ie=I[ae];Ie=(0,K.m9)(Ie);const Ge=f.na(me);if(Ie instanceof PE)O.push(me);else{const Je=Cb(Ie,Ge);null!=Je&&(O.push(me),V.set(me,Je))}}const X=new is(O);return new Fz(V,X,f.fieldTransforms)}function zz(n,e,t,i=!1){return Cb(t,n.ua(i?4:3,e))}function Cb(n,e){if(Vz(n=(0,K.m9)(n)))return LO("Unsupported field value:",e,n),Bz(n,e);if(n instanceof xb)return function(t,i){if(!Lz(i.Yc))throw i.ia(`${t._methodName}() can only be used with update() and set()`);if(!i.path)throw i.ia(`${t._methodName}() is not currently supported inside arrays`);const r=t._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.ta&&4!==e.Yc)throw e.ia("Nested arrays are not supported");return function(t,i){const r=[];let s=0;for(const f of t){let b=Cb(f,i.sa(s));null==b&&(b={nullValue:"NULL_VALUE"}),r.push(b),s++}return{arrayValue:{values:r}}}(n,e)}return function(t,i){if(null===(t=(0,K.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return wS(i.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const r=Go.fromDate(t);return{timestampValue:Lw(i.serializer,r)}}if(t instanceof Go){const r=new Go(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Lw(i.serializer,r)}}if(t instanceof KS)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof km)return{bytesValue:tN(i.serializer,t._byteString)};if(t instanceof ms){const r=i.databaseId,s=t.firestore._databaseId;if(!s.isEqual(r))throw i.ia(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:XA(t.firestore._databaseId||i.databaseId,t._key.path)}}throw i.ia(`Unsupported field value: ${ZS(t)}`)}(n,e)}function Bz(n,e){const t={};return lS(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Jg(n,(i,r)=>{const s=Cb(r,e.Xc(i));null!=s&&(t[i]=s)}),{mapValue:{fields:t}}}function Vz(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Go||n instanceof KS||n instanceof km||n instanceof ms||n instanceof xb)}function LO(n,e,t){if(!Vz(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const i=ZS(t);throw e.ia("an object"===i?n+" a custom object":n+" "+i)}var i}function OE(n,e,t){if((e=(0,K.m9)(e))instanceof a_)return e._internalPath;if("string"==typeof e)return JS(n,e);throw eM("Field path arguments must be of type string or ",n,!1,void 0,t)}const hG=new RegExp("[~\\*/\\[\\]]");function JS(n,e,t){if(e.search(hG)>=0)throw eM(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new a_(...e.split("."))._internalPath}catch{throw eM(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function eM(n,e,t,i,r){const s=i&&!i.isEmpty(),f=void 0!==r;let b=`Function ${e}() called with invalid data`;t&&(b+=" (via `toFirestore()`)"),b+=". ";let I="";return(s||f)&&(I+=" (found",s&&(I+=` in field ${i}`),f&&(I+=` in document ${r}`),I+=")"),new Zt(Et.INVALID_ARGUMENT,b+n+I)}function Uz(n,e){return n.some(t=>t.isEqual(e))}class kE{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ms(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new fG(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(tM("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class fG extends kE{data(){return super.data()}}function tM(n,e){return"string"==typeof e?JS(n,e):e instanceof a_?e._internalPath:e._delegate._internalPath}function jz(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Zt(Et.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class NO{}class RE extends NO{}function ov(n,e,...t){let i=[];e instanceof NO&&i.push(e),i=i.concat(t),function(r){const s=r.filter(b=>b instanceof Xw).length,f=r.filter(b=>b instanceof FE).length;if(s>1||s>0&&f>0)throw new Zt(Et.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class FE extends RE{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new FE(e,t,i)}_apply(e){const t=this._parse(e);return qz(e._query,t),new Xl(e.firestore,e.converter,aE(e._query,t))}_parse(e){const t=wb(e.firestore);return function(r,s,f,b,I,O,V){let X;if(I.isKeyField()){if("array-contains"===O||"array-contains-any"===O)throw new Zt(Et.INVALID_ARGUMENT,`Invalid Query. You can't perform '${O}' queries on documentId().`);if("in"===O||"not-in"===O){Hz(V,O);const ae=[];for(const me of V)ae.push(Gz(b,r,me));X={arrayValue:{values:ae}}}else X=Gz(b,r,V)}else"in"!==O&&"not-in"!==O&&"array-contains-any"!==O||Hz(V,O),X=zz(f,"where",V,"in"===O||"not-in"===O);return gr.create(I,O,X)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class Xw extends NO{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Xw(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return 1===t.length?t[0]:Vr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,r){let s=i;const f=r.getFlattenedFilters();for(const b of f)qz(s,b),s=aE(s,b)}(e._query,t),new Xl(e.firestore,e.converter,aE(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class zO extends RE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new zO(e,t)}_apply(e){const t=function(i,r,s){if(null!==i.startAt)throw new Zt(Et.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new Zt(Et.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const f=new t_(r,s);return function(b,I){if(null===_S(b)){const O=sE(b);null!==O&&Wz(0,O,I.field)}}(i,f),f}(e._query,this._field,this._direction);return new Xl(e.firestore,e.converter,function(i,r){const s=i.explicitOrderBy.concat([r]);return new mp(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class nM extends RE{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new nM(e,t,i)}_apply(e){return new Xl(e.firestore,e.converter,kw(e._query,this._limit,this._limitType))}}class iM extends RE{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new iM(e,t,i)}_apply(e){const t=$z(e,this.type,this._docOrFields,this._inclusive);return new Xl(e.firestore,e.converter,(r=t,new mp((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,r,i.endAt)));var i,r}}class rM extends RE{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new rM(e,t,i)}_apply(e){const t=$z(e,this.type,this._docOrFields,this._inclusive);return new Xl(e.firestore,e.converter,(r=t,new mp((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,r)));var i,r}}function $z(n,e,t,i){if(t[0]=(0,K.m9)(t[0]),t[0]instanceof kE)return function(r,s,f,b,I){if(!b)throw new Zt(Et.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${f}().`);const O=[];for(const V of Ky(r))if(V.field.isKeyField())O.push(Dm(s,b.key));else{const X=b.data.field(V.field);if(KC(X))throw new Zt(Et.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+V.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===X){const ae=V.field.canonicalString();throw new Zt(Et.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${ae}' (used as the orderBy) does not exist.`)}O.push(X)}return new Jh(O,I)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{const r=wb(n.firestore);return function(s,f,b,I,O,V){const X=s.explicitOrderBy;if(O.length>X.length)throw new Zt(Et.INVALID_ARGUMENT,`Too many arguments provided to ${I}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const ae=[];for(let me=0;me<O.length;me++){const Ie=O[me];if(X[me].field.isKeyField()){if("string"!=typeof Ie)throw new Zt(Et.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${I}(), but got a ${typeof Ie}`);if(!yS(s)&&-1!==Ie.indexOf("/"))throw new Zt(Et.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${I}() must be a plain document ID, but '${Ie}' contains a slash.`);const Ge=s.path.child(Pr.fromString(Ie));if(!Pn.isDocumentKey(Ge))throw new Zt(Et.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${I}() must result in a valid document path, but '${Ge}' is not because it contains an odd number of segments.`);const Je=new Pn(Ge);ae.push(Dm(f,Je))}else{const Ge=zz(b,I,Ie);ae.push(Ge)}}return new Jh(ae,V)}(n._query,n.firestore._databaseId,r,e,t,i)}}function Gz(n,e,t){if("string"==typeof(t=(0,K.m9)(t))){if(""===t)throw new Zt(Et.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yS(e)&&-1!==t.indexOf("/"))throw new Zt(Et.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Pr.fromString(t));if(!Pn.isDocumentKey(i))throw new Zt(Et.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Dm(n,new Pn(i))}if(t instanceof ms)return Dm(n,t._key);throw new Zt(Et.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ZS(t)}.`)}function Hz(n,e){if(!Array.isArray(n)||0===n.length)throw new Zt(Et.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qz(n,e){if(e.isInequality()){const i=sE(n),r=e.field;if(null!==i&&!i.isEqual(r))throw new Zt(Et.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${i.toString()}' and '${r.toString()}'`);const s=_S(n);null!==s&&Wz(0,r,s)}const t=function(i,r){for(const s of i)for(const f of s.getFlattenedFilters())if(r.indexOf(f.op)>=0)return f.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Zt(Et.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Wz(n,e,t){if(!t.isEqual(e))throw new Zt(Et.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class BO{convertValue(e,t="none"){switch(Sm(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Is(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(fp(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Hn()}}convertObject(e,t){const i={};return Jg(e.fields,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertGeoPoint(e){return new KS(Is(e.latitude),Is(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=cS(e);return null==i?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(e_(e));default:return null}}convertTimestamp(e){const t=ia(e);return new Go(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Pr.fromString(e);si(dN(i));const r=new pp(i.get(1),i.get(3)),s=new Pn(i.popFirst(5));return r.isEqual(t)||Ns(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function oM(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class wG extends BO{constructor(e){super(),this.firestore=e}convertBytes(e){return new km(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ms(this.firestore,null,t)}}class Eb{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class l_ extends kE{constructor(e,t,i,r,s,f){super(e,t,i,r,f),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new LE(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(tM("DocumentSnapshot.get",e));if(null!==i)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class LE extends l_{data(e={}){return super.data(e)}}class sv{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Eb(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new LE(this._firestore,this._userDataWriter,i.key,i,new Eb(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Zt(Et.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(f=>({type:"added",doc:new LE(i._firestore,i._userDataWriter,f.doc.key,f.doc,new Eb(i._snapshot.mutatedKeys.has(f.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:s++}))}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(f=>r||3!==f.type).map(f=>{const b=new LE(i._firestore,i._userDataWriter,f.doc.key,f.doc,new Eb(i._snapshot.mutatedKeys.has(f.doc.key),i._snapshot.fromCache),i.query.converter);let I=-1,O=-1;return 0!==f.type&&(I=s.indexOf(f.doc.key),s=s.delete(f.doc.key)),1!==f.type&&(s=s.add(f.doc),O=s.indexOf(f.doc.key)),{type:EG(f.type),doc:b,oldIndex:I,newIndex:O}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function EG(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Hn()}}function Yz(n,e){return n instanceof l_&&e instanceof l_?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof sv&&e instanceof sv&&n._firestore===e._firestore&&PO(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class av extends BO{constructor(e){super(),this.firestore=e}convertBytes(e){return new km(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ms(this.firestore,null,t)}}function Kz(n,e,t){n=Or(n,ms);const i=Or(n.firestore,gs),r=oM(n.converter,e,t);return Qw(i,[QS(wb(i),"setDoc",n._key,r,null!==n.converter,t).toMutation(n._key,re.none())])}function Xz(n,e,t,...i){n=Or(n,ms);const r=Or(n.firestore,gs),s=wb(r);let f;return f="string"==typeof(e=(0,K.m9)(e))||e instanceof a_?FO(s,"updateDoc",n._key,e,t,i):RO(s,"updateDoc",n._key,e),Qw(r,[f.toMutation(n._key,re.exists(!0))])}function Qz(n,e){const t=Or(n.firestore,gs),i=YS(n),r=oM(n.converter,e);return Qw(t,[QS(wb(n.firestore),"addDoc",i._key,r,null!==n.converter,{}).toMutation(i._key,re.exists(!1))]).then(()=>i)}function Jz(n,...e){var t,i,r;n=(0,K.m9)(n);let s={includeMetadataChanges:!1},f=0;"object"!=typeof e[f]||OO(e[f])||(s=e[f],f++);const b={includeMetadataChanges:s.includeMetadataChanges};if(OO(e[f])){const X=e[f];e[f]=null===(t=X.next)||void 0===t?void 0:t.bind(X),e[f+1]=null===(i=X.error)||void 0===i?void 0:i.bind(X),e[f+2]=null===(r=X.complete)||void 0===r?void 0:r.bind(X)}let I,O,V;if(n instanceof ms)O=Or(n.firestore,gs),V=Am(n._key.path),I={next:X=>{e[f]&&e[f](VO(O,n,X))},error:e[f+1],complete:e[f+2]};else{const X=Or(n,Xl);O=Or(X.firestore,gs),V=X._query;const ae=new av(O);I={next:me=>{e[f]&&e[f](new sv(O,ae,X,me))},error:e[f+1],complete:e[f+2]},jz(n._query)}return function(X,ae,me,Ie){const Ge=new GS(Ie),Je=new WP(ae,Ge,me);return X.asyncQueue.enqueueAndForget((0,z.Z)(function*(){return jP(yield Kw(X),Je)})),()=>{Ge.yc(),X.asyncQueue.enqueueAndForget((0,z.Z)(function*(){return GP(yield Kw(X),Je)}))}}(oa(O),V,b,I)}function Qw(n,e){return function(t,i){const r=new Ws;return t.asyncQueue.enqueueAndForget((0,z.Z)(function*(){return function y$(n,e,t){return QP.apply(this,arguments)}(yield SO(t),i,r)})),r.promise}(oa(n),e)}function VO(n,e,t){const i=t.docs.get(e._key),r=new av(n);return new l_(n,r,e._key,i,new Eb(t.hasPendingWrites,t.fromCache),e.converter)}const BG={maxAttempts:5};class eB{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=wb(e)}set(e,t,i){this._verifyNotCommitted();const r=lv(e,this._firestore),s=oM(r.converter,t,i),f=QS(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,i);return this._mutations.push(f.toMutation(r._key,re.none())),this}update(e,t,i,...r){this._verifyNotCommitted();const s=lv(e,this._firestore);let f;return f="string"==typeof(t=(0,K.m9)(t))||t instanceof a_?FO(this._dataReader,"WriteBatch.update",s._key,t,i,r):RO(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(f.toMutation(s._key,re.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=lv(e,this._firestore);return this._mutations=this._mutations.concat(new No(t._key,re.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Zt(Et.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function lv(n,e){if((n=(0,K.m9)(n)).firestore!==e)throw new Zt(Et.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class VG extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=wb(e)}get(e){const t=lv(e,this._firestore),i=new wG(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||1!==r.length)return Hn();const s=r[0];if(s.isFoundDocument())return new kE(this._firestore,i,s.key,s,t.converter);if(s.isNoDocument())return new kE(this._firestore,i,t._key,null,t.converter);throw Hn()})}set(e,t,i){const r=lv(e,this._firestore),s=oM(r.converter,t,i),f=QS(this._dataReader,"Transaction.set",r._key,s,null!==r.converter,i);return this._transaction.set(r._key,f),this}update(e,t,i,...r){const s=lv(e,this._firestore);let f;return f="string"==typeof(t=(0,K.m9)(t))||t instanceof a_?FO(this._dataReader,"Transaction.update",s._key,t,i,r):RO(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,f),this}delete(e){const t=lv(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=lv(e,this._firestore),i=new av(this._firestore);return super.get(e).then(r=>new l_(this._firestore,i,t._key,r._document,new Eb(!1,!1),t.converter))}}!function(n,e=!0){Tm=Z.SDK_VERSION,(0,Z._registerComponent)(new te.wA("firestore",(t,{instanceIdentifier:i,options:r})=>{const s=t.getProvider("app").getImmediate(),f=new gs(new Yl(t.getProvider("auth-internal")),new PL(t.getProvider("app-check-internal")),function(b,I){if(!Object.prototype.hasOwnProperty.apply(b.options,["projectId"]))throw new Zt(Et.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pp(b.options.projectId,I)}(s,i),s);return r=Object.assign({useFetchStreams:e},r),f._setSettings(r),f},"PUBLIC").setMultipleInstances(!0)),(0,Z.registerVersion)(bw,"3.10.0",n),(0,Z.registerVersion)(bw,"3.10.0","esm2017")}(),(0,Z.registerVersion)("firebase","9.19.1","app");var Jw=Ae(8766);const nB="@firebase/installations",UO="0.6.4",iB=1e4,rB=`w:${UO}`,oB="FIS_v2",XG="https://firebaseinstallations.googleapis.com/v1",QG=36e5,c_=new K.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function sB(n){return n instanceof K.ZR&&n.code.includes("request-failed")}function jO({projectId:n}){return`${XG}/projects/${n}/installations`}function aB(n){return{token:n.token,requestStatus:2,expiresIn:nH(n.expiresIn),creationTime:Date.now()}}function $O(n,e){return GO.apply(this,arguments)}function GO(){return GO=(0,z.Z)(function*(n,e){const i=(yield e.json()).error;return c_.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}),GO.apply(this,arguments)}function lB({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function HO(n){return qO.apply(this,arguments)}function qO(){return qO=(0,z.Z)(function*(n){const e=yield n();return e.status>=500&&e.status<600?n():e}),qO.apply(this,arguments)}function nH(n){return Number(n.replace("s","000"))}function WO(){return WO=(0,z.Z)(function*({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=jO(n),r=lB(n),s=e.getImmediate({optional:!0});if(s){const O=yield s.getHeartbeatsHeader();O&&r.append("x-firebase-client",O)}const b={method:"POST",headers:r,body:JSON.stringify({fid:t,authVersion:oB,appId:n.appId,sdkVersion:rB})},I=yield HO(()=>fetch(i,b));if(I.ok){const O=yield I.json();return{fid:O.fid||t,registrationStatus:2,refreshToken:O.refreshToken,authToken:aB(O.authToken)}}throw yield $O("Create Installation",I)}),WO.apply(this,arguments)}function uB(n){return new Promise(e=>{setTimeout(e,n)})}const sH=/^[cdef][\w-]{21}$/,ZO="";function aH(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=function lH(n){return function oH(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return sH.test(t)?t:ZO}catch{return ZO}}function e1(n){return`${n.appName}!${n.appId}`}const t1=new Map;function dB(n,e){const t=e1(n);hB(t,e),function dH(n,e){const t=function fB(){return!Tb&&"BroadcastChannel"in self&&(Tb=new BroadcastChannel("[Firebase] FID Change"),Tb.onmessage=n=>{hB(n.data.key,n.data.fid)}),Tb}();t&&t.postMessage({key:n,fid:e}),function pB(){0===t1.size&&Tb&&(Tb.close(),Tb=null)}()}(t,e)}function hB(n,e){const t=t1.get(n);if(t)for(const i of t)i(e)}let Tb=null;const hH="firebase-installations-database",fH=1,Ib="firebase-installations-store";let YO=null;function KO(){return YO||(YO=(0,Jw.X3)(hH,fH,{upgrade:(n,e)=>{0===e&&n.createObjectStore(Ib)}})),YO}function sM(n,e){return XO.apply(this,arguments)}function XO(){return XO=(0,z.Z)(function*(n,e){const t=e1(n),r=(yield KO()).transaction(Ib,"readwrite"),s=r.objectStore(Ib),f=yield s.get(t);return yield s.put(e,t),yield r.done,(!f||f.fid!==e.fid)&&dB(n,e.fid),e}),XO.apply(this,arguments)}function QO(n){return JO.apply(this,arguments)}function JO(){return JO=(0,z.Z)(function*(n){const e=e1(n),i=(yield KO()).transaction(Ib,"readwrite");yield i.objectStore(Ib).delete(e),yield i.done}),JO.apply(this,arguments)}function NE(n,e){return ek.apply(this,arguments)}function ek(){return ek=(0,z.Z)(function*(n,e){const t=e1(n),r=(yield KO()).transaction(Ib,"readwrite"),s=r.objectStore(Ib),f=yield s.get(t),b=e(f);return void 0===b?yield s.delete(t):yield s.put(b,t),yield r.done,b&&(!f||f.fid!==b.fid)&&dB(n,b.fid),b}),ek.apply(this,arguments)}function tk(n){return nk.apply(this,arguments)}function nk(){return nk=(0,z.Z)(function*(n){let e;const t=yield NE(n.appConfig,i=>{const r=function pH(n){return gB(n||{fid:aH(),registrationStatus:0})}(i),s=function mH(n,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(c_.create("app-offline"))};const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=function gH(n,e){return ik.apply(this,arguments)}(n,t);return{installationEntry:t,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:_H(n)}:{installationEntry:e}}(n,r);return e=s.registrationPromise,s.installationEntry});return t.fid===ZO?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}}),nk.apply(this,arguments)}function ik(){return ik=(0,z.Z)(function*(n,e){try{const t=yield function rH(n,e){return WO.apply(this,arguments)}(n,e);return sM(n.appConfig,t)}catch(t){throw sB(t)&&409===t.customData.serverCode?yield QO(n.appConfig):yield sM(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}),ik.apply(this,arguments)}function _H(n){return rk.apply(this,arguments)}function rk(){return rk=(0,z.Z)(function*(n){let e=yield mB(n.appConfig);for(;1===e.registrationStatus;)yield uB(100),e=yield mB(n.appConfig);if(0===e.registrationStatus){const{installationEntry:t,registrationPromise:i}=yield tk(n);return i||t}return e}),rk.apply(this,arguments)}function mB(n){return NE(n,e=>{if(!e)throw c_.create("installation-not-found");return gB(e)})}function gB(n){return function yH(n){return 1===n.registrationStatus&&n.registrationTime+iB<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function ok(){return ok=(0,z.Z)(function*({appConfig:n,heartbeatServiceProvider:e},t){const i=function bH(n,{fid:e}){return`${jO(n)}/${e}/authTokens:generate`}(n,t),r=function cB(n,{refreshToken:e}){const t=lB(n);return t.append("Authorization",function iH(n){return`${oB} ${n}`}(e)),t}(n,t),s=e.getImmediate({optional:!0});if(s){const O=yield s.getHeartbeatsHeader();O&&r.append("x-firebase-client",O)}const b={method:"POST",headers:r,body:JSON.stringify({installation:{sdkVersion:rB,appId:n.appId}})},I=yield HO(()=>fetch(i,b));if(I.ok)return aB(yield I.json());throw yield $O("Generate Auth Token",I)}),ok.apply(this,arguments)}function sk(n){return ak.apply(this,arguments)}function ak(){return ak=(0,z.Z)(function*(n,e=!1){let t;const i=yield NE(n.appConfig,s=>{if(!yB(s))throw c_.create("not-registered");const f=s.authToken;if(!e&&function CH(n){return 2===n.requestStatus&&!function EH(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+QG}(n)}(f))return s;if(1===f.requestStatus)return t=function xH(n,e){return lk.apply(this,arguments)}(n,e),s;{if(!navigator.onLine)throw c_.create("app-offline");const b=function TH(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}(s);return t=function wH(n,e){return ck.apply(this,arguments)}(n,b),b}});return t?yield t:i.authToken}),ak.apply(this,arguments)}function lk(){return lk=(0,z.Z)(function*(n,e){let t=yield _B(n.appConfig);for(;1===t.authToken.requestStatus;)yield uB(100),t=yield _B(n.appConfig);const i=t.authToken;return 0===i.requestStatus?sk(n,e):i}),lk.apply(this,arguments)}function _B(n){return NE(n,e=>{if(!yB(e))throw c_.create("not-registered");return function IH(n){return 1===n.requestStatus&&n.requestTime+iB<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function ck(){return ck=(0,z.Z)(function*(n,e){try{const t=yield function vH(n,e){return ok.apply(this,arguments)}(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return yield sM(n.appConfig,i),t}catch(t){if(!sB(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode){const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield sM(n.appConfig,i)}else yield QO(n.appConfig);throw t}}),ck.apply(this,arguments)}function yB(n){return void 0!==n&&2===n.registrationStatus}function uk(){return uk=(0,z.Z)(function*(n){const e=n,{installationEntry:t,registrationPromise:i}=yield tk(e);return i?i.catch(console.error):sk(e).catch(console.error),t.fid}),uk.apply(this,arguments)}function dk(){return dk=(0,z.Z)(function*(n,e=!1){const t=n;return yield function DH(n){return hk.apply(this,arguments)}(t),(yield sk(t,e)).token}),dk.apply(this,arguments)}function hk(){return hk=(0,z.Z)(function*(n){const{registrationPromise:e}=yield tk(n);e&&(yield e)}),hk.apply(this,arguments)}function mk(n){return c_.create("missing-app-config-values",{valueName:n})}const vB="installations",RH=n=>{const e=n.getProvider("app").getImmediate(),t=function OH(n){if(!n||!n.options)throw mk("App Configuration");if(!n.name)throw mk("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw mk(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(e);return{app:e,appConfig:t,heartbeatServiceProvider:(0,Z._getProvider)(e,"heartbeat"),_delete:()=>Promise.resolve()}},FH=n=>{const e=n.getProvider("app").getImmediate(),t=(0,Z._getProvider)(e,vB).getImmediate();return{getId:()=>function SH(n){return uk.apply(this,arguments)}(t),getToken:r=>function MH(n){return dk.apply(this,arguments)}(t,r)}};(function LH(){(0,Z._registerComponent)(new te.wA(vB,RH,"PUBLIC")),(0,Z._registerComponent)(new te.wA("installations-internal",FH,"PRIVATE"))})(),(0,Z.registerVersion)(nB,UO),(0,Z.registerVersion)(nB,UO,"esm2017");const gk="@firebase/remote-config",fd=new K.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class WH{constructor(e,t,i,r){this.client=e,this.storage=t,this.storageCache=i,this.logger=r}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const i=Date.now()-t,r=i<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${i}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}fetch(e){var t=this;return(0,z.Z)(function*(){const[i,r]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(r&&t.isCachedDataFresh(e.cacheMaxAgeMillis,i))return r;e.eTag=r&&r.eTag;const s=yield t.client.fetch(e),f=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===s.status&&f.push(t.storage.setLastSuccessfulFetchResponse(s)),yield Promise.all(f),s})()}}function ZH(n=navigator){return n.languages&&n.languages[0]||n.language}class YH{constructor(e,t,i,r,s,f){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=i,this.projectId=r,this.apiKey=s,this.appId=f}fetch(e){var t=this;return(0,z.Z)(function*(){const[i,r]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),f=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,b={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},I={sdk_version:t.sdkVersion,app_instance_id:i,app_instance_id_token:r,app_id:t.appId,language_code:ZH()},O={method:"POST",headers:b,body:JSON.stringify(I)},V=fetch(f,O),X=new Promise((Qt,xn)=>{e.signal.addEventListener(()=>{const Nn=new Error("The operation was aborted.");Nn.name="AbortError",xn(Nn)})});let ae;try{yield Promise.race([V,X]),ae=yield V}catch(Qt){let xn="fetch-client-network";throw"AbortError"===Qt?.name&&(xn="fetch-timeout"),fd.create(xn,{originalErrorMessage:Qt?.message})}let me=ae.status;const Ie=ae.headers.get("ETag")||void 0;let Ge,Je;if(200===ae.status){let Qt;try{Qt=yield ae.json()}catch(xn){throw fd.create("fetch-client-parse",{originalErrorMessage:xn?.message})}Ge=Qt.entries,Je=Qt.state}if("INSTANCE_STATE_UNSPECIFIED"===Je?me=500:"NO_CHANGE"===Je?me=304:("NO_TEMPLATE"===Je||"EMPTY_CONFIG"===Je)&&(Ge={}),304!==me&&200!==me)throw fd.create("fetch-status",{httpStatus:me});return{status:me,eTag:Ie,config:Ge}})()}}class QH{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return(0,z.Z)(function*(){const i=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,i)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:i}){var r=this;return(0,z.Z)(function*(){yield function KH(n,e){return new Promise((t,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(s),i(fd.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(e.signal,t);try{const s=yield r.client.fetch(e);return yield r.storage.deleteThrottleMetadata(),s}catch(s){if(!function XH(n){if(!(n instanceof K.ZR&&n.customData))return!1;const e=Number(n.customData.httpStatus);return 429===e||500===e||503===e||504===e}(s))throw s;const f={throttleEndTimeMillis:Date.now()+(0,K.$s)(i),backoffCount:i+1};return yield r.storage.setThrottleMetadata(f),r.attemptFetch(e,f)}})()}}class tq{constructor(e,t,i,r,s){this.app=e,this._client=t,this._storageCache=i,this._storage=r,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function lM(n,e){const t=n.target.error||void 0;return fd.create(e,{originalErrorMessage:t&&t?.message})}const Sb="app_namespace_store";class oq{constructor(e,t,i,r=function rq(){return new Promise((n,e)=>{try{const t=indexedDB.open("firebase_remote_config",1);t.onerror=i=>{e(lM(i,"storage-open"))},t.onsuccess=i=>{n(i.target.result)},t.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(Sb,{keyPath:"compositeKey"})}}catch(t){e(fd.create("storage-open",{originalErrorMessage:t?.message}))}})}()){this.appId=e,this.appName=t,this.namespace=i,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return(0,z.Z)(function*(){const i=yield t.openDbPromise;return new Promise((r,s)=>{const b=i.transaction([Sb],"readonly").objectStore(Sb),I=t.createCompositeKey(e);try{const O=b.get(I);O.onerror=V=>{s(lM(V,"storage-get"))},O.onsuccess=V=>{const X=V.target.result;r(X?X.value:void 0)}}catch(O){s(fd.create("storage-get",{originalErrorMessage:O?.message}))}})})()}set(e,t){var i=this;return(0,z.Z)(function*(){const r=yield i.openDbPromise;return new Promise((s,f)=>{const I=r.transaction([Sb],"readwrite").objectStore(Sb),O=i.createCompositeKey(e);try{const V=I.put({compositeKey:O,value:t});V.onerror=X=>{f(lM(X,"storage-set"))},V.onsuccess=()=>{s()}}catch(V){f(fd.create("storage-set",{originalErrorMessage:V?.message}))}})})()}delete(e){var t=this;return(0,z.Z)(function*(){const i=yield t.openDbPromise;return new Promise((r,s)=>{const b=i.transaction([Sb],"readwrite").objectStore(Sb),I=t.createCompositeKey(e);try{const O=b.delete(I);O.onerror=V=>{s(lM(V,"storage-delete"))},O.onsuccess=()=>{r()}}catch(O){s(fd.create("storage-delete",{originalErrorMessage:O?.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class sq{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return(0,z.Z)(function*(){const t=e.storage.getLastFetchStatus(),i=e.storage.getLastSuccessfulFetchTimestampMillis(),r=e.storage.getActiveConfig(),s=yield t;s&&(e.lastFetchStatus=s);const f=yield i;f&&(e.lastSuccessfulFetchTimestampMillis=f);const b=yield r;b&&(e.activeConfig=b)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function lq(){return xk.apply(this,arguments)}function xk(){return(xk=(0,z.Z)(function*(){if(!(0,K.hl)())return!1;try{return yield(0,K.eu)()}catch{return!1}})).apply(this,arguments)}!function aq(){(0,Z._registerComponent)(new te.wA("remote-config",function n(e,{instanceIdentifier:t}){const i=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw fd.create("registration-window");if(!(0,K.hl)())throw fd.create("indexed-db-unavailable");const{projectId:s,apiKey:f,appId:b}=i.options;if(!s)throw fd.create("registration-project-id");if(!f)throw fd.create("registration-api-key");if(!b)throw fd.create("registration-app-id");const I=new oq(b,i.name,t=t||"firebase"),O=new sq(I),V=new ie.Yd(gk);V.logLevel=ie.in.ERROR;const X=new YH(r,Z.SDK_VERSION,t,s,f,b),ae=new QH(X,I),me=new WH(ae,I,O,V),Ie=new tq(i,me,O,I,V);return function GH(n){const e=(0,K.m9)(n);e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0}))}(Ie),Ie},"PUBLIC").setMultipleInstances(!0)),(0,Z.registerVersion)(gk,"0.4.4"),(0,Z.registerVersion)(gk,"0.4.4","esm2017")}();const cq="/firebase-messaging-sw.js",uq="/firebase-cloud-messaging-push-scope",CB="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",dq="https://fcmregistrations.googleapis.com/v1",EB="google.c.a.c_id",hq="google.c.a.c_l",fq="google.c.a.ts",pq="google.c.a.e";var n1=(()=>(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"}(n1||(n1={})),n1))();function u_(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function mq(n){const t=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),r=new Uint8Array(i.length);for(let s=0;s<i.length;++s)r[s]=i.charCodeAt(s);return r}const wk="fcm_token_details_db",gq=5,TB="fcm_token_object_Store";function Ck(){return Ck=(0,z.Z)(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(s=>s.name).includes(wk))return null;let e=null;return(yield(0,Jw.X3)(wk,gq,{upgrade:(i=(0,z.Z)(function*(r,s,f,b){var I;if(s<2||!r.objectStoreNames.contains(TB))return;const O=b.objectStore(TB),V=yield O.index("fcmSenderId").get(n);if(yield O.clear(),V)if(2===s){const X=V;if(!X.auth||!X.p256dh||!X.endpoint)return;e={token:X.fcmToken,createTime:null!==(I=X.createTime)&&void 0!==I?I:Date.now(),subscriptionOptions:{auth:X.auth,p256dh:X.p256dh,endpoint:X.endpoint,swScope:X.swScope,vapidKey:"string"==typeof X.vapidKey?X.vapidKey:u_(X.vapidKey)}}}else if(3===s){const X=V;e={token:X.fcmToken,createTime:X.createTime,subscriptionOptions:{auth:u_(X.auth),p256dh:u_(X.p256dh),endpoint:X.endpoint,swScope:X.swScope,vapidKey:u_(X.vapidKey)}}}else if(4===s){const X=V;e={token:X.fcmToken,createTime:X.createTime,subscriptionOptions:{auth:u_(X.auth),p256dh:u_(X.p256dh),endpoint:X.endpoint,swScope:X.swScope,vapidKey:u_(X.vapidKey)}}}}),function(s,f,b,I){return i.apply(this,arguments)})})).close(),yield(0,Jw.Lj)(wk),yield(0,Jw.Lj)("fcm_vapid_details_db"),yield(0,Jw.Lj)("undefined"),function yq(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}(e)?e:null;var i}),Ck.apply(this,arguments)}const vq="firebase-messaging-database",bq=1,Mb="firebase-messaging-store";let Ek=null;function Tk(){return Ek||(Ek=(0,Jw.X3)(vq,bq,{upgrade:(n,e)=>{0===e&&n.createObjectStore(Mb)}})),Ek}function IB(n){return Ik.apply(this,arguments)}function Ik(){return Ik=(0,z.Z)(function*(n){const e=Ak(n),i=yield(yield Tk()).transaction(Mb).objectStore(Mb).get(e);if(i)return i;{const r=yield function _q(n){return Ck.apply(this,arguments)}(n.appConfig.senderId);if(r)return yield Sk(n,r),r}}),Ik.apply(this,arguments)}function Sk(n,e){return Mk.apply(this,arguments)}function Mk(){return Mk=(0,z.Z)(function*(n,e){const t=Ak(n),r=(yield Tk()).transaction(Mb,"readwrite");return yield r.objectStore(Mb).put(e,t),yield r.done,e}),Mk.apply(this,arguments)}function Dk(){return Dk=(0,z.Z)(function*(n){const e=Ak(n),i=(yield Tk()).transaction(Mb,"readwrite");yield i.objectStore(Mb).delete(e),yield i.done}),Dk.apply(this,arguments)}function Ak({appConfig:n}){return n.appId}const Ql=new K.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function Cq(n,e){return Pk.apply(this,arguments)}function Pk(){return Pk=(0,z.Z)(function*(n,e){const t=yield Fk(n),i=MB(e),r={method:"POST",headers:t,body:JSON.stringify(i)};let s;try{s=yield(yield fetch(Rk(n.appConfig),r)).json()}catch(f){throw Ql.create("token-subscribe-failed",{errorInfo:f?.toString()})}if(s.error)throw Ql.create("token-subscribe-failed",{errorInfo:s.error.message});if(!s.token)throw Ql.create("token-subscribe-no-token");return s.token}),Pk.apply(this,arguments)}function Ok(){return Ok=(0,z.Z)(function*(n,e){const t=yield Fk(n),i=MB(e.subscriptionOptions),r={method:"PATCH",headers:t,body:JSON.stringify(i)};let s;try{s=yield(yield fetch(`${Rk(n.appConfig)}/${e.token}`,r)).json()}catch(f){throw Ql.create("token-update-failed",{errorInfo:f?.toString()})}if(s.error)throw Ql.create("token-update-failed",{errorInfo:s.error.message});if(!s.token)throw Ql.create("token-update-no-token");return s.token}),Ok.apply(this,arguments)}function SB(n,e){return kk.apply(this,arguments)}function kk(){return kk=(0,z.Z)(function*(n,e){const i={method:"DELETE",headers:yield Fk(n)};try{const s=yield(yield fetch(`${Rk(n.appConfig)}/${e}`,i)).json();if(s.error)throw Ql.create("token-unsubscribe-failed",{errorInfo:s.error.message})}catch(r){throw Ql.create("token-unsubscribe-failed",{errorInfo:r?.toString()})}}),kk.apply(this,arguments)}function Rk({projectId:n}){return`${dq}/projects/${n}/registrations`}function Fk(n){return Lk.apply(this,arguments)}function Lk(){return Lk=(0,z.Z)(function*({appConfig:n,installations:e}){const t=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}),Lk.apply(this,arguments)}function MB({p256dh:n,auth:e,endpoint:t,vapidKey:i}){const r={web:{endpoint:t,auth:e,p256dh:n}};return i!==CB&&(r.web.applicationPubKey=i),r}const Tq=6048e5;function Nk(){return Nk=(0,z.Z)(function*(n){const e=yield function Mq(n,e){return Uk.apply(this,arguments)}(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:u_(e.getKey("auth")),p256dh:u_(e.getKey("p256dh"))},i=yield IB(n.firebaseDependencies);if(i){if(function Dq(n,e){return e.vapidKey===n.vapidKey&&e.endpoint===n.endpoint&&e.auth===n.auth&&e.p256dh===n.p256dh}(i.subscriptionOptions,t))return Date.now()>=i.createTime+Tq?function Sq(n,e){return Bk.apply(this,arguments)}(n,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{yield SB(n.firebaseDependencies,i.token)}catch(r){console.warn(r)}return AB(n.firebaseDependencies,t)}return AB(n.firebaseDependencies,t)}),Nk.apply(this,arguments)}function zk(){return zk=(0,z.Z)(function*(n){const e=yield IB(n.firebaseDependencies);e&&(yield SB(n.firebaseDependencies,e.token),yield function xq(n){return Dk.apply(this,arguments)}(n.firebaseDependencies));const t=yield n.swRegistration.pushManager.getSubscription();return!t||t.unsubscribe()}),zk.apply(this,arguments)}function Bk(){return Bk=(0,z.Z)(function*(n,e){try{const t=yield function Eq(n,e){return Ok.apply(this,arguments)}(n.firebaseDependencies,e),i=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield Sk(n.firebaseDependencies,i),t}catch(t){throw yield function DB(n){return zk.apply(this,arguments)}(n),t}}),Bk.apply(this,arguments)}function AB(n,e){return Vk.apply(this,arguments)}function Vk(){return Vk=(0,z.Z)(function*(n,e){const i={token:yield Cq(n,e),createTime:Date.now(),subscriptionOptions:e};return yield Sk(n,i),i.token}),Vk.apply(this,arguments)}function Uk(){return Uk=(0,z.Z)(function*(n,e){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:mq(e)})}),Uk.apply(this,arguments)}function PB(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function Aq(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const i=e.notification.body;i&&(n.notification.body=i);const r=e.notification.image;r&&(n.notification.image=r);const s=e.notification.icon;s&&(n.notification.icon=s)}(e,n),function Pq(n,e){e.data&&(n.data=e.data)}(e,n),function Oq(n,e){var t,i,r,s,f;if(!(e.fcmOptions||null!==(t=e.notification)&&void 0!==t&&t.click_action))return;n.fcmOptions={};const b=null!==(r=null===(i=e.fcmOptions)||void 0===i?void 0:i.link)&&void 0!==r?r:null===(s=e.notification)||void 0===s?void 0:s.click_action;b&&(n.fcmOptions.link=b);const I=null===(f=e.fcmOptions)||void 0===f?void 0:f.analytics_label;I&&(n.fcmOptions.analyticsLabel=I)}(e,n),e}function OB(n,e){const t=[];for(let i=0;i<n.length;i++)t.push(n.charAt(i)),i<e.length&&t.push(e.charAt(i));return t.join("")}function jk(n){return Ql.create("missing-app-config-values",{valueName:n})}OB("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),OB("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Fq{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function Rq(n){if(!n||!n.options)throw jk("App Configuration Object");if(!n.name)throw jk("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const i of e)if(!t[i])throw jk(i);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}function $k(){return $k=(0,z.Z)(function*(n){try{n.swRegistration=yield navigator.serviceWorker.register(cq,{scope:uq}),n.swRegistration.update().catch(()=>{})}catch(e){throw Ql.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}),$k.apply(this,arguments)}function Gk(){return Gk=(0,z.Z)(function*(n,e){if(!e&&!n.swRegistration&&(yield function kB(n){return $k.apply(this,arguments)}(n)),e||!n.swRegistration){if(!(e instanceof ServiceWorkerRegistration))throw Ql.create("invalid-sw-registration");n.swRegistration=e}}),Gk.apply(this,arguments)}function Hk(){return Hk=(0,z.Z)(function*(n,e){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=CB)}),Hk.apply(this,arguments)}function qk(){return qk=(0,z.Z)(function*(n,e){if(!navigator)throw Ql.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Ql.create("permission-blocked");return yield function Nq(n,e){return Hk.apply(this,arguments)}(n,e?.vapidKey),yield function Lq(n,e){return Gk.apply(this,arguments)}(n,e?.serviceWorkerRegistration),function Iq(n){return Nk.apply(this,arguments)}(n)}),qk.apply(this,arguments)}function Wk(){return Wk=(0,z.Z)(function*(n,e,t){const i=function Bq(n){switch(n){case n1.NOTIFICATION_CLICKED:return"notification_open";case n1.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(e);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[EB],message_name:t[hq],message_time:t[fq],message_device_time:Math.floor(Date.now()/1e3)})}),Wk.apply(this,arguments)}function Zk(){return Zk=(0,z.Z)(function*(n,e){const t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===n1.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(PB(t)):n.onMessageHandler.next(PB(t)));const i=t.data;(function kq(n){return"object"==typeof n&&!!n&&EB in n})(i)&&"1"===i[pq]&&(yield function zq(n,e,t){return Wk.apply(this,arguments)}(n,t.messageType,i))}),Zk.apply(this,arguments)}const FB="@firebase/messaging",Uq=n=>{const e=new Fq(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>function Vq(n,e){return Zk.apply(this,arguments)}(e,t)),e},jq=n=>{const e=n.getProvider("messaging").getImmediate();return{getToken:i=>function RB(n,e){return qk.apply(this,arguments)}(e,i)}};function NB(){return Yk.apply(this,arguments)}function Yk(){return(Yk=(0,z.Z)(function*(){try{yield(0,K.eu)()}catch{return!1}return typeof window<"u"&&(0,K.hl)()&&(0,K.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function $q(){(0,Z._registerComponent)(new te.wA("messaging",Uq,"PUBLIC")),(0,Z._registerComponent)(new te.wA("messaging-internal",jq,"PRIVATE")),(0,Z.registerVersion)(FB,"0.12.4"),(0,Z.registerVersion)(FB,"0.12.4","esm2017")}();const cM="analytics",qq="firebase_id",Wq="origin",Zq=6e4,Yq="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Qk="https://www.googletagmanager.com/gtag/js",yl=new ie.Yd("@firebase/analytics"),pd=new K.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Xq(n){if(!n.startsWith(Qk)){const e=pd.create("invalid-gtag-resource",{gtagURL:n});return yl.warn(e.message),""}return n}function zB(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function Jk(){return Jk=(0,z.Z)(function*(n,e,t,i,r,s){const f=i[r];try{if(f)yield e[f];else{const I=(yield zB(t)).find(O=>O.measurementId===r);I&&(yield e[I.appId])}}catch(b){yl.error(b)}n("config",r,s)}),Jk.apply(this,arguments)}function eR(){return eR=(0,z.Z)(function*(n,e,t,i,r){try{let s=[];if(r&&r.send_to){let f=r.send_to;Array.isArray(f)||(f=[f]);const b=yield zB(t);for(const I of f){const O=b.find(X=>X.measurementId===I),V=O&&e[O.appId];if(!V){s=[];break}s.push(V)}}0===s.length&&(s=Object.values(e)),yield Promise.all(s),n("event",i,r||{})}catch(s){yl.error(s)}}),eR.apply(this,arguments)}const s8=30,BB=new class l8{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function c8(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function tR(){return tR=(0,z.Z)(function*(n){var e;const{appId:t,apiKey:i}=n,r={method:"GET",headers:c8(i)},s=Yq.replace("{app-id}",t),f=yield fetch(s,r);if(200!==f.status&&304!==f.status){let b="";try{const I=yield f.json();null!==(e=I.error)&&void 0!==e&&e.message&&(b=I.error.message)}catch{}throw pd.create("config-fetch-failed",{httpStatus:f.status,responseMessage:b})}return f.json()}),tR.apply(this,arguments)}function nR(){return nR=(0,z.Z)(function*(n,e=BB,t){const{appId:i,apiKey:r,measurementId:s}=n.options;if(!i)throw pd.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw pd.create("no-api-key")}const f=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},b=new p8;return setTimeout((0,z.Z)(function*(){b.abort()}),void 0!==t?t:Zq),VB({appId:i,apiKey:r,measurementId:s},f,b,e)}),nR.apply(this,arguments)}function VB(n,e,t){return iR.apply(this,arguments)}function iR(){return iR=(0,z.Z)(function*(n,{throttleEndTimeMillis:e,backoffCount:t},i,r=BB){var s;const{appId:f,measurementId:b}=n;try{yield function h8(n,e){return new Promise((t,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(s),i(pd.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(i,e)}catch(I){if(b)return yl.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${b} provided in the "measurementId" field in the local Firebase config. [${I?.message}]`),{appId:f,measurementId:b};throw I}try{const I=yield function u8(n){return tR.apply(this,arguments)}(n);return r.deleteThrottleMetadata(f),I}catch(I){const O=I;if(!function f8(n){if(!(n instanceof K.ZR&&n.customData))return!1;const e=Number(n.customData.httpStatus);return 429===e||500===e||503===e||504===e}(O)){if(r.deleteThrottleMetadata(f),b)return yl.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${b} provided in the "measurementId" field in the local Firebase config. [${O?.message}]`),{appId:f,measurementId:b};throw I}const V=503===Number(null===(s=O?.customData)||void 0===s?void 0:s.httpStatus)?(0,K.$s)(t,r.intervalMillis,s8):(0,K.$s)(t,r.intervalMillis),X={throttleEndTimeMillis:Date.now()+V,backoffCount:t+1};return r.setThrottleMetadata(f,X),yl.debug(`Calling attemptFetch again in ${V} millis`),VB(n,X,i,r)}}),iR.apply(this,arguments)}class p8{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let rR,uR;function oR(){return oR=(0,z.Z)(function*(n,e,t,i,r){if(r&&r.global)n("event",t,i);else{const s=yield e;n("event",t,Object.assign(Object.assign({},i),{send_to:s}))}}),oR.apply(this,arguments)}function aR(){return aR=(0,z.Z)(function*(n,e,t,i){if(i&&i.global)return n("set",{user_id:t}),Promise.resolve();n("config",yield e,{update:!0,user_id:t})}),aR.apply(this,arguments)}function dR(){return dR=(0,z.Z)(function*(){if(!(0,K.hl)())return yl.warn(pd.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,K.eu)()}catch(n){return yl.warn(pd.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}return!0}),dR.apply(this,arguments)}function hR(){return hR=(0,z.Z)(function*(n,e,t,i,r,s,f){var b;const I=function d8(n){return nR.apply(this,arguments)}(n);I.then(me=>{t[me.measurementId]=me.appId,n.options.measurementId&&me.measurementId!==n.options.measurementId&&yl.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${me.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(me=>yl.error(me)),e.push(I);const O=function b8(){return dR.apply(this,arguments)}().then(me=>{if(me)return i.getId()}),[V,X]=yield Promise.all([I,O]);(function o8(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Qk)&&t.src.includes(n))return t;return null})(s)||function Jq(n,e){const t=function Qq(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}("firebase-js-sdk-policy",{createScriptURL:Xq}),i=document.createElement("script"),r=`${Qk}?l=${n}&id=${e}`;i.src=t?t?.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}(s,V.measurementId),uR&&(r("consent","default",uR),function UB(n){uR=n}(void 0)),r("js",new Date);const ae=null!==(b=f?.config)&&void 0!==b?b:{};return ae[Wq]="firebase",ae.update=!0,null!=X&&(ae[qq]=X),r("config",V.measurementId,ae),rR&&(r("set",rR),function jB(n){rR=n}(void 0)),V.measurementId}),hR.apply(this,arguments)}class w8{constructor(e){this.app=e}_delete(){return delete d_[this.app.options.appId],Promise.resolve()}}let d_={},$B=[];const GB={};let qB,h_,uM="dataLayer",HB="gtag",fR=!1;function E8(n,e,t){!function C8(){const n=[];if((0,K.ru)()&&n.push("This is a browser extension environment."),(0,K.zI)()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,r)=>`(${r+1}) ${i}`).join(" "),t=pd.create("invalid-analytics-context",{errorInfo:e});yl.warn(t.message)}}();const i=n.options.appId;if(!i)throw pd.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw pd.create("no-api-key");yl.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=d_[i])throw pd.create("already-exists",{id:i});if(!fR){!function e8(n){let e=[];Array.isArray(window[n])?e=window[n]:window[n]=e}(uM);const{wrappedGtag:s,gtagCore:f}=function r8(n,e,t,i,r){let s=function(...f){window[i].push(arguments)};return window[r]&&"function"==typeof window[r]&&(s=window[r]),window[r]=function i8(n,e,t,i){function s(){return s=(0,z.Z)(function*(f,b,I){try{"event"===f?yield function n8(n,e,t,i,r){return eR.apply(this,arguments)}(n,e,t,b,I):"config"===f?yield function t8(n,e,t,i,r,s){return Jk.apply(this,arguments)}(n,e,t,i,b,I):"consent"===f?n("consent","update",I):n("set",b)}catch(O){yl.error(O)}}),s.apply(this,arguments)}return function r(f,b,I){return s.apply(this,arguments)}}(s,n,e,t),{gtagCore:s,wrappedGtag:window[r]}}(d_,$B,GB,uM,HB);h_=s,qB=f,fR=!0}return d_[i]=function x8(n,e,t,i,r,s,f){return hR.apply(this,arguments)}(n,$B,GB,e,qB,uM,t),new w8(n)}function T8(n=(0,Z.getApp)()){n=(0,K.m9)(n);const e=(0,Z._getProvider)(n,cM);return e.isInitialized()?e.getImmediate():function I8(n,e={}){const t=(0,Z._getProvider)(n,cM);if(t.isInitialized()){const r=t.getImmediate();if((0,K.vZ)(e,t.getOptions()))return r;throw pd.create("already-initialized")}return t.initialize({options:e})}(n)}function S8(){return pR.apply(this,arguments)}function pR(){return(pR=(0,z.Z)(function*(){if((0,K.ru)()||!(0,K.zI)()||!(0,K.hl)())return!1;try{return yield(0,K.eu)()}catch{return!1}})).apply(this,arguments)}function M8(n,e,t){n=(0,K.m9)(n),function _8(n,e,t,i){return aR.apply(this,arguments)}(h_,d_[n.app.options.appId],e,t).catch(i=>yl.error(i))}function WB(n,e,t,i){n=(0,K.m9)(n),function m8(n,e,t,i,r){return oR.apply(this,arguments)}(h_,d_[n.app.options.appId],e,t,i).catch(r=>yl.error(r))}const ZB="@firebase/analytics";!function D8(){(0,Z._registerComponent)(new te.wA(cM,(e,{options:t})=>E8(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),(0,Z._registerComponent)(new te.wA("analytics-internal",function n(e){try{const t=e.getProvider(cM).getImmediate();return{logEvent:(i,r,s)=>WB(t,i,r,s)}}catch(t){throw pd.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),(0,Z.registerVersion)(ZB,"0.9.5"),(0,Z.registerVersion)(ZB,"0.9.5","esm2017")}();class A8 extends qe.w0{constructor(e,t){super()}schedule(e,t=0){return this}}const dM={setInterval(n,e,...t){const{delegate:i}=dM;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=dM;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var P8=Ae(8737);class hM extends A8{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return dM.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&dM.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,P8.P)(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const mR={now:()=>(mR.delegate||Date).now(),delegate:void 0};class zE{constructor(e,t=zE.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}zE.now=mR.now;class fM extends zE{constructor(e,t=zE.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const R8=new class k8 extends fM{}(class O8 extends hM{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!=i&&i>0||null==i&&this.delay>0?super.requestAsyncId(e,t,i):(e.flush(this),0)}}),BE=new fM(hM),F8=BE;var VE=Ae(9468),r1=Ae(5363);const cv=new d.GfV("7.5.0"),gR="__angularfire_symbol__analyticsIsSupportedValue",_R="__angularfire_symbol__analyticsIsSupported",yR="__angularfire_symbol__remoteConfigIsSupportedValue",vR="__angularfire_symbol__remoteConfigIsSupported",bR="__angularfire_symbol__messagingIsSupportedValue",xR="__angularfire_symbol__messagingIsSupported";globalThis[_R]||(globalThis[_R]=S8().then(n=>globalThis[gR]=n).catch(()=>globalThis[gR]=!1)),globalThis[xR]||(globalThis[xR]=NB().then(n=>globalThis[bR]=n).catch(()=>globalThis[bR]=!1)),globalThis[vR]||(globalThis[vR]=lq().then(n=>globalThis[yR]=n).catch(()=>globalThis[yR]=!1));const pM={async:()=>globalThis[_R],sync:()=>{const n=globalThis[gR];if(void 0===n)throw new Error((n=>`The APP_INITIALIZER that is "making" isSupported() sync for the sake of convenient DI has not resolved in this\ncontext. Rather than injecting ${n} in the constructor, first ensure that ${n} is supported by calling\n\`await isSupported()\`, then retrieve the instance from the injector manually \`injector.get(${n})\`.`)("Analytics"));return n}};function UE(n,e,t){if(e){if(1===e.length)return e[0];const s=e.filter(f=>f.app===t);if(1===s.length)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}const jE=(n,e)=>{const t=e?[e]:(0,Z.getApps)(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(f=>{i.includes(f)||i.push(f)})}),i};function o1(){}class KB{constructor(e,t=R8){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){const r=this.zone;return this.delegate.schedule(function(f){r.runGuarded(()=>{e.apply(this,[f])})},t,i)}}class L8{constructor(e){this.zone=e,this.task=null}call(e,t){const i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",o1,{},o1,o1)),t.pipe(vi({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Db=(()=>{class n{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new KB(Zone.current)),this.insideAngular=t.run(()=>new KB(Zone.current,BE)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(d.R0b))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ab(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function Pb(n){return Ab().ngZone.run(()=>n())}function Jd(n){return Ab(),function z8(n){return function(t){return(t=t.lift(new L8(n.ngZone))).pipe((0,VE.R)(n.outsideAngular),(0,r1.Q)(n.insideAngular))}}(Ab())(n)}const B8=(n,e)=>function(){const i=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),Pb(()=>n.apply(void 0,i))},f_=(n,e)=>function(){let t;const i=arguments;for(let s=0;s<arguments.length;s++)"function"==typeof i[s]&&(e&&(t||(t=Pb(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",o1,{},o1,o1)))),i[s]=B8(i[s],t));const r=function N8(n){return Ab().ngZone.runOutsideAngular(()=>n())}(()=>n.apply(this,i));if(!e){if(r instanceof L.y){const s=Ab();return r.pipe((0,VE.R)(s.outsideAngular),(0,r1.Q)(s.insideAngular))}return Pb(()=>r)}return r instanceof L.y?r.pipe(Jd):r instanceof Promise?Pb(()=>new Promise((s,f)=>r.then(b=>Pb(()=>s(b)),b=>Pb(()=>f(b))))):"function"==typeof r&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),r.apply(this,arguments)}:Pb(()=>r)};class uv{constructor(e){return e}}class $E{constructor(){return(0,Z.getApps)()}}const CR=new d.OlP("angularfire2._apps"),U8={provide:uv,useFactory:function V8(n){return n&&1===n.length?n[0]:new uv((0,Z.getApp)())},deps:[[new d.FiY,CR]]},j8={provide:$E,deps:[[new d.FiY,CR]]};function $8(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new uv(i)}}let G8=(()=>{class n{constructor(t){(0,Z.registerVersion)("angularfire",cv.full,"core"),(0,Z.registerVersion)("angularfire",cv.full,"app"),(0,Z.registerVersion)("angular",d.q4F.full,t.toString())}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(d.Lbi))},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[U8,j8]}),n})();function H8(n,...e){return{ngModule:G8,providers:[{provide:CR,useFactory:$8(n),multi:!0,deps:[d.R0b,d.zs3,Db,...e]}]}}const q8=f_(Z.initializeApp,!0),ER=new Map,XB={activated:!1,tokenObservers:[]},W8={initialized:!1,enabled:!1};function Jl(n){return ER.get(n)||Object.assign({},XB)}function mM(){return W8}const TR="https://content-firebaseappcheck.googleapis.com/v1",X8="exchangeDebugToken",QB={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class J8{constructor(e,t,i,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,z.Z)(function*(){t.stop();try{t.pending=new K.BH,yield function eW(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new K.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(i){t.retryPolicy(i)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const bu=new K.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function MR(){return MR=(0,z.Z)(function*({url:n,body:e},t){const i={"Content-Type":"application/json"},r=t.getImmediate({optional:!0});if(r){const X=yield r.getHeartbeatsHeader();X&&(i["X-Firebase-Client"]=X)}const s={method:"POST",body:JSON.stringify(e),headers:i};let f,b;try{f=yield fetch(n,s)}catch(X){throw bu.create("fetch-network-error",{originalErrorMessage:X?.message})}if(200!==f.status)throw bu.create("fetch-status-error",{httpStatus:f.status});try{b=yield f.json()}catch(X){throw bu.create("fetch-parse-error",{originalErrorMessage:X?.message})}const I=b.ttl.match(/^([\d.]+)(s)$/);if(!I||!I[2]||isNaN(Number(I[1])))throw bu.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${b.ttl}`});const O=1e3*Number(I[1]),V=Date.now();return{token:b.token,expireTimeMillis:V+O,issuedAtTimeMillis:V}}),MR.apply(this,arguments)}const oW="firebase-app-check-database",sW=1,GE="firebase-app-check-store";let yM=null;function DR(){return DR=(0,z.Z)(function*(n,e){const i=(yield function t3(){return yM||(yM=new Promise((n,e)=>{try{const t=indexedDB.open(oW,sW);t.onsuccess=i=>{n(i.target.result)},t.onerror=i=>{var r;e(bu.create("storage-open",{originalErrorMessage:null===(r=i.target.error)||void 0===r?void 0:r.message}))},t.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(GE,{keyPath:"compositeKey"})}}catch(t){e(bu.create("storage-open",{originalErrorMessage:t?.message}))}}),yM)}()).transaction(GE,"readwrite"),s=i.objectStore(GE).put({compositeKey:n,value:e});return new Promise((f,b)=>{s.onsuccess=I=>{f()},i.onerror=I=>{var O;b(bu.create("storage-set",{originalErrorMessage:null===(O=I.target.error)||void 0===O?void 0:O.message}))}})}),DR.apply(this,arguments)}const HE=new ie.Yd("@firebase/app-check");function OR(n,e){return(0,K.hl)()?function lW(n,e){return function n3(n,e){return DR.apply(this,arguments)}(function r3(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{HE.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function RR(){return RR=(0,z.Z)(function*(){const n=mM();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),RR.apply(this,arguments)}const pW={error:"UNKNOWN_ERROR"};function mW(n){return K.US.encodeString(JSON.stringify(n),!1)}function vM(n){return FR.apply(this,arguments)}function FR(){return FR=(0,z.Z)(function*(n,e=!1){const t=n.app;!function JB(n){if(!Jl(n).activated)throw bu.create("use-before-activation",{appName:n.name})}(t);const i=Jl(t);let s,r=i.token;if(r&&!s1(r)&&(i.token=void 0,r=void 0),!r){const I=yield i.cachedTokenPromise;I&&(s1(I)?r=I:yield OR(t,void 0))}if(!e&&r&&s1(r))return{token:r.token};let b,f=!1;if(function o3(){return mM().enabled}()){i.exchangeTokenPromise||(i.exchangeTokenPromise=function SR(n,e){return MR.apply(this,arguments)}(function rW(n,e){const{projectId:t,appId:i,apiKey:r}=n.options;return{url:`${TR}/projects/${t}/apps/${i}:${X8}?key=${r}`,body:{debug_token:e}}}(t,yield function s3(){return RR.apply(this,arguments)}()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),f=!0);const I=yield i.exchangeTokenPromise;return yield OR(t,I),i.token=I,{token:I.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),f=!0),r=yield Jl(t).exchangeTokenPromise}catch(I){"appCheck/throttled"===I.code?HE.warn(I.message):HE.error(I),s=I}return r?s?b=s1(r)?{token:r.token,internalError:s}:c3(s):(b={token:r.token},i.token=r,yield OR(t,r)):b=c3(s),f&&function l3(n,e){const t=Jl(n).tokenObservers;for(const i of t)try{"EXTERNAL"===i.type&&null!=e.error?i.error(e.error):i.next(e)}catch{}}(t,b),b}),FR.apply(this,arguments)}function NR(n,e){const t=Jl(n),i=t.tokenObservers.filter(r=>r.next!==e);0===i.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=i}function a3(n){const{app:e}=n,t=Jl(e);let i=t.tokenRefresher;i||(i=function gW(n){const{app:e}=n;return new J8((0,z.Z)(function*(){let i;if(i=Jl(e).token?yield vM(n,!0):yield vM(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{const t=Jl(e);if(t.token){let i=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return i=Math.min(i,t.token.expireTimeMillis-3e5),Math.max(0,i-Date.now())}return 0},QB.RETRIAL_MIN_WAIT,QB.RETRIAL_MAX_WAIT)}(n),t.tokenRefresher=i),!i.isRunning()&&t.isTokenAutoRefreshEnabled&&i.start()}function s1(n){return n.expireTimeMillis-Date.now()>0}function c3(n){return{token:mW(pW),error:n}}class _W{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Jl(this.app);for(const t of e)NR(this.app,t.next);return Promise.resolve()}}const _3="app-check-internal";!function PW(){(0,Z._registerComponent)(new te.wA("app-check",n=>function yW(n,e){return new _W(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(_3).initialize()})),(0,Z._registerComponent)(new te.wA(_3,n=>function vW(n){return{getToken:e=>vM(n,e),addTokenListener:e=>function LR(n,e,t,i){const{app:r}=n,s=Jl(r);if(s.tokenObservers=[...s.tokenObservers,{next:t,error:i,type:e}],s.token&&s1(s.token)){const b=s.token;Promise.resolve().then(()=>{t({token:b.token}),a3(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>a3(n))}(n,"INTERNAL",e),removeTokenListener:e=>NR(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,Z.registerVersion)("@firebase/app-check","0.6.4")}();class a1{constructor(){return jE("app-check")}}typeof window<"u"&&window;var v3=Ae(3432);function LW(n){return new L.y(function(e){return{unsubscribe:(0,v3.w)(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e))}})}class xM{constructor(e){return e}}class jR{constructor(){return jE("auth")}}const $R=new d.OlP("angularfire2.auth-instances");function BW(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new xM(i)}}const VW={provide:jR,deps:[[new d.FiY,$R]]},UW={provide:xM,useFactory:function zW(n,e){const t=UE("auth",n,e);return t&&new xM(t)},deps:[[new d.FiY,$R],uv]};let jW=(()=>{class n{constructor(){(0,Z.registerVersion)("angularfire",cv.full,"auth")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[UW,VW]}),n})();function $W(n,...e){return{ngModule:jW,providers:[{provide:$R,useFactory:BW(n),multi:!0,deps:[d.R0b,d.zs3,Db,$E,[new d.FiY,a1],...e]}]}}const GW=f_(LW,!0),HW=f_(v3.o,!0);class qE{constructor(e){return e}}const x3="firestore",GR=new d.OlP("angularfire2.firestore-instances");function ZW(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new qE(i)}}const YW={provide:class qW{constructor(){return jE(x3)}},deps:[[new d.FiY,GR]]},KW={provide:qE,useFactory:function WW(n,e){const t=UE(x3,n,e);return t&&new qE(t)},deps:[[new d.FiY,GR],uv]};let XW=(()=>{class n{constructor(){(0,Z.registerVersion)("angularfire",cv.full,"fst")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[KW,YW]}),n})();function QW(n,...e){return{ngModule:XW,providers:[{provide:GR,useFactory:ZW(n),multi:!0,deps:[d.R0b,d.zs3,Db,$E,[new d.FiY,jR],[new d.FiY,a1],...e]}]}}const JW=f_(Qz,!0),eZ=f_(K$,!0);function wM(){return(0,Xe.e)((n,e)=>{let t,i=!1;n.subscribe((0,ve.x)(e,r=>{const s=t;t=r,i&&e.next([s,r]),i=!0}))})}function CM(n,e=ge.y){return n=n??tZ,(0,Xe.e)((t,i)=>{let r,s=!0;t.subscribe((0,ve.x)(i,f=>{const b=e(f);(s||!n(r,b))&&(s=!1,r=b,i.next(f))}))})}function tZ(n,e){return n===e}var _p=Ae(2011),nZ=(Ae(9568),Ae(3942));function HR(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Zt("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function w3(){if(typeof Uint8Array>"u")throw new Zt("unimplemented","Uint8Arrays are not available in this environment.")}function C3(){if(!function YC(){return typeof atob<"u"}())throw new Zt("unimplemented","Blobs are unavailable in Firestore in this environment.")}class WE{constructor(e){this._delegate=e}static fromBase64String(e){return C3(),new WE(km.fromBase64String(e))}static fromUint8Array(e){return w3(),new WE(km.fromUint8Array(e))}toBase64(){return C3(),this._delegate.toBase64()}toUint8Array(){return w3(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function qR(n){return function oZ(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const i of e)if(i in t&&"function"==typeof t[i])return!0;return!1}(n,["next","error","complete"])}class sZ{enableIndexedDbPersistence(e,t){return function X$(n,e){Rz(n=Or(n,gs));const t=oa(n);if(t._uninitializedComponentsProvider)throw new Zt(Et.FAILED_PRECONDITION,"SDK cache is already specified.");Qd("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const i=n._freezeSettings(),r=new Yw;return kz(t,r,new vO(r,i.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function Q$(n){Rz(n=Or(n,gs));const e=oa(n);if(e._uninitializedComponentsProvider)throw new Zt(Et.FAILED_PRECONDITION,"SDK cache is already specified.");Qd("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),i=new Yw;return kz(e,i,new _z(i,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function J$(n){if(n._initialized&&!n._terminated)throw new Zt(Et.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Ws;return n._queue.enqueueAndForgetEvenWhileRestricted((0,z.Z)(function*(){try{yield(t=(0,z.Z)(function*(i){if(!dd.D())return Promise.resolve();const r=i+"main";yield dd.delete(r)}),function(i){return t.apply(this,arguments)})(dP(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class E3{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof pp||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Qd("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,i={}){Az(this._delegate,e,t,i)}enableNetwork(){return function tG(n){return function z$(n){return n.asyncQueue.enqueue((0,z.Z)(function*(){const e=yield bz(n),t=yield IO(n);return e.setNetworkEnabled(!0),function(i){const r=kn(i);return r.du.delete(0),SE(r)}(t)}))}(oa(n=Or(n,gs)))}(this._delegate)}disableNetwork(){return function nG(n){return function B$(n){return n.asyncQueue.enqueue((0,z.Z)(function*(){const e=yield bz(n),t=yield IO(n);return e.setNetworkEnabled(!1),(i=(0,z.Z)(function*(r){const s=kn(r);s.du.add(0),yield jw(s),s.mu.set("Offline")}),function(r){return i.apply(this,arguments)})(t);var i}))}(oa(n=Or(n,gs)))}(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,Tz("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function eG(n){return function(e){const t=new Ws;return e.asyncQueue.enqueueAndForget((0,z.Z)(function*(){return function w$(n,e){return iO.apply(this,arguments)}(yield SO(e),t)})),t.promise}(oa(n=Or(n,gs)))}(this._delegate)}onSnapshotsInSync(e){return function OG(n,e){return function j$(n,e){const t=new GS(e);return n.asyncQueue.enqueueAndForget((0,z.Z)(function*(){return i=yield Kw(n),r=t,kn(i).Au.add(r),void r.next();var i,r})),()=>{t.yc(),n.asyncQueue.enqueueAndForget((0,z.Z)(function*(){return i=yield Kw(n),r=t,void kn(i).Au.delete(r);var i,r}))}}(oa(n=Or(n,gs)),OO(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Zt("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new l1(this,AO(this._delegate,e))}catch(t){throw xu(t,"collection()","Firestore.collection()")}}doc(e){try{return new nf(this,YS(this._delegate,e))}catch(t){throw xu(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new wu(this,function q$(n,e){if(n=Or(n,DE),DO("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Zt(Et.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Xl(n,null,(t=e,new mp(Pr.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw xu(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function UG(n,e,t){n=Or(n,gs);const i=Object.assign(Object.assign({},BG),t);return function(r){if(r.maxAttempts<1)throw new Zt(Et.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(r,s,f){const b=new Ws;return r.asyncQueue.enqueueAndForget((0,z.Z)(function*(){const I=yield function xz(n){return qS(n).then(e=>e.datastore)}(r);new L$(r.asyncQueue,I,f,s,b).run()})),b.promise}(oa(n),r=>e(new VG(n,r)),i)}(this._delegate,t=>e(new T3(this,t)))}batch(){return oa(this._delegate),new I3(new eB(this._delegate,e=>Qw(this._delegate,e)))}loadBundle(e){return function iG(n,e){const t=oa(n=Or(n,gs)),i=new Z$;return function $$(n,e,t,i){const r=function(s,f){let b;return b="string"==typeof s?(new TextEncoder).encode(s):s,I=function(I,O){if(I instanceof Uint8Array)return yz(I,O);if(I instanceof ArrayBuffer)return yz(new Uint8Array(I),O);if(I instanceof ReadableStream)return I.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(b),new R$(I,f);var I}(t,IE(e));n.asyncQueue.enqueueAndForget((0,z.Z)(function*(){!function k$(n,e,t){const i=kn(n);var r;(r=(0,z.Z)(function*(s,f,b){try{const I=yield f.getMetadata();if(yield function(ae,me){const Ie=kn(ae),Ge=ra(me.createTime);return Ie.persistence.runTransaction("hasNewerBundle","readonly",Je=>Ie.xs.getBundleMetadata(Je,me.id)).then(Je=>!!Je&&Je.createTime.compareTo(Ge)>=0)}(s.localStore,I))return yield f.close(),b._completeWith({taskState:"Success",documentsLoaded:(ae=I).totalDocuments,bytesLoaded:ae.totalBytes,totalDocuments:ae.totalDocuments,totalBytes:ae.totalBytes}),Promise.resolve(new Set);b._updateProgress(lz(I));const O=new h$(I,s.localStore,f.serializer);let V=yield f._c();for(;V;){const ae=yield O.$u(V);ae&&b._updateProgress(ae),V=yield f._c()}const X=yield O.complete();return yield s_(s,X.Bu,void 0),yield function(ae,me){const Ie=kn(ae);return Ie.persistence.runTransaction("Save bundle","readwrite",Ge=>Ie.xs.saveBundleMetadata(Ge,me))}(s.localStore,I),b._completeWith(X.progress),Promise.resolve(X.Fu)}catch(I){return Qd("SyncEngine",`Loading bundle failed with ${I}`),b._failWith(I),Promise.resolve(new Set)}var ae}),function(s,f,b){return r.apply(this,arguments)})(i,e,t).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}(yield SO(n),r,i)}))}(t,n._databaseId,e,i),i}(this._delegate,e)}namedQuery(e){return function rG(n,e){return function G$(n,e){return n.asyncQueue.enqueue((0,z.Z)(function*(){return function(t,i){const r=kn(t);return r.persistence.runTransaction("Get named query","readonly",s=>r.xs.getNamedQuery(s,i))}(yield WS(n),e)}))}(oa(n=Or(n,gs)),e).then(t=>t?new Xl(n,null,t.query):null)}(this._delegate,e).then(t=>t?new wu(this,t):null)}}class EM extends BO{constructor(e){super(),this.firestore=e}convertBytes(e){return new WE(new km(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return nf.forKey(t,this.firestore,null)}}class T3{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new EM(e)}get(e){const t=kb(e);return this._delegate.get(t).then(i=>new ZE(this._firestore,new l_(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const r=kb(e);return i?(HR("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=kb(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=kb(e);return this._delegate.delete(t),this}}class I3{constructor(e){this._delegate=e}set(e,t,i){const r=kb(e);return i?(HR("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=kb(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=kb(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Ob{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new LE(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new YE(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=Ob.INSTANCES;let r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(t);return s||(s=new Ob(e,new EM(e),t),r.set(t,s)),s}}Ob.INSTANCES=new WeakMap;class nf{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new EM(e)}static forPath(e,t,i){if(e.length%2!=0)throw new Zt("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new nf(t,new ms(t._delegate,i,new Pn(e)))}static forKey(e,t,i){return new nf(t,new ms(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new l1(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new l1(this.firestore,AO(this._delegate,e))}catch(t){throw xu(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,K.m9)(e))instanceof ms&&Pz(this._delegate,e)}set(e,t){t=HR("DocumentReference.set",t);try{return t?Kz(this._delegate,e,t):Kz(this._delegate,e)}catch(i){throw xu(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return 1===arguments.length?Xz(this._delegate,e):Xz(this._delegate,e,t,...i)}catch(r){throw xu(r,"updateDoc()","DocumentReference.update()")}}delete(){return function PG(n){return Qw(Or(n.firestore,gs),[new No(n._key,re.none())])}(this._delegate)}onSnapshot(...e){const t=S3(e),i=M3(e,r=>new ZE(this.firestore,new l_(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return Jz(this._delegate,t,i)}get(e){let t;return t="cache"===e?.source?function IG(n){n=Or(n,ms);const e=Or(n.firestore,gs),t=oa(e),i=new av(e);return function V$(n,e){const t=new Ws;return n.asyncQueue.enqueueAndForget((0,z.Z)(function*(){return(i=(0,z.Z)(function*(r,s,f){try{const b=yield function(I,O){const V=kn(I);return V.persistence.runTransaction("read document","readonly",X=>V.localDocuments.getDocument(X,O))}(r,s);b.isFoundDocument()?f.resolve(b):b.isNoDocument()?f.resolve(null):f.reject(new Zt(Et.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(b){const I=Hw(b,`Failed to get document '${s} from cache`);f.reject(I)}}),function(r,s,f){return i.apply(this,arguments)})(yield WS(n),e,t);var i})),t.promise}(t,n._key).then(r=>new l_(e,i,n._key,r,new Eb(null!==r&&r.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function SG(n){n=Or(n,ms);const e=Or(n.firestore,gs);return wz(oa(e),n._key,{source:"server"}).then(t=>VO(e,n,t))}(this._delegate):function TG(n){n=Or(n,ms);const e=Or(n.firestore,gs);return wz(oa(e),n._key).then(t=>VO(e,n,t))}(this._delegate),t.then(i=>new ZE(this.firestore,new l_(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new nf(this.firestore,this._delegate.withConverter(e?Ob.getInstance(this.firestore,e):null))}}function xu(n,e,t){return n.message=n.message.replace(e,t),n}function S3(n){for(const e of n)if("object"==typeof e&&!qR(e))return e;return{}}function M3(n,e){var t,i;let r;return r=qR(n[0])?n[0]:qR(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(e(s))},error:null===(t=r.error)||void 0===t?void 0:t.bind(r),complete:null===(i=r.complete)||void 0===i?void 0:i.bind(r)}}class ZE{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new nf(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Yz(this._delegate,e._delegate)}}class YE extends ZE{data(e){const t=this._delegate.data(e);return function jI(n,e){n||Hn()}(void 0!==t),t}}class wu{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new EM(e)}where(e,t,i){try{return new wu(this.firestore,ov(this._delegate,function pG(n,e,t){const i=e,r=tM("where",n);return FE._create(r,i,t)}(e,t,i)))}catch(r){throw xu(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new wu(this.firestore,ov(this._delegate,function mG(n,e="asc"){const t=e,i=tM("orderBy",n);return zO._create(i,t)}(e,t)))}catch(i){throw xu(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new wu(this.firestore,ov(this._delegate,function gG(n){return Mz("limit",n),nM._create("limit",n,"F")}(e)))}catch(t){throw xu(t,"limit()","Query.limit()")}}limitToLast(e){try{return new wu(this.firestore,ov(this._delegate,function _G(n){return Mz("limitToLast",n),nM._create("limitToLast",n,"L")}(e)))}catch(t){throw xu(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new wu(this.firestore,ov(this._delegate,function yG(...n){return iM._create("startAt",n,!0)}(...e)))}catch(t){throw xu(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new wu(this.firestore,ov(this._delegate,function vG(...n){return iM._create("startAfter",n,!1)}(...e)))}catch(t){throw xu(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new wu(this.firestore,ov(this._delegate,function bG(...n){return rM._create("endBefore",n,!1)}(...e)))}catch(t){throw xu(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new wu(this.firestore,ov(this._delegate,function xG(...n){return rM._create("endAt",n,!0)}(...e)))}catch(t){throw xu(t,"endAt()","Query.endAt()")}}isEqual(e){return PO(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function DG(n){n=Or(n,Xl);const e=Or(n.firestore,gs),t=oa(e),i=new av(e);return function U$(n,e){const t=new Ws;return n.asyncQueue.enqueueAndForget((0,z.Z)(function*(){return(i=(0,z.Z)(function*(r,s,f){try{const b=yield LS(r,s,!0),I=new dz(s,b.Wi),O=I.zu(b.documents),V=I.applyChanges(O,!1);f.resolve(V.snapshot)}catch(b){const I=Hw(b,`Failed to execute query '${s} against cache`);f.reject(I)}}),function(r,s,f){return i.apply(this,arguments)})(yield WS(n),e,t);var i})),t.promise}(t,n._query).then(r=>new sv(e,i,n,r))}(this._delegate):"server"===e?.source?function AG(n){n=Or(n,Xl);const e=Or(n.firestore,gs),t=oa(e),i=new av(e);return Cz(t,n._query,{source:"server"}).then(r=>new sv(e,i,n,r))}(this._delegate):function MG(n){n=Or(n,Xl);const e=Or(n.firestore,gs),t=oa(e),i=new av(e);return jz(n._query),Cz(t,n._query).then(r=>new sv(e,i,n,r))}(this._delegate),t.then(i=>new WR(this.firestore,new sv(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=S3(e),i=M3(e,r=>new WR(this.firestore,new sv(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return Jz(this._delegate,t,i)}withConverter(e){return new wu(this.firestore,this._delegate.withConverter(e?Ob.getInstance(this.firestore,e):null))}}class lZ{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new YE(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class WR{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new wu(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new YE(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new lZ(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new YE(this._firestore,i))})}isEqual(e){return Yz(this._delegate,e._delegate)}}class l1 extends wu{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new nf(this.firestore,e):null}doc(e){try{return new nf(this.firestore,void 0===e?YS(this._delegate):YS(this._delegate,e))}catch(t){throw xu(t,"doc()","CollectionReference.doc()")}}add(e){return Qz(this._delegate,e).then(t=>new nf(this.firestore,t))}isEqual(e){return Pz(this._delegate,e._delegate)}withConverter(e){return new l1(this.firestore,this._delegate.withConverter(e?Ob.getInstance(this.firestore,e):null))}}function kb(n){return Or(n,ms)}class ZR{constructor(...e){this._delegate=new a_(...e)}static documentId(){return new ZR(ns.keyField().canonicalString())}isEqual(e){return(e=(0,K.m9)(e))instanceof a_&&this._delegate._internalPath.isEqual(e._internalPath)}}class Rb{constructor(e){this._delegate=e}static serverTimestamp(){const e=function $G(){return new kO("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Rb(e)}static delete(){const e=function jG(){return new PE("deleteField")}();return e._methodName="FieldValue.delete",new Rb(e)}static arrayUnion(...e){const t=function GG(...n){return new cG("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Rb(t)}static arrayRemove(...e){const t=function HG(...n){return new uG("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Rb(t)}static increment(e){const t=function qG(n){return new dG("increment",n)}(e);return t._methodName="FieldValue.increment",new Rb(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const cZ={Firestore:E3,GeoPoint:KS,Timestamp:Go,Blob:WE,Transaction:T3,WriteBatch:I3,DocumentReference:nf,DocumentSnapshot:ZE,Query:wu,QueryDocumentSnapshot:YE,QuerySnapshot:WR,CollectionReference:l1,FieldPath:ZR,FieldValue:Rb,setLogLevel:function aZ(n){!function gA(n){Kh.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function dZ(n){(function uZ(n,e){n.INTERNAL.registerComponent(new te.wA("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},cZ)))})(n,(e,t)=>new E3(e,t,new sZ)),n.registerVersion("@firebase/firestore-compat","0.3.6")}(nZ.Z);var p_=Ae(6451);class hZ extends g.x{constructor(e=1/0,t=1/0,i=mR){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:f}=this;t||(i.push(e),!r&&i.push(s.now()+f)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,s=r.slice();for(let f=0;f<s.length&&!e.closed;f+=i?1:2)e.next(s[f]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<i.length&&i.splice(0,i.length-s),!r){const f=t.now();let b=0;for(let I=1;I<i.length&&i[I]<=f;I+=2)b=I;b&&i.splice(0,b+1)}}}var D3=Ae(3099);function A3(n,e,t){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=n):i=n??1/0,(0,D3.B)({connector:()=>new hZ(i,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}function P3(n,e){return(0,at.m)(e)?dn(()=>n,e):dn(()=>n)}Ae(9260);const O3=new d.OlP("angularfire2.auth.use-emulator"),k3=new d.OlP("angularfire2.auth.settings"),R3=new d.OlP("angularfire2.auth.tenant-id"),F3=new d.OlP("angularfire2.auth.langugage-code"),L3=new d.OlP("angularfire2.auth.use-device-language"),N3=new d.OlP("angularfire.auth.persistence"),z3=(n,e,t,i,r,s,f,b)=>(0,_p.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const I=e.runOutsideAngular(()=>n.auth());if(t&&I.useEmulator(...t),i&&(I.tenantId=i),I.languageCode=r,s&&I.useDeviceLanguage(),f)for(const[O,V]of Object.entries(f))I.settings[O]=V;return b&&I.setPersistence(b),I},[t,i,r,s,f,b]);let YR=(()=>{class n{constructor(t,i,r,s,f,b,I,O,V,X,ae,me){const Ie=new g.x,Ge=c(void 0).pipe((0,r1.Q)(f.outsideAngular),dn(()=>s.runOutsideAngular(()=>Promise.resolve().then(Ae.bind(Ae,9568)))),(0,ue.U)(()=>(0,_p.on)(t,s,i)),(0,ue.U)(Je=>z3(Je,s,b,O,V,X,I,ae)),A3({bufferSize:1,refCount:!1}));if(ff(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=c(null);else{Ge.pipe(Fi()).subscribe();const Qt=Ge.pipe(dn(ai=>ai.getRedirectResult().then(Hi=>Hi,()=>null)),Jd,A3({bufferSize:1,refCount:!1})),xn=Ge.pipe(dn(ai=>new L.y(Hi=>({unsubscribe:s.runOutsideAngular(()=>ai.onAuthStateChanged(Xi=>Hi.next(Xi),Xi=>Hi.error(Xi),()=>Hi.complete()))})))),Nn=Ge.pipe(dn(ai=>new L.y(Hi=>({unsubscribe:s.runOutsideAngular(()=>ai.onIdTokenChanged(Xi=>Hi.next(Xi),Xi=>Hi.error(Xi),()=>Hi.complete()))}))));this.authState=Qt.pipe(P3(xn),(0,VE.R)(f.outsideAngular),(0,r1.Q)(f.insideAngular)),this.user=Qt.pipe(P3(Nn),(0,VE.R)(f.outsideAngular),(0,r1.Q)(f.insideAngular)),this.idToken=this.user.pipe(dn(ai=>ai?(0,Mi.D)(ai.getIdToken()):c(null))),this.idTokenResult=this.user.pipe(dn(ai=>ai?(0,Mi.D)(ai.getIdTokenResult()):c(null))),this.credential=(0,p_.T)(Qt,Ie,this.authState.pipe(Yt(ai=>!ai))).pipe((0,ue.U)(ai=>ai?.user?ai:null),(0,VE.R)(f.outsideAngular),(0,r1.Q)(f.insideAngular))}return(0,_p.pX)(this,Ge,s,{spy:{apply:(Je,Qt,xn)=>{(Je.startsWith("signIn")||Je.startsWith("createUser"))&&xn.then(Nn=>Ie.next(Nn))}}})}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(_p.Dh),d.LFG(_p.xv,8),d.LFG(d.Lbi),d.LFG(d.R0b),d.LFG(Db),d.LFG(O3,8),d.LFG(k3,8),d.LFG(R3,8),d.LFG(F3,8),d.LFG(L3,8),d.LFG(N3,8),d.LFG(a1,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})();function B3(n,e){return function pZ(n,e=BE){return new L.y(t=>{let i;return null!=e?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{i?.()}})}(n,e)}function KR(n,e){return B3(n,e).pipe((0,ue.U)(t=>({payload:t,type:"query"})))}function TM(n,e){return KR(n,e).pipe(gn(void 0),wM(),(0,ue.U)(([t,i])=>{const r=i.payload.docChanges(),s=r.map(f=>({type:f.type,payload:f}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((f,b)=>{const I=r.find(V=>V.doc.ref.isEqual(f.ref)),O=t?.payload.docs.find(V=>V.ref.isEqual(f.ref));I&&JSON.stringify(I.doc.metadata)===JSON.stringify(f.metadata)||!I&&O&&JSON.stringify(O.metadata)===JSON.stringify(f.metadata)||s.push({type:"modified",payload:{oldIndex:b,newIndex:b,type:"modified",doc:f}})}),s}))}function V3(n,e,t){return TM(n,t).pipe(Gs((i,r)=>function gZ(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=function _Z(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return XR(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return XR(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return XR(n,e.oldIndex,1)}return n}(n,i))}),n}(i,r.map(s=>s.payload),e),[]),CM(),(0,ue.U)(i=>i.map(r=>({type:r.type,payload:r}))))}function XR(n,e,t,...i){const r=n.slice();return r.splice(e,t,...i),r}function U3(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class j3{constructor(e,t,i){this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=TM(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,ue.U)(i=>i.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(gn(void 0),wM(),Yt(([i,r])=>r.length>0||!i),(0,ue.U)(([i,r])=>r),Jd)}auditTrail(e){return this.stateChanges(e).pipe(Gs((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=U3(e);return V3(this.query,t,this.afs.schedulers.outsideAngular).pipe(Jd)}valueChanges(e={}){return KR(this.query,this.afs.schedulers.outsideAngular).pipe((0,ue.U)(t=>t.payload.docs.map(i=>e.idField?Object.assign(Object.assign({},i.data()),{[e.idField]:i.id}):i.data())),Jd)}get(e){return(0,Mi.D)(this.query.get(e)).pipe(Jd)}add(e){return this.ref.add(e)}doc(e){return new $3(this.ref.doc(e),this.afs)}}class $3{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const i=this.ref.collection(e),{ref:r,query:s}=G3(i,t);return new j3(r,s,this.afs)}snapshotChanges(){return function mZ(n,e){return B3(n,e).pipe(gn(void 0),wM(),(0,ue.U)(([t,i])=>i.exists?t?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Jd)}valueChanges(e={}){return this.snapshotChanges().pipe((0,ue.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,Mi.D)(this.ref.get(e)).pipe(Jd)}}class yZ{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?TM(this.query,this.afs.schedulers.outsideAngular).pipe((0,ue.U)(t=>t.filter(i=>e.indexOf(i.type)>-1)),Yt(t=>t.length>0),Jd):TM(this.query,this.afs.schedulers.outsideAngular).pipe(Jd)}auditTrail(e){return this.stateChanges(e).pipe(Gs((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=U3(e);return V3(this.query,t,this.afs.schedulers.outsideAngular).pipe(Jd)}valueChanges(e={}){return KR(this.query,this.afs.schedulers.outsideAngular).pipe((0,ue.U)(i=>i.payload.docs.map(r=>e.idField?Object.assign({[e.idField]:r.id},r.data()):r.data())),Jd)}get(e){return(0,Mi.D)(this.query.get(e)).pipe(Jd)}}const vZ=new d.OlP("angularfire2.enableFirestorePersistence"),bZ=new d.OlP("angularfire2.firestore.persistenceSettings"),xZ=new d.OlP("angularfire2.firestore.settings"),wZ=new d.OlP("angularfire2.firestore.use-emulator");function G3(n,e=(t=>t)){return{query:e(n),ref:n}}let H3=(()=>{class n{constructor(t,i,r,s,f,b,I,O,V,X,ae,me,Ie,Ge,Je,Qt,xn){this.schedulers=I;const Nn=(0,_p.on)(t,b,i),ai=V;X&&z3(Nn,b,ae,Ie,Ge,Je,me,Qt),[this.firestore,this.persistenceEnabled$]=(0,_p.cc)(`${Nn.name}.firestore`,"AngularFirestore",Nn.name,()=>{const Hi=b.runOutsideAngular(()=>Nn.firestore());if(s&&Hi.settings(s),ai&&Hi.useEmulator(...ai),r&&!ff(f)){const Xi=()=>{try{return(0,Mi.D)(Hi.enablePersistence(O||void 0).then(()=>!0,()=>!1))}catch(ro){return typeof console<"u"&&console.warn(ro),c(!1)}};return[Hi,b.runOutsideAngular(Xi)]}return[Hi,c(!1)]},[s,ai,r])}collection(t,i){let r;r="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:f}=G3(r,i),b=this.schedulers.ngZone.run(()=>s);return new j3(b,f,this)}collectionGroup(t,i){const r=i||(f=>f),s=this.firestore.collectionGroup(t);return new yZ(r(s),this)}doc(t){let i;i="string"==typeof t?this.firestore.doc(t):t;const r=this.schedulers.ngZone.run(()=>i);return new $3(r,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(_p.Dh),d.LFG(_p.xv,8),d.LFG(vZ,8),d.LFG(xZ,8),d.LFG(d.Lbi),d.LFG(d.R0b),d.LFG(Db),d.LFG(bZ,8),d.LFG(wZ,8),d.LFG(YR,8),d.LFG(O3,8),d.LFG(k3,8),d.LFG(R3,8),d.LFG(F3,8),d.LFG(L3,8),d.LFG(N3,8),d.LFG(a1,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),QR=(()=>{class n{constructor(t,i){this.db=t,this.firestore=i,this.dbName="bandeja-entrada",this.bandejaEntradaData=this.db.collection(this.dbName).valueChanges({idField:"id"})}getBandejaEntradaData(){return this.bandejaEntradaData}getEmailById(t){return this.db.collection(this.dbName).doc(t).valueChanges({idField:"id"})}addEmail(t){return JW(AO(this.firestore,this.dbName),t)}updateEmailALeido(t){return t.estado="LEIDO",this.db.collection(this.dbName).doc(t.id).update(t)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(H3),d.LFG(qE))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function CZ(n,e){1&n&&(d.TgZ(0,"div",29),d._uU(1," * El nombre es obligatorio "),d.qZA())}function EZ(n,e){1&n&&(d.TgZ(0,"div",29),d._uU(1," * El email es obligatorio y debe tener el formato correcto "),d.qZA())}function TZ(n,e){1&n&&(d.TgZ(0,"div",29),d._uU(1," * El asunto es obligatorio "),d.qZA())}function IZ(n,e){1&n&&(d.TgZ(0,"div",29),d._uU(1," * El mensaje es obligatorio "),d.qZA())}function SZ(n,e){1&n&&(d.TgZ(0,"div",30),d._uU(1," \xa1Muchas gracias por contactar con nosotros! Nos pondremos en contacto contigo cuanto antes. "),d.qZA())}function MZ(n,e){1&n&&(d.TgZ(0,"div",31),d._uU(1," Ha ocurrido un error al enviar el mensaje. Por favor, contacte con nosotros a trav\xe9s de "),d.TgZ(2,"b"),d._uU(3,"contacto@hasspro.es"),d.qZA(),d._uU(4,". "),d.qZA())}function DZ(n,e){if(1&n&&(d.TgZ(0,"div",32)(1,"div",33),d._UZ(2,"img",34),d.qZA(),d.TgZ(3,"div",35),d._uU(4),d.qZA()()),2&n){const t=e.$implicit,i=d.oxw();d.xp6(2),d.Q6J("src",i.iconPath+t.icon,d.LSH),d.xp6(2),d.hij(" ",t.text," ")}}let AZ=(()=>{class n{constructor(t,i){this.fb=t,this.messageService=i,this.correoEnviado=!1,this.errorEnviado=!1,this.enviandoCorreo=!1,this.iconPath="../../../assets/icons/",this.vDondeEncontrarnos=[{text:"Ronda del Carmen, 13. C\xe1ceres (CP: 10002)",icon:"icon-map.png"},{text:"640 90 36 70",icon:"icon-phone.png"},{text:"contacto@hasspro.es",icon:"icon-email.png"},{text:"Hasspro_es",icon:"icon-instagram.png"},{text:"Hasspro \xc1vila",icon:"icon-facebook.png"},{text:"hasspro.es",icon:"icon-website.png"}],this.center=[-6.3757,39.4684],this.zoom=16,this.container="mapa-container",this.formularioContacto=this.fb.group({nombre:["",[du.required]],email:["",[du.required,du.email]],asunto:["",[du.required]],mensaje:["",[du.required]]})}ngOnInit(){}ngAfterViewInit(){wc.accessToken=mg_mapboxToken;var t=new wc.Map({container:"mapa-container",style:"mapbox://styles/mapbox/streets-v11",center:this.center,zoom:this.zoom,scrollZoom:!1});t.scrollZoom.disable(),t.boxZoom.disable(),t.dragRotate.disable(),t.dragPan.disable(),t.keyboard.disable(),t.doubleClickZoom.disable(),t.touchZoomRotate.disable(),(new wc.Marker).setLngLat(this.center).addTo(t)}onSubmit(){if(this.formularioContacto.invalid)return void this.formularioContacto.markAllAsTouched();this.correoEnviado=!0;const t={fecha:Go.fromDate(new Date),estado:"NO_LEIDO",...this.formularioContacto.value};this.enviandoCorreo=!0,this.messageService.addEmail(t).then(i=>{this.correoEnviado=!0,this.enviandoCorreo=!1,this.formularioContacto.reset()},i=>{console.log("Error al enviar el mensaje:",i),this.errorEnviado=!0,this.enviandoCorreo=!1})}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(w),d.Y36(QR))},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-contact"]],decls:60,vars:10,consts:[[1,"contacto-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"contactanos-container"],[1,"title"],[1,"parrafo"],[1,"formulario-container"],[3,"formGroup","submit"],[1,"input-group"],["for","nombre"],["type","text","id","nombre","formControlName","nombre"],["class","input-error",4,"ngIf"],["type","email","id","email","formControlName","email"],["type","text","id","asunto","formControlName","asunto"],["id","mensaje","formControlName","mensaje"],[1,"submit-container"],["type","submit",3,"disabled"],["class","correo-enviado",4,"ngIf"],["class","correo-enviado-error",4,"ngIf"],[1,"direccion-container"],[1,"nos-conocemos-container","animate__animated","animate__fadeIn","animate__delay-1s"],[1,"subtitle"],[1,"contact-list"],["class","item-contacto",4,"ngFor","ngForOf"],[1,"map-container"],["id","mapa-container"],[1,"input-error"],[1,"correo-enviado"],[1,"correo-enviado-error"],[1,"item-contacto"],[1,"icon"],[3,"src"],[1,"text"]],template:function(t,i){if(1&t&&(d.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),d._UZ(4,"img",4),d.qZA(),d.TgZ(5,"h1",5),d._uU(6,"ASISTENTE PROFESIONAL DE HOSTELER\xcdA"),d.qZA()()(),d.TgZ(7,"div",6)(8,"div",7),d._uU(9,"\xbfC\xf3mo trabajamos?"),d.qZA(),d.TgZ(10,"div",8),d._uU(11," Visite nuestra oficina o "),d.TgZ(12,"b"),d._uU(13,"programe una cita"),d.qZA(),d._uU(14,", nos adaptamos a su horario. "),d.qZA(),d.TgZ(15,"div",8),d._uU(16," Servicio "),d.TgZ(17,"b"),d._uU(18,"exclusivo"),d.qZA(),d._uU(19," y "),d.TgZ(20,"b"),d._uU(21,"personalizado"),d.qZA(),d._uU(22,". "),d.qZA()(),d.TgZ(23,"div",9)(24,"form",10),d.NdJ("submit",function(){return i.onSubmit()}),d.TgZ(25,"div",11)(26,"label",12),d._uU(27,"Nombre"),d.qZA(),d._UZ(28,"input",13),d.YNc(29,CZ,2,0,"div",14),d.qZA(),d.TgZ(30,"div",11)(31,"label",12),d._uU(32,"Email"),d.qZA(),d._UZ(33,"input",15),d.YNc(34,EZ,2,0,"div",14),d.qZA(),d.TgZ(35,"div",11)(36,"label",12),d._uU(37,"Asunto"),d.qZA(),d._UZ(38,"input",16),d.YNc(39,TZ,2,0,"div",14),d.qZA(),d.TgZ(40,"div",11)(41,"label",12),d._uU(42,"Mensaje"),d.qZA(),d._UZ(43,"textarea",17),d.YNc(44,IZ,2,0,"div",14),d.qZA(),d.TgZ(45,"div",18)(46,"button",19),d._uU(47),d.qZA()(),d.YNc(48,SZ,2,0,"div",20),d.YNc(49,MZ,5,0,"div",21),d.qZA()(),d.TgZ(50,"div",22)(51,"div",23)(52,"div",7),d._uU(53," \xbfNos conocemos? "),d.qZA(),d.TgZ(54,"div",24),d._uU(55," Queremos escucharte y compartir nuestra experiencia contigo. Puedes encontrarnos en todos estos sitios: "),d.qZA(),d.TgZ(56,"div",25),d.YNc(57,DZ,5,2,"div",26),d.qZA()(),d.TgZ(58,"div",27),d._UZ(59,"div",28),d.qZA()()()),2&t){let r,s,f,b;d.xp6(24),d.Q6J("formGroup",i.formularioContacto),d.xp6(5),d.Q6J("ngIf",(null==(r=i.formularioContacto.get("nombre"))?null:r.touched)&&null!==(null==(r=i.formularioContacto.get("nombre"))?null:r.errors)),d.xp6(5),d.Q6J("ngIf",(null==(s=i.formularioContacto.get("email"))?null:s.touched)&&null!==(null==(s=i.formularioContacto.get("email"))?null:s.errors)),d.xp6(5),d.Q6J("ngIf",(null==(f=i.formularioContacto.get("asunto"))?null:f.touched)&&null!==(null==(f=i.formularioContacto.get("asunto"))?null:f.errors)),d.xp6(5),d.Q6J("ngIf",(null==(b=i.formularioContacto.get("mensaje"))?null:b.touched)&&null!==(null==(b=i.formularioContacto.get("mensaje"))?null:b.errors)),d.xp6(2),d.Q6J("disabled",i.enviandoCorreo),d.xp6(1),d.hij(" ",i.enviandoCorreo?"Enviando...":"Enviar"," "),d.xp6(1),d.Q6J("ngIf",i.correoEnviado),d.xp6(1),d.Q6J("ngIf",i.errorEnviado),d.xp6(8),d.Q6J("ngForOf",i.vDondeEncontrarnos)}},dependencies:[ur,Bo,kg,_g,vg,hy,pl,tp],styles:[".contacto-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:30px;flex-wrap:wrap;width:calc(100% - 180px);padding:50px;margin:70px 40px;background-color:var(--principal-color-light-80);border-radius:5px;box-shadow:2px 2px 4px var(--principal-color-light)}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:36px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 25% 30px;border-bottom:1px solid var(--principal-color-80)}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .parrafo[_ngcontent-%COMP%]{font-size:20px;color:var(--principal-color)}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .parrafo[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-weight:900;text-shadow:1px 1px 3px var(--principal-color-40)}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:10px;padding-bottom:60px}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:flex-start;width:500px;max-width:100%;gap:5px;flex-direction:column}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:var(--principal-color)}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:40px;padding:0 10px;border:1px solid var(--principal-color);border-radius:5px;box-sizing:border-box;font-size:14px;font-weight:700;color:var(--principal-color)}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;height:100px;padding:10px;border:1px solid var(--principal-color);border-radius:5px;box-sizing:border-box;font-size:14px;font-weight:700;resize:none;color:var(--principal-color)}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-error[_ngcontent-%COMP%]{color:red;font-size:12px}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]{display:flex;align-items:flex-end;justify-content:flex-end;width:100%;padding-top:20px}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:200px;height:40px;border:none;border-radius:5px;background-color:var(--principal-color);color:var(--white-color);font-size:16px;font-weight:700;cursor:pointer}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:var(--principal-color-light);color:var(--principal-color)}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .correo-enviado[_ngcontent-%COMP%]{text-align:center;width:calc(100% - 40px);max-width:500px;background-color:#cbeccb;color:#000;font-size:18px;padding:30px 10px;margin:30px 10px;border-radius:10px;box-shadow:2px 2px 4px #00000020}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .correo-enviado-error[_ngcontent-%COMP%]{text-align:center;width:calc(100% - 40px);max-width:500px;background-color:#eccbcb;color:#000;font-size:18px;padding:30px 10px;margin:30px 10px;border-radius:10px;box-shadow:2px 2px 4px #00000020}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;width:100%;background-color:var(--principal-color);color:var(--white-color)}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;padding:100px 40px;width:calc(50% - 80px);box-sizing:border-box}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:2.2rem;font-weight:700;text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-bottom:1px solid var(--principal-color-light);padding:8px 20px}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1.2rem;max-width:600px;font-weight:700;text-align:start;padding:8px 20px}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:20px}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .item-contacto[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;flex-direction:row;gap:20px}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .item-contacto[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:30px;height:auto}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .item-contacto[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:1rem;font-weight:700}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:50%;height:710px;box-sizing:border-box}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   #mapa-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column}@media screen and (min-width: 600px) and (max-width: 959px){.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:50px 10px;margin:70px 10px}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:30px;padding:0 10px 30px;text-align:center}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .parrafo[_ngcontent-%COMP%]{font-size:16px;text-align:center}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]{width:100%}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%], .contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]{width:95%}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]{flex-direction:column}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%], .contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:100%}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]{padding:80px 10px}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{text-align:center}}@media screen and (max-width: 599px){.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:50px 10px;margin:70px 10px}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:30px;padding:0 10px 30px;text-align:center}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .parrafo[_ngcontent-%COMP%]{font-size:16px;text-align:center}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]{width:100%}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%], .contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]{width:95%}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]{flex-direction:column}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%], .contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:100%}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]{padding:80px 10px}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{text-align:center}}"]}),n})(),PZ=(()=>{class n{constructor(){}ngOnInit(){window.scroll({top:0,left:0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-sobre-hasspro"]],decls:27,vars:0,consts:[[1,"sobre-hasspro-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"sobre-hasspro-card"],[1,"title"],[1,"parrafo"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),d._UZ(4,"img",4),d.qZA(),d.TgZ(5,"h1",5),d._uU(6,"ASISTENTE PROFESIONAL DE HOSTELER\xcdA"),d.qZA()()(),d.TgZ(7,"div",6)(8,"div",7),d._uU(9," Sobre Hasspro "),d.qZA(),d.TgZ(10,"div",8),d._uU(11," Hasspro, fundada por "),d.TgZ(12,"b"),d._uU(13,"Abel \xc1vila Alcalde"),d.qZA(),d._uU(14," tras la formaci\xf3n, estudios y haber conocido de primera mano el sector hostelero, trabajando con diferentes responsabilidades, en diferentes establecimientos y haber obtenido el titulo de t\xe9cnico en gesti\xf3n administrativa, el titulo t\xe9cnico superior en administraci\xf3n y finanzas y me encuentro actualmente terminando el Grado en finanzas y contabilidad en la Universidad de Extremadura. "),d.qZA(),d.TgZ(15,"div",8),d._uU(16," Tras mi dilatada experiencia encontr\xe9 mi oportunidad de negocio al observar que las necesidades del restaurador son muchas y variadas, y no se pueden limitar solamente a las funciones de camarero o cocinero, sino que deben aprender a gestionar su negocio, para poder sacarle el mayor rendimiento. "),d.qZA(),d.TgZ(17,"div",8),d._uU(18," Mi "),d.TgZ(19,"b"),d._uU(20,"motivaci\xf3n"),d.qZA(),d._uU(21," para emprender en este negocio, es "),d.TgZ(22,"b"),d._uU(23,"contribuir a mejorar la situaci\xf3n de los establecimientos"),d.qZA(),d._uU(24," de mi ciudad natal. La hoster\xeda, un sector en auge actualmente, pero que en ocasiones denostado por una dif\xedcil conciliaci\xf3n, los altos costes o la poca formaci\xf3n. "),d.qZA(),d.TgZ(25,"div",8),d._uU(26," Busco ofrecer una mejora de la profesionalidad del sector y contribuir a una mayor rentabilidad de los negocios. "),d.qZA()()())},styles:[".sobre-hasspro-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.sobre-hasspro-container[_ngcontent-%COMP%]   .sobre-hasspro-card[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:50px;flex-wrap:wrap;width:calc(100% - 180px);padding:50px 50px 100px;margin:70px 40px 20px;background-color:var(--principal-color-light-80);border-radius:5px;box-shadow:2px 2px 4px var(--principal-color-light)}.sobre-hasspro-container[_ngcontent-%COMP%]   .sobre-hasspro-card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:36px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 25% 30px;border-bottom:1px solid var(--principal-color-80)}.sobre-hasspro-container[_ngcontent-%COMP%]   .sobre-hasspro-card[_ngcontent-%COMP%]   .parrafo[_ngcontent-%COMP%]{width:100%;text-align:start;font-size:18px;color:var(--principal-color)}.sobre-hasspro-container[_ngcontent-%COMP%]   .sobre-hasspro-card[_ngcontent-%COMP%]   .parrafo[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-weight:900;text-shadow:1px 1px 2px var(--principal-color-20)}@media screen and (min-width: 600px) and (max-width: 959px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]{padding:50px 20px 100px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]{width:90%}}@media screen and (max-width: 599px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .sobre-hasspro-card[_ngcontent-%COMP%]{width:calc(100% - 40px);padding:50px 10px 100px;margin:20px 10px}.servicios-container[_ngcontent-%COMP%]   .sobre-hasspro-card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding:0 10px 30px;text-align:center}}"]}),n})();function OZ(n,e){if(1&n&&(d.TgZ(0,"div",22),d._UZ(1,"img",23),d.TgZ(2,"span"),d._uU(3),d.qZA()()),2&n){const t=e.$implicit;d.xp6(3),d.hij(" ",t," ")}}function kZ(n,e){if(1&n&&(d.TgZ(0,"div",15)(1,"div",16)(2,"div",17),d._UZ(3,"img",18),d.qZA(),d.TgZ(4,"div",19),d._uU(5),d.qZA()(),d.TgZ(6,"div",20),d.YNc(7,OZ,4,1,"div",21),d.qZA()()),2&n){const t=e.$implicit;d.xp6(3),d.Q6J("src",t.iconPath,d.LSH),d.xp6(2),d.hij(" ",t.titulo," "),d.xp6(2),d.Q6J("ngForOf",t.datos)}}let RZ=(()=>{class n{constructor(){this.vContabilidad=["An\xe1lisis, revisi\xf3n y evoluci\xf3n de la contabilidad","Cierre del ejercicio","Presentaci\xf3n de las cuentas anuales y libros","Gesti\xf3n y trato de informaci\xf3n"],this.vLaboral=["Elaboraci\xf3n de las n\xf3minas","Presentaci\xf3n de los impuestos correspondientes","Altas y bajas en la empresa","Elaboraci\xf3n de entrevistas y elecci\xf3n de candidatos","Expedientes y tr\xe1mites con la Seguridad Social"],this.vFiscalidad=["Impuesto sobre la Renta de las Personas F\xedsicas (IRPF)","Impuesto sobre el Valor A\xf1adido (IVA)","Impuesto sobre Sociedades (IS)","Impuesto sobre Actividades Econ\xf3micas (IAE)","Impuesto sobre Transmisiones Patrimoniales y Actos Jur\xeddicos"],this.vDatos=[{titulo:"Contabilidad",iconPath:"../../../assets/icons/icon-contabilidad.png",datos:this.vContabilidad},{titulo:"Laboral",iconPath:"i../../../assets/icons/icon-laboral.png",datos:this.vLaboral},{titulo:"Fiscalidad",iconPath:"i../../../assets/icons/icon-fiscalidad.png",datos:this.vFiscalidad}]}ngOnInit(){window.scroll({top:0,left:0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-gestion-documentacion"]],decls:21,vars:1,consts:[[1,"servicios-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"servicios-items-container"],[1,"title"],[1,"subtitle"],[1,"listado-servicios"],["class","item-list",4,"ngFor","ngForOf"],[1,"solicita-nuestros-servicios"],[1,"texto"],[1,"boton"],[1,"boton-contacta-con-nosotros"],[1,"item-list"],[1,"title-item-list"],[1,"icon"],[3,"src"],[1,"text"],[1,"content-item-list"],["class","item-content-item-list",4,"ngFor","ngForOf"],[1,"item-content-item-list"],["src","../../../assets/icons/check.png"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),d._UZ(4,"img",4),d.qZA(),d.TgZ(5,"h1",5),d._uU(6,"ASISTENTE PROFESIONAL DE HOSTELER\xcdA"),d.qZA()()(),d.TgZ(7,"div",6)(8,"div",7),d._uU(9," A/Gesti\xf3n de la Documentaci\xf3n "),d.qZA(),d.TgZ(10,"div",8),d._uU(11," Servicios "),d.qZA(),d.TgZ(12,"div",9),d.YNc(13,kZ,8,3,"div",10),d.qZA()(),d.TgZ(14,"div",11)(15,"div",12)(16,"div",7),d._uU(17," \xbfQuieres solicitar nuestros servicios? "),d.qZA()(),d.TgZ(18,"div",13)(19,"button",14),d._uU(20," Contacta con nosotros "),d.qZA()()()()),2&t&&(d.xp6(13),d.Q6J("ngForOf",i.vDatos))},dependencies:[ur],styles:[".servicios-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;padding:100px 40px;width:calc(100% - 80px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:36px;min-width:800px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 25% 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:30px;min-width:500px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 25% 30px;border-bottom:1px solid var(--principal-color-80)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:center;gap:50px;flex-direction:row;flex-wrap:wrap;min-width:950px;width:100%;margin-top:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{min-width:270px;max-width:330px;width:27%;background-color:var(--principal-color-light);box-shadow:1px 2px 4px var(--principal-color-light-40);border-radius:10px;padding:30px 20px;display:flex;align-items:flex-start;justify-self:flex-start;flex-direction:column;gap:30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:flex-start;flex-direction:row;gap:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:30px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;gap:10px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]{padding:50px 0 100px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:36px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]{text-align:center}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]{font-size:20px;color:var(--principal-color);background-color:var(--principal-color-light);border:1px solid var(--principal-color);border-radius:10px;padding:10px 20px;margin-top:20px;cursor:pointer;transition:all .3s ease-in-out}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]:hover{background-color:var(--principal-color);color:var(--principal-color-light)}@media screen and (min-width: 600px) and (max-width: 959px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;width:calc(100% - 16px);padding:8px 20px}}@media screen and (max-width: 599px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{padding:100px 5px;width:calc(100% - 10px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{min-width:100%;padding:0 10px 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{min-width:100%;padding-left:0;padding-right:0}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{min-width:100%}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{width:100%}}"]}),n})();function FZ(n,e){if(1&n&&(d.TgZ(0,"div",22),d._UZ(1,"img",23),d.TgZ(2,"span"),d._uU(3),d.qZA()()),2&n){const t=e.$implicit;d.xp6(3),d.hij(" ",t," ")}}function LZ(n,e){if(1&n&&(d.TgZ(0,"div",15)(1,"div",16)(2,"div",17),d._UZ(3,"img",18),d.qZA(),d.TgZ(4,"div",19),d._uU(5),d.qZA()(),d.TgZ(6,"div",20),d.YNc(7,FZ,4,1,"div",21),d.qZA()()),2&n){const t=e.$implicit;d.xp6(3),d.Q6J("src",t.iconPath,d.LSH),d.xp6(2),d.hij(" ",t.titulo," "),d.xp6(2),d.Q6J("ngForOf",t.datos)}}let NZ=(()=>{class n{constructor(){this.vControlHorarios=["Horarios","Horas","App"],this.vControlProveedores=["Pedidos","Control de stock","Proveedores","App"],this.vGestionCartas=["Cartas","Digitalizacion de cartas","Inventarios","Escandallos","App"],this.vPersonal=["Charlas","Formaci\xf3n participativa","Organizaci\xf3n y gesti\xf3n del equipo"],this.vServicio=["Al\xe9rgenos","Gesti\xf3n antes y despu\xe9s del servicio","Gesti\xf3n de reservas","Organizaci\xf3n de mesas","Tiempos","Tipos de comanda","Tipos de servicios","App"],this.vGestionEventos=["Men\xfas","App"],this.vDatos=[{titulo:"Gesti\xf3n y control de horarios y horas",iconPath:"../../../assets/icons/icon-clock.png",datos:this.vControlHorarios},{titulo:"Gesti\xf3n y control de proveedores y stock",iconPath:"../../../assets/icons/icon-stock.png",datos:this.vControlProveedores},{titulo:"Gesti\xf3n y organizaci\xf3n de cartas",iconPath:"../../../assets/icons/icon-message.png",datos:this.vGestionCartas},{titulo:"Selecci\xf3n y formaci\xf3n del personal",iconPath:"../../../assets/icons/icon-person.png",datos:this.vPersonal},{titulo:"Gesti\xf3n y organizacion del servicio",iconPath:"../../../assets/icons/icon-service.png",datos:this.vServicio},{titulo:"Organizaci\xf3n y gesti\xf3n de eventos",iconPath:"../../../assets/icons/icon-events.png",datos:this.vGestionEventos}]}ngOnInit(){window.scroll({top:0,left:0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-gestion-participativa-sala"]],decls:21,vars:1,consts:[[1,"servicios-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"servicios-items-container"],[1,"title"],[1,"subtitle"],[1,"listado-servicios"],["class","item-list",4,"ngFor","ngForOf"],[1,"solicita-nuestros-servicios"],[1,"texto"],[1,"boton"],[1,"boton-contacta-con-nosotros"],[1,"item-list"],[1,"title-item-list"],[1,"icon"],[3,"src"],[1,"text"],[1,"content-item-list"],["class","item-content-item-list",4,"ngFor","ngForOf"],[1,"item-content-item-list"],["src","../../../assets/icons/check.png"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),d._UZ(4,"img",4),d.qZA(),d.TgZ(5,"h1",5),d._uU(6,"ASISTENTE PROFESIONAL DE HOSTELER\xcdA"),d.qZA()()(),d.TgZ(7,"div",6)(8,"div",7),d._uU(9," A/Gesti\xf3n Participativa de Sala "),d.qZA(),d.TgZ(10,"div",8),d._uU(11," Servicios "),d.qZA(),d.TgZ(12,"div",9),d.YNc(13,LZ,8,3,"div",10),d.qZA()(),d.TgZ(14,"div",11)(15,"div",12)(16,"div",7),d._uU(17," \xbfQuieres solicitar nuestros servicios? "),d.qZA()(),d.TgZ(18,"div",13)(19,"button",14),d._uU(20," Contacta con nosotros "),d.qZA()()()()),2&t&&(d.xp6(13),d.Q6J("ngForOf",i.vDatos))},dependencies:[ur],styles:[".servicios-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;padding:100px 40px;width:calc(100% - 80px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:36px;min-width:800px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 25% 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:30px;min-width:500px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 25% 30px;border-bottom:1px solid var(--principal-color-80)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:center;gap:50px;flex-direction:row;flex-wrap:wrap;min-width:950px;width:100%;margin-top:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{min-width:270px;max-width:330px;width:27%;background-color:var(--principal-color-light);box-shadow:1px 2px 4px var(--principal-color-light-40);border-radius:10px;padding:30px 20px;display:flex;align-items:flex-start;justify-self:flex-start;flex-direction:column;gap:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:flex-start;flex-direction:row;gap:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:22px;text-align:start;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;gap:10px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]{padding:50px 0 100px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:36px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]{text-align:center}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]{font-size:20px;color:var(--principal-color);background-color:var(--principal-color-light);border:1px solid var(--principal-color);border-radius:10px;padding:10px 20px;margin-top:20px;cursor:pointer;transition:all .3s ease-in-out}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]:hover{background-color:var(--principal-color);color:var(--principal-color-light)}@media screen and (min-width: 600px) and (max-width: 959px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;width:calc(100% - 16px);padding:8px 20px}}@media screen and (max-width: 599px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{padding:100px 5px;width:calc(100% - 10px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{min-width:100%;padding:0 10px 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{min-width:100%;padding-left:0;padding-right:0}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{min-width:100%}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{width:100%}}"]}),n})(),JR=(()=>{class n{constructor(){}getLocalLinks(){return[{name:"Inicio",path:"home"},{name:"Servicios",path:"servicios"},{name:"Sobre Hasspro",path:"sobre-hasspro"},{name:"Contacto",path:"contacto"}]}getServiciosLinks(){return[{name:"A/Gesti\xf3n de la Documentaci\xf3n",path:"/servicios/gestion-documentacion"},{name:"A/Gesti\xf3n Participativa de Sala",path:"/servicios/gestion-participativa-sala"},{name:"Consultor\xeda Financiera",path:"/servicios/consultoria-financiera"}]}getLegalLinks(){return[{name:"Pol\xedtica de privacidad",path:""},{name:"T\xe9rminos y condiciones",path:""},{name:"Pol\xedtica de cookies",path:""}]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function zZ(n,e){if(1&n&&(d.TgZ(0,"div",6)(1,"a",7),d._uU(2),d.qZA()()),2&n){const t=e.$implicit;d.xp6(1),d.Q6J("routerLink",t.path),d.xp6(1),d.Oqu(t.name)}}function BZ(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"div",8),d.NdJ("click",function(){d.CHM(t);const r=d.oxw();return d.KtG(r.menuMobileOpened=!1)}),d.TgZ(1,"a",9),d._uU(2),d.qZA()()}if(2&n){const t=e.$implicit;d.xp6(1),d.Q6J("routerLink",t.path),d.xp6(1),d.Oqu(t.name)}}const VZ=function(n){return{"not-in-top":n}},UZ=function(n){return{"menu-mobile-button-opened":n}},jZ=function(n){return{"link-mobile-menu-opened":n}};let $Z=(()=>{class n{constructor(t){this.localDataService=t,this.vLocalLinks=[],this.menuMobileOpened=!1,this.notInTop=!1}ngOnInit(){this.vLocalLinks=this.localDataService.getLocalLinks()}onScroll(t){this.notInTop=window.pageYOffset>50}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(JR))},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-header"]],hostBindings:function(t,i){1&t&&d.NdJ("scroll",function(s){return i.onScroll(s)},!1,d.Jf7)},decls:6,vars:11,consts:[[1,"toolbar",3,"ngClass"],[1,"link-container"],["class","link",4,"ngFor","ngForOf"],[1,"menu-mobile-button",3,"ngClass","click"],[1,"link-mobile-container",3,"ngClass"],["class","link-mobile",3,"click",4,"ngFor","ngForOf"],[1,"link"],["routerLinkActive","link-active",3,"routerLink"],[1,"link-mobile",3,"click"],[3,"routerLink"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"div",1),d.YNc(2,zZ,3,2,"div",2),d.qZA(),d.TgZ(3,"div",3),d.NdJ("click",function(){return i.menuMobileOpened=!i.menuMobileOpened}),d.qZA(),d.TgZ(4,"div",4),d.YNc(5,BZ,3,2,"div",5),d.qZA()()),2&t&&(d.Q6J("ngClass",d.VKq(5,VZ,i.notInTop)),d.xp6(2),d.Q6J("ngForOf",i.vLocalLinks),d.xp6(1),d.Q6J("ngClass",d.VKq(7,UZ,i.menuMobileOpened)),d.xp6(1),d.Q6J("ngClass",d.VKq(9,jZ,i.menuMobileOpened)),d.xp6(1),d.Q6J("ngForOf",i.vLocalLinks))},dependencies:[Mn,ur,om,wx],styles:['.toolbar[_ngcontent-%COMP%]{width:100%;height:60px;position:fixed;top:0;z-index:100;display:flex;align-items:center;justify-content:flex-end;flex-direction:row;transition:.4s cubic-bezier(.075,.82,.165,1) background-color}.toolbar.not-in-top[_ngcontent-%COMP%]{background-color:var(--principal-color-light);transition:.4s cubic-bezier(.075,.82,.165,1) background-color;box-shadow:2px 2px 5px var(--principal-color-light-80)}.toolbar.not-in-top[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--principal-color);transition:.4s cubic-bezier(.075,.82,.165,1) color}.toolbar.not-in-top[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .toolbar.not-in-top[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   a.link-active[_ngcontent-%COMP%]{border-bottom:1px solid var(--principal-color-80)}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;flex-direction:row;position:fixed;top:10px}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{cursor:pointer;padding:10px 20px}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--principal-color-light);font-size:1.1em;font-weight:500;text-decoration:none;text-shadow:1px 1px 2px var(--principal-color-light-20);border-bottom:1px solid transparent;padding-bottom:4px;transition:border-bottom .3s linear;transition:.4s cubic-bezier(.075,.82,.165,1) color}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   a.link-active[_ngcontent-%COMP%]{border-bottom:1px solid var(--principal-color-light-80)}.toolbar[_ngcontent-%COMP%]   .link-mobile-container[_ngcontent-%COMP%]{display:none}@media screen and (min-width: 600px) and (max-width: 959px){.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]{display:none}.toolbar[_ngcontent-%COMP%]   .link-mobile-container[_ngcontent-%COMP%]{display:flex}}@media screen and (max-width: 959px){.toolbar[_ngcontent-%COMP%]{background-color:var(--principal-color-light)}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button[_ngcontent-%COMP%]{width:30px;height:3px;background:var(--principal-color);margin-right:30px;border-radius:50px;transition:all .3s linear;position:relative;z-index:10;transition:.15s linear transform}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button[_ngcontent-%COMP%]:after, .toolbar[_ngcontent-%COMP%]   .menu-mobile-button[_ngcontent-%COMP%]:before{position:absolute;content:"";width:30px;height:3px;background:var(--principal-color);border-radius:50px;transition:.15s linear transform}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button[_ngcontent-%COMP%]:after{top:10px}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button[_ngcontent-%COMP%]:before{top:-10px}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button.menu-mobile-button-opened[_ngcontent-%COMP%]{background-color:transparent}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button.menu-mobile-button-opened[_ngcontent-%COMP%]:after{transform:rotate(45deg) translateY(-8px) translate(-6px);transition:.15s linear transform}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button.menu-mobile-button-opened[_ngcontent-%COMP%]:before{transform:rotate(-45deg) translateY(8px) translate(-6px);transition:.15s linear transform}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]{display:none}.toolbar[_ngcontent-%COMP%]   .link-mobile-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;box-shadow:0 3px 10px var(--principal-color);position:absolute;top:0;left:0;width:100%;height:0px;background-color:var(--principal-color-light);transition:.3s cubic-bezier(.075,.82,.165,1) all .2s}.toolbar[_ngcontent-%COMP%]   .link-mobile-container.link-mobile-menu-opened[_ngcontent-%COMP%]{border-bottom:2px solid var(--principal-color);height:500px;transition:.3s cubic-bezier(.075,.82,.165,1) all}.toolbar[_ngcontent-%COMP%]   .link-mobile-container.link-mobile-menu-opened[_ngcontent-%COMP%]   .link-mobile[_ngcontent-%COMP%]{font-size:24px!important;transition:.2s cubic-bezier(.075,.82,.165,1) all .3s}.toolbar[_ngcontent-%COMP%]   .link-mobile-container[_ngcontent-%COMP%]   .link-mobile[_ngcontent-%COMP%]{font-size:0px;text-shadow:1px 1px 2px var(--principal-color-40);transition:.2s cubic-bezier(.075,.82,.165,1) all}.toolbar[_ngcontent-%COMP%]   .link-mobile-container[_ngcontent-%COMP%]   .link-mobile[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:var(--principal-color)}}']}),n})();function GZ(n,e){if(1&n&&(d.TgZ(0,"div",16),d._uU(1),d.qZA()),2&n){const t=e.$implicit;d.Q6J("routerLink",t.path),d.xp6(1),d.hij(" ",t.name," ")}}function HZ(n,e){if(1&n&&(d.TgZ(0,"div",16),d._uU(1),d.qZA()),2&n){const t=e.$implicit;d.Q6J("routerLink",t.path),d.xp6(1),d.hij(" ",t.name," ")}}function qZ(n,e){if(1&n&&(d.TgZ(0,"div",16),d._uU(1),d.qZA()),2&n){const t=e.$implicit;d.Q6J("routerLink",t.path),d.xp6(1),d.hij(" ",t.name," ")}}let WZ=(()=>{class n{constructor(t){this.localDataService=t,this.vLinks=[],this.vLinksServicios=[],this.vLegalLinks=[]}ngOnInit(){this.vLinks=this.localDataService.getLocalLinks(),this.vLegalLinks=this.localDataService.getLegalLinks(),this.vLinksServicios=this.localDataService.getServiciosLinks()}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(JR))},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-footer"]],decls:32,vars:3,consts:[[1,"footer-container"],[1,"data-container"],[1,"links-list"],["class","link-item",3,"routerLink",4,"ngFor","ngForOf"],[1,"address"],[1,"content"],[1,"item"],[1,"icon"],["src","../../../assets/icons/location-color-principal.png"],[1,"text"],["src","../../../assets/icons/email-color-principal.png"],["src","../../../assets/icons/phone-color-principal.png"],[1,"legal-links-list"],["routerLink","/private/auth-login",1,"link-item"],[1,"developer-container"],["href","https://sergiogdev.com/"],[1,"link-item",3,"routerLink"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"div",1)(2,"div",2),d.YNc(3,GZ,2,2,"div",3),d.qZA(),d.TgZ(4,"div",2),d.YNc(5,HZ,2,2,"div",3),d.qZA(),d.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7),d._UZ(10,"img",8),d.qZA(),d.TgZ(11,"div",9),d._uU(12," Ronda del Carmen, 13. C\xe1ceres (CP: 10002) "),d.qZA()(),d.TgZ(13,"div",6)(14,"div",7),d._UZ(15,"img",10),d.qZA(),d.TgZ(16,"div",9),d._uU(17," contacto@hasspro.es "),d.qZA()(),d.TgZ(18,"div",6)(19,"div",7),d._UZ(20,"img",11),d.qZA(),d.TgZ(21,"div",9),d._uU(22," 640 90 36 70 "),d.qZA()()()(),d.TgZ(23,"div",12),d.YNc(24,qZ,2,2,"div",3),d.TgZ(25,"div",13),d._uU(26," Secci\xf3n privada "),d.qZA()()(),d.TgZ(27,"div",14)(28,"div",9),d._uU(29," Hecho con \u2764\ufe0f por "),d.TgZ(30,"a",15),d._uU(31,"SergioGDev \xa9"),d.qZA()()()()),2&t&&(d.xp6(3),d.Q6J("ngForOf",i.vLinks),d.xp6(2),d.Q6J("ngForOf",i.vLinksServicios),d.xp6(19),d.Q6J("ngForOf",i.vLegalLinks))},dependencies:[ur,om],styles:[".footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;flex-wrap:wrap;gap:20px;padding:30px;background-color:var(--principal-color-light)}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .links-list[_ngcontent-%COMP%]{width:25%}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .links-list[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:var(--principal-color);cursor:pointer;padding:5px 20px}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .links-list[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]:hover{text-shadow:1px 1px 1px var(--principal-color-20)}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{width:40%;display:flex;align-items:center;justify-content:center;flex-direction:column}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:center;flex-direction:column;gap:16px}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;gap:30px}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:32px;height:32px;color:var(--principal-color)}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px;height:32px}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:16px;color:var(--principal-color)}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .legal-links-list[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;flex-direction:row;flex-wrap:wrap;gap:20px}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .legal-links-list[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:var(--principal-color);cursor:pointer;padding:5px 20px}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .legal-links-list[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]:hover{text-shadow:1px 1px 1px var(--principal-color-20)}.footer-container[_ngcontent-%COMP%]   .developer-container[_ngcontent-%COMP%]{text-align:center;padding:30px;background-color:var(--principal-color-light-oscuro);color:var(--principal-color)}.footer-container[_ngcontent-%COMP%]   .developer-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--principal-color);text-shadow:1px 1px 1px var(--principal-color-20);text-decoration:none}@media screen and (min-width: 600px) and (max-width: 959px){.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .links-list[_ngcontent-%COMP%], .footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%], .footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .legal-links-list[_ngcontent-%COMP%]{width:100%}}@media screen and (max-width: 599px){.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .links-list[_ngcontent-%COMP%], .footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{width:100%}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .legal-links-list[_ngcontent-%COMP%]{width:100%;gap:10px}}"]}),n})(),ZZ=(()=>{class n{constructor(t){this.localDataService=t,this.vLocalLinks=[],this.menuMobileOpened=!1}ngOnInit(){this.vLocalLinks=this.localDataService.getLocalLinks()}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(JR))},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-home-layout"]],decls:7,vars:0,consts:[[1,"layout-container"],[1,"header"],[1,"content"],[1,"footbar"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"div",1),d._UZ(2,"app-header"),d.qZA(),d.TgZ(3,"div",2),d._UZ(4,"router-outlet"),d.qZA(),d.TgZ(5,"div",3),d._UZ(6,"app-footer"),d.qZA()())},dependencies:[Qu,$Z,WZ],styles:[".layout-container[_ngcontent-%COMP%]{width:100%}"]}),n})();function YZ(n,e){if(1&n&&(d.TgZ(0,"div",19)(1,"div",10),d._uU(2),d.qZA(),d.TgZ(3,"div",13),d._uU(4),d.qZA()()),2&n){const t=e.$implicit;d.xp6(2),d.hij(" ",t.title," "),d.xp6(2),d.hij(" ",t.text," ")}}function KZ(n,e){if(1&n&&(d.TgZ(0,"div",10),d._uU(1),d.qZA()),2&n){const t=d.oxw().$implicit;d.xp6(1),d.hij(" ",t.subtitle," ")}}function XZ(n,e){if(1&n&&(d.TgZ(0,"div",12)(1,"div",7),d._uU(2),d.qZA(),d.YNc(3,KZ,2,1,"div",20),d.TgZ(4,"div",13),d._uU(5),d.qZA(),d.TgZ(6,"div",21)(7,"button",22),d._uU(8," Ver m\xe1s "),d.qZA()()()),2&n){const t=e.$implicit;d.xp6(2),d.hij(" ",t.title," "),d.xp6(1),d.Q6J("ngIf",t.subtitle),d.xp6(2),d.hij(" ",t.text," "),d.xp6(2),d.Q6J("routerLink",t.path)}}let QZ=(()=>{class n{constructor(){this.vServicios=[{title:"1\xba.-Realizamos un Estudio inicial participativo sin compromiso:",text:"Para poder conocer la situaci\xf3n en la que se encuentra cada local, as\xed como la documentaci\xf3n tratada y  gestionada."},{title:"2\xba.- Ofrecemos un presupuesto personalizado:",text:"Plantearemos los diferentes problemas y aplicaremos los mecanismos necesarios para optimizar y garantizar los diferentes procesos, acorde a las necesidades de cada negocio."},{title:"3\xba.-Realizamos el servicio acordado con profesionalidad, personalizado y con rigor.",text:"Establecemos un sello exclusivo de calidad, exigiendo rigor en su cumplimiento."}],this.vNuestrosServicios=[{title:"A/Gesti\xf3n de la documentaci\xf3n",text:"Tramitamos toda la documentaci\xf3n necesaria para tu establecimiento. Te asesoramos y realizamos todo tipo de gestiones ajust\xe1ndolas a los par\xe1metros de tu negocio con el fin de obtener una mayor viabilidad del mismo.",path:"/servicios/gestion-documentacion"},{title:"A/Gesti\xf3n participativa de sala",text:"Ofrecemos una mejora de los servicios y la optimizaci\xf3n de los procesos y recursos de los que disponga la empresa. Te asesoramos y adaptamos nuevos m\xe9todos de trabajo, gesti\xf3n, formaci\xf3n del equipo o mejora de los servicios, entre otros.",path:"/servicios/gestion-participativa-sala"},{title:"Consultor\xeda financiera",subtitle:"Particulares - Aut\xf3nomos - PYMES",text:"Lo m\xe1s importante de un buen asesoramiento es que puedes entender cada paso. Para ello te vamos a explicar hasta el m\xe1s m\xednimo detalle de por qu\xe9 recomendamos una soluci\xf3n financiera espec\xedfica y en qu\xe9 medida se adapta esta soluci\xf3n a tus necesidades particulares ",path:"/servicios/consultoria-financiera"}]}ngOnInit(){window.scroll({top:0,left:0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-servicios"]],decls:30,vars:2,consts:[[1,"servicios-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"como-trabajamos-container"],[1,"title"],["class","como-trabajamos-item",4,"ngFor","ngForOf"],[1,"nuestros-servicios-container"],[1,"subtitle"],[1,"items-nuestros-servicios"],[1,"item-nuestros-servicios"],[1,"text"],["class","item-nuestros-servicios",4,"ngFor","ngForOf"],[1,"solicita-nuestros-servicios"],[1,"texto"],[1,"boton"],[1,"boton-contacta-con-nosotros"],[1,"como-trabajamos-item"],["class","subtitle",4,"ngIf"],[1,"ver-mas"],[3,"routerLink"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),d._UZ(4,"img",4),d.qZA(),d.TgZ(5,"h1",5),d._uU(6,"ASISTENTE PROFESIONAL DE HOSTELER\xcdA"),d.qZA()()(),d.TgZ(7,"div",6)(8,"div",7),d._uU(9,"\xbfC\xf3mo trabajamos?"),d.qZA(),d.YNc(10,YZ,5,2,"div",8),d.qZA(),d.TgZ(11,"div",9)(12,"div",7),d._uU(13,"Nuestros servicios"),d.qZA(),d.TgZ(14,"div",10),d._uU(15,"Trabajamos para que tu negocio triunfe"),d.qZA(),d.TgZ(16,"div",11)(17,"div",12)(18,"div",7),d._uU(19," Estudio inicial participativo SIN COMPROMISO "),d.qZA(),d.TgZ(20,"div",13),d._uU(21," Cont\xe1ctenos y analizaremos la situaci\xf3n de tu negocio. Te ofrecemos un estudio inicial participativo sin compromiso en el que estudiaremos los diferentes servicios y t\xe9cnicas que mejor se adapten a tu situaci\xf3n, ayud\xe1ndote a incorporar nuevas rutinas y formas de trabajo que garanticen el \xe9xito y la durabilidad de tu establecimiento. "),d.qZA()(),d.YNc(22,XZ,9,4,"div",14),d.qZA()(),d.TgZ(23,"div",15)(24,"div",16)(25,"div",7),d._uU(26," \xbfQuieres solicitar nuestros servicios? "),d.qZA()(),d.TgZ(27,"div",17)(28,"button",18),d._uU(29," Contacta con nosotros "),d.qZA()()()()),2&t&&(d.xp6(10),d.Q6J("ngForOf",i.vServicios),d.xp6(12),d.Q6J("ngForOf",i.vNuestrosServicios))},dependencies:[ur,Bo,om],styles:[".servicios-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:50px;flex-wrap:wrap;width:calc(100% - 180px);padding:50px 50px 100px;margin:70px 40px 20px;background-color:var(--principal-color-light-80);border-radius:5px;box-shadow:2px 2px 4px var(--principal-color-light)}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:36px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 25% 30px;border-bottom:1px solid var(--principal-color-80)}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]   .como-trabajamos-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:10px;flex-direction:column;max-width:800px}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]   .como-trabajamos-item[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-weight:900;font-size:20px;text-align:center;color:var(--principal-color);text-shadow:1px 2px 2px var(--principal-color-20)}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]   .como-trabajamos-item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:18px;text-align:center;color:var(--principal-color)}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;flex-wrap:wrap;gap:20px;width:calc(100% - 180px);padding:50px 50px 100px;margin:20px 40px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:36px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 25%}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:24px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10% 30px;border-bottom:1px solid var(--principal-color-80);text-align:center}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;flex-wrap:wrap;gap:20px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;width:40%;padding:40px;min-height:380px;background-color:var(--principal-color-light-80);border-radius:5px;box-shadow:2px 2px 4px var(--principal-color-light)}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]:first-child{width:75%;min-height:250px;gap:40px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%], .servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:var(--principal-color);width:100%;text-align:center}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:28px;font-weight:900;text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:24px;font-weight:700;border-bottom:none;text-shadow:1px 1px 2px var(--principal-color-20)}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:18px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .ver-mas[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:var(--principal-color);color:var(--principal-color-light);border:none;border-radius:5px;padding:10px 20px;font-size:18px;font-weight:700;cursor:pointer;transition:all .3s ease-in-out;margin-top:30px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]{padding:50px 0 100px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:36px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]{text-align:center}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]{font-size:20px;color:var(--principal-color);background-color:var(--principal-color-light);border:1px solid var(--principal-color);border-radius:10px;padding:10px 20px;margin-top:20px;cursor:pointer;transition:all .3s ease-in-out}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]:hover{background-color:var(--principal-color);color:var(--principal-color-light)}@media screen and (min-width: 600px) and (max-width: 959px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]{padding:50px 20px 100px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]{width:90%}}@media screen and (max-width: 599px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]{width:calc(100% - 40px);padding:50px 10px 100px;margin:20px 10px}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding:0 10px 30px;text-align:center}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]{width:calc(100% - 40px);padding:50px 10px 100px;margin:20px 10px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding:0}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{padding:0 0 30px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]{width:100%!important;padding:40px 10px!important}}"]}),n})(),JZ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-desarrollo-establecimientos"]],decls:7,vars:0,consts:[[1,"servicios-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),d._UZ(4,"img",4),d.qZA(),d.TgZ(5,"h1",5),d._uU(6,"ASISTENTE PROFESIONAL DE HOSTELER\xcdA"),d.qZA()()()())}}),n})();function e7(n,e){if(1&n&&(d.TgZ(0,"div",15)(1,"div",16)(2,"div",17),d._UZ(3,"img",18),d.qZA(),d.TgZ(4,"div",19),d._uU(5),d.qZA()()()),2&n){const t=e.$implicit;d.xp6(3),d.Q6J("src",t.iconPath,d.LSH),d.xp6(2),d.hij(" ",t.titulo," ")}}let t7=(()=>{class n{constructor(){this.vDatos=[{titulo:"Planificaci\xf3n Financiera",iconPath:"../../../assets/icons/icon-planificacion-financiera.png",datos:[]},{titulo:"Estrategias de Ahorro",iconPath:"../../../assets/icons/icon-estrategia-ahorro.png",datos:[]},{titulo:"Inversiones",iconPath:"../../../assets/icons/icon-inversiones.png",datos:[]},{titulo:"Acortamiento de Hipotecas",iconPath:"../../../assets/icons/icon-acortamiento-hipotecas.png",datos:[]},{titulo:"Pensiones / Jubilaci\xf3n",iconPath:"../../../assets/icons/icon-pensiones-jubilacion.png",datos:[]},{titulo:"B\xfasqueda de Financiaci\xf3n y Seguros",iconPath:"../../../assets/icons/icon-busqueda-financiacion.png",datos:[]}]}ngOnInit(){window.scroll({top:0,left:0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-consultoria-financiera"]],decls:21,vars:1,consts:[[1,"servicios-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"servicios-items-container"],[1,"title"],[1,"subtitle"],[1,"listado-servicios"],["class","item-list",4,"ngFor","ngForOf"],[1,"solicita-nuestros-servicios"],[1,"texto"],[1,"boton"],[1,"boton-contacta-con-nosotros"],[1,"item-list"],[1,"title-item-list"],[1,"icon"],[3,"src"],[1,"text"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),d._UZ(4,"img",4),d.qZA(),d.TgZ(5,"h1",5),d._uU(6,"ASISTENTE PROFESIONAL DE HOSTELER\xcdA"),d.qZA()()(),d.TgZ(7,"div",6)(8,"div",7),d._uU(9," Consultor\xeda Financiera "),d.qZA(),d.TgZ(10,"div",8),d._uU(11," Servicios "),d.qZA(),d.TgZ(12,"div",9),d.YNc(13,e7,6,2,"div",10),d.qZA()(),d.TgZ(14,"div",11)(15,"div",12)(16,"div",7),d._uU(17," \xbfQuieres solicitar nuestros servicios? "),d.qZA()(),d.TgZ(18,"div",13)(19,"button",14),d._uU(20," Contacta con nosotros "),d.qZA()()()()),2&t&&(d.xp6(13),d.Q6J("ngForOf",i.vDatos))},dependencies:[ur],styles:[".servicios-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;padding:100px 40px;width:calc(100% - 80px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:36px;min-width:800px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 25% 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:30px;min-width:500px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 25% 30px;border-bottom:1px solid var(--principal-color-80)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:50px;flex-direction:row;flex-wrap:wrap;min-width:950px;width:100%;margin-top:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{min-width:270px;max-width:330px;height:60px;width:27%;background-color:var(--principal-color-light);box-shadow:1px 2px 4px var(--principal-color-light-40);border-radius:10px;padding:30px 20px;display:flex;align-items:flex-start;justify-content:center;flex-direction:column;gap:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:flex-start;flex-direction:row;gap:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:22px;text-align:start;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;gap:10px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]{padding:50px 0 100px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:36px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]{text-align:center}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]{font-size:20px;color:var(--principal-color);background-color:var(--principal-color-light);border:1px solid var(--principal-color);border-radius:10px;padding:10px 20px;margin-top:20px;cursor:pointer;transition:all .3s ease-in-out}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]:hover{background-color:var(--principal-color);color:var(--principal-color-light)}@media screen and (min-width: 600px) and (max-width: 959px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{padding:100px 5px;width:calc(100% - 10px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{min-width:100%;padding:0 10px 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{min-width:100%;padding-left:0;padding-right:0}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{min-width:100%}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{width:100%}}@media screen and (max-width: 599px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{padding:100px 5px;width:calc(100% - 10px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{min-width:100%;padding:0 10px 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{min-width:100%;padding-left:0;padding-right:0}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{min-width:100%}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{width:100%}}"]}),n})(),e2=(()=>{class n{constructor(t,i,r,s){this.firestore=t,this.db=i,this.auth=r,this.router=s}register(t,i){return this.auth.createUserWithEmailAndPassword(t,i)}login(t,i){return this.auth.signInWithEmailAndPassword(t,i)}logout(){return localStorage.removeItem("hasspro_internal_token"),this.auth.signOut()}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(qE),d.LFG(H3),d.LFG(YR),d.LFG(Oo))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function n7(n,e){1&n&&(d.TgZ(0,"div",11),d._uU(1," * El email es obligatorio "),d.qZA())}function i7(n,e){1&n&&(d.TgZ(0,"div",11),d._uU(1," * La contrase\xf1a es obligatoria "),d.qZA())}function r7(n,e){1&n&&(d.TgZ(0,"div",12),d._uU(1," Error: Usuario / contrase\xf1a no existentes "),d.qZA())}let t2,o7=(()=>{class n{constructor(t,i,r){this.fb=t,this.authService=i,this.router=r,this.loging=!1,this.errorLogin=!1,this.formularioLogin=this.fb.group({email:["",[du.required,du.email]],password:["",[du.required,du.minLength(6)]]})}ngOnInit(){}onSubmit(){if(this.formularioLogin.invalid)return void this.formularioLogin.markAllAsTouched();this.loging=!0;const{email:t,password:i}=this.formularioLogin.value;this.authService.login(t,i).then(r=>{localStorage.setItem("hasspro_internal_token",r.user.uid),this.loging=!1,this.router.navigateByUrl("/private/email-list")},r=>{console.log(r),this.loging=!1,this.errorLogin=!0})}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(w),d.Y36(e2),d.Y36(Oo))},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-login"]],decls:19,vars:6,consts:[[1,"login-container"],[1,"form-container"],[3,"formGroup","submit"],[1,"input-group"],["for","nombre"],["type","text","id","email","formControlName","email"],["class","input-error",4,"ngIf"],["type","password","id","password","formControlName","password"],["class","correo-enviado-error",4,"ngIf"],[1,"submit-container"],["type","submit",3,"disabled"],[1,"input-error"],[1,"correo-enviado-error"]],template:function(t,i){if(1&t&&(d.TgZ(0,"div",0)(1,"div",1)(2,"h2"),d._uU(3,"Hasspro - Secci\xf3n privada"),d.qZA(),d.TgZ(4,"form",2),d.NdJ("submit",function(){return i.onSubmit()}),d.TgZ(5,"div",3)(6,"label",4),d._uU(7,"Email"),d.qZA(),d._UZ(8,"input",5),d.YNc(9,n7,2,0,"div",6),d.qZA(),d.TgZ(10,"div",3)(11,"label",4),d._uU(12,"Password"),d.qZA(),d._UZ(13,"input",7),d.YNc(14,i7,2,0,"div",6),d.qZA(),d.YNc(15,r7,2,0,"div",8),d.TgZ(16,"div",9)(17,"button",10),d._uU(18),d.qZA()()()()()),2&t){let r,s;d.xp6(4),d.Q6J("formGroup",i.formularioLogin),d.xp6(5),d.Q6J("ngIf",(null==(r=i.formularioLogin.get("email"))?null:r.touched)&&null!==(null==(r=i.formularioLogin.get("email"))?null:r.errors)),d.xp6(5),d.Q6J("ngIf",(null==(s=i.formularioLogin.get("password"))?null:s.touched)&&null!==(null==(s=i.formularioLogin.get("password"))?null:s.errors)),d.xp6(1),d.Q6J("ngIf",i.errorLogin),d.xp6(2),d.Q6J("disabled",i.loging),d.xp6(1),d.hij(" ",i.loging?"Iniciando sesi\xf3n...":"Iniciar sesi\xf3n"," ")}},dependencies:[Bo,kg,_g,vg,hy,pl,tp],styles:[".login-container[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background-color:var(--principal-color)}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{background-color:var(--principal-color-light);padding:20px;border-radius:10px;box-shadow:0 0 10px #000000bf;width:400px}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--principal-color);text-align:center;margin-bottom:30px}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:flex-start;width:500px;max-width:100%;gap:5px;flex-direction:column}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:var(--principal-color)}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:40px;padding:0 10px;border:1px solid var(--principal-color);border-radius:5px;box-sizing:border-box;font-size:14px;font-weight:700;color:var(--principal-color)}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;height:100px;padding:10px;border:1px solid var(--principal-color);border-radius:5px;box-sizing:border-box;font-size:14px;font-weight:700;resize:none;color:var(--principal-color)}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-error[_ngcontent-%COMP%]{color:red;font-size:12px}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;padding-top:10px}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:200px;height:40px;border:none;border-radius:5px;background-color:var(--principal-color);color:var(--white-color);font-size:16px;font-weight:700;cursor:pointer}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:var(--principal-color-light);color:var(--principal-color);border:2px solid var(--principal-color)}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .correo-enviado-error[_ngcontent-%COMP%]{text-align:center;background-color:#eccbcb;width:90%;color:#000;font-size:14px;padding:10px;margin-top:10px;border-radius:10px;box-shadow:2px 2px 4px #00000020}"]}),n})();try{t2=typeof Intl<"u"&&Intl.v8BreakIterator}catch{t2=!1}let KE,IM,Fb,n2,ec=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function Mu(n){return n===eo}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!t2)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(d.Lbi))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function XE(n){return function s7(){if(null==KE&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>KE=!0}))}finally{KE=KE||!1}return KE}()?n:!!n.capture}function W3(){if(null==Fb){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Fb=!1,Fb;if("scrollBehavior"in document.documentElement.style)Fb=!0;else{const n=Element.prototype.scrollTo;Fb=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Fb}function QE(){if("object"!=typeof document||!document)return 0;if(null==IM){const n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),IM=0,0===n.scrollLeft&&(n.scrollLeft=1,IM=0===n.scrollLeft?1:2),n.remove()}return IM}function dv(n){return n.composedPath?n.composedPath()[0]:n.target}function r2(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function u1(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}function a2(n,e=BE){return(0,Xe.e)((t,i)=>{let r=null,s=null,f=null;const b=()=>{if(r){r.unsubscribe(),r=null;const O=s;s=null,i.next(O)}};function I(){const O=f+n,V=e.now();if(V<O)return r=this.schedule(void 0,O-V),void i.add(r);b()}t.subscribe((0,ve.x)(i,O=>{s=O,f=e.now(),r||(r=e.schedule(I,n),i.add(r))},()=>{b(),i.complete()},void 0,()=>{s=r=null}))})}function Q3(n){return Yt((e,t)=>n<=t)}var w7=Ae(5032);function qo(n){return(0,Xe.e)((e,t)=>{(0,Ut.Xf)(n).subscribe((0,ve.x)(t,()=>t.complete(),w7.Z)),!t.closed&&e.subscribe(t)})}function os(n){return null!=n&&"false"!=`${n}`}function m_(n,e=0){return J3(n)?Number(n):e}function J3(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}function DM(n){return Array.isArray(n)?n:[n]}function Sa(n){return null==n?"":"string"==typeof n?n:`${n}px`}function Lb(n){return n instanceof d.SBq?n.nativeElement:n}let eV=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),C7=(()=>{class n{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,i)=>this._cleanupObserver(i))}observe(t){const i=Lb(t);return new L.y(r=>{const f=this._observeElement(i).subscribe(r);return()=>{f.unsubscribe(),this._unobserveElement(i)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const i=new g.x,r=this._mutationObserverFactory.create(s=>i.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:i,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:i,stream:r}=this._observedElements.get(t);i&&i.disconnect(),r.complete(),this._observedElements.delete(t)}}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(eV))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),E7=(()=>{class n{get disabled(){return this._disabled}set disabled(t){this._disabled=os(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=m_(t),this._subscribe()}constructor(t,i,r){this._contentObserver=t,this._elementRef=i,this._ngZone=r,this.event=new d.vpe,this._disabled=!1,this._currentSubscription=null}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(a2(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(C7),d.Y36(d.SBq),d.Y36(d.R0b))},n.\u0275dir=d.lG2({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),tV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[eV]}),n})();const nV=new Set;let d1,T7=(()=>{class n{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):S7}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function I7(n){if(!nV.has(n))try{d1||(d1=document.createElement("style"),d1.setAttribute("type","text/css"),document.head.appendChild(d1)),d1.sheet&&(d1.sheet.insertRule(`@media ${n} {body{ }}`,0),nV.add(n))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ec))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function S7(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let M7=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new g.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return iV(DM(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=Fe(iV(DM(t)).map(f=>this._registerQuery(f).observable));return s=ot(s.pipe(Yn(1)),s.pipe(Q3(1),a2(0))),s.pipe((0,ue.U)(f=>{const b={matches:!1,breakpoints:{}};return f.forEach(({matches:I,query:O})=>{b.matches=b.matches||I,b.breakpoints[O]=I}),b}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new L.y(f=>{const b=I=>this._zone.run(()=>f.next(I));return i.addListener(b),()=>{i.removeListener(b)}}).pipe(gn(i),(0,ue.U)(({matches:f})=>({query:t,matches:f})),qo(this._destroySubject)),mql:i};return this._queries.set(t,s),s}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(T7),d.LFG(d.R0b))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function iV(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}function AM(n,e){return(n.getAttribute(e)||"").match(/\S+/g)||[]}const oV="cdk-describedby-message",PM="cdk-describedby-host";let l2=0,sV=(()=>{class n{constructor(t,i){this._platform=i,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+l2++,this._document=t,this._id=(0,d.f3M)(d.AFp)+"-"+l2++}describe(t,i,r){if(!this._canBeDescribed(t,i))return;const s=c2(i,r);"string"!=typeof i?(aV(i,this._id),this._messageRegistry.set(s,{messageElement:i,referenceCount:0})):this._messageRegistry.has(s)||this._createMessageElement(i,r),this._isElementDescribedByMessage(t,s)||this._addMessageReference(t,s)}removeDescription(t,i,r){if(!i||!this._isElementNode(t))return;const s=c2(i,r);if(this._isElementDescribedByMessage(t,s)&&this._removeMessageReference(t,s),"string"==typeof i){const f=this._messageRegistry.get(s);f&&0===f.referenceCount&&this._deleteMessageElement(s)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const t=this._document.querySelectorAll(`[${PM}="${this._id}"]`);for(let i=0;i<t.length;i++)this._removeCdkDescribedByReferenceIds(t[i]),t[i].removeAttribute(PM);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(t,i){const r=this._document.createElement("div");aV(r,this._id),r.textContent=t,i&&r.setAttribute("role",i),this._createMessagesContainer(),this._messagesContainer.appendChild(r),this._messageRegistry.set(c2(t,i),{messageElement:r,referenceCount:0})}_deleteMessageElement(t){this._messageRegistry.get(t)?.messageElement?.remove(),this._messageRegistry.delete(t)}_createMessagesContainer(){if(this._messagesContainer)return;const t="cdk-describedby-message-container",i=this._document.querySelectorAll(`.${t}[platform="server"]`);for(let s=0;s<i.length;s++)i[s].remove();const r=this._document.createElement("div");r.style.visibility="hidden",r.classList.add(t),r.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&r.setAttribute("platform","server"),this._document.body.appendChild(r),this._messagesContainer=r}_removeCdkDescribedByReferenceIds(t){const i=AM(t,"aria-describedby").filter(r=>0!=r.indexOf(oV));t.setAttribute("aria-describedby",i.join(" "))}_addMessageReference(t,i){const r=this._messageRegistry.get(i);(function D7(n,e,t){const i=AM(n,e);i.some(r=>r.trim()==t.trim())||(i.push(t.trim()),n.setAttribute(e,i.join(" ")))})(t,"aria-describedby",r.messageElement.id),t.setAttribute(PM,this._id),r.referenceCount++}_removeMessageReference(t,i){const r=this._messageRegistry.get(i);r.referenceCount--,function A7(n,e,t){const r=AM(n,e).filter(s=>s!=t.trim());r.length?n.setAttribute(e,r.join(" ")):n.removeAttribute(e)}(t,"aria-describedby",r.messageElement.id),t.removeAttribute(PM)}_isElementDescribedByMessage(t,i){const r=AM(t,"aria-describedby"),s=this._messageRegistry.get(i),f=s&&s.messageElement.id;return!!f&&-1!=r.indexOf(f)}_canBeDescribed(t,i){if(!this._isElementNode(t))return!1;if(i&&"object"==typeof i)return!0;const r=null==i?"":`${i}`.trim(),s=t.getAttribute("aria-label");return!(!r||s&&s.trim()===r)}_isElementNode(t){return t.nodeType===this._document.ELEMENT_NODE}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ft),d.LFG(ec))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function c2(n,e){return"string"==typeof n?`${e||""}/${n}`:n}function aV(n,e){n.id||(n.id=`${oV}-${e}-${l2++}`)}class P7{constructor(e){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new g.x,this._typeaheadSubscription=qe.w0.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new g.x,this.change=new g.x,e instanceof d.n_E&&(this._itemChangesSubscription=e.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(vi(t=>this._pressedLetters.push(t)),a2(e),Yt(()=>this._pressedLetters.length>0),(0,ue.U)(()=>this._pressedLetters.join(""))).subscribe(t=>{const i=this._getItemsArray();for(let r=1;r<i.length+1;r++){const s=(this._activeItemIndex+r)%i.length,f=i[s];if(!this._skipPredicateFn(f)&&0===f.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,t=10){return this._pageUpAndDown={enabled:e,delta:t},this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex+this._pageUpAndDown.delta,f=this._getItemsArray().length;this._setActiveItemByIndex(s<f?s:f-1,-1);break}return;default:return void((r||u1(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),i="number"==typeof e?e:t.indexOf(e);this._activeItem=t[i]??null,this._activeItemIndex=i}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const r=(this._activeItemIndex+e*i+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const i=this._getItemsArray();if(i[e]){for(;this._skipPredicateFn(i[e]);)if(!i[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return this._items instanceof d.n_E?this._items.toArray():this._items}}class O7 extends P7{setActiveItem(e){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(e),this.activeItem&&this.activeItem.setActiveStyles()}}function cV(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function uV(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const z7=new d.OlP("cdk-input-modality-detector-options"),B7={ignoreKeys:[18,17,224,91,16]},h1=XE({passive:!0,capture:!0});let V7=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new C(null),this._lastTouchMs=0,this._onKeydown=f=>{this._options?.ignoreKeys?.some(b=>b===f.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=dv(f))},this._onMousedown=f=>{Date.now()-this._lastTouchMs<650||(this._modality.next(cV(f)?"keyboard":"mouse"),this._mostRecentTarget=dv(f))},this._onTouchstart=f=>{uV(f)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=dv(f))},this._options={...B7,...s},this.modalityDetected=this._modality.pipe(Q3(1)),this.modalityChanged=this.modalityDetected.pipe(CM()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,h1),r.addEventListener("mousedown",this._onMousedown,h1),r.addEventListener("touchstart",this._onTouchstart,h1)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,h1),document.removeEventListener("mousedown",this._onMousedown,h1),document.removeEventListener("touchstart",this._onTouchstart,h1))}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ec),d.LFG(d.R0b),d.LFG(ft),d.LFG(z7,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const U7=new d.OlP("liveAnnouncerElement",{providedIn:"root",factory:function j7(){return null}}),$7=new d.OlP("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let G7=0,H7=(()=>{class n{constructor(t,i,r,s){this._ngZone=i,this._defaultOptions=s,this._document=r,this._liveElement=t||this._createLiveElement()}announce(t,...i){const r=this._defaultOptions;let s,f;return 1===i.length&&"number"==typeof i[0]?f=i[0]:[s,f]=i,this.clear(),clearTimeout(this._previousTimeout),s||(s=r&&r.politeness?r.politeness:"polite"),null==f&&r&&(f=r.duration),this._liveElement.setAttribute("aria-live",s),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(b=>this._currentResolve=b)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,"number"==typeof f&&(this._previousTimeout=setTimeout(()=>this.clear(),f)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const t="cdk-live-announcer-element",i=this._document.getElementsByClassName(t),r=this._document.createElement("div");for(let s=0;s<i.length;s++)i[s].remove();return r.classList.add(t),r.classList.add("cdk-visually-hidden"),r.setAttribute("aria-atomic","true"),r.setAttribute("aria-live","polite"),r.id="cdk-live-announcer-"+G7++,this._document.body.appendChild(r),r}_exposeAnnouncerToModals(t){const i=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let r=0;r<i.length;r++){const s=i[r],f=s.getAttribute("aria-owns");f?-1===f.indexOf(t)&&s.setAttribute("aria-owns",f+" "+t):s.setAttribute("aria-owns",t)}}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(U7,8),d.LFG(d.R0b),d.LFG(ft),d.LFG($7,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const q7=new d.OlP("cdk-focus-monitor-default-options"),OM=XE({passive:!0,capture:!0});let u2=(()=>{class n{constructor(t,i,r,s,f){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new g.x,this._rootNodeFocusAndBlurListener=b=>{for(let O=dv(b);O;O=O.parentElement)"focus"===b.type?this._onFocus(b,O):this._onBlur(b,O)},this._document=s,this._detectionMode=f?.detectionMode||0}monitor(t,i=!1){const r=Lb(t);if(!this._platform.isBrowser||1!==r.nodeType)return c(null);const s=function l7(n){if(function a7(){if(null==n2){const n=typeof document<"u"?document.head:null;n2=!(!n||!n.createShadowRoot&&!n.attachShadow)}return n2}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),f=this._elementInfo.get(r);if(f)return i&&(f.checkChildren=!0),f.subject;const b={checkChildren:i,subject:new g.x,rootNode:s};return this._elementInfo.set(r,b),this._registerGlobalListeners(b),b.subject}stopMonitoring(t){const i=Lb(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=Lb(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([b,I])=>this._originChanged(b,i,I)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=dv(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,OM),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,OM)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(qo(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,OM),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,OM),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let f=0;f<s.length;f++)if(s[f].contains(i))return!0;return!1}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(d.R0b),d.LFG(ec),d.LFG(V7),d.LFG(ft,8),d.LFG(q7,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const hV="cdk-high-contrast-black-on-white",fV="cdk-high-contrast-white-on-black",d2="cdk-high-contrast-active";let pV=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=(0,d.f3M)(M7).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(d2,hV,fV),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(d2,hV):2===i&&t.add(d2,fV)}}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ec),d.LFG(ft))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),W7=(()=>{class n{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(pV))},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[tV]}),n})();const Z7=new d.OlP("cdk-dir-doc",{providedIn:"root",factory:function Y7(){return(0,d.f3M)(ft)}}),K7=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let g_=(()=>{class n{constructor(t){this.value="ltr",this.change=new d.vpe,t&&(this.value=function X7(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?K7.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(Z7,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),JE=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({}),n})();const Q7=["text"];function J7(n,e){if(1&n&&d._UZ(0,"mat-pseudo-checkbox",6),2&n){const t=d.oxw();d.Q6J("state",t.selected?"checked":"unchecked")("disabled",t.disabled)}}function eY(n,e){if(1&n&&d._UZ(0,"mat-pseudo-checkbox",7),2&n){const t=d.oxw();d.Q6J("disabled",t.disabled)}}function tY(n,e){if(1&n&&(d.TgZ(0,"span",8),d._uU(1),d.qZA()),2&n){const t=d.oxw();d.xp6(1),d.hij("(",t.group.label,")")}}const nY=[[["mat-icon"]],"*"],iY=["mat-icon","*"];let rY=(()=>{class n{}return n.STANDARD_CURVE="cubic-bezier(0.4,0.0,0.2,1)",n.DECELERATION_CURVE="cubic-bezier(0.0,0.0,0.2,1)",n.ACCELERATION_CURVE="cubic-bezier(0.4,0.0,1,1)",n.SHARP_CURVE="cubic-bezier(0.4,0.0,0.6,1)",n})(),oY=(()=>{class n{}return n.COMPLEX="375ms",n.ENTERING="225ms",n.EXITING="195ms",n})();const aY=new d.OlP("mat-sanity-checks",{providedIn:"root",factory:function sY(){return!0}});let Za=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!r2()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(pV),d.LFG(aY,8),d.LFG(ft))},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[JE,JE]}),n})();function eT(n){return class extends n{get disabled(){return this._disabled}set disabled(e){this._disabled=os(e)}constructor(...e){super(...e),this._disabled=!1}}}function h2(n,e){return class extends n{get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...t){super(...t),this.defaultColor=e,this.color=e}}}function _V(n){return class extends n{get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=os(e)}constructor(...e){super(...e),this._disableRipple=!1}}}function lY(n,e=0){return class extends n{get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?m_(t):this.defaultTabIndex}constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}}}function cY(n){return class extends n{updateErrorState(){const e=this.errorState,s=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);s!==e&&(this.errorState=s,this.stateChanges.next())}constructor(...e){super(...e),this.errorState=!1}}}function yV(n){return class extends n{constructor(...e){super(...e),this._isInitialized=!1,this._pendingSubscribers=[],this.initialized=new L.y(t=>{this._isInitialized?this._notifySubscriber(t):this._pendingSubscribers.push(t)})}_markInitialized(){this._isInitialized=!0,this._pendingSubscribers.forEach(this._notifySubscriber),this._pendingSubscribers=null}_notifySubscriber(e){e.next(),e.complete()}}}let dY=(()=>{class n{isErrorState(t,i){return!!(t&&t.invalid&&(t.touched||i&&i.submitted))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class hY{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const vV=XE({passive:!0,capture:!0});class fY{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=dv(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){const s=this._events.get(t);if(s){const f=s.get(i);f?f.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,vV)})}removeHandler(e,t,i){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(i),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,vV)))}}const bV={enterDuration:225,exitDuration:150},xV=XE({passive:!0,capture:!0}),wV=["mousedown","touchstart"],CV=["mouseup","mouseleave","touchend","touchcancel"];class nT{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Lb(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...bV,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const f=i.radius||function mY(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),b=e-r.left,I=t-r.top,O=s.enterDuration,V=document.createElement("div");V.classList.add("mat-ripple-element"),V.style.left=b-f+"px",V.style.top=I-f+"px",V.style.height=2*f+"px",V.style.width=2*f+"px",null!=i.color&&(V.style.backgroundColor=i.color),V.style.transitionDuration=`${O}ms`,this._containerElement.appendChild(V);const X=window.getComputedStyle(V),me=X.transitionDuration,Ie="none"===X.transitionProperty||"0s"===me||"0s, 0s"===me||0===r.width&&0===r.height,Ge=new hY(this,V,i,Ie);V.style.transform="scale3d(1, 1, 1)",Ge.state=0,i.persistent||(this._mostRecentTransientRipple=Ge);let Je=null;return!Ie&&(O||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const Qt=()=>this._finishRippleTransition(Ge),xn=()=>this._destroyRipple(Ge);V.addEventListener("transitionend",Qt),V.addEventListener("transitioncancel",xn),Je={onTransitionEnd:Qt,onTransitionCancel:xn}}),this._activeRipples.set(Ge,Je),(Ie||!O)&&this._finishRippleTransition(Ge),Ge}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,i={...bV,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Lb(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,wV.forEach(i=>{nT._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{CV.forEach(t=>{this._triggerElement.addEventListener(t,this,xV)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=1,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=cV(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!uV(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(wV.forEach(t=>nT._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&CV.forEach(t=>e.removeEventListener(t,this,xV)))}}nT._eventManager=new fY;const gY=new d.OlP("mat-ripple-global-options");let f2=(()=>{class n{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,f){this._elementRef=t,this._animationMode=f,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new nT(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq),d.Y36(d.R0b),d.Y36(ec),d.Y36(gY,8),d.Y36(d.QbO,8))},n.\u0275dir=d.lG2({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&d.ekj("mat-ripple-unbounded",i.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),EV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[Za,Za]}),n})(),_Y=(()=>{class n{constructor(t){this._animationMode=t,this.state="unchecked",this.disabled=!1,this.appearance="full"}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.QbO,8))},n.\u0275cmp=d.Xpm({type:n,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(t,i){2&t&&d.ekj("mat-pseudo-checkbox-indeterminate","indeterminate"===i.state)("mat-pseudo-checkbox-checked","checked"===i.state)("mat-pseudo-checkbox-disabled",i.disabled)("mat-pseudo-checkbox-minimal","minimal"===i.appearance)("mat-pseudo-checkbox-full","full"===i.appearance)("_mat-animation-noopable","NoopAnimations"===i._animationMode)},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},decls:0,vars:0,template:function(t,i){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-full{border:2px solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0}),n})(),yY=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[Za]}),n})();const TV=new d.OlP("MAT_OPTION_PARENT_COMPONENT"),IV=new d.OlP("MatOptgroup");let vY=0;class bY{constructor(e,t=!1){this.source=e,this.isUserInput=t}}let xY=(()=>{class n{get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(t){this._disabled=os(t)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get hideSingleSelectionIndicator(){return!(!this._parent||!this._parent.hideSingleSelectionIndicator)}constructor(t,i,r,s){this._element=t,this._changeDetectorRef=i,this._parent=r,this.group=s,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+vY++,this.onSelectionChange=new d.vpe,this._stateChanges=new g.x}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(t,i){const r=this._getHostElement();"function"==typeof r.focus&&r.focus(i)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(t){(13===t.keyCode||32===t.keyCode)&&!u1(t)&&(this._selectViaInteraction(),t.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const t=this.viewValue;t!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=t)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(t=!1){this.onSelectionChange.emit(new bY(this,t))}}return n.\u0275fac=function(t){d.$Z()},n.\u0275dir=d.lG2({type:n,viewQuery:function(t,i){if(1&t&&d.Gf(Q7,7),2&t){let r;d.iGM(r=d.CRH())&&(i._text=r.first)}},inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),n})(),SV=(()=>{class n extends xY{constructor(t,i,r,s){super(t,i,r,s)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq),d.Y36(d.sBO),d.Y36(TV,8),d.Y36(IV,8))},n.\u0275cmp=d.Xpm({type:n,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(t,i){1&t&&d.NdJ("click",function(){return i._selectViaInteraction()})("keydown",function(s){return i._handleKeydown(s)}),2&t&&(d.Ikx("id",i.id),d.uIk("aria-selected",i.selected)("aria-disabled",i.disabled.toString()),d.ekj("mdc-list-item--selected",i.selected)("mat-mdc-option-multiple",i.multiple)("mat-mdc-option-active",i.active)("mdc-list-item--disabled",i.disabled))},exportAs:["matOption"],features:[d.qOj],ngContentSelectors:iY,decls:8,vars:5,consts:[["class","mat-mdc-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mdc-list-item__primary-text"],["text",""],["class","mat-mdc-option-pseudo-checkbox","state","checked","appearance","minimal",3,"disabled",4,"ngIf"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-mdc-option-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-mdc-option-pseudo-checkbox",3,"state","disabled"],["state","checked","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"]],template:function(t,i){1&t&&(d.F$t(nY),d.YNc(0,J7,1,2,"mat-pseudo-checkbox",0),d.Hsn(1),d.TgZ(2,"span",1,2),d.Hsn(4,1),d.qZA(),d.YNc(5,eY,1,1,"mat-pseudo-checkbox",3),d.YNc(6,tY,2,1,"span",4),d._UZ(7,"div",5)),2&t&&(d.Q6J("ngIf",i.multiple),d.xp6(5),d.Q6J("ngIf",!i.multiple&&i.selected&&!i.hideSingleSelectionIndicator),d.xp6(1),d.Q6J("ngIf",i.group&&i.group._inert),d.xp6(1),d.Q6J("matRippleTrigger",i._getHostElement())("matRippleDisabled",i.disabled||i.disableRipple))},dependencies:[f2,Bo,_Y],styles:['.mat-mdc-option{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);min-height:48px}.mat-mdc-option:focus{outline:none}[dir=rtl] .mat-mdc-option,.mat-mdc-option[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-option.mdc-list-item{align-items:center}.mat-mdc-option.mdc-list-item--disabled{opacity:.38;cursor:default}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}.cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{right:auto;left:16px}.mat-mdc-option-active .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),n})(),MV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[EV,vs,Za,yY]}),n})();class DV{}class EY{}const __="*";function Rm(n,e){return{type:7,name:n,definitions:e,options:{}}}function md(n,e=null){return{type:4,styles:e,timings:n}}function AV(n,e=null){return{type:2,steps:n,options:e}}function Mo(n){return{type:6,styles:n,offset:null}}function Pc(n,e,t){return{type:0,name:n,styles:e,options:t}}function kM(n){return{type:5,steps:n}}function Oc(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}function PV(n=null){return{type:9,options:n}}function OV(n,e,t=null){return{type:11,selector:n,animation:e,options:t}}function kV(n){Promise.resolve().then(n)}class iT{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){kV(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class RV{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?kV(()=>this._onFinish()):this.players.forEach(f=>{f.onDone(()=>{++t==s&&this._onFinish()}),f.onDestroy(()=>{++i==s&&this._onDestroy()}),f.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((f,b)=>Math.max(f,b.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}const p2="!",TY=["mat-sort-header",""];function IY(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"div",3),d.NdJ("@arrowPosition.start",function(){d.CHM(t);const r=d.oxw();return d.KtG(r._disableViewStateAnimation=!0)})("@arrowPosition.done",function(){d.CHM(t);const r=d.oxw();return d.KtG(r._disableViewStateAnimation=!1)}),d._UZ(1,"div",4),d.TgZ(2,"div",5),d._UZ(3,"div",6)(4,"div",7)(5,"div",8),d.qZA()()}if(2&n){const t=d.oxw();d.Q6J("@arrowOpacity",t._getArrowViewState())("@arrowPosition",t._getArrowViewState())("@allowChildren",t._getArrowDirectionState()),d.xp6(2),d.Q6J("@indicator",t._getArrowDirectionState()),d.xp6(1),d.Q6J("@leftPointer",t._getArrowDirectionState()),d.xp6(1),d.Q6J("@rightPointer",t._getArrowDirectionState())}}const SY=["*"],FV=new d.OlP("MAT_SORT_DEFAULT_OPTIONS"),MY=yV(eT(class{}));let m2=(()=>{class n extends MY{get direction(){return this._direction}set direction(t){this._direction=t}get disableClear(){return this._disableClear}set disableClear(t){this._disableClear=os(t)}constructor(t){super(),this._defaultOptions=t,this.sortables=new Map,this._stateChanges=new g.x,this.start="asc",this._direction="",this.sortChange=new d.vpe}register(t){this.sortables.set(t.id,t)}deregister(t){this.sortables.delete(t.id)}sort(t){this.active!=t.id?(this.active=t.id,this.direction=t.start?t.start:this.start):this.direction=this.getNextSortDirection(t),this.sortChange.emit({active:this.active,direction:this.direction})}getNextSortDirection(t){if(!t)return"";let r=function DY(n,e){let t=["asc","desc"];return"desc"==n&&t.reverse(),e||t.push(""),t}(t.start||this.start,t?.disableClear??this.disableClear??!!this._defaultOptions?.disableClear),s=r.indexOf(this.direction)+1;return s>=r.length&&(s=0),r[s]}ngOnInit(){this._markInitialized()}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(FV,8))},n.\u0275dir=d.lG2({type:n,selectors:[["","matSort",""]],hostAttrs:[1,"mat-sort"],inputs:{disabled:["matSortDisabled","disabled"],active:["matSortActive","active"],start:["matSortStart","start"],direction:["matSortDirection","direction"],disableClear:["matSortDisableClear","disableClear"]},outputs:{sortChange:"matSortChange"},exportAs:["matSort"],features:[d.qOj,d.TTD]}),n})();const hv=oY.ENTERING+" "+rY.STANDARD_CURVE,f1={indicator:Rm("indicator",[Pc("active-asc, asc",Mo({transform:"translateY(0px)"})),Pc("active-desc, desc",Mo({transform:"translateY(10px)"})),Oc("active-asc <=> active-desc",md(hv))]),leftPointer:Rm("leftPointer",[Pc("active-asc, asc",Mo({transform:"rotate(-45deg)"})),Pc("active-desc, desc",Mo({transform:"rotate(45deg)"})),Oc("active-asc <=> active-desc",md(hv))]),rightPointer:Rm("rightPointer",[Pc("active-asc, asc",Mo({transform:"rotate(45deg)"})),Pc("active-desc, desc",Mo({transform:"rotate(-45deg)"})),Oc("active-asc <=> active-desc",md(hv))]),arrowOpacity:Rm("arrowOpacity",[Pc("desc-to-active, asc-to-active, active",Mo({opacity:1})),Pc("desc-to-hint, asc-to-hint, hint",Mo({opacity:.54})),Pc("hint-to-desc, active-to-desc, desc, hint-to-asc, active-to-asc, asc, void",Mo({opacity:0})),Oc("* => asc, * => desc, * => active, * => hint, * => void",md("0ms")),Oc("* <=> *",md(hv))]),arrowPosition:Rm("arrowPosition",[Oc("* => desc-to-hint, * => desc-to-active",md(hv,kM([Mo({transform:"translateY(-25%)"}),Mo({transform:"translateY(0)"})]))),Oc("* => hint-to-desc, * => active-to-desc",md(hv,kM([Mo({transform:"translateY(0)"}),Mo({transform:"translateY(25%)"})]))),Oc("* => asc-to-hint, * => asc-to-active",md(hv,kM([Mo({transform:"translateY(25%)"}),Mo({transform:"translateY(0)"})]))),Oc("* => hint-to-asc, * => active-to-asc",md(hv,kM([Mo({transform:"translateY(0)"}),Mo({transform:"translateY(-25%)"})]))),Pc("desc-to-hint, asc-to-hint, hint, desc-to-active, asc-to-active, active",Mo({transform:"translateY(0)"})),Pc("hint-to-desc, active-to-desc, desc",Mo({transform:"translateY(-25%)"})),Pc("hint-to-asc, active-to-asc, asc",Mo({transform:"translateY(25%)"}))]),allowChildren:Rm("allowChildren",[Oc("* <=> *",[OV("@*",PV(),{optional:!0})])])};let RM=(()=>{class n{constructor(){this.changes=new g.x}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const PY={provide:RM,deps:[[new d.FiY,new d.tp0,RM]],useFactory:function AY(n){return n||new RM}},OY=eT(class{});let kY=(()=>{class n extends OY{get sortActionDescription(){return this._sortActionDescription}set sortActionDescription(t){this._updateSortActionDescription(t)}get disableClear(){return this._disableClear}set disableClear(t){this._disableClear=os(t)}constructor(t,i,r,s,f,b,I,O){super(),this._intl=t,this._changeDetectorRef=i,this._sort=r,this._columnDef=s,this._focusMonitor=f,this._elementRef=b,this._ariaDescriber=I,this._showIndicatorHint=!1,this._viewState={},this._arrowDirection="",this._disableViewStateAnimation=!1,this.arrowPosition="after",this._sortActionDescription="Sort",O?.arrowPosition&&(this.arrowPosition=O?.arrowPosition),this._handleStateChanges()}ngOnInit(){!this.id&&this._columnDef&&(this.id=this._columnDef.name),this._updateArrowDirection(),this._setAnimationTransitionState({toState:this._isSorted()?"active":this._arrowDirection}),this._sort.register(this),this._sortButton=this._elementRef.nativeElement.querySelector(".mat-sort-header-container"),this._updateSortActionDescription(this._sortActionDescription)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{const i=!!t;i!==this._showIndicatorHint&&(this._setIndicatorHintVisible(i),this._changeDetectorRef.markForCheck())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._sort.deregister(this),this._rerenderSubscription.unsubscribe()}_setIndicatorHintVisible(t){this._isDisabled()&&t||(this._showIndicatorHint=t,this._isSorted()||(this._updateArrowDirection(),this._setAnimationTransitionState(this._showIndicatorHint?{fromState:this._arrowDirection,toState:"hint"}:{fromState:"hint",toState:this._arrowDirection})))}_setAnimationTransitionState(t){this._viewState=t||{},this._disableViewStateAnimation&&(this._viewState={toState:t.toState})}_toggleOnInteraction(){this._sort.sort(this),("hint"===this._viewState.toState||"active"===this._viewState.toState)&&(this._disableViewStateAnimation=!0)}_handleClick(){this._isDisabled()||this._sort.sort(this)}_handleKeydown(t){!this._isDisabled()&&(32===t.keyCode||13===t.keyCode)&&(t.preventDefault(),this._toggleOnInteraction())}_isSorted(){return this._sort.active==this.id&&("asc"===this._sort.direction||"desc"===this._sort.direction)}_getArrowDirectionState(){return`${this._isSorted()?"active-":""}${this._arrowDirection}`}_getArrowViewState(){const t=this._viewState.fromState;return(t?`${t}-to-`:"")+this._viewState.toState}_updateArrowDirection(){this._arrowDirection=this._isSorted()?this._sort.direction:this.start||this._sort.start}_isDisabled(){return this._sort.disabled||this.disabled}_getAriaSortAttribute(){return this._isSorted()?"asc"==this._sort.direction?"ascending":"descending":"none"}_renderArrow(){return!this._isDisabled()||this._isSorted()}_updateSortActionDescription(t){this._sortButton&&(this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription),this._ariaDescriber?.describe(this._sortButton,t)),this._sortActionDescription=t}_handleStateChanges(){this._rerenderSubscription=(0,p_.T)(this._sort.sortChange,this._sort._stateChanges,this._intl.changes).subscribe(()=>{this._isSorted()&&(this._updateArrowDirection(),("hint"===this._viewState.toState||"active"===this._viewState.toState)&&(this._disableViewStateAnimation=!0),this._setAnimationTransitionState({fromState:this._arrowDirection,toState:"active"}),this._showIndicatorHint=!1),!this._isSorted()&&this._viewState&&"active"===this._viewState.toState&&(this._disableViewStateAnimation=!1,this._setAnimationTransitionState({fromState:"active",toState:this._arrowDirection})),this._changeDetectorRef.markForCheck()})}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(RM),d.Y36(d.sBO),d.Y36(m2,8),d.Y36("MAT_SORT_HEADER_COLUMN_DEF",8),d.Y36(u2),d.Y36(d.SBq),d.Y36(sV,8),d.Y36(FV,8))},n.\u0275cmp=d.Xpm({type:n,selectors:[["","mat-sort-header",""]],hostAttrs:[1,"mat-sort-header"],hostVars:3,hostBindings:function(t,i){1&t&&d.NdJ("click",function(){return i._handleClick()})("keydown",function(s){return i._handleKeydown(s)})("mouseenter",function(){return i._setIndicatorHintVisible(!0)})("mouseleave",function(){return i._setIndicatorHintVisible(!1)}),2&t&&(d.uIk("aria-sort",i._getAriaSortAttribute()),d.ekj("mat-sort-header-disabled",i._isDisabled()))},inputs:{disabled:"disabled",id:["mat-sort-header","id"],arrowPosition:"arrowPosition",start:"start",sortActionDescription:"sortActionDescription",disableClear:"disableClear"},exportAs:["matSortHeader"],features:[d.qOj],attrs:TY,ngContentSelectors:SY,decls:4,vars:7,consts:[[1,"mat-sort-header-container","mat-focus-indicator"],[1,"mat-sort-header-content"],["class","mat-sort-header-arrow",4,"ngIf"],[1,"mat-sort-header-arrow"],[1,"mat-sort-header-stem"],[1,"mat-sort-header-indicator"],[1,"mat-sort-header-pointer-left"],[1,"mat-sort-header-pointer-right"],[1,"mat-sort-header-pointer-middle"]],template:function(t,i){1&t&&(d.F$t(),d.TgZ(0,"div",0)(1,"div",1),d.Hsn(2),d.qZA(),d.YNc(3,IY,6,6,"div",2),d.qZA()),2&t&&(d.ekj("mat-sort-header-sorted",i._isSorted())("mat-sort-header-position-before","before"===i.arrowPosition),d.uIk("tabindex",i._isDisabled()?null:0)("role",i._isDisabled()?null:"button"),d.xp6(3),d.Q6J("ngIf",i._renderArrow()))},dependencies:[Bo],styles:[".mat-sort-header-container{display:flex;cursor:pointer;align-items:center;letter-spacing:normal;outline:0}[mat-sort-header].cdk-keyboard-focused .mat-sort-header-container,[mat-sort-header].cdk-program-focused .mat-sort-header-container{border-bottom:solid 1px currentColor}.mat-sort-header-disabled .mat-sort-header-container{cursor:default}.mat-sort-header-container::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-sort-header-content{text-align:center;display:flex;align-items:center}.mat-sort-header-position-before{flex-direction:row-reverse}.mat-sort-header-arrow{height:12px;width:12px;min-width:12px;position:relative;display:flex;opacity:0}.mat-sort-header-arrow,[dir=rtl] .mat-sort-header-position-before .mat-sort-header-arrow{margin:0 0 0 6px}.mat-sort-header-position-before .mat-sort-header-arrow,[dir=rtl] .mat-sort-header-arrow{margin:0 6px 0 0}.mat-sort-header-stem{background:currentColor;height:10px;width:2px;margin:auto;display:flex;align-items:center}.cdk-high-contrast-active .mat-sort-header-stem{width:0;border-left:solid 2px}.mat-sort-header-indicator{width:100%;height:2px;display:flex;align-items:center;position:absolute;top:0;left:0}.mat-sort-header-pointer-middle{margin:auto;height:2px;width:2px;background:currentColor;transform:rotate(45deg)}.cdk-high-contrast-active .mat-sort-header-pointer-middle{width:0;height:0;border-top:solid 2px;border-left:solid 2px}.mat-sort-header-pointer-left,.mat-sort-header-pointer-right{background:currentColor;width:6px;height:2px;position:absolute;top:0}.cdk-high-contrast-active .mat-sort-header-pointer-left,.cdk-high-contrast-active .mat-sort-header-pointer-right{width:0;height:0;border-left:solid 6px;border-top:solid 2px}.mat-sort-header-pointer-left{transform-origin:right;left:0}.mat-sort-header-pointer-right{transform-origin:left;right:0}"],encapsulation:2,data:{animation:[f1.indicator,f1.leftPointer,f1.rightPointer,f1.arrowOpacity,f1.arrowPosition,f1.allowChildren]},changeDetection:0}),n})(),RY=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[PY],imports:[vs,Za]}),n})();const LY=["mat-icon-button",""],NY=["*"],zY=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],BY=h2(eT(_V(class{constructor(n){this._elementRef=n}})));let VY=(()=>{class n extends BY{constructor(t,i,r,s){super(t),this._platform=i,this._ngZone=r,this._animationMode=s,this._focusMonitor=(0,d.f3M)(u2),this._isFab=!1;const f=t.nativeElement.classList;for(const b of zY)this._hasHostAttributes(b.selector)&&b.mdcClasses.forEach(I=>{f.add(I)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_hasHostAttributes(...t){return t.some(i=>this._elementRef.nativeElement.hasAttribute(i))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return n.\u0275fac=function(t){d.$Z()},n.\u0275dir=d.lG2({type:n,viewQuery:function(t,i){if(1&t&&d.Gf(f2,5),2&t){let r;d.iGM(r=d.CRH())&&(i.ripple=r.first)}},features:[d.qOj]}),n})(),g2=(()=>{class n extends VY{constructor(t,i,r,s){super(t,i,r,s)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq),d.Y36(ec),d.Y36(d.R0b),d.Y36(d.QbO,8))},n.\u0275cmp=d.Xpm({type:n,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(t,i){2&t&&(d.uIk("disabled",i.disabled||null),d.ekj("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-unthemed",!i.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[d.qOj],attrs:LY,ngContentSelectors:NY,decls:5,vars:3,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(t,i){1&t&&(d.F$t(),d._UZ(0,"span",0),d.Hsn(1),d._UZ(2,"span",1)(3,"span",2)(4,"span",3)),2&t&&(d.xp6(3),d.Q6J("matRippleDisabled",i._isRippleDisabled())("matRippleCentered",!0)("matRippleTrigger",i._elementRef.nativeElement))},dependencies:[f2],styles:['.mdc-icon-button{font-size:24px;width:48px;height:48px;padding:12px}.mdc-icon-button .mdc-icon-button__focus-ring{max-height:48px;max-width:48px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:40px;height:40px;margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:40px;max-width:40px}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button svg,.mdc-icon-button img{width:24px;height:24px}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size, 48px);width:var(--mdc-icon-button-state-layer-size, 48px);color:var(--mdc-icon-button-icon-color, inherit);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity, 0.38)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color, #000)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),LV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[Za,EV,Za]}),n})();var $Y=Ae(1144);const GY=["addListener","removeListener"],HY=["addEventListener","removeEventListener"],qY=["on","off"];function FM(n,e,t,i){if((0,at.m)(t)&&(i=t,t=void 0),i)return FM(n,e,t).pipe(ce(i));const[r,s]=function YY(n){return(0,at.m)(n.addEventListener)&&(0,at.m)(n.removeEventListener)}(n)?HY.map(f=>b=>n[f](e,b,t)):function WY(n){return(0,at.m)(n.addListener)&&(0,at.m)(n.removeListener)}(n)?GY.map(NV(n,e)):function ZY(n){return(0,at.m)(n.on)&&(0,at.m)(n.off)}(n)?qY.map(NV(n,e)):[];if(!r&&(0,$Y.z)(n))return(0,yn.z)(f=>FM(f,e,t))((0,Ut.Xf)(n));if(!r)throw new TypeError("Invalid event target");return new L.y(f=>{const b=(...I)=>f.next(1<I.length?I:I[0]);return r(b),()=>s(b)})}function NV(n,e){return t=>i=>n[t](e,i)}const rT={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=rT;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new qe.w0(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=rT;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=rT;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},QY=new class XY extends fM{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class KY extends hM{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=rT.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(rT.cancelAnimationFrame(t),e._scheduled=void 0)}});let _2,JY=1;const LM={};function zV(n){return n in LM&&(delete LM[n],!0)}const e9={setImmediate(n){const e=JY++;return LM[e]=!0,_2||(_2=Promise.resolve()),_2.then(()=>zV(e)&&n()),e},clearImmediate(n){zV(n)}},{setImmediate:t9,clearImmediate:n9}=e9,NM={setImmediate(...n){const{delegate:e}=NM;return(e?.setImmediate||t9)(...n)},clearImmediate(n){const{delegate:e}=NM;return(e?.clearImmediate||n9)(n)},delegate:void 0},o9=new class r9 extends fM{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class i9 extends hM{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=NM.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(NM.clearImmediate(t),e._scheduled=void 0)}});var a9=Ae(3532);function y2(n,e=BE){return function s9(n){return(0,Xe.e)((e,t)=>{let i=!1,r=null,s=null,f=!1;const b=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const O=r;r=null,t.next(O)}f&&t.complete()},I=()=>{s=null,f&&t.complete()};e.subscribe((0,ve.x)(t,O=>{i=!0,r=O,s||(0,Ut.Xf)(n(O)).subscribe(s=(0,ve.x)(t,b,I))},()=>{f=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>function c9(n=0,e,t=F8){let i=-1;return null!=e&&((0,a9.K)(e)?t=e:i=e),new L.y(r=>{let s=function l9(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let f=0;return t.schedule(function(){r.closed||(r.next(f++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(n,e))}const u9=["contentWrapper"],d9=["*"],h9=new d.OlP("VIRTUAL_SCROLL_STRATEGY");let oT=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new g.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new L.y(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(y2(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):c()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(Yt(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=Lb(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>FM(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(d.R0b),d.LFG(ec),d.LFG(ft,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),BV=(()=>{class n{constructor(t,i,r,s){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=r,this.dir=s,this._destroyed=new g.x,this._elementScrolled=new L.y(f=>this.ngZone.runOutsideAngular(()=>FM(this.elementRef.nativeElement,"scroll").pipe(qo(this._destroyed)).subscribe(f)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const i=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),r&&0!=QE()?(null!=t.left&&(t.right=i.scrollWidth-i.clientWidth-t.left),2==QE()?t.left=t.right:1==QE()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const i=this.elementRef.nativeElement;W3()?i.scrollTo(t):(null!=t.top&&(i.scrollTop=t.top),null!=t.left&&(i.scrollLeft=t.left))}measureScrollOffset(t){const i="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const f=this.dir&&"rtl"==this.dir.value;return"start"==t?t=f?r:i:"end"==t&&(t=f?i:r),f&&2==QE()?t==i?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:f&&1==QE()?t==i?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==i?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq),d.Y36(oT),d.Y36(d.R0b),d.Y36(g_,8))},n.\u0275dir=d.lG2({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),n})(),sT=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new g.x,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(y2(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ec),d.LFG(d.R0b),d.LFG(ft,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const VV=new d.OlP("VIRTUAL_SCROLLABLE");let m9=(()=>{class n extends BV{constructor(t,i,r,s){super(t,i,r,s)}measureViewportSize(t){const i=this.elementRef.nativeElement;return"horizontal"===t?i.clientWidth:i.clientHeight}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq),d.Y36(oT),d.Y36(d.R0b),d.Y36(g_,8))},n.\u0275dir=d.lG2({type:n,features:[d.qOj]}),n})();const _9=typeof requestAnimationFrame<"u"?QY:o9;let y9=(()=>{class n extends m9{get orientation(){return this._orientation}set orientation(t){this._orientation!==t&&(this._orientation=t,this._calculateSpacerSize())}get appendOnly(){return this._appendOnly}set appendOnly(t){this._appendOnly=os(t)}constructor(t,i,r,s,f,b,I,O){super(t,b,r,f),this.elementRef=t,this._changeDetectorRef=i,this._scrollStrategy=s,this.scrollable=O,this._platform=(0,d.f3M)(ec),this._detachedSubject=new g.x,this._renderedRangeSubject=new g.x,this._orientation="vertical",this._appendOnly=!1,this.scrolledIndexChange=new L.y(V=>this._scrollStrategy.scrolledIndexChange.subscribe(X=>Promise.resolve().then(()=>this.ngZone.run(()=>V.next(X))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=qe.w0.EMPTY,this._viewportChanges=I.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe(gn(null),y2(0,_9)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(t){this.ngZone.runOutsideAngular(()=>{this._forOf=t,this._forOf.dataStream.pipe(qo(this._detachedSubject)).subscribe(i=>{const r=i.length;r!==this._dataLength&&(this._dataLength=r,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(t){return this.getElementRef().nativeElement.getBoundingClientRect()[t]}setTotalContentSize(t){this._totalContentSize!==t&&(this._totalContentSize=t,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(t){(function g9(n,e){return n.start==e.start&&n.end==e.end})(this._renderedRange,t)||(this.appendOnly&&(t={start:0,end:Math.max(this._renderedRange.end,t.end)}),this._renderedRangeSubject.next(this._renderedRange=t),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(t,i="to-start"){t=this.appendOnly&&"to-start"===i?0:t;const s="horizontal"==this.orientation,f=s?"X":"Y";let I=`translate${f}(${Number((s&&this.dir&&"rtl"==this.dir.value?-1:1)*t)}px)`;this._renderedContentOffset=t,"to-end"===i&&(I+=` translate${f}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=I&&(this._renderedContentTransform=I,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(t,i="auto"){const r={behavior:i};"horizontal"===this.orientation?r.start=t:r.top=t,this.scrollable.scrollTo(r)}scrollToIndex(t,i="auto"){this._scrollStrategy.scrollToIndex(t,i)}measureScrollOffset(t){let i;return i=this.scrollable==this?r=>super.measureScrollOffset(r):r=>this.scrollable.measureScrollOffset(r),Math.max(0,i(t??("horizontal"===this.orientation?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(t){let i;const r="left",s="right",f="rtl"==this.dir?.value;i="start"==t?f?s:r:"end"==t?f?r:s:t||("horizontal"===this.orientation?"left":"top");const b=this.scrollable.measureBoundingClientRectWithScrollOffset(i);return this.elementRef.nativeElement.getBoundingClientRect()[i]-b}measureRenderedContentSize(){const t=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?t.offsetWidth:t.offsetHeight}measureRangeSize(t){return this._forOf?this._forOf.measureRangeSize(t,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(t){t&&this._runAfterChangeDetection.push(t),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const t=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const i of t)i()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq),d.Y36(d.sBO),d.Y36(d.R0b),d.Y36(h9,8),d.Y36(g_,8),d.Y36(oT),d.Y36(sT),d.Y36(VV,8))},n.\u0275cmp=d.Xpm({type:n,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(t,i){if(1&t&&d.Gf(u9,7),2&t){let r;d.iGM(r=d.CRH())&&(i._contentWrapper=r.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(t,i){2&t&&d.ekj("cdk-virtual-scroll-orientation-horizontal","horizontal"===i.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==i.orientation)},inputs:{orientation:"orientation",appendOnly:"appendOnly"},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[d._Bn([{provide:BV,useFactory:(e,t)=>e||t,deps:[[new d.FiY,new d.tBr(VV)],n]}]),d.qOj,d.jDz],ngContentSelectors:d9,decls:4,vars:4,consts:[[1,"cdk-virtual-scroll-content-wrapper"],["contentWrapper",""],[1,"cdk-virtual-scroll-spacer"]],template:function(t,i){1&t&&(d.F$t(),d.TgZ(0,"div",0,1),d.Hsn(2),d.qZA(),d._UZ(3,"div",2)),2&t&&(d.xp6(3),d.Udp("width",i._totalContentWidth)("height",i._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0}),n})(),zM=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({}),n})(),v2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[JE,zM,y9,JE,zM]}),n})();class b2{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class UV extends b2{constructor(e,t,i,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class jV extends b2{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class v9 extends b2{constructor(e){super(),this.element=e instanceof d.SBq?e.nativeElement:e}}class b9{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof UV?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof jV?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof v9?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class x9 extends b9{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=f=>{const b=f.element,I=this._document.createComment("dom-portal");b.parentNode.insertBefore(I,b),this.outletElement.appendChild(b),this._attachedPortal=f,super.setDisposeFn(()=>{I.parentNode&&I.parentNode.replaceChild(b,I)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||d.zs3.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let w9=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({}),n})();const $V=W3();class C9{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=Sa(-this._previousScrollPosition.left),e.style.top=Sa(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",f=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),$V&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),$V&&(i.scrollBehavior=s,r.scrollBehavior=f)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class E9{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(Yt(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class GV{enable(){}disable(){}attach(){}}function x2(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function HV(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class T9{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();x2(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let I9=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new GV,this.close=f=>new E9(this._scrollDispatcher,this._ngZone,this._viewportRuler,f),this.block=()=>new C9(this._viewportRuler,this._document),this.reposition=f=>new T9(this._scrollDispatcher,this._viewportRuler,this._ngZone,f),this._document=s}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(oT),d.LFG(sT),d.LFG(d.R0b),d.LFG(ft))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class qV{constructor(e){if(this.scrollStrategy=new GV,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class S9{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let WV=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ft))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),M9=(()=>{class n extends WV{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let f=s.length-1;f>-1;f--)if(s[f]._keydownEvents.observers.length>0){const b=s[f]._keydownEvents;this._ngZone?this._ngZone.run(()=>b.next(r)):b.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ft),d.LFG(d.R0b,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),D9=(()=>{class n extends WV{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=dv(s)},this._clickListener=s=>{const f=dv(s),b="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:f;this._pointerDownEventTarget=null;const I=this._attachedOverlays.slice();for(let O=I.length-1;O>-1;O--){const V=I[O];if(V._outsidePointerEvents.observers.length<1||!V.hasAttached())continue;if(V.overlayElement.contains(f)||V.overlayElement.contains(b))break;const X=V._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>X.next(s)):X.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ft),d.LFG(ec),d.LFG(d.R0b,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ZV=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||r2()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),r2()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ft),d.LFG(ec))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class A9{constructor(e,t,i,r,s,f,b,I,O,V=!1){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=f,this._document=b,this._location=I,this._outsideClickDispatcher=O,this._animationsDisabled=V,this._backdropElement=null,this._backdropClick=new g.x,this._attachments=new g.x,this._detachments=new g.x,this._locationChanges=qe.w0.EMPTY,this._backdropClickHandler=X=>this._backdropClick.next(X),this._backdropTransitionendHandler=X=>{this._disposeBackdrop(X.target)},this._keydownEvents=new g.x,this._outsidePointerEvents=new g.x,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Yn(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=Sa(this._config.width),e.height=Sa(this._config.height),e.minWidth=Sa(this._config.minWidth),e.minHeight=Sa(this._config.minHeight),e.maxWidth=Sa(this._config.maxWidth),e.maxHeight=Sa(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){const r=DM(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(qo((0,p_.T)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const YV="cdk-overlay-connected-position-bounding-box",P9=/([A-Za-z%]+)$/;class O9{get positions(){return this._preferredPositions}constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new g.x,this._resizeSubscription=qe.w0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(YV),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let f;for(let b of this._preferredPositions){let I=this._getOriginPoint(e,r,b),O=this._getOverlayPoint(I,t,b),V=this._getOverlayFit(O,t,i,b);if(V.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(b,I);this._canFitWithFlexibleDimensions(V,O,i)?s.push({position:b,origin:I,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(I,b)}):(!f||f.overlayFit.visibleArea<V.visibleArea)&&(f={overlayFit:V,overlayPoint:O,originPoint:I,position:b,overlayRect:t})}if(s.length){let b=null,I=-1;for(const O of s){const V=O.boundingBoxRect.width*O.boundingBoxRect.height*(O.position.weight||1);V>I&&(I=V,b=O)}return this._isPushed=!1,void this._applyPosition(b.position,b.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(f.position,f.originPoint);this._applyPosition(f.position,f.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Nb(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(YV),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const f=this._isRtl()?e.right:e.left,b=this._isRtl()?e.left:e.right;r="start"==i.originX?f:b}return t.left<0&&(r-=t.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=XV(t);let{x:f,y:b}=e,I=this._getOffset(r,"x"),O=this._getOffset(r,"y");I&&(f+=I),O&&(b+=O);let ae=0-b,me=b+s.height-i.height,Ie=this._subtractOverflows(s.width,0-f,f+s.width-i.width),Ge=this._subtractOverflows(s.height,ae,me),Je=Ie*Ge;return{visibleArea:Je,isCompletelyWithinViewport:s.width*s.height===Je,fitsInViewportVertically:Ge===s.height,fitsInViewportHorizontally:Ie==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,f=KV(this._overlayRef.getConfig().minHeight),b=KV(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=f&&f<=r)&&(e.fitsInViewportHorizontally||null!=b&&b<=s)}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=XV(t),s=this._viewportRect,f=Math.max(e.x+r.width-s.width,0),b=Math.max(e.y+r.height-s.height,0),I=Math.max(s.top-i.top-e.y,0),O=Math.max(s.left-i.left-e.x,0);let V=0,X=0;return V=r.width<=s.width?O||-f:e.x<this._viewportMargin?s.left-i.left-e.x:0,X=r.height<=s.height?I||-b:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:V,y:X},{x:e.x+V,y:e.y+X}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new S9(e,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,f,b,V,X,ae;if("top"===t.overlayY)f=e.y,s=i.height-f+this._viewportMargin;else if("bottom"===t.overlayY)b=i.height-e.y+2*this._viewportMargin,s=i.height-b+this._viewportMargin;else{const me=Math.min(i.bottom-e.y+i.top,e.y),Ie=this._lastBoundingBoxSize.height;s=2*me,f=e.y-me,s>Ie&&!this._isInitialRender&&!this._growAfterOpen&&(f=e.y-Ie/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)ae=i.width-e.x+this._viewportMargin,V=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)X=e.x,V=i.right-e.x;else{const me=Math.min(i.right-e.x+i.left,e.x),Ie=this._lastBoundingBoxSize.width;V=2*me,X=e.x-me,V>Ie&&!this._isInitialRender&&!this._growAfterOpen&&(X=e.x-Ie/2)}return{top:f,left:X,bottom:b,right:ae,width:V,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,f=this._overlayRef.getConfig().maxWidth;r.height=Sa(i.height),r.top=Sa(i.top),r.bottom=Sa(i.bottom),r.width=Sa(i.width),r.left=Sa(i.left),r.right=Sa(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=Sa(s)),f&&(r.maxWidth=Sa(f))}this._lastBoundingBoxSize=i,Nb(this._boundingBox.style,r)}_resetBoundingBoxStyles(){Nb(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Nb(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,f=this._overlayRef.getConfig();if(r){const V=this._viewportRuler.getViewportScrollPosition();Nb(i,this._getExactOverlayY(t,e,V)),Nb(i,this._getExactOverlayX(t,e,V))}else i.position="static";let b="",I=this._getOffset(t,"x"),O=this._getOffset(t,"y");I&&(b+=`translateX(${I}px) `),O&&(b+=`translateY(${O}px)`),i.transform=b.trim(),f.maxHeight&&(r?i.maxHeight=Sa(f.maxHeight):s&&(i.maxHeight="")),f.maxWidth&&(r?i.maxWidth=Sa(f.maxWidth):s&&(i.maxWidth="")),Nb(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=Sa(s.y),r}_getExactOverlayX(e,t,i){let f,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),f=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===f?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=Sa(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:HV(e,i),isOriginOutsideView:x2(e,i),isOverlayClipped:HV(t,i),isOverlayOutsideView:x2(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&DM(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof d.SBq)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function Nb(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function KV(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(P9);return t&&"px"!==t?null:parseFloat(e)}return n||null}function XV(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const QV="cdk-global-overlay-wrapper";class k9{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(QV),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:f,maxHeight:b}=i,I=!("100%"!==r&&"100vw"!==r||f&&"100%"!==f&&"100vw"!==f),O=!("100%"!==s&&"100vh"!==s||b&&"100%"!==b&&"100vh"!==b),V=this._xPosition,X=this._xOffset,ae="rtl"===this._overlayRef.getConfig().direction;let me="",Ie="",Ge="";I?Ge="flex-start":"center"===V?(Ge="center",ae?Ie=X:me=X):ae?"left"===V||"end"===V?(Ge="flex-end",me=X):("right"===V||"start"===V)&&(Ge="flex-start",Ie=X):"left"===V||"start"===V?(Ge="flex-start",me=X):("right"===V||"end"===V)&&(Ge="flex-end",Ie=X),e.position=this._cssPosition,e.marginLeft=I?"0":me,e.marginTop=O?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=I?"0":Ie,t.justifyContent=Ge,t.alignItems=O?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(QV),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let R9=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new k9}flexibleConnectedTo(t){return new O9(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(sT),d.LFG(ft),d.LFG(ec),d.LFG(ZV))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),F9=0,p1=(()=>{class n{constructor(t,i,r,s,f,b,I,O,V,X,ae,me){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=f,this._injector=b,this._ngZone=I,this._document=O,this._directionality=V,this._location=X,this._outsideClickDispatcher=ae,this._animationsModuleType=me}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),f=new qV(t);return f.direction=f.direction||this._directionality.value,new A9(s,i,r,f,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+F9++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(d.z2F)),new x9(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(I9),d.LFG(ZV),d.LFG(d._Vd),d.LFG(R9),d.LFG(M9),d.LFG(d.zs3),d.LFG(d.R0b),d.LFG(ft),d.LFG(g_),d.LFG(Jt),d.LFG(D9),d.LFG(d.QbO,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const L9=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],JV=new d.OlP("cdk-connected-overlay-scroll-strategy");let w2=(()=>{class n{constructor(t){this.elementRef=t}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq))},n.\u0275dir=d.lG2({type:n,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0}),n})(),eU=(()=>{class n{get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(t){this._hasBackdrop=os(t)}get lockPosition(){return this._lockPosition}set lockPosition(t){this._lockPosition=os(t)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(t){this._flexibleDimensions=os(t)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(t){this._growAfterOpen=os(t)}get push(){return this._push}set push(t){this._push=os(t)}constructor(t,i,r,s,f){this._overlay=t,this._dir=f,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=qe.w0.EMPTY,this._attachSubscription=qe.w0.EMPTY,this._detachSubscription=qe.w0.EMPTY,this._positionSubscription=qe.w0.EMPTY,this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.backdropClick=new d.vpe,this.positionChange=new d.vpe,this.attach=new d.vpe,this.detach=new d.vpe,this.overlayKeydown=new d.vpe,this.overlayOutsideClick=new d.vpe,this._templatePortal=new jV(i,r),this._scrollStrategyFactory=s,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(t){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),t.origin&&this.open&&this._position.apply()),t.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=L9);const t=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=t.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=t.detachments().subscribe(()=>this.detach.emit()),t.keydownEvents().subscribe(i=>{this.overlayKeydown.next(i),27===i.keyCode&&!this.disableClose&&!u1(i)&&(i.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(i=>{this.overlayOutsideClick.next(i)})}_buildConfig(){const t=this._position=this.positionStrategy||this._createPositionStrategy(),i=new qV({direction:this._dir,positionStrategy:t,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(i.width=this.width),(this.height||0===this.height)&&(i.height=this.height),(this.minWidth||0===this.minWidth)&&(i.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(i.minHeight=this.minHeight),this.backdropClass&&(i.backdropClass=this.backdropClass),this.panelClass&&(i.panelClass=this.panelClass),i}_updatePositionStrategy(t){const i=this.positions.map(r=>({originX:r.originX,originY:r.originY,overlayX:r.overlayX,overlayY:r.overlayY,offsetX:r.offsetX||this.offsetX,offsetY:r.offsetY||this.offsetY,panelClass:r.panelClass||void 0}));return t.setOrigin(this._getFlexibleConnectedPositionStrategyOrigin()).withPositions(i).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const t=this._overlay.position().flexibleConnectedTo(this._getFlexibleConnectedPositionStrategyOrigin());return this._updatePositionStrategy(t),t}_getFlexibleConnectedPositionStrategyOrigin(){return this.origin instanceof w2?this.origin.elementRef:this.origin}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(t=>{this.backdropClick.emit(t)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(ar(()=>this.positionChange.observers.length>0)).subscribe(t=>{this.positionChange.emit(t),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(p1),d.Y36(d.Rgc),d.Y36(d.s_b),d.Y36(JV),d.Y36(g_,8))},n.\u0275dir=d.lG2({type:n,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:["cdkConnectedOverlayOrigin","origin"],positions:["cdkConnectedOverlayPositions","positions"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:["cdkConnectedOverlayOpen","open"],disableClose:["cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[d.TTD]}),n})();const z9={provide:JV,deps:[p1],useFactory:function N9(n){return()=>n.scrollStrategies.reposition()}};let tU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[p1,z9],imports:[JE,w9,v2,v2]}),n})();const B9=["matFormFieldNotchedOutline",""],V9=["*"],U9=["textField"],j9=["iconPrefixContainer"],$9=["textPrefixContainer"];function G9(n,e){1&n&&d._UZ(0,"span",19)}function H9(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"label",17),d.NdJ("cdkObserveContent",function(){d.CHM(t);const r=d.oxw(2);return d.KtG(r._refreshOutlineNotchWidth())}),d.Hsn(1,1),d.YNc(2,G9,1,0,"span",18),d.qZA()}if(2&n){const t=d.oxw(2);d.Q6J("floating",t._shouldLabelFloat())("cdkObserveContentDisabled",!t._hasOutline())("id",t._labelId),d.uIk("for",t._control.id)("aria-owns",t._control.id),d.xp6(2),d.Q6J("ngIf",!t.hideRequiredMarker&&t._control.required)}}function q9(n,e){if(1&n&&d.YNc(0,H9,3,6,"label",16),2&n){const t=d.oxw();d.Q6J("ngIf",t._hasFloatingLabel())}}function W9(n,e){1&n&&d._UZ(0,"div",20)}function Z9(n,e){}function Y9(n,e){if(1&n&&d.YNc(0,Z9,0,0,"ng-template",22),2&n){d.oxw(2);const t=d.MAs(1);d.Q6J("ngTemplateOutlet",t)}}function K9(n,e){if(1&n&&(d.TgZ(0,"div",21),d.YNc(1,Y9,1,1,"ng-template",9),d.qZA()),2&n){const t=d.oxw();d.Q6J("matFormFieldNotchedOutlineOpen",t._shouldLabelFloat())("matFormFieldNotchedOutlineLabelWidth",t._labelWidth),d.xp6(1),d.Q6J("ngIf",!t._forceDisplayInfixLabel())}}function X9(n,e){1&n&&(d.TgZ(0,"div",23,24),d.Hsn(2,2),d.qZA())}function Q9(n,e){1&n&&(d.TgZ(0,"div",25,26),d.Hsn(2,3),d.qZA())}function J9(n,e){}function eK(n,e){if(1&n&&d.YNc(0,J9,0,0,"ng-template",22),2&n){d.oxw();const t=d.MAs(1);d.Q6J("ngTemplateOutlet",t)}}function tK(n,e){1&n&&(d.TgZ(0,"div",27),d.Hsn(1,4),d.qZA())}function nK(n,e){1&n&&(d.TgZ(0,"div",28),d.Hsn(1,5),d.qZA())}function iK(n,e){1&n&&d._UZ(0,"div",29)}function rK(n,e){if(1&n&&(d.TgZ(0,"div",30),d.Hsn(1,6),d.qZA()),2&n){const t=d.oxw();d.Q6J("@transitionMessages",t._subscriptAnimationState)}}function oK(n,e){if(1&n&&(d.TgZ(0,"mat-hint",34),d._uU(1),d.qZA()),2&n){const t=d.oxw(2);d.Q6J("id",t._hintLabelId),d.xp6(1),d.Oqu(t.hintLabel)}}function sK(n,e){if(1&n&&(d.TgZ(0,"div",31),d.YNc(1,oK,2,2,"mat-hint",32),d.Hsn(2,7),d._UZ(3,"div",33),d.Hsn(4,8),d.qZA()),2&n){const t=d.oxw();d.Q6J("@transitionMessages",t._subscriptAnimationState),d.xp6(1),d.Q6J("ngIf",t.hintLabel)}}const aK=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],lK=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];let nU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=d.lG2({type:n,selectors:[["mat-label"]]}),n})();const cK=new d.OlP("MatError");let uK=0,iU=(()=>{class n{constructor(){this.align="start",this.id="mat-mdc-hint-"+uK++}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=d.lG2({type:n,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(t,i){2&t&&(d.Ikx("id",i.id),d.uIk("align",null),d.ekj("mat-mdc-form-field-hint-end","end"===i.align))},inputs:{align:"align",id:"id"}}),n})();const dK=new d.OlP("MatPrefix"),hK=new d.OlP("MatSuffix");let rU=(()=>{class n{constructor(t){this._elementRef=t,this.floating=!1}getWidth(){return function fK(n){if(null!==n.offsetParent)return n.scrollWidth;const t=n.cloneNode(!0);t.style.setProperty("position","absolute"),t.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(t);const i=t.scrollWidth;return t.remove(),i}(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq))},n.\u0275dir=d.lG2({type:n,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(t,i){2&t&&d.ekj("mdc-floating-label--float-above",i.floating)},inputs:{floating:"floating"}}),n})();const oU="mdc-line-ripple--active",BM="mdc-line-ripple--deactivating";let sU=(()=>{class n{constructor(t,i){this._elementRef=t,this._handleTransitionEnd=r=>{const s=this._elementRef.nativeElement.classList,f=s.contains(BM);"opacity"===r.propertyName&&f&&s.remove(oU,BM)},i.runOutsideAngular(()=>{t.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){const t=this._elementRef.nativeElement.classList;t.remove(BM),t.add(oU)}deactivate(){this._elementRef.nativeElement.classList.add(BM)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq),d.Y36(d.R0b))},n.\u0275dir=d.lG2({type:n,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]}),n})(),aU=(()=>{class n{constructor(t,i){this._elementRef=t,this._ngZone=i,this.labelWidth=0,this.open=!1}ngAfterViewInit(){const t=this._elementRef.nativeElement.querySelector(".mdc-floating-label");t?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),"function"==typeof requestAnimationFrame&&(t.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>t.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_getNotchWidth(){return this.open?this.labelWidth>0?`calc(${this.labelWidth}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`:"0px":null}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq),d.Y36(d.R0b))},n.\u0275cmp=d.Xpm({type:n,selectors:[["div","matFormFieldNotchedOutline",""]],hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(t,i){2&t&&d.ekj("mdc-notched-outline--notched",i.open)},inputs:{labelWidth:["matFormFieldNotchedOutlineLabelWidth","labelWidth"],open:["matFormFieldNotchedOutlineOpen","open"]},attrs:B9,ngContentSelectors:V9,decls:4,vars:2,consts:[[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(t,i){1&t&&(d.F$t(),d._UZ(0,"div",0),d.TgZ(1,"div",1),d.Hsn(2),d.qZA(),d._UZ(3,"div",2)),2&t&&(d.xp6(1),d.Udp("width",i._getNotchWidth()))},encapsulation:2,changeDetection:0}),n})();const pK={transitionMessages:Rm("transitionMessages",[Pc("enter",Mo({opacity:1,transform:"translateY(0%)"})),Oc("void => enter",[Mo({opacity:0,transform:"translateY(-5px)"}),md("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let lU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=d.lG2({type:n}),n})();const cU=new d.OlP("MatFormField"),mK=new d.OlP("MAT_FORM_FIELD_DEFAULT_OPTIONS");let uU=0,yK=(()=>{class n{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(t){this._hideRequiredMarker=os(t)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||"auto"}set floatLabel(t){t!==this._floatLabel&&(this._floatLabel=t,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(t){const i=this._appearance;this._appearance=t||this._defaults?.appearance||"fill","outline"===this._appearance&&this._appearance!==i&&(this._refreshOutlineNotchWidth(),this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||"fixed"}set subscriptSizing(t){this._subscriptSizing=t||this._defaults?.subscriptSizing||"fixed"}get hintLabel(){return this._hintLabel}set hintLabel(t){this._hintLabel=t,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(t){this._explicitFormFieldControl=t}constructor(t,i,r,s,f,b,I,O){this._elementRef=t,this._changeDetectorRef=i,this._ngZone=r,this._dir=s,this._platform=f,this._defaults=b,this._animationMode=I,this._document=O,this._hideRequiredMarker=!1,this.color="primary",this._appearance="fill",this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId="mat-mdc-form-field-label-"+uU++,this._hintLabelId="mat-mdc-hint-"+uU++,this._subscriptAnimationState="",this._labelWidth=0,this._destroyed=new g.x,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,b&&(b.appearance&&(this.appearance=b.appearance),this._hideRequiredMarker=Boolean(b?.hideRequiredMarker),b.color&&(this.color=b.color))}ngAfterViewInit(){this._updateFocusState(),this._refreshOutlineNotchWidth(),this._document?.fonts?.ready?this._document.fonts.ready.then(()=>{this._refreshOutlineNotchWidth(),this._changeDetectorRef.markForCheck()}):setTimeout(()=>this._refreshOutlineNotchWidth(),100),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){const t=this._control;t.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${t.controlType}`),t.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),t.ngControl&&t.ngControl.valueChanges&&t.ngControl.valueChanges.pipe(qo(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(t=>!t._isText),this._hasTextPrefix=!!this._prefixChildren.find(t=>t._isText),this._hasIconSuffix=!!this._suffixChildren.find(t=>!t._isText),this._hasTextSuffix=!!this._suffixChildren.find(t=>t._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),(0,p_.T)(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||null===this._isFocused)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(qo(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(qo(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return"always"===this.floatLabel}_hasOutline(){return"outline"===this.appearance}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(t){const i=this._control?this._control.ngControl:null;return i&&i[t]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||(this._labelWidth=this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_syncDescribedByIds(){if(this._control){let t=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&t.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const i=this._hintChildren?this._hintChildren.find(s=>"start"===s.align):null,r=this._hintChildren?this._hintChildren.find(s=>"end"===s.align):null;i?t.push(i.id):this._hintLabel&&t.push(this._hintLabelId),r&&t.push(r.id)}else this._errorChildren&&t.push(...this._errorChildren.map(i=>i.id));this._control.setDescribedByIds(t)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;const t=this._floatingLabel.element;if(!this._iconPrefixContainer&&!this._textPrefixContainer)return void(t.style.transform="");if(!this._isAttachedToDom())return void(this._needsOutlineLabelOffsetUpdateOnStable=!0);const i=this._iconPrefixContainer?.nativeElement,r=this._textPrefixContainer?.nativeElement,s=i?.getBoundingClientRect().width??0,f=r?.getBoundingClientRect().width??0;t.style.transform=`var(\n        --mat-mdc-form-field-label-transform,\n        translateY(-50%) translateX(calc(${"rtl"===this._dir.value?"-1":"1"} * (${s+f}px + var(--mat-mdc-form-field-label-offset-x, 0px))))\n    )`}_isAttachedToDom(){const t=this._elementRef.nativeElement;if(t.getRootNode){const i=t.getRootNode();return i&&i!==t}return document.documentElement.contains(t)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq),d.Y36(d.sBO),d.Y36(d.R0b),d.Y36(g_),d.Y36(ec),d.Y36(mK,8),d.Y36(d.QbO,8),d.Y36(ft))},n.\u0275cmp=d.Xpm({type:n,selectors:[["mat-form-field"]],contentQueries:function(t,i,r){if(1&t&&(d.Suo(r,nU,5),d.Suo(r,nU,7),d.Suo(r,lU,5),d.Suo(r,dK,5),d.Suo(r,hK,5),d.Suo(r,cK,5),d.Suo(r,iU,5)),2&t){let s;d.iGM(s=d.CRH())&&(i._labelChildNonStatic=s.first),d.iGM(s=d.CRH())&&(i._labelChildStatic=s.first),d.iGM(s=d.CRH())&&(i._formFieldControl=s.first),d.iGM(s=d.CRH())&&(i._prefixChildren=s),d.iGM(s=d.CRH())&&(i._suffixChildren=s),d.iGM(s=d.CRH())&&(i._errorChildren=s),d.iGM(s=d.CRH())&&(i._hintChildren=s)}},viewQuery:function(t,i){if(1&t&&(d.Gf(U9,5),d.Gf(j9,5),d.Gf($9,5),d.Gf(rU,5),d.Gf(aU,5),d.Gf(sU,5)),2&t){let r;d.iGM(r=d.CRH())&&(i._textField=r.first),d.iGM(r=d.CRH())&&(i._iconPrefixContainer=r.first),d.iGM(r=d.CRH())&&(i._textPrefixContainer=r.first),d.iGM(r=d.CRH())&&(i._floatingLabel=r.first),d.iGM(r=d.CRH())&&(i._notchedOutline=r.first),d.iGM(r=d.CRH())&&(i._lineRipple=r.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(t,i){2&t&&d.ekj("mat-mdc-form-field-label-always-float",i._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",i._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",i._hasIconSuffix)("mat-form-field-invalid",i._control.errorState)("mat-form-field-disabled",i._control.disabled)("mat-form-field-autofilled",i._control.autofilled)("mat-form-field-no-animations","NoopAnimations"===i._animationMode)("mat-form-field-appearance-fill","fill"==i.appearance)("mat-form-field-appearance-outline","outline"==i.appearance)("mat-form-field-hide-placeholder",i._hasFloatingLabel()&&!i._shouldLabelFloat())("mat-focused",i._control.focused)("mat-primary","accent"!==i.color&&"warn"!==i.color)("mat-accent","accent"===i.color)("mat-warn","warn"===i.color)("ng-untouched",i._shouldForward("untouched"))("ng-touched",i._shouldForward("touched"))("ng-pristine",i._shouldForward("pristine"))("ng-dirty",i._shouldForward("dirty"))("ng-valid",i._shouldForward("valid"))("ng-invalid",i._shouldForward("invalid"))("ng-pending",i._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[d._Bn([{provide:cU,useExisting:n}])],ngContentSelectors:lK,decls:18,vars:23,consts:[["labelTemplate",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],["textField",""],["class","mat-mdc-form-field-focus-overlay",4,"ngIf"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen","matFormFieldNotchedOutlineLabelWidth",4,"ngIf"],["class","mat-mdc-form-field-icon-prefix",4,"ngIf"],["class","mat-mdc-form-field-text-prefix",4,"ngIf"],[1,"mat-mdc-form-field-infix"],[3,"ngIf"],["class","mat-mdc-form-field-text-suffix",4,"ngIf"],["class","mat-mdc-form-field-icon-suffix",4,"ngIf"],["matFormFieldLineRipple","",4,"ngIf"],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align",3,"ngSwitch"],["class","mat-mdc-form-field-error-wrapper",4,"ngSwitchCase"],["class","mat-mdc-form-field-hint-wrapper",4,"ngSwitchCase"],["matFormFieldFloatingLabel","",3,"floating","cdkObserveContentDisabled","id","cdkObserveContent",4,"ngIf"],["matFormFieldFloatingLabel","",3,"floating","cdkObserveContentDisabled","id","cdkObserveContent"],["aria-hidden","true","class","mat-mdc-form-field-required-marker mdc-floating-label--required",4,"ngIf"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-focus-overlay"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen","matFormFieldNotchedOutlineLabelWidth"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-icon-prefix"],["iconPrefixContainer",""],[1,"mat-mdc-form-field-text-prefix"],["textPrefixContainer",""],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id",4,"ngIf"],[1,"mat-mdc-form-field-hint-spacer"],[3,"id"]],template:function(t,i){1&t&&(d.F$t(aK),d.YNc(0,q9,1,1,"ng-template",null,0,d.W1O),d.TgZ(2,"div",1,2),d.NdJ("click",function(s){return i._control.onContainerClick&&i._control.onContainerClick(s)}),d.YNc(4,W9,1,0,"div",3),d.TgZ(5,"div",4),d.YNc(6,K9,2,3,"div",5),d.YNc(7,X9,3,0,"div",6),d.YNc(8,Q9,3,0,"div",7),d.TgZ(9,"div",8),d.YNc(10,eK,1,1,"ng-template",9),d.Hsn(11),d.qZA(),d.YNc(12,tK,2,0,"div",10),d.YNc(13,nK,2,0,"div",11),d.qZA(),d.YNc(14,iK,1,0,"div",12),d.qZA(),d.TgZ(15,"div",13),d.YNc(16,rK,2,1,"div",14),d.YNc(17,sK,5,2,"div",15),d.qZA()),2&t&&(d.xp6(2),d.ekj("mdc-text-field--filled",!i._hasOutline())("mdc-text-field--outlined",i._hasOutline())("mdc-text-field--no-label",!i._hasFloatingLabel())("mdc-text-field--disabled",i._control.disabled)("mdc-text-field--invalid",i._control.errorState),d.xp6(2),d.Q6J("ngIf",!i._hasOutline()&&!i._control.disabled),d.xp6(2),d.Q6J("ngIf",i._hasOutline()),d.xp6(1),d.Q6J("ngIf",i._hasIconPrefix),d.xp6(1),d.Q6J("ngIf",i._hasTextPrefix),d.xp6(2),d.Q6J("ngIf",!i._hasOutline()||i._forceDisplayInfixLabel()),d.xp6(2),d.Q6J("ngIf",i._hasTextSuffix),d.xp6(1),d.Q6J("ngIf",i._hasIconSuffix),d.xp6(1),d.Q6J("ngIf",!i._hasOutline()),d.xp6(1),d.ekj("mat-mdc-form-field-subscript-dynamic-size","dynamic"===i.subscriptSizing),d.Q6J("ngSwitch",i._getDisplayedMessages()),d.xp6(1),d.Q6J("ngSwitchCase","error"),d.xp6(1),d.Q6J("ngSwitchCase","hint"))},dependencies:[Bo,aa,ji,_d,E7,iU,rU,aU,sU],styles:['.mdc-text-field{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px, var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 96px / 0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{line-height:normal;pointer-events:all}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:12px;box-sizing:content-box}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0 - 0%)) translateY(-10.25px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-10.25px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-10.25px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-10.25px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-24.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-24.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-106%) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-106%) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}'],encapsulation:2,data:{animation:[pK.transitionMessages]},changeDetection:0}),n})(),vK=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[Za,vs,tV,Za]}),n})();class bK{}function C2(n){return n&&"function"==typeof n.connect&&!(n instanceof Lt)}class fU{applyChanges(e,t,i,r,s){e.forEachOperation((f,b,I)=>{let O,V;if(null==f.previousIndex){const X=i(f,b,I);O=t.createEmbeddedView(X.templateRef,X.context,X.index),V=1}else null==I?(t.remove(b),V=3):(O=t.get(b),t.move(O,I),V=2);s&&s({context:O?.context,operation:V,record:f})})}detach(){}}class xK{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(e=!1,t,i=!0,r){this._multiple=e,this._emitChanges=i,this.compareWith=r,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new g.x,t&&t.length&&(e?t.forEach(s=>this._markSelected(s)):this._markSelected(t[0]),this._selectedToEmit.length=0)}select(...e){this._verifyValueAssignment(e),e.forEach(i=>this._markSelected(i));const t=this._hasQueuedChanges();return this._emitChangeEvent(),t}deselect(...e){this._verifyValueAssignment(e),e.forEach(i=>this._unmarkSelected(i));const t=this._hasQueuedChanges();return this._emitChangeEvent(),t}setSelection(...e){this._verifyValueAssignment(e);const t=this.selected,i=new Set(e);e.forEach(s=>this._markSelected(s)),t.filter(s=>!i.has(s)).forEach(s=>this._unmarkSelected(s));const r=this._hasQueuedChanges();return this._emitChangeEvent(),r}toggle(e){return this.isSelected(e)?this.deselect(e):this.select(e)}clear(e=!0){this._unmarkAll();const t=this._hasQueuedChanges();return e&&this._emitChangeEvent(),t}isSelected(e){return this._selection.has(this._getConcreteValue(e))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(e){this._multiple&&this.selected&&this._selected.sort(e)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(e){e=this._getConcreteValue(e),this.isSelected(e)||(this._multiple||this._unmarkAll(),this.isSelected(e)||this._selection.add(e),this._emitChanges&&this._selectedToEmit.push(e))}_unmarkSelected(e){e=this._getConcreteValue(e),this.isSelected(e)&&(this._selection.delete(e),this._emitChanges&&this._deselectedToEmit.push(e))}_unmarkAll(){this.isEmpty()||this._selection.forEach(e=>this._unmarkSelected(e))}_verifyValueAssignment(e){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(e){if(this.compareWith){for(let t of this._selection)if(this.compareWith(e,t))return t;return e}return e}}const aT=new d.OlP("_ViewRepeater"),wK=["trigger"],CK=["panel"];function EK(n,e){if(1&n&&(d.TgZ(0,"span",10),d._uU(1),d.qZA()),2&n){const t=d.oxw();d.xp6(1),d.Oqu(t.placeholder)}}function TK(n,e){if(1&n&&(d.TgZ(0,"span",14),d._uU(1),d.qZA()),2&n){const t=d.oxw(2);d.xp6(1),d.Oqu(t.triggerValue)}}function IK(n,e){1&n&&d.Hsn(0,0,["*ngSwitchCase","true"])}function SK(n,e){if(1&n&&(d.TgZ(0,"span",11),d.YNc(1,TK,2,1,"span",12),d.YNc(2,IK,1,0,"ng-content",13),d.qZA()),2&n){const t=d.oxw();d.Q6J("ngSwitch",!!t.customTrigger),d.xp6(2),d.Q6J("ngSwitchCase",!0)}}function MK(n,e){if(1&n){const t=d.EpF();d.O4$(),d.kcU(),d.TgZ(0,"div",15,16),d.NdJ("@transformPanel.done",function(r){d.CHM(t);const s=d.oxw();return d.KtG(s._panelDoneAnimatingStream.next(r.toState))})("keydown",function(r){d.CHM(t);const s=d.oxw();return d.KtG(s._handleKeydown(r))}),d.Hsn(2,1),d.qZA()}if(2&n){const t=d.oxw();d.Gre("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",t._getPanelTheme(),""),d.Q6J("ngClass",t.panelClass)("@transformPanel","showing"),d.uIk("id",t.id+"-panel")("aria-multiselectable",t.multiple)("aria-label",t.ariaLabel||null)("aria-labelledby",t._getPanelAriaLabelledby())}}const DK=[[["mat-select-trigger"]],"*"],AK=["mat-select-trigger","*"],PK={transformPanelWrap:Rm("transformPanelWrap",[Oc("* => void",OV("@transformPanel",[PV()],{optional:!0}))]),transformPanel:Rm("transformPanel",[Pc("void",Mo({opacity:0,transform:"scale(1, 0.8)"})),Oc("void => showing",md("120ms cubic-bezier(0, 0, 0.2, 1)",Mo({opacity:1,transform:"scale(1, 1)"}))),Oc("* => void",md("100ms linear",Mo({opacity:0})))])};let mU=0;const gU=new d.OlP("mat-select-scroll-strategy"),kK=new d.OlP("MAT_SELECT_CONFIG"),RK={provide:gU,deps:[p1],useFactory:function OK(n){return()=>n.scrollStrategies.reposition()}},FK=new d.OlP("MatSelectTrigger");class LK{constructor(e,t){this.source=e,this.value=t}}const NK=_V(lY(eT(cY(class{constructor(n,e,t,i,r){this._elementRef=n,this._defaultErrorStateMatcher=e,this._parentForm=t,this._parentFormGroup=i,this.ngControl=r,this.stateChanges=new g.x}}))));let zK=(()=>{class n extends NK{get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(t){this._placeholder=t,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(du.required)??!1}set required(t){this._required=os(t),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(t){this._multiple=os(t)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(t){this._disableOptionCentering=os(t)}get compareWith(){return this._compareWith}set compareWith(t){this._compareWith=t,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(t){this._assignValue(t)&&this._onChange(t)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(t){this._typeaheadDebounceInterval=m_(t)}get id(){return this._id}set id(t){this._id=t||this._uid,this.stateChanges.next()}constructor(t,i,r,s,f,b,I,O,V,X,ae,me,Ie,Ge){super(f,s,I,O,X),this._viewportRuler=t,this._changeDetectorRef=i,this._ngZone=r,this._dir=b,this._parentFormField=V,this._liveAnnouncer=Ie,this._defaultOptions=Ge,this._panelOpen=!1,this._compareWith=(Je,Qt)=>Je===Qt,this._uid="mat-select-"+mU++,this._triggerAriaLabelledBy=null,this._destroy=new g.x,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+mU++,this._panelDoneAnimatingStream=new g.x,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this._multiple=!1,this._disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.optionSelectionChanges=Qe(()=>{const Je=this.options;return Je?Je.changes.pipe(gn(Je),dn(()=>(0,p_.T)(...Je.map(Qt=>Qt.onSelectionChange)))):this._ngZone.onStable.pipe(Yn(1),dn(()=>this.optionSelectionChanges))}),this.openedChange=new d.vpe,this._openedStream=this.openedChange.pipe(Yt(Je=>Je),(0,ue.U)(()=>{})),this._closedStream=this.openedChange.pipe(Yt(Je=>!Je),(0,ue.U)(()=>{})),this.selectionChange=new d.vpe,this.valueChange=new d.vpe,this.ngControl&&(this.ngControl.valueAccessor=this),null!=Ge?.typeaheadDebounceInterval&&(this._typeaheadDebounceInterval=Ge.typeaheadDebounceInterval),this._scrollStrategyFactory=me,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(ae)||0,this.id=this.id}ngOnInit(){this._selectionModel=new xK(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(CM(),qo(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen))}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe(qo(this._destroy)).subscribe(t=>{t.added.forEach(i=>i.select()),t.removed.forEach(i=>i.deselect())}),this.options.changes.pipe(gn(null),qo(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const t=this._getTriggerAriaLabelledby(),i=this.ngControl;if(t!==this._triggerAriaLabelledBy){const r=this._elementRef.nativeElement;this._triggerAriaLabelledBy=t,t?r.setAttribute("aria-labelledby",t):r.removeAttribute("aria-labelledby")}i&&(this._previousControl!==i.control&&(void 0!==this._previousControl&&null!==i.disabled&&i.disabled!==this.disabled&&(this.disabled=i.disabled),this._previousControl=i.control),this.updateErrorState())}ngOnChanges(t){(t.disabled||t.userAriaDescribedBy)&&this.stateChanges.next(),t.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(t){this._assignValue(t)}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const t=this._selectionModel.selected.map(i=>i.viewValue);return this._isRtl()&&t.reverse(),t.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(t){this.disabled||(this.panelOpen?this._handleOpenKeydown(t):this._handleClosedKeydown(t))}_handleClosedKeydown(t){const i=t.keyCode,r=40===i||38===i||37===i||39===i,s=13===i||32===i,f=this._keyManager;if(!f.isTyping()&&s&&!u1(t)||(this.multiple||t.altKey)&&r)t.preventDefault(),this.open();else if(!this.multiple){const b=this.selected;f.onKeydown(t);const I=this.selected;I&&b!==I&&this._liveAnnouncer.announce(I.viewValue,1e4)}}_handleOpenKeydown(t){const i=this._keyManager,r=t.keyCode,s=40===r||38===r,f=i.isTyping();if(s&&t.altKey)t.preventDefault(),this.close();else if(f||13!==r&&32!==r||!i.activeItem||u1(t))if(!f&&this._multiple&&65===r&&t.ctrlKey){t.preventDefault();const b=this.options.some(I=>!I.disabled&&!I.selected);this.options.forEach(I=>{I.disabled||(b?I.select():I.deselect())})}else{const b=i.activeItemIndex;i.onKeydown(t),this._multiple&&s&&t.shiftKey&&i.activeItem&&i.activeItemIndex!==b&&i.activeItem._selectViaInteraction()}else t.preventDefault(),i.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(Yn(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(t){if(this.options.forEach(i=>i.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&t)Array.isArray(t),t.forEach(i=>this._selectOptionByValue(i)),this._sortValues();else{const i=this._selectOptionByValue(t);i?this._keyManager.updateActiveItem(i):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(t){const i=this.options.find(r=>{if(this._selectionModel.isSelected(r))return!1;try{return null!=r.value&&this._compareWith(r.value,t)}catch{return!1}});return i&&this._selectionModel.select(i),i}_assignValue(t){return!!(t!==this._value||this._multiple&&Array.isArray(t))&&(this.options&&this._setSelectionByValue(t),this._value=t,!0)}_initKeyManager(){this._keyManager=new O7(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const t=(0,p_.T)(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(qo(t)).subscribe(i=>{this._onSelect(i.source,i.isUserInput),i.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),(0,p_.T)(...this.options.map(i=>i._stateChanges)).pipe(qo(t)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(t,i){const r=this._selectionModel.isSelected(t);null!=t.value||this._multiple?(r!==t.selected&&(t.selected?this._selectionModel.select(t):this._selectionModel.deselect(t)),i&&this._keyManager.setActiveItem(t),this.multiple&&(this._sortValues(),i&&this.focus())):(t.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(t.value)),r!==this._selectionModel.isSelected(t)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const t=this.options.toArray();this._selectionModel.sort((i,r)=>this.sortComparator?this.sortComparator(i,r,t):t.indexOf(i)-t.indexOf(r)),this.stateChanges.next()}}_propagateChanges(t){let i=null;i=this.multiple?this.selected.map(r=>r.value):this.selected?this.selected.value:t,this._value=i,this.valueChange.emit(i),this._onChange(i),this.selectionChange.emit(this._getChangeEvent(i)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(t){this._elementRef.nativeElement.focus(t)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const t=this._parentFormField?.getLabelId();return this.ariaLabelledby?(t?t+" ":"")+this.ariaLabelledby:t}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;const t=this._parentFormField?.getLabelId();let i=(t?t+" ":"")+this._valueId;return this.ariaLabelledby&&(i+=" "+this.ariaLabelledby),i}_panelDoneAnimating(t){this.openedChange.emit(t)}setDescribedByIds(t){t.length?this._elementRef.nativeElement.setAttribute("aria-describedby",t.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty||this._focused&&!!this._placeholder}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(sT),d.Y36(d.sBO),d.Y36(d.R0b),d.Y36(dY),d.Y36(d.SBq),d.Y36(g_,8),d.Y36(ym,8),d.Y36(pl,8),d.Y36(cU,8),d.Y36(hl,10),d.$8M("tabindex"),d.Y36(gU),d.Y36(H7),d.Y36(kK,8))},n.\u0275dir=d.lG2({type:n,viewQuery:function(t,i){if(1&t&&(d.Gf(wK,5),d.Gf(CK,5),d.Gf(eU,5)),2&t){let r;d.iGM(r=d.CRH())&&(i.trigger=r.first),d.iGM(r=d.CRH())&&(i.panel=r.first),d.iGM(r=d.CRH())&&(i._overlayDir=r.first)}},inputs:{userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",placeholder:"placeholder",required:"required",multiple:"multiple",disableOptionCentering:"disableOptionCentering",compareWith:"compareWith",value:"value",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:"typeaheadDebounceInterval",sortComparator:"sortComparator",id:"id"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},features:[d.qOj,d.TTD]}),n})(),BK=(()=>{class n extends zK{constructor(){super(...arguments),this._positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}],this._hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}ngOnInit(){super.ngOnInit(),this._viewportRuler.change().pipe(qo(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(),this._changeDetectorRef.detectChanges())})}ngAfterViewInit(){this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin())}open(){this._overlayWidth=this._getOverlayWidth(),super.open(),this.stateChanges.next()}close(){super.close(),this.stateChanges.next()}_scrollOptionIntoView(t){const i=this.options.toArray()[t];if(i){const r=this.panel.nativeElement,s=function wY(n,e,t){if(t.length){let i=e.toArray(),r=t.toArray(),s=0;for(let f=0;f<n+1;f++)i[f].group&&i[f].group===r[s]&&s++;return s}return 0}(t,this.options,this.optionGroups),f=i._getHostElement();r.scrollTop=0===t&&1===s?0:function CY(n,e,t,i){return n<t?n:n+e>t+i?Math.max(0,n-i+e):t}(f.offsetTop,f.offsetHeight,r.scrollTop,r.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(t){return new LK(this,t)}_getOverlayWidth(){return(this._preferredOverlayOrigin instanceof w2?this._preferredOverlayOrigin.elementRef:this._preferredOverlayOrigin||this._elementRef).nativeElement.getBoundingClientRect().width}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(t){this._hideSingleSelectionIndicator=os(t),this._syncParentProperties()}_syncParentProperties(){if(this.options)for(const t of this.options)t._changeDetectorRef.markForCheck()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275cmp=d.Xpm({type:n,selectors:[["mat-select"]],contentQueries:function(t,i,r){if(1&t&&(d.Suo(r,FK,5),d.Suo(r,SV,5),d.Suo(r,IV,5)),2&t){let s;d.iGM(s=d.CRH())&&(i.customTrigger=s.first),d.iGM(s=d.CRH())&&(i.options=s),d.iGM(s=d.CRH())&&(i.optionGroups=s)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","listbox",1,"mat-mdc-select"],hostVars:19,hostBindings:function(t,i){1&t&&d.NdJ("keydown",function(s){return i._handleKeydown(s)})("focus",function(){return i._onFocus()})("blur",function(){return i._onBlur()}),2&t&&(d.uIk("id",i.id)("tabindex",i.tabIndex)("aria-controls",i.panelOpen?i.id+"-panel":null)("aria-expanded",i.panelOpen)("aria-label",i.ariaLabel||null)("aria-required",i.required.toString())("aria-disabled",i.disabled.toString())("aria-invalid",i.errorState)("aria-activedescendant",i._getAriaActiveDescendant()),d.ekj("mat-mdc-select-disabled",i.disabled)("mat-mdc-select-invalid",i.errorState)("mat-mdc-select-required",i.required)("mat-mdc-select-empty",i.empty)("mat-mdc-select-multiple",i.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matSelect"],features:[d._Bn([{provide:lU,useExisting:n},{provide:TV,useExisting:n}]),d.qOj],ngContentSelectors:AK,decls:11,vars:11,consts:[["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],[1,"mat-mdc-select-value",3,"ngSwitch"],["class","mat-mdc-select-placeholder mat-mdc-select-min-line",4,"ngSwitchCase"],["class","mat-mdc-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth","backdropClick","attach","detach"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text",3,"ngSwitch"],["class","mat-mdc-select-min-line",4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(t,i){if(1&t&&(d.F$t(DK),d.TgZ(0,"div",0,1),d.NdJ("click",function(){return i.toggle()}),d.TgZ(3,"div",2),d.YNc(4,EK,2,1,"span",3),d.YNc(5,SK,3,2,"span",4),d.qZA(),d.TgZ(6,"div",5)(7,"div",6),d.O4$(),d.TgZ(8,"svg",7),d._UZ(9,"path",8),d.qZA()()()(),d.YNc(10,MK,3,9,"ng-template",9),d.NdJ("backdropClick",function(){return i.close()})("attach",function(){return i._onAttached()})("detach",function(){return i.close()})),2&t){const r=d.MAs(1);d.uIk("aria-owns",i.panelOpen?i.id+"-panel":null),d.xp6(3),d.Q6J("ngSwitch",i.empty),d.uIk("id",i._valueId),d.xp6(1),d.Q6J("ngSwitchCase",!0),d.xp6(1),d.Q6J("ngSwitchCase",!1),d.xp6(5),d.Q6J("cdkConnectedOverlayPanelClass",i._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",i._scrollStrategy)("cdkConnectedOverlayOrigin",i._preferredOverlayOrigin||r)("cdkConnectedOverlayOpen",i.panelOpen)("cdkConnectedOverlayPositions",i._positions)("cdkConnectedOverlayWidth",i._overlayWidth)}},dependencies:[Mn,ji,_d,co,eU,w2],styles:['.mdc-menu-surface{display:none;position:absolute;box-sizing:border-box;max-width:calc(100vw - 32px);max-width:var(--mdc-menu-max-width, calc(100vw - 32px));max-height:calc(100vh - 32px);max-height:var(--mdc-menu-max-height, calc(100vh - 32px));margin:0;padding:0;transform:scale(1);transform-origin:top left;opacity:0;overflow:auto;will-change:transform,opacity;z-index:8;border-radius:4px;border-radius:var(--mdc-shape-medium, 4px);transform-origin-left:top left;transform-origin-right:top right}.mdc-menu-surface:focus{outline:none}.mdc-menu-surface--animating-open{display:inline-block;transform:scale(0.8);opacity:0}.mdc-menu-surface--open{display:inline-block;transform:scale(1);opacity:1}.mdc-menu-surface--animating-closed{display:inline-block;opacity:0}[dir=rtl] .mdc-menu-surface,.mdc-menu-surface[dir=rtl]{transform-origin-left:top right;transform-origin-right:top left}.mdc-menu-surface--anchor{position:relative;overflow:visible}.mdc-menu-surface--fixed{position:fixed}.mdc-menu-surface--fullwidth{width:100%}.mat-mdc-select{display:inline-block;width:100%;outline:none}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:translateY(-8px)}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-select-arrow{width:10px;height:5px;position:relative}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:GrayText}.mdc-menu-surface.mat-mdc-select-panel{width:100%;max-height:275px;position:static;outline:0;margin:0;padding:8px 0;list-style-type:none}.mdc-menu-surface.mat-mdc-select-panel:focus{outline:none}.cdk-high-contrast-active .mdc-menu-surface.mat-mdc-select-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) .mdc-menu-surface.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above .mdc-menu-surface.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}'],encapsulation:2,data:{animation:[PK.transformPanel]},changeDetection:0}),n})(),VK=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[RK],imports:[vs,tU,MV,Za,zM,vK,MV,Za]}),n})();const UK=["tooltip"],_U=new d.OlP("mat-tooltip-scroll-strategy"),GK={provide:_U,deps:[p1],useFactory:function $K(n){return()=>n.scrollStrategies.reposition({scrollThrottle:20})}},qK=new d.OlP("mat-tooltip-default-options",{providedIn:"root",factory:function HK(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),yU="tooltip-panel",vU=XE({passive:!0});let QK=(()=>{class n{get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(t){this._positionAtOrigin=os(t),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(t){this._disabled=os(t),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=m_(t)}get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=m_(t),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(t){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=t?String(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(t,i,r,s,f,b,I,O,V,X,ae,me){this._overlay=t,this._elementRef=i,this._scrollDispatcher=r,this._viewContainerRef=s,this._ngZone=f,this._platform=b,this._ariaDescriber=I,this._focusMonitor=O,this._dir=X,this._defaultOptions=ae,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._viewportMargin=8,this._cssClassPrefix="mat",this._showDelay=this._defaultOptions.showDelay,this._hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new g.x,this._scrollStrategy=V,this._document=me,ae&&(ae.position&&(this.position=ae.position),ae.positionAtOrigin&&(this.positionAtOrigin=ae.positionAtOrigin),ae.touchGestures&&(this.touchGestures=ae.touchGestures)),X.change.pipe(qo(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(qo(this._destroyed)).subscribe(t=>{t?"keyboard"===t&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const t=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([i,r])=>{t.removeEventListener(i,r,vU)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(t,this.message,"tooltip"),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay,i){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const r=this._createOverlay(i);this._detach(),this._portal=this._portal||new UV(this._tooltipComponent,this._viewContainerRef);const s=this._tooltipInstance=r.attach(this._portal).instance;s._triggerElement=this._elementRef.nativeElement,s._mouseLeaveHideDelay=this._hideDelay,s.afterHidden().pipe(qo(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),s.show(t)}hide(t=this.hideDelay){const i=this._tooltipInstance;i&&(i.isVisible()?i.hide(t):(i._cancelPendingAnimations(),this._detach()))}toggle(t){this._isTooltipVisible()?this.hide():this.show(void 0,t)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(t){if(this._overlayRef){const s=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!t)&&s._origin instanceof d.SBq)return this._overlayRef;this._detach()}const i=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),r=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin&&t||this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(i);return r.positionChanges.pipe(qo(this._destroyed)).subscribe(s=>{this._updateCurrentPositionClass(s.connectionPair),this._tooltipInstance&&s.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:r,panelClass:`${this._cssClassPrefix}-${yU}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(qo(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(qo(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(qo(this._destroyed)).subscribe(s=>{this._isTooltipVisible()&&27===s.keyCode&&!u1(s)&&(s.preventDefault(),s.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(t){const i=t.getConfig().positionStrategy,r=this._getOrigin(),s=this._getOverlayPosition();i.withPositions([this._addOffset({...r.main,...s.main}),this._addOffset({...r.fallback,...s.fallback})])}_addOffset(t){return t}_getOrigin(){const t=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i||"below"==i?r={originX:"center",originY:"above"==i?"top":"bottom"}:"before"==i||"left"==i&&t||"right"==i&&!t?r={originX:"start",originY:"center"}:("after"==i||"right"==i&&t||"left"==i&&!t)&&(r={originX:"end",originY:"center"});const{x:s,y:f}=this._invertPosition(r.originX,r.originY);return{main:r,fallback:{originX:s,originY:f}}}_getOverlayPosition(){const t=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i?r={overlayX:"center",overlayY:"bottom"}:"below"==i?r={overlayX:"center",overlayY:"top"}:"before"==i||"left"==i&&t||"right"==i&&!t?r={overlayX:"end",overlayY:"center"}:("after"==i||"right"==i&&t||"left"==i&&!t)&&(r={overlayX:"start",overlayY:"center"});const{x:s,y:f}=this._invertPosition(r.overlayX,r.overlayY);return{main:r,fallback:{overlayX:s,overlayY:f}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(Yn(1),qo(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,i){return"above"===this.position||"below"===this.position?"top"===i?i="bottom":"bottom"===i&&(i="top"):"end"===t?t="start":"start"===t&&(t="end"),{x:t,y:i}}_updateCurrentPositionClass(t){const{overlayY:i,originX:r,originY:s}=t;let f;if(f="center"===i?this._dir&&"rtl"===this._dir.value?"end"===r?"left":"right":"start"===r?"left":"right":"bottom"===i&&"top"===s?"above":"below",f!==this._currentPosition){const b=this._overlayRef;if(b){const I=`${this._cssClassPrefix}-${yU}-`;b.removePanelClass(I+this._currentPosition),b.addPanelClass(I+f)}this._currentPosition=f}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",t=>{let i;this._setupPointerExitEventsIfNeeded(),void 0!==t.x&&void 0!==t.y&&(i=t),this.show(void 0,i)}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",t=>{const i=t.targetTouches?.[0],r=i?{x:i.clientX,y:i.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(void 0,r),500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const t=[];if(this._platformSupportsMouseEvents())t.push(["mouseleave",i=>{const r=i.relatedTarget;(!r||!this._overlayRef?.overlayElement.contains(r))&&this.hide()}],["wheel",i=>this._wheelListener(i)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const i=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};t.push(["touchend",i],["touchcancel",i])}this._addListeners(t),this._passiveListeners.push(...t)}_addListeners(t){t.forEach(([i,r])=>{this._elementRef.nativeElement.addEventListener(i,r,vU)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(t){if(this._isTooltipVisible()){const i=this._document.elementFromPoint(t.clientX,t.clientY),r=this._elementRef.nativeElement;i!==r&&!r.contains(i)&&this.hide()}}_disableNativeGesturesIfNecessary(){const t=this.touchGestures;if("off"!==t){const i=this._elementRef.nativeElement,r=i.style;("on"===t||"INPUT"!==i.nodeName&&"TEXTAREA"!==i.nodeName)&&(r.userSelect=r.msUserSelect=r.webkitUserSelect=r.MozUserSelect="none"),("on"===t||!i.draggable)&&(r.webkitUserDrag="none"),r.touchAction="none",r.webkitTapHighlightColor="transparent"}}}return n.\u0275fac=function(t){d.$Z()},n.\u0275dir=d.lG2({type:n,inputs:{position:["matTooltipPosition","position"],positionAtOrigin:["matTooltipPositionAtOrigin","positionAtOrigin"],disabled:["matTooltipDisabled","disabled"],showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]}}),n})(),bU=(()=>{class n extends QK{constructor(t,i,r,s,f,b,I,O,V,X,ae,me){super(t,i,r,s,f,b,I,O,V,X,ae,me),this._tooltipComponent=eX,this._cssClassPrefix="mat-mdc",this._viewportMargin=8}_addOffset(t){const r=!this._dir||"ltr"==this._dir.value;return"top"===t.originY?t.offsetY=-8:"bottom"===t.originY?t.offsetY=8:"start"===t.originX?t.offsetX=r?-8:8:"end"===t.originX&&(t.offsetX=r?8:-8),t}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(p1),d.Y36(d.SBq),d.Y36(oT),d.Y36(d.s_b),d.Y36(d.R0b),d.Y36(ec),d.Y36(sV),d.Y36(u2),d.Y36(_U),d.Y36(g_,8),d.Y36(qK,8),d.Y36(ft))},n.\u0275dir=d.lG2({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],exportAs:["matTooltip"],features:[d.qOj]}),n})(),JK=(()=>{class n{constructor(t,i){this._changeDetectorRef=t,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new g.x,this._animationsDisabled="NoopAnimations"===i}show(t){clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},t)}hide(t){clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},t)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:t}){(!t||!this._triggerElement.contains(t))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){}_handleAnimationEnd({animationName:t}){(t===this._showAnimation||t===this._hideAnimation)&&this._finalizeAnimation(t===this._showAnimation)}_cancelPendingAnimations(){clearTimeout(this._showTimeoutId),clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(t){t?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(t){const i=this._tooltip.nativeElement,r=this._showAnimation,s=this._hideAnimation;if(i.classList.remove(t?s:r),i.classList.add(t?r:s),this._isVisible=t,t&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const f=getComputedStyle(i);("0s"===f.getPropertyValue("animation-duration")||"none"===f.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}t&&this._onShow(),this._animationsDisabled&&(i.classList.add("_mat-animation-noopable"),this._finalizeAnimation(t))}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.sBO),d.Y36(d.QbO,8))},n.\u0275dir=d.lG2({type:n}),n})(),eX=(()=>{class n extends JK{constructor(t,i,r){super(t,r),this._elementRef=i,this._isMultiline=!1,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide"}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){const t=this._elementRef.nativeElement.getBoundingClientRect();return t.height>24&&t.width>=200}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.QbO,8))},n.\u0275cmp=d.Xpm({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(t,i){if(1&t&&d.Gf(UK,7),2&t){let r;d.iGM(r=d.CRH())&&(i._tooltip=r.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(t,i){1&t&&d.NdJ("mouseleave",function(s){return i._handleMouseLeave(s)}),2&t&&d.Udp("zoom",i.isVisible()?1:null)},features:[d.qOj],decls:4,vars:4,consts:[[1,"mdc-tooltip","mdc-tooltip--shown","mat-mdc-tooltip",3,"ngClass","animationend"],["tooltip",""],[1,"mdc-tooltip__surface","mdc-tooltip__surface-animation"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0,1),d.NdJ("animationend",function(s){return i._handleAnimationEnd(s)}),d.TgZ(2,"div",2),d._uU(3),d.qZA()()),2&t&&(d.ekj("mdc-tooltip--multiline",i._isMultiline),d.Q6J("ngClass",i.tooltipClass),d.xp6(3),d.Oqu(i.message))},dependencies:[Mn],styles:['.mdc-tooltip__surface{word-break:var(--mdc-tooltip-word-break, normal);overflow-wrap:anywhere}.mdc-tooltip{position:fixed;display:none;z-index:9}.mdc-tooltip-wrapper--rich{position:relative}.mdc-tooltip--shown,.mdc-tooltip--showing,.mdc-tooltip--hide{display:inline-flex}.mdc-tooltip--shown.mdc-tooltip--rich,.mdc-tooltip--showing.mdc-tooltip--rich,.mdc-tooltip--hide.mdc-tooltip--rich{display:inline-block;left:-320px;position:absolute}.mdc-tooltip__surface{line-height:16px;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center}.mdc-tooltip__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-tooltip__surface::before{border-color:CanvasText}}.mdc-tooltip--rich .mdc-tooltip__surface{align-items:flex-start;display:flex;flex-direction:column;min-height:24px;min-width:40px;max-width:320px;position:relative}.mdc-tooltip--multiline .mdc-tooltip__surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mdc-tooltip__surface,.mdc-tooltip--multiline .mdc-tooltip__surface[dir=rtl]{text-align:right}.mdc-tooltip__surface .mdc-tooltip__title{margin:0 8px}.mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(200px - (2 * 8px));margin:8px;text-align:left}[dir=rtl] .mdc-tooltip__surface .mdc-tooltip__content,.mdc-tooltip__surface .mdc-tooltip__content[dir=rtl]{text-align:right}.mdc-tooltip--rich .mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(320px - (2 * 8px));align-self:stretch}.mdc-tooltip__surface .mdc-tooltip__content-link{text-decoration:none}.mdc-tooltip--rich-actions,.mdc-tooltip__content,.mdc-tooltip__title{z-index:1}.mdc-tooltip__surface-animation{opacity:0;transform:scale(0.8);will-change:transform,opacity}.mdc-tooltip--shown .mdc-tooltip__surface-animation{transform:scale(1);opacity:1}.mdc-tooltip--hide .mdc-tooltip__surface-animation{transform:scale(1)}.mdc-tooltip__caret-surface-top,.mdc-tooltip__caret-surface-bottom{position:absolute;height:24px;width:24px;transform:rotate(35deg) skewY(20deg) scaleX(0.9396926208)}.mdc-tooltip__caret-surface-top .mdc-elevation-overlay,.mdc-tooltip__caret-surface-bottom .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-tooltip__caret-surface-bottom{outline:1px solid rgba(0,0,0,0);z-index:-1}@media screen and (forced-colors: active){.mdc-tooltip__caret-surface-bottom{outline-color:CanvasText}}.mdc-tooltip__surface{background-color:var(--mdc-plain-tooltip-container-color, #fff)}.mdc-tooltip__surface{border-radius:var(--mdc-plain-tooltip-container-shape, var(--mdc-shape-small, 4px))}.mdc-tooltip__caret-surface-top,.mdc-tooltip__caret-surface-bottom{border-radius:var(--mdc-plain-tooltip-container-shape, var(--mdc-shape-small, 4px))}.mdc-tooltip__surface{color:var(--mdc-plain-tooltip-supporting-text-color, #000)}.mdc-tooltip__surface{font-family:var(--mdc-plain-tooltip-supporting-text-font, inherit);font-size:var(--mdc-plain-tooltip-supporting-text-size, inherit);font-weight:var(--mdc-plain-tooltip-supporting-text-weight, inherit);letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, inherit)}.mat-mdc-tooltip{position:relative;transform:scale(0)}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0}),n})(),xU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[GK],imports:[W7,vs,tU,Za,Za,zM]}),n})();function tX(n,e){if(1&n&&(d.TgZ(0,"mat-option",19),d._uU(1),d.qZA()),2&n){const t=e.$implicit;d.Q6J("value",t),d.xp6(1),d.hij(" ",t," ")}}function nX(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"mat-form-field",16)(1,"mat-select",17),d.NdJ("selectionChange",function(r){d.CHM(t);const s=d.oxw(2);return d.KtG(s._changePageSize(r.value))}),d.YNc(2,tX,2,2,"mat-option",18),d.qZA()()}if(2&n){const t=d.oxw(2);d.Q6J("appearance",t._formFieldAppearance)("color",t.color),d.xp6(1),d.Q6J("value",t.pageSize)("disabled",t.disabled)("aria-labelledby",t._pageSizeLabelId)("panelClass",t.selectConfig.panelClass||"")("disableOptionCentering",t.selectConfig.disableOptionCentering),d.xp6(1),d.Q6J("ngForOf",t._displayedPageSizeOptions)}}function iX(n,e){if(1&n&&(d.TgZ(0,"div",20),d._uU(1),d.qZA()),2&n){const t=d.oxw(2);d.xp6(1),d.Oqu(t.pageSize)}}function rX(n,e){if(1&n&&(d.TgZ(0,"div",12)(1,"div",13),d._uU(2),d.qZA(),d.YNc(3,nX,3,8,"mat-form-field",14),d.YNc(4,iX,2,1,"div",15),d.qZA()),2&n){const t=d.oxw();d.xp6(1),d.s9C("id",t._pageSizeLabelId),d.xp6(1),d.hij(" ",t._intl.itemsPerPageLabel," "),d.xp6(1),d.Q6J("ngIf",t._displayedPageSizeOptions.length>1),d.xp6(1),d.Q6J("ngIf",t._displayedPageSizeOptions.length<=1)}}function oX(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"button",21),d.NdJ("click",function(){d.CHM(t);const r=d.oxw();return d.KtG(r.firstPage())}),d.O4$(),d.TgZ(1,"svg",7),d._UZ(2,"path",22),d.qZA()()}if(2&n){const t=d.oxw();d.Q6J("matTooltip",t._intl.firstPageLabel)("matTooltipDisabled",t._previousButtonsDisabled())("matTooltipPosition","above")("disabled",t._previousButtonsDisabled()),d.uIk("aria-label",t._intl.firstPageLabel)}}function sX(n,e){if(1&n){const t=d.EpF();d.O4$(),d.kcU(),d.TgZ(0,"button",23),d.NdJ("click",function(){d.CHM(t);const r=d.oxw();return d.KtG(r.lastPage())}),d.O4$(),d.TgZ(1,"svg",7),d._UZ(2,"path",24),d.qZA()()}if(2&n){const t=d.oxw();d.Q6J("matTooltip",t._intl.lastPageLabel)("matTooltipDisabled",t._nextButtonsDisabled())("matTooltipPosition","above")("disabled",t._nextButtonsDisabled()),d.uIk("aria-label",t._intl.lastPageLabel)}}let VM=(()=>{class n{constructor(){this.changes=new g.x,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(t,i,r)=>{if(0==r||0==i)return`0 of ${r}`;const s=t*i;return`${s+1} \u2013 ${s<(r=Math.max(r,0))?Math.min(s+i,r):s+i} of ${r}`}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const lX={provide:VM,deps:[[new d.FiY,new d.tp0,VM]],useFactory:function aX(n){return n||new VM}},uX=new d.OlP("MAT_PAGINATOR_DEFAULT_OPTIONS"),dX=eT(yV(class{}));let hX=(()=>{class n extends dX{get pageIndex(){return this._pageIndex}set pageIndex(t){this._pageIndex=Math.max(m_(t),0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(t){this._length=m_(t),this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(t){this._pageSize=Math.max(m_(t),0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(t){this._pageSizeOptions=(t||[]).map(i=>m_(i)),this._updateDisplayedPageSizeOptions()}get hidePageSize(){return this._hidePageSize}set hidePageSize(t){this._hidePageSize=os(t)}get showFirstLastButtons(){return this._showFirstLastButtons}set showFirstLastButtons(t){this._showFirstLastButtons=os(t)}constructor(t,i,r){if(super(),this._intl=t,this._changeDetectorRef=i,this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this._hidePageSize=!1,this._showFirstLastButtons=!1,this.selectConfig={},this.page=new d.vpe,this._intlChanges=t.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),r){const{pageSize:s,pageSizeOptions:f,hidePageSize:b,showFirstLastButtons:I}=r;null!=s&&(this._pageSize=s),null!=f&&(this._pageSizeOptions=f),null!=b&&(this._hidePageSize=b),null!=I&&(this._showFirstLastButtons=I)}}ngOnInit(){this._initialized=!0,this._updateDisplayedPageSizeOptions(),this._markInitialized()}ngOnDestroy(){this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex=this.pageIndex+1,this._emitPageEvent(t)}previousPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex=this.pageIndex-1,this._emitPageEvent(t)}firstPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex=0,this._emitPageEvent(t)}lastPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(t)}hasPreviousPage(){return this.pageIndex>=1&&0!=this.pageSize}hasNextPage(){const t=this.getNumberOfPages()-1;return this.pageIndex<t&&0!=this.pageSize}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(t){const r=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/t)||0,this.pageSize=t,this._emitPageEvent(r)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._initialized&&(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((t,i)=>t-i),this._changeDetectorRef.markForCheck())}_emitPageEvent(t){this.page.emit({previousPageIndex:t,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}}return n.\u0275fac=function(t){d.$Z()},n.\u0275dir=d.lG2({type:n,inputs:{color:"color",pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",hidePageSize:"hidePageSize",showFirstLastButtons:"showFirstLastButtons",selectConfig:"selectConfig"},outputs:{page:"page"},features:[d.qOj]}),n})(),fX=0,wU=(()=>{class n extends hX{constructor(t,i,r){super(t,i,r),this._pageSizeLabelId="mat-paginator-page-size-label-"+fX++,this._formFieldAppearance=r?.formFieldAppearance||"outline"}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(VM),d.Y36(d.sBO),d.Y36(uX,8))},n.\u0275cmp=d.Xpm({type:n,selectors:[["mat-paginator"]],hostAttrs:["role","group",1,"mat-mdc-paginator"],inputs:{disabled:"disabled"},exportAs:["matPaginator"],features:[d.qOj],decls:14,vars:14,consts:[[1,"mat-mdc-paginator-outer-container"],[1,"mat-mdc-paginator-container"],["class","mat-mdc-paginator-page-size",4,"ngIf"],[1,"mat-mdc-paginator-range-actions"],["aria-live","polite",1,"mat-mdc-paginator-range-label"],["mat-icon-button","","type","button","class","mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-previous",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["viewBox","0 0 24 24","focusable","false",1,"mat-mdc-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-next",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","class","mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],[1,"mat-mdc-paginator-page-size"],[1,"mat-mdc-paginator-page-size-label",3,"id"],["class","mat-mdc-paginator-page-size-select",3,"appearance","color",4,"ngIf"],["class","mat-mdc-paginator-page-size-value",4,"ngIf"],[1,"mat-mdc-paginator-page-size-select",3,"appearance","color"],["hideSingleSelectionIndicator","",3,"value","disabled","aria-labelledby","panelClass","disableOptionCentering","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-mdc-paginator-page-size-value"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"div",1),d.YNc(2,rX,5,4,"div",2),d.TgZ(3,"div",3)(4,"div",4),d._uU(5),d.qZA(),d.YNc(6,oX,3,5,"button",5),d.TgZ(7,"button",6),d.NdJ("click",function(){return i.previousPage()}),d.O4$(),d.TgZ(8,"svg",7),d._UZ(9,"path",8),d.qZA()(),d.kcU(),d.TgZ(10,"button",9),d.NdJ("click",function(){return i.nextPage()}),d.O4$(),d.TgZ(11,"svg",7),d._UZ(12,"path",10),d.qZA()(),d.YNc(13,sX,3,5,"button",11),d.qZA()()()),2&t&&(d.xp6(2),d.Q6J("ngIf",!i.hidePageSize),d.xp6(3),d.hij(" ",i._intl.getRangeLabel(i.pageIndex,i.pageSize,i.length)," "),d.xp6(1),d.Q6J("ngIf",i.showFirstLastButtons),d.xp6(1),d.Q6J("matTooltip",i._intl.previousPageLabel)("matTooltipDisabled",i._previousButtonsDisabled())("matTooltipPosition","above")("disabled",i._previousButtonsDisabled()),d.uIk("aria-label",i._intl.previousPageLabel),d.xp6(3),d.Q6J("matTooltip",i._intl.nextPageLabel)("matTooltipDisabled",i._nextButtonsDisabled())("matTooltipPosition","above")("disabled",i._nextButtonsDisabled()),d.uIk("aria-label",i._intl.nextPageLabel),d.xp6(3),d.Q6J("ngIf",i.showFirstLastButtons))},dependencies:[ur,Bo,g2,yK,BK,SV,bU],styles:[".mat-mdc-paginator{display:block}.mat-mdc-paginator .mat-mdc-form-field-subscript-wrapper{display:none}.mat-mdc-paginator .mat-mdc-select{line-height:1.5}.mat-mdc-paginator-outer-container{display:flex}.mat-mdc-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap-reverse;width:100%}.mat-mdc-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-mdc-paginator-page-size{margin-right:0;margin-left:8px}.mat-mdc-paginator-page-size-label{margin:0 4px}.mat-mdc-paginator-page-size-select{margin:0 4px;width:84px}.mat-mdc-paginator-range-label{margin:0 32px 0 24px}.mat-mdc-paginator-range-actions{display:flex;align-items:center}.mat-mdc-paginator-icon{display:inline-block;width:28px}[dir=rtl] .mat-mdc-paginator-icon{transform:rotate(180deg)}.cdk-high-contrast-active .mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon,.cdk-high-contrast-active .mat-mdc-paginator-icon{fill:currentColor;fill:CanvasText}.cdk-high-contrast-active .mat-mdc-paginator-range-actions .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),pX=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[lX],imports:[vs,LV,VK,xU]}),n})();const gX=[[["caption"]],[["colgroup"],["col"]]],_X=["caption","colgroup, col"];function E2(n){return class extends n{get sticky(){return this._sticky}set sticky(e){const t=this._sticky;this._sticky=os(e),this._hasStickyChanged=t!==this._sticky}hasStickyChanged(){const e=this._hasStickyChanged;return this._hasStickyChanged=!1,e}resetStickyChanged(){this._hasStickyChanged=!1}constructor(...e){super(...e),this._sticky=!1,this._hasStickyChanged=!1}}}const m1=new d.OlP("CDK_TABLE");let g1=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.Rgc))},n.\u0275dir=d.lG2({type:n,selectors:[["","cdkCellDef",""]]}),n})(),_1=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.Rgc))},n.\u0275dir=d.lG2({type:n,selectors:[["","cdkHeaderCellDef",""]]}),n})(),UM=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.Rgc))},n.\u0275dir=d.lG2({type:n,selectors:[["","cdkFooterCellDef",""]]}),n})();class xX{}const wX=E2(xX);let y_=(()=>{class n extends wX{get name(){return this._name}set name(t){this._setNameInput(t)}get stickyEnd(){return this._stickyEnd}set stickyEnd(t){const i=this._stickyEnd;this._stickyEnd=os(t),this._hasStickyChanged=i!==this._stickyEnd}constructor(t){super(),this._table=t,this._stickyEnd=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(t){t&&(this._name=t,this.cssClassFriendlyName=t.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(m1,8))},n.\u0275dir=d.lG2({type:n,selectors:[["","cdkColumnDef",""]],contentQueries:function(t,i,r){if(1&t&&(d.Suo(r,g1,5),d.Suo(r,_1,5),d.Suo(r,UM,5)),2&t){let s;d.iGM(s=d.CRH())&&(i.cell=s.first),d.iGM(s=d.CRH())&&(i.headerCell=s.first),d.iGM(s=d.CRH())&&(i.footerCell=s.first)}},inputs:{sticky:"sticky",name:["cdkColumnDef","name"],stickyEnd:"stickyEnd"},features:[d._Bn([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),d.qOj]}),n})();class T2{constructor(e,t){t.nativeElement.classList.add(...e._columnCssClassName)}}let I2=(()=>{class n extends T2{constructor(t,i){super(t,i)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(y_),d.Y36(d.SBq))},n.\u0275dir=d.lG2({type:n,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[d.qOj]}),n})(),S2=(()=>{class n extends T2{constructor(t,i){if(super(t,i),1===t._table?._elementRef.nativeElement.nodeType){const r=t._table._elementRef.nativeElement.getAttribute("role");i.nativeElement.setAttribute("role","grid"===r||"treegrid"===r?"gridcell":"cell")}}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(y_),d.Y36(d.SBq))},n.\u0275dir=d.lG2({type:n,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],features:[d.qOj]}),n})();class EU{constructor(){this.tasks=[],this.endTasks=[]}}const M2=new d.OlP("_COALESCED_STYLE_SCHEDULER");let TU=(()=>{class n{constructor(t){this._ngZone=t,this._currentSchedule=null,this._destroyed=new g.x}schedule(t){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(t)}scheduleEnd(t){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(t)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new EU,this._getScheduleObservable().pipe(qo(this._destroyed)).subscribe(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){const t=this._currentSchedule;this._currentSchedule=new EU;for(const i of t.tasks)i();for(const i of t.endTasks)i()}this._currentSchedule=null}))}_getScheduleObservable(){return this._ngZone.isStable?(0,Mi.D)(Promise.resolve(void 0)):this._ngZone.onStable.pipe(Yn(1))}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(d.R0b))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})(),D2=(()=>{class n{constructor(t,i){this.template=t,this._differs=i}ngOnChanges(t){if(!this._columnsDiffer){const i=t.columns&&t.columns.currentValue||[];this._columnsDiffer=this._differs.find(i).create(),this._columnsDiffer.diff(i)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(t){return this instanceof lT?t.headerCell.template:this instanceof cT?t.footerCell.template:t.cell.template}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.Rgc),d.Y36(d.ZZ4))},n.\u0275dir=d.lG2({type:n,features:[d.TTD]}),n})();class CX extends D2{}const EX=E2(CX);let lT=(()=>{class n extends EX{constructor(t,i,r){super(t,i),this._table=r}ngOnChanges(t){super.ngOnChanges(t)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.Rgc),d.Y36(d.ZZ4),d.Y36(m1,8))},n.\u0275dir=d.lG2({type:n,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:["cdkHeaderRowDef","columns"],sticky:["cdkHeaderRowDefSticky","sticky"]},features:[d.qOj,d.TTD]}),n})();class TX extends D2{}const IX=E2(TX);let cT=(()=>{class n extends IX{constructor(t,i,r){super(t,i),this._table=r}ngOnChanges(t){super.ngOnChanges(t)}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.Rgc),d.Y36(d.ZZ4),d.Y36(m1,8))},n.\u0275dir=d.lG2({type:n,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:["cdkFooterRowDef","columns"],sticky:["cdkFooterRowDefSticky","sticky"]},features:[d.qOj,d.TTD]}),n})(),jM=(()=>{class n extends D2{constructor(t,i,r){super(t,i),this._table=r}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.Rgc),d.Y36(d.ZZ4),d.Y36(m1,8))},n.\u0275dir=d.lG2({type:n,selectors:[["","cdkRowDef",""]],inputs:{columns:["cdkRowDefColumns","columns"],when:["cdkRowDefWhen","when"]},features:[d.qOj]}),n})(),v_=(()=>{class n{constructor(t){this._viewContainer=t,n.mostRecentCellOutlet=this}ngOnDestroy(){n.mostRecentCellOutlet===this&&(n.mostRecentCellOutlet=null)}}return n.mostRecentCellOutlet=null,n.\u0275fac=function(t){return new(t||n)(d.Y36(d.s_b))},n.\u0275dir=d.lG2({type:n,selectors:[["","cdkCellOutlet",""]]}),n})(),A2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=d.Xpm({type:n,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,i){1&t&&d.GkF(0,0)},dependencies:[v_],encapsulation:2}),n})(),O2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=d.Xpm({type:n,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,i){1&t&&d.GkF(0,0)},dependencies:[v_],encapsulation:2}),n})(),$M=(()=>{class n{constructor(t){this.templateRef=t,this._contentClassName="cdk-no-data-row"}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.Rgc))},n.\u0275dir=d.lG2({type:n,selectors:[["ng-template","cdkNoDataRow",""]]}),n})();const IU=["top","bottom","left","right"];class SX{constructor(e,t,i,r,s=!0,f=!0,b){this._isNativeHtmlTable=e,this._stickCellCss=t,this.direction=i,this._coalescedStyleScheduler=r,this._isBrowser=s,this._needsPositionStickyOnElement=f,this._positionListener=b,this._cachedCellWidths=[],this._borderCellCss={top:`${t}-border-elem-top`,bottom:`${t}-border-elem-bottom`,left:`${t}-border-elem-left`,right:`${t}-border-elem-right`}}clearStickyPositioning(e,t){const i=[];for(const r of e)if(r.nodeType===r.ELEMENT_NODE){i.push(r);for(let s=0;s<r.children.length;s++)i.push(r.children[s])}this._coalescedStyleScheduler.schedule(()=>{for(const r of i)this._removeStickyStyle(r,t)})}updateStickyColumns(e,t,i,r=!0){if(!e.length||!this._isBrowser||!t.some(ae=>ae)&&!i.some(ae=>ae))return void(this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]})));const s=e[0],f=s.children.length,b=this._getCellWidths(s,r),I=this._getStickyStartColumnPositions(b,t),O=this._getStickyEndColumnPositions(b,i),V=t.lastIndexOf(!0),X=i.indexOf(!0);this._coalescedStyleScheduler.schedule(()=>{const ae="rtl"===this.direction,me=ae?"right":"left",Ie=ae?"left":"right";for(const Ge of e)for(let Je=0;Je<f;Je++){const Qt=Ge.children[Je];t[Je]&&this._addStickyStyle(Qt,me,I[Je],Je===V),i[Je]&&this._addStickyStyle(Qt,Ie,O[Je],Je===X)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:-1===V?[]:b.slice(0,V+1).map((Ge,Je)=>t[Je]?Ge:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:-1===X?[]:b.slice(X).map((Ge,Je)=>i[Je+X]?Ge:null).reverse()}))})}stickRows(e,t,i){if(!this._isBrowser)return;const r="bottom"===i?e.slice().reverse():e,s="bottom"===i?t.slice().reverse():t,f=[],b=[],I=[];for(let V=0,X=0;V<r.length;V++){if(!s[V])continue;f[V]=X;const ae=r[V];I[V]=this._isNativeHtmlTable?Array.from(ae.children):[ae];const me=ae.getBoundingClientRect().height;X+=me,b[V]=me}const O=s.lastIndexOf(!0);this._coalescedStyleScheduler.schedule(()=>{for(let V=0;V<r.length;V++){if(!s[V])continue;const X=f[V],ae=V===O;for(const me of I[V])this._addStickyStyle(me,i,X,ae)}"top"===i?this._positionListener?.stickyHeaderRowsUpdated({sizes:b,offsets:f,elements:I}):this._positionListener?.stickyFooterRowsUpdated({sizes:b,offsets:f,elements:I})})}updateStickyFooterContainer(e,t){if(!this._isNativeHtmlTable)return;const i=e.querySelector("tfoot");this._coalescedStyleScheduler.schedule(()=>{t.some(r=>!r)?this._removeStickyStyle(i,["bottom"]):this._addStickyStyle(i,"bottom",0,!1)})}_removeStickyStyle(e,t){for(const r of t)e.style[r]="",e.classList.remove(this._borderCellCss[r]);IU.some(r=>-1===t.indexOf(r)&&e.style[r])?e.style.zIndex=this._getCalculatedZIndex(e):(e.style.zIndex="",this._needsPositionStickyOnElement&&(e.style.position=""),e.classList.remove(this._stickCellCss))}_addStickyStyle(e,t,i,r){e.classList.add(this._stickCellCss),r&&e.classList.add(this._borderCellCss[t]),e.style[t]=`${i}px`,e.style.zIndex=this._getCalculatedZIndex(e),this._needsPositionStickyOnElement&&(e.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(e){const t={top:100,bottom:10,left:1,right:1};let i=0;for(const r of IU)e.style[r]&&(i+=t[r]);return i?`${i}`:""}_getCellWidths(e,t=!0){if(!t&&this._cachedCellWidths.length)return this._cachedCellWidths;const i=[],r=e.children;for(let s=0;s<r.length;s++)i.push(r[s].getBoundingClientRect().width);return this._cachedCellWidths=i,i}_getStickyStartColumnPositions(e,t){const i=[];let r=0;for(let s=0;s<e.length;s++)t[s]&&(i[s]=r,r+=e[s]);return i}_getStickyEndColumnPositions(e,t){const i=[];let r=0;for(let s=e.length;s>0;s--)t[s]&&(i[s]=r,r+=e[s]);return i}}const k2=new d.OlP("CDK_SPL");let GM=(()=>{class n{constructor(t,i){this.viewContainer=t,this.elementRef=i}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.s_b),d.Y36(d.SBq))},n.\u0275dir=d.lG2({type:n,selectors:[["","rowOutlet",""]]}),n})(),HM=(()=>{class n{constructor(t,i){this.viewContainer=t,this.elementRef=i}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.s_b),d.Y36(d.SBq))},n.\u0275dir=d.lG2({type:n,selectors:[["","headerRowOutlet",""]]}),n})(),qM=(()=>{class n{constructor(t,i){this.viewContainer=t,this.elementRef=i}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.s_b),d.Y36(d.SBq))},n.\u0275dir=d.lG2({type:n,selectors:[["","footerRowOutlet",""]]}),n})(),WM=(()=>{class n{constructor(t,i){this.viewContainer=t,this.elementRef=i}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.s_b),d.Y36(d.SBq))},n.\u0275dir=d.lG2({type:n,selectors:[["","noDataRowOutlet",""]]}),n})(),ZM=(()=>{class n{get trackBy(){return this._trackByFn}set trackBy(t){this._trackByFn=t}get dataSource(){return this._dataSource}set dataSource(t){this._dataSource!==t&&this._switchDataSource(t)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(t){this._multiTemplateDataRows=os(t),this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(t){this._fixedLayout=os(t),this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}constructor(t,i,r,s,f,b,I,O,V,X,ae,me){this._differs=t,this._changeDetectorRef=i,this._elementRef=r,this._dir=f,this._platform=I,this._viewRepeater=O,this._coalescedStyleScheduler=V,this._viewportRuler=X,this._stickyPositioningListener=ae,this._ngZone=me,this._onDestroy=new g.x,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new d.vpe,this.viewChange=new C({start:0,end:Number.MAX_VALUE}),s||this._elementRef.nativeElement.setAttribute("role","table"),this._document=b,this._isNativeHtmlTable="TABLE"===this._elementRef.nativeElement.nodeName}ngOnInit(){this._setupStickyStyler(),this._isNativeHtmlTable&&this._applyNativeTableSections(),this._dataDiffer=this._differs.find([]).create((t,i)=>this.trackBy?this.trackBy(i.dataIndex,i.data):i),this._viewportRuler.change().pipe(qo(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentChecked(){this._cacheRowDefs(),this._cacheColumnDefs();const i=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||i,this._forceRecalculateCellWidths=i,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}ngOnDestroy(){[this._rowOutlet.viewContainer,this._headerRowOutlet.viewContainer,this._footerRowOutlet.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(t=>{t.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),C2(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();const t=this._dataDiffer.diff(this._renderRows);if(!t)return this._updateNoDataRow(),void this.contentChanged.next();const i=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(t,i,(r,s,f)=>this._getEmbeddedViewArgs(r.item,f),r=>r.item.data,r=>{1===r.operation&&r.context&&this._renderCellTemplateForItem(r.record.item.rowDef,r.context)}),this._updateRowIndexContext(),t.forEachIdentityChange(r=>{i.get(r.currentIndex).context.$implicit=r.item.data}),this._updateNoDataRow(),this._ngZone&&d.R0b.isInAngularZone()?this._ngZone.onStable.pipe(Yn(1),qo(this._onDestroy)).subscribe(()=>{this.updateStickyColumnStyles()}):this.updateStickyColumnStyles(),this.contentChanged.next()}addColumnDef(t){this._customColumnDefs.add(t)}removeColumnDef(t){this._customColumnDefs.delete(t)}addRowDef(t){this._customRowDefs.add(t)}removeRowDef(t){this._customRowDefs.delete(t)}addHeaderRowDef(t){this._customHeaderRowDefs.add(t),this._headerRowDefChanged=!0}removeHeaderRowDef(t){this._customHeaderRowDefs.delete(t),this._headerRowDefChanged=!0}addFooterRowDef(t){this._customFooterRowDefs.add(t),this._footerRowDefChanged=!0}removeFooterRowDef(t){this._customFooterRowDefs.delete(t),this._footerRowDefChanged=!0}setNoDataRow(t){this._customNoDataRow=t}updateStickyHeaderRowStyles(){const t=this._getRenderedRows(this._headerRowOutlet),r=this._elementRef.nativeElement.querySelector("thead");r&&(r.style.display=t.length?"":"none");const s=this._headerRowDefs.map(f=>f.sticky);this._stickyStyler.clearStickyPositioning(t,["top"]),this._stickyStyler.stickRows(t,s,"top"),this._headerRowDefs.forEach(f=>f.resetStickyChanged())}updateStickyFooterRowStyles(){const t=this._getRenderedRows(this._footerRowOutlet),r=this._elementRef.nativeElement.querySelector("tfoot");r&&(r.style.display=t.length?"":"none");const s=this._footerRowDefs.map(f=>f.sticky);this._stickyStyler.clearStickyPositioning(t,["bottom"]),this._stickyStyler.stickRows(t,s,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,s),this._footerRowDefs.forEach(f=>f.resetStickyChanged())}updateStickyColumnStyles(){const t=this._getRenderedRows(this._headerRowOutlet),i=this._getRenderedRows(this._rowOutlet),r=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...t,...i,...r],["left","right"]),this._stickyColumnStylesNeedReset=!1),t.forEach((s,f)=>{this._addStickyColumnStyles([s],this._headerRowDefs[f])}),this._rowDefs.forEach(s=>{const f=[];for(let b=0;b<i.length;b++)this._renderRows[b].rowDef===s&&f.push(i[b]);this._addStickyColumnStyles(f,s)}),r.forEach((s,f)=>{this._addStickyColumnStyles([s],this._footerRowDefs[f])}),Array.from(this._columnDefsByName.values()).forEach(s=>s.resetStickyChanged())}_getAllRenderRows(){const t=[],i=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let r=0;r<this._data.length;r++){let s=this._data[r];const f=this._getRenderRowsForData(s,r,i.get(s));this._cachedRenderRowsMap.has(s)||this._cachedRenderRowsMap.set(s,new WeakMap);for(let b=0;b<f.length;b++){let I=f[b];const O=this._cachedRenderRowsMap.get(I.data);O.has(I.rowDef)?O.get(I.rowDef).push(I):O.set(I.rowDef,[I]),t.push(I)}}return t}_getRenderRowsForData(t,i,r){return this._getRowDefs(t,i).map(f=>{const b=r&&r.has(f)?r.get(f):[];if(b.length){const I=b.shift();return I.dataIndex=i,I}return{data:t,rowDef:f,dataIndex:i}})}_cacheColumnDefs(){this._columnDefsByName.clear(),YM(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(i=>{this._columnDefsByName.has(i.name),this._columnDefsByName.set(i.name,i)})}_cacheRowDefs(){this._headerRowDefs=YM(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=YM(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=YM(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);const t=this._rowDefs.filter(i=>!i.when);this._defaultRowDef=t[0]}_renderUpdatedColumns(){const t=(f,b)=>f||!!b.getColumnsDiff(),i=this._rowDefs.reduce(t,!1);i&&this._forceRenderDataRows();const r=this._headerRowDefs.reduce(t,!1);r&&this._forceRenderHeaderRows();const s=this._footerRowDefs.reduce(t,!1);return s&&this._forceRenderFooterRows(),i||r||s}_switchDataSource(t){this._data=[],C2(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),t||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear()),this._dataSource=t}_observeRenderChanges(){if(!this.dataSource)return;let t;C2(this.dataSource)?t=this.dataSource.connect(this):function mX(n){return!!n&&(n instanceof L.y||(0,at.m)(n.lift)&&(0,at.m)(n.subscribe))}(this.dataSource)?t=this.dataSource:Array.isArray(this.dataSource)&&(t=c(this.dataSource)),this._renderChangeSubscription=t.pipe(qo(this._onDestroy)).subscribe(i=>{this._data=i||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((t,i)=>this._renderRow(this._headerRowOutlet,t,i)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((t,i)=>this._renderRow(this._footerRowOutlet,t,i)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(t,i){const r=Array.from(i.columns||[]).map(b=>this._columnDefsByName.get(b)),s=r.map(b=>b.sticky),f=r.map(b=>b.stickyEnd);this._stickyStyler.updateStickyColumns(t,s,f,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(t){const i=[];for(let r=0;r<t.viewContainer.length;r++){const s=t.viewContainer.get(r);i.push(s.rootNodes[0])}return i}_getRowDefs(t,i){if(1==this._rowDefs.length)return[this._rowDefs[0]];let r=[];if(this.multiTemplateDataRows)r=this._rowDefs.filter(s=>!s.when||s.when(i,t));else{let s=this._rowDefs.find(f=>f.when&&f.when(i,t))||this._defaultRowDef;s&&r.push(s)}return r}_getEmbeddedViewArgs(t,i){return{templateRef:t.rowDef.template,context:{$implicit:t.data},index:i}}_renderRow(t,i,r,s={}){const f=t.viewContainer.createEmbeddedView(i.template,s,r);return this._renderCellTemplateForItem(i,s),f}_renderCellTemplateForItem(t,i){for(let r of this._getCellTemplates(t))v_.mostRecentCellOutlet&&v_.mostRecentCellOutlet._viewContainer.createEmbeddedView(r,i);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){const t=this._rowOutlet.viewContainer;for(let i=0,r=t.length;i<r;i++){const f=t.get(i).context;f.count=r,f.first=0===i,f.last=i===r-1,f.even=i%2==0,f.odd=!f.even,this.multiTemplateDataRows?(f.dataIndex=this._renderRows[i].dataIndex,f.renderIndex=i):f.index=this._renderRows[i].dataIndex}}_getCellTemplates(t){return t&&t.columns?Array.from(t.columns,i=>{const r=this._columnDefsByName.get(i);return t.extractCellTemplate(r)}):[]}_applyNativeTableSections(){const t=this._document.createDocumentFragment(),i=[{tag:"thead",outlets:[this._headerRowOutlet]},{tag:"tbody",outlets:[this._rowOutlet,this._noDataRowOutlet]},{tag:"tfoot",outlets:[this._footerRowOutlet]}];for(const r of i){const s=this._document.createElement(r.tag);s.setAttribute("role","rowgroup");for(const f of r.outlets)s.appendChild(f.elementRef.nativeElement);t.appendChild(s)}this._elementRef.nativeElement.appendChild(t)}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){const t=(i,r)=>i||r.hasStickyChanged();this._headerRowDefs.reduce(t,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(t,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(t,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){this._stickyStyler=new SX(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:c()).pipe(qo(this._onDestroy)).subscribe(i=>{this._stickyStyler.direction=i,this.updateStickyColumnStyles()})}_getOwnDefs(t){return t.filter(i=>!i._table||i._table===this)}_updateNoDataRow(){const t=this._customNoDataRow||this._noDataRow;if(!t)return;const i=0===this._rowOutlet.viewContainer.length;if(i===this._isShowingNoDataRow)return;const r=this._noDataRowOutlet.viewContainer;if(i){const s=r.createEmbeddedView(t.templateRef),f=s.rootNodes[0];1===s.rootNodes.length&&f?.nodeType===this._document.ELEMENT_NODE&&(f.setAttribute("role","row"),f.classList.add(t._contentClassName))}else r.clear();this._isShowingNoDataRow=i}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.ZZ4),d.Y36(d.sBO),d.Y36(d.SBq),d.$8M("role"),d.Y36(g_,8),d.Y36(ft),d.Y36(ec),d.Y36(aT),d.Y36(M2),d.Y36(sT),d.Y36(k2,12),d.Y36(d.R0b,8))},n.\u0275cmp=d.Xpm({type:n,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(t,i,r){if(1&t&&(d.Suo(r,$M,5),d.Suo(r,y_,5),d.Suo(r,jM,5),d.Suo(r,lT,5),d.Suo(r,cT,5)),2&t){let s;d.iGM(s=d.CRH())&&(i._noDataRow=s.first),d.iGM(s=d.CRH())&&(i._contentColumnDefs=s),d.iGM(s=d.CRH())&&(i._contentRowDefs=s),d.iGM(s=d.CRH())&&(i._contentHeaderRowDefs=s),d.iGM(s=d.CRH())&&(i._contentFooterRowDefs=s)}},viewQuery:function(t,i){if(1&t&&(d.Gf(GM,7),d.Gf(HM,7),d.Gf(qM,7),d.Gf(WM,7)),2&t){let r;d.iGM(r=d.CRH())&&(i._rowOutlet=r.first),d.iGM(r=d.CRH())&&(i._headerRowOutlet=r.first),d.iGM(r=d.CRH())&&(i._footerRowOutlet=r.first),d.iGM(r=d.CRH())&&(i._noDataRowOutlet=r.first)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(t,i){2&t&&d.ekj("cdk-table-fixed-layout",i.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:"multiTemplateDataRows",fixedLayout:"fixedLayout"},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],features:[d._Bn([{provide:m1,useExisting:n},{provide:aT,useClass:fU},{provide:M2,useClass:TU},{provide:k2,useValue:null}])],ngContentSelectors:_X,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(t,i){1&t&&(d.F$t(gX),d.Hsn(0),d.Hsn(1,1),d.GkF(2,0)(3,1)(4,2)(5,3))},dependencies:[GM,HM,qM,WM],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2}),n})();function YM(n,e){return n.concat(Array.from(e))}let DX=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[v2]}),n})();const AX=[[["caption"]],[["colgroup"],["col"]]],PX=["caption","colgroup, col"];let MU=(()=>{class n extends ZM{constructor(){super(...arguments),this.stickyCssClass="mat-mdc-table-sticky",this.needsPositionStickyOnElement=!1}ngOnInit(){super.ngOnInit(),this._isNativeHtmlTable&&this._elementRef.nativeElement.querySelector("tbody").classList.add("mdc-data-table__content")}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275cmp=d.Xpm({type:n,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-mdc-table","mdc-data-table__table"],hostVars:2,hostBindings:function(t,i){2&t&&d.ekj("mdc-table-fixed-layout",i.fixedLayout)},exportAs:["matTable"],features:[d._Bn([{provide:ZM,useExisting:n},{provide:m1,useExisting:n},{provide:M2,useClass:TU},{provide:aT,useClass:fU},{provide:k2,useValue:null}]),d.qOj],ngContentSelectors:PX,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(t,i){1&t&&(d.F$t(AX),d.Hsn(0),d.Hsn(1,1),d.GkF(2,0)(3,1)(4,2)(5,3))},dependencies:[GM,HM,qM,WM],styles:[".mdc-data-table{border-radius:var(--mdc-shape-medium, 4px);border-width:1px;border-style:solid}.mdc-data-table .mdc-data-table__header-cell:first-child{border-top-left-radius:var(--mdc-shape-medium, 4px)}[dir=rtl] .mdc-data-table .mdc-data-table__header-cell:first-child,.mdc-data-table .mdc-data-table__header-cell:first-child[dir=rtl]{border-top-right-radius:var(--mdc-shape-medium, 4px);border-top-left-radius:0}.mdc-data-table .mdc-data-table__header-cell:last-child{border-top-right-radius:var(--mdc-shape-medium, 4px)}[dir=rtl] .mdc-data-table .mdc-data-table__header-cell:last-child,.mdc-data-table .mdc-data-table__header-cell:last-child[dir=rtl]{border-top-left-radius:var(--mdc-shape-medium, 4px);border-top-right-radius:0}.mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:first-child{border-bottom-left-radius:var(--mdc-shape-medium, 4px)}[dir=rtl] .mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:first-child,.mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:first-child[dir=rtl]{border-bottom-right-radius:var(--mdc-shape-medium, 4px);border-bottom-left-radius:0}.mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:last-child{border-bottom-right-radius:var(--mdc-shape-medium, 4px)}[dir=rtl] .mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:last-child,.mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:last-child[dir=rtl]{border-bottom-left-radius:var(--mdc-shape-medium, 4px);border-bottom-right-radius:0}.mdc-data-table__cell,.mdc-data-table__header-cell{border-bottom-width:1px;border-bottom-style:solid}.mdc-data-table__pagination{border-top-width:1px;border-top-style:solid}.mdc-data-table__row:last-child .mdc-data-table__cell{border-bottom:none}.mdc-data-table__row{height:52px}.mdc-data-table__pagination{min-height:52px}.mdc-data-table__header-row{height:56px}.mdc-data-table__cell,.mdc-data-table__header-cell{padding:0 16px 0 16px}.mdc-data-table__header-cell--checkbox,.mdc-data-table__cell--checkbox{padding-left:4px;padding-right:0}[dir=rtl] .mdc-data-table__header-cell--checkbox,[dir=rtl] .mdc-data-table__cell--checkbox,.mdc-data-table__header-cell--checkbox[dir=rtl],.mdc-data-table__cell--checkbox[dir=rtl]{padding-left:0;padding-right:4px}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell,.mdc-data-table__cell[dir=rtl]{text-align:right}.mdc-data-table__cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__cell--numeric,.mdc-data-table__cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__cell--checkbox{width:1px}.mdc-data-table__header-cell{box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mdc-data-table__header-cell,.mdc-data-table__header-cell[dir=rtl]{text-align:right}.mdc-data-table__header-cell--checkbox{width:1px}.mdc-data-table__header-cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__header-cell--numeric,.mdc-data-table__header-cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__sort-icon-button{width:28px;height:28px;padding:2px;transform:rotate(0.0001deg);margin-left:4px;margin-right:0;opacity:0}.mdc-data-table__sort-icon-button .mdc-icon-button__focus-ring{max-height:28px;max-width:28px}.mdc-data-table__sort-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:28px;height:28px;margin-top:0px;margin-bottom:0px;margin-right:0px;margin-left:0px}.mdc-data-table__sort-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:28px;max-width:28px}.mdc-data-table__sort-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:28px;left:50%;width:28px;transform:translate(-50%, -50%)}[dir=rtl] .mdc-data-table__sort-icon-button,.mdc-data-table__sort-icon-button[dir=rtl]{margin-left:0;margin-right:4px}.mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button{margin-left:0;margin-right:4px}[dir=rtl] .mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button,.mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button[dir=rtl]{margin-left:4px;margin-right:0}.mdc-data-table__header-cell--sorted-descending .mdc-data-table__sort-icon-button{transform:rotate(-180deg)}.mdc-data-table__sort-icon-button:focus,.mdc-data-table__header-cell:hover .mdc-data-table__sort-icon-button,.mdc-data-table__header-cell--sorted .mdc-data-table__sort-icon-button{opacity:1}.mdc-data-table__header-cell-wrapper{align-items:center;display:inline-flex;vertical-align:middle}.mdc-data-table__header-cell--with-sort{cursor:pointer}.mdc-data-table__sort-status-label{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.mdc-data-table--sticky-header .mdc-data-table__header-cell{position:sticky;top:0;z-index:1}.mdc-data-table{-webkit-overflow-scrolling:touch;display:inline-flex;flex-direction:column;box-sizing:border-box;position:relative}.mdc-data-table__table-container{-webkit-overflow-scrolling:touch;overflow-x:auto;width:100%}.mdc-data-table__table{min-width:100%;border:0;white-space:nowrap;border-spacing:0;table-layout:fixed}.mdc-data-table__header-cell{box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mdc-data-table__header-cell,.mdc-data-table__header-cell[dir=rtl]{text-align:right}.mdc-data-table__header-cell--checkbox{width:1px}.mdc-data-table__header-cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__header-cell--numeric,.mdc-data-table__header-cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__sort-icon-button{width:28px;height:28px;padding:2px;transform:rotate(0.0001deg);margin-left:4px;margin-right:0;opacity:0}.mdc-data-table__sort-icon-button .mdc-icon-button__focus-ring{max-height:28px;max-width:28px}.mdc-data-table__sort-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:28px;height:28px;margin-top:0px;margin-bottom:0px;margin-right:0px;margin-left:0px}.mdc-data-table__sort-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:28px;max-width:28px}.mdc-data-table__sort-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:28px;left:50%;width:28px;transform:translate(-50%, -50%)}[dir=rtl] .mdc-data-table__sort-icon-button,.mdc-data-table__sort-icon-button[dir=rtl]{margin-left:0;margin-right:4px}.mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button{margin-left:0;margin-right:4px}[dir=rtl] .mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button,.mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button[dir=rtl]{margin-left:4px;margin-right:0}.mdc-data-table__header-cell--sorted-descending .mdc-data-table__sort-icon-button{transform:rotate(-180deg)}.mdc-data-table__sort-icon-button:focus,.mdc-data-table__header-cell:hover .mdc-data-table__sort-icon-button,.mdc-data-table__header-cell--sorted .mdc-data-table__sort-icon-button{opacity:1}.mdc-data-table__header-cell-wrapper{align-items:center;display:inline-flex;vertical-align:middle}.mdc-data-table__header-cell--with-sort{cursor:pointer}.mdc-data-table__sort-status-label{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell,.mdc-data-table__cell[dir=rtl]{text-align:right}.mdc-data-table__cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__cell--numeric,.mdc-data-table__cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__cell--checkbox{width:1px}.mdc-data-table__pagination{box-sizing:border-box;display:flex;justify-content:flex-end}.mdc-data-table__pagination-trailing{margin-left:4px;margin-right:0;align-items:center;display:flex;flex-wrap:wrap;justify-content:flex-end}[dir=rtl] .mdc-data-table__pagination-trailing,.mdc-data-table__pagination-trailing[dir=rtl]{margin-left:0;margin-right:4px}.mdc-data-table__pagination-navigation{align-items:center;display:flex}.mdc-data-table__pagination-button{margin-left:0;margin-right:4px}[dir=rtl] .mdc-data-table__pagination-button .mdc-button__icon,.mdc-data-table__pagination-button .mdc-button__icon[dir=rtl]{transform:rotate(180deg)}[dir=rtl] .mdc-data-table__pagination-button,.mdc-data-table__pagination-button[dir=rtl]{margin-left:4px;margin-right:0}.mdc-data-table__pagination-total{margin-left:14px;margin-right:36px;white-space:nowrap}[dir=rtl] .mdc-data-table__pagination-total,.mdc-data-table__pagination-total[dir=rtl]{margin-left:36px;margin-right:14px}.mdc-data-table__pagination-rows-per-page{margin-left:0;margin-right:22px;align-items:center;display:inline-flex}[dir=rtl] .mdc-data-table__pagination-rows-per-page,.mdc-data-table__pagination-rows-per-page[dir=rtl]{margin-left:22px;margin-right:0}.mdc-data-table__pagination-rows-per-page-label{margin-left:0;margin-right:12px;white-space:nowrap}[dir=rtl] .mdc-data-table__pagination-rows-per-page-label,.mdc-data-table__pagination-rows-per-page-label[dir=rtl]{margin-left:12px;margin-right:0}.mdc-data-table__pagination-rows-per-page-select{min-width:var(--mdc-menu-min-width, 80px);margin:8px 0}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor{width:100%;min-width:80px}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor{height:36px}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor .mdc-floating-label--float-above{font-size:.75rem}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-data-table__pagination-rows-per-page-select .mdc-select__dropdown-icon{width:20px;height:20px}.mdc-data-table__pagination-rows-per-page-select.mdc-select--outlined .mdc-select__anchor :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 56px)}.mdc-data-table__pagination-rows-per-page-select .mdc-list-item.mdc-list-item--with-one-line{height:36px}.mdc-data-table__progress-indicator{display:none;position:absolute;width:100%}.mdc-data-table--in-progress .mdc-data-table__progress-indicator{display:block}.mdc-data-table__scrim{background-color:var(--mdc-theme-surface, #fff);height:100%;opacity:.32;position:absolute;top:0;width:100%}mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.mat-mdc-table-sticky{position:sticky !important}.mat-mdc-table{table-layout:auto;white-space:normal}mat-row.mat-mdc-row,mat-header-row.mat-mdc-header-row,mat-footer-row.mat-mdc-footer-row{border-bottom:none}.mat-mdc-table tbody,.mat-mdc-table tfoot,.mat-mdc-table thead,.mat-mdc-cell,.mat-mdc-footer-cell,.mat-mdc-header-row,.mat-mdc-row,.mat-mdc-footer-row,.mat-mdc-table .mat-mdc-header-cell{background:inherit}.mat-mdc-table .mat-mdc-row:hover,.mat-mdc-table .mat-mdc-footer-row:hover{background-color:inherit}.mat-mdc-table mat-header-row.mat-mdc-header-row,.mat-mdc-table mat-row.mat-mdc-row,.mat-mdc-table mat-footer-row.mat-mdc-footer-cell{height:unset}mat-header-cell.mat-mdc-header-cell,mat-cell.mat-mdc-cell,mat-footer-cell.mat-mdc-footer-cell{align-self:stretch}"],encapsulation:2}),n})(),R2=(()=>{class n extends g1{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275dir=d.lG2({type:n,selectors:[["","matCellDef",""]],features:[d._Bn([{provide:g1,useExisting:n}]),d.qOj]}),n})(),F2=(()=>{class n extends _1{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275dir=d.lG2({type:n,selectors:[["","matHeaderCellDef",""]],features:[d._Bn([{provide:_1,useExisting:n}]),d.qOj]}),n})(),L2=(()=>{class n extends y_{get name(){return this._name}set name(t){this._setNameInput(t)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275dir=d.lG2({type:n,selectors:[["","matColumnDef",""]],inputs:{sticky:"sticky",name:["matColumnDef","name"]},features:[d._Bn([{provide:y_,useExisting:n},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),d.qOj]}),n})(),N2=(()=>{class n extends I2{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275dir=d.lG2({type:n,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-mdc-header-cell","mdc-data-table__header-cell"],features:[d.qOj]}),n})(),z2=(()=>{class n extends S2{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275dir=d.lG2({type:n,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:[1,"mat-mdc-cell","mdc-data-table__cell"],features:[d.qOj]}),n})(),DU=(()=>{class n extends lT{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275dir=d.lG2({type:n,selectors:[["","matHeaderRowDef",""]],inputs:{columns:["matHeaderRowDef","columns"],sticky:["matHeaderRowDefSticky","sticky"]},features:[d._Bn([{provide:lT,useExisting:n}]),d.qOj]}),n})(),AU=(()=>{class n extends jM{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275dir=d.lG2({type:n,selectors:[["","matRowDef",""]],inputs:{columns:["matRowDefColumns","columns"],when:["matRowDefWhen","when"]},features:[d._Bn([{provide:jM,useExisting:n}]),d.qOj]}),n})(),PU=(()=>{class n extends A2{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275cmp=d.Xpm({type:n,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-mdc-header-row","mdc-data-table__header-row"],exportAs:["matHeaderRow"],features:[d._Bn([{provide:A2,useExisting:n}]),d.qOj],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,i){1&t&&d.GkF(0,0)},dependencies:[v_],encapsulation:2}),n})(),OU=(()=>{class n extends O2{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275cmp=d.Xpm({type:n,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-mdc-row","mdc-data-table__row"],exportAs:["matRow"],features:[d._Bn([{provide:O2,useExisting:n}]),d.qOj],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,i){1&t&&d.GkF(0,0)},dependencies:[v_],encapsulation:2}),n})(),kU=(()=>{class n extends $M{constructor(){super(...arguments),this._contentClassName="mat-mdc-no-data-row"}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=d.n5z(n)))(i||n)}}(),n.\u0275dir=d.lG2({type:n,selectors:[["ng-template","matNoDataRow",""]],features:[d._Bn([{provide:$M,useExisting:n}]),d.qOj]}),n})(),VX=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[Za,DX,Za]}),n})();class jX extends bK{get data(){return this._data.value}set data(e){e=Array.isArray(e)?e:[],this._data.next(e),this._renderChangesSubscription||this._filterData(e)}get filter(){return this._filter.value}set filter(e){this._filter.next(e),this._renderChangesSubscription||this._filterData(this.data)}get sort(){return this._sort}set sort(e){this._sort=e,this._updateChangeSubscription()}get paginator(){return this._paginator}set paginator(e){this._paginator=e,this._updateChangeSubscription()}constructor(e=[]){super(),this._renderData=new C([]),this._filter=new C(""),this._internalPageChanges=new g.x,this._renderChangesSubscription=null,this.sortingDataAccessor=(t,i)=>{const r=t[i];if(J3(r)){const s=Number(r);return s<9007199254740991?s:r}return r},this.sortData=(t,i)=>{const r=i.active,s=i.direction;return r&&""!=s?t.sort((f,b)=>{let I=this.sortingDataAccessor(f,r),O=this.sortingDataAccessor(b,r);const V=typeof I,X=typeof O;V!==X&&("number"===V&&(I+=""),"number"===X&&(O+=""));let ae=0;return null!=I&&null!=O?I>O?ae=1:I<O&&(ae=-1):null!=I?ae=1:null!=O&&(ae=-1),ae*("asc"==s?1:-1)}):t},this.filterPredicate=(t,i)=>{const r=Object.keys(t).reduce((f,b)=>f+t[b]+"\u25ec","").toLowerCase(),s=i.trim().toLowerCase();return-1!=r.indexOf(s)},this._data=new C(e),this._updateChangeSubscription()}_updateChangeSubscription(){const e=this._sort?(0,p_.T)(this._sort.sortChange,this._sort.initialized):c(null),t=this._paginator?(0,p_.T)(this._paginator.page,this._internalPageChanges,this._paginator.initialized):c(null),r=Fe([this._data,this._filter]).pipe((0,ue.U)(([b])=>this._filterData(b))),s=Fe([r,e]).pipe((0,ue.U)(([b])=>this._orderData(b))),f=Fe([s,t]).pipe((0,ue.U)(([b])=>this._pageData(b)));this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=f.subscribe(b=>this._renderData.next(b))}_filterData(e){return this.filteredData=null==this.filter||""===this.filter?e:e.filter(t=>this.filterPredicate(t,this.filter)),this.paginator&&this._updatePaginator(this.filteredData.length),this.filteredData}_orderData(e){return this.sort?this.sortData(e.slice(),this.sort):e}_pageData(e){if(!this.paginator)return e;const t=this.paginator.pageIndex*this.paginator.pageSize;return e.slice(t,t+this.paginator.pageSize)}_updatePaginator(e){Promise.resolve().then(()=>{const t=this.paginator;if(t&&(t.length=e,t.pageIndex>0)){const i=Math.ceil(t.length/t.pageSize)-1||0,r=Math.min(t.pageIndex,i);r!==t.pageIndex&&(t.pageIndex=r,this._internalPageChanges.next())}})}connect(){return this._renderChangesSubscription||this._updateChangeSubscription(),this._renderData}disconnect(){this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=null}}class RU extends jX{}class B2{}class fv{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),f=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(f):this.headers.set(s,[f])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof fv?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new fv;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof fv?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let f=this.headers.get(t);if(!f)return;f=f.filter(b=>-1===s.indexOf(b)),0===f.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,f)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class $X{encodeKey(e){return LU(e)}encodeValue(e){return LU(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const HX=/%(\d[a-f0-9])/gi,qX={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function LU(n){return encodeURIComponent(n).replace(HX,(e,t)=>qX[t]??e)}function KM(n){return`${n}`}class pv{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new $X,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function GX(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[f,b]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],I=t.get(f)||[];I.push(b),t.set(f,I)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(KM):[KM(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new pv({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(KM(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(KM(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class WX{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function NU(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function zU(n){return typeof Blob<"u"&&n instanceof Blob}function BU(n){return typeof FormData<"u"&&n instanceof FormData}class uT{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function ZX(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new fv),this.context||(this.context=new WX),this.params){const f=this.params.toString();if(0===f.length)this.urlWithParams=t;else{const b=t.indexOf("?");this.urlWithParams=t+(-1===b?"?":b<t.length-1?"&":"")+f}}else this.params=new pv,this.urlWithParams=t}serializeBody(){return null===this.body?null:NU(this.body)||zU(this.body)||BU(this.body)||function YX(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof pv?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||BU(this.body)?null:zU(this.body)?this.body.type||null:NU(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof pv?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,f=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,b=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let I=e.headers||this.headers,O=e.params||this.params;const V=e.context??this.context;return void 0!==e.setHeaders&&(I=Object.keys(e.setHeaders).reduce((X,ae)=>X.set(ae,e.setHeaders[ae]),I)),e.setParams&&(O=Object.keys(e.setParams).reduce((X,ae)=>X.set(ae,e.setParams[ae]),O)),new uT(t,i,s,{params:O,headers:I,context:V,reportProgress:b,responseType:r,withCredentials:f})}}var tc=(()=>((tc=tc||{})[tc.Sent=0]="Sent",tc[tc.UploadProgress=1]="UploadProgress",tc[tc.ResponseHeader=2]="ResponseHeader",tc[tc.DownloadProgress=3]="DownloadProgress",tc[tc.Response=4]="Response",tc[tc.User=5]="User",tc))();class KX{constructor(e,t=200,i="OK"){this.headers=e.headers||new fv,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class V2 extends KX{constructor(e={}){super(e),this.type=tc.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new V2({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}function U2(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let j2=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof uT)s=t;else{let I,O;I=r.headers instanceof fv?r.headers:new fv(r.headers),r.params&&(O=r.params instanceof pv?r.params:new pv({fromObject:r.params})),s=new uT(t,i,void 0!==r.body?r.body:null,{headers:I,context:r.context,params:O,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const f=c(s).pipe(sr(I=>this.handler.handle(I)));if(t instanceof uT||"events"===r.observe)return f;const b=f.pipe(Yt(I=>I instanceof V2));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return b.pipe((0,ue.U)(I=>{if(null!==I.body&&!(I.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return I.body}));case"blob":return b.pipe((0,ue.U)(I=>{if(null!==I.body&&!(I.body instanceof Blob))throw new Error("Response is not a Blob.");return I.body}));case"text":return b.pipe((0,ue.U)(I=>{if(null!==I.body&&"string"!=typeof I.body)throw new Error("Response is not a string.");return I.body}));default:return b.pipe((0,ue.U)(I=>I.body))}case"response":return b;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new pv).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,U2(r,i))}post(t,i,r={}){return this.request("POST",t,U2(r,i))}put(t,i,r={}){return this.request("PUT",t,U2(r,i))}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(B2))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();const cQ=["*"];let QM;function dT(n){return function uQ(){if(void 0===QM&&(QM=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(QM=n.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return QM}()?.createHTML(n)||n}function WU(n){return Error(`Unable to find icon with the name "${n}"`)}function ZU(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function YU(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class zb{constructor(e,t,i){this.url=e,this.svgText=t,this.options=i}}let JM=(()=>{class n{constructor(t,i,r,s){this._httpClient=t,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,s){return this._addSvgIconConfig(t,i,new zb(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,s){const f=this._sanitizer.sanitize(d.q3G.HTML,r);if(!f)throw YU(r);const b=dT(f);return this._addSvgIconConfig(t,i,new zb("",b,s))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new zb(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const s=this._sanitizer.sanitize(d.q3G.HTML,i);if(!s)throw YU(i);const f=dT(s);return this._addSvgIconSetConfig(t,new zb("",f,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(d.q3G.RESOURCE_URL,t);if(!i)throw ZU(t);const r=this._cachedIconsByUrl.get(i);return r?c(eD(r)):this._loadSvgIconFromConfig(new zb(t,null)).pipe(vi(s=>this._cachedIconsByUrl.set(i,s)),(0,ue.U)(s=>eD(s)))}getNamedSvgIcon(t,i=""){const r=KU(i,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const f=this._iconSetConfigs.get(i);return f?this._getSvgFromIconSetConfigs(t,f):Ot(WU(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?c(eD(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe((0,ue.U)(i=>eD(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?c(r):n0(i.filter(f=>!f.svgText).map(f=>this._loadSvgIconSetFromConfig(f).pipe(Mr(b=>{const O=`Loading icon set URL: ${this._sanitizer.sanitize(d.q3G.RESOURCE_URL,f.url)} failed: ${b.message}`;return this._errorHandler.handleError(new Error(O)),c(null)})))).pipe((0,ue.U)(()=>{const f=this._extractIconWithNameFromAnySet(t,i);if(!f)throw WU(t);return f}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const f=this._svgElementFromConfig(s),b=this._extractSvgIconFromSet(f,t,s.options);if(b)return b}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(vi(i=>t.svgText=i),(0,ue.U)(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?c(null):this._fetchIcon(t).pipe(vi(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const s=t.querySelector(`[id="${i}"]`);if(!s)return null;const f=s.cloneNode(!0);if(f.removeAttribute("id"),"svg"===f.nodeName.toLowerCase())return this._setSvgAttributes(f,r);if("symbol"===f.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(f),r);const b=this._svgElementFromString(dT("<svg></svg>"));return b.appendChild(f),this._setSvgAttributes(b,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString(dT("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:f,value:b}=r[s];"id"!==f&&i.setAttribute(f,b)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){const{url:i,options:r}=t,s=r?.withCredentials??!1;if(!this._httpClient)throw function dQ(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const f=this._sanitizer.sanitize(d.q3G.RESOURCE_URL,i);if(!f)throw ZU(i);const b=this._inProgressUrlFetches.get(f);if(b)return b;const I=this._httpClient.get(f,{responseType:"text",withCredentials:s}).pipe((0,ue.U)(O=>dT(O)),Fr(()=>this._inProgressUrlFetches.delete(f)),(0,D3.B)());return this._inProgressUrlFetches.set(f,I),I}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(KU(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](i,t);if(s)return fQ(s)?new zb(s.url,null,s.options):new zb(s,null)}}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(j2,8),d.LFG(Th),d.LFG(ft,8),d.LFG(d.qLn))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function eD(n){return n.cloneNode(!0)}function KU(n,e){return n+":"+e}function fQ(n){return!(!n.url||!n.options)}const pQ=h2(class{constructor(n){this._elementRef=n}}),mQ=new d.OlP("MAT_ICON_DEFAULT_OPTIONS"),gQ=new d.OlP("mat-icon-location",{providedIn:"root",factory:function _Q(){const n=(0,d.f3M)(ft),e=n?n.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),XU=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],yQ=XU.map(n=>`[${n}]`).join(", "),vQ=/^url\(['"]?#(.*?)['"]?\)$/;let QU=(()=>{class n extends pQ{get inline(){return this._inline}set inline(t){this._inline=os(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(t,i,r,s,f,b){super(t),this._iconRegistry=i,this._location=s,this._errorHandler=f,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=qe.w0.EMPTY,b&&(b.color&&(this.color=this.defaultColor=b.color),b.fontSet&&(this.fontSet=b.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),i.forEach(r=>t.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,s)=>{r.forEach(f=>{s.setAttribute(f.name,`url('${t}#${f.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(yQ),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)XU.forEach(f=>{const b=i[s],I=b.getAttribute(f),O=I?I.match(vQ):null;if(O){let V=r.get(b);V||(V=[],r.set(b,V)),V.push({name:f,value:O[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(Yn(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${s.message}`))})}}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq),d.Y36(JM),d.$8M("aria-hidden"),d.Y36(gQ),d.Y36(d.qLn),d.Y36(mQ,8))},n.\u0275cmp=d.Xpm({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(t,i){2&t&&(d.uIk("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet)("fontIcon",i._usingFontIcon()?i.fontIcon:null),d.ekj("mat-icon-inline",i.inline)("mat-icon-no-color","primary"!==i.color&&"accent"!==i.color&&"warn"!==i.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[d.qOj],ngContentSelectors:cQ,decls:1,vars:0,template:function(t,i){1&t&&(d.F$t(),d.Hsn(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),n})(),bQ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[Za,Za]}),n})();const xQ=["*",[["mat-toolbar-row"]]],wQ=["*","mat-toolbar-row"],CQ=h2(class{constructor(n){this._elementRef=n}});let EQ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=d.lG2({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),n})(),JU=(()=>{class n extends CQ{constructor(t,i,r){super(t),this._platform=i,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(d.SBq),d.Y36(ec),d.Y36(ft))},n.\u0275cmp=d.Xpm({type:n,selectors:[["mat-toolbar"]],contentQueries:function(t,i,r){if(1&t&&d.Suo(r,EQ,5),2&t){let s;d.iGM(s=d.CRH())&&(i._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,i){2&t&&d.ekj("mat-toolbar-multiple-rows",i._toolbarRows.length>0)("mat-toolbar-single-row",0===i._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[d.qOj],ngContentSelectors:wQ,decls:2,vars:0,template:function(t,i){1&t&&(d.F$t(xQ),d.Hsn(0),d.Hsn(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),n})(),TQ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[Za,Za]}),n})();function IQ(n,e){1&n&&(d.TgZ(0,"div",21),d._uU(1," Obteniendo correos... "),d.qZA())}function SQ(n,e){if(1&n&&(d.TgZ(0,"div",22),d._uU(1),d.qZA()),2&n){const t=d.oxw();d.xp6(1),d.hij(" Tienes ",t.mensajesPendientes," mensajes pendientes de lectura. ")}}function MQ(n,e){1&n&&(d.TgZ(0,"mat-header-cell",23),d._uU(1," Nombre "),d.qZA())}function DQ(n,e){if(1&n&&(d.TgZ(0,"mat-cell"),d._uU(1),d.qZA()),2&n){const t=e.$implicit;d.xp6(1),d.hij(" ",t.nombre," ")}}function AQ(n,e){1&n&&(d.TgZ(0,"mat-header-cell",24),d._uU(1," Asunto "),d.qZA())}function PQ(n,e){if(1&n&&(d.TgZ(0,"mat-cell"),d._uU(1),d.qZA()),2&n){const t=e.$implicit;d.xp6(1),d.hij(" ",t.asunto," ")}}function OQ(n,e){1&n&&(d.TgZ(0,"mat-header-cell",25),d._uU(1," Fecha "),d.qZA())}function kQ(n,e){if(1&n&&(d.TgZ(0,"mat-cell"),d._uU(1),d.ALo(2,"date"),d.qZA()),2&n){const t=e.$implicit;d.xp6(1),d.hij(" ",d.xi3(2,1,t.fecha.toDate(),"dd/MM/yyyy HH:mm")," ")}}function RQ(n,e){1&n&&d._UZ(0,"mat-header-row")}const FQ=function(n){return{"no-leido":n}};function LQ(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"mat-row",26),d.NdJ("click",function(){const s=d.CHM(t).$implicit,f=d.oxw();return d.KtG(f.abrirMensaje(s))}),d.qZA()}2&n&&d.Q6J("ngClass",d.VKq(1,FQ,"NO_LEIDO"===e.$implicit.estado))}function NQ(n,e){1&n&&(d.TgZ(0,"tr",27)(1,"td",28),d._uU(2,"No hay coincidencias"),d.qZA()())}const zQ=function(){return[25,50,100]};let BQ=(()=>{class n{constructor(t,i,r){this.messageService=t,this.authService=i,this.router=r,this.bandejaEntrada=[],this.displayedColumns=["nombre","fecha","asunto"],this.dataSource=new RU,this.obteniendoCorreos=!1,this.mensajesPendientes=0,this.asignarDataSource()}ngOnInit(){this.obteniendoCorreos=!0,this.messageService.getBandejaEntradaData().subscribe(t=>{this.paginator._intl.itemsPerPageLabel="N\xba de correos por p\xe1gina:",this.paginator._intl.getRangeLabel=(i,r,s)=>{const b=(i+1)*r;return`Del ${i*r+1} al ${b>s?s:b} (Total: ${s})`},this.bandejaEntrada=t,this.mensajesPendientes=this.bandejaEntrada.filter(i=>"NO_LEIDO"===i.estado).length,this.ordenarTabla({active:"fecha",direction:"desc"}),this.asignarDataSource(),this.obteniendoCorreos=!1})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}asignarDataSource(){this.dataSource=new RU(this.bandejaEntrada),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}ordenarTabla(t){const{active:i,direction:r}=t;!i||""===r||(this.bandejaEntrada=this.bandejaEntrada.sort((s,f)=>{const b="asc"===r;switch(i){case"nombre":return this.compare(s.nombre,f.nombre,b);case"fecha":return this.compare(s.fecha.seconds,f.fecha.seconds,b);case"asunto":return this.compare(s.asunto,f.asunto,b);default:return 0}}))}compare(t,i,r){return(t<i?-1:1)*(r?1:-1)}aplicarFiltro(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}abrirMensaje(t){this.router.navigateByUrl(`/private/email-list/${t.id}`)}logout(){this.authService.logout(),this.router.navigateByUrl("/private/auth-login")}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(QR),d.Y36(e2),d.Y36(Oo))},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-internal-email-list"]],viewQuery:function(t,i){if(1&t&&(d.Gf(wU,7),d.Gf(m2,7)),2&t){let r;d.iGM(r=d.CRH())&&(i.paginator=r.first),d.iGM(r=d.CRH())&&(i.sort=r.first)}},decls:26,vars:8,consts:[[1,"internal-email-list-container"],[1,"toolbar"],["mat-icon-button","",3,"click"],[1,"listado-emails"],["class","obteniendo-correos",4,"ngIf"],[1,"bandeja-entrada",3,"hidden"],["class","mensajes-pendientes",4,"ngIf"],[1,"input-group"],["type","text","id","busqueda-tabla","placeholder","Buscar en la bandeja de entrada...",3,"keyup"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource","matSortChange"],["matColumnDef","nombre"],["mat-sort-header","nombre",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","asunto"],["mat-sort-header","asunto",4,"matHeaderCellDef"],["matColumnDef","fecha"],["mat-sort-header","fecha",4,"matHeaderCellDef"],[4,"matHeaderRowDef"],["class","mat-row",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],["class","mat-row-no-mails",4,"matNoDataRow"],["aria-label","Select page",1,"mat-elevation-z8",3,"pageSizeOptions"],[1,"obteniendo-correos"],[1,"mensajes-pendientes"],["mat-sort-header","nombre"],["mat-sort-header","asunto"],["mat-sort-header","fecha"],[1,"mat-row",3,"ngClass","click"],[1,"mat-row-no-mails"],["colspan","3"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"mat-toolbar",1),d._uU(2," Hasspro - Bandeja de entrada del formulario de contacto "),d.TgZ(3,"button",2),d.NdJ("click",function(){return i.logout()}),d.TgZ(4,"mat-icon"),d._uU(5,"logout"),d.qZA()()(),d.TgZ(6,"div",3),d.YNc(7,IQ,2,0,"div",4),d.TgZ(8,"div",5),d.YNc(9,SQ,2,1,"div",6),d.TgZ(10,"div",7)(11,"input",8),d.NdJ("keyup",function(s){return i.aplicarFiltro(s)}),d.qZA()(),d.TgZ(12,"table",9),d.NdJ("matSortChange",function(s){return i.ordenarTabla(s)}),d.ynx(13,10),d.YNc(14,MQ,2,0,"mat-header-cell",11),d.YNc(15,DQ,2,1,"mat-cell",12),d.BQk(),d.ynx(16,13),d.YNc(17,AQ,2,0,"mat-header-cell",14),d.YNc(18,PQ,2,1,"mat-cell",12),d.BQk(),d.ynx(19,15),d.YNc(20,OQ,2,0,"mat-header-cell",16),d.YNc(21,kQ,3,4,"mat-cell",12),d.BQk(),d.YNc(22,RQ,1,0,"mat-header-row",17),d.YNc(23,LQ,1,3,"mat-row",18),d.YNc(24,NQ,3,0,"tr",19),d.qZA(),d._UZ(25,"mat-paginator",20),d.qZA()()()),2&t&&(d.xp6(7),d.Q6J("ngIf",i.obteniendoCorreos),d.xp6(1),d.Q6J("hidden",i.obteniendoCorreos),d.xp6(1),d.Q6J("ngIf",i.mensajesPendientes>0),d.xp6(3),d.Q6J("dataSource",i.dataSource),d.xp6(10),d.Q6J("matHeaderRowDef",i.displayedColumns),d.xp6(1),d.Q6J("matRowDefColumns",i.displayedColumns),d.xp6(2),d.Q6J("pageSizeOptions",d.DdM(7,zQ)))},dependencies:[Mn,Bo,g2,QU,wU,m2,kY,MU,F2,DU,L2,R2,AU,N2,z2,PU,OU,kU,JU,js],styles:[".internal-email-list-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;background-color:var(--principal-color);color:var(--principal-color-light)}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]{margin:30px 50px}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .obteniendo-correos[_ngcontent-%COMP%]{text-align:center;background-color:var(--principal-color-light);color:var(--principal-color);padding:30px 10px;border-radius:10px;text-shadow:1px 1px 3px var(--principal-color-40);font-size:18px}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mensajes-pendientes[_ngcontent-%COMP%]{text-align:center;background-color:var(--principal-color);color:var(--principal-color-light);padding:30px 10px;border-radius:10px;text-shadow:1px 1px 3px var(--principal-color-40);font-size:18px;margin-bottom:30px}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:40px;padding:0 10px;border:1px solid var(--principal-color);border-radius:5px;box-sizing:border-box;font-size:14px;font-weight:700;color:var(--principal-color);margin-bottom:30px}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-column-acciones[_ngcontent-%COMP%]{max-width:100px}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-row-no-mails[_ngcontent-%COMP%]{text-align:center}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-row-no-mails[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:30px 10px}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{cursor:pointer;background-color:var(--principal-color-light);transition:.2s linear all}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]{color:var(--principal-color)}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:hover{background-color:#fff;transition:.2s linear all}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:hover   mat-cell[_ngcontent-%COMP%]{color:#000}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .no-leido[_ngcontent-%COMP%]{background-color:var(--principal-color);font-weight:900;transition:.2s linear all}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .no-leido[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]{color:var(--principal-color-light)}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .no-leido[_ngcontent-%COMP%]:hover{background-color:#4384a4;transition:.2s linear all}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .no-leido[_ngcontent-%COMP%]:hover   mat-cell[_ngcontent-%COMP%]{color:#fff}"]}),n})();function VQ(n,e){1&n&&(d.TgZ(0,"div",6),d._uU(1," Obteniendo los datos del mensaje... "),d.qZA())}function UQ(n,e){if(1&n&&(d.TgZ(0,"div",7)(1,"div",8)(2,"div",9),d._uU(3,"Nombre"),d.qZA(),d.TgZ(4,"div",10),d._uU(5),d.qZA()(),d.TgZ(6,"div",8)(7,"div",9),d._uU(8,"Email"),d.qZA(),d.TgZ(9,"div",10),d._uU(10),d.qZA()(),d.TgZ(11,"div",8)(12,"div",9),d._uU(13,"Fecha de env\xedo"),d.qZA(),d.TgZ(14,"div",10),d._uU(15),d.ALo(16,"date"),d.qZA()(),d.TgZ(17,"div",8)(18,"div",9),d._uU(19,"Asunto"),d.qZA(),d.TgZ(20,"div",10),d._uU(21),d.qZA()(),d.TgZ(22,"div",8)(23,"div",9),d._uU(24,"Mensaje"),d.qZA(),d.TgZ(25,"div",10),d._uU(26),d.qZA()()()),2&n){const t=d.oxw();d.xp6(5),d.Oqu(t.datosEmail.nombre),d.xp6(5),d.Oqu(t.datosEmail.email),d.xp6(5),d.Oqu(d.xi3(16,5,t.datosEmail.fecha.toDate(),"dd/MM/yyyy HH:mm")),d.xp6(6),d.Oqu(t.datosEmail.asunto),d.xp6(5),d.Oqu(t.datosEmail.mensaje)}}let jQ=(()=>{class n{constructor(t,i,r){this.authService=t,this.messageService=i,this.router=r,this.obteniendoDatos=!1}ngOnInit(){this.obteniendoDatos=!0;const t=this.router.url.split("/")[3];this.messageService.getEmailById(t).subscribe(i=>{this.datosEmail=i,this.obteniendoDatos=!1})}ngOnDestroy(){this.messageService.updateEmailALeido(this.datosEmail)}goToList(){this.router.navigateByUrl("/private/email-list")}logout(){this.authService.logout(),this.router.navigateByUrl("/private/auth-login")}}return n.\u0275fac=function(t){return new(t||n)(d.Y36(e2),d.Y36(QR),d.Y36(Oo))},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-internal-email-detail"]],decls:12,vars:2,consts:[[1,"internal-email-detail-container"],[1,"toolbar"],["mat-icon-button","","matTooltip","Volver a la bandeja de entrada",3,"click"],["mat-icon-button","",3,"click"],["class","obteniendo-datos",4,"ngIf"],["class","email-detail",4,"ngIf"],[1,"obteniendo-datos"],[1,"email-detail"],[1,"group"],[1,"title"],[1,"value"]],template:function(t,i){1&t&&(d.TgZ(0,"div",0)(1,"mat-toolbar",1)(2,"div")(3,"button",2),d.NdJ("click",function(){return i.goToList()}),d.TgZ(4,"mat-icon"),d._uU(5,"arrow_back"),d.qZA()(),d._uU(6," Hasspro - Detalles del mensaje "),d.qZA(),d.TgZ(7,"button",3),d.NdJ("click",function(){return i.logout()}),d.TgZ(8,"mat-icon"),d._uU(9,"logout"),d.qZA()()(),d.YNc(10,VQ,2,0,"div",4),d.YNc(11,UQ,27,8,"div",5),d.qZA()),2&t&&(d.xp6(10),d.Q6J("ngIf",i.obteniendoDatos),d.xp6(1),d.Q6J("ngIf",i.datosEmail&&!i.obteniendoDatos))},dependencies:[Bo,g2,QU,JU,bU,js],styles:[".internal-email-detail-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;background-color:var(--principal-color);color:var(--principal-color-light)}.internal-email-detail-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;gap:10px;height:100%}.internal-email-detail-container[_ngcontent-%COMP%]   .obteniendo-datos[_ngcontent-%COMP%], .internal-email-detail-container[_ngcontent-%COMP%]   .email-detail[_ngcontent-%COMP%]{background-color:var(--principal-color-light);color:#000;padding:30px 10px;border-radius:10px;margin:20px 40px;box-shadow:1px 1px 3px var(--principal-color-light-80)}.internal-email-detail-container[_ngcontent-%COMP%]   .obteniendo-datos[_ngcontent-%COMP%]{text-align:center}.internal-email-detail-container[_ngcontent-%COMP%]   .email-detail[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;flex-direction:column;gap:30px}.internal-email-detail-container[_ngcontent-%COMP%]   .email-detail[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:14px;width:100%}.internal-email-detail-container[_ngcontent-%COMP%]   .email-detail[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:700;font-size:18px;text-shadow:1px 1px 1px rgba(0,0,0,.2509803922);padding-left:20px}.internal-email-detail-container[_ngcontent-%COMP%]   .email-detail[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:16px;color:var(--principal-color);padding-left:40px;white-space:break-spaces}"]}),n})(),G2=(()=>{class n{constructor(t){this.router=t}canActivate(t,i){const{url:r}=i;if(r.indexOf("private/email-list")>-1){if(!localStorage.getItem("hasspro_internal_token"))return this.router.navigateByUrl("private/auth-login"),!1}else if(r.indexOf("private/auth-login")>-1&&localStorage.getItem("hasspro_internal_token"))return this.router.navigateByUrl("private/email-list"),!0;return!0}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(Oo))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const $Q=[{path:"private",children:[{path:"auth-login",component:o7,canActivate:[G2]},{path:"email-list",component:BQ,canActivate:[G2]},{path:"email-list/:id",component:jQ,canActivate:[G2]},{path:"**",redirectTo:"auth-login"}]},{path:"",component:ZZ,children:[{path:"home",component:iy},{path:"servicios",component:QZ},{path:"contacto",component:AZ},{path:"sobre-hasspro",component:PZ},{path:"servicios/gestion-documentacion",component:RZ},{path:"servicios/gestion-participativa-sala",component:NZ},{path:"servicios/consultoria-financiera",component:t7},{path:"servicios/desarrollo-establecimientos",component:JZ},{path:"**",redirectTo:"home"}]},{path:"**",redirectTo:"/home",pathMatch:"full"}];let GQ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[Mx.forRoot($Q),Mx]}),n})(),HQ=(()=>{class n{constructor(){this.title="hasspro"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=d.Xpm({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){1&t&&d._UZ(0,"router-outlet")},dependencies:[Qu]}),n})();const ej={firebase:{apiKey:"AIzaSyDXN9asVVTHL7WB2g-jbrATljfaRk4v8e0",authDomain:"hasspro-bb0e4.firebaseapp.com",databaseURL:"https://hasspro-bb0e4-default-rtdb.europe-west1.firebasedatabase.app",projectId:"hasspro-bb0e4",storageBucket:"hasspro-bb0e4.appspot.com",messagingSenderId:"386256142322",appId:"1:386256142322:web:2241bf83271e673de5356b",measurementId:"G-X98710WS66"},production:!1,mapboxToken:"pk.eyJ1Ijoic2VyZ2lvZ2RldiIsImEiOiJja3J2eW9zcGIwYmR2MnVxamJ3MGk0djRiIn0.R1ANSOBYyCstt-QxZcI5pg"};var WQ=Ae(655);class hT{constructor(e){return e}}const tj="analytics",nj=pM.async,YQ=f_(T8,!0),KQ=f_(WB,!0),XQ=f_(M8,!0);let H2=(()=>{class n{constructor(t,i,r){let s;this.disposables=[],(0,Z.registerVersion)("angularfire",cv.full,"user-tracking"),this.initialized=i.runOutsideAngular(()=>new Promise(f=>{s=f})),nj().then(()=>{const f=r.get(hT);f?this.disposables=[GW(t).subscribe(b=>{XQ(f,b?.uid),s()})]:s()})}ngOnDestroy(){this.disposables.forEach(t=>t.unsubscribe())}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(xM),d.LFG(d.R0b),d.LFG(d.zs3))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();const ij="firebase_screen_id",q2="outlet",fT="screen_class",rj="screen_name";let cJ=Math.floor(Math.random()*(Math.pow(2,32)-1))-Math.pow(2,31);const W2={},uJ=n=>{const e=[n[fT],n[q2]].join("#");if(W2.hasOwnProperty(e))return W2[e];{const t=cJ++;return W2[e]=t,t}};let oj=(()=>{class n{constructor(t,i,r,s,f,b){(0,Z.registerVersion)("angularfire",cv.full,"screen-tracking"),nj().then(()=>{const I=b.get(hT);!t||!I||s.runOutsideAngular(()=>{this.disposable=((n,e,t)=>n.events.pipe(Yt(r=>r instanceof P_)).pipe(dn(r=>{var s;const b=(null===(s=n.parseUrl(n.url.replace(/(?:\().+(?:\))/g,me=>me.replace("://",":///"))).root.children[r.snapshot.outlet])||void 0===s?void 0:s.toString())||"",I=n.routerState.root.children.map(me=>me).find(me=>me.outlet===r.snapshot.outlet);if(!I)return c(null);let O=I;for(;O.firstChild;)O=O.firstChild;const V=O.pathFromRoot.map(me=>{var Ie;return null===(Ie=me.routeConfig)||void 0===Ie?void 0:Ie.path}).filter(me=>me).join("/")||"/",X={[rj]:V,page_path:`/${b}`,firebase_event_origin:"auto",firebase_screen:V,[q2]:r.snapshot.outlet};e&&(X.page_title=e.getTitle());let ae=I.component;if(ae){if(ae===eg){let me=r.snapshot;for(;me.firstChild;)me=me.firstChild;ae=me.component}}else ae=r.snapshot.component;if("string"==typeof ae)return c(Object.assign(Object.assign({},X),{[fT]:ae}));if(ae){const me=t.resolveComponentFactory(ae);return c(Object.assign(Object.assign({},X),{[fT]:me.selector}))}return c(null)}),Yt(r=>!!r),(0,ue.U)(r=>Object.assign({firebase_screen_class:r[fT],[ij]:uJ(r)},r)),function qQ(n,e,t,i){return(0,Xe.e)((r,s)=>{let f;e&&"function"!=typeof e?({duration:t,element:f,connector:i}=e):f=e;const b=new Map,I=Ie=>{b.forEach(Ie),Ie(s)},O=Ie=>I(Ge=>Ge.error(Ie));let V=0,X=!1;const ae=new ve.Q(s,Ie=>{try{const Ge=n(Ie);let Je=b.get(Ge);if(!Je){b.set(Ge,Je=i?i():new g.x);const Qt=function me(Ie,Ge){const Je=new L.y(Qt=>{V++;const xn=Ge.subscribe(Qt);return()=>{xn.unsubscribe(),0==--V&&X&&ae.unsubscribe()}});return Je.key=Ie,Je}(Ge,Je);if(s.next(Qt),t){const xn=(0,ve.x)(Je,()=>{Je.complete(),xn?.unsubscribe()},void 0,void 0,()=>b.delete(Ge));ae.add((0,Ut.Xf)(t(Qt)).subscribe(xn))}}Je.next(f?f(Ie):Ie)}catch(Ge){O(Ge)}},()=>I(Ie=>Ie.complete()),O,()=>b.clear(),()=>(X=!0,0===V));r.subscribe(ae)})}(r=>r[q2]),(0,yn.z)(r=>r.pipe(CM((s,f)=>JSON.stringify(s)===JSON.stringify(f)),gn(void 0),wM(),(0,ue.U)(([s,f])=>s?Object.assign({firebase_previous_class:s[fT],firebase_previous_screen:s[rj],firebase_previous_id:s[ij]},f):f)))))(t,i,r).pipe(dn(O=>(0,WQ.mG)(this,void 0,void 0,function*(){return f&&(yield f.initialized),KQ(I,"screen_view",O)}))).subscribe()})})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(Oo,8),d.LFG(mn,8),d.LFG(d._Vd),d.LFG(d.R0b),d.LFG(H2,8),d.LFG(d.zs3))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();const Z2=new d.OlP("angularfire2.analytics-instances");function fJ(n){return(e,t)=>{if(!pM.sync())return null;const i=e.runOutsideAngular(()=>n(t));return new hT(i)}}const pJ={provide:class ZQ{constructor(){return jE(tj)}},deps:[[new d.FiY,Z2]]},mJ={provide:hT,useFactory:function hJ(n,e){if(!pM.sync())return null;const t=UE(tj,n,e);return t&&new hT(t)},deps:[[new d.FiY,Z2],uv]};let gJ=(()=>{class n{constructor(t,i){(0,Z.registerVersion)("angularfire",cv.full,"analytics")}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(oj,8),d.LFG(H2,8))},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[mJ,pJ,{provide:d.ip1,useValue:pM.async,multi:!0}]}),n})();function _J(n,...e){return{ngModule:gJ,providers:[{provide:Z2,useFactory:fJ(n),multi:!0,deps:[d.R0b,d.zs3,Db,$E,...e]}]}}const sj="@firebase/database";let Y2="";class vJ{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,K.Wl)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,K.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class bJ{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,K.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const lj=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new vJ(e)}}catch{}return new bJ},Bb=lj("localStorage"),K2=lj("sessionStorage"),b1=new ie.Yd("@firebase/database"),cj=function(){let n=1;return function(){return n++}}(),uj=function(n){const e=(0,K.dS)(n),t=new K.gQ;t.update(e);const i=t.digest();return K.US.encodeByteArray(i)},pT=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?e+=pT.apply(null,i):e+="object"==typeof i?(0,K.Wl)(i):i,e+=" "}return e};let Vb=null,dj=!0;const vl=function(...n){if(!0===dj&&(dj=!1,null===Vb&&!0===K2.get("logging_enabled")&&function(n,e){(0,K.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(b1.logLevel=ie.in.VERBOSE,Vb=b1.log.bind(b1),e&&K2.set("logging_enabled",!0)):"function"==typeof n?Vb=n:(Vb=null,K2.remove("logging_enabled"))}(!0)),Vb){const e=pT.apply(null,n);Vb(e)}},mT=function(n){return function(...e){vl(n,...e)}},X2=function(...n){const e="FIREBASE INTERNAL ERROR: "+pT(...n);b1.error(e)},Fm=function(...n){const e=`FIREBASE FATAL ERROR: ${pT(...n)}`;throw b1.error(e),new Error(e)},kc=function(...n){const e="FIREBASE WARNING: "+pT(...n);b1.warn(e)},tD=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},mv="[MIN_NAME]",b_="[MAX_NAME]",Ub=function(n,e){if(n===e)return 0;if(n===mv||e===b_)return-1;if(e===mv||n===b_)return 1;{const t=mj(n),i=mj(e);return null!==t?null!==i?t-i==0?n.length-e.length:t-i:-1:null!==i?1:n<e?-1:1}},CJ=function(n,e){return n===e?0:n<e?-1:1},gT=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,K.Wl)(e))},Q2=function(n){if("object"!=typeof n||null===n)return(0,K.Wl)(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)0!==i&&(t+=","),t+=(0,K.Wl)(e[i]),t+=":",t+=Q2(n[e[i]]);return t+="}",t},fj=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let r=0;r<t;r+=e)i.push(n.substring(r,r+e>t?t:r+e));return i};function bl(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const pj=function(n){(0,K.hu)(!tD(n),"Invalid JSON number");const i=1023;let r,s,f,b,I;0===n?(s=0,f=0,r=1/n==-1/0?1:0):(r=n<0,(n=Math.abs(n))>=Math.pow(2,1-i)?(b=Math.min(Math.floor(Math.log(n)/Math.LN2),i),s=b+i,f=Math.round(n*Math.pow(2,52-b)-Math.pow(2,52))):(s=0,f=Math.round(n/Math.pow(2,-1074))));const O=[];for(I=52;I;I-=1)O.push(f%2?1:0),f=Math.floor(f/2);for(I=11;I;I-=1)O.push(s%2?1:0),s=Math.floor(s/2);O.push(r?1:0),O.reverse();const V=O.join("");let X="";for(I=0;I<64;I+=8){let ae=parseInt(V.substr(I,8),2).toString(16);1===ae.length&&(ae="0"+ae),X+=ae}return X.toLowerCase()},SJ=new RegExp("^-?(0*)\\d{1,10}$"),mj=function(n){if(SJ.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},x1=function(n){try{n()}catch(e){setTimeout(()=>{throw kc("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},AJ=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},_T=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class PJ{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){kc(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class OJ{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(vl("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',kc(e)}}let yT=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const bj=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Cj="websocket",Ej="long_polling";class eF{constructor(e,t,i,r,s=!1,f="",b=!1,I=!1){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=f,this.includeNamespaceInQueryParams=b,this.isUsingEmulator=I,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Bb.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Bb.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function Tj(n,e,t){let i;if((0,K.hu)("string"==typeof e,"typeof type must == string"),(0,K.hu)("object"==typeof t,"typeof params must == object"),e===Cj)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==Ej)throw new Error("Unknown connection type: "+e);i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function kJ(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const r=[];return bl(t,(s,f)=>{r.push(s+"="+f)}),i+r.join("&")}class RJ{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,K.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,K.p$)(this.counters_)}}const tF={},nF={};function iF(n){const e=n.toString();return tF[e]||(tF[e]=new RJ),tF[e]}class LJ{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&x1(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class gv{constructor(e,t,i,r,s,f,b){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=f,this.lastSessionId=b,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=mT(e),this.stats_=iF(t),this.urlFn=I=>(this.appCheckToken&&(I.ac=this.appCheckToken),Tj(t,Ej,I))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new LJ(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,K.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new rF((...s)=>{const[f,b,I,O,V]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===f)this.id=b,this.password=I;else{if("close"!==f)throw new Error("Unrecognized command received: "+f);b?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(b,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[f,b]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(f,b)},()=>{this.onClosed_()},this.urlFn);const i={start:"t"};i.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(i.cb=this.scriptTagHolder.uniqueCallbackIdentifier),i.v="5",this.transportSessionId&&(i.s=this.transportSessionId),this.lastSessionId&&(i.ls=this.lastSessionId),this.applicationId&&(i.p=this.applicationId),this.appCheckToken&&(i.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&bj.test(location.hostname)&&(i.r="f");const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){gv.forceAllow_=!0}static forceDisallow(){gv.forceDisallow_=!0}static isAvailable(){return!((0,K.Yr)()||!gv.forceAllow_&&(gv.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,K.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=(0,K.h$)(t),r=fj(i,1840);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,K.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const i={dframe:"t"};i.id=e,i.pw=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,K.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class rF{constructor(e,t,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,K.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=cj(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=rF.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const f="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(f),this.myIFrame.doc.close()}catch(b){vl("frame writing exception"),b.stack&&vl(b.stack),vl(b)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||vl("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+i.length<=1870;){const f=this.pendingSegs.shift();i=i+"&seg"+r+"="+f.seg+"&ts"+r+"="+f.ts+"&d"+r+"="+f.d,r++}return t+=i,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(r),i()})}addTag(e,t){(0,K.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||"loaded"===r||"complete"===r)&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{vl("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}let iD=null;typeof MozWebSocket<"u"?iD=MozWebSocket:typeof WebSocket<"u"&&(iD=WebSocket);let w1=(()=>{class n{constructor(t,i,r,s,f,b,I){this.connId=t,this.applicationId=r,this.appCheckToken=s,this.authToken=f,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=mT(this.connId),this.stats_=iF(i),this.connURL=n.connectionURL_(i,b,I,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(t,i,r,s,f){const b={v:"5"};return!(0,K.Yr)()&&typeof location<"u"&&location.hostname&&bj.test(location.hostname)&&(b.r="f"),i&&(b.s=i),r&&(b.ls=r),s&&(b.ac=s),f&&(b.p=f),Tj(t,Cj,b)}open(t,i){this.onDisconnect=i,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Bb.set("previous_websocket_failure",!0);try{let r;if((0,K.Yr)()){r={headers:{"User-Agent":`Firebase/5/${Y2}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);const f=process.env,b=0===this.connURL.indexOf("wss://")?f.HTTPS_PROXY||f.https_proxy:f.HTTP_PROXY||f.http_proxy;b&&(r.proxy={origin:b})}this.mySock=new iD(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==iD&&!n.forceDisallow_}static previouslyFailed(){return Bb.isInMemoryStorage||!0===Bb.get("previous_websocket_failure")}markConnectionHealthy(){Bb.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const i=this.frames.join("");this.frames=null;const r=(0,K.cI)(i);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,K.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const i=Number(t);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const i=t.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(i);else{const r=this.extractFrameCount_(i);null!==r&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();const i=(0,K.Wl)(t);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);const r=fj(i,16384);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),Oj=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[gv,w1]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const i=w1&&w1.isAvailable();let r=i&&!w1.previouslyFailed();if(t.webSocketOnly&&(i||kc("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[w1];else{const s=this.transports_=[];for(const f of n.ALL_TRANSPORTS)f&&f.isAvailable()&&s.push(f);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class Bj{constructor(e,t,i,r,s,f,b,I,O,V){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=f,this.onReady_=b,this.onDisconnect_=I,this.onKill_=O,this.lastSessionId=V,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=mT("c:"+this.id+":"),this.transportManager_=new Oj(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=_T(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=gT("t",e),i=gT("d",e);if("c"===t)this.onSecondaryControl_(i);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(i)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=gT("t",e),i=gT("d",e);"c"===t?this.onControl_(i):"d"===t&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=gT("t",e);if("d"in e){const i=e.d;if("h"===t){const r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(i):"r"===t?this.onReset_(i):"e"===t?X2("Server Error: "+i):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):X2("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==i&&kc("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),_T(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):_T(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Bb.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Vj{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}class Uj{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,K.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!i||i===r[s].context))return void r.splice(s,1)}validateEventType_(e){(0,K.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class rD extends Uj{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,K.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new rD}getInitialEvent(e){return(0,K.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const jj=32,$j=768;class yo{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Kr(){return new yo("")}function vr(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function _v(n){return n.pieces_.length-n.pieceNum_}function Wo(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new yo(n.pieces_,e)}function sF(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function vT(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Gj(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new yo(e,0)}function Ss(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof yo)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new yo(t,0)}function br(n){return n.pieceNum_>=n.pieces_.length}function Cu(n,e){const t=vr(n),i=vr(e);if(null===t)return e;if(t===i)return Cu(Wo(n),Wo(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function aF(n,e){if(_v(n)!==_v(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function rf(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(_v(n)>_v(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class oee{constructor(e,t){this.errorPrefix_=t,this.parts_=vT(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=(0,K.ug)(this.parts_[i]);Hj(this)}}function Hj(n){if(n.byteLength_>$j)throw new Error(n.errorPrefix_+"has a key path longer than "+$j+" bytes ("+n.byteLength_+").");if(n.parts_.length>jj)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+jj+") or object contains a cycle "+jb(n))}function jb(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class lF extends Uj{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new lF}getInitialEvent(e){return(0,K.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const bT=1e3;let sD,$b=(()=>{class n extends Vj{constructor(t,i,r,s,f,b,I,O){if(super(),this.repoInfo_=t,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=f,this.authTokenProvider_=b,this.appCheckTokenProvider_=I,this.authOverride_=O,this.id=n.nextPersistentConnectionId_++,this.log_=mT("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=bT,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,O&&!(0,K.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");lF.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&rD.getInstance().on("online",this.onOnline_,this)}sendRequest(t,i,r){const s=++this.requestNumber_,f={r:s,a:t,b:i};this.log_((0,K.Wl)(f)),(0,K.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(f),r&&(this.requestCBHash_[s]=r)}get(t){this.initConnection_();const i=new K.BH,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:b=>{const I=b.d;"ok"===b.s?i.resolve(I):i.reject(I)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),i.promise}listen(t,i,r,s){this.initConnection_();const f=t._queryIdentifier,b=t._path.toString();this.log_("Listen called for "+b+" "+f),this.listens.has(b)||this.listens.set(b,new Map),(0,K.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,K.hu)(!this.listens.get(b).has(f),"listen() called twice for same path/queryId.");const I={onComplete:s,hashFn:i,query:t,tag:r};this.listens.get(b).set(f,I),this.connected_&&this.sendListen_(I)}sendGet_(t){const i=this.outstandingGets_[t];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(t){const i=t.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);const f={p:r};t.tag&&(f.q=i._queryObject,f.t=t.tag),f.h=t.hashFn(),this.sendRequest("q",f,I=>{const O=I.d,V=I.s;n.warnOnListenWarnings_(O,i),(this.listens.get(r)&&this.listens.get(r).get(s))===t&&(this.log_("listen response",I),"ok"!==V&&this.removeListen_(r,s),t.onComplete&&t.onComplete(V,O))})}static warnOnListenWarnings_(t,i){if(t&&"object"==typeof t&&(0,K.r3)(t,"w")){const r=(0,K.DV)(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',f=i._path.toString();kc(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${f} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,K.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,i=(0,K.w9)(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{const f=s.s,b=s.d||"error";this.authToken_===t&&("ok"===f?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(f,b))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const i=t.s,r=t.d||"error";"ok"===i?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(t,i){const r=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),(0,K.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,t._queryObject,i)}sendUnlisten_(t,i,r,s){this.log_("Unlisten on "+t+" for "+i);const f={p:t};s&&(f.q=r,f.t=s),this.sendRequest("n",f)}onDisconnectPut(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:i,onComplete:r})}onDisconnectMerge(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:i,onComplete:r})}onDisconnectCancel(t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(t,i,r,s){const f={p:i,d:r};this.log_("onDisconnect "+t,f),this.sendRequest(t,f,b=>{s&&setTimeout(()=>{s(b.s,b.d)},Math.floor(0))})}put(t,i,r,s){this.putInternal("p",t,i,r,s)}merge(t,i,r,s){this.putInternal("m",t,i,r,s)}putInternal(t,i,r,s,f){this.initConnection_();const b={p:i,d:r};void 0!==f&&(b.h=f),this.outstandingPuts_.push({action:t,request:b,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+i)}sendPut_(t){const i=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(i,r,f=>{this.log_(i+" response",f),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(f.s,f.d)})}reportStats(t){if(this.connected_){const i={c:t};this.log_("reportStats",i),this.sendRequest("s",i,r=>{"ok"!==r.s&&this.log_("reportStats","Error sending stats: "+r.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,K.Wl)(t));const i=t.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,i){this.log_("handleServerMessage",t,i),"d"===t?this.onDataUpdate_(i.p,i.d,!1,i.t):"m"===t?this.onDataUpdate_(i.p,i.d,!0,i.t):"c"===t?this.onListenRevoked_(i.p,i.q):"ac"===t?this.onAuthRevoked_(i.s,i.d):"apc"===t?this.onAppCheckRevoked_(i.s,i.d):"sd"===t?this.onSecurityDebugPacket_(i):X2("Unrecognized action received from server: "+(0,K.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,K.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=bT,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=bT,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=bT),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let i=Math.max(0,this.reconnectDelay_-t);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,z.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const i=t.onDataMessage_.bind(t),r=t.onReady_.bind(t),s=t.onRealtimeDisconnect_.bind(t),f=t.id+":"+n.nextConnectionId_++,b=t.lastSessionId;let I=!1,O=null;const V=function(){O?O.close():(I=!0,s())};t.realtime_={close:V,sendRequest:function(me){(0,K.hu)(O,"sendRequest call when we're not connected not allowed."),O.sendRequest(me)}};const ae=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[me,Ie]=yield Promise.all([t.authTokenProvider_.getToken(ae),t.appCheckTokenProvider_.getToken(ae)]);I?vl("getToken() completed but was canceled"):(vl("getToken() completed. Creating connection."),t.authToken_=me&&me.accessToken,t.appCheckToken_=Ie&&Ie.token,O=new Bj(f,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,i,r,s,Ge=>{kc(Ge+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},b))}catch(me){t.log_("Failed to get token: "+me),I||(t.repoInfo_.nodeAdmin&&kc(me),V())}}})()}interrupt(t){vl("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){vl("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,K.xb)(this.interruptReasons_)&&(this.reconnectDelay_=bT,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const i=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const i=this.outstandingPuts_[t];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,i){let r;r=i?i.map(f=>Q2(f)).join("$"):"default";const s=this.removeListen_(t,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,i){const r=new yo(t).toString();let s;if(this.listens.has(r)){const f=this.listens.get(r);s=f.get(i),f.delete(i),0===f.size&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(t,i){vl("Auth token revoked: "+t+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,i){vl("App check token revoked: "+t+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const i of t.values())this.sendListen_(i);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let i="js";(0,K.Yr)()&&(i=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+i+"."+Y2.replace(/\./g,"-")]=1,(0,K.uI)()?t["framework.cordova"]=1:(0,K.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=rD.getInstance().currentlyOnline();return(0,K.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class wr{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new wr(e,t)}}class oD{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new wr(mv,e),r=new wr(mv,t);return 0!==this.compare(i,r)}minPost(){return wr.MIN}}class Zj extends oD{static get __EMPTY_NODE(){return sD}static set __EMPTY_NODE(e){sD=e}compare(e,t){return Ub(e.name,t.name)}isDefinedOn(e){throw(0,K.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return wr.MIN}maxPost(){return new wr(b_,sD)}makePost(e,t){return(0,K.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new wr(e,sD)}toString(){return".key"}}const Lm=new Zj;class aD{constructor(e,t,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let f=1;for(;!e.isEmpty();)if(f=t?i(e.key,t):1,r&&(f*=-1),f<0)e=this.isReverse_?e.left:e.right;else{if(0===f){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let uF,yp=(()=>{class n{constructor(t,i,r,s,f){this.key=t,this.value=i,this.color=r??n.RED,this.left=s??gd.EMPTY_NODE,this.right=f??gd.EMPTY_NODE}copy(t,i,r,s,f){return new n(t??this.key,i??this.value,r??this.color,s??this.left,f??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this;const f=r(t,s.key);return s=f<0?s.copy(null,null,null,s.left.insert(t,i,r),null):0===f?s.copy(null,i,null,null,null):s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return gd.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,i){let r,s;if(r=this,i(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),0===i(t,r.key)){if(r.right.isEmpty())return gd.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class gd{constructor(e,t=gd.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new gd(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,yp.BLACK,null,null))}remove(e){return new gd(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,yp.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),0===t)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),0===t){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}t<0?i=i.left:t>0&&(r=i,i=i.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new aD(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new aD(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new aD(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new aD(this.root_,null,this.comparator_,!0,e)}}function fee(n,e){return Ub(n.name,e.name)}function cF(n,e){return Ub(n,e)}gd.EMPTY_NODE=new class hee{copy(e,t,i,r,s){return this}insert(e,t,i){return new yp(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Yj=function(n){return"number"==typeof n?"number:"+pj(n):"string:"+n},Kj=function(n){if(n.isLeafNode()){const e=n.val();(0,K.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,K.r3)(e,".sv"),"Priority must be a string or number.")}else(0,K.hu)(n===uF||n.isEmpty(),"priority of unexpected type.");(0,K.hu)(n===uF||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Xj,Qj,Jj,C1=(()=>{class n{constructor(t,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=i,this.lazyHash_=null,(0,K.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Kj(this.priorityNode_)}static set __childrenNodeConstructor(t){Xj=t}static get __childrenNodeConstructor(){return Xj}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return br(t)?this:".priority"===vr(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,i){return null}updateImmediateChild(t,i){return".priority"===t?this.updatePriority(i):i.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,i).updatePriority(this.priorityNode_)}updateChild(t,i){const r=vr(t);return null===r?i:i.isEmpty()&&".priority"!==r?this:((0,K.hu)(".priority"!==r||1===_v(t),".priority must be the last token in a path"),this.updateImmediateChild(r,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Wo(t),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,i){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Yj(this.priorityNode_.val())+":");const i=typeof this.value_;t+=i+":",t+="number"===i?pj(this.value_):this.value_,this.lazyHash_=uj(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,K.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const i=typeof t.value_,r=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(i),f=n.VALUE_TYPE_ORDER.indexOf(r);return(0,K.hu)(s>=0,"Unknown leaf type: "+i),(0,K.hu)(f>=0,"Unknown leaf type: "+r),s===f?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:f-s}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const ss=new class _ee extends oD{compare(e,t){const i=e.node.getPriority(),r=t.node.getPriority(),s=i.compareTo(r);return 0===s?Ub(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return wr.MIN}maxPost(){return new wr(b_,new C1("[PRIORITY-POST]",Jj))}makePost(e,t){const i=Qj(e);return new wr(t,new C1("[PRIORITY-POST]",i))}toString(){return".priority"}},yee=Math.log(2);class vee{constructor(e){this.count=parseInt(Math.log(e+1)/yee,10),this.current_=this.count-1;const r=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const lD=function(n,e,t,i){n.sort(e);const r=function(I,O){const V=O-I;let X,ae;if(0===V)return null;if(1===V)return X=n[I],ae=t?t(X):X,new yp(ae,X.node,yp.BLACK,null,null);{const me=parseInt(V/2,10)+I,Ie=r(I,me),Ge=r(me+1,O);return X=n[me],ae=t?t(X):X,new yp(ae,X.node,yp.BLACK,Ie,Ge)}},b=function(I){let O=null,V=null,X=n.length;const ae=function(Ie,Ge){const Je=X-Ie,Qt=X;X-=Ie;const xn=r(Je+1,Qt),Nn=n[Je],ai=t?t(Nn):Nn;me(new yp(ai,Nn.node,Ge,null,xn))},me=function(Ie){O?(O.left=Ie,O=Ie):(V=Ie,O=Ie)};for(let Ie=0;Ie<I.count;++Ie){const Ge=I.nextBitIsOne(),Je=Math.pow(2,I.count-(Ie+1));Ge?ae(Je,yp.BLACK):(ae(Je,yp.BLACK),ae(Je,yp.RED))}return V}(new vee(n.length));return new gd(i||e,b)};let dF;const E1={};class x_{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,K.hu)(E1&&ss,"ChildrenNode.ts has not been loaded"),dF=dF||new x_({".priority":E1},{".priority":ss}),dF}get(e){const t=(0,K.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof gd?t:null}hasIndex(e){return(0,K.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,K.hu)(e!==Lm,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const s=t.getIterator(wr.Wrap);let b,f=s.getNext();for(;f;)r=r||e.isDefinedOn(f.node),i.push(f),f=s.getNext();b=r?lD(i,e.getCompare()):E1;const I=e.toString(),O=Object.assign({},this.indexSet_);O[I]=e;const V=Object.assign({},this.indexes_);return V[I]=b,new x_(V,O)}addToIndexes(e,t){const i=(0,K.UI)(this.indexes_,(r,s)=>{const f=(0,K.DV)(this.indexSet_,s);if((0,K.hu)(f,"Missing index implementation for "+s),r===E1){if(f.isDefinedOn(e.node)){const b=[],I=t.getIterator(wr.Wrap);let O=I.getNext();for(;O;)O.name!==e.name&&b.push(O),O=I.getNext();return b.push(e),lD(b,f.getCompare())}return E1}{const b=t.get(e.name);let I=r;return b&&(I=I.remove(new wr(e.name,b))),I.insert(e,e.node)}});return new x_(i,this.indexSet_)}removeFromIndexes(e,t){const i=(0,K.UI)(this.indexes_,r=>{if(r===E1)return r;{const s=t.get(e.name);return s?r.remove(new wr(e.name,s)):r}});return new x_(i,this.indexSet_)}}let xT,lr=(()=>{class n{constructor(t,i,r){this.children_=t,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Kj(this.priorityNode_),this.children_.isEmpty()&&(0,K.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return xT||(xT=new n(new gd(cF),null,x_.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||xT}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const i=this.children_.get(t);return null===i?xT:i}}getChild(t){const i=vr(t);return null===i?this:this.getImmediateChild(i).getChild(Wo(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,i){if((0,K.hu)(i,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(i);{const r=new wr(t,i);let s,f;i.isEmpty()?(s=this.children_.remove(t),f=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(t,i),f=this.indexMap_.addToIndexes(r,this.children_));const b=s.isEmpty()?xT:this.priorityNode_;return new n(s,b,f)}}updateChild(t,i){const r=vr(t);if(null===r)return i;{(0,K.hu)(".priority"!==vr(t)||1===_v(t),".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Wo(t),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const i={};let r=0,s=0,f=!0;if(this.forEachChild(ss,(b,I)=>{i[b]=I.val(t),r++,f&&n.INTEGER_REGEXP_.test(b)?s=Math.max(s,Number(b)):f=!1}),!t&&f&&s<2*r){const b=[];for(const I in i)b[I]=i[I];return b}return t&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+Yj(this.getPriority().val())+":"),this.forEachChild(ss,(i,r)=>{const s=r.hash();""!==s&&(t+=":"+i+":"+s)}),this.lazyHash_=""===t?"":uj(t)}return this.lazyHash_}getPredecessorChildName(t,i,r){const s=this.resolveIndex_(r);if(s){const f=s.getPredecessorKey(new wr(t,i));return f?f.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const i=this.resolveIndex_(t);if(i){const r=i.minKey();return r&&r.name}return this.children_.minKey()}getFirstChild(t){const i=this.getFirstChildName(t);return i?new wr(i,this.children_.get(i)):null}getLastChildName(t){const i=this.resolveIndex_(t);if(i){const r=i.maxKey();return r&&r.name}return this.children_.maxKey()}getLastChild(t){const i=this.getLastChildName(t);return i?new wr(i,this.children_.get(i)):null}forEachChild(t,i){const r=this.resolveIndex_(t);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,i){const r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,wr.Wrap);let f=s.peek();for(;null!=f&&i.compare(f,t)<0;)s.getNext(),f=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,i){const r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,wr.Wrap);let f=s.peek();for(;null!=f&&i.compare(f,t)>0;)s.getNext(),f=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===wT?-1:0}withIndex(t){if(t===Lm||this.indexMap_.hasIndex(t))return this;{const i=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(t){return t===Lm||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const i=t;if(this.getPriority().equals(i.getPriority())){if(this.children_.count()===i.children_.count()){const r=this.getIterator(ss),s=i.getIterator(ss);let f=r.getNext(),b=s.getNext();for(;f&&b;){if(f.name!==b.name||!f.node.equals(b.node))return!1;f=r.getNext(),b=s.getNext()}return null===f&&null===b}return!1}return!1}}resolveIndex_(t){return t===Lm?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const wT=new class bee extends lr{constructor(){super(new gd(cF),lr.EMPTY_NODE,x_.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return lr.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(wr,{MIN:{value:new wr(mv,lr.EMPTY_NODE)},MAX:{value:new wr(b_,wT)}}),Zj.__EMPTY_NODE=lr.EMPTY_NODE,C1.__childrenNodeConstructor=lr,function pee(n){uF=n}(wT),function gee(n){Jj=n}(wT);const xee=!0;function zs(n,e=null){if(null===n)return lr.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,K.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new C1(n,zs(e));if(n instanceof Array||!xee){let t=lr.EMPTY_NODE;return bl(n,(i,r)=>{if((0,K.r3)(n,i)&&"."!==i.substring(0,1)){const s=zs(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(i,s))}}),t.updatePriority(zs(e))}{const t=[];let i=!1;if(bl(n,(f,b)=>{if("."!==f.substring(0,1)){const I=zs(b);I.isEmpty()||(i=i||!I.getPriority().isEmpty(),t.push(new wr(f,I)))}}),0===t.length)return lr.EMPTY_NODE;const s=lD(t,fee,f=>f.name,cF);if(i){const f=lD(t,ss.getCompare());return new lr(s,zs(e),new x_({".priority":f},{".priority":ss}))}return new lr(s,zs(e),x_.Default)}}!function mee(n){Qj=n}(zs);class hF extends oD{constructor(e){super(),this.indexPath_=e,(0,K.hu)(!br(e)&&".priority"!==vr(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),r=this.extractChild(t.node),s=i.compareTo(r);return 0===s?Ub(e.name,t.name):s}makePost(e,t){const i=zs(e),r=lr.EMPTY_NODE.updateChild(this.indexPath_,i);return new wr(t,r)}maxPost(){const e=lr.EMPTY_NODE.updateChild(this.indexPath_,wT);return new wr(b_,e)}toString(){return vT(this.indexPath_,0).join("/")}}const fF=new class wee extends oD{compare(e,t){const i=e.node.compareTo(t.node);return 0===i?Ub(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return wr.MIN}maxPost(){return wr.MAX}makePost(e,t){const i=zs(e);return new wr(t,i)}toString(){return".value"}};function ET(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class mF{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ss}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,K.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,K.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:mv}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,K.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,K.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:b_}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,K.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ss}copy(){const e=new mF;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function t4(n){const e={};if(n.isDefault())return e;let t;if(n.index_===ss?t="$priority":n.index_===fF?t="$value":n.index_===Lm?t="$key":((0,K.hu)(n.index_ instanceof hF,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,K.Wl)(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=(0,K.Wl)(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+(0,K.Wl)(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=(0,K.Wl)(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+(0,K.Wl)(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function n4(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==ss&&(e.i=n.index_.toString()),e}class uD extends Vj{constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=mT("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,K.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,r){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const f=uD.getListenId_(e,i),b={};this.listens_[f]=b;const I=t4(e._queryParams);this.restRequest_(s+".json",I,(O,V)=>{let X=V;if(404===O&&(X=null,O=null),null===O&&this.onDataUpdate_(s,X,!1,i),(0,K.DV)(this.listens_,f)===b){let ae;ae=O?401===O?"permission_denied":"rest_error:"+O:"ok",r(ae,null)}})}unlisten(e,t){const i=uD.getListenId_(e,t);delete this.listens_[i]}get(e){const t=t4(e._queryParams),i=e._path.toString(),r=new K.BH;return this.restRequest_(i+".json",t,(s,f)=>{let b=f;404===s&&(b=null,s=null),null===s?(this.onDataUpdate_(i,b,!1,null),r.resolve(b)):r.reject(new Error(b))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);const f=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,K.xO)(t);this.log_("Sending REST request for "+f);const b=new XMLHttpRequest;b.onreadystatechange=()=>{if(i&&4===b.readyState){this.log_("REST Response for "+f+" received. status:",b.status,"response:",b.responseText);let I=null;if(b.status>=200&&b.status<300){try{I=(0,K.cI)(b.responseText)}catch{kc("Failed to parse JSON response for "+f+": "+b.responseText)}i(null,I)}else 401!==b.status&&404!==b.status&&kc("Got unsuccessful REST response for "+f+" Status: "+b.status),i(b.status);i=null}},b.open("GET",f,!0),b.send()})}}class Aee{constructor(){this.rootNode_=lr.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function dD(){return{value:null,children:new Map}}function I1(n,e,t){if(br(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const i=vr(e);n.children.has(i)||n.children.set(i,dD()),I1(n.children.get(i),e=Wo(e),t)}}function vF(n,e,t){null!==n.value?t(e,n.value):function Pee(n,e){n.children.forEach((t,i)=>{e(i,t)})}(n,(i,r)=>{vF(r,new yo(e.toString()+"/"+i),t)})}class Oee{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&bl(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}}class Fee{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Oee(e);const i=1e4+2e4*Math.random();_T(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;bl(e,(r,s)=>{s>0&&(0,K.r3)(this.statsToReport_,r)&&(t[r]=s,i=!0)}),i&&this.server_.reportStats(t),_T(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var sf=(()=>(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(sf||(sf={})),sf))();function wF(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class hD{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=sf.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(br(this.path)){if(null!=this.affectedTree.value)return(0,K.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new yo(e));return new hD(Kr(),t,this.revert)}}return(0,K.hu)(vr(this.path)===e,"operationForChild called for unrelated child."),new hD(Wo(this.path),this.affectedTree,this.revert)}}class Gb{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=sf.OVERWRITE}operationForChild(e){return br(this.path)?new Gb(this.source,Kr(),this.snap.getImmediateChild(e)):new Gb(this.source,Wo(this.path),this.snap)}}class S1{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=sf.MERGE}operationForChild(e){if(br(this.path)){const t=this.children.subtree(new yo(e));return t.isEmpty()?null:t.value?new Gb(this.source,Kr(),t.value):new S1(this.source,Kr(),t)}return(0,K.hu)(vr(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new S1(this.source,Wo(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class yv{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(br(e))return this.isFullyInitialized()&&!this.filtered_;const t=vr(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function ST(n,e,t,i,r,s){const f=i.filter(b=>b.type===t);f.sort((b,I)=>function Bee(n,e,t){if(null==e.childName||null==t.childName)throw(0,K.g5)("Should only compare child_ events.");const i=new wr(e.childName,e.snapshotNode),r=new wr(t.childName,t.snapshotNode);return n.index_.compare(i,r)}(n,b,I)),f.forEach(b=>{const I=function zee(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,b,s);r.forEach(O=>{O.respondsTo(b.type)&&e.push(O.createEvent(I,n.query_))})})}function fD(n,e){return{eventCache:n,serverCache:e}}function MT(n,e,t,i){return fD(new yv(e,t,i),n.serverCache)}function r4(n,e,t,i){return fD(n.eventCache,new yv(e,t,i))}function pD(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Hb(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let CF;class as{constructor(e,t=(()=>(CF||(CF=new gd(CJ)),CF))()){this.value=e,this.children=t}static fromObject(e){let t=new as(null);return bl(e,(i,r)=>{t=t.set(new yo(i),r)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Kr(),value:this.value};if(br(e))return null;{const i=vr(e),r=this.children.get(i);if(null!==r){const s=r.findRootMostMatchingPathAndValue(Wo(e),t);return null!=s?{path:Ss(new yo(i),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(br(e))return this;{const t=vr(e),i=this.children.get(t);return null!==i?i.subtree(Wo(e)):new as(null)}}set(e,t){if(br(e))return new as(t,this.children);{const i=vr(e),s=(this.children.get(i)||new as(null)).set(Wo(e),t),f=this.children.insert(i,s);return new as(this.value,f)}}remove(e){if(br(e))return this.children.isEmpty()?new as(null):new as(null,this.children);{const t=vr(e),i=this.children.get(t);if(i){const r=i.remove(Wo(e));let s;return s=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&s.isEmpty()?new as(null):new as(this.value,s)}return this}}get(e){if(br(e))return this.value;{const t=vr(e),i=this.children.get(t);return i?i.get(Wo(e)):null}}setTree(e,t){if(br(e))return t;{const i=vr(e),s=(this.children.get(i)||new as(null)).setTree(Wo(e),t);let f;return f=s.isEmpty()?this.children.remove(i):this.children.insert(i,s),new as(this.value,f)}}fold(e){return this.fold_(Kr(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(Ss(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,Kr(),t)}findOnPath_(e,t,i){const r=!!this.value&&i(t,this.value);if(r)return r;if(br(e))return null;{const s=vr(e),f=this.children.get(s);return f?f.findOnPath_(Wo(e),Ss(t,s),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Kr(),t)}foreachOnPath_(e,t,i){if(br(e))return this;{this.value&&i(t,this.value);const r=vr(e),s=this.children.get(r);return s?s.foreachOnPath_(Wo(e),Ss(t,r),i):new as(null)}}foreach(e){this.foreach_(Kr(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_(Ss(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}class vp{constructor(e){this.writeTree_=e}static empty(){return new vp(new as(null))}}function DT(n,e,t){if(br(e))return new vp(new as(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(null!=i){const r=i.path;let s=i.value;const f=Cu(r,e);return s=s.updateChild(f,t),new vp(n.writeTree_.set(r,s))}{const r=new as(t),s=n.writeTree_.setTree(e,r);return new vp(s)}}}function EF(n,e,t){let i=n;return bl(t,(r,s)=>{i=DT(i,Ss(e,r),s)}),i}function o4(n,e){if(br(e))return vp.empty();{const t=n.writeTree_.setTree(e,new as(null));return new vp(t)}}function TF(n,e){return null!=qb(n,e)}function qb(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(Cu(t.path,e)):null}function s4(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(ss,(i,r)=>{e.push(new wr(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{null!=r.value&&e.push(new wr(i,r.value))}),e}function vv(n,e){if(br(e))return n;{const t=qb(n,e);return new vp(null!=t?new as(t):n.writeTree_.subtree(e))}}function IF(n){return n.writeTree_.isEmpty()}function M1(n,e){return a4(Kr(),n.writeTree_,e)}function a4(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{".priority"===r?((0,K.hu)(null!==s.value,"Priority writes must always be leaf nodes"),i=s.value):t=a4(Ss(n,r),s,t)}),!t.getChild(n).isEmpty()&&null!==i&&(t=t.updateChild(Ss(n,".priority"),i)),t}}function mD(n,e){return h4(e,n)}function Hee(n,e){if(n.snap)return rf(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&rf(Ss(n.path,t),e))return!0;return!1}function Wee(n){return n.visible}function l4(n,e,t){let i=vp.empty();for(let r=0;r<n.length;++r){const s=n[r];if(e(s)){const f=s.path;let b;if(s.snap)rf(t,f)?(b=Cu(t,f),i=DT(i,b,s.snap)):rf(f,t)&&(b=Cu(f,t),i=DT(i,Kr(),s.snap.getChild(b)));else{if(!s.children)throw(0,K.g5)("WriteRecord should have .snap or .children");if(rf(t,f))b=Cu(t,f),i=EF(i,b,s.children);else if(rf(f,t))if(b=Cu(f,t),br(b))i=EF(i,Kr(),s.children);else{const I=(0,K.DV)(s.children,vr(b));if(I){const O=I.getChild(Wo(b));i=DT(i,Kr(),O)}}}}}return i}function c4(n,e,t,i,r){if(i||r){const s=vv(n.visibleWrites,e);return!r&&IF(s)?t:r||null!=t||TF(s,Kr())?M1(l4(n.allWrites,function(O){return(O.visible||r)&&(!i||!~i.indexOf(O.writeId))&&(rf(O.path,e)||rf(e,O.path))},e),t||lr.EMPTY_NODE):null}{const s=qb(n.visibleWrites,e);if(null!=s)return s;{const f=vv(n.visibleWrites,e);return IF(f)?t:null!=t||TF(f,Kr())?M1(f,t||lr.EMPTY_NODE):null}}}function gD(n,e,t,i){return c4(n.writeTree,n.treePath,e,t,i)}function SF(n,e){return function Zee(n,e,t){let i=lr.EMPTY_NODE;const r=qb(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(ss,(s,f)=>{i=i.updateImmediateChild(s,f)}),i;if(t){const s=vv(n.visibleWrites,e);return t.forEachChild(ss,(f,b)=>{const I=M1(vv(s,new yo(f)),b);i=i.updateImmediateChild(f,I)}),s4(s).forEach(f=>{i=i.updateImmediateChild(f.name,f.node)}),i}return s4(vv(n.visibleWrites,e)).forEach(f=>{i=i.updateImmediateChild(f.name,f.node)}),i}(n.writeTree,n.treePath,e)}function u4(n,e,t,i){return function Yee(n,e,t,i,r){(0,K.hu)(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=Ss(e,t);if(TF(n.visibleWrites,s))return null;{const f=vv(n.visibleWrites,s);return IF(f)?r.getChild(t):M1(f,r.getChild(t))}}(n.writeTree,n.treePath,e,t,i)}function _D(n,e){return function Xee(n,e){return qb(n.visibleWrites,e)}(n.writeTree,Ss(n.treePath,e))}function MF(n,e,t){return function Kee(n,e,t,i){const r=Ss(e,t),s=qb(n.visibleWrites,r);return null!=s?s:i.isCompleteForChild(t)?M1(vv(n.visibleWrites,r),i.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function d4(n,e){return h4(Ss(n.treePath,e),n.writeTree)}function h4(n,e){return{treePath:n,writeTree:e}}class tte{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;(0,K.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,K.hu)(".priority"!==i,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const s=r.type;if("child_added"===t&&"child_removed"===s)this.changeMap.set(i,ET(i,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===s)this.changeMap.delete(i);else if("child_removed"===t&&"child_changed"===s)this.changeMap.set(i,function CT(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}(i,r.oldSnap));else if("child_changed"===t&&"child_added"===s)this.changeMap.set(i,function T1(n,e){return{type:"child_added",snapshotNode:e,childName:n}}(i,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==s)throw(0,K.g5)("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(i,ET(i,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}const f4=new class nte{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}};class DF{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=null!=this.optCompleteServerCache_?new yv(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return MF(this.writes_,e,i)}}getChildAfterChild(e,t,i){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Hb(this.viewCache_),s=function ete(n,e,t,i,r,s){return function Qee(n,e,t,i,r,s,f){let b;const I=vv(n.visibleWrites,e),O=qb(I,Kr());if(null!=O)b=O;else{if(null==t)return[];b=M1(I,t)}if(b=b.withIndex(f),b.isEmpty()||b.isLeafNode())return[];{const V=[],X=f.getCompare(),ae=s?b.getReverseIteratorFrom(i,f):b.getIteratorFrom(i,f);let me=ae.getNext();for(;me&&V.length<r;)0!==X(me,i)&&V.push(me),me=ae.getNext();return V}}(n.writeTree,n.treePath,e,t,i,r,s)}(this.writes_,r,t,1,i,e);return 0===s.length?null:s[0]}}function p4(n,e,t,i,r,s){const f=e.eventCache;if(null!=_D(i,t))return e;{let b,I;if(br(t))if((0,K.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const O=Hb(e),X=SF(i,O instanceof lr?O:lr.EMPTY_NODE);b=n.filter.updateFullNode(e.eventCache.getNode(),X,s)}else{const O=gD(i,Hb(e));b=n.filter.updateFullNode(e.eventCache.getNode(),O,s)}else{const O=vr(t);if(".priority"===O){(0,K.hu)(1===_v(t),"Can't have a priority with additional path components");const V=f.getNode();I=e.serverCache.getNode();const X=u4(i,t,V,I);b=null!=X?n.filter.updatePriority(V,X):f.getNode()}else{const V=Wo(t);let X;if(f.isCompleteForChild(O)){I=e.serverCache.getNode();const ae=u4(i,t,f.getNode(),I);X=null!=ae?f.getNode().getImmediateChild(O).updateChild(V,ae):f.getNode().getImmediateChild(O)}else X=MF(i,O,e.serverCache);b=null!=X?n.filter.updateChild(f.getNode(),O,X,V,r,s):f.getNode()}}return MT(e,b,f.isFullyInitialized()||br(t),n.filter.filtersNodes())}}function yD(n,e,t,i,r,s,f,b){const I=e.serverCache;let O;const V=f?n.filter:n.filter.getIndexedFilter();if(br(t))O=V.updateFullNode(I.getNode(),i,null);else if(V.filtersNodes()&&!I.isFiltered()){const me=I.getNode().updateChild(t,i);O=V.updateFullNode(I.getNode(),me,null)}else{const me=vr(t);if(!I.isCompleteForPath(t)&&_v(t)>1)return e;const Ie=Wo(t),Je=I.getNode().getImmediateChild(me).updateChild(Ie,i);O=".priority"===me?V.updatePriority(I.getNode(),Je):V.updateChild(I.getNode(),me,Je,Ie,f4,null)}const X=r4(e,O,I.isFullyInitialized()||br(t),V.filtersNodes());return p4(n,X,t,r,new DF(r,X,s),b)}function AF(n,e,t,i,r,s,f){const b=e.eventCache;let I,O;const V=new DF(r,e,s);if(br(t))O=n.filter.updateFullNode(e.eventCache.getNode(),i,f),I=MT(e,O,!0,n.filter.filtersNodes());else{const X=vr(t);if(".priority"===X)O=n.filter.updatePriority(e.eventCache.getNode(),i),I=MT(e,O,b.isFullyInitialized(),b.isFiltered());else{const ae=Wo(t),me=b.getNode().getImmediateChild(X);let Ie;if(br(ae))Ie=i;else{const Ge=V.getCompleteChild(X);Ie=null!=Ge?".priority"===sF(ae)&&Ge.getChild(Gj(ae)).isEmpty()?Ge:Ge.updateChild(ae,i):lr.EMPTY_NODE}I=me.equals(Ie)?e:MT(e,n.filter.updateChild(b.getNode(),X,Ie,ae,V,f),b.isFullyInitialized(),n.filter.filtersNodes())}}return I}function m4(n,e){return n.eventCache.isCompleteForChild(e)}function g4(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function PF(n,e,t,i,r,s,f,b){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let O,I=e;O=br(t)?i:new as(null).setTree(t,i);const V=e.serverCache.getNode();return O.children.inorderTraversal((X,ae)=>{if(V.hasChild(X)){const Ie=g4(0,e.serverCache.getNode().getImmediateChild(X),ae);I=yD(n,I,new yo(X),Ie,r,s,f,b)}}),O.children.inorderTraversal((X,ae)=>{const me=!e.serverCache.isCompleteForChild(X)&&null===ae.value;if(!V.hasChild(X)&&!me){const Ge=g4(0,e.serverCache.getNode().getImmediateChild(X),ae);I=yD(n,I,new yo(X),Ge,r,s,f,b)}}),I}function pte(n,e){const t=Hb(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!br(e)&&!t.getImmediateChild(vr(e)).isEmpty())?t.getChild(e):null}function v4(n,e,t,i){e.type===sf.MERGE&&null!==e.source.queryId&&((0,K.hu)(Hb(n.viewCache_),"We should always have a full cache before handling merges"),(0,K.hu)(pD(n.viewCache_),"Missing event cache, even though we have a server cache"));const r=n.viewCache_,s=function ote(n,e,t,i,r){const s=new tte;let f,b;if(t.type===sf.OVERWRITE){const O=t;O.source.fromUser?f=AF(n,e,O.path,O.snap,i,r,s):((0,K.hu)(O.source.fromServer,"Unknown source."),b=O.source.tagged||e.serverCache.isFiltered()&&!br(O.path),f=yD(n,e,O.path,O.snap,i,r,b,s))}else if(t.type===sf.MERGE){const O=t;O.source.fromUser?f=function ate(n,e,t,i,r,s,f){let b=e;return i.foreach((I,O)=>{const V=Ss(t,I);m4(e,vr(V))&&(b=AF(n,b,V,O,r,s,f))}),i.foreach((I,O)=>{const V=Ss(t,I);m4(e,vr(V))||(b=AF(n,b,V,O,r,s,f))}),b}(n,e,O.path,O.children,i,r,s):((0,K.hu)(O.source.fromServer,"Unknown source."),b=O.source.tagged||e.serverCache.isFiltered(),f=PF(n,e,O.path,O.children,i,r,b,s))}else if(t.type===sf.ACK_USER_WRITE){const O=t;f=O.revert?function ute(n,e,t,i,r,s){let f;if(null!=_D(i,t))return e;{const b=new DF(i,e,r),I=e.eventCache.getNode();let O;if(br(t)||".priority"===vr(t)){let V;if(e.serverCache.isFullyInitialized())V=gD(i,Hb(e));else{const X=e.serverCache.getNode();(0,K.hu)(X instanceof lr,"serverChildren would be complete if leaf node"),V=SF(i,X)}O=n.filter.updateFullNode(I,V,s)}else{const V=vr(t);let X=MF(i,V,e.serverCache);null==X&&e.serverCache.isCompleteForChild(V)&&(X=I.getImmediateChild(V)),O=null!=X?n.filter.updateChild(I,V,X,Wo(t),b,s):e.eventCache.getNode().hasChild(V)?n.filter.updateChild(I,V,lr.EMPTY_NODE,Wo(t),b,s):I,O.isEmpty()&&e.serverCache.isFullyInitialized()&&(f=gD(i,Hb(e)),f.isLeafNode()&&(O=n.filter.updateFullNode(O,f,s)))}return f=e.serverCache.isFullyInitialized()||null!=_D(i,Kr()),MT(e,O,f,n.filter.filtersNodes())}}(n,e,O.path,i,r,s):function lte(n,e,t,i,r,s,f){if(null!=_D(r,t))return e;const b=e.serverCache.isFiltered(),I=e.serverCache;if(null!=i.value){if(br(t)&&I.isFullyInitialized()||I.isCompleteForPath(t))return yD(n,e,t,I.getNode().getChild(t),r,s,b,f);if(br(t)){let O=new as(null);return I.getNode().forEachChild(Lm,(V,X)=>{O=O.set(new yo(V),X)}),PF(n,e,t,O,r,s,b,f)}return e}{let O=new as(null);return i.foreach((V,X)=>{const ae=Ss(t,V);I.isCompleteForPath(ae)&&(O=O.set(V,I.getNode().getChild(ae)))}),PF(n,e,t,O,r,s,b,f)}}(n,e,O.path,O.affectedTree,i,r,s)}else{if(t.type!==sf.LISTEN_COMPLETE)throw(0,K.g5)("Unknown operation type: "+t.type);f=function cte(n,e,t,i,r){const s=e.serverCache;return p4(n,r4(e,s.getNode(),s.isFullyInitialized()||br(t),s.isFiltered()),t,i,f4,r)}(n,e,t.path,i,s)}const I=s.getChanges();return function ste(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=pD(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&t.push(function e4(n){return{type:"value",snapshotNode:n}}(pD(e)))}}(e,f,I),{viewCache:f,changes:I}}(n.processor_,r,e,t,i);return function rte(n,e){(0,K.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,K.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,s.viewCache),(0,K.hu)(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,function b4(n,e,t,i){return function Nee(n,e,t,i){const r=[],s=[];return e.forEach(f=>{"child_changed"===f.type&&n.index_.indexedValueChanged(f.oldSnap,f.snapshotNode)&&s.push(function Cee(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(f.childName,f.snapshotNode))}),ST(n,r,"child_removed",e,i,t),ST(n,r,"child_added",e,i,t),ST(n,r,"child_moved",s,i,t),ST(n,r,"child_changed",e,i,t),ST(n,r,"value",e,i,t),r}(n.eventGenerator_,e,t,i?[i]:n.eventRegistrations_)}(n,s.changes,s.viewCache.eventCache.getNode(),null)}let vD,xD;function OF(n,e,t,i){const r=e.source.queryId;if(null!==r){const s=n.views.get(r);return(0,K.hu)(null!=s,"SyncTree gave us an op for an invalid query."),v4(s,e,t,i)}{let s=[];for(const f of n.views.values())s=s.concat(v4(f,e,t,i));return s}}function bv(n,e){let t=null;for(const i of n.views.values())t=t||pte(i,e);return t}class I4{constructor(e){this.listenProvider_=e,this.syncPointTree_=new as(null),this.pendingWriteTree_=function Jee(){return{visibleWrites:vp.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function kF(n,e,t,i,r){return function Uee(n,e,t,i,r){(0,K.hu)(i>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=DT(n.visibleWrites,e,t)),n.lastWriteId=i}(n.pendingWriteTree_,e,t,i,r),r?D1(n,new Gb({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function wv(n,e,t=!1){const i=function $ee(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}(n.pendingWriteTree_,e);if(function Gee(n,e){const t=n.allWrites.findIndex(b=>b.writeId===e);(0,K.hu)(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,s=!1,f=n.allWrites.length-1;for(;r&&f>=0;){const b=n.allWrites[f];b.visible&&(f>=t&&Hee(b,i.path)?r=!1:rf(i.path,b.path)&&(s=!0)),f--}return!!r&&(s?(function qee(n){n.visibleWrites=l4(n.allWrites,Wee,Kr()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(i.snap?n.visibleWrites=o4(n.visibleWrites,i.path):bl(i.children,I=>{n.visibleWrites=o4(n.visibleWrites,Ss(i.path,I))}),!0))}(n.pendingWriteTree_,e)){let s=new as(null);return null!=i.snap?s=s.set(Kr(),!0):bl(i.children,f=>{s=s.set(new yo(f),!0)}),D1(n,new hD(i.path,s,t))}return[]}function AT(n,e,t){return D1(n,new Gb({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function CD(n,e,t){const r=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(f,b)=>{const O=bv(b,Cu(f,e));if(O)return O});return c4(r,e,s,t,!0)}function D1(n,e){return M4(e,n.syncPointTree_,null,mD(n.pendingWriteTree_,Kr()))}function M4(n,e,t,i){if(br(n.path))return D4(n,e,t,i);{const r=e.get(Kr());null==t&&null!=r&&(t=bv(r,Kr()));let s=[];const f=vr(n.path),b=n.operationForChild(f),I=e.children.get(f);if(I&&b){const O=t?t.getImmediateChild(f):null,V=d4(i,f);s=s.concat(M4(b,I,O,V))}return r&&(s=s.concat(OF(r,n,i,t))),s}}function D4(n,e,t,i){const r=e.get(Kr());null==t&&null!=r&&(t=bv(r,Kr()));let s=[];return e.children.inorderTraversal((f,b)=>{const I=t?t.getImmediateChild(f):null,O=d4(i,f),V=n.operationForChild(f);V&&(s=s.concat(D4(V,b,I,O)))}),r&&(s=s.concat(OF(r,n,i,t))),s}function FF(n,e){return n.tagToQueryMap.get(e)}function LF(n){const e=n.indexOf("$");return(0,K.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new yo(n.substr(0,e))}}function NF(n,e,t){const i=n.syncPointTree_.get(e);return(0,K.hu)(i,"Missing sync point for query tag that we're tracking"),OF(i,t,mD(n.pendingWriteTree_,e),null)}class zF{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new zF(t)}node(){return this.node_}}class BF{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Ss(this.path_,e);return new BF(this.syncTree_,t)}node(){return CD(this.syncTree_,this.path_)}}const Fte=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},P4=function(n,e,t){return n&&"object"==typeof n?((0,K.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?Lte(n[".sv"],e,t):"object"==typeof n[".sv"]?Nte(n[".sv"],e):void(0,K.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},Lte=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,K.hu)(!1,"Unexpected server value: "+n)},Nte=function(n,e,t){n.hasOwnProperty("increment")||(0,K.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;"number"!=typeof i&&(0,K.hu)(!1,"Unexpected increment value: "+i);const r=e.node();if((0,K.hu)(null!==r&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const f=r.getValue();return"number"!=typeof f?i:f+i},O4=function(n,e,t,i){return UF(e,new BF(t,n),i)},VF=function(n,e,t){return UF(n,new zF(e),t)};function UF(n,e,t){const i=n.getPriority().val(),r=P4(i,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const f=n,b=P4(f.getValue(),e,t);return b!==f.getValue()||r!==f.getPriority().val()?new C1(b,zs(r)):n}{const f=n;return s=f,r!==f.getPriority().val()&&(s=s.updatePriority(new C1(r))),f.forEachChild(ss,(b,I)=>{const O=UF(I,e.getImmediateChild(b),t);O!==I&&(s=s.updateImmediateChild(b,O))}),s}}class jF{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function TD(n,e){let t=e instanceof yo?e:new yo(e),i=n,r=vr(t);for(;null!==r;){const s=(0,K.DV)(i.node.children,r)||{children:{},childCount:0};i=new jF(r,i,s),t=Wo(t),r=vr(t)}return i}function Wb(n){return n.node.value}function $F(n,e){n.node.value=e,GF(n)}function k4(n){return n.node.childCount>0}function ID(n,e){bl(n.node.children,(t,i)=>{e(new jF(t,n,i))})}function R4(n,e,t,i){t&&!i&&e(n),ID(n,r=>{R4(r,e,!0,i)}),t&&i&&e(n)}function kT(n){return new yo(null===n.parent?n.name:kT(n.parent)+"/"+n.name)}function GF(n){null!==n.parent&&function Vte(n,e,t){const i=function zte(n){return void 0===Wb(n)&&!k4(n)}(t),r=(0,K.r3)(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,GF(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,GF(n))}(n.parent,n.name,n)}const Ute=/[\[\].#$\/\u0000-\u001F\u007F]/,jte=/[\[\].#$\u0000-\u001F\u007F]/,HF=10485760,SD=function(n){return"string"==typeof n&&0!==n.length&&!Ute.test(n)},FT=function(n,e,t){const i=t instanceof yo?new oee(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+jb(i));if("function"==typeof e)throw new Error(n+"contains a function "+jb(i)+" with contents = "+e.toString());if(tD(e))throw new Error(n+"contains "+e.toString()+" "+jb(i));if("string"==typeof e&&e.length>HF/3&&(0,K.ug)(e)>HF)throw new Error(n+"contains a string greater than "+HF+" utf8 bytes "+jb(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let r=!1,s=!1;if(bl(e,(f,b)=>{if(".value"===f)r=!0;else if(".priority"!==f&&".sv"!==f&&(s=!0,!SD(f)))throw new Error(n+" contains an invalid key ("+f+") "+jb(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function see(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,K.ug)(e),Hj(n)})(i,f),FT(n,b,i),function aee(n){const e=n.parts_.pop();n.byteLength_-=(0,K.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(i)}),r&&s)throw new Error(n+' contains ".value" child '+jb(i)+" in addition to actual children.")}},N4=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!SD(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),function(n){return"string"==typeof n&&0!==n.length&&!jte.test(n)}(n)}(t))throw new Error((0,K.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class qte{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function eh(n,e,t){(function MD(n,e){let t=null;for(let i=0;i<e.length;i++){const r=e[i],s=r.getPath();null!==t&&!aF(s,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:s}),t.events.push(r)}t&&n.eventLists_.push(t)})(n,t),function B4(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const r=n.eventLists_[i];r&&(e(r.path)?(Wte(n.eventLists_[i]),n.eventLists_[i]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}(n,i=>rf(i,e)||rf(e,i))}function Wte(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const i=t.getEventRunner();Vb&&vl("event: "+t.toString()),x1(i)}}}const V4="repo_interrupt",Zte=25;class Yte{constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new qte,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=dD(),this.transactionQueueTree_=new jF,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function U4(n){const t=n.infoData_.getNode(new yo(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function NT(n){return Fte({timestamp:U4(n)})}function j4(n,e,t,i,r){n.dataUpdateCount++;const s=new yo(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let f=[];if(r)if(i){const I=(0,K.UI)(t,O=>zs(O));f=function Dte(n,e,t,i){const r=FF(n,i);if(r){const s=LF(r),f=s.path,b=s.queryId,I=Cu(f,e),O=as.fromObject(t);return NF(n,f,new S1(wF(b),I,O))}return[]}(n.serverSyncTree_,s,I,r)}else{const I=zs(t);f=function S4(n,e,t,i){const r=FF(n,i);if(null!=r){const s=LF(r),f=s.path,b=s.queryId,I=Cu(f,e);return NF(n,f,new Gb(wF(b),I,t))}return[]}(n.serverSyncTree_,s,I,r)}else if(i){const I=(0,K.UI)(t,O=>zs(O));f=function Ite(n,e,t){const i=as.fromObject(t);return D1(n,new S1({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,s,I)}else{const I=zs(t);f=AT(n.serverSyncTree_,s,I)}let b=s;f.length>0&&(b=P1(n,s)),eh(n.eventQueue_,b,f)}function $4(n,e){ZF(n,"connected",e),!1===e&&function ene(n){A1(n,"onDisconnectEvents");const e=NT(n),t=dD();vF(n.onDisconnect_,Kr(),(r,s)=>{const f=O4(r,s,n.serverSyncTree_,e);I1(t,r,f)});let i=[];vF(t,Kr(),(r,s)=>{i=i.concat(AT(n.serverSyncTree_,r,s));const f=function QF(n,e){const t=kT(q4(n,e)),i=TD(n.transactionQueueTree_,e);return function Bte(n,e,t){let i=t?n:n.parent;for(;null!==i;){if(e(i))return!0;i=i.parent}}(i,r=>{JF(n,r)}),JF(n,i),R4(i,r=>{JF(n,r)}),t}(n,r);P1(n,f)}),n.onDisconnect_=dD(),eh(n.eventQueue_,Kr(),i)}(n)}function ZF(n,e,t){const i=new yo("/.info/"+e),r=zs(t);n.infoData_.updateSnapshot(i,r);const s=AT(n.infoSyncTree_,i,r);eh(n.eventQueue_,i,s)}function DD(n){return n.nextWriteId_++}function A1(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),vl(t,...e)}function XF(n,e,t){return CD(n.serverSyncTree_,e,t)||lr.EMPTY_NODE}function AD(n,e=n.transactionQueueTree_){if(e||PD(n,e),Wb(e)){const t=W4(n,e);(0,K.hu)(t.length>0,"Sending zero length transaction queue"),t.every(r=>0===r.status)&&function ane(n,e,t){const i=t.map(O=>O.currentWriteId),r=XF(n,e,i);let s=r;const f=r.hash();for(let O=0;O<t.length;O++){const V=t[O];(0,K.hu)(0===V.status,"tryToSendTransactionQueue_: items in queue should all be run."),V.status=1,V.retryCount++;const X=Cu(e,V.path);s=s.updateChild(X,V.currentOutputSnapshotRaw)}const b=s.val(!0),I=e;n.server_.put(I.toString(),b,O=>{A1(n,"transaction put response",{path:I.toString(),status:O});let V=[];if("ok"===O){const X=[];for(let ae=0;ae<t.length;ae++)t[ae].status=2,V=V.concat(wv(n.serverSyncTree_,t[ae].currentWriteId)),t[ae].onComplete&&X.push(()=>t[ae].onComplete(null,!0,t[ae].currentOutputSnapshotResolved)),t[ae].unwatcher();PD(n,TD(n.transactionQueueTree_,e)),AD(n,n.transactionQueueTree_),eh(n.eventQueue_,e,V);for(let ae=0;ae<X.length;ae++)x1(X[ae])}else{if("datastale"===O)for(let X=0;X<t.length;X++)t[X].status=3===t[X].status?4:0;else{kc("transaction at "+I.toString()+" failed: "+O);for(let X=0;X<t.length;X++)t[X].status=4,t[X].abortReason=O}P1(n,e)}},f)}(n,kT(e),t)}else k4(e)&&ID(e,t=>{AD(n,t)})}function P1(n,e){const t=q4(n,e),i=kT(t);return function lne(n,e,t){if(0===e.length)return;const i=[];let r=[];const f=e.filter(b=>0===b.status).map(b=>b.currentWriteId);for(let b=0;b<e.length;b++){const I=e[b],O=Cu(t,I.path);let X,V=!1;if((0,K.hu)(null!==O,"rerunTransactionsUnderNode_: relativePath should not be null."),4===I.status)V=!0,X=I.abortReason,r=r.concat(wv(n.serverSyncTree_,I.currentWriteId,!0));else if(0===I.status)if(I.retryCount>=Zte)V=!0,X="maxretry",r=r.concat(wv(n.serverSyncTree_,I.currentWriteId,!0));else{const ae=XF(n,I.path,f);I.currentInputSnapshot=ae;const me=e[b].update(ae.val());if(void 0!==me){FT("transaction failed: Data returned ",me,I.path);let Ie=zs(me);"object"==typeof me&&null!=me&&(0,K.r3)(me,".priority")||(Ie=Ie.updatePriority(ae.getPriority()));const Je=I.currentWriteId,Qt=NT(n),xn=VF(Ie,ae,Qt);I.currentOutputSnapshotRaw=Ie,I.currentOutputSnapshotResolved=xn,I.currentWriteId=DD(n),f.splice(f.indexOf(Je),1),r=r.concat(kF(n.serverSyncTree_,I.path,xn,I.currentWriteId,I.applyLocally)),r=r.concat(wv(n.serverSyncTree_,Je,!0))}else V=!0,X="nodata",r=r.concat(wv(n.serverSyncTree_,I.currentWriteId,!0))}eh(n.eventQueue_,t,r),r=[],V&&(e[b].status=2,setTimeout(e[b].unwatcher,Math.floor(0)),e[b].onComplete&&i.push("nodata"===X?()=>e[b].onComplete(null,!1,e[b].currentInputSnapshot):()=>e[b].onComplete(new Error(X),!1,null)))}PD(n,n.transactionQueueTree_);for(let b=0;b<i.length;b++)x1(i[b]);AD(n,n.transactionQueueTree_)}(n,W4(n,t),i),i}function q4(n,e){let t,i=n.transactionQueueTree_;for(t=vr(e);null!==t&&void 0===Wb(i);)i=TD(i,t),t=vr(e=Wo(e));return i}function W4(n,e){const t=[];return Z4(n,e,t),t.sort((i,r)=>i.order-r.order),t}function Z4(n,e,t){const i=Wb(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);ID(e,r=>{Z4(n,r,t)})}function PD(n,e){const t=Wb(e);if(t){let i=0;for(let r=0;r<t.length;r++)2!==t[r].status&&(t[i]=t[r],i++);t.length=i,$F(e,t.length>0?t:void 0)}ID(e,i=>{PD(n,i)})}function JF(n,e){const t=Wb(e);if(t){const i=[];let r=[],s=-1;for(let f=0;f<t.length;f++)3===t[f].status||(1===t[f].status?((0,K.hu)(s===f-1,"All SENT items should be at beginning of queue."),s=f,t[f].status=3,t[f].abortReason="set"):((0,K.hu)(0===t[f].status,"Unexpected transaction status in abort"),t[f].unwatcher(),r=r.concat(wv(n.serverSyncTree_,t[f].currentWriteId,!0)),t[f].onComplete&&i.push(t[f].onComplete.bind(null,new Error("set"),!1,null))));-1===s?$F(e,void 0):t.length=s+1,eh(n.eventQueue_,kT(e),r);for(let f=0;f<i.length;f++)x1(i[f])}}const eL=function(n,e){const t=dne(n),i=t.namespace;return"firebase.com"===t.domain&&Fm(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||"undefined"===i)&&"localhost"!==t.domain&&Fm("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&kc("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new eF(t.host,t.secure,i,"ws"===t.scheme||"wss"===t.scheme,e,"",i!==t.subdomain),path:new yo(t.pathString)}},dne=function(n){let e="",t="",i="",r="",s="",f=!0,b="https",I=443;if("string"==typeof n){let O=n.indexOf("//");O>=0&&(b=n.substring(0,O-1),n=n.substring(O+2));let V=n.indexOf("/");-1===V&&(V=n.length);let X=n.indexOf("?");-1===X&&(X=n.length),e=n.substring(0,Math.min(V,X)),V<X&&(r=function cne(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}(n.substring(V,X)));const ae=function une(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const i=t.split("=");2===i.length?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):kc(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,X)));O=e.indexOf(":"),O>=0?(f="https"===b||"wss"===b,I=parseInt(e.substring(O+1),10)):O=e.length;const me=e.slice(0,O);if("localhost"===me.toLowerCase())t="localhost";else if(me.split(".").length<=2)t=me;else{const Ie=e.indexOf(".");i=e.substring(0,Ie).toLowerCase(),t=e.substring(Ie+1),s=i}"ns"in ae&&(s=ae.ns)}return{host:e,port:I,domain:t,subdomain:i,secure:f,scheme:b,pathString:r,namespace:s}};class th{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return br(this._path)?null:sF(this._path)}get ref(){return new bp(this._repo,this._path)}get _queryIdentifier(){const e=n4(this._queryParams),t=Q2(e);return"{}"===t?"default":t}get _queryObject(){return n4(this._queryParams)}isEqual(e){if(!((e=(0,K.m9)(e))instanceof th))return!1;const t=this._repo===e._repo,i=aF(this._path,e._path);return t&&i&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function iee(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}class bp extends th{constructor(e,t){super(e,t,new mF,!1)}get parent(){const e=Gj(this._path);return null===e?null:new bp(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}(function _te(n){(0,K.hu)(!vD,"__referenceConstructor has already been defined"),vD=n})(bp),function wte(n){(0,K.hu)(!xD,"__referenceConstructor has already been defined"),xD=n}(bp);const Tne="FIREBASE_DATABASE_EMULATOR_HOST",nL={};let t5=!1;class Pne{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Kte(n,e,t){if(n.stats_=iF(n.repoInfo_),n.forceRestClient_||AJ())n.server_=new uD(n.repoInfo_,(i,r,s,f)=>{j4(n,i,r,s,f)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>$4(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,K.Wl)(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new $b(n.repoInfo_,e,(i,r,s,f)=>{j4(n,i,r,s,f)},i=>{$4(n,i)},i=>{!function Xte(n,e){bl(e,(t,i)=>{ZF(n,t,i)})}(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=function FJ(n,e){const t=n.toString();return nF[t]||(nF[t]=e()),nF[t]}(n.repoInfo_,()=>new Fee(n.stats_,n.server_)),n.infoData_=new Aee,n.infoSyncTree_=new I4({startListening:(i,r,s,f)=>{let b=[];const I=n.infoData_.getNode(i._path);return I.isEmpty()||(b=AT(n.infoSyncTree_,i._path,I),setTimeout(()=>{f("ok")},0)),b},stopListening:()=>{}}),ZF(n,"connected",!1),n.serverSyncTree_=new I4({startListening:(i,r,s,f)=>(n.server_.listen(i,s,r,(b,I)=>{const O=f(b,I);eh(n.eventQueue_,i._path,O)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new bp(this._repo,Kr())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function Mne(n,e){const t=nL[e];(!t||t[n.key]!==n)&&Fm(`Database ${e}(${n.repoInfo_}) has already been deleted.`),function H4(n){n.persistentConnection_&&n.persistentConnection_.interrupt(V4)}(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Fm("Cannot call "+e+" on a deleted database.")}}function One(n=(0,Z.getApp)(),e){const t=(0,Z._getProvider)(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=(0,K.P0)("database");i&&function kne(n,e,t,i={}){(n=(0,K.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Fm("Cannot call useEmulator() after instance has already been initialized.");const r=n._repoInternal;let s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Fm('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new yT(yT.OWNER);else if(i.mockUserToken){const f="string"==typeof i.mockUserToken?i.mockUserToken:(0,K.Sg)(i.mockUserToken,n.app.options.projectId);s=new yT(f)}!function Ine(n,e,t,i){n.repoInfo_=new eF(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}(r,e,t,s)}(t,...i)}return t}$b.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},$b.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function Rne(n){(function yJ(n){Y2=n})(Z.SDK_VERSION),(0,Z._registerComponent)(new te.wA("database",(e,{instanceIdentifier:t})=>function Sne(n,e,t,i,r){let s=i||n.options.databaseURL;void 0===s&&(n.options.projectId||Fm("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),vl("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let I,O,f=eL(s,r),b=f.repoInfo;typeof process<"u"&&process.env&&(O=process.env[Tne]),O?(I=!0,s=`http://${O}?ns=${b.namespace}`,f=eL(s,r),b=f.repoInfo):I=!f.repoInfo.secure;const V=r&&I?new yT(yT.OWNER):new OJ(n.name,n.options,e);N4("Invalid Firebase Database URL",f),br(f.path)||Fm("Database URL must point to the root of a Firebase Database (not including a child path).");const X=function Dne(n,e,t,i){let r=nL[e.name];r||(r={},nL[e.name]=r);let s=r[n.toURLString()];return s&&Fm("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Yte(n,t5,t,i),r[n.toURLString()]=s,s}(b,n,V,new PJ(n.name,t));return new Pne(X,n)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,Z.registerVersion)(sj,"0.14.4",n),(0,Z.registerVersion)(sj,"0.14.4","esm2017")}();class iL{constructor(e){return e}}const i5="database",rL=new d.OlP("angularfire2.database-instances");function Bne(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new iL(i)}}const Vne={provide:class Nne{constructor(){return jE(i5)}},deps:[[new d.FiY,rL]]},Une={provide:iL,useFactory:function zne(n,e){const t=UE(i5,n,e);return t&&new iL(t)},deps:[[new d.FiY,rL],uv]};let jne=(()=>{class n{constructor(){(0,Z.registerVersion)("angularfire",cv.full,"rtdb")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:[Une,Vne]}),n})();function $ne(n,...e){return{ngModule:jne,providers:[{provide:rL,useFactory:Bne(n),multi:!0,deps:[d.R0b,d.zs3,Db,$E,[new d.FiY,jR],[new d.FiY,a1],...e]}]}}const Gne=f_(One,!0);function r5(n){return new d.vHH(3e3,!1)}function Tie(){return typeof window<"u"&&typeof window.document<"u"}function oL(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Tv(n){switch(n.length){case 0:return new iT;case 1:return n[0];default:return new RV(n)}}function o5(n,e,t,i,r=new Map,s=new Map){const f=[],b=[];let I=-1,O=null;if(i.forEach(V=>{const X=V.get("offset"),ae=X==I,me=ae&&O||new Map;V.forEach((Ie,Ge)=>{let Je=Ge,Qt=Ie;if("offset"!==Ge)switch(Je=e.normalizePropertyName(Je,f),Qt){case p2:Qt=r.get(Ge);break;case __:Qt=s.get(Ge);break;default:Qt=e.normalizeStyleValue(Ge,Je,Qt,f)}me.set(Je,Qt)}),ae||b.push(me),O=me,I=X}),f.length)throw function fie(n){return new d.vHH(3502,!1)}();return b}function sL(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&aL(t,"start",n)));break;case"done":n.onDone(()=>i(t&&aL(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&aL(t,"destroy",n)))}}function aL(n,e,t){const s=lL(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),f=n._data;return null!=f&&(s._data=f),s}function lL(n,e,t,i,r="",s=0,f){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!f}}function nh(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function s5(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}let cL=(n,e)=>!1,a5=(n,e,t)=>[],l5=null;function uL(n){const e=n.parentNode||n.host;return e===l5?null:e}(oL()||typeof Element<"u")&&(Tie()?(l5=(()=>document.documentElement)(),cL=(n,e)=>{for(;e;){if(e===n)return!0;e=uL(e)}return!1}):cL=(n,e)=>n.contains(e),a5=(n,e,t)=>{if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]});let Yb=null,c5=!1;const u5=cL,d5=a5;let h5=(()=>{class n{validateStyleProperty(t){return function Sie(n){Yb||(Yb=function Mie(){return typeof document<"u"?document.body:null}()||{},c5=!!Yb.style&&"WebkitAppearance"in Yb.style);let e=!0;return Yb.style&&!function Iie(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Yb.style,!e&&c5&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Yb.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return u5(t,i)}getParentElement(t){return uL(t)}query(t,i,r){return d5(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,f,b=[],I){return new iT(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})(),dL=(()=>{class n{}return n.NOOP=new h5,n})();const Die=1e3,hL="ng-enter",FD="ng-leave",LD="ng-trigger",ND=".ng-trigger",p5="ng-animating",fL=".ng-animating";function w_(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:pL(parseFloat(e[1]),e[2])}function pL(n,e){return"s"===e?n*Die:n}function zD(n,e,t){return n.hasOwnProperty("duration")?n:function Pie(n,e,t){let r,s=0,f="";if("string"==typeof n){const b=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===b)return e.push(r5()),{duration:0,delay:0,easing:""};r=pL(parseFloat(b[1]),b[2]);const I=b[3];null!=I&&(s=pL(parseFloat(I),b[4]));const O=b[5];O&&(f=O)}else r=n;if(!t){let b=!1,I=e.length;r<0&&(e.push(function Hne(){return new d.vHH(3100,!1)}()),b=!0),s<0&&(e.push(function qne(){return new d.vHH(3101,!1)}()),b=!0),b&&e.splice(I,0,r5())}return{duration:r,delay:s,easing:f}}(n,e,t)}function VT(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function m5(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function Iv(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function _5(n,e,t){return t?e+":"+t+";":""}function y5(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=_5(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=_5(0,Fie(t),n.style[t]));n.setAttribute("style",e)}function Bm(n,e,t){n.style&&(e.forEach((i,r)=>{const s=gL(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i}),oL()&&y5(n))}function Kb(n,e){n.style&&(e.forEach((t,i)=>{const r=gL(i);n.style[r]=""}),oL()&&y5(n))}function UT(n){return Array.isArray(n)?1==n.length?n[0]:AV(n):n}const mL=new RegExp("{{\\s*(.+?)\\s*}}","g");function v5(n){let e=[];if("string"==typeof n){let t;for(;t=mL.exec(n);)e.push(t[1]);mL.lastIndex=0}return e}function jT(n,e,t){const i=n.toString(),r=i.replace(mL,(s,f)=>{let b=e[f];return null==b&&(t.push(function Zne(n){return new d.vHH(3003,!1)}()),b=""),b.toString()});return r==i?n:r}function BD(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const Rie=/-+([a-z0-9])/g;function gL(n){return n.replace(Rie,(...e)=>e[1].toUpperCase())}function Fie(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ih(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function Yne(n){return new d.vHH(3004,!1)}()}}const jD="*";function Uie(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function jie(n,e,t){if(":"==n[0]){const I=function $ie(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function cie(n){return new d.vHH(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof I)return void e.push(I);n=I}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function lie(n){return new d.vHH(3015,!1)}()),e;const r=i[1],s=i[2],f=i[3];e.push(x5(r,f));"<"==s[0]&&!(r==jD&&f==jD)&&e.push(x5(f,r))}(i,t,e)):t.push(n),t}const $D=new Set(["true","1"]),GD=new Set(["false","0"]);function x5(n,e){const t=$D.has(n)||GD.has(n),i=$D.has(e)||GD.has(e);return(r,s)=>{let f=n==jD||n==r,b=e==jD||e==s;return!f&&t&&"boolean"==typeof r&&(f=r?$D.has(n):GD.has(n)),!b&&i&&"boolean"==typeof s&&(b=s?$D.has(e):GD.has(e)),f&&b}}const Gie=new RegExp("s*:selfs*,?","g");function _L(n,e,t,i){return new Hie(n).build(e,t,i)}class Hie{constructor(e){this._driver=e}build(e,t,i){const r=new Zie(t);return this._resetContextStyleTimingState(r),ih(this,UT(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],f=[];return"@"==e.name.charAt(0)&&t.errors.push(function Xne(){return new d.vHH(3006,!1)}()),e.definitions.forEach(b=>{if(this._resetContextStyleTimingState(t),0==b.type){const I=b,O=I.name;O.toString().split(/\s*,\s*/).forEach(V=>{I.name=V,s.push(this.visitState(I,t))}),I.name=O}else if(1==b.type){const I=this.visitTransition(b,t);i+=I.queryCount,r+=I.depCount,f.push(I)}else t.errors.push(function Qne(){return new d.vHH(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:f,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,f=r||{};i.styles.forEach(b=>{b instanceof Map&&b.forEach(I=>{v5(I).forEach(O=>{f.hasOwnProperty(O)||s.add(O)})})}),s.size&&(BD(s.values()),t.errors.push(function Jne(n,e){return new d.vHH(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=ih(this,UT(e.animation),t);return{type:1,matchers:Uie(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Xb(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>ih(this,i,t)),options:Xb(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(f=>{t.currentTime=i;const b=ih(this,f,t);return r=Math.max(r,t.currentTime),b});return t.currentTime=r,{type:3,steps:s,options:Xb(e.options)}}visitAnimate(e,t){const i=function Kie(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return yL(zD(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=yL(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=zD(t,e);return yL(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:Mo({});if(5==s.type)r=this.visitKeyframes(s,t);else{let f=e.styles,b=!1;if(!f){b=!0;const O={};i.easing&&(O.easing=i.easing),f=Mo(O)}t.currentTime+=i.duration+i.delay;const I=this.visitStyle(f,t);I.isEmptyStep=b,r=I}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let b of r)"string"==typeof b?b===__?i.push(b):t.errors.push(new d.vHH(3002,!1)):i.push(m5(b));let s=!1,f=null;return i.forEach(b=>{if(b instanceof Map&&(b.has("easing")&&(f=b.get("easing"),b.delete("easing")),!s))for(let I of b.values())if(I.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:f,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(f=>{"string"!=typeof f&&f.forEach((b,I)=>{const O=t.collectedStyles.get(t.currentQuerySelector),V=O.get(I);let X=!0;V&&(s!=r&&s>=V.startTime&&r<=V.endTime&&(t.errors.push(function tie(n,e,t,i,r){return new d.vHH(3010,!1)}()),X=!1),s=V.startTime),X&&O.set(I,{startTime:s,endTime:r}),t.options&&function kie(n,e,t){const i=e.params||{},r=v5(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function Wne(n){return new d.vHH(3001,!1)}())})}(b,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function nie(){return new d.vHH(3011,!1)}()),i;let s=0;const f=[];let b=!1,I=!1,O=0;const V=e.steps.map(Qt=>{const xn=this._makeStyleAst(Qt,t);let Nn=null!=xn.offset?xn.offset:function Yie(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(xn.styles),ai=0;return null!=Nn&&(s++,ai=xn.offset=Nn),I=I||ai<0||ai>1,b=b||ai<O,O=ai,f.push(ai),xn});I&&t.errors.push(function iie(){return new d.vHH(3012,!1)}()),b&&t.errors.push(function rie(){return new d.vHH(3200,!1)}());const X=e.steps.length;let ae=0;s>0&&s<X?t.errors.push(function oie(){return new d.vHH(3202,!1)}()):0==s&&(ae=1/(X-1));const me=X-1,Ie=t.currentTime,Ge=t.currentAnimateTimings,Je=Ge.duration;return V.forEach((Qt,xn)=>{const Nn=ae>0?xn==me?1:ae*xn:f[xn],ai=Nn*Je;t.currentTime=Ie+Ge.delay+ai,Ge.duration=ai,this._validateStyleAst(Qt,t),Qt.offset=Nn,i.styles.push(Qt)}),i}visitReference(e,t){return{type:8,animation:ih(this,UT(e.animation),t),options:Xb(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Xb(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Xb(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,f]=function qie(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(Gie,"")),n=n.replace(/@\*/g,ND).replace(/@\w+/g,t=>ND+"-"+t.slice(1)).replace(/:animating/g,fL),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,nh(t.collectedStyles,t.currentQuerySelector,new Map);const b=ih(this,UT(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:f,animation:b,originalSelector:e.selector,options:Xb(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function sie(){return new d.vHH(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:zD(e.timings,t.errors,!0);return{type:12,animation:ih(this,UT(e.animation),t),timings:i,options:null}}}class Zie{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Xb(n){return n?(n=VT(n)).params&&(n.params=function Wie(n){return n?VT(n):null}(n.params)):n={},n}function yL(n,e,t){return{duration:n,delay:e,easing:t}}function vL(n,e,t,i,r,s,f=null,b=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:f,subTimeline:b}}class HD{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const Jie=new RegExp(":enter","g"),tre=new RegExp(":leave","g");function bL(n,e,t,i,r,s=new Map,f=new Map,b,I,O=[]){return(new nre).buildKeyframes(n,e,t,i,r,s,f,b,I,O)}class nre{buildKeyframes(e,t,i,r,s,f,b,I,O,V=[]){O=O||new HD;const X=new xL(e,t,O,r,s,V,[]);X.options=I;const ae=I.delay?w_(I.delay):0;X.currentTimeline.delayNextStep(ae),X.currentTimeline.setStyles([f],null,X.errors,I),ih(this,i,X);const me=X.timelines.filter(Ie=>Ie.containsAnimation());if(me.length&&b.size){let Ie;for(let Ge=me.length-1;Ge>=0;Ge--){const Je=me[Ge];if(Je.element===t){Ie=Je;break}}Ie&&!Ie.allowOnlyTimelineStyles()&&Ie.setStyles([b],null,X.errors,I)}return me.length?me.map(Ie=>Ie.buildKeyframes()):[vL(t,[],[],[],0,ae,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,f=this._visitSubInstructions(i,r,r.options);s!=f&&t.transformIntoNewTimeline(f)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const f="number"==typeof s?s:w_(jT(s,r?.params??{},t.errors));i.delayNextStep(f)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const f=null!=i.duration?w_(i.duration):null,b=null!=i.delay?w_(i.delay):null;return 0!==f&&e.forEach(I=>{const O=t.appendInstructionToTimeline(I,f,b);s=Math.max(s,O.duration+O.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),ih(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=qD);const f=w_(s.delay);r.delayNextStep(f)}e.steps.length&&(e.steps.forEach(f=>ih(this,f,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?w_(e.options.delay):0;e.steps.forEach(f=>{const b=t.createSubContext(e.options);s&&b.delayNextStep(s),ih(this,f,b),r=Math.max(r,b.currentTimeline.currentTime),i.push(b.currentTimeline)}),i.forEach(f=>t.currentTimeline.mergeTimelineCollectedStyles(f)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return zD(t.params?jT(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,b=t.createSubContext().currentTimeline;b.easing=i.easing,e.styles.forEach(I=>{b.forwardTime((I.offset||0)*s),b.setStyles(I.styles,I.easing,t.errors,t.options),b.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(b),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?w_(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=qD);let f=i;const b=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=b.length;let I=null;b.forEach((O,V)=>{t.currentQueryIndex=V;const X=t.createSubContext(e.options,O);s&&X.delayNextStep(s),O===t.element&&(I=X.currentTimeline),ih(this,e.animation,X),X.currentTimeline.applyStylesToKeyframe(),f=Math.max(f,X.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(f),I&&(t.currentTimeline.mergeTimelineCollectedStyles(I),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,f=Math.abs(s.duration),b=f*(t.currentQueryTotal-1);let I=f*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":I=b-I;break;case"full":I=i.currentStaggerTime}const V=t.currentTimeline;I&&V.delayNextStep(I);const X=V.currentTime;ih(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-X+(r.startTime-i.currentTimeline.startTime)}}const qD={};class xL{constructor(e,t,i,r,s,f,b,I){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=f,this.timelines=b,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=qD,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=I||new WD(this._driver,t,0),b.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=w_(i.duration)),null!=i.delay&&(r.delay=w_(i.delay));const s=i.params;if(s){let f=r.params;f||(f=this.options.params={}),Object.keys(s).forEach(b=>{(!t||!f.hasOwnProperty(b))&&(f[b]=jT(s[b],f,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new xL(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=qD,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new ire(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,f){let b=[];if(r&&b.push(this.element),e.length>0){e=(e=e.replace(Jie,"."+this._enterClassName)).replace(tre,"."+this._leaveClassName);let O=this._driver.query(this.element,e,1!=i);0!==i&&(O=i<0?O.slice(O.length+i,O.length):O.slice(0,i)),b.push(...O)}return!s&&0==b.length&&f.push(function aie(n){return new d.vHH(3014,!1)}()),b}}class WD{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new WD(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||__),this._currentKeyframe.set(t,__);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},f=function rre(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,__)}else Iv(r,t)}),t}(e,this._globalTimelineStyles);for(let[b,I]of f){const O=jT(I,s,i);this._pendingStyles.set(b,O),this._localTimelineStyles.has(b)||this._backFill.set(b,this._globalTimelineStyles.get(b)??__),this._updateStyle(b,O)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((b,I)=>{const O=Iv(b,new Map,this._backFill);O.forEach((V,X)=>{V===p2?e.add(X):V===__&&t.add(X)}),i||O.set("offset",I/this.duration),r.push(O)});const s=e.size?BD(e.values()):[],f=t.size?BD(t.values()):[];if(i){const b=r[0],I=new Map(b);b.set("offset",0),I.set("offset",1),r=[b,I]}return vL(this.element,r,s,f,this.duration,this.startTime,this.easing,!1)}}class ire extends WD{constructor(e,t,i,r,s,f,b=!1){super(e,t,f.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=b,this.timings={duration:f.duration,delay:f.delay,easing:f.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],f=i+t,b=t/f,I=Iv(e[0]);I.set("offset",0),s.push(I);const O=Iv(e[0]);O.set("offset",E5(b)),s.push(O);const V=e.length-1;for(let X=1;X<=V;X++){let ae=Iv(e[X]);const me=ae.get("offset");ae.set("offset",E5((t+me*i)/f)),s.push(ae)}i=f,t=0,r="",e=s}return vL(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function E5(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class wL{}const ore=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class sre extends wL{normalizePropertyName(e,t){return gL(e)}normalizeStyleValue(e,t,i,r){let s="";const f=i.toString().trim();if(ore.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const b=i.match(/^[+-]?[\d\.]+([a-z]*)$/);b&&0==b[1].length&&r.push(function Kne(n,e){return new d.vHH(3005,!1)}())}return f+s}}function T5(n,e,t,i,r,s,f,b,I,O,V,X,ae){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:f,timelines:b,queriedElements:I,preStyleProps:O,postStyleProps:V,totalTime:X,errors:ae}}const CL={};class I5{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function are(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,f,b,I,O,V){const X=[],ae=this.ast.options&&this.ast.options.params||CL,Ie=this.buildStyles(i,b&&b.params||CL,X),Ge=I&&I.params||CL,Je=this.buildStyles(r,Ge,X),Qt=new Set,xn=new Map,Nn=new Map,ai="void"===r,Hi={params:lre(Ge,ae),delay:this.ast.options?.delay},Xi=V?[]:bL(e,t,this.ast.animation,s,f,Ie,Je,Hi,O,X);let ro=0;if(Xi.forEach(C_=>{ro=Math.max(C_.duration+C_.delay,ro)}),X.length)return T5(t,this._triggerName,i,r,ai,Ie,Je,[],[],xn,Nn,ro,X);Xi.forEach(C_=>{const E_=C_.element,U5=nh(xn,E_,new Set);C_.preStyleProps.forEach(Qb=>U5.add(Qb));const GT=nh(Nn,E_,new Set);C_.postStyleProps.forEach(Qb=>GT.add(Qb)),E_!==t&&Qt.add(E_)});const xl=BD(Qt.values());return T5(t,this._triggerName,i,r,ai,Ie,Je,Xi,xl,xn,Nn,ro)}}function lre(n,e){const t=VT(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class cre{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=VT(this.defaultParams);return Object.keys(e).forEach(s=>{const f=e[s];null!==f&&(r[s]=f)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((f,b)=>{f&&(f=jT(f,r,t));const I=this.normalizer.normalizePropertyName(b,t);f=this.normalizer.normalizeStyleValue(b,I,f,t),i.set(b,f)})}),i}}class dre{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new cre(r.style,r.options&&r.options.params||{},i))}),S5(this.states,"true","1"),S5(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new I5(e,r,this.states))}),this.fallbackTransition=function hre(n,e,t){return new I5(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(f,b)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(f=>f.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function S5(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const fre=new HD;class pre{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],r=[],s=_L(this._driver,t,i,r);if(i.length)throw function pie(n){return new d.vHH(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=o5(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let f;const b=new Map;if(s?(f=bL(this._driver,t,s,hL,FD,new Map,new Map,i,fre,r),f.forEach(V=>{const X=nh(b,V.element,new Map);V.postStyleProps.forEach(ae=>X.set(ae,null))})):(r.push(function mie(){return new d.vHH(3300,!1)}()),f=[]),r.length)throw function gie(n){return new d.vHH(3504,!1)}();b.forEach((V,X)=>{V.forEach((ae,me)=>{V.set(me,this._driver.computeStyle(X,me,__))})});const O=Tv(f.map(V=>{const X=b.get(V.element);return this._buildPlayer(V,new Map,X)}));return this._playersById.set(e,O),O.onDestroy(()=>this.destroy(e)),this.players.push(O),O}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function _ie(n){return new d.vHH(3301,!1)}();return t}listen(e,t,i,r){const s=lL(t,"","","");return sL(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const M5="ng-animate-queued",EL="ng-animate-disabled",vre=[],D5={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},bre={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},af="__ng_removed";class TL{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function Ere(n){return n??null}(i?e.value:e),i){const s=VT(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const $T="void",IL=new TL($T);class xre{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,lf(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function yie(n,e){return new d.vHH(3302,!1)}();if(null==i||0==i.length)throw function vie(n){return new d.vHH(3303,!1)}();if(!function Tre(n){return"start"==n||"done"==n}(i))throw function bie(n,e){return new d.vHH(3400,!1)}();const s=nh(this._elementListeners,e,[]),f={name:t,phase:i,callback:r};s.push(f);const b=nh(this._engine.statesByElement,e,new Map);return b.has(t)||(lf(e,LD),lf(e,LD+"-"+t),b.set(t,IL)),()=>{this._engine.afterFlush(()=>{const I=s.indexOf(f);I>=0&&s.splice(I,1),this._triggers.has(t)||b.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function xie(n){return new d.vHH(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),f=new SL(this.id,t,e);let b=this._engine.statesByElement.get(e);b||(lf(e,LD),lf(e,LD+"-"+t),this._engine.statesByElement.set(e,b=new Map));let I=b.get(t);const O=new TL(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&I&&O.absorbOptions(I.options),b.set(t,O),I||(I=IL),O.value!==$T&&I.value===O.value){if(!function Mre(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(I.params,O.params)){const Ge=[],Je=s.matchStyles(I.value,I.params,Ge),Qt=s.matchStyles(O.value,O.params,Ge);Ge.length?this._engine.reportError(Ge):this._engine.afterFlush(()=>{Kb(e,Je),Bm(e,Qt)})}return}const ae=nh(this._engine.playersByElement,e,[]);ae.forEach(Ge=>{Ge.namespaceId==this.id&&Ge.triggerName==t&&Ge.queued&&Ge.destroy()});let me=s.matchTransition(I.value,O.value,e,O.params),Ie=!1;if(!me){if(!r)return;me=s.fallbackTransition,Ie=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:me,fromState:I,toState:O,player:f,isFallbackTransition:Ie}),Ie||(lf(e,M5),f.onStart(()=>{k1(e,M5)})),f.onDone(()=>{let Ge=this.players.indexOf(f);Ge>=0&&this.players.splice(Ge,1);const Je=this._engine.playersByElement.get(e);if(Je){let Qt=Je.indexOf(f);Qt>=0&&Je.splice(Qt,1)}}),this.players.push(f),ae.push(f),f}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,ND,!0);i.forEach(r=>{if(r[af])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(f=>f.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),f=new Map;if(s){const b=[];if(s.forEach((I,O)=>{if(f.set(O,I.value),this._triggers.has(O)){const V=this.trigger(e,O,$T,r);V&&b.push(V)}}),b.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,f),i&&Tv(b).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const f=s.name;if(r.has(f))return;r.add(f);const I=this._triggers.get(f).fallbackTransition,O=i.get(f)||IL,V=new TL($T),X=new SL(this.id,f,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:f,transition:I,fromState:O,toState:V,player:X,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let f=e;for(;f=f.parentNode;)if(i.statesByElement.get(f)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[af];(!s||s===D5)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){lf(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,f=this._elementListeners.get(s);f&&f.forEach(b=>{if(b.name==i.triggerName){const I=lL(s,i.triggerName,i.fromState.value,i.toState.value);I._data=e,sL(i.player,b.phase,I,b.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,f=r.transition.ast.depCount;return 0==s||0==f?s-f:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(i=>i.element===e)||t,t}}class wre{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new xre(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let f=!1,b=this.driver.getParentElement(t);for(;b;){const I=r.get(b);if(I){const O=i.indexOf(I);i.splice(O+1,0,e),f=!0;break}b=this.driver.getParentElement(b)}f||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(ZD(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!ZD(t))return;const s=t[af];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const f=this.collectedLeaveElements.indexOf(t);f>=0&&this.collectedLeaveElements.splice(f,1)}if(e){const f=this._fetchNamespace(e);f&&f.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),lf(e,EL)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),k1(e,EL))}removeNode(e,t,i,r){if(ZD(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),i){const f=this.namespacesByHostElement.get(t);f&&f.id!==e&&f.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[af]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return ZD(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,ND,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,fL,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Tv(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[af];if(t&&t.setForRemoval){if(e[af]=D5,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(EL)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)lf(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?Tv(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function wie(n){return new d.vHH(3402,!1)}()}_flushAnimations(e,t){const i=new HD,r=[],s=new Map,f=[],b=new Map,I=new Map,O=new Map,V=new Set;this.disabledNodes.forEach(li=>{V.add(li);const Si=this.driver.query(li,".ng-animate-queued",!0);for(let Ni=0;Ni<Si.length;Ni++)V.add(Si[Ni])});const X=this.bodyNode,ae=Array.from(this.statesByElement.keys()),me=O5(ae,this.collectedEnterElements),Ie=new Map;let Ge=0;me.forEach((li,Si)=>{const Ni=hL+Ge++;Ie.set(Si,Ni),li.forEach(Gr=>lf(Gr,Ni))});const Je=[],Qt=new Set,xn=new Set;for(let li=0;li<this.collectedLeaveElements.length;li++){const Si=this.collectedLeaveElements[li],Ni=Si[af];Ni&&Ni.setForRemoval&&(Je.push(Si),Qt.add(Si),Ni.hasAnimation?this.driver.query(Si,".ng-star-inserted",!0).forEach(Gr=>Qt.add(Gr)):xn.add(Si))}const Nn=new Map,ai=O5(ae,Array.from(Qt));ai.forEach((li,Si)=>{const Ni=FD+Ge++;Nn.set(Si,Ni),li.forEach(Gr=>lf(Gr,Ni))}),e.push(()=>{me.forEach((li,Si)=>{const Ni=Ie.get(Si);li.forEach(Gr=>k1(Gr,Ni))}),ai.forEach((li,Si)=>{const Ni=Nn.get(Si);li.forEach(Gr=>k1(Gr,Ni))}),Je.forEach(li=>{this.processLeaveNode(li)})});const Hi=[],Xi=[];for(let li=this._namespaceList.length-1;li>=0;li--)this._namespaceList[li].drainQueuedTransitions(t).forEach(Ni=>{const Gr=Ni.player,wl=Ni.element;if(Hi.push(Gr),this.collectedEnterElements.length){const Rc=wl[af];if(Rc&&Rc.setForMove){if(Rc.previousTriggersValues&&Rc.previousTriggersValues.has(Ni.triggerName)){const Jb=Rc.previousTriggersValues.get(Ni.triggerName),cf=this.statesByElement.get(Ni.element);if(cf&&cf.has(Ni.triggerName)){const XD=cf.get(Ni.triggerName);XD.value=Jb,cf.set(Ni.triggerName,XD)}}return void Gr.destroy()}}const Vm=!X||!this.driver.containsElement(X,wl),rh=Nn.get(wl),Sv=Ie.get(wl),Bs=this._buildInstruction(Ni,i,Sv,rh,Vm);if(Bs.errors&&Bs.errors.length)return void Xi.push(Bs);if(Vm)return Gr.onStart(()=>Kb(wl,Bs.fromStyles)),Gr.onDestroy(()=>Bm(wl,Bs.toStyles)),void r.push(Gr);if(Ni.isFallbackTransition)return Gr.onStart(()=>Kb(wl,Bs.fromStyles)),Gr.onDestroy(()=>Bm(wl,Bs.toStyles)),void r.push(Gr);const G5=[];Bs.timelines.forEach(Rc=>{Rc.stretchStartingKeyframe=!0,this.disabledNodes.has(Rc.element)||G5.push(Rc)}),Bs.timelines=G5,i.append(wl,Bs.timelines),f.push({instruction:Bs,player:Gr,element:wl}),Bs.queriedElements.forEach(Rc=>nh(b,Rc,[]).push(Gr)),Bs.preStyleProps.forEach((Rc,Jb)=>{if(Rc.size){let cf=I.get(Jb);cf||I.set(Jb,cf=new Set),Rc.forEach((XD,DL)=>cf.add(DL))}}),Bs.postStyleProps.forEach((Rc,Jb)=>{let cf=O.get(Jb);cf||O.set(Jb,cf=new Set),Rc.forEach((XD,DL)=>cf.add(DL))})});if(Xi.length){const li=[];Xi.forEach(Si=>{li.push(function Cie(n,e){return new d.vHH(3505,!1)}())}),Hi.forEach(Si=>Si.destroy()),this.reportError(li)}const ro=new Map,xl=new Map;f.forEach(li=>{const Si=li.element;i.has(Si)&&(xl.set(Si,Si),this._beforeAnimationBuild(li.player.namespaceId,li.instruction,ro))}),r.forEach(li=>{const Si=li.element;this._getPreviousPlayers(Si,!1,li.namespaceId,li.triggerName,null).forEach(Gr=>{nh(ro,Si,[]).push(Gr),Gr.destroy()})});const C_=Je.filter(li=>R5(li,I,O)),E_=new Map;P5(E_,this.driver,xn,O,__).forEach(li=>{R5(li,I,O)&&C_.push(li)});const GT=new Map;me.forEach((li,Si)=>{P5(GT,this.driver,new Set(li),I,p2)}),C_.forEach(li=>{const Si=E_.get(li),Ni=GT.get(li);E_.set(li,new Map([...Array.from(Si?.entries()??[]),...Array.from(Ni?.entries()??[])]))});const Qb=[],j5=[],$5={};f.forEach(li=>{const{element:Si,player:Ni,instruction:Gr}=li;if(i.has(Si)){if(V.has(Si))return Ni.onDestroy(()=>Bm(Si,Gr.toStyles)),Ni.disabled=!0,Ni.overrideTotalTime(Gr.totalTime),void r.push(Ni);let wl=$5;if(xl.size>1){let rh=Si;const Sv=[];for(;rh=rh.parentNode;){const Bs=xl.get(rh);if(Bs){wl=Bs;break}Sv.push(rh)}Sv.forEach(Bs=>xl.set(Bs,wl))}const Vm=this._buildAnimation(Ni.namespaceId,Gr,ro,s,GT,E_);if(Ni.setRealPlayer(Vm),wl===$5)Qb.push(Ni);else{const rh=this.playersByElement.get(wl);rh&&rh.length&&(Ni.parentPlayer=Tv(rh)),r.push(Ni)}}else Kb(Si,Gr.fromStyles),Ni.onDestroy(()=>Bm(Si,Gr.toStyles)),j5.push(Ni),V.has(Si)&&r.push(Ni)}),j5.forEach(li=>{const Si=s.get(li.element);if(Si&&Si.length){const Ni=Tv(Si);li.setRealPlayer(Ni)}}),r.forEach(li=>{li.parentPlayer?li.syncPlayerEvents(li.parentPlayer):li.destroy()});for(let li=0;li<Je.length;li++){const Si=Je[li],Ni=Si[af];if(k1(Si,FD),Ni&&Ni.hasAnimation)continue;let Gr=[];if(b.size){let Vm=b.get(Si);Vm&&Vm.length&&Gr.push(...Vm);let rh=this.driver.query(Si,fL,!0);for(let Sv=0;Sv<rh.length;Sv++){let Bs=b.get(rh[Sv]);Bs&&Bs.length&&Gr.push(...Bs)}}const wl=Gr.filter(Vm=>!Vm.destroyed);wl.length?Ire(this,Si,wl):this.processLeaveNode(Si)}return Je.length=0,Qb.forEach(li=>{this.players.push(li),li.onDone(()=>{li.destroy();const Si=this.players.indexOf(li);this.players.splice(Si,1)}),li.play()}),Qb}elementContainsData(e,t){let i=!1;const r=t[af];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let f=[];if(t){const b=this.playersByQueriedElement.get(e);b&&(f=b)}else{const b=this.playersByElement.get(e);if(b){const I=!s||s==$T;b.forEach(O=>{O.queued||!I&&O.triggerName!=r||f.push(O)})}}return(i||r)&&(f=f.filter(b=>!(i&&i!=b.namespaceId||r&&r!=b.triggerName))),f}_beforeAnimationBuild(e,t,i){const s=t.element,f=t.isRemovalTransition?void 0:e,b=t.isRemovalTransition?void 0:t.triggerName;for(const I of t.timelines){const O=I.element,V=O!==s,X=nh(i,O,[]);this._getPreviousPlayers(O,V,f,b,t.toState).forEach(me=>{const Ie=me.getRealPlayer();Ie.beforeDestroy&&Ie.beforeDestroy(),me.destroy(),X.push(me)})}Kb(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,f){const b=t.triggerName,I=t.element,O=[],V=new Set,X=new Set,ae=t.timelines.map(Ie=>{const Ge=Ie.element;V.add(Ge);const Je=Ge[af];if(Je&&Je.removedBeforeQueried)return new iT(Ie.duration,Ie.delay);const Qt=Ge!==I,xn=function Sre(n){const e=[];return k5(n,e),e}((i.get(Ge)||vre).map(ro=>ro.getRealPlayer())).filter(ro=>!!ro.element&&ro.element===Ge),Nn=s.get(Ge),ai=f.get(Ge),Hi=o5(0,this._normalizer,0,Ie.keyframes,Nn,ai),Xi=this._buildPlayer(Ie,Hi,xn);if(Ie.subTimeline&&r&&X.add(Ge),Qt){const ro=new SL(e,b,Ge);ro.setRealPlayer(Xi),O.push(ro)}return Xi});O.forEach(Ie=>{nh(this.playersByQueriedElement,Ie.element,[]).push(Ie),Ie.onDone(()=>function Cre(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,Ie.element,Ie))}),V.forEach(Ie=>lf(Ie,p5));const me=Tv(ae);return me.onDestroy(()=>{V.forEach(Ie=>k1(Ie,p5)),Bm(I,t.toStyles)}),X.forEach(Ie=>{nh(r,Ie,[]).push(me)}),me}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new iT(e.duration,e.delay)}}class SL{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new iT,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>sL(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){nh(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function ZD(n){return n&&1===n.nodeType}function A5(n,e){const t=n.style.display;return n.style.display=e??"none",t}function P5(n,e,t,i,r){const s=[];t.forEach(I=>s.push(A5(I)));const f=[];i.forEach((I,O)=>{const V=new Map;I.forEach(X=>{const ae=e.computeStyle(O,X,r);V.set(X,ae),(!ae||0==ae.length)&&(O[af]=bre,f.push(O))}),n.set(O,V)});let b=0;return t.forEach(I=>A5(I,s[b++])),f}function O5(n,e){const t=new Map;if(n.forEach(b=>t.set(b,[])),0==e.length)return t;const i=1,r=new Set(e),s=new Map;function f(b){if(!b)return i;let I=s.get(b);if(I)return I;const O=b.parentNode;return I=t.has(O)?O:r.has(O)?i:f(O),s.set(b,I),I}return e.forEach(b=>{const I=f(b);I!==i&&t.get(I).push(b)}),t}function lf(n,e){n.classList?.add(e)}function k1(n,e){n.classList?.remove(e)}function Ire(n,e,t){Tv(t).onDone(()=>n.processLeaveNode(e))}function k5(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof RV?k5(i.players,e):e.push(i)}}function R5(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class YD{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new wre(e,t,i),this._timelineEngine=new pre(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const f=e+"-"+r;let b=this._triggerCache[f];if(!b){const I=[],O=[],V=_L(this._driver,s,I,O);if(I.length)throw function hie(n,e){return new d.vHH(3404,!1)}();b=function ure(n,e,t){return new dre(n,e,t)}(r,V,this._normalizer),this._triggerCache[f]=b}this._transitionEngine.registerTrigger(t,r,b)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i,r){this._transitionEngine.removeNode(e,t,r||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,f]=s5(i);this._timelineEngine.command(s,t,f,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[f,b]=s5(i);return this._timelineEngine.listen(f,t,b,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let kre=(()=>{class n extends DV{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:d.ifc.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?AV(t):t;return L5(this._renderer,null,i,"register",[r]),new Rre(i,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(d.FYo),d.LFG(ft))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();class Rre extends EY{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Fre(this._id,e,t||{},this._renderer)}}class Fre{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return L5(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function L5(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const N5="@.disabled";let Lre=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,f)=>{const b=f?.parentNode(s);b&&f.removeChild(b,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let V=this._rendererCache.get(s);return V||(V=new z5("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,V)),V}const f=i.id,b=i.id+"-"+this._currentId;this._currentId++,this.engine.register(b,t);const I=V=>{Array.isArray(V)?V.forEach(I):this.engine.registerTrigger(f,b,t,V.name,V)};return i.data.animation.forEach(I),new Nre(this,b,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[f,b]=s;f(b)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(d.FYo),d.LFG(YD),d.LFG(d.R0b))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();class z5{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==N5?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Nre extends z5{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==N5?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function zre(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),f="";return"@"!=s.charAt(0)&&([s,f]=function Bre(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,f,b=>{this.factory.scheduleListenerCallback(b._data||-1,i,b)})}return this.delegate.listen(e,t,i)}}let Vre=(()=>{class n extends YD{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(ft),d.LFG(dL),d.LFG(wL),d.LFG(d.z2F))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac}),n})();const B5=[{provide:DV,useClass:kre},{provide:wL,useFactory:function Ure(){return new sre}},{provide:YD,useClass:Vre},{provide:d.FYo,useFactory:function jre(n,e,t){return new Lre(n,e,t)},deps:[mh,YD,d.R0b]}],V5=[{provide:dL,useClass:h5},{provide:d.QbO,useValue:"NoopAnimations"},...B5];let Gre=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({providers:V5,imports:[Rs]}),n})(),Hre=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[vs,LV,bQ,pX,RY,VX,TQ,xU]}),n})(),qre=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n,bootstrap:[HQ]}),n.\u0275inj=d.cJS({providers:[oj,H2,{provide:_p.Dh,useValue:ej.firebase},{provide:Dn,useClass:Ft}],imports:[Rs,GQ,F,U,Hre,H8(()=>q8(ej.firebase)),_J(()=>YQ()),$W(()=>HW()),$ne(()=>Gne()),QW(()=>eZ()),Gre]}),n})();wf().bootstrapModule(qre).catch(n=>console.error(n))},9898:function(ui){ui.exports=function(){"use strict";var Kt,Ae,d;function Ne(_,$e){if(Kt)if(Ae){var ft="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Kt+")(sharedChunk); ("+Ae+")(sharedChunk); self.onerror = null;",on={};Kt(on),d=$e(on),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([ft],{type:"text/javascript"})))}else Ae=$e;else Kt=$e}return Ne(0,function(_){var $e=typeof self<"u"?self:{},ft="2.13.0";let on;const yt={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==on){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{on=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):a}catch{on=a}}return on},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},It={supported:!1,testSupport:function(a){!Ke&&je&&(pn?tn(a):Ve=a)}};let Ve,je,Ke=!1,pn=!1;function tn(a){const o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,je),a.isContextLost())return;It.supported=!0}catch{}a.deleteTexture(o),Ke=!0}$e.document&&(je=$e.document.createElement("img"),je.onload=function(){Ve&&tn(Ve),Ve=null,pn=!0},je.onerror=function(){Ke=!0,Ve=null},je.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const bn="01";var Dn=vt;function vt(a,o,l,p){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(p-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=o,this.p2x=l,this.p2y=p}vt.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,o){if(void 0===o&&(o=1e-6),a<0)return 0;if(a>1)return 1;for(var l=a,p=0;p<8;p++){var y=this.sampleCurveX(l)-a;if(Math.abs(y)<o)return l;var w=this.sampleCurveDerivativeX(l);if(Math.abs(w)<1e-6)break;l-=y/w}var E=0,M=1;for(l=a,p=0;p<20&&(y=this.sampleCurveX(l),!(Math.abs(y-a)<o));p++)a>y?E=l:M=l,l=.5*(M-E)+E;return l},solve:function(a,o){return this.sampleCurveY(this.solveCurveX(a,o))}};var Ye=Ft;function Ft(a,o){this.x=a,this.y=o}Ft.prototype={clone:function(){return new Ft(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,o){return this.clone()._rotateAround(a,o)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var o=a.x-this.x,l=a.y-this.y;return o*o+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,o){return Math.atan2(this.x*o-this.y*a,this.x*a+this.y*o)},_matMult:function(a){var o=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=o,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var o=Math.cos(a),l=Math.sin(a),p=l*this.x+o*this.y;return this.x=o*this.x-l*this.y,this.y=p,this},_rotateAround:function(a,o){var l=Math.cos(a),p=Math.sin(a),y=o.y+p*(this.x-o.x)+l*(this.y-o.y);return this.x=o.x+l*(this.x-o.x)-p*(this.y-o.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ft.convert=function(a){return a instanceof Ft?a:Array.isArray(a)?new Ft(a[0],a[1]):a};const Jt=Math.PI/180,Xt=180/Math.PI;function Ct(a){return a*Jt}function Pt(a){return a*Xt}const un=[[0,0],[1,0],[1,1],[0,1]];function tt(a){if(a<=0)return 0;if(a>=1)return 1;const o=a*a,l=o*a;return 4*(a<.5?l:3*(a-o)+l-.75)}function pt(a,o,l,p){const y=new Dn(a,o,l,p);return function(w){return y.solve(w)}}const zt=pt(.25,.1,.25,1);function Bt(a,o,l){return Math.min(l,Math.max(o,a))}function an(a,o,l){return(l=Bt((l-a)/(o-a),0,1))*l*(3-2*l)}function oi(a,o,l){const p=l-o,y=((a-o)%p+p)%p+o;return y===o?l:y}function On(a,o,l){if(!a.length)return l(null,[]);let p=a.length;const y=new Array(a.length);let w=null;a.forEach((E,M)=>{o(E,(k,F)=>{k&&(w=k),y[M]=F,0==--p&&l(w,y)})})}function mt(a){const o=[];for(const l in a)o.push(a[l]);return o}function gt(a,...o){for(const l of o)for(const p in l)a[p]=l[p];return a}let Dt=1;function Ht(){return Dt++}function nn(){return function a(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function en(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function wn(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function Cn(a,o){a.forEach(l=>{o[l]&&(o[l]=o[l].bind(o))})}function rr(a,o){return-1!==a.indexOf(o,a.length-o.length)}function qn(a,o,l){const p={};for(const y in a)p[y]=o.call(l||this,a[y],y,a);return p}function zn(a,o,l){const p={};for(const y in a)o.call(l||this,a[y],y,a)&&(p[y]=a[y]);return p}function vn(a){return Array.isArray(a)?a.map(vn):"object"==typeof a&&a?qn(a,vn):a}const Qi={};function Pi(a){Qi[a]||(typeof console<"u"&&console.warn(a),Qi[a]=!0)}function dr(a,o,l){return(l.y-a.y)*(o.x-a.x)>(o.y-a.y)*(l.x-a.x)}function Vn(a){let o=0;for(let l,p,y=0,w=a.length,E=w-1;y<w;E=y++)l=a[y],p=a[E],o+=(p.x-l.x)*(l.y+p.y);return o}function kr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function oo(a){const o={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,p,y,w)=>{const E=y||w;return o[p]=!E||E.toLowerCase(),""}),o["max-age"]){const l=parseInt(o["max-age"],10);isNaN(l)?delete o["max-age"]:o["max-age"]=l}return o}let Ms=null;function so(a){if(null==Ms){const o=a.navigator?a.navigator.userAgent:null;Ms=!!a.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return Ms}function Ds(a){try{const o=$e[a];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}}function _s(a,o){return[a[4*o],a[4*o+1],a[4*o+2],a[4*o+3]]}const Ir="mapbox-tiles";let jr,In,zo=500,ls=50;function vo(){try{return $e.caches}catch{}}function $r(){vo()&&!jr&&(jr=$e.caches.open(Ir))}function cs(a){const o=a.indexOf("?");if(o<0)return a;const p=function(y){const w=y.indexOf("?");return w>0?y.slice(w+1).split("&"):[]}(a).filter(y=>{const w=y.split("=");return"language"===w[0]||"worldview"===w[0]});return p.length?`${a.slice(0,o)}?${p.join("&")}`:a.slice(0,o)}let pi=1/0;const jn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(jn);class Kn extends Error{constructor(o,l,p){401===l&&Hr(p)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=l,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Nr=kr()?()=>self.worker&&self.worker.referrer:()=>("blob:"===$e.location.protocol?$e.parent:$e).location.href,Sr=function(a,o){if(!(/^file:/.test(l=a.url)||/^file:/.test(Nr())&&!/^\w+:/.test(l))){if($e.fetch&&$e.Request&&$e.AbortController&&$e.Request.prototype.hasOwnProperty("signal"))return function(p,y){const w=new $e.AbortController,E=new $e.Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:Nr(),signal:w.signal});let M=!1,k=!1;const F=(U=E.url).indexOf("sku=")>0&&Hr(U);var U;"json"===p.type&&E.headers.set("Accept","application/json");const z=(te,ie,K)=>{if(k)return;if(te&&"SecurityError"!==te.message&&Pi(te),ie&&K)return Z(ie);const pe=Date.now();$e.fetch(E).then(Ee=>{if(Ee.ok){const xe=F?Ee.clone():null;return Z(Ee,xe,pe)}return y(new Kn(Ee.statusText,Ee.status,p.url))}).catch(Ee=>{"AbortError"!==Ee.name&&y(new Error(`${Ee.message} ${p.url}`))})},Z=(te,ie,K)=>{("arrayBuffer"===p.type?te.arrayBuffer():"json"===p.type?te.json():te.text()).then(pe=>{k||(ie&&K&&function(Ee,xe,we){if($r(),!jr)return;const Ce={status:xe.status,statusText:xe.statusText,headers:new $e.Headers};xe.headers.forEach((st,rt)=>Ce.headers.set(rt,st));const Le=oo(xe.headers.get("Cache-Control")||"");if(Le["no-store"])return;Le["max-age"]&&Ce.headers.set("Expires",new Date(we+1e3*Le["max-age"]).toUTCString());const ke=Ce.headers.get("Expires");ke&&(new Date(ke).getTime()-we<42e4||function(st,rt){if(void 0===In)try{new Response(new ReadableStream),In=!0}catch{In=!1}In?rt(st.body):st.blob().then(rt)}(xe,st=>{const rt=new $e.Response(st,Ce);$r(),jr&&jr.then(bt=>bt.put(cs(Ee.url),rt)).catch(bt=>Pi(bt.message))}))}(E,ie,K),M=!0,y(null,pe,te.headers.get("Cache-Control"),te.headers.get("Expires")))}).catch(pe=>{k||y(new Error(pe.message))})};return F?function(te,ie){if($r(),!jr)return ie(null);const K=cs(te.url);jr.then(pe=>{pe.match(K).then(Ee=>{const xe=function(we){if(!we)return!1;const Ce=new Date(we.headers.get("Expires")||0),Le=oo(we.headers.get("Cache-Control")||"");return Ce>Date.now()&&!Le["no-cache"]}(Ee);pe.delete(K),xe&&pe.put(K,Ee.clone()),ie(null,Ee,xe)}).catch(ie)}).catch(ie)}(E,z):z(null,null),{cancel:()=>{k=!0,M||w.abort()}}}(a,o);if(kr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,o,void 0,!0)}var l;return function(p,y){const w=new $e.XMLHttpRequest;w.open(p.method||"GET",p.url,!0),"arrayBuffer"===p.type&&(w.responseType="arraybuffer");for(const E in p.headers)w.setRequestHeader(E,p.headers[E]);return"json"===p.type&&(w.responseType="text",w.setRequestHeader("Accept","application/json")),w.withCredentials="include"===p.credentials,w.onerror=()=>{y(new Error(w.statusText))},w.onload=()=>{if((w.status>=200&&w.status<300||0===w.status)&&null!==w.response){let E=w.response;if("json"===p.type)try{E=JSON.parse(w.response)}catch(M){return y(M)}y(null,E,w.getResponseHeader("Cache-Control"),w.getResponseHeader("Expires"))}else y(new Kn(w.statusText,w.status,p.url))},w.send(p.body),{cancel:()=>w.abort()}}(a,o)},Xr=function(a,o){return Sr(gt(a,{type:"arrayBuffer"}),o)};function Do(a){const o=$e.document.createElement("a");return o.href=a,o.protocol===$e.document.location.protocol&&o.host===$e.document.location.host}const ao="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ys,wi;ys=[],wi=0;const Vs=function(a,o){if(It.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),wi>=yt.MAX_PARALLEL_IMAGE_REQUESTS){const w={requestParameters:a,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return ys.push(w),w}wi++;let l=!1;const p=()=>{if(!l)for(l=!0,wi--;ys.length&&wi<yt.MAX_PARALLEL_IMAGE_REQUESTS;){const w=ys.shift(),{requestParameters:E,callback:M,cancelled:k}=w;k||(w.cancel=Vs(E,M).cancel)}},y=Xr(a,(w,E,M,k)=>{p(),w?o(w):E&&($e.createImageBitmap?function(F,U){const z=new $e.Blob([new Uint8Array(F)],{type:"image/png"});$e.createImageBitmap(z).then(Z=>{U(null,Z)}).catch(Z=>{U(new Error(`Could not load image because of ${Z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(E,(F,U)=>o(F,U,M,k)):function(F,U){const z=new $e.Image,Z=$e.URL;z.onload=()=>{U(null,z),Z.revokeObjectURL(z.src),z.onload=null,$e.requestAnimationFrame(()=>{z.src=ao})},z.onerror=()=>U(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const te=new $e.Blob([new Uint8Array(F)],{type:"image/png"});z.src=F.byteLength?Z.createObjectURL(te):ao}(E,(F,U)=>o(F,U,M,k)))});return{cancel:()=>{y.cancel(),p()}}},Ei="NO_ACCESS_TOKEN";function lo(a){return 0===a.indexOf("mapbox:")}function Hr(a){return yt.API_URL_REGEX.test(a)}function cn(a){return yt.API_CDN_URL_REGEX.test(a)}function Vt(a){return yt.API_STYLE_REGEX.test(a)&&!Sn(a)}function Sn(a){return yt.API_SPRITE_REGEX.test(a)}const Zn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ei(a){const o=a.match(Zn);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function ki(a){const o=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${o}`}function Qr(a){if(!a)return null;const o=a.split(".");if(!o||3!==o.length)return null;try{return JSON.parse(decodeURIComponent($e.atob(o[1]).split("").map(l=>"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class ze{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const l=Qr(yt.ACCESS_TOKEN);let p="";return p=l&&l.u?$e.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,(y,w)=>String.fromCharCode(Number("0x"+w)))):yt.ACCESS_TOKEN||"",o?`mapbox.eventData.${o}:${p}`:`mapbox.eventData:${p}`}fetchEventData(){const o=Ds("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid");if(o)try{const y=$e.localStorage.getItem(l);y&&(this.eventData=JSON.parse(y));const w=$e.localStorage.getItem(p);w&&(this.anonId=w)}catch{Pi("Unable to read from LocalStorage")}}saveEventData(){const o=Ds("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid");if(o)try{$e.localStorage.setItem(p,this.anonId),Object.keys(this.eventData).length>=1&&$e.localStorage.setItem(l,JSON.stringify(this.eventData))}catch{Pi("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,l,p,y){if(!yt.EVENTS_URL)return;const w=ei(yt.EVENTS_URL);w.params.push(`access_token=${y||yt.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(o).toISOString()},M=l?gt(E,l):E,k={url:ki(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([M])};var U;this.pendingRequest=(U=F=>{this.pendingRequest=null,p(F),this.saveEventData(),this.processRequests(y)},Sr(gt(k,{method:"POST"}),U))}queueRequest(o,l){this.queue.push(o),this.processRequests(l)}}const ne=new class extends ze{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,o){yt.EVENTS_URL&&yt.ACCESS_TOKEN&&Array.isArray(a)&&a.some(l=>lo(l)||Hr(l))&&this.queueRequest(Date.now(),o)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=Qr(yt.ACCESS_TOKEN),l=o?o.u:yt.ACCESS_TOKEN;let p=l!==this.eventData.tokenU;wn(this.anonId)||(this.anonId=nn(),p=!0);const y=this.queue.shift();if(this.eventData.lastSuccess){const w=new Date(this.eventData.lastSuccess),E=new Date(y),M=(y-this.eventData.lastSuccess)/864e5;p=p||M>=1||M<-1||w.getDate()!==E.getDate()}else p=!0;p?this.postEvent(y,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ft,skuId:bn,"enabled.telemetry":!1,userId:this.anonId},w=>{w||(this.eventData.lastSuccess=y,this.eventData.tokenU=l)},a):this.processRequests()}},$=ne.postTurnstileEvent.bind(ne),H=new class extends ze{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,o,l,p){this.skuToken=o,this.errorCb=p,yt.EVENTS_URL&&(l||yt.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},l):this.errorCb(new Error(Ei)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:o,timestamp:l}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),wn(this.anonId)||(this.anonId=nn()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ft,skuId:bn,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):o&&(this.success[o]=!0)},a))}},Y=H.postMapLoadEvent.bind(H),se=new class extends ze{constructor(){super("gljs.performance")}postPerformanceEvent(a,o){yt.EVENTS_URL&&(a||yt.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},a)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:o,performanceData:l}=this.queue.shift(),p=function(y){const w=$e.performance.getEntriesByType("resource"),E=$e.performance.getEntriesByType("mark"),M=function(Z){const te={};if(Z)for(const ie in Z)if("other"!==ie)for(const K of Z[ie]){const pe=`${ie}ResolveRangeMin`,Ee=`${ie}ResolveRangeMax`,xe=`${ie}RequestCount`,we=`${ie}RequestCachedCount`;te[pe]=Math.min(te[pe]||1/0,K.startTime),te[Ee]=Math.max(te[Ee]||-1/0,K.responseEnd);const Ce=Le=>{void 0===te[Le]&&(te[Le]=0),++te[Le]};void 0!==K.transferSize&&0===K.transferSize&&Ce(we),Ce(xe)}return te}(function(Z,te){const ie={};if(Z)for(const K of Z){const pe=te(K);void 0===ie[pe]&&(ie[pe]=[]),ie[pe].push(K)}return ie}(w,jt)),k=$e.devicePixelRatio,F=$e.navigator.connection||$e.navigator.mozConnection||$e.navigator.webkitConnection,U={counters:[],metadata:[],attributes:[]},z=(Z,te,ie)=>{null!=ie&&Z.push({name:te,value:ie.toString()})};for(const Z in M)z(U.counters,Z,M[Z]);if(y.interactionRange[0]!==1/0&&y.interactionRange[1]!==-1/0&&(z(U.counters,"interactionRangeMin",y.interactionRange[0]),z(U.counters,"interactionRangeMax",y.interactionRange[1])),E)for(const Z of Object.keys(He)){const te=He[Z],ie=E.find(K=>K.name===te);ie&&z(U.counters,te,ie.startTime)}return z(U.counters,"visibilityHidden",y.visibilityHidden),z(U.attributes,"style",function(Z){if(Z)for(const te of Z){const ie=te.name.split("?")[0];if(Vt(ie)){const K=ie.split("/").slice(-2);if(2===K.length)return`mapbox://styles/${K[0]}/${K[1]}`}}}(w)),z(U.attributes,"terrainEnabled",y.terrainEnabled?"true":"false"),z(U.attributes,"fogEnabled",y.fogEnabled?"true":"false"),z(U.attributes,"projection",y.projection),z(U.attributes,"zoom",y.zoom),z(U.metadata,"devicePixelRatio",k),z(U.metadata,"connectionEffectiveType",F?F.effectiveType:void 0),z(U.metadata,"navigatorUserAgent",$e.navigator.userAgent),z(U.metadata,"screenWidth",$e.screen.width),z(U.metadata,"screenHeight",$e.screen.height),z(U.metadata,"windowWidth",$e.innerWidth),z(U.metadata,"windowHeight",$e.innerHeight),z(U.metadata,"mapWidth",y.width/k),z(U.metadata,"mapHeight",y.height/k),z(U.metadata,"webglRenderer",y.renderer),z(U.metadata,"webglVendor",y.vendor),z(U.metadata,"sdkVersion",ft),z(U.metadata,"sdkIdentifier","mapbox-gl-js"),U}(l);for(const y of p.metadata);for(const y of p.counters);for(const y of p.attributes);this.postEvent(o,p,()=>{},a)}},fe=se.postPerformanceEvent.bind(se),Oe=new class extends ze{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,o,l,p){if(!yt.API_URL||!yt.SESSION_PATH)return;const y=ei(yt.API_URL+yt.SESSION_PATH);y.params.push(`sku=${o||""}`),y.params.push(`access_token=${p||yt.ACCESS_TOKEN||""}`);const w={url:ki(y),headers:{"Content-Type":"text/plain"}};var M;this.pendingRequest=(M=E=>{this.pendingRequest=null,l(E),this.saveEventData(),this.processRequests(p)},Sr(gt(w,{method:"GET"}),M))}getSessionAPI(a,o,l,p){this.skuToken=o,this.errorCb=p,yt.SESSION_PATH&&yt.API_URL&&(l||yt.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},l):this.errorCb(new Error(Ei)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:o,timestamp:l}=this.queue.shift();o&&this.success[o]||this.getSession(l,this.skuToken,p=>{p?this.errorCb(p):o&&(this.success[o]=!0)},a)}},Be=Oe.getSessionAPI.bind(Oe),Pe=new Set,He={create:"create",load:"load",fullLoad:"fullLoad"},it={mark(a){$e.performance.mark(a)},measure(a,o,l){$e.performance.measure(a,o,l)}};function jt(a){const o=a.name.split("?")[0];return cn(o)&&o.includes("mapbox-gl.js")?"javascript":cn(o)&&o.includes("mapbox-gl.css")?"css":yt.API_FONTS_REGEX.test(o)?"fontRange":Sn(o)?"sprite":Vt(o)?"style":yt.API_TILEJSON_REGEX.test(o)?"tilejson":"other"}const _t=$e.performance;function En(a){const o=a?a.url.toString():void 0;return _t.getEntriesByName(o)}let Ln,Fn,ni,Ci;const gi={now:()=>void 0!==ni?ni:$e.performance.now(),setNow(a){ni=a},restoreNow(){ni=void 0},frame(a){const o=$e.requestAnimationFrame(a);return{cancel:()=>$e.cancelAnimationFrame(o)}},getImageData(a,o=0){const{width:l,height:p}=a;Ci||(Ci=$e.document.createElement("canvas"));const y=Ci.getContext("2d",{willReadFrequently:!0});if(!y)throw new Error("failed to create canvas 2d context");return(l>Ci.width||p>Ci.height)&&(Ci.width=l,Ci.height=p),y.clearRect(-o,-o,l+2*o,p+2*o),y.drawImage(a,0,0,l,p),y.getImageData(-o,-o,l+2*o,p+2*o)},resolveURL:a=>(Ln||(Ln=$e.document.createElement("a")),Ln.href=a,Ln.href),get devicePixelRatio(){return $e.devicePixelRatio},get prefersReducedMotion(){return!!$e.matchMedia&&(null==Fn&&(Fn=$e.matchMedia("(prefers-reduced-motion: reduce)")),Fn.matches)}};function $n(a,o,l){l[a]&&-1!==l[a].indexOf(o)||(l[a]=l[a]||[],l[a].push(o))}function hr(a,o,l){if(l&&l[a]){const p=l[a].indexOf(o);-1!==p&&l[a].splice(p,1)}}class fr{constructor(o,l={}){gt(this,l),this.type=o}}class Zi extends fr{constructor(o,l={}){super("error",gt({error:o},l))}}class Rr{on(o,l){return this._listeners=this._listeners||{},$n(o,l,this._listeners),this}off(o,l){return hr(o,l,this._listeners),hr(o,l,this._oneTimeListeners),this}once(o,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},$n(o,l,this._oneTimeListeners),this):new Promise(p=>this.once(o,p))}fire(o,l){"string"==typeof o&&(o=new fr(o,l||{}));const p=o.type;if(this.listens(p)){o.target=this;const y=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const M of y)M.call(this,o);const w=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const M of w)hr(p,M,this._oneTimeListeners),M.call(this,o);const E=this._eventedParent;E&&(gt(o,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),E.fire(o))}else o instanceof Zi&&console.error(o.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,l){return this._eventedParent=o,this._eventedParentData=l,this}}var ut=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ao(a,...o){for(const l of o)for(const p in l)a[p]=l[p];return a}function cr(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Ya(a){if(Array.isArray(a))return a.map(Ya);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const o={};for(const l in a)o[l]=Ya(a[l]);return o}return cr(a)}class oh extends Error{constructor(o,l){super(l),this.message=l,this.key=o}}var us=oh;class As{constructor(o,l=[]){this.parent=o,this.bindings={};for(const[p,y]of l)this.bindings[p]=y}concat(o){return new As(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}var Mn=As;const Ti={kind:"null"},Nt={kind:"number"},ri={kind:"string"},_i={kind:"boolean"},ur={kind:"color"},Ps={kind:"object"},Gn={kind:"value"},Bo={kind:"collator"},Cl={kind:"formatted"},bi={kind:"resolvedImage"};function Vo(a,o){return{kind:"array",itemType:a,N:o}}function ji(a){if("array"===a.kind){const o=ji(a.itemType);return"number"==typeof a.N?`array<${o}, ${a.N}>`:"value"===a.itemType.kind?"array":`array<${o}>`}return a.kind}const _d=[Ti,Nt,ri,_i,ur,Cl,Ps,Vo(Gn),bi];function co(a,o){if("error"===o.kind)return null;if("array"===a.kind){if("array"===o.kind&&(0===o.N&&"value"===o.itemType.kind||!co(a.itemType,o.itemType))&&("number"!=typeof a.N||a.N===o.N))return null}else{if(a.kind===o.kind)return null;if("value"===a.kind)for(const l of _d)if(!co(l,o))return null}return`Expected ${ji(a)} but found ${ji(o)} instead.`}function ds(a,o){return o.some(l=>l.kind===a.kind)}function Us(a,o){return o.some(l=>"null"===l?null===a:"array"===l?Array.isArray(a):"object"===l?a&&!Array.isArray(a)&&"object"==typeof a:l===typeof a)}var sa,bo={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function aa(a){return(a=Math.round(a))<0?0:a>255?255:a}function Fc(a){return aa("%"===a[a.length-1]?parseFloat(a)/100*255:parseInt(a))}function yi(a){return(o="%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))<0?0:o>1?1:o;var o}function xp(a,o,l){return l<0?l+=1:l>1&&(l-=1),6*l<1?a+(o-a)*l*6:2*l<1?o:3*l<2?a+(o-a)*(2/3-l)*6:a}try{sa={}.parseCSSColor=function(a){var o,l=a.replace(/ /g,"").toLowerCase();if(l in bo)return bo[l].slice();if("#"===l[0])return 4===l.length?(o=parseInt(l.substr(1),16))>=0&&o<=4095?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null:7===l.length&&(o=parseInt(l.substr(1),16))>=0&&o<=16777215?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null;var p=l.indexOf("("),y=l.indexOf(")");if(-1!==p&&y+1===l.length){var w=l.substr(0,p),E=l.substr(p+1,y-(p+1)).split(","),M=1;switch(w){case"rgba":if(4!==E.length)return null;M=yi(E.pop());case"rgb":return 3!==E.length?null:[Fc(E[0]),Fc(E[1]),Fc(E[2]),M];case"hsla":if(4!==E.length)return null;M=yi(E.pop());case"hsl":if(3!==E.length)return null;var k=(parseFloat(E[0])%360+360)%360/360,F=yi(E[1]),U=yi(E[2]),z=U<=.5?U*(F+1):U+F-U*F,Z=2*U-z;return[aa(255*xp(Z,z,k+1/3)),aa(255*xp(Z,z,k)),aa(255*xp(Z,z,k-1/3)),M];default:return null}}return null}}catch{}class Zo{constructor(o,l,p,y=1){this.r=o,this.g=l,this.b=p,this.a=y}static parse(o){if(!o)return;if(o instanceof Zo)return o;if("string"!=typeof o)return;const l=sa(o);return l?new Zo(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[o,l,p,y]=this.toArray();return`rgba(${Math.round(o)},${Math.round(l)},${Math.round(p)},${y})`}toArray(){const{r:o,g:l,b:p,a:y}=this;return 0===y?[0,0,0,0]:[255*o/y,255*l/y,255*p/y,y]}toArray01(){const{r:o,g:l,b:p,a:y}=this;return 0===y?[0,0,0,0]:[o/y,l/y,p/y,y]}toArray01PremultipliedAlpha(){const{r:o,g:l,b:p,a:y}=this;return[o,l,p,y]}}Zo.black=new Zo(0,0,0,1),Zo.white=new Zo(1,1,1,1),Zo.transparent=new Zo(0,0,0,0),Zo.red=new Zo(1,0,0,1),Zo.blue=new Zo(0,0,1,1);var Jr=Zo;class El{constructor(o,l,p){this.sensitivity=o?l?"variant":"case":l?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,l){return this.collator.compare(o,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class nc{constructor(o,l,p,y,w){this.text=o.normalize?o.normalize():o,this.image=l,this.scale=p,this.fontStack=y,this.textColor=w}}class xo{constructor(o){this.sections=o}static fromString(o){return new xo([new nc(o,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(o=>0!==o.text.length||o.image&&0!==o.image.name.length)}static factory(o){return o instanceof xo?o:xo.fromString(o)}toString(){return 0===this.sections.length?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const l of this.sections){if(l.image){o.push(["image",l.image.name]);continue}o.push(l.text);const p={};l.fontStack&&(p["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(p["font-scale"]=l.scale),l.textColor&&(p["text-color"]=["rgba"].concat(l.textColor.toArray())),o.push(p)}return o}}class Cr{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new Cr({name:o,available:!1}):null}serialize(){return["image",this.name]}}function Um(a,o,l,p){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof o&&o>=0&&o<=255&&"number"==typeof l&&l>=0&&l<=255?void 0===p||"number"==typeof p&&p>=0&&p<=1?null:`Invalid rgba value [${[a,o,l,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof p?[a,o,l,p]:[a,o,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Yo(a){if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||a instanceof Jr||a instanceof El||a instanceof xo||a instanceof Cr)return!0;if(Array.isArray(a)){for(const o of a)if(!Yo(o))return!1;return!0}if("object"==typeof a){for(const o in a)if(!Yo(a[o]))return!1;return!0}return!1}function Ji(a){if(null===a)return Ti;if("string"==typeof a)return ri;if("boolean"==typeof a)return _i;if("number"==typeof a)return Nt;if(a instanceof Jr)return ur;if(a instanceof El)return Bo;if(a instanceof xo)return Cl;if(a instanceof Cr)return bi;if(Array.isArray(a)){const o=a.length;let l;for(const p of a){const y=Ji(p);if(l){if(l===y)continue;l=Gn;break}l=y}return Vo(l||Gn,o)}return Ps}function Lc(a){const o=typeof a;return null===a?"":"string"===o||"number"===o||"boolean"===o?String(a):a instanceof Jr||a instanceof xo||a instanceof Cr?a.toString():JSON.stringify(a)}class Nc{constructor(o,l){this.type=o,this.value=l}static parse(o,l){if(2!==o.length)return l.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!Yo(o[1]))return l.error("invalid value");const p=o[1];let y=Ji(p);const w=l.expectedType;return"array"!==y.kind||0!==y.N||!w||"array"!==w.kind||"number"==typeof w.N&&0!==w.N||(y=w),new Nc(y,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Jr?["rgba"].concat(this.value.toArray()):this.value instanceof xo?this.value.serialize():this.value}}var js=Nc,zr=class{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}};const Eu={string:ri,number:Nt,boolean:_i,object:Ps};class Zs{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");let p,y=1;const w=o[0];if("array"===w){let M,k;if(o.length>2){const F=o[1];if("string"!=typeof F||!(F in Eu)||"object"===F)return l.error('The item type argument of "array" must be one of string, number, boolean',1);M=Eu[F],y++}else M=Gn;if(o.length>3){if(null!==o[2]&&("number"!=typeof o[2]||o[2]<0||o[2]!==Math.floor(o[2])))return l.error('The length argument to "array" must be a positive integer literal',2);k=o[2],y++}p=Vo(M,k)}else p=Eu[w];const E=[];for(;y<o.length;y++){const M=l.parse(o[y],y,Gn);if(!M)return null;E.push(M)}return new Zs(p,E)}evaluate(o){for(let l=0;l<this.args.length;l++){const p=this.args[l].evaluate(o);if(!co(this.type,Ji(p)))return p;if(l===this.args.length-1)throw new zr(`Expected value to be of type ${ji(this.type)}, but found ${ji(Ji(p))} instead.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,l=[o.kind];if("array"===o.kind){const p=o.itemType;if("string"===p.kind||"number"===p.kind||"boolean"===p.kind){l.push(p.kind);const y=o.N;("number"==typeof y||this.args.length>1)&&l.push(y)}}return l.concat(this.args.map(p=>p.serialize()))}}var $s=Zs;class Tl{constructor(o){this.type=Cl,this.sections=o}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const p=o[1];if(!Array.isArray(p)&&"object"==typeof p)return l.error("First argument must be an image or text section.");const y=[];let w=!1;for(let E=1;E<=o.length-1;++E){const M=o[E];if(w&&"object"==typeof M&&!Array.isArray(M)){w=!1;let k=null;if(M["font-scale"]&&(k=l.parse(M["font-scale"],1,Nt),!k))return null;let F=null;if(M["text-font"]&&(F=l.parse(M["text-font"],1,Vo(ri)),!F))return null;let U=null;if(M["text-color"]&&(U=l.parse(M["text-color"],1,ur),!U))return null;const z=y[y.length-1];z.scale=k,z.font=F,z.textColor=U}else{const k=l.parse(o[E],1,Gn);if(!k)return null;const F=k.type.kind;if("string"!==F&&"value"!==F&&"null"!==F&&"resolvedImage"!==F)return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");w=!0,y.push({content:k,scale:null,font:null,textColor:null})}}return new Tl(y)}evaluate(o){return new xo(this.sections.map(l=>{const p=l.content.evaluate(o);return Ji(p)===bi?new nc("",p,null,null,null):new nc(Lc(p),null,l.scale?l.scale.evaluate(o):null,l.font?l.font.evaluate(o).join(","):null,l.textColor?l.textColor.evaluate(o):null)}))}eachChild(o){for(const l of this.sections)o(l.content),l.scale&&o(l.scale),l.font&&o(l.font),l.textColor&&o(l.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const l of this.sections){o.push(l.content.serialize());const p={};l.scale&&(p["font-scale"]=l.scale.serialize()),l.font&&(p["text-font"]=l.font.serialize()),l.textColor&&(p["text-color"]=l.textColor.serialize()),o.push(p)}return o}}class uf{constructor(o){this.type=bi,this.input=o}static parse(o,l){if(2!==o.length)return l.error("Expected two arguments.");const p=l.parse(o[1],1,ri);return p?new uf(p):l.error("No image name provided.")}evaluate(o){const l=this.input.evaluate(o),p=Cr.fromString(l);return p&&o.availableImages&&(p.available=o.availableImages.indexOf(l)>-1),p}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const jm={"to-boolean":_i,"to-color":ur,"to-number":Nt,"to-string":ri};class wp{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const p=o[0];if(("to-boolean"===p||"to-string"===p)&&2!==o.length)return l.error("Expected one argument.");const y=jm[p],w=[];for(let E=1;E<o.length;E++){const M=l.parse(o[E],E,Gn);if(!M)return null;w.push(M)}return new wp(y,w)}evaluate(o){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(o));if("color"===this.type.kind){let l,p;for(const y of this.args){if(l=y.evaluate(o),p=null,l instanceof Jr)return l;if("string"==typeof l){const w=o.parseColor(l);if(w)return w}else if(Array.isArray(l)&&(p=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Um(l[0],l[1],l[2],l[3]),!p))return new Jr(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new zr(p||`Could not parse color from value '${"string"==typeof l?l:String(JSON.stringify(l))}'`)}if("number"===this.type.kind){let l=null;for(const p of this.args){if(l=p.evaluate(o),null===l)return 0;const y=Number(l);if(!isNaN(y))return y}throw new zr(`Could not convert ${JSON.stringify(l)} to number.`)}return"formatted"===this.type.kind?xo.fromString(Lc(this.args[0].evaluate(o))):"resolvedImage"===this.type.kind?Cr.fromString(Lc(this.args[0].evaluate(o))):Lc(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Tl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new uf(this.args[0]).serialize();const o=[`to-${this.type.kind}`];return this.eachChild(l=>{o.push(l.serialize())}),o}}var yd=wp;const Tu=["Unknown","Point","LineString","Polygon"];var Iu=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Tu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:l,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(l*o-a[0])+this.featureDistanceData.bearing[1]*(p*o-a[1])}return 0}parseColor(a){let o=this._parseColorCache[a];return o||(o=this._parseColorCache[a]=Jr.parse(a)),o}};class Ka{constructor(o,l,p,y){this.name=o,this.type=l,this._evaluate=p,this.args=y}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,l){const p=o[0],y=Ka.definitions[p];if(!y)return l.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const w=Array.isArray(y)?y[0]:y.type,E=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,M=E.filter(([F])=>!Array.isArray(F)||F.length===o.length-1);let k=null;for(const[F,U]of M){k=new Sl(l.registry,l.path,null,l.scope);const z=[];let Z=!1;for(let te=1;te<o.length;te++){const ie=o[te],K=Array.isArray(F)?F[te-1]:F.type,pe=k.parse(ie,1+z.length,K);if(!pe){Z=!0;break}z.push(pe)}if(!Z)if(Array.isArray(F)&&F.length!==z.length)k.error(`Expected ${F.length} arguments, but found ${z.length} instead.`);else{for(let te=0;te<z.length;te++){const ie=Array.isArray(F)?F[te]:F.type,K=z[te];k.concat(te+1).checkSubtype(ie,K.type)}if(0===k.errors.length)return new Ka(p,w,U,z)}}if(1===M.length)l.errors.push(...k.errors);else{const F=(M.length?M:E).map(([z])=>{return Z=z,Array.isArray(Z)?`(${Z.map(ji).join(", ")})`:`(${ji(Z.type)}...)`;var Z}).join(" | "),U=[];for(let z=1;z<o.length;z++){const Z=l.parse(o[z],1+U.length);if(!Z)return null;U.push(ji(Z.type))}l.error(`Expected arguments of type ${F}, but found (${U.join(", ")}) instead.`)}return null}static register(o,l){Ka.definitions=l;for(const p in l)o[p]=Ka}}var Su=Ka;class df{constructor(o,l,p){this.type=Bo,this.locale=p,this.caseSensitive=o,this.diacriticSensitive=l}static parse(o,l){if(2!==o.length)return l.error("Expected one argument.");const p=o[1];if("object"!=typeof p||Array.isArray(p))return l.error("Collator options argument must be an object.");const y=l.parse(void 0!==p["case-sensitive"]&&p["case-sensitive"],1,_i);if(!y)return null;const w=l.parse(void 0!==p["diacritic-sensitive"]&&p["diacritic-sensitive"],1,_i);if(!w)return null;let E=null;return p.locale&&(E=l.parse(p.locale,1,ri),!E)?null:new df(y,w,E)}evaluate(o){return new El(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}const vs=8192;function eo(a,o){a[0]=Math.min(a[0],o[0]),a[1]=Math.min(a[1],o[1]),a[2]=Math.max(a[2],o[0]),a[3]=Math.max(a[3],o[1])}function vd(a,o){return!(a[0]<=o[0]||a[2]>=o[2]||a[1]<=o[1]||a[3]>=o[3])}function hf(a,o){const l=(180+a[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,y=Math.pow(2,o.z);return[Math.round(l*y*vs),Math.round(p*y*vs)]}function bd(a,o,l){const p=a[0]-o[0],y=a[1]-o[1],w=a[0]-l[0],E=a[1]-l[1];return p*E-w*y==0&&p*w<=0&&y*E<=0}function Mu(a,o){let l=!1;for(let E=0,M=o.length;E<M;E++){const k=o[E];for(let F=0,U=k.length;F<U-1;F++){if(bd(a,k[F],k[F+1]))return!1;(y=k[F])[1]>(p=a)[1]!=(w=k[F+1])[1]>p[1]&&p[0]<(w[0]-y[0])*(p[1]-y[1])/(w[1]-y[1])+y[0]&&(l=!l)}}var p,y,w;return l}function ff(a,o){for(let l=0;l<o.length;l++)if(Mu(a,o[l]))return!0;return!1}function Cp(a,o,l,p){const y=p[0]-l[0],w=p[1]-l[1],E=(a[0]-l[0])*w-y*(a[1]-l[1]),M=(o[0]-l[0])*w-y*(o[1]-l[1]);return E>0&&M<0||E<0&&M>0}function ic(a,o,l){for(const F of l)for(let U=0;U<F.length-1;++U)if((M=[(E=F[U+1])[0]-(w=F[U])[0],E[1]-w[1]])[0]*(k=[(y=o)[0]-(p=a)[0],y[1]-p[1]])[1]-M[1]*k[0]!=0&&Cp(p,y,w,E)&&Cp(w,E,p,y))return!0;var p,y,w,E,M,k;return!1}function zc(a,o){for(let l=0;l<a.length;++l)if(!Mu(a[l],o))return!1;for(let l=0;l<a.length-1;++l)if(ic(a[l],a[l+1],o))return!1;return!0}function Du(a,o){for(let l=0;l<o.length;l++)if(zc(a,o[l]))return!0;return!1}function Bc(a,o,l){const p=[];for(let y=0;y<a.length;y++){const w=[];for(let E=0;E<a[y].length;E++){const M=hf(a[y][E],l);eo(o,M),w.push(M)}p.push(w)}return p}function rc(a,o,l){const p=[];for(let y=0;y<a.length;y++){const w=Bc(a[y],o,l);p.push(w)}return p}function xd(a,o,l,p){if(a[0]<l[0]||a[0]>l[2]){const y=.5*p;let w=a[0]-l[0]>y?-p:l[0]-a[0]>y?p:0;0===w&&(w=a[0]-l[2]>y?-p:l[2]-a[0]>y?p:0),a[0]+=w}eo(o,a)}function oc(a,o,l,p){const y=Math.pow(2,p.z)*vs,w=[p.x*vs,p.y*vs],E=[];if(!a)return E;for(const M of a)for(const k of M){const F=[k.x+w[0],k.y+w[1]];xd(F,o,l,y),E.push(F)}return E}function Yi(a,o,l,p){const y=Math.pow(2,p.z)*vs,w=[p.x*vs,p.y*vs],E=[];if(!a)return E;for(const k of a){const F=[];for(const U of k){const z=[U.x+w[0],U.y+w[1]];eo(o,z),F.push(z)}E.push(F)}if(o[2]-o[0]<=y/2){(M=o)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const k of E)for(const F of k)xd(F,o,l,y)}var M;return E}class wd{constructor(o,l){this.type=_i,this.geojson=o,this.geometries=l}static parse(o,l){if(2!==o.length)return l.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(Yo(o[1])){const p=o[1];if("FeatureCollection"===p.type)for(let y=0;y<p.features.length;++y){const w=p.features[y].geometry.type;if("Polygon"===w||"MultiPolygon"===w)return new wd(p,p.features[y].geometry)}else if("Feature"===p.type){const y=p.geometry.type;if("Polygon"===y||"MultiPolygon"===y)return new wd(p,p.geometry)}else if("Polygon"===p.type||"MultiPolygon"===p.type)return new wd(p,p)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(null!=o.geometry()&&null!=o.canonicalID()){if("Point"===o.geometryType())return function(l,p){const y=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],E=l.canonicalID();if(!E)return!1;if("Polygon"===p.type){const M=Bc(p.coordinates,w,E),k=oc(l.geometry(),y,w,E);if(!vd(y,w))return!1;for(const F of k)if(!Mu(F,M))return!1}if("MultiPolygon"===p.type){const M=rc(p.coordinates,w,E),k=oc(l.geometry(),y,w,E);if(!vd(y,w))return!1;for(const F of k)if(!ff(F,M))return!1}return!0}(o,this.geometries);if("LineString"===o.geometryType())return function(l,p){const y=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],E=l.canonicalID();if(!E)return!1;if("Polygon"===p.type){const M=Bc(p.coordinates,w,E),k=Yi(l.geometry(),y,w,E);if(!vd(y,w))return!1;for(const F of k)if(!zc(F,M))return!1}if("MultiPolygon"===p.type){const M=rc(p.coordinates,w,E),k=Yi(l.geometry(),y,w,E);if(!vd(y,w))return!1;for(const F of k)if(!Du(F,M))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Il=wd;function Vc(a){if(a instanceof Su&&("get"===a.name&&1===a.args.length||"feature-state"===a.name||"has"===a.name&&1===a.args.length||"properties"===a.name||"geometry-type"===a.name||"id"===a.name||/^filter-/.test(a.name))||a instanceof Il)return!1;let o=!0;return a.eachChild(l=>{o&&!Vc(l)&&(o=!1)}),o}function Ko(a){if(a instanceof Su&&"feature-state"===a.name)return!1;let o=!0;return a.eachChild(l=>{o&&!Ko(l)&&(o=!1)}),o}function Au(a,o){if(a instanceof Su&&o.indexOf(a.name)>=0)return!1;let l=!0;return a.eachChild(p=>{l&&!Au(p,o)&&(l=!1)}),l}class Uc{constructor(o,l){this.type=l.type,this.name=o,this.boundExpression=l}static parse(o,l){if(2!==o.length||"string"!=typeof o[1])return l.error("'var' expression requires exactly one string literal argument.");const p=o[1];return l.scope.has(p)?new Uc(p,l.scope.get(p)):l.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var to=Uc;class Pu{constructor(o,l=[],p,y=new Mn,w=[]){this.registry=o,this.path=l,this.key=l.map(E=>`[${E}]`).join(""),this.scope=y,this.errors=w,this.expectedType=p}parse(o,l,p,y,w={}){return l?this.concat(l,p,y)._parse(o,w):this._parse(o,w)}_parse(o,l){function p(y,w,E){return"assert"===E?new $s(w,[y]):"coerce"===E?new yd(w,[y]):y}if(null!==o&&"string"!=typeof o&&"boolean"!=typeof o&&"number"!=typeof o||(o=["literal",o]),Array.isArray(o)){if(0===o.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const y=o[0];if("string"!=typeof y)return this.error(`Expression name must be a string, but found ${typeof y} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const w=this.registry[y];if(w){let E=w.parse(o,this);if(!E)return null;if(this.expectedType){const M=this.expectedType,k=E.type;if("string"!==M.kind&&"number"!==M.kind&&"boolean"!==M.kind&&"object"!==M.kind&&"array"!==M.kind||"value"!==k.kind)if("color"!==M.kind&&"formatted"!==M.kind&&"resolvedImage"!==M.kind||"value"!==k.kind&&"string"!==k.kind){if(this.checkSubtype(M,k))return null}else E=p(E,M,l.typeAnnotation||"coerce");else E=p(E,M,l.typeAnnotation||"assert")}if(!(E instanceof js)&&"resolvedImage"!==E.type.kind&&uo(E)){const M=new Iu;try{E=new js(E.type,E.evaluate(M))}catch(k){return this.error(k.message),null}}return E}return this.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===o?"'undefined' value invalid. Use null instead.":"object"==typeof o?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,l,p){const y="number"==typeof o?this.path.concat(o):this.path,w=p?this.scope.concat(p):this.scope;return new Pu(this.registry,y,l||null,w,this.errors)}error(o,...l){const p=`${this.key}${l.map(y=>`[${y}]`).join("")}`;this.errors.push(new us(p,o))}checkSubtype(o,l){const p=co(o,l);return p&&this.error(p),p}}var Sl=Pu;function uo(a){if(a instanceof to)return uo(a.boundExpression);if(a instanceof Su&&"error"===a.name||a instanceof df||a instanceof Il)return!1;const o=a instanceof yd||a instanceof $s;let l=!0;return a.eachChild(p=>{l=o?l&&uo(p):l&&p instanceof js}),!!l&&Vc(a)&&Au(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function jc(a,o){const l=a.length-1;let p,y,w=0,E=l,M=0;for(;w<=E;)if(M=Math.floor((w+E)/2),p=a[M],y=a[M+1],p<=o){if(M===l||o<y)return M;w=M+1}else{if(!(p>o))throw new zr("Input is not a number.");E=M-1}return 0}class Ou{constructor(o,l,p){this.type=o,this.input=l,this.labels=[],this.outputs=[];for(const[y,w]of p)this.labels.push(y),this.outputs.push(w)}static parse(o,l){if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return l.error("Expected an even number of arguments.");const p=l.parse(o[1],1,Nt);if(!p)return null;const y=[];let w=null;l.expectedType&&"value"!==l.expectedType.kind&&(w=l.expectedType);for(let E=1;E<o.length;E+=2){const M=1===E?-1/0:o[E],k=o[E+1],F=E,U=E+1;if("number"!=typeof M)return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(y.length&&y[y.length-1][0]>=M)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);const z=l.parse(k,U,w);if(!z)return null;w=w||z.type,y.push([M,z])}return new Ou(w,p,y)}evaluate(o){const l=this.labels,p=this.outputs;if(1===l.length)return p[0].evaluate(o);const y=this.input.evaluate(o);if(y<=l[0])return p[0].evaluate(o);const w=l.length;return y>=l[w-1]?p[w-1].evaluate(o):p[jc(l,y)].evaluate(o)}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&o.push(this.labels[l]),o.push(this.outputs[l].serialize());return o}}var la=Ou;function di(a,o,l){return a*(1-l)+o*l}var $c=Object.freeze({__proto__:null,number:di,color:function(a,o,l){return new Jr(di(a.r,o.r,l),di(a.g,o.g,l),di(a.b,o.b,l),di(a.a,o.a,l))},array:function(a,o,l){return a.map((p,y)=>di(p,o[y],l))}});const sc=.95047,$m=1.08883,ca=4/29,sh=6/29,Gc=3*sh*sh,Ii=Math.PI/180,pf=180/Math.PI;function ah(a){return a>.008856451679035631?Math.pow(a,1/3):a/Gc+ca}function Cd(a){return a>sh?a*a*a:Gc*(a-ca)}function lh(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function ku(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Ep(a){const o=ku(a.r),l=ku(a.g),p=ku(a.b),y=ah((.4124564*o+.3575761*l+.1804375*p)/sc),w=ah((.2126729*o+.7151522*l+.072175*p)/1);return{l:116*w-16,a:500*(y-w),b:200*(w-ah((.0193339*o+.119192*l+.9503041*p)/$m)),alpha:a.a}}function ch(a){let o=(a.l+16)/116,l=isNaN(a.a)?o:o+a.a/500,p=isNaN(a.b)?o:o-a.b/200;return o=1*Cd(o),l=sc*Cd(l),p=$m*Cd(p),new Jr(lh(3.2404542*l-1.5371385*o-.4985314*p),lh(-.969266*l+1.8760108*o+.041556*p),lh(.0556434*l-.2040259*o+1.0572252*p),a.alpha)}function wo(a,o,l){const p=o-a;return a+l*(p>180||p<-180?p-360*Math.round(p/360):p)}const qt={forward:Ep,reverse:ch,interpolate:function(a,o,l){return{l:di(a.l,o.l,l),a:di(a.a,o.a,l),b:di(a.b,o.b,l),alpha:di(a.alpha,o.alpha,l)}}},$i={forward:function(a){const{l:o,a:l,b:p}=Ep(a),y=Math.atan2(p,l)*pf;return{h:y<0?y+360:y,c:Math.sqrt(l*l+p*p),l:o,alpha:a.a}},reverse:function(a){const o=a.h*Ii,l=a.c;return ch({l:a.l,a:Math.cos(o)*l,b:Math.sin(o)*l,alpha:a.alpha})},interpolate:function(a,o,l){return{h:wo(a.h,o.h,l),c:di(a.c,o.c,l),l:di(a.l,o.l,l),alpha:di(a.alpha,o.alpha,l)}}};var Tp=Object.freeze({__proto__:null,lab:qt,hcl:$i});class Ed{constructor(o,l,p,y,w){this.type=o,this.operator=l,this.interpolation=p,this.input=y,this.labels=[],this.outputs=[];for(const[E,M]of w)this.labels.push(E),this.outputs.push(M)}static interpolationFactor(o,l,p,y){let w=0;if("exponential"===o.name)w=Po(l,o.base,p,y);else if("linear"===o.name)w=Po(l,1,p,y);else if("cubic-bezier"===o.name){const E=o.controlPoints;w=new Dn(E[0],E[1],E[2],E[3]).solve(Po(l,1,p,y))}return w}static parse(o,l){let[p,y,w,...E]=o;if(!Array.isArray(y)||0===y.length)return l.error("Expected an interpolation type expression.",1);if("linear"===y[0])y={name:"linear"};else if("exponential"===y[0]){const F=y[1];if("number"!=typeof F)return l.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:F}}else{if("cubic-bezier"!==y[0])return l.error(`Unknown interpolation type ${String(y[0])}`,1,0);{const F=y.slice(1);if(4!==F.length||F.some(U=>"number"!=typeof U||U<0||U>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:F}}}if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(w=l.parse(w,2,Nt),!w)return null;const M=[];let k=null;"interpolate-hcl"===p||"interpolate-lab"===p?k=ur:l.expectedType&&"value"!==l.expectedType.kind&&(k=l.expectedType);for(let F=0;F<E.length;F+=2){const U=E[F],z=E[F+1],Z=F+3,te=F+4;if("number"!=typeof U)return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(M.length&&M[M.length-1][0]>=U)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Z);const ie=l.parse(z,te,k);if(!ie)return null;k=k||ie.type,M.push([U,ie])}return"number"===k.kind||"color"===k.kind||"array"===k.kind&&"number"===k.itemType.kind&&"number"==typeof k.N?new Ed(k,p,y,w,M):l.error(`Type ${ji(k)} is not interpolatable.`)}evaluate(o){const l=this.labels,p=this.outputs;if(1===l.length)return p[0].evaluate(o);const y=this.input.evaluate(o);if(y<=l[0])return p[0].evaluate(o);const w=l.length;if(y>=l[w-1])return p[w-1].evaluate(o);const E=jc(l,y),M=Ed.interpolationFactor(this.interpolation,y,l[E],l[E+1]),k=p[E].evaluate(o),F=p[E+1].evaluate(o);return"interpolate"===this.operator?$c[this.type.kind.toLowerCase()](k,F,M):"interpolate-hcl"===this.operator?$i.reverse($i.interpolate($i.forward(k),$i.forward(F),M)):qt.reverse(qt.interpolate(qt.forward(k),qt.forward(F),M))}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,o,this.input.serialize()];for(let p=0;p<this.labels.length;p++)l.push(this.labels[p],this.outputs[p].serialize());return l}}function Po(a,o,l,p){const y=p-l,w=a-l;return 0===y?0:1===o?w/y:(Math.pow(o,w)-1)/(Math.pow(o,y)-1)}var Xa=Ed;class Ml{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expectected at least one argument.");let p=null;const y=l.expectedType;y&&"value"!==y.kind&&(p=y);const w=[];for(const M of o.slice(1)){const k=l.parse(M,1+w.length,p,void 0,{typeAnnotation:"omit"});if(!k)return null;p=p||k.type,w.push(k)}const E=y&&w.some(M=>co(y,M.type));return new Ml(E?Gn:p,w)}evaluate(o){let l,p=null,y=0;for(const w of this.args){if(y++,p=w.evaluate(o),p&&p instanceof Cr&&!p.available&&(l||(l=p),p=null,y===this.args.length))return l;if(null!==p)break}return p}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(l=>{o.push(l.serialize())}),o}}var Qa=Ml;class Hc{constructor(o,l){this.type=l.type,this.bindings=[].concat(o),this.result=l}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const l of this.bindings)o(l[1]);o(this.result)}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const p=[];for(let w=1;w<o.length-1;w+=2){const E=o[w];if("string"!=typeof E)return l.error(`Expected string, but found ${typeof E} instead.`,w);if(/[^a-zA-Z0-9_]/.test(E))return l.error("Variable names must contain only alphanumeric characters or '_'.",w);const M=l.parse(o[w+1],w+1);if(!M)return null;p.push([E,M])}const y=l.parse(o[o.length-1],o.length-1,l.expectedType,p);return y?new Hc(p,y):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[l,p]of this.bindings)o.push(l,p.serialize());return o.push(this.result.serialize()),o}}var uh=Hc;class qc{constructor(o,l,p){this.type=o,this.index=l,this.input=p}static parse(o,l){if(3!==o.length)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const p=l.parse(o[1],1,Nt),y=l.parse(o[2],2,Vo(l.expectedType||Gn));return p&&y?new qc(y.type.itemType,p,y):null}evaluate(o){const l=this.index.evaluate(o),p=this.input.evaluate(o);if(l<0)throw new zr(`Array index out of bounds: ${l} < 0.`);if(l>=p.length)throw new zr(`Array index out of bounds: ${l} > ${p.length-1}.`);if(l!==Math.floor(l))throw new zr(`Array index must be an integer, but found ${l} instead.`);return p[l]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var T_=qc;class Ru{constructor(o,l){this.type=_i,this.needle=o,this.haystack=l}static parse(o,l){if(3!==o.length)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const p=l.parse(o[1],1,Gn),y=l.parse(o[2],2,Gn);return p&&y?ds(p.type,[_i,ri,Nt,Ti,Gn])?new Ru(p,y):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ji(p.type)} instead`):null}evaluate(o){const l=this.needle.evaluate(o),p=this.haystack.evaluate(o);if(null==p)return!1;if(!Us(l,["boolean","string","number","null"]))throw new zr(`Expected first argument to be of type boolean, string, number or null, but found ${ji(Ji(l))} instead.`);if(!Us(p,["string","array"]))throw new zr(`Expected second argument to be of type array or string, but found ${ji(Ji(p))} instead.`);return p.indexOf(l)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Xo=Ru;class Uo{constructor(o,l,p){this.type=Nt,this.needle=o,this.haystack=l,this.fromIndex=p}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const p=l.parse(o[1],1,Gn),y=l.parse(o[2],2,Gn);if(!p||!y)return null;if(!ds(p.type,[_i,ri,Nt,Ti,Gn]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ji(p.type)} instead`);if(4===o.length){const w=l.parse(o[3],3,Nt);return w?new Uo(p,y,w):null}return new Uo(p,y)}evaluate(o){const l=this.needle.evaluate(o),p=this.haystack.evaluate(o);if(!Us(l,["boolean","string","number","null"]))throw new zr(`Expected first argument to be of type boolean, string, number or null, but found ${ji(Ji(l))} instead.`);if(!Us(p,["string","array"]))throw new zr(`Expected second argument to be of type array or string, but found ${ji(Ji(p))} instead.`);if(this.fromIndex){const y=this.fromIndex.evaluate(o);return p.indexOf(l,y)}return p.indexOf(l)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Ip=Uo;class Dl{constructor(o,l,p,y,w,E){this.inputType=o,this.type=l,this.input=p,this.cases=y,this.outputs=w,this.otherwise=E}static parse(o,l){if(o.length<5)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return l.error("Expected an even number of arguments.");let p,y;l.expectedType&&"value"!==l.expectedType.kind&&(y=l.expectedType);const w={},E=[];for(let F=2;F<o.length-1;F+=2){let U=o[F];const z=o[F+1];Array.isArray(U)||(U=[U]);const Z=l.concat(F);if(0===U.length)return Z.error("Expected at least one branch label.");for(const ie of U){if("number"!=typeof ie&&"string"!=typeof ie)return Z.error("Branch labels must be numbers or strings.");if("number"==typeof ie&&Math.abs(ie)>Number.MAX_SAFE_INTEGER)return Z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof ie&&Math.floor(ie)!==ie)return Z.error("Numeric branch labels must be integer values.");if(p){if(Z.checkSubtype(p,Ji(ie)))return null}else p=Ji(ie);if(void 0!==w[String(ie)])return Z.error("Branch labels must be unique.");w[String(ie)]=E.length}const te=l.parse(z,F,y);if(!te)return null;y=y||te.type,E.push(te)}const M=l.parse(o[1],1,Gn);if(!M)return null;const k=l.parse(o[o.length-1],o.length-1,y);return k?"value"!==M.type.kind&&l.concat(1).checkSubtype(p,M.type)?null:new Dl(p,y,M,w,E,k):null}evaluate(o){const l=this.input.evaluate(o);return(Ji(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),p=[],y={};for(const E of l){const M=y[this.cases[E]];void 0===M?(y[this.cases[E]]=p.length,p.push([this.cases[E],[E]])):p[M][1].push(E)}const w=E=>"number"===this.inputType.kind?Number(E):E;for(const[E,M]of p)o.push(1===M.length?w(M[0]):M.map(w)),o.push(this.outputs[E].serialize());return o.push(this.otherwise.serialize()),o}}var Ja=Dl;class dh{constructor(o,l,p){this.type=o,this.branches=l,this.otherwise=p}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return l.error("Expected an odd number of arguments.");let p;l.expectedType&&"value"!==l.expectedType.kind&&(p=l.expectedType);const y=[];for(let E=1;E<o.length-1;E+=2){const M=l.parse(o[E],E,_i);if(!M)return null;const k=l.parse(o[E+1],E+1,p);if(!k)return null;y.push([M,k]),p=p||k.type}const w=l.parse(o[o.length-1],o.length-1,p);return w?new dh(p,y,w):null}evaluate(o){for(const[l,p]of this.branches)if(l.evaluate(o))return p.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[l,p]of this.branches)o(l),o(p);o(this.otherwise)}outputDefined(){return this.branches.every(([o,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(l=>{o.push(l.serialize())}),o}}var Sp=dh;class ac{constructor(o,l,p,y){this.type=o,this.input=l,this.beginIndex=p,this.endIndex=y}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const p=l.parse(o[1],1,Gn),y=l.parse(o[2],2,Nt);if(!p||!y)return null;if(!ds(p.type,[Vo(Gn),ri,Gn]))return l.error(`Expected first argument to be of type array or string, but found ${ji(p.type)} instead`);if(4===o.length){const w=l.parse(o[3],3,Nt);return w?new ac(p.type,p,y,w):null}return new ac(p.type,p,y)}evaluate(o){const l=this.input.evaluate(o),p=this.beginIndex.evaluate(o);if(!Us(l,["string","array"]))throw new zr(`Expected first argument to be of type array or string, but found ${ji(Ji(l))} instead.`);if(this.endIndex){const y=this.endIndex.evaluate(o);return l.slice(p,y)}return l.slice(p)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Mp=ac;function Ma(a,o){return"=="===a||"!="===a?"boolean"===o.kind||"string"===o.kind||"number"===o.kind||"null"===o.kind||"value"===o.kind:"string"===o.kind||"number"===o.kind||"value"===o.kind}function hh(a,o,l,p){return 0===p.compare(o,l)}function Fu(a,o,l){const p="=="!==a&&"!="!==a;return class H5{constructor(w,E,M){this.type=_i,this.lhs=w,this.rhs=E,this.collator=M,this.hasUntypedArgument="value"===w.type.kind||"value"===E.type.kind}static parse(w,E){if(3!==w.length&&4!==w.length)return E.error("Expected two or three arguments.");const M=w[0];let k=E.parse(w[1],1,Gn);if(!k)return null;if(!Ma(M,k.type))return E.concat(1).error(`"${M}" comparisons are not supported for type '${ji(k.type)}'.`);let F=E.parse(w[2],2,Gn);if(!F)return null;if(!Ma(M,F.type))return E.concat(2).error(`"${M}" comparisons are not supported for type '${ji(F.type)}'.`);if(k.type.kind!==F.type.kind&&"value"!==k.type.kind&&"value"!==F.type.kind)return E.error(`Cannot compare types '${ji(k.type)}' and '${ji(F.type)}'.`);p&&("value"===k.type.kind&&"value"!==F.type.kind?k=new $s(F.type,[k]):"value"!==k.type.kind&&"value"===F.type.kind&&(F=new $s(k.type,[F])));let U=null;if(4===w.length){if("string"!==k.type.kind&&"string"!==F.type.kind&&"value"!==k.type.kind&&"value"!==F.type.kind)return E.error("Cannot use collator to compare non-string types.");if(U=E.parse(w[3],3,Bo),!U)return null}return new H5(k,F,U)}evaluate(w){const E=this.lhs.evaluate(w),M=this.rhs.evaluate(w);if(p&&this.hasUntypedArgument){const k=Ji(E),F=Ji(M);if(k.kind!==F.kind||"string"!==k.kind&&"number"!==k.kind)throw new zr(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${k.kind}, ${F.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const k=Ji(E),F=Ji(M);if("string"!==k.kind||"string"!==F.kind)return o(w,E,M)}return this.collator?l(w,E,M,this.collator.evaluate(w)):o(w,E,M)}eachChild(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)}outputDefined(){return!0}serialize(){const w=[a];return this.eachChild(E=>{w.push(E.serialize())}),w}}}const Dp=Fu("==",function(a,o,l){return o===l},hh),Gm=Fu("!=",function(a,o,l){return o!==l},function(a,o,l,p){return!hh(0,o,l,p)}),Ap=Fu("<",function(a,o,l){return o<l},function(a,o,l,p){return p.compare(o,l)<0}),mf=Fu(">",function(a,o,l){return o>l},function(a,o,l,p){return p.compare(o,l)>0}),Pp=Fu("<=",function(a,o,l){return o<=l},function(a,o,l,p){return p.compare(o,l)<=0}),Hm=Fu(">=",function(a,o,l){return o>=l},function(a,o,l,p){return p.compare(o,l)>=0});class gf{constructor(o,l,p,y,w,E){this.type=ri,this.number=o,this.locale=l,this.currency=p,this.unit=y,this.minFractionDigits=w,this.maxFractionDigits=E}static parse(o,l){if(3!==o.length)return l.error("Expected two arguments.");const p=l.parse(o[1],1,Nt);if(!p)return null;const y=o[2];if("object"!=typeof y||Array.isArray(y))return l.error("NumberFormat options argument must be an object.");let w=null;if(y.locale&&(w=l.parse(y.locale,1,ri),!w))return null;let E=null;if(y.currency&&(E=l.parse(y.currency,1,ri),!E))return null;let M=null;if(y.unit&&(M=l.parse(y.unit,1,ri),!M))return null;let k=null;if(y["min-fraction-digits"]&&(k=l.parse(y["min-fraction-digits"],1,Nt),!k))return null;let F=null;return y["max-fraction-digits"]&&(F=l.parse(y["max-fraction-digits"],1,Nt),!F)?null:new gf(p,w,E,M,k,F)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class _f{constructor(o){this.type=Nt,this.input=o}static parse(o,l){if(2!==o.length)return l.error(`Expected 1 argument, but found ${o.length-1} instead.`);const p=l.parse(o[1],1);return p?"array"!==p.type.kind&&"string"!==p.type.kind&&"value"!==p.type.kind?l.error(`Expected argument of type string or array, but found ${ji(p.type)} instead.`):new _f(p):null}evaluate(o){const l=this.input.evaluate(o);if("string"==typeof l||Array.isArray(l))return l.length;throw new zr(`Expected value to be of type string or array, but found ${ji(Ji(l))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(l=>{o.push(l.serialize())}),o}}const yf={"==":Dp,"!=":Gm,">":mf,"<":Ap,">=":Hm,"<=":Pp,array:$s,at:T_,boolean:$s,case:Sp,coalesce:Qa,collator:df,format:Tl,image:uf,in:Xo,"index-of":Ip,interpolate:Xa,"interpolate-hcl":Xa,"interpolate-lab":Xa,length:_f,let:uh,literal:js,match:Ja,number:$s,"number-format":gf,object:$s,slice:Mp,step:la,string:$s,"to-boolean":yd,"to-color":yd,"to-number":yd,"to-string":yd,var:to,within:Il};function I_(a,[o,l,p,y]){o=o.evaluate(a),l=l.evaluate(a),p=p.evaluate(a);const w=y?y.evaluate(a):1,E=Um(o,l,p,w);if(E)throw new zr(E);return new Jr(o/255*w,l/255*w,p/255*w,w)}function qm(a,o){return a in o}function bs(a,o){const l=o[a];return void 0===l?null:l}function Os(a){return{type:a}}Su.register(yf,{error:[{kind:"error"},[ri],(a,[o])=>{throw new zr(o.evaluate(a))}],typeof:[ri,[Gn],(a,[o])=>ji(Ji(o.evaluate(a)))],"to-rgba":[Vo(Nt,4),[ur],(a,[o])=>o.evaluate(a).toArray()],rgb:[ur,[Nt,Nt,Nt],I_],rgba:[ur,[Nt,Nt,Nt,Nt],I_],has:{type:_i,overloads:[[[ri],(a,[o])=>qm(o.evaluate(a),a.properties())],[[ri,Ps],(a,[o,l])=>qm(o.evaluate(a),l.evaluate(a))]]},get:{type:Gn,overloads:[[[ri],(a,[o])=>bs(o.evaluate(a),a.properties())],[[ri,Ps],(a,[o,l])=>bs(o.evaluate(a),l.evaluate(a))]]},"feature-state":[Gn,[ri],(a,[o])=>bs(o.evaluate(a),a.featureState||{})],properties:[Ps,[],a=>a.properties()],"geometry-type":[ri,[],a=>a.geometryType()],id:[Gn,[],a=>a.id()],zoom:[Nt,[],a=>a.globals.zoom],pitch:[Nt,[],a=>a.globals.pitch||0],"distance-from-center":[Nt,[],a=>a.distanceFromCenter()],"heatmap-density":[Nt,[],a=>a.globals.heatmapDensity||0],"line-progress":[Nt,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[Nt,[],a=>a.globals.skyRadialProgress||0],accumulated:[Gn,[],a=>void 0===a.globals.accumulated?null:a.globals.accumulated],"+":[Nt,Os(Nt),(a,o)=>{let l=0;for(const p of o)l+=p.evaluate(a);return l}],"*":[Nt,Os(Nt),(a,o)=>{let l=1;for(const p of o)l*=p.evaluate(a);return l}],"-":{type:Nt,overloads:[[[Nt,Nt],(a,[o,l])=>o.evaluate(a)-l.evaluate(a)],[[Nt],(a,[o])=>-o.evaluate(a)]]},"/":[Nt,[Nt,Nt],(a,[o,l])=>o.evaluate(a)/l.evaluate(a)],"%":[Nt,[Nt,Nt],(a,[o,l])=>o.evaluate(a)%l.evaluate(a)],ln2:[Nt,[],()=>Math.LN2],pi:[Nt,[],()=>Math.PI],e:[Nt,[],()=>Math.E],"^":[Nt,[Nt,Nt],(a,[o,l])=>Math.pow(o.evaluate(a),l.evaluate(a))],sqrt:[Nt,[Nt],(a,[o])=>Math.sqrt(o.evaluate(a))],log10:[Nt,[Nt],(a,[o])=>Math.log(o.evaluate(a))/Math.LN10],ln:[Nt,[Nt],(a,[o])=>Math.log(o.evaluate(a))],log2:[Nt,[Nt],(a,[o])=>Math.log(o.evaluate(a))/Math.LN2],sin:[Nt,[Nt],(a,[o])=>Math.sin(o.evaluate(a))],cos:[Nt,[Nt],(a,[o])=>Math.cos(o.evaluate(a))],tan:[Nt,[Nt],(a,[o])=>Math.tan(o.evaluate(a))],asin:[Nt,[Nt],(a,[o])=>Math.asin(o.evaluate(a))],acos:[Nt,[Nt],(a,[o])=>Math.acos(o.evaluate(a))],atan:[Nt,[Nt],(a,[o])=>Math.atan(o.evaluate(a))],min:[Nt,Os(Nt),(a,o)=>Math.min(...o.map(l=>l.evaluate(a)))],max:[Nt,Os(Nt),(a,o)=>Math.max(...o.map(l=>l.evaluate(a)))],abs:[Nt,[Nt],(a,[o])=>Math.abs(o.evaluate(a))],round:[Nt,[Nt],(a,[o])=>{const l=o.evaluate(a);return l<0?-Math.round(-l):Math.round(l)}],floor:[Nt,[Nt],(a,[o])=>Math.floor(o.evaluate(a))],ceil:[Nt,[Nt],(a,[o])=>Math.ceil(o.evaluate(a))],"filter-==":[_i,[ri,Gn],(a,[o,l])=>a.properties()[o.value]===l.value],"filter-id-==":[_i,[Gn],(a,[o])=>a.id()===o.value],"filter-type-==":[_i,[ri],(a,[o])=>a.geometryType()===o.value],"filter-<":[_i,[ri,Gn],(a,[o,l])=>{const p=a.properties()[o.value],y=l.value;return typeof p==typeof y&&p<y}],"filter-id-<":[_i,[Gn],(a,[o])=>{const l=a.id(),p=o.value;return typeof l==typeof p&&l<p}],"filter->":[_i,[ri,Gn],(a,[o,l])=>{const p=a.properties()[o.value],y=l.value;return typeof p==typeof y&&p>y}],"filter-id->":[_i,[Gn],(a,[o])=>{const l=a.id(),p=o.value;return typeof l==typeof p&&l>p}],"filter-<=":[_i,[ri,Gn],(a,[o,l])=>{const p=a.properties()[o.value],y=l.value;return typeof p==typeof y&&p<=y}],"filter-id-<=":[_i,[Gn],(a,[o])=>{const l=a.id(),p=o.value;return typeof l==typeof p&&l<=p}],"filter->=":[_i,[ri,Gn],(a,[o,l])=>{const p=a.properties()[o.value],y=l.value;return typeof p==typeof y&&p>=y}],"filter-id->=":[_i,[Gn],(a,[o])=>{const l=a.id(),p=o.value;return typeof l==typeof p&&l>=p}],"filter-has":[_i,[Gn],(a,[o])=>o.value in a.properties()],"filter-has-id":[_i,[],a=>null!==a.id()&&void 0!==a.id()],"filter-type-in":[_i,[Vo(ri)],(a,[o])=>o.value.indexOf(a.geometryType())>=0],"filter-id-in":[_i,[Vo(Gn)],(a,[o])=>o.value.indexOf(a.id())>=0],"filter-in-small":[_i,[ri,Vo(Gn)],(a,[o,l])=>l.value.indexOf(a.properties()[o.value])>=0],"filter-in-large":[_i,[ri,Vo(Gn)],(a,[o,l])=>function(p,y,w,E){for(;w<=E;){const M=w+E>>1;if(y[M]===p)return!0;y[M]>p?E=M-1:w=M+1}return!1}(a.properties()[o.value],l.value,0,l.value.length-1)],all:{type:_i,overloads:[[[_i,_i],(a,[o,l])=>o.evaluate(a)&&l.evaluate(a)],[Os(_i),(a,o)=>{for(const l of o)if(!l.evaluate(a))return!1;return!0}]]},any:{type:_i,overloads:[[[_i,_i],(a,[o,l])=>o.evaluate(a)||l.evaluate(a)],[Os(_i),(a,o)=>{for(const l of o)if(l.evaluate(a))return!0;return!1}]]},"!":[_i,[_i],(a,[o])=>!o.evaluate(a)],"is-supported-script":[_i,[ri],(a,[o])=>{const l=a.globals&&a.globals.isSupportedScript;return!l||l(o.evaluate(a))}],upcase:[ri,[ri],(a,[o])=>o.evaluate(a).toUpperCase()],downcase:[ri,[ri],(a,[o])=>o.evaluate(a).toLowerCase()],concat:[ri,Os(Gn),(a,o)=>o.map(l=>Lc(l.evaluate(a))).join("")],"resolved-locale":[ri,[Bo],(a,[o])=>o.evaluate(a).resolvedLocale()]});var pr=yf;function Wc(a){return{result:"success",value:a}}function Td(a){return{result:"error",value:a}}function Lu(a){return"data-driven"===a["property-type"]}function lc(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Op(a){return!!a.expression&&a.expression.interpolated}function qi(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function Nu(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function Id(a){return a}function cc(a,o){const l="color"===o.type,p=a.stops&&"object"==typeof a.stops[0][0],y=p||!(p||void 0!==a.property),w=a.type||(Op(o)?"exponential":"interval");if(l&&((a=Ao({},a)).stops&&(a.stops=a.stops.map(F=>[F[0],Jr.parse(F[1])])),a.default=Jr.parse(a.default?a.default:o.default)),a.colorSpace&&"rgb"!==a.colorSpace&&!Tp[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let E,M,k;if("exponential"===w)E=ua;else if("interval"===w)E=vf;else if("categorical"===w){E=Da,M=Object.create(null);for(const F of a.stops)M[F[0]]=F[1];k=typeof a.stops[0][0]}else{if("identity"!==w)throw new Error(`Unknown function type "${w}"`);E=zu}if(p){const F={},U=[];for(let te=0;te<a.stops.length;te++){const ie=a.stops[te],K=ie[0].zoom;void 0===F[K]&&(F[K]={zoom:K,type:a.type,property:a.property,default:a.default,stops:[]},U.push(K)),F[K].stops.push([ie[0].value,ie[1]])}const z=[];for(const te of U)z.push([F[te].zoom,cc(F[te],o)]);const Z={name:"linear"};return{kind:"composite",interpolationType:Z,interpolationFactor:Xa.interpolationFactor.bind(void 0,Z),zoomStops:z.map(te=>te[0]),evaluate:({zoom:te},ie)=>ua({stops:z,base:a.base},o,te).evaluate(te,ie)}}if(y){const F="exponential"===w?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:Xa.interpolationFactor.bind(void 0,F),zoomStops:a.stops.map(U=>U[0]),evaluate:({zoom:U})=>E(a,o,U,M,k)}}return{kind:"source",evaluate(F,U){const z=U&&U.properties?U.properties[a.property]:void 0;return void 0===z?Al(a.default,o.default):E(a,o,z,M,k)}}}function Al(a,o,l){return void 0!==a?a:void 0!==o?o:void 0!==l?l:void 0}function Da(a,o,l,p,y){return Al(typeof l===y?p[l]:void 0,a.default,o.default)}function vf(a,o,l){if("number"!==qi(l))return Al(a.default,o.default);const p=a.stops.length;if(1===p||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[p-1][0])return a.stops[p-1][1];const y=jc(a.stops.map(w=>w[0]),l);return a.stops[y][1]}function ua(a,o,l){const p=void 0!==a.base?a.base:1;if("number"!==qi(l))return Al(a.default,o.default);const y=a.stops.length;if(1===y||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[y-1][0])return a.stops[y-1][1];const w=jc(a.stops.map(U=>U[0]),l),E=function(U,z,Z,te){const ie=te-Z,K=U-Z;return 0===ie?0:1===z?K/ie:(Math.pow(z,K)-1)/(Math.pow(z,ie)-1)}(l,p,a.stops[w][0],a.stops[w+1][0]),M=a.stops[w][1],k=a.stops[w+1][1];let F=$c[o.type]||Id;if(a.colorSpace&&"rgb"!==a.colorSpace){const U=Tp[a.colorSpace];F=(z,Z)=>U.reverse(U.interpolate(U.forward(z),U.forward(Z),E))}return"function"==typeof M.evaluate?{evaluate(...U){const z=M.evaluate.apply(void 0,U),Z=k.evaluate.apply(void 0,U);if(void 0!==z&&void 0!==Z)return F(z,Z,E)}}:F(M,k,E)}function zu(a,o,l){return"color"===o.type?l=Jr.parse(l):"formatted"===o.type?l=xo.fromString(l.toString()):"resolvedImage"===o.type?l=Cr.fromString(l.toString()):qi(l)===o.type||"enum"===o.type&&o.values[l]||(l=void 0),Al(l,a.default,o.default)}class Sd{constructor(o,l){var p;this.expression=o,this._warningHistory={},this._evaluator=new Iu,this._defaultValue=l?"color"===(p=l).type&&(Nu(p.default)||Array.isArray(p.default))?new Jr(0,0,0,0):"color"===p.type?Jr.parse(p.default)||null:void 0===p.default?null:p.default:null,this._enumValues=l&&"enum"===l.type?l.values:null}evaluateWithoutErrorHandling(o,l,p,y,w,E,M,k){return this._evaluator.globals=o,this._evaluator.feature=l,this._evaluator.featureState=p,this._evaluator.canonical=y||null,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=E,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=k||null,this.expression.evaluate(this._evaluator)}evaluate(o,l,p,y,w,E,M,k){this._evaluator.globals=o,this._evaluator.feature=l||null,this._evaluator.featureState=p||null,this._evaluator.canonical=y||null,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=E||null,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=k||null;try{const F=this.expression.evaluate(this._evaluator);if(null==F||"number"==typeof F&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new zr(`Expected value to be one of ${Object.keys(this._enumValues).map(U=>JSON.stringify(U)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,typeof console<"u"&&console.warn(F.message)),this._defaultValue}}}function fh(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in pr}function Pl(a,o){const l=new Sl(pr,[],o?function(y){const w={color:ur,string:ri,number:Nt,enum:ri,boolean:_i,formatted:Cl,resolvedImage:bi};return"array"===y.type?Vo(w[y.value]||Gn,y.length):w[y.type]}(o):void 0),p=l.parse(a,void 0,void 0,void 0,o&&"string"===o.type?{typeAnnotation:"coerce"}:void 0);return p?Wc(new Sd(p,o)):Td(l.errors)}class kp{constructor(o,l){this.kind=o,this._styleExpression=l,this.isStateDependent="constant"!==o&&!Ko(l.expression)}evaluateWithoutErrorHandling(o,l,p,y,w,E){return this._styleExpression.evaluateWithoutErrorHandling(o,l,p,y,w,E)}evaluate(o,l,p,y,w,E){return this._styleExpression.evaluate(o,l,p,y,w,E)}}class Ol{constructor(o,l,p,y){this.kind=o,this.zoomStops=p,this._styleExpression=l,this.isStateDependent="camera"!==o&&!Ko(l.expression),this.interpolationType=y}evaluateWithoutErrorHandling(o,l,p,y,w,E){return this._styleExpression.evaluateWithoutErrorHandling(o,l,p,y,w,E)}evaluate(o,l,p,y,w,E){return this._styleExpression.evaluate(o,l,p,y,w,E)}interpolationFactor(o,l,p){return this.interpolationType?Xa.interpolationFactor(this.interpolationType,o,l,p):0}}function el(a,o){if("error"===(a=Pl(a,o)).result)return a;const l=a.value.expression,p=Vc(l);if(!p&&!Lu(o))return Td([new us("","data expressions not supported")]);const y=Au(l,["zoom","pitch","distance-from-center"]);if(!y&&!lc(o))return Td([new us("","zoom expressions not supported")]);const w=kl(l);return w||y?w instanceof us?Td([w]):w instanceof Xa&&!Op(o)?Td([new us("",'"interpolate" expressions cannot be used with this property')]):Wc(w?new Ol(p?"camera":"composite",a.value,w.labels,w instanceof Xa?w.interpolation:void 0):new kp(p?"constant":"source",a.value)):Td([new us("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Zc{constructor(o,l){this._parameters=o,this._specification=l,Ao(this,cc(this._parameters,this._specification))}static deserialize(o){return new Zc(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function kl(a){let o=null;if(a instanceof uh)o=kl(a.result);else if(a instanceof Qa){for(const l of a.args)if(o=kl(l),o)break}else(a instanceof la||a instanceof Xa)&&a.input instanceof Su&&"zoom"===a.input.name&&(o=a);return o instanceof us||a.eachChild(l=>{const p=kl(l);p instanceof us?o=p:!o&&p?o=new us("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&p&&o!==p&&(o=new us("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}class hn{constructor(o,l,p,y){this.message=(o?`${o}: `:"")+p,y&&(this.identifier=y),null!=l&&l.__line__&&(this.line=l.__line__)}}function or(a){const o=a.key,l=a.value,p=a.valueSpec||{},y=a.objectElementValidators||{},w=a.style,E=a.styleSpec;let M=[];const k=qi(l);if("object"!==k)return[new hn(o,l,`object expected, ${k} found`)];for(const F in l){const U=F.split(".")[0];let Z;y[U]?Z=y[U]:p[U]?Z=Co:y["*"]?Z=y["*"]:p["*"]&&(Z=Co),Z?M=M.concat(Z({key:(o&&`${o}.`)+F,value:l[F],valueSpec:p[U]||p["*"],style:w,styleSpec:E,object:l,objectKey:F},l)):M.push(new hn(o,l[F],`unknown property "${F}"`))}for(const F in p)y[F]||p[F].required&&void 0===p[F].default&&void 0===l[F]&&M.push(new hn(o,l,`missing required property "${F}"`));return M}function Md(a){const o=a.value,l=a.valueSpec,p=a.style,y=a.styleSpec,w=a.key,E=a.arrayElementValidator||Co;if("array"!==qi(o))return[new hn(w,o,`array expected, ${qi(o)} found`)];if(l.length&&o.length!==l.length)return[new hn(w,o,`array length ${l.length} expected, length ${o.length} found`)];if(l["min-length"]&&o.length<l["min-length"])return[new hn(w,o,`array length at least ${l["min-length"]} expected, length ${o.length} found`)];let M={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};y.$version<7&&(M.function=l.function),"object"===qi(l.value)&&(M=l.value);let k=[];for(let F=0;F<o.length;F++)k=k.concat(E({array:o,arrayIndex:F,value:o[F],valueSpec:M,style:p,styleSpec:y,key:`${w}[${F}]`}));return k}function Aa(a){const o=a.key,l=a.value,p=a.valueSpec;let y=qi(l);if("number"===y&&l!=l&&(y="NaN"),"number"!==y)return[new hn(o,l,`number expected, ${y} found`)];if("minimum"in p){let w=p.minimum;if("array"===qi(p.minimum)&&(w=p.minimum[a.arrayIndex]),l<w)return[new hn(o,l,`${l} is less than the minimum value ${w}`)]}if("maximum"in p){let w=p.maximum;if("array"===qi(p.maximum)&&(w=p.maximum[a.arrayIndex]),l>w)return[new hn(o,l,`${l} is greater than the maximum value ${w}`)]}return[]}function Yc(a){const o=a.valueSpec,l=cr(a.value.type);let p,y,w,E={};const M="categorical"!==l&&void 0===a.value.property,k=!M,F="array"===qi(a.value.stops)&&"array"===qi(a.value.stops[0])&&"object"===qi(a.value.stops[0][0]),U=or({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(te){if("identity"===l)return[new hn(te.key,te.value,'identity function may not have a "stops" property')];let ie=[];const K=te.value;return ie=ie.concat(Md({key:te.key,value:K,valueSpec:te.valueSpec,style:te.style,styleSpec:te.styleSpec,arrayElementValidator:z})),"array"===qi(K)&&0===K.length&&ie.push(new hn(te.key,K,"array must have at least one stop")),ie},default:function(te){return Co({key:te.key,value:te.value,valueSpec:o,style:te.style,styleSpec:te.styleSpec})}}});return"identity"===l&&M&&U.push(new hn(a.key,a.value,'missing required property "property"')),"identity"===l||a.value.stops||U.push(new hn(a.key,a.value,'missing required property "stops"')),"exponential"===l&&a.valueSpec.expression&&!Op(a.valueSpec)&&U.push(new hn(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(k&&!Lu(a.valueSpec)?U.push(new hn(a.key,a.value,"property functions not supported")):M&&!lc(a.valueSpec)&&U.push(new hn(a.key,a.value,"zoom functions not supported"))),"categorical"!==l&&!F||void 0!==a.value.property||U.push(new hn(a.key,a.value,'"property" property is required')),U;function z(te){let ie=[];const K=te.value,pe=te.key;if("array"!==qi(K))return[new hn(pe,K,`array expected, ${qi(K)} found`)];if(2!==K.length)return[new hn(pe,K,`array length 2 expected, length ${K.length} found`)];if(F){if("object"!==qi(K[0]))return[new hn(pe,K,`object expected, ${qi(K[0])} found`)];if(void 0===K[0].zoom)return[new hn(pe,K,"object stop key must have zoom")];if(void 0===K[0].value)return[new hn(pe,K,"object stop key must have value")];const Ee=cr(K[0].zoom);if("number"!=typeof Ee)return[new hn(pe,K[0].zoom,"stop zoom values must be numbers")];if(w&&w>Ee)return[new hn(pe,K[0].zoom,"stop zoom values must appear in ascending order")];Ee!==w&&(w=Ee,y=void 0,E={}),ie=ie.concat(or({key:`${pe}[0]`,value:K[0],valueSpec:{zoom:{}},style:te.style,styleSpec:te.styleSpec,objectElementValidators:{zoom:Aa,value:Z}}))}else ie=ie.concat(Z({key:`${pe}[0]`,value:K[0],valueSpec:{},style:te.style,styleSpec:te.styleSpec},K));return fh(Ya(K[1]))?ie.concat([new hn(`${pe}[1]`,K[1],"expressions are not allowed in function stops.")]):ie.concat(Co({key:`${pe}[1]`,value:K[1],valueSpec:o,style:te.style,styleSpec:te.styleSpec}))}function Z(te,ie){const K=qi(te.value),pe=cr(te.value),Ee=null!==te.value?te.value:ie;if(p){if(K!==p)return[new hn(te.key,Ee,`${K} stop domain type must match previous stop domain type ${p}`)]}else p=K;if("number"!==K&&"string"!==K&&"boolean"!==K&&"number"!=typeof pe&&"string"!=typeof pe&&"boolean"!=typeof pe)return[new hn(te.key,Ee,"stop domain value must be a number, string, or boolean")];if("number"!==K&&"categorical"!==l){let xe=`number expected, ${K} found`;return Lu(o)&&void 0===l&&(xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new hn(te.key,Ee,xe)]}return"categorical"!==l||"number"!==K||"number"==typeof pe&&isFinite(pe)&&Math.floor(pe)===pe?"categorical"!==l&&"number"===K&&"number"==typeof pe&&"number"==typeof y&&void 0!==y&&pe<y?[new hn(te.key,Ee,"stop domain values must appear in ascending order")]:(y=pe,"categorical"===l&&pe in E?[new hn(te.key,Ee,"stop domain values must be unique")]:(E[pe]=!0,[])):[new hn(te.key,Ee,`integer expected, found ${String(pe)}`)]}}function tl(a){const o=("property"===a.expressionContext?el:Pl)(Ya(a.value),a.valueSpec);if("error"===o.result)return o.value.map(p=>new hn(`${a.key}${p.key}`,a.value,p.message));const l=o.value.expression||o.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!l.outputDefined())return[new hn(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===a.expressionContext&&"layout"===a.propertyType&&!Ko(l))return[new hn(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext)return Dd(l,a);if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!Au(l,["zoom","feature-state"]))return[new hn(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!Vc(l))return[new hn(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Dd(a,o){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const y of o.valueSpec.expression.parameters)l.delete(y);if(0===l.size)return[];const p=[];return a instanceof Su&&l.has(a.name)?[new hn(o.key,o.value,`["${a.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(a.eachChild(y=>{p.push(...Dd(y,o))}),p)}function ph(a){const o=a.key,l=a.value,p=a.valueSpec,y=[];return Array.isArray(p.values)?-1===p.values.indexOf(cr(l))&&y.push(new hn(o,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):-1===Object.keys(p.values).indexOf(cr(l))&&y.push(new hn(o,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),y}function Kc(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const o of a.slice(1))if(!Kc(o)&&"boolean"!=typeof o)return!1;return!0;default:return!0}}function Xc(a,o="fill"){if(null==a)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Kc(a)||(a=Pd(a));const l=a;let p=!0;try{p=function(F){if(!qr(F))return F;let U=Ya(F);return Ad(U),U=Pa(U),U}(l)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(l,null,2)}\n        `)}const y=ut[`filter_${o}`],w=Pl(p,y);let E=null;if("error"===w.result)throw new Error(w.value.map(F=>`${F.key}: ${F.message}`).join(", "));E=(F,U,z)=>w.value.evaluate(F,U,{},z);let M=null,k=null;if(p!==l){const F=Pl(l,y);if("error"===F.result)throw new Error(F.value.map(U=>`${U.key}: ${U.message}`).join(", "));M=(U,z,Z,te,ie)=>F.value.evaluate(U,z,{},Z,void 0,void 0,te,ie),k=!Vc(F.value.expression)}return{filter:E,dynamicFilter:M||void 0,needGeometry:ks(p),needFeature:!!k}}function Pa(a){if(!Array.isArray(a))return a;const o=function(l){if(Rl.has(l[0]))for(let p=1;p<l.length;p++)if(qr(l[p]))return!0;return l}(a);return!0===o?o:o.map(l=>Pa(l))}function Ad(a){let o=!1;const l=[];if("case"===a[0]){for(let p=1;p<a.length-1;p+=2)o=o||qr(a[p]),l.push(a[p+1]);l.push(a[a.length-1])}else if("match"===a[0]){o=o||qr(a[1]);for(let p=2;p<a.length-1;p+=2)l.push(a[p+1]);l.push(a[a.length-1])}else if("step"===a[0]){o=o||qr(a[1]);for(let p=1;p<a.length-1;p+=2)l.push(a[p+1])}o&&(a.length=0,a.push("any",...l));for(let p=1;p<a.length;p++)Ad(a[p])}function qr(a){if(!Array.isArray(a))return!1;if("pitch"===(o=a[0])||"distance-from-center"===o)return!0;var o;for(let l=1;l<a.length;l++)if(qr(a[l]))return!0;return!1}const Rl=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function mh(a,o){return a<o?-1:a>o?1:0}function ks(a){if(!Array.isArray(a))return!1;if("within"===a[0])return!0;for(let o=1;o<a.length;o++)if(ks(a[o]))return!0;return!1}function Pd(a){if(!a)return!0;const o=a[0];return a.length<=1?"any"!==o:"=="===o?Fl(a[1],a[2],"=="):"!="===o?Oa(Fl(a[1],a[2],"==")):"<"===o||">"===o||"<="===o||">="===o?Fl(a[1],a[2],o):"any"===o?(l=a.slice(1),["any"].concat(l.map(Pd))):"all"===o?["all"].concat(a.slice(1).map(Pd)):"none"===o?["all"].concat(a.slice(1).map(Pd).map(Oa)):"in"===o?Qc(a[1],a.slice(2)):"!in"===o?Oa(Qc(a[1],a.slice(2))):"has"===o?Od(a[1]):"!has"===o?Oa(Od(a[1])):"within"!==o||a;var l}function Fl(a,o,l){switch(a){case"$type":return[`filter-type-${l}`,o];case"$id":return[`filter-id-${l}`,o];default:return[`filter-${l}`,a,o]}}function Qc(a,o){if(0===o.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(l=>typeof l!=typeof o[0])?["filter-in-large",a,["literal",o.sort(mh)]]:["filter-in-small",a,["literal",o]]}}function Od(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Oa(a){return["!",a]}function Bu(a){return Kc(Ya(a.value))?tl(Ao({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):Rp(a)}function Rp(a){const o=a.value,l=a.key;if("array"!==qi(o))return[new hn(l,o,`array expected, ${qi(o)} found`)];const p=a.styleSpec;let y,w=[];if(o.length<1)return[new hn(l,o,"filter array must have at least 1 element")];switch(w=w.concat(ph({key:`${l}[0]`,value:o[0],valueSpec:p.filter_operator,style:a.style,styleSpec:a.styleSpec})),cr(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&"$type"===cr(o[1])&&w.push(new hn(l,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":3!==o.length&&w.push(new hn(l,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(y=qi(o[1]),"string"!==y&&w.push(new hn(`${l}[1]`,o[1],`string expected, ${y} found`)));for(let E=2;E<o.length;E++)y=qi(o[E]),"$type"===cr(o[1])?w=w.concat(ph({key:`${l}[${E}]`,value:o[E],valueSpec:p.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==y&&"number"!==y&&"boolean"!==y&&w.push(new hn(`${l}[${E}]`,o[E],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let E=1;E<o.length;E++)w=w.concat(Rp({key:`${l}[${E}]`,value:o[E],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":y=qi(o[1]),2!==o.length?w.push(new hn(l,o,`filter array for "${o[0]}" operator must have 2 elements`)):"string"!==y&&w.push(new hn(`${l}[1]`,o[1],`string expected, ${y} found`));break;case"within":y=qi(o[1]),2!==o.length?w.push(new hn(l,o,`filter array for "${o[0]}" operator must have 2 elements`)):"object"!==y&&w.push(new hn(`${l}[1]`,o[1],`object expected, ${y} found`))}return w}function kd(a,o){const l=a.key,p=a.style,y=a.styleSpec,w=a.value,E=a.objectKey,M=y[`${o}_${a.layerType}`];if(!M)return[];const k=E.match(/^(.*)-transition$/);if("paint"===o&&k&&M[k[1]]&&M[k[1]].transition)return Co({key:l,value:w,valueSpec:y.transition,style:p,styleSpec:y});const F=a.valueSpec||M[E];if(!F)return[new hn(l,w,`unknown property "${E}"`)];let U;if("string"===qi(w)&&Lu(F)&&!F.tokens&&(U=/^{([^}]+)}$/.exec(w)))return[new hn(l,w,`"${E}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(U[1])} }\`.`)];const z=[];return"symbol"===a.layerType&&("text-field"===E&&p&&!p.glyphs&&z.push(new hn(l,w,'use of "text-field" requires a style "glyphs" property')),"text-font"===E&&Nu(Ya(w))&&"identity"===cr(w.type)&&z.push(new hn(l,w,'"text-font" does not support identity functions'))),z.concat(Co({key:a.key,value:w,valueSpec:F,style:p,styleSpec:y,expressionContext:"property",propertyType:o,propertyKey:E}))}function gh(a){return kd(a,"paint")}function _h(a){return kd(a,"layout")}function yh(a){let o=[];const l=a.value,p=a.key,y=a.style,w=a.styleSpec;l.type||l.ref||o.push(new hn(p,l,'either "type" or "ref" is required'));let E=cr(l.type);const M=cr(l.ref);if(l.id){const k=cr(l.id);for(let F=0;F<a.arrayIndex;F++){const U=y.layers[F];cr(U.id)===k&&o.push(new hn(p,l.id,`duplicate layer id "${l.id}", previously used at line ${U.id.__line__}`))}}if("ref"in l){let k;["type","source","source-layer","filter","layout"].forEach(F=>{F in l&&o.push(new hn(p,l[F],`"${F}" is prohibited for ref layers`))}),y.layers.forEach(F=>{cr(F.id)===M&&(k=F)}),k?k.ref?o.push(new hn(p,l.ref,"ref cannot reference another ref layer")):E=cr(k.type):"string"==typeof M&&o.push(new hn(p,l.ref,`ref layer "${M}" not found`))}else if("background"!==E&&"sky"!==E)if(l.source){const k=y.sources&&y.sources[l.source],F=k&&cr(k.type);k?"vector"===F&&"raster"===E?o.push(new hn(p,l.source,`layer "${l.id}" requires a raster source`)):"raster"===F&&"raster"!==E?o.push(new hn(p,l.source,`layer "${l.id}" requires a vector source`)):"vector"!==F||l["source-layer"]?"raster-dem"===F&&"hillshade"!==E?o.push(new hn(p,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==E||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||"geojson"===F&&k.lineMetrics||o.push(new hn(p,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new hn(p,l,`layer "${l.id}" must specify a "source-layer"`)):o.push(new hn(p,l.source,`source "${l.source}" not found`))}else o.push(new hn(p,l,'missing required property "source"'));return o=o.concat(or({key:p,value:l,valueSpec:w.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Co({key:`${p}.type`,value:l.type,valueSpec:w.layer.type,style:a.style,styleSpec:a.styleSpec,object:l,objectKey:"type"}),filter:k=>Bu(Ao({layerType:E},k)),layout:k=>or({layer:l,key:k.key,value:k.value,valueSpec:{},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{"*":F=>_h(Ao({layerType:E},F))}}),paint:k=>or({layer:l,key:k.key,value:k.value,valueSpec:{},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{"*":F=>gh(Ao({layerType:E},F))}})}})),o}function uc(a){const o=a.value,l=a.key,p=qi(o);return"string"!==p?[new hn(l,o,`string expected, ${p} found`)]:[]}const Vu={promoteId:function({key:a,value:o}){if("string"===qi(o))return uc({key:a,value:o});{const l=[];for(const p in o)l.push(...uc({key:`${a}.${p}`,value:o[p]}));return l}}};function da(a){const o=a.value,l=a.key,p=a.styleSpec,y=a.style;if(!o.type)return[new hn(l,o,'"type" is required')];const w=cr(o.type);let E;switch(w){case"vector":case"raster":case"raster-dem":return E=or({key:l,value:o,valueSpec:p[`source_${w.replace("-","_")}`],style:a.style,styleSpec:p,objectElementValidators:Vu}),E;case"geojson":if(E=or({key:l,value:o,valueSpec:p.source_geojson,style:y,styleSpec:p,objectElementValidators:Vu}),o.cluster)for(const M in o.clusterProperties){const[k,F]=o.clusterProperties[M],U="string"==typeof k?[k,["accumulated"],["get",M]]:k;E.push(...tl({key:`${l}.${M}.map`,value:F,expressionContext:"cluster-map"})),E.push(...tl({key:`${l}.${M}.reduce`,value:U,expressionContext:"cluster-reduce"}))}return E;case"video":return or({key:l,value:o,valueSpec:p.source_video,style:y,styleSpec:p});case"image":return or({key:l,value:o,valueSpec:p.source_image,style:y,styleSpec:p});case"canvas":return[new hn(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ph({key:`${l}.type`,value:o.type,valueSpec:{values:bf(p)},style:y,styleSpec:p})}}function bf(a){return a.source.reduce((o,l)=>{const p=a[l];return"enum"===p.type.type&&(o=o.concat(Object.keys(p.type.values))),o},[])}function xf(a){const o=a.value,l=a.styleSpec,p=l.light,y=a.style;let w=[];const E=qi(o);if(void 0===o)return w;if("object"!==E)return w=w.concat([new hn("light",o,`object expected, ${E} found`)]),w;for(const M in o){const k=M.match(/^(.*)-transition$/);w=w.concat(k&&p[k[1]]&&p[k[1]].transition?Co({key:M,value:o[M],valueSpec:l.transition,style:y,styleSpec:l}):p[M]?Co({key:M,value:o[M],valueSpec:p[M],style:y,styleSpec:l}):[new hn(M,o[M],`unknown property "${M}"`)])}return w}function Rd(a){const o=a.value,l=a.key,p=a.style,y=a.styleSpec,w=y.terrain;let E=[];const M=qi(o);if(void 0===o)return E;if("object"!==M)return E=E.concat([new hn("terrain",o,`object expected, ${M} found`)]),E;for(const k in o){const F=k.match(/^(.*)-transition$/);E=E.concat(F&&w[F[1]]&&w[F[1]].transition?Co({key:k,value:o[k],valueSpec:y.transition,style:p,styleSpec:y}):w[k]?Co({key:k,value:o[k],valueSpec:w[k],style:p,styleSpec:y}):[new hn(k,o[k],`unknown property "${k}"`)])}if(o.source){const k=p.sources&&p.sources[o.source],F=k&&cr(k.type);k?"raster-dem"!==F&&E.push(new hn(l,o.source,`terrain cannot be used with a source of type ${String(F)}, it only be used with a "raster-dem" source type`)):E.push(new hn(l,o.source,`source "${o.source}" not found`))}else E.push(new hn(l,o,'terrain is missing required property "source"'));return E}function Jc(a){const o=a.value,l=a.style,p=a.styleSpec,y=p.fog;let w=[];const E=qi(o);if(void 0===o)return w;if("object"!==E)return w=w.concat([new hn("fog",o,`object expected, ${E} found`)]),w;for(const M in o){const k=M.match(/^(.*)-transition$/);w=w.concat(k&&y[k[1]]&&y[k[1]].transition?Co({key:M,value:o[M],valueSpec:p.transition,style:l,styleSpec:p}):y[M]?Co({key:M,value:o[M],valueSpec:y[M],style:l,styleSpec:p}):[new hn(M,o[M],`unknown property "${M}"`)])}return w}const vh={"*":()=>[],array:Md,boolean:function(a){const o=a.value,l=a.key,p=qi(o);return"boolean"!==p?[new hn(l,o,`boolean expected, ${p} found`)]:[]},number:Aa,color:function(a){const o=a.key,l=a.value,p=qi(l);return"string"!==p?[new hn(o,l,`color expected, ${p} found`)]:null===sa(l)?[new hn(o,l,`color expected, "${l}" found`)]:[]},enum:ph,filter:Bu,function:Yc,layer:yh,object:or,source:da,light:xf,terrain:Rd,fog:Jc,string:uc,formatted:function(a){return 0===uc(a).length?[]:tl(a)},resolvedImage:function(a){return 0===uc(a).length?[]:tl(a)},projection:function(a){const o=a.value,l=a.styleSpec,p=l.projection,y=a.style;let w=[];const E=qi(o);if("object"===E)for(const M in o)w=w.concat(Co({key:M,value:o[M],valueSpec:p[M],style:y,styleSpec:l}));else"string"!==E&&(w=w.concat([new hn("projection",o,`object or string expected, ${E} found`)]));return w}};function Co(a){const o=a.value,l=a.valueSpec,p=a.styleSpec;return l.expression&&Nu(cr(o))?Yc(a):l.expression&&fh(Ya(o))?tl(a):l.type&&vh[l.type]?vh[l.type](a):or(Ao({},a,{valueSpec:l.type?p[l.type]:l}))}function wf(a){const o=a.value,l=a.key,p=uc(a);return p.length||(-1===o.indexOf("{fontstack}")&&p.push(new hn(l,o,'"glyphs" url must include a "{fontstack}" token')),-1===o.indexOf("{range}")&&p.push(new hn(l,o,'"glyphs" url must include a "{range}" token'))),p}function Cf(a,o=ut){return Rs(Co({key:"",value:a,valueSpec:o.$root,styleSpec:o,style:a,objectElementValidators:{glyphs:wf,"*":()=>[]}}))}const Ef=a=>Rs(gh(a)),eu=a=>Rs(_h(a));function Rs(a){return a.slice().sort((o,l)=>o.line&&l.line?o.line-l.line:0)}function Uu(a,o){let l=!1;if(o&&o.length)for(const p of o)a.fire(new Zi(new Error(p.message))),l=!0;return l}var ka=nl;function nl(a,o,l){var p=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var y=new Int32Array(this.arrayBuffer);a=y[0],this.d=(o=y[1])+2*(l=y[2]);for(var w=0;w<this.d*this.d;w++){var E=y[3+w],M=y[3+w+1];p.push(E===M?null:y.subarray(E,M))}var k=y[3+p.length+1];this.keys=y.subarray(y[3+p.length],k),this.bboxes=y.subarray(k),this.insert=this._insertReadonly}else{this.d=o+2*l;for(var F=0;F<this.d*this.d;F++)p.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=a,this.padding=l,this.scale=o/a,this.uid=0;var U=l/o*a;this.min=-U,this.max=a+U}nl.prototype.insert=function(a,o,l,p,y){this._forEachCell(o,l,p,y,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(y)},nl.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},nl.prototype._insertCell=function(a,o,l,p,y,w){this.cells[y].push(w)},nl.prototype.query=function(a,o,l,p,y){var w=this.min,E=this.max;if(a<=w&&o<=w&&E<=l&&E<=p&&!y)return Array.prototype.slice.call(this.keys);var M=[];return this._forEachCell(a,o,l,p,this._queryCell,M,{},y),M},nl.prototype._queryCell=function(a,o,l,p,y,w,E,M){var k=this.cells[y];if(null!==k)for(var F=this.keys,U=this.bboxes,z=0;z<k.length;z++){var Z=k[z];if(void 0===E[Z]){var te=4*Z;(M?M(U[te+0],U[te+1],U[te+2],U[te+3]):a<=U[te+2]&&o<=U[te+3]&&l>=U[te+0]&&p>=U[te+1])?(E[Z]=!0,w.push(F[Z])):E[Z]=!1}}},nl.prototype._forEachCell=function(a,o,l,p,y,w,E,M){for(var k=this._convertToCellCoord(a),F=this._convertToCellCoord(o),U=this._convertToCellCoord(l),z=this._convertToCellCoord(p),Z=k;Z<=U;Z++)for(var te=F;te<=z;te++){var ie=this.d*te+Z;if((!M||M(this._convertFromCellCoord(Z),this._convertFromCellCoord(te),this._convertFromCellCoord(Z+1),this._convertFromCellCoord(te+1)))&&y.call(this,a,o,l,p,ie,w,E,M))return}},nl.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},nl.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},nl.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,o=3+this.cells.length+1+1,l=0,p=0;p<this.cells.length;p++)l+=this.cells[p].length;var y=new Int32Array(o+l+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var w=o,E=0;E<a.length;E++){var M=a[E];y[3+E]=w,y.set(M,w),w+=M.length}return y[3+a.length]=w,y.set(this.keys,w),y[3+a.length+1]=w+=this.keys.length,y.set(this.bboxes,w),w+=this.bboxes.length,y.buffer};const ju={};function mn(a,o,l={}){Object.defineProperty(a,"_classRegistryKey",{value:o,writeable:!1}),ju[o]={klass:a,omit:l.omit||[]}}mn(Object,"Object"),ka.serialize=function(a,o){const l=a.toArrayBuffer();return o&&o.push(l),{buffer:l}},ka.deserialize=function(a){return new ka(a.buffer)},Object.defineProperty(ka,"name",{value:"Grid"}),mn(ka,"Grid"),mn(Jr,"Color"),mn(Error,"Error"),mn(Kn,"AJAXError"),mn(Cr,"ResolvedImage"),mn(Zc,"StylePropertyFunction"),mn(Sd,"StyleExpression",{omit:["_evaluator"]}),mn(Ol,"ZoomDependentExpression"),mn(kp,"ZoomConstantExpression"),mn(Su,"CompoundExpression",{omit:["_evaluate"]});for(const a in pr)ju[pr[a]._classRegistryKey]||mn(pr[a],`Expression${a}`);function Fp(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function ha(a){return $e.ImageBitmap&&a instanceof $e.ImageBitmap}function xr(a,o){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(Fp(a)||ha(a))return o&&o.push(a),a;if(ArrayBuffer.isView(a)){const l=a;return o&&o.push(l.buffer),l}if(a instanceof $e.ImageData)return o&&o.push(a.data.buffer),a;if(Array.isArray(a)){const l=[];for(const p of a)l.push(xr(p,o));return l}if("object"==typeof a){const l=a.constructor,p=l._classRegistryKey;if(!p)throw new Error(`can't serialize object of unregistered class ${p}`);const y=l.serialize?l.serialize(a,o):{};if(!l.serialize){for(const w in a)a.hasOwnProperty(w)&&(ju[p].omit.indexOf(w)>=0||(y[w]=xr(a[w],o)));a instanceof Error&&(y.message=a.message)}if(y.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==p&&(y.$name=p),y}throw new Error("can't serialize object of type "+typeof a)}function $u(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||Fp(a)||ha(a)||ArrayBuffer.isView(a)||a instanceof $e.ImageData)return a;if(Array.isArray(a))return a.map($u);if("object"==typeof a){const o=a.$name||"Object",{klass:l}=ju[o];if(!l)throw new Error(`can't deserialize unregistered class ${o}`);if(l.deserialize)return l.deserialize(a);const p=Object.create(l.prototype);for(const y of Object.keys(a))"$name"!==y&&(p[y]=$u(a[y]));return p}throw new Error("can't deserialize object of type "+typeof a)}const Gu=a=>a>=1536&&a<=1791,bh=a=>a>=1872&&a<=1919,Wm=a=>a>=2208&&a<=2303,Lp=a=>a>=11904&&a<=12031,Zm=a=>a>=12032&&a<=12255,xh=a=>a>=12272&&a<=12287,Ra=a=>a>=12288&&a<=12351,wh=a=>a>=12352&&a<=12447,Ch=a=>a>=12448&&a<=12543,no=a=>a>=12544&&a<=12591,Tf=a=>a>=12704&&a<=12735,fa=a=>a>=12736&&a<=12783,Eh=a=>a>=12784&&a<=12799,pa=a=>a>=12800&&a<=13055,tu=a=>a>=13056&&a<=13311,Np=a=>a>=13312&&a<=19903,nu=a=>a>=19968&&a<=40959,Hu=a=>a>=40960&&a<=42127,Th=a=>a>=42128&&a<=42191,Ym=a=>a>=44032&&a<=55215,Fd=a=>a>=63744&&a<=64255,zp=a=>a>=64336&&a<=65023,Mi=a=>a>=65040&&a<=65055,v=a=>a>=65072&&a<=65103,c=a=>a>=65104&&a<=65135,g=a=>a>=65136&&a<=65279,C=a=>a>=65280&&a<=65519;function S(a){for(const o of a)if(B(o.charCodeAt(0)))return!0;return!1}function D(a){for(const o of a)if(!L(o.charCodeAt(0)))return!1;return!0}function L(a){return!(Gu(a)||bh(a)||Wm(a)||zp(a)||g(a))}function B(a){return!(746!==a&&747!==a&&(a<4352||!(Tf(a)||no(a)||v(a)&&!(a>=65097&&a<=65103)||Fd(a)||tu(a)||Lp(a)||fa(a)||!(!Ra(a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||Np(a)||nu(a)||pa(a)||(o=a,o>=12592&&o<=12687)||(o=>o>=43360&&o<=43391)(a)||(o=>o>=55216&&o<=55295)(a)||(o=>o>=4352&&o<=4607)(a)||Ym(a)||wh(a)||xh(a)||(o=>o>=12688&&o<=12703)(a)||Zm(a)||Eh(a)||Ch(a)&&12540!==a||!(!C(a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!c(a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||(o=>o>=5120&&o<=5759)(a)||(o=>o>=6320&&o<=6399)(a)||Mi(a)||(o=>o>=19904&&o<=19967)(a)||Hu(a)||Th(a))));var o}function G(a){return!(B(a)||(o=a,(l=o)>=128&&l<=255&&(167===o||169===o||174===o||177===o||188===o||189===o||190===o||215===o||247===o)||(l=>l>=8192&&l<=8303)(o)&&(8214===o||8224===o||8225===o||8240===o||8241===o||8251===o||8252===o||8258===o||8263===o||8264===o||8265===o||8273===o)||(l=>l>=8448&&l<=8527)(o)||(l=>l>=8528&&l<=8591)(o)||(l=>l>=8960&&l<=9215)(o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||9003===o||o>=9085&&o<=9114||o>=9150&&o<=9165||9167===o||o>=9169&&o<=9179||o>=9186&&o<=9215)||(l=>l>=9216&&l<=9279)(o)&&9251!==o||(l=>l>=9280&&l<=9311)(o)||(l=>l>=9312&&l<=9471)(o)||(l=>l>=9632&&l<=9727)(o)||(l=>l>=9728&&l<=9983)(o)&&!(o>=9754&&o<=9759)||(l=>l>=11008&&l<=11263)(o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Ra(o)||Ch(o)||(l=>l>=57344&&l<=63743)(o)||v(o)||c(o)||C(o)||8734===o||8756===o||8757===o||o>=9984&&o<=10087||o>=10102&&o<=10131||65532===o||65533===o));var o,l}function J(a){return a>=1424&&a<=2303||zp(a)||g(a)}function ee(a,o){return!(!o&&J(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||(l=a,l>=6016&&l<=6143));var l}function oe(a){for(const o of a)if(J(o.charCodeAt(0)))return!0;return!1}const de="deferred",ge="loading",ue="loaded";let ye=null,be="unavailable",ce=null;const Te=function(a){a&&"string"==typeof a&&a.indexOf("NetworkError")>-1&&(be="error"),ye&&ye(a)};function ve(){De.fire(new fr("pluginStateChange",{pluginStatus:be,pluginURL:ce}))}const De=new Rr,Fe=function(){return be},Re=function(){if(be!==de||!ce)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");be=ge,ve(),ce&&Xr({url:ce},a=>{a?Te(a):(be=ue,ve())})},Ue={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>be===ue||null!=Ue.applyArabicShaping,isLoading:()=>be===ge,setState(a){be=a.pluginStatus,ce=a.pluginURL},isParsed:()=>null!=Ue.applyArabicShaping&&null!=Ue.processBidirectionalText&&null!=Ue.processStyledBidirectionalText,getPluginURL:()=>ce};class Ze{constructor(o,l){this.zoom=o,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(o){return function(l,p){for(const y of l)if(!ee(y.charCodeAt(0),p))return!1;return!0}(o,Ue.isLoaded())}}class nt{constructor(o,l){this.property=o,this.value=l,this.expression=function(p,y){if(Nu(p))return new Zc(p,y);if(fh(p)){const w=el(p,y);if("error"===w.result)throw new Error(w.value.map(E=>`${E.key}: ${E.message}`).join(", "));return w.value}{let w=p;return"string"==typeof p&&"color"===y.type&&(w=Jr.parse(p)),{kind:"constant",evaluate:()=>w}}}(void 0===l?o.specification.default:l,o.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(o,l,p){return this.property.possiblyEvaluate(this,o,l,p)}}class ot{constructor(o){this.property=o,this.value=new nt(o,void 0)}transitioned(o,l){return new Qe(this.property,this.value,l,gt({},o.transition,this.transition),o.now)}untransitioned(){return new Qe(this.property,this.value,null,{},0)}}class Ut{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return vn(this._values[o].value.value)}setValue(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new ot(this._values[o].property)),this._values[o].value=new nt(this._values[o].property,null===l?void 0:vn(l))}getTransition(o){return vn(this._values[o].transition)}setTransition(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new ot(this._values[o].property)),this._values[o].transition=vn(l)||void 0}serialize(){const o={};for(const l of Object.keys(this._values)){const p=this.getValue(l);void 0!==p&&(o[l]=p);const y=this.getTransition(l);void 0!==y&&(o[`${l}-transition`]=y)}return o}transitioned(o,l){const p=new St(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].transitioned(o,l._values[y]);return p}untransitioned(){const o=new St(this._properties);for(const l of Object.keys(this._values))o._values[l]=this._values[l].untransitioned();return o}}class Qe{constructor(o,l,p,y,w){const E=y.delay||0,M=y.duration||0;w=w||0,this.property=o,this.value=l,this.begin=w+E,this.end=this.begin+M,o.specification.transition&&(y.delay||y.duration)&&(this.prior=p)}possiblyEvaluate(o,l,p){const y=o.now||0,w=this.value.possiblyEvaluate(o,l,p),E=this.prior;if(E){if(y>this.end)return this.prior=null,w;if(this.value.isDataDriven())return this.prior=null,w;if(y<this.begin)return E.possiblyEvaluate(o,l,p);{const M=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(o,l,p),w,tt(M))}}return w}}class St{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,l,p){const y=new et(this._properties);for(const w of Object.keys(this._values))y._values[w]=this._values[w].possiblyEvaluate(o,l,p);return y}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class at{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}getValue(o){return vn(this._values[o].value)}setValue(o,l){this._values[o]=new nt(this._values[o].property,null===l?void 0:vn(l))}serialize(){const o={};for(const l of Object.keys(this._values)){const p=this.getValue(l);void 0!==p&&(o[l]=p)}return o}possiblyEvaluate(o,l,p){const y=new et(this._properties);for(const w of Object.keys(this._values))y._values[w]=this._values[w].possiblyEvaluate(o,l,p);return y}}class Ot{constructor(o,l,p){this.property=o,this.value=l,this.parameters=p}isConstant(){return"constant"===this.value.kind}constantOr(o){return"constant"===this.value.kind?this.value.value:o}evaluate(o,l,p,y){return this.property.evaluate(this.value,this.parameters,o,l,p,y)}}class et{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class qe{constructor(o){this.specification=o}possiblyEvaluate(o,l){return o.expression.evaluate(l)}interpolate(o,l,p){const y=$c[this.specification.type];return y?y(o,l,p):o}}class Xe{constructor(o,l){this.specification=o,this.overrides=l}possiblyEvaluate(o,l,p,y){return new Ot(this,"constant"===o.expression.kind||"camera"===o.expression.kind?{kind:"constant",value:o.expression.evaluate(l,null,{},p,y)}:o.expression,l)}interpolate(o,l,p){if("constant"!==o.value.kind||"constant"!==l.value.kind)return o;if(void 0===o.value.value||void 0===l.value.value)return new Ot(this,{kind:"constant",value:void 0},o.parameters);const y=$c[this.specification.type];return y?new Ot(this,{kind:"constant",value:y(o.value.value,l.value.value,p)},o.parameters):o}evaluate(o,l,p,y,w,E){return"constant"===o.kind?o.value:o.evaluate(l,p,y,w,E)}}class Mt{constructor(o){this.specification=o}possiblyEvaluate(o,l,p,y){return!!o.expression.evaluate(l,null,{},p,y)}interpolate(){return!1}}class Lt{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new Ze(0,{});for(const p in o){const y=o[p];y.specification.overridable&&this.overridableProperties.push(p);const w=this.defaultPropertyValues[p]=new nt(y,void 0),E=this.defaultTransitionablePropertyValues[p]=new ot(y);this.defaultTransitioningPropertyValues[p]=E.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=w.possiblyEvaluate(l)}}}function dn(a,o){return 256*(a=Bt(Math.floor(a),0,255))+Bt(Math.floor(o),0,255)}mn(Xe,"DataDrivenProperty"),mn(qe,"DataConstantProperty"),mn(Mt,"ColorRampProperty");const Yn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class gn{constructor(o,l){this._structArray=o,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Yt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,l){return o._trim(),l&&(o.isTransferred=!0,l.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const l=Object.create(this.prototype);return l.arrayBuffer=o.arrayBuffer,l.length=o.length,l.capacity=o.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function yn(a,o=1){let l=0,p=0;return{members:a.map(y=>{const w=Yn[y.type].BYTES_PER_ELEMENT,E=l=xi(l,Math.max(o,w)),M=y.components||1;return p=Math.max(p,w),l+=w*M,{name:y.name,type:y.type,components:M,offset:E}}),size:xi(l,Math.max(p,o)),alignment:o}}function xi(a,o){return Math.ceil(a/o)*o}class Bn extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l){const p=this.length;return this.resize(p+1),this.emplace(p,o,l)}emplace(o,l,p){const y=2*o;return this.int16[y+0]=l,this.int16[y+1]=p,o}}Bn.prototype.bytesPerElement=4,mn(Bn,"StructArrayLayout2i4");class er extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,p)}emplace(o,l,p,y){const w=3*o;return this.int16[w+0]=l,this.int16[w+1]=p,this.int16[w+2]=y,o}}er.prototype.bytesPerElement=6,mn(er,"StructArrayLayout3i6");class Fi extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,p,y){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,p,y)}emplace(o,l,p,y,w){const E=4*o;return this.int16[E+0]=l,this.int16[E+1]=p,this.int16[E+2]=y,this.int16[E+3]=w,o}}Fi.prototype.bytesPerElement=8,mn(Fi,"StructArrayLayout4i8");class sr extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E,M){const k=this.length;return this.resize(k+1),this.emplace(k,o,l,p,y,w,E,M)}emplace(o,l,p,y,w,E,M,k){const F=6*o,U=12*o,z=3*o;return this.int16[F+0]=l,this.int16[F+1]=p,this.uint8[U+4]=y,this.uint8[U+5]=w,this.uint8[U+6]=E,this.uint8[U+7]=M,this.float32[z+2]=k,o}}sr.prototype.bytesPerElement=12,mn(sr,"StructArrayLayout2i4ub1f12");class vi extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p,y){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,p,y)}emplace(o,l,p,y,w){const E=4*o;return this.float32[E+0]=l,this.float32[E+1]=p,this.float32[E+2]=y,this.float32[E+3]=w,o}}vi.prototype.bytesPerElement=16,mn(vi,"StructArrayLayout4f16");class Mr extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,p,y,w)}emplace(o,l,p,y,w,E){const M=6*o,k=3*o;return this.uint16[M+0]=l,this.uint16[M+1]=p,this.uint16[M+2]=y,this.uint16[M+3]=w,this.float32[k+2]=E,o}}Mr.prototype.bytesPerElement=12,mn(Mr,"StructArrayLayout4ui1f12");class Ys extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,p,y){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,p,y)}emplace(o,l,p,y,w){const E=4*o;return this.uint16[E+0]=l,this.uint16[E+1]=p,this.uint16[E+2]=y,this.uint16[E+3]=w,o}}Ys.prototype.bytesPerElement=8,mn(Ys,"StructArrayLayout4ui8");class Gs extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E){const M=this.length;return this.resize(M+1),this.emplace(M,o,l,p,y,w,E)}emplace(o,l,p,y,w,E,M){const k=6*o;return this.int16[k+0]=l,this.int16[k+1]=p,this.int16[k+2]=y,this.int16[k+3]=w,this.int16[k+4]=E,this.int16[k+5]=M,o}}Gs.prototype.bytesPerElement=12,mn(Gs,"StructArrayLayout6i12");class Fa extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E,M,k,F,U,z,Z){const te=this.length;return this.resize(te+1),this.emplace(te,o,l,p,y,w,E,M,k,F,U,z,Z)}emplace(o,l,p,y,w,E,M,k,F,U,z,Z,te){const ie=12*o;return this.int16[ie+0]=l,this.int16[ie+1]=p,this.int16[ie+2]=y,this.int16[ie+3]=w,this.uint16[ie+4]=E,this.uint16[ie+5]=M,this.uint16[ie+6]=k,this.uint16[ie+7]=F,this.int16[ie+8]=U,this.int16[ie+9]=z,this.int16[ie+10]=Z,this.int16[ie+11]=te,o}}Fa.prototype.bytesPerElement=24,mn(Fa,"StructArrayLayout4i4ui4i24");class Er extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E){const M=this.length;return this.resize(M+1),this.emplace(M,o,l,p,y,w,E)}emplace(o,l,p,y,w,E,M){const k=10*o,F=5*o;return this.int16[k+0]=l,this.int16[k+1]=p,this.int16[k+2]=y,this.float32[F+2]=w,this.float32[F+3]=E,this.float32[F+4]=M,o}}Er.prototype.bytesPerElement=20,mn(Er,"StructArrayLayout3i3f20");class ar extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint32[1*o+0]=l,o}}ar.prototype.bytesPerElement=4,mn(ar,"StructArrayLayout1ul4");class Ki extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E,M,k,F,U,z,Z,te){const ie=this.length;return this.resize(ie+1),this.emplace(ie,o,l,p,y,w,E,M,k,F,U,z,Z,te)}emplace(o,l,p,y,w,E,M,k,F,U,z,Z,te,ie){const K=20*o,pe=10*o;return this.int16[K+0]=l,this.int16[K+1]=p,this.int16[K+2]=y,this.int16[K+3]=w,this.int16[K+4]=E,this.float32[pe+3]=M,this.float32[pe+4]=k,this.float32[pe+5]=F,this.float32[pe+6]=U,this.int16[K+14]=z,this.uint32[pe+8]=Z,this.uint16[K+18]=te,this.uint16[K+19]=ie,o}}Ki.prototype.bytesPerElement=40,mn(Ki,"StructArrayLayout5i4f1i1ul2ui40");class Fr extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E,M){const k=this.length;return this.resize(k+1),this.emplace(k,o,l,p,y,w,E,M)}emplace(o,l,p,y,w,E,M,k){const F=8*o;return this.int16[F+0]=l,this.int16[F+1]=p,this.int16[F+2]=y,this.int16[F+4]=w,this.int16[F+5]=E,this.int16[F+6]=M,this.int16[F+7]=k,o}}Fr.prototype.bytesPerElement=16,mn(Fr,"StructArrayLayout3i2i2i16");class Xn extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,p,y,w)}emplace(o,l,p,y,w,E){const M=4*o,k=8*o;return this.float32[M+0]=l,this.float32[M+1]=p,this.float32[M+2]=y,this.int16[k+6]=w,this.int16[k+7]=E,o}}Xn.prototype.bytesPerElement=16,mn(Xn,"StructArrayLayout2f1f2i16");class Li extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p,y){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,p,y)}emplace(o,l,p,y,w){const E=12*o,M=3*o;return this.uint8[E+0]=l,this.uint8[E+1]=p,this.float32[M+1]=y,this.float32[M+2]=w,o}}Li.prototype.bytesPerElement=12,mn(Li,"StructArrayLayout2ub2f12");class xs extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,p)}emplace(o,l,p,y){const w=3*o;return this.float32[w+0]=l,this.float32[w+1]=p,this.float32[w+2]=y,o}}xs.prototype.bytesPerElement=12,mn(xs,"StructArrayLayout3f12");class ho extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,p)}emplace(o,l,p,y){const w=3*o;return this.uint16[w+0]=l,this.uint16[w+1]=p,this.uint16[w+2]=y,o}}ho.prototype.bytesPerElement=6,mn(ho,"StructArrayLayout3ui6");class dc extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E,M,k,F,U,z,Z,te,ie,K,pe,Ee,xe,we,Ce,Le){const ke=this.length;return this.resize(ke+1),this.emplace(ke,o,l,p,y,w,E,M,k,F,U,z,Z,te,ie,K,pe,Ee,xe,we,Ce,Le)}emplace(o,l,p,y,w,E,M,k,F,U,z,Z,te,ie,K,pe,Ee,xe,we,Ce,Le,ke){const st=30*o,rt=15*o,bt=60*o;return this.int16[st+0]=l,this.int16[st+1]=p,this.int16[st+2]=y,this.float32[rt+2]=w,this.float32[rt+3]=E,this.uint16[st+8]=M,this.uint16[st+9]=k,this.uint32[rt+5]=F,this.uint32[rt+6]=U,this.uint32[rt+7]=z,this.uint16[st+16]=Z,this.uint16[st+17]=te,this.uint16[st+18]=ie,this.float32[rt+10]=K,this.float32[rt+11]=pe,this.uint8[bt+48]=Ee,this.uint8[bt+49]=xe,this.uint8[bt+50]=we,this.uint32[rt+13]=Ce,this.int16[st+28]=Le,this.uint8[bt+58]=ke,o}}dc.prototype.bytesPerElement=60,mn(dc,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class iu extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E,M,k,F,U,z,Z,te,ie,K,pe,Ee,xe,we,Ce,Le,ke,st,rt,bt,Gt,ht,Tt,xt,kt){const At=this.length;return this.resize(At+1),this.emplace(At,o,l,p,y,w,E,M,k,F,U,z,Z,te,ie,K,pe,Ee,xe,we,Ce,Le,ke,st,rt,bt,Gt,ht,Tt,xt,kt)}emplace(o,l,p,y,w,E,M,k,F,U,z,Z,te,ie,K,pe,Ee,xe,we,Ce,Le,ke,st,rt,bt,Gt,ht,Tt,xt,kt,At){const ct=38*o,ln=19*o;return this.int16[ct+0]=l,this.int16[ct+1]=p,this.int16[ct+2]=y,this.float32[ln+2]=w,this.float32[ln+3]=E,this.int16[ct+8]=M,this.int16[ct+9]=k,this.int16[ct+10]=F,this.int16[ct+11]=U,this.int16[ct+12]=z,this.int16[ct+13]=Z,this.uint16[ct+14]=te,this.uint16[ct+15]=ie,this.uint16[ct+16]=K,this.uint16[ct+17]=pe,this.uint16[ct+18]=Ee,this.uint16[ct+19]=xe,this.uint16[ct+20]=we,this.uint16[ct+21]=Ce,this.uint16[ct+22]=Le,this.uint16[ct+23]=ke,this.uint16[ct+24]=st,this.uint16[ct+25]=rt,this.uint16[ct+26]=bt,this.uint16[ct+27]=Gt,this.uint16[ct+28]=ht,this.uint32[ln+15]=Tt,this.float32[ln+16]=xt,this.float32[ln+17]=kt,this.float32[ln+18]=At,o}}iu.prototype.bytesPerElement=76,mn(iu,"StructArrayLayout3i2f6i15ui1ul3f76");class Wr extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.float32[1*o+0]=l,o}}Wr.prototype.bytesPerElement=4,mn(Wr,"StructArrayLayout1f4");class Ks extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,p,y,w)}emplace(o,l,p,y,w,E){const M=5*o;return this.float32[M+0]=l,this.float32[M+1]=p,this.float32[M+2]=y,this.float32[M+3]=w,this.float32[M+4]=E,o}}Ks.prototype.bytesPerElement=20,mn(Ks,"StructArrayLayout5f20");class ma extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,p,y){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,p,y)}emplace(o,l,p,y,w){const E=6*o;return this.uint32[3*o+0]=l,this.uint16[E+2]=p,this.uint16[E+3]=y,this.uint16[E+4]=w,o}}ma.prototype.bytesPerElement=12,mn(ma,"StructArrayLayout1ul3ui12");class Ll extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l){const p=this.length;return this.resize(p+1),this.emplace(p,o,l)}emplace(o,l,p){const y=2*o;return this.uint16[y+0]=l,this.uint16[y+1]=p,o}}Ll.prototype.bytesPerElement=4,mn(Ll,"StructArrayLayout2ui4");class il extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint16[1*o+0]=l,o}}il.prototype.bytesPerElement=2,mn(il,"StructArrayLayout1ui2");class fo extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l){const p=this.length;return this.resize(p+1),this.emplace(p,o,l)}emplace(o,l,p){const y=2*o;return this.float32[y+0]=l,this.float32[y+1]=p,o}}fo.prototype.bytesPerElement=8,mn(fo,"StructArrayLayout2f8");class hc extends gn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}hc.prototype.size=40;class hs extends Ki{get(o){return new hc(this,o)}}mn(hs,"CollisionBoxArray");class Ih extends gn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}Ih.prototype.size=60;class Bp extends dc{get(o){return new Ih(this,o)}}mn(Bp,"PlacedSymbolArray");class Vp extends gn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(o){this._structArray.uint32[this._pos4+15]=o}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Vp.prototype.size=76;class fs extends iu{get(o){return new Vp(this,o)}}mn(fs,"SymbolInstanceArray");class qu extends Wr{getoffsetX(o){return this.float32[1*o+0]}}mn(qu,"GlyphOffsetArray");class Sh extends Bn{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}mn(Sh,"SymbolLineVertexArray");class If extends gn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}If.prototype.size=12;class Up extends ma{get(o){return new If(this,o)}}mn(Up,"FeatureIndexArray");class Mh extends Ll{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}mn(Mh,"FillExtrusionCentroidArray");const Wu=yn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Wi=yn([{name:"a_dash",components:4,type:"Uint16"}]);var Nl={},S_={get exports(){return Nl},set exports(a){Nl=a}},fc={};({get exports(){return fc},set exports(a){fc=a}}).exports=function(a,o){var l,p,y,w,E,M,k,F;for(p=a.length-(l=3&a.length),y=o,E=3432918353,M=461845907,F=0;F<p;)k=255&a.charCodeAt(F)|(255&a.charCodeAt(++F))<<8|(255&a.charCodeAt(++F))<<16|(255&a.charCodeAt(++F))<<24,++F,y=27492+(65535&(w=5*(65535&(y=(y^=k=(65535&(k=(k=(65535&k)*E+(((k>>>16)*E&65535)<<16)&4294967295)<<15|k>>>17))*M+(((k>>>16)*M&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(k=0,l){case 3:k^=(255&a.charCodeAt(F+2))<<16;case 2:k^=(255&a.charCodeAt(F+1))<<8;case 1:y^=k=(65535&(k=(k=(65535&(k^=255&a.charCodeAt(F)))*E+(((k>>>16)*E&65535)<<16)&4294967295)<<15|k>>>17))*M+(((k>>>16)*M&65535)<<16)&4294967295}return y^=a.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0};var Km={};({get exports(){return Km},set exports(a){Km=a}}).exports=function(a,o){for(var l,p=a.length,y=o^p,w=0;p>=4;)l=1540483477*(65535&(l=255&a.charCodeAt(w)|(255&a.charCodeAt(++w))<<8|(255&a.charCodeAt(++w))<<16|(255&a.charCodeAt(++w))<<24))+((1540483477*(l>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),p-=4,++w;switch(p){case 3:y^=(255&a.charCodeAt(w+2))<<16;case 2:y^=(255&a.charCodeAt(w+1))<<8;case 1:y=1540483477*(65535&(y^=255&a.charCodeAt(w)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0};var Zu=fc,j=Km;S_.exports=Zu,Nl.murmur3=Zu,Nl.murmur2=j;class P{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,l,p,y){this.ids.push(R(o)),this.positions.push(l,p,y)}getPositions(o){const l=R(o);let p=0,y=this.ids.length-1;for(;p<y;){const E=p+y>>1;this.ids[E]>=l?y=E:p=E+1}const w=[];for(;this.ids[p]===l;)w.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return w}static serialize(o,l){const p=new Float64Array(o.ids),y=new Uint32Array(o.positions);return q(p,y,0,p.length-1),l&&l.push(p.buffer,y.buffer),{ids:p,positions:y}}static deserialize(o){const l=new P;return l.ids=o.ids,l.positions=o.positions,l.indexed=!0,l}}function R(a){const o=+a;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:Nl(String(a))}function q(a,o,l,p){for(;l<p;){const y=a[l+p>>1];let w=l-1,E=p+1;for(;;){do{w++}while(a[w]<y);do{E--}while(a[E]>y);if(w>=E)break;le(a,w,E),le(o,3*w,3*E),le(o,3*w+1,3*E+1),le(o,3*w+2,3*E+2)}E-l<p-E?(q(a,o,l,E),l=E+1):(q(a,o,E+1,p),p=E)}}function le(a,o,l){const p=a[o];a[o]=a[l],a[l]=p}mn(P,"FeaturePositionMap");class _e{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,l),this.initialized=!0),!!this.location}}class lt extends _e{constructor(o){super(o),this.current=0}set(o,l,p){this.fetchUniformLocation(o,l)&&this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class $t extends _e{constructor(o){super(o),this.current=[0,0,0,0]}set(o,l,p){this.fetchUniformLocation(o,l)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3])))}}class Tn extends _e{constructor(o){super(o),this.current=Jr.transparent}set(o,l,p){this.fetchUniformLocation(o,l)&&(p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a)))}}const ii=new Float32Array(16),zi=new Float32Array(9),po=new Float32Array(4);function ga(a){return[dn(255*a.r,255*a.g),dn(255*a.b,255*a.a)]}class rl{constructor(o,l,p){this.value=o,this.uniformNames=l.map(y=>`u_${y}`),this.type=p}setUniform(o,l,p,y,w){l.set(o,w,y.constantOr(this.value))}getBinding(o,l){return"color"===this.type?new Tn(o):new lt(o)}}class ol{constructor(o,l){this.uniformNames=l.map(p=>`u_${p}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,l,p,y,w){const E="u_pattern"===w||"u_dash"===w?this.pattern:"u_pixel_ratio"===w?this.pixelRatio:null;E&&l.set(o,w,E)}getBinding(o,l){return"u_pattern"===l||"u_dash"===l?new $t(o):new lt(o)}}class pc{constructor(o,l,p,y){this.expression=o,this.type=p,this.maxValue=0,this.paintVertexAttributes=l.map(w=>({name:`a_${w}`,type:"Float32",components:"color"===p?2:1,offset:0})),this.paintVertexArray=new y}populatePaintArray(o,l,p,y,w,E){const M=this.paintVertexArray.length,k=this.expression.evaluate(new Ze(0),l,{},w,y,E);this.paintVertexArray.resize(o),this._setPaintValue(M,o,k)}updatePaintArray(o,l,p,y,w){const E=this.expression.evaluate({zoom:0},p,y,void 0,w);this._setPaintValue(o,l,E)}_setPaintValue(o,l,p){if("color"===this.type){const y=ga(p);for(let w=o;w<l;w++)this.paintVertexArray.emplace(w,y[0],y[1])}else{for(let y=o;y<l;y++)this.paintVertexArray.emplace(y,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class La{constructor(o,l,p,y,w,E){this.expression=o,this.uniformNames=l.map(M=>`u_${M}_t`),this.type=p,this.useIntegerZoom=y,this.zoom=w,this.maxValue=0,this.paintVertexAttributes=l.map(M=>({name:`a_${M}`,type:"Float32",components:"color"===p?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(o,l,p,y,w,E){const M=this.expression.evaluate(new Ze(this.zoom),l,{},w,y,E),k=this.expression.evaluate(new Ze(this.zoom+1),l,{},w,y,E),F=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(F,o,M,k)}updatePaintArray(o,l,p,y,w){const E=this.expression.evaluate({zoom:this.zoom},p,y,void 0,w),M=this.expression.evaluate({zoom:this.zoom+1},p,y,void 0,w);this._setPaintValue(o,l,E,M)}_setPaintValue(o,l,p,y){if("color"===this.type){const w=ga(p),E=ga(y);for(let M=o;M<l;M++)this.paintVertexArray.emplace(M,w[0],w[1],E[0],E[1])}else{for(let w=o;w<l;w++)this.paintVertexArray.emplace(w,p,y);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(y))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,l,p,y,w){const E=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,M=Bt(this.expression.interpolationFactor(E,this.zoom,this.zoom+1),0,1);l.set(o,w,M)}getBinding(o,l){return new lt(o)}}class ru{constructor(o,l,p,y,w){this.expression=o,this.layerId=w,this.paintVertexAttributes=("array"===p?Wi:Wu).members;for(let E=0;E<l.length;++E);this.paintVertexArray=new y}populatePaintArray(o,l,p){const y=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(y,o,l.patterns&&l.patterns[this.layerId],p)}updatePaintArray(o,l,p,y,w,E){this._setPaintValues(o,l,p.patterns&&p.patterns[this.layerId],E)}_setPaintValues(o,l,p,y){if(!y||!p)return;const w=y[p];if(!w)return;const{tl:E,br:M,pixelRatio:k}=w;for(let F=o;F<l;F++)this.paintVertexArray.emplace(F,E[0],E[1],M[0],M[1],k)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ou{constructor(o,l,p=(()=>!0)){this.binders={},this._buffers=[];const y=[];for(const w in o.paint._values){if(!p(w))continue;const E=o.paint.get(w);if(!(E instanceof Ot&&Lu(E.property.specification)))continue;const M=Ah(w,o.type),k=E.value,F=E.property.specification.type,U=E.property.useIntegerZoom,z="line-dasharray"===w||w.endsWith("pattern"),Z="line-dasharray"===w&&"constant"!==o.layout.get("line-cap").value.kind;if("constant"!==k.kind||Z)if("source"===k.kind||Z||z){const te=jp(w,F,"source");this.binders[w]=z?new ru(k,M,F,te,o.id):new pc(k,M,F,te),y.push(`/a_${w}`)}else{const te=jp(w,F,"composite");this.binders[w]=new La(k,M,F,U,l,te),y.push(`/z_${w}`)}else this.binders[w]=z?new ol(k.value,M):new rl(k.value,M,F),y.push(`/u_${w}`)}this.cacheKey=y.sort().join("")}getMaxValue(o){const l=this.binders[o];return l instanceof pc||l instanceof La?l.maxValue:0}populatePaintArrays(o,l,p,y,w,E){for(const M in this.binders){const k=this.binders[M];(k instanceof pc||k instanceof La||k instanceof ru)&&k.populatePaintArray(o,l,p,y,w,E)}}setConstantPatternPositions(o){for(const l in this.binders){const p=this.binders[l];p instanceof ol&&p.setConstantPatternPositions(o)}}updatePaintArrays(o,l,p,y,w,E){let M=!1;for(const k in o){const F=l.getPositions(k);for(const U of F){const z=p.feature(U.index);for(const Z in this.binders){const te=this.binders[Z];if((te instanceof pc||te instanceof La||te instanceof ru)&&!0===te.expression.isStateDependent){const ie=y.paint.get(Z);te.expression=ie.value,te.updatePaintArray(U.start,U.end,z,o[k],w,E),M=!0}}}}return M}defines(){const o=[];for(const l in this.binders){const p=this.binders[l];(p instanceof rl||p instanceof ol)&&o.push(...p.uniformNames.map(y=>`#define HAS_UNIFORM_${y}`))}return o}getBinderAttributes(){const o=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof pc||p instanceof La||p instanceof ru)for(let y=0;y<p.paintVertexAttributes.length;y++)o.push(p.paintVertexAttributes[y].name)}return o}getBinderUniforms(){const o=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof rl||p instanceof ol||p instanceof La)for(const y of p.uniformNames)o.push(y)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const l=[];for(const p in this.binders){const y=this.binders[p];if(y instanceof rl||y instanceof ol||y instanceof La)for(const w of y.uniformNames)l.push({name:w,property:p,binding:y.getBinding(o,w)})}return l}setUniforms(o,l,p,y,w){for(const{name:E,property:M,binding:k}of p)this.binders[M].setUniform(o,k,w,y.get(M),E)}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const l=this.binders[o];(l instanceof pc||l instanceof La||l instanceof ru)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(o){for(const l in this.binders){const p=this.binders[l];(p instanceof pc||p instanceof La||p instanceof ru)&&p.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const l=this.binders[o];(l instanceof pc||l instanceof La||l instanceof ru)&&l.destroy()}}}class mc{constructor(o,l,p=(()=>!0)){this.programConfigurations={};for(const y of o)this.programConfigurations[y.id]=new ou(y,l,p);this.needsUpload=!1,this._featureMap=new P,this._bufferOffset=0}populatePaintArrays(o,l,p,y,w,E,M){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(o,l,y,w,E,M);void 0!==l.id&&this._featureMap.add(l.id,p,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,l,p,y,w){for(const E of p)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(o,this._featureMap,l,E,y,w)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const Dh={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Ah(a,o){return Dh[a]||[a.replace(`${o}-`,"").replace(/-/g,"_")]}const Sf={"line-pattern":{source:Mr,composite:Mr},"fill-pattern":{source:Mr,composite:Mr},"fill-extrusion-pattern":{source:Mr,composite:Mr},"line-dasharray":{source:Ys,composite:Ys}},Yu={color:{source:fo,composite:vi},number:{source:Wr,composite:fo}};function jp(a,o,l){const p=Sf[a];return p&&p[l]||Yu[o][l]}mn(rl,"ConstantBinder"),mn(ol,"PatternConstantBinder"),mn(pc,"SourceExpressionBinder"),mn(ru,"PatternCompositeBinder"),mn(La,"CompositeExpressionBinder"),mn(ou,"ProgramConfiguration",{omit:["_buffers"]}),mn(mc,"ProgramConfigurationSet");const Ph="-transition";class Na extends Rr{constructor(o,l){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==o.type&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,"background"!==o.type&&"sky"!==o.type&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),l.layout&&(this._unevaluatedLayout=new at(l.layout)),l.paint)){this._transitionablePaint=new Ut(l.paint);for(const p in o.paint)this.setPaintProperty(p,o.paint[p],{validate:!1});for(const p in o.layout)this.setLayoutProperty(p,o.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new et(l.paint)}}getLayoutProperty(o){return"visibility"===o?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,l,p={}){null!=l&&this._validate(eu,`layers.${this.id}.layout.${o}`,o,l,p)||("visibility"!==o?this._unevaluatedLayout.setValue(o,l):this.visibility=l)}getPaintProperty(o){return rr(o,Ph)?this._transitionablePaint.getTransition(o.slice(0,-Ph.length)):this._transitionablePaint.getValue(o)}setPaintProperty(o,l,p={}){if(null!=l&&this._validate(Ef,`layers.${this.id}.paint.${o}`,o,l,p))return!1;if(rr(o,Ph))return this._transitionablePaint.setTransition(o.slice(0,-Ph.length),l||void 0),!1;{const y=this._transitionablePaint._values[o],w=y.value.isDataDriven(),E=y.value;this._transitionablePaint.setValue(o,l),this._handleSpecialPaintPropertyUpdate(o);const M=this._transitionablePaint._values[o].value,k=M.isDataDriven(),F=rr(o,"pattern")||"line-dasharray"===o;return k||w||F||this._handleOverridablePaintPropertyUpdate(o,E,M)}}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getProgramConfiguration(o){return null}_handleOverridablePaintPropertyUpdate(o,l,p){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||"none"===this.visibility}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,l)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),zn(o,(l,p)=>!(void 0===l||"layout"===p&&!Object.keys(l).length||"paint"===p&&!Object.keys(l).length))}_validate(o,l,p,y,w={}){return(!w||!1!==w.validate)&&Uu(this,o.call(Cf,{key:l,layerType:this.type,objectKey:p,value:y,styleSpec:ut,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const l=this.paint.get(o);if(l instanceof Ot&&Lu(l.property.specification)&&("source"===l.value.kind||"composite"===l.value.kind)&&l.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Xc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Oh=yn([{name:"a_pos",components:2,type:"Int16"}],4),ex=yn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Zr{constructor(o=[]){this.segments=o}prepareSegment(o,l,p,y){let w=this.segments[this.segments.length-1];return o>Zr.MAX_VERTEX_ARRAY_LENGTH&&Pi(`Max vertices per segment is ${Zr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!w||w.vertexLength+o>Zr.MAX_VERTEX_ARRAY_LENGTH||w.sortKey!==y)&&(w={vertexOffset:l.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},void 0!==y&&(w.sortKey=y),this.segments.push(w)),w}get(){return this.segments}destroy(){for(const o of this.segments)for(const l in o.vaos)o.vaos[l].destroy()}static simpleSegment(o,l,p,y){return new Zr([{vertexOffset:o,primitiveOffset:l,vertexLength:p,primitiveLength:y,vaos:{},sortKey:0}])}}Zr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,mn(Zr,"SegmentVector");var Qn=8192;class gc{constructor(o,l){o&&(l?this.setSouthWest(o).setNorthEast(l):4===o.length?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))}setNorthEast(o){return this._ne=o instanceof tr?new tr(o.lng,o.lat):tr.convert(o),this}setSouthWest(o){return this._sw=o instanceof tr?new tr(o.lng,o.lat):tr.convert(o),this}extend(o){const l=this._sw,p=this._ne;let y,w;if(o instanceof tr)y=o,w=o;else{if(!(o instanceof gc))return Array.isArray(o)?4===o.length||o.every(Array.isArray)?this.extend(gc.convert(o)):this.extend(tr.convert(o)):"object"==typeof o&&null!==o&&o.hasOwnProperty("lat")&&o.hasOwnProperty("lon")?this.extend(tr.convert(o)):this;if(y=o._sw,w=o._ne,!y||!w)return this}return l||p?(l.lng=Math.min(y.lng,l.lng),l.lat=Math.min(y.lat,l.lat),p.lng=Math.max(w.lng,p.lng),p.lat=Math.max(w.lat,p.lat)):(this._sw=new tr(y.lng,y.lat),this._ne=new tr(w.lng,w.lat)),this}getCenter(){return new tr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new tr(this.getWest(),this.getNorth())}getSouthEast(){return new tr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:l,lat:p}=tr.convert(o);let y=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&y}static convert(o){return!o||o instanceof gc?o:new gc(o)}}var kh=1e-6,za=typeof Float32Array<"u"?Float32Array:Array;function M_(){var a=new za(9);return za!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Rh(a,o,l){var p=o[0],y=o[1],w=o[2],E=o[3],M=o[4],k=o[5],F=o[6],U=o[7],z=o[8],Z=l[0],te=l[1],ie=l[2],K=l[3],pe=l[4],Ee=l[5],xe=l[6],we=l[7],Ce=l[8];return a[0]=Z*p+te*E+ie*F,a[1]=Z*y+te*M+ie*U,a[2]=Z*w+te*k+ie*z,a[3]=K*p+pe*E+Ee*F,a[4]=K*y+pe*M+Ee*U,a[5]=K*w+pe*k+Ee*z,a[6]=xe*p+we*E+Ce*F,a[7]=xe*y+we*M+Ce*U,a[8]=xe*w+we*k+Ce*z,a}function _c(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Xm(a,o){var l=o[0],p=o[1],y=o[2],w=o[3],E=o[4],M=o[5],k=o[6],F=o[7],U=o[8],z=o[9],Z=o[10],te=o[11],ie=o[12],K=o[13],pe=o[14],Ee=o[15],xe=l*M-p*E,we=l*k-y*E,Ce=l*F-w*E,Le=p*k-y*M,ke=p*F-w*M,st=y*F-w*k,rt=U*K-z*ie,bt=U*pe-Z*ie,Gt=U*Ee-te*ie,ht=z*pe-Z*K,Tt=z*Ee-te*K,xt=Z*Ee-te*pe,kt=xe*xt-we*Tt+Ce*ht+Le*Gt-ke*bt+st*rt;return kt?(a[0]=(M*xt-k*Tt+F*ht)*(kt=1/kt),a[1]=(y*Tt-p*xt-w*ht)*kt,a[2]=(K*st-pe*ke+Ee*Le)*kt,a[3]=(Z*ke-z*st-te*Le)*kt,a[4]=(k*Gt-E*xt-F*bt)*kt,a[5]=(l*xt-y*Gt+w*bt)*kt,a[6]=(pe*Ce-ie*st-Ee*we)*kt,a[7]=(U*st-Z*Ce+te*we)*kt,a[8]=(E*Tt-M*Gt+F*rt)*kt,a[9]=(p*Gt-l*Tt-w*rt)*kt,a[10]=(ie*ke-K*Ce+Ee*xe)*kt,a[11]=(z*Ce-U*ke-te*xe)*kt,a[12]=(M*bt-E*ht-k*rt)*kt,a[13]=(l*ht-p*bt+y*rt)*kt,a[14]=(K*we-ie*Le-pe*xe)*kt,a[15]=(U*Le-z*we+Z*xe)*kt,a):null}function Ld(a,o,l){var p=o[0],y=o[1],w=o[2],E=o[3],M=o[4],k=o[5],F=o[6],U=o[7],z=o[8],Z=o[9],te=o[10],ie=o[11],K=o[12],pe=o[13],Ee=o[14],xe=o[15],we=l[0],Ce=l[1],Le=l[2],ke=l[3];return a[0]=we*p+Ce*M+Le*z+ke*K,a[1]=we*y+Ce*k+Le*Z+ke*pe,a[2]=we*w+Ce*F+Le*te+ke*Ee,a[3]=we*E+Ce*U+Le*ie+ke*xe,a[4]=(we=l[4])*p+(Ce=l[5])*M+(Le=l[6])*z+(ke=l[7])*K,a[5]=we*y+Ce*k+Le*Z+ke*pe,a[6]=we*w+Ce*F+Le*te+ke*Ee,a[7]=we*E+Ce*U+Le*ie+ke*xe,a[8]=(we=l[8])*p+(Ce=l[9])*M+(Le=l[10])*z+(ke=l[11])*K,a[9]=we*y+Ce*k+Le*Z+ke*pe,a[10]=we*w+Ce*F+Le*te+ke*Ee,a[11]=we*E+Ce*U+Le*ie+ke*xe,a[12]=(we=l[12])*p+(Ce=l[13])*M+(Le=l[14])*z+(ke=l[15])*K,a[13]=we*y+Ce*k+Le*Z+ke*pe,a[14]=we*w+Ce*F+Le*te+ke*Ee,a[15]=we*E+Ce*U+Le*ie+ke*xe,a}function Fh(a,o,l){var p,y,w,E,M,k,F,U,z,Z,te,ie,K=l[0],pe=l[1],Ee=l[2];return o===a?(a[12]=o[0]*K+o[4]*pe+o[8]*Ee+o[12],a[13]=o[1]*K+o[5]*pe+o[9]*Ee+o[13],a[14]=o[2]*K+o[6]*pe+o[10]*Ee+o[14],a[15]=o[3]*K+o[7]*pe+o[11]*Ee+o[15]):(y=o[1],w=o[2],E=o[3],M=o[4],k=o[5],F=o[6],U=o[7],z=o[8],Z=o[9],te=o[10],ie=o[11],a[0]=p=o[0],a[1]=y,a[2]=w,a[3]=E,a[4]=M,a[5]=k,a[6]=F,a[7]=U,a[8]=z,a[9]=Z,a[10]=te,a[11]=ie,a[12]=p*K+M*pe+z*Ee+o[12],a[13]=y*K+k*pe+Z*Ee+o[13],a[14]=w*K+F*pe+te*Ee+o[14],a[15]=E*K+U*pe+ie*Ee+o[15]),a}function yc(a,o,l){var p=l[0],y=l[1],w=l[2];return a[0]=o[0]*p,a[1]=o[1]*p,a[2]=o[2]*p,a[3]=o[3]*p,a[4]=o[4]*y,a[5]=o[5]*y,a[6]=o[6]*y,a[7]=o[7]*y,a[8]=o[8]*w,a[9]=o[9]*w,a[10]=o[10]*w,a[11]=o[11]*w,a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],a}function Nd(a,o,l){var p=Math.sin(l),y=Math.cos(l),w=o[4],E=o[5],M=o[6],k=o[7],F=o[8],U=o[9],z=o[10],Z=o[11];return o!==a&&(a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[4]=w*y+F*p,a[5]=E*y+U*p,a[6]=M*y+z*p,a[7]=k*y+Z*p,a[8]=F*y-w*p,a[9]=U*y-E*p,a[10]=z*y-M*p,a[11]=Z*y-k*p,a}function $p(a,o,l){var p=Math.sin(l),y=Math.cos(l),w=o[0],E=o[1],M=o[2],k=o[3],F=o[8],U=o[9],z=o[10],Z=o[11];return o!==a&&(a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=w*y-F*p,a[1]=E*y-U*p,a[2]=M*y-z*p,a[3]=k*y-Z*p,a[8]=w*p+F*y,a[9]=E*p+U*y,a[10]=M*p+z*y,a[11]=k*p+Z*y,a}function Gp(a,o){return a[0]=o[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=o[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=o[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function D_(a,o,l){var p,y,w,E=l[0],M=l[1],k=l[2],F=Math.hypot(E,M,k);return F<kh?null:(E*=F=1/F,M*=F,k*=F,p=Math.sin(o),y=Math.cos(o),a[0]=E*E*(w=1-y)+y,a[1]=M*E*w+k*p,a[2]=k*E*w-M*p,a[3]=0,a[4]=E*M*w-k*p,a[5]=M*M*w+y,a[6]=k*M*w+E*p,a[7]=0,a[8]=E*k*w+M*p,a[9]=M*k*w-E*p,a[10]=k*k*w+y,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}Math.hypot||(Math.hypot=function(){for(var a=0,o=arguments.length;o--;)a+=arguments[o]*arguments[o];return Math.sqrt(a)});var Hp=Ld;function A_(){var a=new za(3);return za!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function Mf(a){var o=new za(3);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o}function sl(a){return Math.hypot(a[0],a[1],a[2])}function Lh(a,o,l){var p=new za(3);return p[0]=a,p[1]=o,p[2]=l,p}function Ba(a,o,l){return a[0]=o[0]+l[0],a[1]=o[1]+l[1],a[2]=o[2]+l[2],a}function Df(a,o,l){return a[0]=o[0]-l[0],a[1]=o[1]-l[1],a[2]=o[2]-l[2],a}function qp(a,o,l){return a[0]=o[0]*l[0],a[1]=o[1]*l[1],a[2]=o[2]*l[2],a}function Ku(a,o,l){return a[0]=Math.min(o[0],l[0]),a[1]=Math.min(o[1],l[1]),a[2]=Math.min(o[2],l[2]),a}function Af(a,o,l){return a[0]=Math.max(o[0],l[0]),a[1]=Math.max(o[1],l[1]),a[2]=Math.max(o[2],l[2]),a}function Hs(a,o,l){return a[0]=o[0]*l,a[1]=o[1]*l,a[2]=o[2]*l,a}function Qm(a,o,l,p){return a[0]=o[0]+l[0]*p,a[1]=o[1]+l[1]*p,a[2]=o[2]+l[2]*p,a}function _a(a,o){var l=o[0],p=o[1],y=o[2],w=l*l+p*p+y*y;return w>0&&(w=1/Math.sqrt(w)),a[0]=o[0]*w,a[1]=o[1]*w,a[2]=o[2]*w,a}function su(a,o){return a[0]*o[0]+a[1]*o[1]+a[2]*o[2]}function Mv(a,o,l){var p=o[0],y=o[1],w=o[2],E=l[0],M=l[1],k=l[2];return a[0]=y*k-w*M,a[1]=w*E-p*k,a[2]=p*M-y*E,a}function mo(a,o,l){var p=o[0],y=o[1],w=o[2],E=l[3]*p+l[7]*y+l[11]*w+l[15];return a[0]=(l[0]*p+l[4]*y+l[8]*w+l[12])/(E=E||1),a[1]=(l[1]*p+l[5]*y+l[9]*w+l[13])/E,a[2]=(l[2]*p+l[6]*y+l[10]*w+l[14])/E,a}function tx(a,o,l){var p=l[0],y=l[1],w=l[2],E=o[0],M=o[1],k=o[2],F=y*k-w*M,U=w*E-p*k,z=p*M-y*E,Z=y*z-w*U,te=w*F-p*z,ie=p*U-y*F,K=2*l[3];return U*=K,z*=K,te*=2,ie*=2,a[0]=E+(F*=K)+(Z*=2),a[1]=M+U+te,a[2]=k+z+ie,a}var Wp,al=Df,P_=qp,Dv=sl;function Av(a,o,l){return a[0]=o[0]*l,a[1]=o[1]*l,a[2]=o[2]*l,a[3]=o[3]*l,a}function Pv(a,o){var l=o[0],p=o[1],y=o[2],w=o[3],E=l*l+p*p+y*y+w*w;return E>0&&(E=1/Math.sqrt(E)),a[0]=l*E,a[1]=p*E,a[2]=y*E,a[3]=w*E,a}function zl(a,o,l){var p=o[0],y=o[1],w=o[2],E=o[3];return a[0]=l[0]*p+l[4]*y+l[8]*w+l[12]*E,a[1]=l[1]*p+l[5]*y+l[9]*w+l[13]*E,a[2]=l[2]*p+l[6]*y+l[10]*w+l[14]*E,a[3]=l[3]*p+l[7]*y+l[11]*w+l[15]*E,a}function nx(){var a=new za(4);return za!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function ix(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function Ov(a,o,l){l*=.5;var p=o[0],y=o[1],w=o[2],E=o[3],M=Math.sin(l),k=Math.cos(l);return a[0]=p*k+E*M,a[1]=y*k+w*M,a[2]=w*k-y*M,a[3]=E*k-p*M,a}function O_(a,o,l){l*=.5;var p=o[0],y=o[1],w=o[2],E=o[3],M=Math.sin(l),k=Math.cos(l);return a[0]=p*k-w*M,a[1]=y*k+E*M,a[2]=w*k+p*M,a[3]=E*k-y*M,a}A_(),Wp=new za(4),za!=Float32Array&&(Wp[0]=0,Wp[1]=0,Wp[2]=0,Wp[3]=0);var kv=Pv;A_(),Lh(1,0,0),Lh(0,1,0),nx(),nx(),M_();const Xs=yn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:vc}=Xs,Rv=yn([{name:"a_pos_3",components:3,type:"Int16"}]);var Zp=yn([{name:"a_pos",type:"Int16",components:2}]);class Fv{constructor(o,l){this.pos=o,this.dir=l}intersectsPlane(o,l,p){const y=su(l,this.dir);if(Math.abs(y)<1e-6)return!1;const w=((o[0]-this.pos[0])*l[0]+(o[1]-this.pos[1])*l[1]+(o[2]-this.pos[2])*l[2])/y;return p[0]=this.pos[0]+this.dir[0]*w,p[1]=this.pos[1]+this.dir[1]*w,p[2]=this.pos[2]+this.dir[2]*w,!0}closestPointOnSphere(o,l,p){if(K=(te=this.pos)[0],pe=te[1],Ee=te[2],xe=(ie=o)[0],we=ie[1],Ce=ie[2],Math.abs(K-xe)<=kh*Math.max(1,Math.abs(K),Math.abs(xe))&&Math.abs(pe-we)<=kh*Math.max(1,Math.abs(pe),Math.abs(we))&&Math.abs(Ee-Ce)<=kh*Math.max(1,Math.abs(Ee),Math.abs(Ce))||0===l)return p[0]=p[1]=p[2]=0,!1;var te,ie,K,pe,Ee,xe,we,Ce;const[y,w,E]=this.dir,M=this.pos[0]-o[0],k=this.pos[1]-o[1],F=this.pos[2]-o[2],U=y*y+w*w+E*E,z=2*(M*y+k*w+F*E),Z=z*z-4*U*(M*M+k*k+F*F-l*l);if(Z<0){const te=Math.max(-z/2,0),ie=M+y*te,K=k+w*te,pe=F+E*te,Ee=Math.hypot(ie,K,pe);return p[0]=ie*l/Ee,p[1]=K*l/Ee,p[2]=pe*l/Ee,!1}{const te=(-z-Math.sqrt(Z))/(2*U);if(te<0){const ie=Math.hypot(M,k,F);return p[0]=M*l/ie,p[1]=k*l/ie,p[2]=F*l/ie,!1}return p[0]=M+y*te,p[1]=k+w*te,p[2]=F+E*te,!0}}}class Nh{constructor(o,l,p,y,w){this.TL=o,this.TR=l,this.BR=p,this.BL=y,this.horizon=w}static fromInvProjectionMatrix(o,l,p){const y=[-1,1,1],w=[1,1,1],E=[1,-1,1],M=[-1,-1,1],k=mo(y,y,o),F=mo(w,w,o),U=mo(E,E,o),z=mo(M,M,o);return new Nh(k,F,U,z,l/p)}}class k_{constructor(o,l){this.points=o,this.planes=l}static fromInvProjectionMatrix(o,l,p,y){const w=Math.pow(2,p),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const F=zl([],k,o),U=1/F[3]/l*w;return(z=F)[0]=(Z=F)[0]*(te=[U,U,y?1/F[3]:U,U])[0],z[1]=Z[1]*te[1],z[2]=Z[2]*te[2],z[3]=Z[3]*te[3],z;var z,Z,te}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const F=_a([],Mv([],al([],E[k[0]],E[k[1]]),al([],E[k[2]],E[k[1]]))),U=-su(F,E[k[1]]);return F.concat(U)});return new k_(E,M)}}class ya{static fromPoints(o){const l=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0];for(const y of o)Ku(l,l,y),Af(p,p,y);return new ya(l,p)}static applyTransform(o,l){const p=o.getCorners();for(let y=0;y<p.length;++y)mo(p[y],p[y],l);return ya.fromPoints(p)}constructor(o,l){this.min=o,this.max=l,this.center=Hs([],Ba([],this.min,this.max),.5)}quadrant(o){const l=[o%2==0,o<2],p=Mf(this.min),y=Mf(this.max);for(let w=0;w<l.length;w++)p[w]=l[w]?this.min[w]:this.center[w],y[w]=l[w]?this.center[w]:this.max[w];return y[2]=this.max[2],new ya(p,y)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,l=this.max;return[[o[0],o[1],o[2]],[l[0],o[1],o[2]],[l[0],l[1],o[2]],[o[0],l[1],o[2]],[o[0],o[1],l[2]],[l[0],o[1],l[2]],[l[0],l[1],l[2]],[o[0],l[1],l[2]]]}intersects(o){const l=this.getCorners();let p=!0;for(let y=0;y<o.planes.length;y++){const w=o.planes[y];let E=0;for(let M=0;M<l.length;M++)E+=su(w,l[M])+w[3]>=0;if(0===E)return 0;E!==l.length&&(p=!1)}if(p)return 2;for(let y=0;y<3;y++){let w=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let M=0;M<o.points.length;M++){const k=o.points[M][y]-this.min[y];w=Math.min(w,k),E=Math.max(E,k)}if(E<0||w>this.max[y]-this.min[y])return 0}return 1}}const ll=Qn/Math.PI/2,Pf=[64,32,16],Bl=-ll,cl=ll,Yp=[new ya([Bl,Bl,Bl],[cl,cl,cl]),new ya([Bl,Bl,Bl],[0,0,cl]),new ya([0,Bl,Bl],[cl,0,cl]),new ya([Bl,0,Bl],[0,cl,cl]),new ya([0,0,Bl],[cl,cl,cl])];function bc(a){return a*ll/zd}function Xu(a,o,l,p=!0){const y=Hs([],a._camera.position,a.worldSize),w=[o,l,1,1];zl(w,w,a.pixelMatrixInverse),Av(w,w,1/w[3]);const E=_a([],al([],w,y)),M=a.globeMatrix,k=[M[12],M[13],M[14]],F=al([],k,y),U=sl(F),z=_a([],F),Z=a.worldSize/(2*Math.PI),te=su(z,E),ie=Math.asin(Z/U);if(ie<Math.acos(te)){if(!p)return null;const Gt=[],ht=[];Hs(Gt,E,U/te),_a(ht,al(ht,Gt,F)),_a(E,Ba(E,F,Hs(E,ht,Math.tan(ie)*U)))}const K=[];new Fv(y,E).closestPointOnSphere(k,Z,K);const pe=_a([],_s(M,0)),Ee=_a([],_s(M,1)),xe=_a([],_s(M,2)),we=su(pe,K),Ce=su(Ee,K),Le=su(xe,K),ke=Pt(Math.asin(-Ce/Z));let st=Pt(Math.atan2(we,Le));st=a.center.lng+function(Gt,ht){const Tt=(ht-Gt+180)%360-180;return Tt<-180?Tt+360:Tt}(a.center.lng,st);const rt=Ju(st),bt=Bt(ed(ke),0,1);return new Ff(rt,bt)}class rx{constructor(o,l,p){this.a=al([],o,p),this.b=al([],l,p),this.center=p;const y=_a([],this.a),w=_a([],this.b);this.angle=Math.acos(su(y,w))}}function R_(a,o){if(0===a.angle)return null;let l;return l=0===a.a[o]?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[o]/a.a[o]/Math.sin(a.angle)-1/Math.tan(a.angle)),l<0||l>1?null:function(p,y,w,E){const M=Math.sin(w);return p*(Math.sin((1-E)*w)/M)+y*(Math.sin(E*w)/M)}(a.a[o],a.b[o],a.angle,Bt(l,0,1))+a.center[o]}function Vl(a){if(a.z<=1)return Yp[a.z+2*a.y+a.x];const o=Xp(Kp(a));return ya.fromPoints(o)}function Of(a,o,l){return Hs(a,a,1-l),Qm(a,a,o,l)}function ox(a,o){const l=Jp(o.zoom);if(0===l)return Vl(a);const p=Kp(a),y=Xp(p),w=Ju(p.getWest())*o.worldSize,E=Ju(p.getEast())*o.worldSize,M=ed(p.getNorth())*o.worldSize,k=ed(p.getSouth())*o.worldSize,F=[w,M,0],U=[E,M,0],z=[w,k,0],Z=[E,k,0],te=Xm([],o.globeMatrix);return mo(F,F,te),mo(U,U,te),mo(z,z,te),mo(Z,Z,te),y[0]=Of(y[0],z,l),y[1]=Of(y[1],Z,l),y[2]=Of(y[2],U,l),y[3]=Of(y[3],F,l),ya.fromPoints(y)}function sx(a,o,l){for(const p of a)mo(p,p,o),Hs(p,p,l)}function Kp({x:a,y:o,z:l}){const p=1/(1<<l),y=new tr(Va(a*p),Qs((o+1)*p)),w=new tr(Va((a+1)*p),Qs(o*p));return new gc(y,w)}function Xp(a){const o=Ct(a.getNorth()),l=Ct(a.getSouth()),p=Math.cos(o),y=Math.cos(l),w=Math.sin(o),E=Math.sin(l),M=a.getWest(),k=a.getEast();return[Bh(y,E,M),Bh(y,E,k),Bh(p,w,k),Bh(p,w,M)]}function Bh(a,o,l,p=ll){return l=Ct(l),[a*Math.sin(l)*p,-o*p,a*Math.cos(l)*p]}function Qu(a,o,l){return Bh(Math.cos(Ct(a)),Math.sin(Ct(a)),o,l)}function Jm(a,o,l,p){const y=1<<l.z,w=(a/Qn+l.x)/y;return Qu(Qs((o/Qn+l.y)/y),Va(w),p)}function L_({min:a,max:o}){return 16383/Math.max(o[0]-a[0],o[1]-a[1],o[2]-a[2])}const eg=new Float64Array(16);function Qp(a){const o=L_(a),l=Gp(eg,[o,o,o]);return Fh(l,l,((p=[])[0]=-(y=a.min)[0],p[1]=-y[1],p[2]=-y[2],p));var p,y}function Lv(a){const o=(p=a.min,(l=eg)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=p[0],l[13]=p[1],l[14]=p[2],l[15]=1,l);var l,p;const y=1/L_(a);return yc(o,o,[y,y,y])}function N_(a,o,l,p,y){const w=function(k){const F=Qn/(2*Math.PI);return k/(2*Math.PI)/F}(l),E=[a,o,-l/(2*Math.PI)],M=_c(new Float64Array(16));return Fh(M,M,E),yc(M,M,[w,w,w]),Nd(M,M,Ct(-y)),$p(M,M,Ct(-p)),M}function Jp(a){return an(5,6,a)}function Nv(a,o){const l=Qu(o.lat,o.lng);return E=(y=Df([],function(ie){const K=Qu(ie._center.lat,ie._center.lng);let pe=Mv([],Lh(0,1,0),K);const Ee=D_([],-ie.angle,K);pe=mo(pe,pe,Ee),D_(Ee,-ie._pitch,pe);const xe=_a([],K);return Hs(xe,xe,bc(ie.cameraToCenterDistance/ie.pixelsPerMeter)),mo(xe,xe,Ee),Ba([],K,xe)}(a),l))[0],M=y[1],k=y[2],F=(w=l)[0],U=w[1],z=w[2],te=(Z=Math.sqrt(E*E+M*M+k*k)*Math.sqrt(F*F+U*U+z*z))&&su(y,w)/Z,Math.acos(Math.min(Math.max(te,-1),1));var y,w,E,M,k,F,U,z,Z,te}function tg(a,o){return Nv(a,o)>Math.PI/2*1.01}const Qo=Ct(85),R1=Math.cos(Qo),F1=Math.sin(Qo),zd=6371008.8,ul=2*Math.PI*zd;class tr{constructor(o,l){if(isNaN(o)||isNaN(l))throw new Error(`Invalid LngLat object: (${o}, ${l})`);if(this.lng=+o,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new tr(oi(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const l=Math.PI/180,p=this.lat*l,y=o.lat*l,w=Math.sin(p)*Math.sin(y)+Math.cos(p)*Math.cos(y)*Math.cos((o.lng-this.lng)*l);return zd*Math.acos(Math.min(w,1))}toBounds(o=0){const l=360*o/40075017,p=l/Math.cos(Math.PI/180*this.lat);return new gc(new tr(this.lng-p,this.lat-l),new tr(this.lng+p,this.lat+l))}toEcef(o){const l=bc(o);return Qu(this.lat,this.lng,ll+l)}static convert(o){if(o instanceof tr)return o;if(Array.isArray(o)&&(2===o.length||3===o.length))return new tr(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&"object"==typeof o&&null!==o)return new tr(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function kf(a){return ul*Math.cos(a*Math.PI/180)}function Ju(a){return(180+a)/360}function ed(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Ul(a,o){return a/kf(o)}function Va(a){return 360*a-180}function Qs(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function em(a,o){return a*kf(Qs(o))}const Eo=85.051129;function Rf(a){return 1/Math.cos(a*Math.PI/180)}class Ff{constructor(o,l,p=0){this.x=+o,this.y=+l,this.z=+p}static fromLngLat(o,l=0){const p=tr.convert(o);return new Ff(Ju(p.lng),ed(p.lat),Ul(l,p.lat))}toLngLat(){return new tr(Va(this.x),Qs(this.y))}toAltitude(){return em(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ul*Rf(Qs(this.y))}}function z_(a,o,l,p,y,w,E,M,k){const F=(o+p)/2,U=(l+y)/2,z=new Ye(F,U);M(z),function(Z,te,ie,K,pe,Ee){const xe=ie-pe,we=K-Ee;return Math.abs((K-te)*xe-(ie-Z)*we)/Math.hypot(xe,we)}(z.x,z.y,w.x,w.y,E.x,E.y)>=k?(z_(a,o,l,F,U,w,z,M,k),z_(a,F,U,p,y,z,E,M,k)):a.push(E)}function ng(a,o,l){let p=a[0],y=p.x,w=p.y;o(p);const E=[p];for(let M=1;M<a.length;M++){const k=a[M],{x:F,y:U}=k;o(k),z_(E,y,w,F,U,p,k,o,l),y=F,w=U,p=k}return E}function Lf(a,o,l,p){if(p(o,l)){const y=o.add(l)._mult(.5);Lf(a,o,y,p),Lf(a,y,l,p)}else a.push(l)}function ax(a,o){let l=a[0];const p=[l];for(let y=1;y<a.length;y++){const w=a[y];Lf(p,l,w,o),l=w}return p}const B_=Math.pow(2,14)-1,V_=-B_-1;function HT(a,o){const l=Math.round(a.x*o),p=Math.round(a.y*o);return a.x=Bt(l,V_,B_),a.y=Bt(p,V_,B_),(l<a.x||l>a.x+1||p<a.y||p>a.y+1)&&Pi("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function au(a,o,l){const p=a.loadGeometry(),y=a.extent,w=Qn/y;if(o&&l&&l.projection.isReprojectedInTileSpace){const E=1<<o.z,{scale:M,x:k,y:F,projection:U}=l,z=Z=>{const te=Va((o.x+Z.x/y)/E),ie=Qs((o.y+Z.y/y)/E),K=U.project(te,ie);Z.x=(K.x*M-k)*y,Z.y=(K.y*M-F)*y};for(let Z=0;Z<p.length;Z++)if(1!==a.type)p[Z]=ng(p[Z],z,1);else{const te=[];for(const ie of p[Z])ie.x<0||ie.x>=y||ie.y<0||ie.y>=y||(z(ie),te.push(ie));p[Z]=te}}for(const E of p)for(const M of E)HT(M,w);return p}function Nf(a,o){return{type:a.type,id:a.id,properties:a.properties,geometry:o?au(a):[]}}function ig(a,o,l,p,y){a.emplaceBack(2*o+(p+1)/2,2*l+(y+1)/2)}function rg(a,o,l){a.emplaceBack(o.x,o.y,o.z,16384*l[0],16384*l[1],16384*l[2])}class tm{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new Bn,this.indexArray=new ho,this.segments=new Zr,this.programConfigurations=new mc(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(o,l,p,y){const w=this.layers[0],E=[];let M=null;"circle"===w.type&&(M=w.layout.get("circle-sort-key"));for(const{feature:F,id:U,index:z,sourceLayerIndex:Z}of o){const te=this.layers[0]._featureFilter.needGeometry,ie=Nf(F,te);if(!this.layers[0]._featureFilter.filter(new Ze(this.zoom),ie,p))continue;const K=M?M.evaluate(ie,{},p):void 0,pe={id:U,properties:F.properties,type:F.type,sourceLayerIndex:Z,index:z,geometry:te?ie.geometry:au(F,p,y),patterns:{},sortKey:K};E.push(pe)}M&&E.sort((F,U)=>F.sortKey-U.sortKey);let k=null;"globe"===y.projection.name&&(this.globeExtVertexArray=new Gs,k=y.projection);for(const F of E){const{geometry:U,index:z,sourceLayerIndex:Z}=F,te=o[z].feature;this.addFeature(F,U,z,l.availableImages,p,k),l.featureIndex.insert(te,U,z,Z,this.index)}}update(o,l,p,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,p,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Oh.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,ex.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,l,p,y,w,E){for(const M of l)for(const k of M){const F=k.x,U=k.y;if(F<0||F>=Qn||U<0||U>=Qn)continue;if(E){const te=E.projectTilePoint(F,U,w),ie=E.upVector(w,F,U),K=this.globeExtVertexArray;rg(K,te,ie),rg(K,te,ie),rg(K,te,ie),rg(K,te,ie)}const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),Z=z.vertexLength;ig(this.layoutVertexArray,F,U,-1,-1),ig(this.layoutVertexArray,F,U,1,-1),ig(this.layoutVertexArray,F,U,1,1),ig(this.layoutVertexArray,F,U,-1,1),this.indexArray.emplaceBack(Z,Z+1,Z+2),this.indexArray.emplaceBack(Z,Z+2,Z+3),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,p,{},y,w)}}function lu(a,o){for(let l=0;l<a.length;l++)if(Bd(o,a[l]))return!0;for(let l=0;l<o.length;l++)if(Bd(a,o[l]))return!0;return!!zv(a,o)}function nm(a,o,l){return!!Bd(a,o)||!!im(o,a,l)}function U_(a,o){if(1===a.length)return Vv(o,a[0]);for(let l=0;l<o.length;l++){const p=o[l];for(let y=0;y<p.length;y++)if(Bd(a,p[y]))return!0}for(let l=0;l<a.length;l++)if(Vv(o,a[l]))return!0;for(let l=0;l<o.length;l++)if(zv(a,o[l]))return!0;return!1}function j_(a,o,l){if(a.length>1){if(zv(a,o))return!0;for(let p=0;p<o.length;p++)if(im(o[p],a,l))return!0}for(let p=0;p<a.length;p++)if(im(a[p],o,l))return!0;return!1}function zv(a,o){if(0===a.length||0===o.length)return!1;for(let l=0;l<a.length-1;l++){const p=a[l],y=a[l+1];for(let w=0;w<o.length-1;w++)if(Bv(p,y,o[w],o[w+1]))return!0}return!1}function Bv(a,o,l,p){return dr(a,l,p)!==dr(o,l,p)&&dr(a,o,l)!==dr(a,o,p)}function im(a,o,l){const p=l*l;if(1===o.length)return a.distSqr(o[0])<p;for(let y=1;y<o.length;y++)if(Vh(a,o[y-1],o[y])<p)return!0;return!1}function Vh(a,o,l){const p=o.distSqr(l);if(0===p)return a.distSqr(o);const y=((a.x-o.x)*(l.x-o.x)+(a.y-o.y)*(l.y-o.y))/p;return a.distSqr(y<0?o:y>1?l:l.sub(o)._mult(y)._add(o))}function Vv(a,o){let l,p,y,w=!1;for(let E=0;E<a.length;E++){l=a[E];for(let M=0,k=l.length-1;M<l.length;k=M++)p=l[M],y=l[k],p.y>o.y!=y.y>o.y&&o.x<(y.x-p.x)*(o.y-p.y)/(y.y-p.y)+p.x&&(w=!w)}return w}function Bd(a,o){let l=!1;for(let p=0,y=a.length-1;p<a.length;y=p++){const w=a[p],E=a[y];w.y>o.y!=E.y>o.y&&o.x<(E.x-w.x)*(o.y-w.y)/(E.y-w.y)+w.x&&(l=!l)}return l}function lx(a,o,l,p,y){for(const E of a)if(o<=E.x&&l<=E.y&&p>=E.x&&y>=E.y)return!0;const w=[new Ye(o,l),new Ye(o,y),new Ye(p,y),new Ye(p,l)];if(a.length>2)for(const E of w)if(Bd(a,E))return!0;for(let E=0;E<a.length-1;E++)if(cx(a[E],a[E+1],w))return!0;return!1}function cx(a,o,l){const p=l[0],y=l[2];if(a.x<p.x&&o.x<p.x||a.x>y.x&&o.x>y.x||a.y<p.y&&o.y<p.y||a.y>y.y&&o.y>y.y)return!1;const w=dr(a,o,l[0]);return w!==dr(a,o,l[1])||w!==dr(a,o,l[2])||w!==dr(a,o,l[3])}function zf(a,o,l){const p=o.paint.get(a).value;return"constant"===p.kind?p.value:l.programConfigurations.get(o.id).getMaxValue(a)}function cu(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Uv(a,o,l,p,y){if(!o[0]&&!o[1])return a;const w=Ye.convert(o)._mult(y);"viewport"===l&&w._rotate(-p);const E=[];for(let M=0;M<a.length;M++)E.push(a[M].sub(w));return E}function $_(a,o,l,p){const y=Ye.convert(a)._mult(p);return"viewport"===o&&y._rotate(-l),y}mn(tm,"CircleBucket",{omit:["layers"]});const G_=new Lt({"circle-sort-key":new Xe(ut.layout_circle["circle-sort-key"])});var jv={paint:new Lt({"circle-radius":new Xe(ut.paint_circle["circle-radius"]),"circle-color":new Xe(ut.paint_circle["circle-color"]),"circle-blur":new Xe(ut.paint_circle["circle-blur"]),"circle-opacity":new Xe(ut.paint_circle["circle-opacity"]),"circle-translate":new qe(ut.paint_circle["circle-translate"]),"circle-translate-anchor":new qe(ut.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new qe(ut.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new qe(ut.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Xe(ut.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Xe(ut.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Xe(ut.paint_circle["circle-stroke-opacity"])}),layout:G_};function ux(a,o,l,p,y,w,E,M,k){if(w&&a.queryGeometry.isAboveHorizon)return!1;w&&(k*=a.pixelToTileUnitsFactor);const F=a.tileID.canonical,U=l.projection.upVectorScale(F,l.center.lat,l.worldSize).metersToTile;for(const z of o)for(const Z of z){const te=Z.add(M),ie=y&&l.elevation?l.elevation.exaggeration()*y.getElevationAt(te.x,te.y,!0):0,K=l.projection.projectTilePoint(te.x,te.y,F);if(ie>0){const we=l.projection.upVector(F,te.x,te.y);K.x+=we[0]*U*ie,K.y+=we[1]*U*ie,K.z+=we[2]*U*ie}const pe=w?te:dx(K.x,K.y,K.z,p),Ee=w?a.tilespaceRays.map(we=>L1(we,ie)):a.queryGeometry.screenGeometry,xe=zl([],[K.x,K.y,K.z,1],p);if(!E&&w?k*=xe[3]/l.cameraToCenterDistance:E&&!w&&(k*=l.cameraToCenterDistance/xe[3]),w){const we=Qs((Z.y/Qn+F.y)/(1<<F.z));k/=l.projection.pixelsPerMeter(we,1)/Ul(1,we)}if(nm(Ee,pe,k))return!0}return!1}function dx(a,o,l,p){const y=zl([],[a,o,l,1],p);return new Ye(y[0]/y[3],y[1]/y[3])}const hx=Lh(0,0,0),og=Lh(0,0,1);function L1(a,o){const l=A_();return hx[2]=o,a.intersectsPlane(hx,og,l),new Ye(l[0],l[1])}class $v extends tm{}function Vd(a,{width:o,height:l},p,y){if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==o*l*p)throw new RangeError("mismatched image size")}else y=new Uint8Array(o*l*p);return a.width=o,a.height=l,a.data=y,a}function sg(a,o,l){const{width:p,height:y}=o;p===a.width&&y===a.height||(Ud(a,o,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,p),height:Math.min(a.height,y)},l),a.width=p,a.height=y,a.data=o.data)}function Ud(a,o,l,p,y,w){if(0===y.width||0===y.height)return o;if(y.width>a.width||y.height>a.height||l.x>a.width-y.width||l.y>a.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>o.width||y.height>o.height||p.x>o.width-y.width||p.y>o.height-y.height)throw new RangeError("out of range destination coordinates for image copy");const E=a.data,M=o.data;for(let k=0;k<y.height;k++){const F=((l.y+k)*a.width+l.x)*w,U=((p.y+k)*o.width+p.x)*w;for(let z=0;z<y.width*w;z++)M[U+z]=E[F+z]}return o}mn($v,"HeatmapBucket",{omit:["layers"]});class Js{constructor(o,l){Vd(this,o,1,l)}resize(o){sg(this,new Js(o),1)}clone(){return new Js({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,p,y,w){Ud(o,l,p,y,w,1)}}class Ua{constructor(o,l){Vd(this,o,4,l)}resize(o){sg(this,new Ua(o),4)}replace(o,l){l?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new Ua({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,p,y,w){Ud(o,l,p,y,w,4)}}mn(Js,"AlphaImage"),mn(Ua,"RGBAImage");var fx={paint:new Lt({"heatmap-radius":new Xe(ut.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Xe(ut.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new qe(ut.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mt(ut.paint_heatmap["heatmap-color"]),"heatmap-opacity":new qe(ut.paint_heatmap["heatmap-opacity"])})};function Gv(a){const o={},l=a.resolution||256,p=a.clips?a.clips.length:1,y=a.image||new Ua({width:l,height:p}),w=(E,M,k)=>{o[a.evaluationKey]=k;const F=a.expression.evaluate(o);y.data[E+M+0]=Math.floor(255*F.r/F.a),y.data[E+M+1]=Math.floor(255*F.g/F.a),y.data[E+M+2]=Math.floor(255*F.b/F.a),y.data[E+M+3]=Math.floor(255*F.a)};if(a.clips)for(let E=0,M=0;E<p;++E,M+=4*l)for(let k=0,F=0;k<l;k++,F+=4){const U=k/(l-1),{start:z,end:Z}=a.clips[E];w(M,F,z*(1-U)+Z*U)}else for(let E=0,M=0;E<l;E++,M+=4)w(0,M,E/(l-1));return y}var N1={paint:new Lt({"hillshade-illumination-direction":new qe(ut.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new qe(ut.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new qe(ut.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new qe(ut.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new qe(ut.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new qe(ut.paint_hillshade["hillshade-accent-color"])})};const z1=yn([{name:"a_pos",components:2,type:"Int16"}],4),{members:px}=z1;var Uh={};function rm(a,o,l){l=l||2;var p,y,w,E,M,k,F,U=o&&o.length,z=U?o[0]*l:a.length,Z=H_(a,0,z,l,!0),te=[];if(!Z||Z.next===Z.prev)return te;if(U&&(Z=function(K,pe,Ee,xe){var we,Ce,Le,ke=[];for(we=0,Ce=pe.length;we<Ce;we++)(Le=H_(K,pe[we]*xe,we<Ce-1?pe[we+1]*xe:K.length,xe,!1))===Le.next&&(Le.steiner=!0),ke.push(Uf(Le));for(ke.sort(U1),we=0;we<ke.length;we++)Ee=Hv(ke[we],Ee);return Ee}(a,o,Z,l)),a.length>80*l){p=w=a[0],y=E=a[1];for(var ie=l;ie<z;ie+=l)(M=a[ie])<p&&(p=M),(k=a[ie+1])<y&&(y=k),M>w&&(w=M),k>E&&(E=k);F=0!==(F=Math.max(w-p,E-y))?32767/F:0}return Vf(Z,te,l,p,y,F,0),te}function H_(a,o,l,p,y){var w,E;if(y===Yv(a,o,l,p)>0)for(w=o;w<l;w+=p)E=Zv(w,a[w],a[w+1],E);else for(w=l-p;w>=o;w-=p)E=Zv(w,a[w],a[w+1],E);return E&&qv(E,E.next)&&(uu(E),E=E.next),E}function Bf(a,o){if(!a)return a;o||(o=a);var l,p=a;do{if(l=!1,p.steiner||!qv(p,p.next)&&0!==jo(p.prev,p,p.next))p=p.next;else{if(uu(p),(p=o=p.prev)===p.next)break;l=!0}}while(l||p!==o);return o}function Vf(a,o,l,p,y,w,E){if(a){!E&&w&&function(U,z,Z,te){var ie=U;do{0===ie.z&&(ie.z=_x(ie.x,ie.y,z,Z,te)),ie.prevZ=ie.prev,ie.nextZ=ie.next,ie=ie.next}while(ie!==U);ie.prevZ.nextZ=null,ie.prevZ=null,function(K){var pe,Ee,xe,we,Ce,Le,ke,st,rt=1;do{for(Ee=K,K=null,Ce=null,Le=0;Ee;){for(Le++,xe=Ee,ke=0,pe=0;pe<rt&&(ke++,xe=xe.nextZ);pe++);for(st=rt;ke>0||st>0&&xe;)0!==ke&&(0===st||!xe||Ee.z<=xe.z)?(we=Ee,Ee=Ee.nextZ,ke--):(we=xe,xe=xe.nextZ,st--),Ce?Ce.nextZ=we:K=we,we.prevZ=Ce,Ce=we;Ee=xe}Ce.nextZ=null,rt*=2}while(Le>1)}(ie)}(a,p,y,w);for(var M,k,F=a;a.prev!==a.next;)if(M=a.prev,k=a.next,w?B1(a,p,y,w):ag(a))o.push(M.i/l|0),o.push(a.i/l|0),o.push(k.i/l|0),uu(a),a=k.next,F=k.next;else if((a=k)===F){E?1===E?Vf(a=V1(Bf(a),o,l),o,l,p,y,w,2):2===E&&mx(a,o,l,p,y,w):Vf(Bf(a),o,l,p,y,w,1);break}}}function ag(a){var o=a.prev,l=a,p=a.next;if(jo(o,l,p)>=0)return!1;for(var y=o.x,w=l.x,E=p.x,M=o.y,k=l.y,F=p.y,U=y<w?y<E?y:E:w<E?w:E,z=M<k?M<F?M:F:k<F?k:F,Z=y>w?y>E?y:E:w>E?w:E,te=M>k?M>F?M:F:k>F?k:F,ie=p.next;ie!==o;){if(ie.x>=U&&ie.x<=Z&&ie.y>=z&&ie.y<=te&&ja(y,M,w,k,E,F,ie.x,ie.y)&&jo(ie.prev,ie,ie.next)>=0)return!1;ie=ie.next}return!0}function B1(a,o,l,p){var y=a.prev,w=a,E=a.next;if(jo(y,w,E)>=0)return!1;for(var M=y.x,k=w.x,F=E.x,U=y.y,z=w.y,Z=E.y,te=M<k?M<F?M:F:k<F?k:F,ie=U<z?U<Z?U:Z:z<Z?z:Z,K=M>k?M>F?M:F:k>F?k:F,pe=U>z?U>Z?U:Z:z>Z?z:Z,Ee=_x(te,ie,o,l,p),xe=_x(K,pe,o,l,p),we=a.prevZ,Ce=a.nextZ;we&&we.z>=Ee&&Ce&&Ce.z<=xe;){if(we.x>=te&&we.x<=K&&we.y>=ie&&we.y<=pe&&we!==y&&we!==E&&ja(M,U,k,z,F,Z,we.x,we.y)&&jo(we.prev,we,we.next)>=0||(we=we.prevZ,Ce.x>=te&&Ce.x<=K&&Ce.y>=ie&&Ce.y<=pe&&Ce!==y&&Ce!==E&&ja(M,U,k,z,F,Z,Ce.x,Ce.y)&&jo(Ce.prev,Ce,Ce.next)>=0))return!1;Ce=Ce.nextZ}for(;we&&we.z>=Ee;){if(we.x>=te&&we.x<=K&&we.y>=ie&&we.y<=pe&&we!==y&&we!==E&&ja(M,U,k,z,F,Z,we.x,we.y)&&jo(we.prev,we,we.next)>=0)return!1;we=we.prevZ}for(;Ce&&Ce.z<=xe;){if(Ce.x>=te&&Ce.x<=K&&Ce.y>=ie&&Ce.y<=pe&&Ce!==y&&Ce!==E&&ja(M,U,k,z,F,Z,Ce.x,Ce.y)&&jo(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.nextZ}return!0}function V1(a,o,l){var p=a;do{var y=p.prev,w=p.next.next;!qv(y,w)&&$1(y,p,p.next,w)&&jf(y,w)&&jf(w,y)&&(o.push(y.i/l|0),o.push(p.i/l|0),o.push(w.i/l|0),uu(p),uu(p.next),p=a=w),p=p.next}while(p!==a);return Bf(p)}function mx(a,o,l,p,y,w){var E=a;do{for(var M=E.next.next;M!==E.prev;){if(E.i!==M.i&&j1(E,M)){var k=cg(E,M);return E=Bf(E,E.next),k=Bf(k,k.next),Vf(E,o,l,p,y,w,0),void Vf(k,o,l,p,y,w,0)}M=M.next}E=E.next}while(E!==a)}function U1(a,o){return a.x-o.x}function Hv(a,o){var l=function(y,w){var E,M=w,k=y.x,F=y.y,U=-1/0;do{if(F<=M.y&&F>=M.next.y&&M.next.y!==M.y){var z=M.x+(F-M.y)*(M.next.x-M.x)/(M.next.y-M.y);if(z<=k&&z>U&&(U=z,E=M.x<M.next.x?M:M.next,z===k))return E}M=M.next}while(M!==w);if(!E)return null;var Z,te=E,ie=E.x,K=E.y,pe=1/0;M=E;do{k>=M.x&&M.x>=ie&&k!==M.x&&ja(F<K?k:U,F,ie,K,F<K?U:k,F,M.x,M.y)&&(Z=Math.abs(F-M.y)/(k-M.x),jf(M,y)&&(Z<pe||Z===pe&&(M.x>E.x||M.x===E.x&&gx(E,M)))&&(E=M,pe=Z)),M=M.next}while(M!==te);return E}(a,o);if(!l)return o;var p=cg(l,a);return Bf(p,p.next),Bf(l,l.next)}function gx(a,o){return jo(a.prev,a,o.prev)<0&&jo(o.next,a,a.next)<0}function _x(a,o,l,p,y){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-l)*y|0)|a<<8))|a<<4))|a<<2))|a<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-p)*y|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function Uf(a){var o=a,l=a;do{(o.x<l.x||o.x===l.x&&o.y<l.y)&&(l=o),o=o.next}while(o!==a);return l}function ja(a,o,l,p,y,w,E,M){return(y-E)*(o-M)>=(a-E)*(w-M)&&(a-E)*(p-M)>=(l-E)*(o-M)&&(l-E)*(w-M)>=(y-E)*(p-M)}function j1(a,o){return a.next.i!==o.i&&a.prev.i!==o.i&&!function(l,p){var y=l;do{if(y.i!==l.i&&y.next.i!==l.i&&y.i!==p.i&&y.next.i!==p.i&&$1(y,y.next,l,p))return!0;y=y.next}while(y!==l);return!1}(a,o)&&(jf(a,o)&&jf(o,a)&&function(l,p){var y=l,w=!1,E=(l.x+p.x)/2,M=(l.y+p.y)/2;do{y.y>M!=y.next.y>M&&y.next.y!==y.y&&E<(y.next.x-y.x)*(M-y.y)/(y.next.y-y.y)+y.x&&(w=!w),y=y.next}while(y!==l);return w}(a,o)&&(jo(a.prev,a,o.prev)||jo(a,o.prev,o))||qv(a,o)&&jo(a.prev,a,a.next)>0&&jo(o.prev,o,o.next)>0)}function jo(a,o,l){return(o.y-a.y)*(l.x-o.x)-(o.x-a.x)*(l.y-o.y)}function qv(a,o){return a.x===o.x&&a.y===o.y}function $1(a,o,l,p){var y=Wv(jo(a,o,l)),w=Wv(jo(a,o,p)),E=Wv(jo(l,p,a)),M=Wv(jo(l,p,o));return y!==w&&E!==M||!(0!==y||!lg(a,l,o))||!(0!==w||!lg(a,p,o))||!(0!==E||!lg(l,a,p))||!(0!==M||!lg(l,o,p))}function lg(a,o,l){return o.x<=Math.max(a.x,l.x)&&o.x>=Math.min(a.x,l.x)&&o.y<=Math.max(a.y,l.y)&&o.y>=Math.min(a.y,l.y)}function Wv(a){return a>0?1:a<0?-1:0}function jf(a,o){return jo(a.prev,a,a.next)<0?jo(a,o,a.next)>=0&&jo(a,a.prev,o)>=0:jo(a,o,a.prev)<0||jo(a,a.next,o)<0}function cg(a,o){var l=new ug(a.i,a.x,a.y),p=new ug(o.i,o.x,o.y),y=a.next,w=o.prev;return a.next=o,o.prev=a,l.next=y,y.prev=l,p.next=l,l.prev=p,w.next=p,p.prev=w,p}function Zv(a,o,l,p){var y=new ug(a,o,l);return p?(y.next=p.next,y.prev=p,p.next.prev=y,p.next=y):(y.prev=y,y.next=y),y}function uu(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function ug(a,o,l){this.i=a,this.x=o,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Yv(a,o,l,p){for(var y=0,w=o,E=l-p;w<l;w+=p)y+=(a[E]-a[w])*(a[w+1]+a[E+1]),E=w;return y}function xc(a,o,l,p,y){dg(a,o,l||0,p||a.length-1,y||yx)}function dg(a,o,l,p,y){for(;p>l;){if(p-l>600){var w=p-l+1,E=o-l+1,M=Math.log(w),k=.5*Math.exp(2*M/3),F=.5*Math.sqrt(M*k*(w-k)/w)*(E-w/2<0?-1:1);dg(a,o,Math.max(l,Math.floor(o-E*k/w+F)),Math.min(p,Math.floor(o+(w-E)*k/w+F)),y)}var U=a[o],z=l,Z=p;for(jd(a,l,o),y(a[p],U)>0&&jd(a,l,p);z<Z;){for(jd(a,z,Z),z++,Z--;y(a[z],U)<0;)z++;for(;y(a[Z],U)>0;)Z--}0===y(a[l],U)?jd(a,l,Z):jd(a,++Z,p),Z<=o&&(l=Z+1),o<=Z&&(p=Z-1)}}function jd(a,o,l){var p=a[o];a[o]=a[l],a[l]=p}function yx(a,o){return a<o?-1:a>o?1:0}function q_(a,o){const l=a.length;if(l<=1)return[a];const p=[];let y,w;for(let E=0;E<l;E++){const M=Vn(a[E]);0!==M&&(a[E].area=Math.abs(M),void 0===w&&(w=M<0),w===M<0?(y&&p.push(y),y=[a[E]]):y.push(a[E]))}if(y&&p.push(y),o>1)for(let E=0;E<p.length;E++)p[E].length<=o||(xc(p[E],o,1,p[E].length-1,G1),p[E]=p[E].slice(0,o));return p}function G1(a,o){return o.area-a.area}function Kv(a,o,l){const p=l.patternDependencies;let y=!1;for(const w of o){const E=w.paint.get(`${a}-pattern`);E.isConstant()||(y=!0);const M=E.constantOr(null);M&&(y=!0,p[M]=!0)}return y}function W_(a,o,l,p,y){const w=y.patternDependencies;for(const E of o){const M=E.paint.get(`${a}-pattern`).value;if("constant"!==M.kind){let k=M.evaluate({zoom:p},l,{},y.availableImages);k=k&&k.name?k.name:k,w[k]=!0,l.patterns[E.id]=k}}return l}({get exports(){return Uh},set exports(a){Uh=a}}).exports=rm,Uh.default=rm,rm.deviation=function(a,o,l,p){var y=o&&o.length,w=Math.abs(Yv(a,0,y?o[0]*l:a.length,l));if(y)for(var E=0,M=o.length;E<M;E++)w-=Math.abs(Yv(a,o[E]*l,E<M-1?o[E+1]*l:a.length,l));var k=0;for(E=0;E<p.length;E+=3){var F=p[E]*l,U=p[E+1]*l,z=p[E+2]*l;k+=Math.abs((a[F]-a[z])*(a[U+1]-a[F+1])-(a[F]-a[U])*(a[z+1]-a[F+1]))}return 0===w&&0===k?0:Math.abs((k-w)/w)},rm.flatten=function(a){for(var o=a[0][0].length,l={vertices:[],holes:[],dimensions:o},p=0,y=0;y<a.length;y++){for(var w=0;w<a[y].length;w++)for(var E=0;E<o;E++)l.vertices.push(a[y][w][E]);y>0&&l.holes.push(p+=a[y-1].length)}return l};class Z_{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Bn,this.indexArray=new ho,this.indexArray2=new Ll,this.programConfigurations=new mc(o.layers,o.zoom),this.segments=new Zr,this.segments2=new Zr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=o.projection}populate(o,l,p,y){this.hasPattern=Kv("fill",this.layers,l);const w=this.layers[0].layout.get("fill-sort-key"),E=[];for(const{feature:M,id:k,index:F,sourceLayerIndex:U}of o){const z=this.layers[0]._featureFilter.needGeometry,Z=Nf(M,z);if(!this.layers[0]._featureFilter.filter(new Ze(this.zoom),Z,p))continue;const te=w?w.evaluate(Z,{},p,l.availableImages):void 0,ie={id:k,properties:M.properties,type:M.type,sourceLayerIndex:U,index:F,geometry:z?Z.geometry:au(M,p,y),patterns:{},sortKey:te};E.push(ie)}w&&E.sort((M,k)=>M.sortKey-k.sortKey);for(const M of E){const{geometry:k,index:F,sourceLayerIndex:U}=M;if(this.hasPattern){const z=W_("fill",this.layers,M,this.zoom,l);this.patternFeatures.push(z)}else this.addFeature(M,k,F,p,{},l.availableImages);l.featureIndex.insert(o[F].feature,k,F,U,this.index)}}update(o,l,p,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,p,y)}addFeatures(o,l,p,y,w){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,l,p,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,px),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,l,p,y,w,E=[]){for(const M of q_(l,500)){let k=0;for(const ie of M)k+=ie.length;const F=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),U=F.vertexLength,z=[],Z=[];for(const ie of M){if(0===ie.length)continue;ie!==M[0]&&Z.push(z.length/2);const K=this.segments2.prepareSegment(ie.length,this.layoutVertexArray,this.indexArray2),pe=K.vertexLength;this.layoutVertexArray.emplaceBack(ie[0].x,ie[0].y),this.indexArray2.emplaceBack(pe+ie.length-1,pe),z.push(ie[0].x),z.push(ie[0].y);for(let Ee=1;Ee<ie.length;Ee++)this.layoutVertexArray.emplaceBack(ie[Ee].x,ie[Ee].y),this.indexArray2.emplaceBack(pe+Ee-1,pe+Ee),z.push(ie[Ee].x),z.push(ie[Ee].y);K.vertexLength+=ie.length,K.primitiveLength+=ie.length}const te=Uh(z,Z);for(let ie=0;ie<te.length;ie+=3)this.indexArray.emplaceBack(U+te[ie],U+te[ie+1],U+te[ie+2]);F.vertexLength+=k,F.primitiveLength+=te.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,p,w,E,y)}}mn(Z_,"FillBucket",{omit:["layers","patternFeatures"]});const H1=new Lt({"fill-sort-key":new Xe(ut.layout_fill["fill-sort-key"])});var Y_={paint:new Lt({"fill-antialias":new qe(ut.paint_fill["fill-antialias"]),"fill-opacity":new Xe(ut.paint_fill["fill-opacity"]),"fill-color":new Xe(ut.paint_fill["fill-color"]),"fill-outline-color":new Xe(ut.paint_fill["fill-outline-color"]),"fill-translate":new qe(ut.paint_fill["fill-translate"]),"fill-translate-anchor":new qe(ut.paint_fill["fill-translate-anchor"]),"fill-pattern":new Xe(ut.paint_fill["fill-pattern"])}),layout:H1};const Bi=yn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),vx=yn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),K_=yn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:bx}=Bi;var X_={},q1=Ye,Xv=Oo;function Oo(a,o,l,p,y){this.properties={},this.extent=l,this.type=0,this._pbf=a,this._geometry=-1,this._keys=p,this._values=y,a.readFields(xx,this,o)}function xx(a,o,l){1==a?o.id=l.readVarint():2==a?function(p,y){for(var w=p.readVarint()+p.pos;p.pos<w;){var E=y._keys[p.readVarint()],M=y._values[p.readVarint()];y.properties[E]=M}}(l,o):3==a?o.type=l.readVarint():4==a&&(o._geometry=l.pos)}function om(a){for(var o,l,p=0,y=0,w=a.length,E=w-1;y<w;E=y++)p+=((l=a[E]).x-(o=a[y]).x)*(o.y+l.y);return p}Oo.types=["Unknown","Point","LineString","Polygon"],Oo.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var o,l=a.readVarint()+a.pos,p=1,y=0,w=0,E=0,M=[];a.pos<l;){if(y<=0){var k=a.readVarint();p=7&k,y=k>>3}if(y--,1===p||2===p)w+=a.readSVarint(),E+=a.readSVarint(),1===p&&(o&&M.push(o),o=[]),o.push(new q1(w,E));else{if(7!==p)throw new Error("unknown command "+p);o&&o.push(o[0].clone())}}return o&&M.push(o),M},Oo.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var o=a.readVarint()+a.pos,l=1,p=0,y=0,w=0,E=1/0,M=-1/0,k=1/0,F=-1/0;a.pos<o;){if(p<=0){var U=a.readVarint();l=7&U,p=U>>3}if(p--,1===l||2===l)(y+=a.readSVarint())<E&&(E=y),y>M&&(M=y),(w+=a.readSVarint())<k&&(k=w),w>F&&(F=w);else if(7!==l)throw new Error("unknown command "+l)}return[E,k,M,F]},Oo.prototype.toGeoJSON=function(a,o,l){var p,y,w=this.extent*Math.pow(2,l),E=this.extent*a,M=this.extent*o,k=this.loadGeometry(),F=Oo.types[this.type];function U(te){for(var ie=0;ie<te.length;ie++){var K=te[ie];te[ie]=[360*(K.x+E)/w-180,360/Math.PI*Math.atan(Math.exp((180-360*(K.y+M)/w)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(p=0;p<k.length;p++)z[p]=k[p][0];U(k=z);break;case 2:for(p=0;p<k.length;p++)U(k[p]);break;case 3:for(k=function(te){var ie=te.length;if(ie<=1)return[te];for(var K,pe,Ee=[],xe=0;xe<ie;xe++){var we=om(te[xe]);0!==we&&(void 0===pe&&(pe=we<0),pe===we<0?(K&&Ee.push(K),K=[te[xe]]):K.push(te[xe]))}return K&&Ee.push(K),Ee}(k),p=0;p<k.length;p++)for(y=0;y<k[p].length;y++)U(k[p][y])}1===k.length?k=k[0]:F="Multi"+F;var Z={type:"Feature",geometry:{type:F,coordinates:k},properties:this.properties};return"id"in this&&(Z.id=this.id),Z};var wx=Xv,W1=Q_;function Q_(a,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Z1,this,o),this.length=this._features.length}function Z1(a,o,l){15===a?o.version=l.readVarint():1===a?o.name=l.readString():5===a?o.extent=l.readVarint():2===a?o._features.push(l.pos):3===a?o._keys.push(l.readString()):4===a&&o._values.push(function(p){for(var y=null,w=p.readVarint()+p.pos;p.pos<w;){var E=p.readVarint()>>3;y=1===E?p.readString():2===E?p.readFloat():3===E?p.readDouble():4===E?p.readVarint64():5===E?p.readVarint():6===E?p.readSVarint():7===E?p.readBoolean():null}return y}(l))}Q_.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var o=this._pbf.readVarint()+this._pbf.pos;return new wx(this._pbf,o,this.extent,this._keys,this._values)};var sm=W1;function Y1(a,o,l){if(3===a){var p=new sm(l,l.readVarint()+l.pos);p.length&&(o[p.name]=p)}}var $f=X_.VectorTile=function(a,o){this.layers=a.readFields(Y1,{},o)},Gf=X_.VectorTileFeature=Xv;function va(a,o,l,p){const y=[],w=0===p?(E,M,k,F,U,z)=>{E.push(new Ye(z,k+(z-M)/(F-M)*(U-k)))}:(E,M,k,F,U,z)=>{E.push(new Ye(M+(z-k)/(U-k)*(F-M),z))};for(const E of a){const M=[];for(const k of E){if(k.length<=2)continue;const F=[];for(let Z=0;Z<k.length-1;Z++){const te=k[Z].x,ie=k[Z].y,K=k[Z+1].x,pe=k[Z+1].y,Ee=0===p?te:ie,xe=0===p?K:pe;Ee<o?xe>o&&w(F,te,ie,K,pe,o):Ee>l?xe<l&&w(F,te,ie,K,pe,l):F.push(k[Z]),xe<o&&Ee>=o&&w(F,te,ie,K,pe,o),xe>l&&Ee<=l&&w(F,te,ie,K,pe,l)}let U=k[k.length-1];const z=0===p?U.x:U.y;z>=o&&z<=l&&F.push(U),F.length&&(U=F[F.length-1],F[0].x===U.x&&F[0].y===U.y||F.push(F[0]),M.push(F))}M.length&&y.push(M)}return y}X_.VectorTileLayer=W1;const qT=Gf.types,hg=Math.pow(2,13);function Qv(a,o,l,p,y,w,E,M){a.emplaceBack((o<<1)+E,(l<<1)+w,(Math.floor(p*hg)<<1)+y,Math.round(M))}function am(a,o,l){a.emplaceBack(o.x,o.y,o.z,16384*l[0],16384*l[1],16384*l[2])}class td{constructor(){this.acc=new Ye(0,0),this.polyCount=[]}startRing(o){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Ye(o.x,o.y),this.max=new Ye(o.x,o.y))}append(o,l){this.currentPolyCount.edges++,this.acc._add(o);const p=this.min,y=this.max;o.x<p.x?p.x=o.x:o.x>y.x&&(y.x=o.x),o.y<p.y?p.y=o.y:o.y>y.y&&(y.y=o.y),((0===o.x||o.x===Qn)&&o.x===l.x)!=((0===o.y||o.y===Qn)&&o.y===l.y)&&this.processBorderOverlap(o,l),l.x<0!=o.x<0&&this.addBorderIntersection(0,di(l.y,o.y,(0-l.x)/(o.x-l.x))),l.x>Qn!=o.x>Qn&&this.addBorderIntersection(1,di(l.y,o.y,(Qn-l.x)/(o.x-l.x))),l.y<0!=o.y<0&&this.addBorderIntersection(2,di(l.x,o.x,(0-l.y)/(o.y-l.y))),l.y>Qn!=o.y>Qn&&this.addBorderIntersection(3,di(l.x,o.x,(Qn-l.y)/(o.y-l.y)))}addBorderIntersection(o,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[o];l<p[0]&&(p[0]=l),l>p[1]&&(p[1]=l)}processBorderOverlap(o,l){if(o.x===l.x){if(o.y===l.y)return;const p=0===o.x?0:1;this.addBorderIntersection(p,l.y),this.addBorderIntersection(p,o.y)}else{const p=0===o.y?2:3;this.addBorderIntersection(p,l.x),this.addBorderIntersection(p,o.x)}}centroid(){const o=this.polyCount.reduce((l,p)=>l+p.edges,0);return 0!==o?this.acc.div(o)._round():new Ye(0,0)}span(){return new Ye(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((o,l)=>o+ +(l[0]!==Number.MAX_VALUE),0)}}class lm{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.layoutVertexArray=new Fi,this.centroidVertexArray=new Mh,this.indexArray=new ho,this.programConfigurations=new mc(o.layers,o.zoom),this.segments=new Zr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.enableTerrain=o.enableTerrain}populate(o,l,p,y){this.features=[],this.hasPattern=Kv("fill-extrusion",this.layers,l),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(w){const E=Math.exp(Math.PI*(1-w.y/(1<<w.z)*2));return 80150034*E/(E*E+1)/Qn/(1<<w.z)}(p),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:w,id:E,index:M,sourceLayerIndex:k}of o){const F=this.layers[0]._featureFilter.needGeometry,U=Nf(w,F);if(!this.layers[0]._featureFilter.filter(new Ze(this.zoom),U,p))continue;const z={id:E,sourceLayerIndex:k,index:M,geometry:F?U.geometry:au(w,p,y),properties:w.properties,type:w.type,patterns:{}},Z=this.layoutVertexArray.length;this.hasPattern?this.features.push(W_("fill-extrusion",this.layers,z,this.zoom,l)):this.addFeature(z,z.geometry,M,p,{},l.availableImages,y),l.featureIndex.insert(w,z.geometry,M,k,this.index,Z)}this.sortBorders()}addFeatures(o,l,p,y,w){for(const E of this.features){const{geometry:M}=E;this.addFeature(E,M,E.index,l,p,y,w)}this.sortBorders()}update(o,l,p,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,p,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,bx),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,K_.members,!0))),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,vx.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,l,p,y,w,E,M){const k=[new Ye(0,0),new Ye(Qn,Qn)],F=M.projection,U="globe"===F.name,z=this.enableTerrain&&!U?new td:null,Z="Polygon"===qT[o.type];U&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Gs);const te=q_(l,500);for(let Ee=te.length-1;Ee>=0;Ee--){const xe=te[Ee];(0===xe.length||(ie=xe[0]).every(we=>we.x<=0)||ie.every(we=>we.x>=Qn)||ie.every(we=>we.y<=0)||ie.every(we=>we.y>=Qn))&&te.splice(Ee,1)}var ie;let K;if(U)K=Ex(te,k,y);else{K=[];for(const Ee of te)K.push({polygon:Ee,bounds:k})}const pe=Z?this.edgeRadius:0;for(const{polygon:Ee,bounds:xe}of K){let we=0,Ce=0;for(const ke of Ee)Z&&!ke[0].equals(ke[ke.length-1])&&ke.push(ke[0]),Ce+=Z?ke.length-1:ke.length;const Le=this.segments.prepareSegment((Z?5:4)*Ce,this.layoutVertexArray,this.indexArray);if(Z){const ke=[],st=[];we=Le.vertexLength;for(const bt of Ee){let Gt,ht;bt.length&&bt!==Ee[0]&&st.push(ke.length/2),Gt=bt[1].sub(bt[0])._perp()._unit();for(let Tt=1;Tt<bt.length;Tt++){const xt=bt[Tt],kt=bt[Tt===bt.length-1?1:Tt+1];let{x:At,y:ct}=xt;if(pe){ht=kt.sub(xt)._perp()._unit();const ln=Gt.add(ht)._unit(),Wn=pe*Math.min(4,1/(Gt.x*ln.x+Gt.y*ln.y));At+=Wn*ln.x,ct+=Wn*ln.y,Gt=ht}Qv(this.layoutVertexArray,At,ct,0,0,1,1,0),Le.vertexLength++,ke.push(xt.x,xt.y),U&&am(this.layoutVertexExtArray,F.projectTilePoint(At,ct,y),F.upVector(y,At,ct))}}const rt=Uh(ke,st);for(let bt=0;bt<rt.length;bt+=3)this.indexArray.emplaceBack(we+rt[bt],we+rt[bt+2],we+rt[bt+1]),Le.primitiveLength++}for(const ke of Ee){z&&ke.length&&z.startRing(ke[0]);let st,rt,bt,Gt=ke.length>4&&cm(ke[ke.length-2],ke[0],ke[1]),ht=pe?fg(ke[ke.length-2],ke[0],ke[1],pe):0;rt=ke[1].sub(ke[0])._perp()._unit();let Tt=!0;for(let xt=1,kt=0;xt<ke.length;xt++){let At=ke[xt-1],ct=ke[xt];const ln=ke[xt===ke.length-1?1:xt+1];if(z&&Z&&z.currentPolyCount.top++,J_(ct,At,xe)){pe&&(rt=ln.sub(ct)._perp()._unit(),Tt=!Tt);continue}z&&z.append(ct,At);const Wn=ct.sub(At)._perp(),fn=Wn.x/(Math.abs(Wn.x)+Math.abs(Wn.y)),An=Wn.y>0?1:0,Wt=At.dist(ct);if(kt+Wt>32768&&(kt=0),pe){bt=ln.sub(ct)._perp()._unit();let Ai=K1(At,ct,ln,Cx(rt,bt),pe);isNaN(Ai)&&(Ai=0);const Jn=ct.sub(At)._unit();At=At.add(Jn.mult(ht))._round(),ct=ct.add(Jn.mult(-Ai))._round(),ht=Ai,rt=bt}const ti=Le.vertexLength,Di=ke.length>4&&cm(At,ct,ln);let Ri=ey(kt,Gt,Tt);if(Qv(this.layoutVertexArray,At.x,At.y,fn,An,0,0,Ri),Qv(this.layoutVertexArray,At.x,At.y,fn,An,0,1,Ri),kt+=Wt,Ri=ey(kt,Di,!Tt),Gt=Di,Qv(this.layoutVertexArray,ct.x,ct.y,fn,An,0,0,Ri),Qv(this.layoutVertexArray,ct.x,ct.y,fn,An,0,1,Ri),Le.vertexLength+=4,this.indexArray.emplaceBack(ti+0,ti+1,ti+2),this.indexArray.emplaceBack(ti+1,ti+3,ti+2),Le.primitiveLength+=2,pe){const Ai=we+(1===xt?ke.length-2:xt-2),Jn=1===xt?we:Ai+1;if(this.indexArray.emplaceBack(ti+1,Ai,ti+3),this.indexArray.emplaceBack(Ai,Jn,ti+3),Le.primitiveLength+=2,void 0===st&&(st=ti),!J_(ln,ke[xt],xe)){const Gi=xt===ke.length-1?st:Le.vertexLength;this.indexArray.emplaceBack(ti+2,ti+3,Gi),this.indexArray.emplaceBack(ti+3,Gi+1,Gi),this.indexArray.emplaceBack(ti+3,Jn,Gi+1),Le.primitiveLength+=3}Tt=!Tt}if(U){const Ai=this.layoutVertexExtArray,Jn=F.projectTilePoint(At.x,At.y,y),Gi=F.projectTilePoint(ct.x,ct.y,y),hi=F.upVector(y,At.x,At.y),Vi=F.upVector(y,ct.x,ct.y);am(Ai,Jn,hi),am(Ai,Jn,hi),am(Ai,Gi,Vi),am(Ai,Gi,Vi)}}Z&&(we+=ke.length-1)}}if(z&&z.polyCount.length>0){if(z.borders){z.vertexArrayOffset=this.centroidVertexArray.length;const Ee=z.borders,xe=this.featuresOnBorder.push(z)-1;for(let we=0;we<4;we++)Ee[we][0]!==Number.MAX_VALUE&&this.borders[we].push(xe)}this.encodeCentroid(z.borders?void 0:z.centroid(),z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,p,w,E,y)}sortBorders(){for(let o=0;o<4;o++)this.borders[o].sort((l,p)=>this.featuresOnBorder[l].borders[o][0]-this.featuresOnBorder[p].borders[o][0])}encodeCentroid(o,l,p=!0){let y,w;if(o)if(0!==o.y){const M=l.span()._mult(this.tileToMeter);y=(Math.max(o.x,1)<<3)+Math.min(7,Math.round(M.x/10)),w=(Math.max(o.y,1)<<3)+Math.min(7,Math.round(M.y/10))}else y=Math.ceil(7*(o.x+450)),w=0;else y=0,w=+p;let E=p?this.centroidVertexArray.length:l.vertexArrayOffset;for(const M of l.polyCount){p&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*M.edges+M.top);for(let k=0;k<M.top;k++)this.centroidVertexArray.emplace(E++,y,w);for(let k=0;k<2*M.edges;k++)this.centroidVertexArray.emplace(E++,0,w),this.centroidVertexArray.emplace(E++,y,w)}}}function Cx(a,o){const l=a.add(o)._unit();return a.x*l.x+a.y*l.y}function fg(a,o,l,p){const y=o.sub(a)._perp()._unit(),w=l.sub(o)._perp()._unit();return K1(a,o,l,Cx(y,w),p)}function K1(a,o,l,p,y){const w=Math.sqrt(1-p*p);return Math.min(a.dist(o)/3,o.dist(l)/3,y*w/p)}function J_(a,o,l){return a.x<l[0].x&&o.x<l[0].x||a.x>l[1].x&&o.x>l[1].x||a.y<l[0].y&&o.y<l[0].y||a.y>l[1].y&&o.y>l[1].y}function cm(a,o,l){if(a.x<0||a.x>=Qn||o.x<0||o.x>=Qn||l.x<0||l.x>=Qn)return!1;const p=l.sub(o),y=p.perp(),w=a.sub(o);return(p.x*w.x+p.y*w.y)/Math.sqrt((p.x*p.x+p.y*p.y)*(w.x*w.x+w.y*w.y))>-.866&&y.x*w.x+y.y*w.y<0}function ey(a,o,l){const p=o?2|a:-3&a;return l?1|p:-2&p}function Jv(){const a=Math.PI/32,o=Math.tan(a),l=zd;return l*Math.sqrt(1+2*o*o)-l}function Ex(a,o,l){const p=1<<l.z,y=Va(l.x/p),w=Va((l.x+1)/p),E=Qs(l.y/p),M=Qs((l.y+1)/p);return function(k,F,U,z,Z=0,te){const ie=[];if(!k.length||!U||!z)return ie;const K=(ke,st)=>{for(const rt of ke)ie.push({polygon:rt,bounds:st})},pe=Math.ceil(Math.log2(U)),Ee=Math.ceil(Math.log2(z)),xe=pe-Ee,we=[];for(let ke=0;ke<Math.abs(xe);ke++)we.push(xe>0?0:1);for(let ke=0;ke<Math.min(pe,Ee);ke++)we.push(0),we.push(1);let Ce=k;if(Ce=va(Ce,F[0].y-Z,F[1].y+Z,1),Ce=va(Ce,F[0].x-Z,F[1].x+Z,0),!Ce.length)return ie;const Le=[];for(we.length?Le.push({polygons:Ce,bounds:F,depth:0}):K(Ce,F);Le.length;){const ke=Le.pop(),st=ke.depth,rt=we[st],bt=ke.bounds[0],Gt=ke.bounds[1],ht=0===rt?bt.x:bt.y,Tt=0===rt?Gt.x:Gt.y,xt=te?te(rt,ht,Tt):.5*(ht+Tt),kt=va(ke.polygons,ht-Z,xt+Z,rt),At=va(ke.polygons,xt-Z,Tt+Z,rt);if(kt.length){const ct=[bt,new Ye(0===rt?xt:Gt.x,1===rt?xt:Gt.y)];we.length>st+1?Le.push({polygons:kt,bounds:ct,depth:st+1}):K(kt,ct)}if(At.length){const ct=[new Ye(0===rt?xt:bt.x,1===rt?xt:bt.y),Gt];we.length>st+1?Le.push({polygons:At,bounds:ct,depth:st+1}):K(At,ct)}}return ie}(a,o,Math.ceil((w-y)/11.25),Math.ceil((E-M)/11.25),1,(k,F,U)=>{if(0===k)return.5*(F+U);{const z=Qs((l.y+F/Qn)/p);return(ed(.5*(Qs((l.y+U/Qn)/p)+z))*p-l.y)*Qn}})}mn(lm,"FillExtrusionBucket",{omit:["layers","features"]}),mn(td,"PartMetadata");const X1=new Lt({"fill-extrusion-edge-radius":new qe(ut["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Tx={paint:new Lt({"fill-extrusion-opacity":new qe(ut["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Xe(ut["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new qe(ut["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new qe(ut["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Xe(ut["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Xe(ut["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Xe(ut["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new qe(ut["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new qe(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new qe(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:X1};function Ix(a,o,l){var p=2*Math.PI*6378137/256/Math.pow(2,l);return[a*p-2*Math.PI*6378137/2,o*p-2*Math.PI*6378137/2]}class e0{constructor(o,l,p){this.z=o,this.x=l,this.y=p,this.key=nd(0,o,o,l,p)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,l){const p=(E=this.y,M=this.z,k=Ix(256*(w=this.x),256*(E=Math.pow(2,M)-E-1),M),F=Ix(256*(w+1),256*(E+1),M),k[0]+","+k[1]+","+F[0]+","+F[1]),y=function(w,E,M){let k,F="";for(let U=w;U>0;U--)k=1<<U-1,F+=(E&k?1:0)+(M&k?2:0);return F}(this.z,this.x,this.y);var w,E,M,k,F;return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===l?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",y).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Sx{constructor(o,l){this.wrap=o,this.canonical=l,this.key=nd(o,l.z,l.z,l.x,l.y)}}class $a{constructor(o,l,p,y,w){this.overscaledZ=o,this.wrap=l,this.canonical=new e0(p,+y,+w),this.key=0===l&&o===p?this.canonical.key:nd(l,o,p,y,w)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const l=this.canonical.z-o;return o>this.canonical.z?new $a(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $a(o,this.wrap,o,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(o,l=!0){if(this.overscaledZ===o&&l)return this.key;if(o>this.canonical.z)return nd(this.wrap*+l,o,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-o;return nd(this.wrap*+l,o,o,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const l=this.canonical.z-o.canonical.z;return 0===o.overscaledZ||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>l&&o.canonical.y===this.canonical.y>>l}children(o){if(this.overscaledZ>=o)return[new $a(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,p=2*this.canonical.x,y=2*this.canonical.y;return[new $a(l,this.wrap,l,p,y),new $a(l,this.wrap,l,p+1,y),new $a(l,this.wrap,l,p,y+1),new $a(l,this.wrap,l,p+1,y+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new $a(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new $a(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Sx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function nd(a,o,l,p,y){const w=1<<Math.min(l,22);let E=w*(y%w)+p%w;return a&&l<22&&(E+=w*w*((a<0?-2*a-1:2*a)%(1<<2*(22-l)))),16*(32*E+l)+(o-l)}mn(e0,"CanonicalTileID"),mn($a,"OverscaledTileID",{omit:["projMatrix"]});class um extends Ye{constructor(o,l,p){super(o,l),this.z=p}}function jh(a,o){return a.x*o.x+a.y*o.y}function Q1(a,o){if(1===a.length){let l=0;const p=o[l++];let y;for(;!y||p.equals(y);)if(y=o[l++],!y)return 1/0;for(;l<o.length;l++){const w=o[l],E=a[0],M=y.sub(p),k=w.sub(p),F=E.sub(p),U=jh(M,M),z=jh(M,k),Z=jh(k,k),te=jh(F,M),ie=jh(F,k),K=U*Z-z*z,pe=(Z*te-z*ie)/K,Ee=(U*ie-z*te)/K,xe=p.z*(1-pe-Ee)+y.z*pe+w.z*Ee;if(isFinite(xe))return xe}return 1/0}{let l=1/0;for(const p of o)l=Math.min(l,p.z);return l}}function ty(a,o,l,p,y,w,E,M){const k=E*y.getElevationAt(a,o,!0,!0),F=0!==w[0],U=F?0===w[1]?E*(w[0]/7-450):E*function(z,Z,te){const ie=Math.floor(Z[0]/8),K=Math.floor(Z[1]/8),pe=10*(Z[0]-8*ie),Ee=10*(Z[1]-8*K),xe=z.getElevationAt(ie,K,!0,!0),we=z.getMeterToDEM(te),Ce=Math.floor(.5*(pe*we-1)),Le=Math.floor(.5*(Ee*we-1)),ke=z.tileCoordToPixel(ie,K),st=2*Ce+1,rt=2*Le+1,bt=(Wn=st,fn=rt,[(At=z).getElevationAtPixel(ct=ke.x-Ce,ln=ke.y-Le,!0),At.getElevationAtPixel(ct+fn,ln,!0),At.getElevationAtPixel(ct,ln+fn,!0),At.getElevationAtPixel(ct+Wn,ln+fn,!0)]),Gt=Math.abs(bt[0]-bt[1]),ht=Math.abs(bt[2]-bt[3]),Tt=Math.abs(bt[0]-bt[2])+Math.abs(bt[1]-bt[3]),xt=Math.min(.25,.5*we*(Gt+ht)/st),kt=Math.min(.25,.5*we*Tt/rt);var At,ct,ln,Wn,fn;return xe+Math.max(xt*pe,kt*Ee)}(y,w,M):k;return{base:k+(0===l)?-1:l,top:F?Math.max(U+p,k+l+2):k+p}}const Mx=yn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:WT}=Mx,dm=yn([{name:"a_packed",components:4,type:"Float32"}]),{members:Dx}=dm,J1=Gf.types,Ax=Math.cos(Math.PI/180*37.5);class pg{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new sr,this.layoutVertexArray2=new vi,this.indexArray=new ho,this.programConfigurations=new mc(o.layers,o.zoom),this.segments=new Zr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(o,l,p,y){this.hasPattern=Kv("line",this.layers,l);const w=this.layers[0].layout.get("line-sort-key"),E=[];for(const{feature:U,id:z,index:Z,sourceLayerIndex:te}of o){const ie=this.layers[0]._featureFilter.needGeometry,K=Nf(U,ie);if(!this.layers[0]._featureFilter.filter(new Ze(this.zoom),K,p))continue;const pe=w?w.evaluate(K,{},p):void 0,Ee={id:z,properties:U.properties,type:U.type,sourceLayerIndex:te,index:Z,geometry:ie?K.geometry:au(U,p,y),patterns:{},sortKey:pe};E.push(Ee)}w&&E.sort((U,z)=>U.sortKey-z.sortKey);const{lineAtlas:M,featureIndex:k}=l,F=this.addConstantDashes(M);for(const U of E){const{geometry:z,index:Z,sourceLayerIndex:te}=U;if(F&&this.addFeatureDashes(U,M),this.hasPattern){const ie=W_("line",this.layers,U,this.zoom,l);this.patternFeatures.push(ie)}else this.addFeature(U,z,Z,p,M.positions,l.availableImages);k.insert(o[Z].feature,z,Z,te,this.index)}}addConstantDashes(o){let l=!1;for(const p of this.layers){const y=p.paint.get("line-dasharray").value,w=p.layout.get("line-cap").value;if("constant"!==y.kind||"constant"!==w.kind)l=!0;else{const E=w.value,M=y.value;if(!M)continue;o.addDash(M,E)}}return l}addFeatureDashes(o,l){const p=this.zoom;for(const y of this.layers){const w=y.paint.get("line-dasharray").value,E=y.layout.get("line-cap").value;if("constant"===w.kind&&"constant"===E.kind)continue;let M,k;if("constant"===w.kind){if(M=w.value,!M)continue}else M=w.evaluate({zoom:p},o);k="constant"===E.kind?E.value:E.evaluate({zoom:p},o),l.addDash(M,k),o.patterns[y.id]=l.getKey(M,k)}}update(o,l,p,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,p,y)}addFeatures(o,l,p,y,w){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,l,p,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,Dx)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,WT),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,l,p,y,w,E){const M=this.layers[0].layout,k=M.get("line-join").evaluate(o,{}),F=M.get("line-cap").evaluate(o,{}),U=M.get("line-miter-limit"),z=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const Z of l)this.addLine(Z,o,k,F,U,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,p,w,E,y)}addLine(o,l,p,y,w,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ee=0;Ee<o.length-1;Ee++)this.totalDistance+=o[Ee].dist(o[Ee+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const M="Polygon"===J1[l.type];let k=o.length;for(;k>=2&&o[k-1].equals(o[k-2]);)k--;let F=0;for(;F<k-1&&o[F].equals(o[F+1]);)F++;if(k<(M?3:2))return;"bevel"===p&&(w=1.05);const U=this.overscaling<=16?122880/(512*this.overscaling):0,z=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray);let Z,te,ie,K,pe;this.e1=this.e2=-1,M&&(Z=o[k-2],pe=o[F].sub(Z)._unit()._perp());for(let Ee=F;Ee<k;Ee++){if(ie=Ee===k-1?M?o[F+1]:void 0:o[Ee+1],ie&&o[Ee].equals(ie))continue;pe&&(K=pe),Z&&(te=Z),Z=o[Ee],pe=ie?ie.sub(Z)._unit()._perp():K,K=K||pe;let xe=K.add(pe);0===xe.x&&0===xe.y||xe._unit();const we=K.x*pe.x+K.y*pe.y,Ce=xe.x*pe.x+xe.y*pe.y,Le=0!==Ce?1/Ce:1/0,ke=2*Math.sqrt(2-2*Ce),st=Ce<Ax&&te&&ie,rt=K.x*pe.y-K.y*pe.x>0;if(st&&Ee>F){const ht=Z.dist(te);if(ht>2*U){const Tt=Z.sub(Z.sub(te)._mult(U/ht)._round());this.updateDistance(te,Tt),this.addCurrentVertex(Tt,K,0,0,z),te=Tt}}const bt=te&&ie;let Gt=bt?p:M?"butt":y;if(bt&&"round"===Gt&&(Le<E?Gt="miter":Le<=2&&(Gt="fakeround")),"miter"===Gt&&Le>w&&(Gt="bevel"),"bevel"===Gt&&(Le>2&&(Gt="flipbevel"),Le<w&&(Gt="miter")),te&&this.updateDistance(te,Z),"miter"===Gt)xe._mult(Le),this.addCurrentVertex(Z,xe,0,0,z);else if("flipbevel"===Gt){if(Le>100)xe=pe.mult(-1);else{const ht=Le*K.add(pe).mag()/K.sub(pe).mag();xe._perp()._mult(ht*(rt?-1:1))}this.addCurrentVertex(Z,xe,0,0,z),this.addCurrentVertex(Z,xe.mult(-1),0,0,z)}else if("bevel"===Gt||"fakeround"===Gt){const ht=-Math.sqrt(Le*Le-1),Tt=rt?ht:0,xt=rt?0:ht;if(te&&this.addCurrentVertex(Z,K,Tt,xt,z),"fakeround"===Gt){const kt=Math.round(180*ke/Math.PI/20);for(let At=1;At<kt;At++){let ct=At/kt;if(.5!==ct){const Wn=ct-.5;ct+=ct*Wn*(ct-1)*((1.0904+we*(we*(3.55645-1.43519*we)-3.2452))*Wn*Wn+(.848013+we*(.215638*we-1.06021)))}const ln=pe.sub(K)._mult(ct)._add(K)._unit()._mult(rt?-1:1);this.addHalfVertex(Z,ln.x,ln.y,!1,rt,0,z)}}ie&&this.addCurrentVertex(Z,pe,-Tt,-xt,z)}else if("butt"===Gt)this.addCurrentVertex(Z,xe,0,0,z);else if("square"===Gt){const ht=te?1:-1;te||this.addCurrentVertex(Z,xe,ht,ht,z),this.addCurrentVertex(Z,xe,0,0,z),te&&this.addCurrentVertex(Z,xe,ht,ht,z)}else"round"===Gt&&(te&&(this.addCurrentVertex(Z,K,0,0,z),this.addCurrentVertex(Z,K,1,1,z,!0)),ie&&(this.addCurrentVertex(Z,pe,-1,-1,z,!0),this.addCurrentVertex(Z,pe,0,0,z)));if(st&&Ee<k-1){const ht=Z.dist(ie);if(ht>2*U){const Tt=Z.add(ie.sub(Z)._mult(U/ht)._round());this.updateDistance(Z,Tt),this.addCurrentVertex(Tt,pe,0,0,z),Z=Tt}}}}addCurrentVertex(o,l,p,y,w,E=!1){const M=l.y*y-l.x,k=-l.y-l.x*y;this.addHalfVertex(o,l.x+l.y*p,l.y-l.x*p,E,!1,p,w),this.addHalfVertex(o,M,k,E,!0,-y,w)}addHalfVertex({x:o,y:l},p,y,w,E,M,k){this.layoutVertexArray.emplaceBack((o<<1)+(w?1:0),(l<<1)+(E?1:0),Math.round(63*p)+128,Math.round(63*y)+128,1+(0===M?0:M<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const F=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,F),k.primitiveLength++),E?this.e2=F:this.e1=F}updateScaledDistance(){if(this.lineClips){const o=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=o*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(o,l){this.distance+=o.dist(l),this.updateScaledDistance()}}mn(pg,"LineBucket",{omit:["layers","patternFeatures"]});const eC=new Lt({"line-cap":new Xe(ut.layout_line["line-cap"]),"line-join":new Xe(ut.layout_line["line-join"]),"line-miter-limit":new qe(ut.layout_line["line-miter-limit"]),"line-round-limit":new qe(ut.layout_line["line-round-limit"]),"line-sort-key":new Xe(ut.layout_line["line-sort-key"])});var ny={paint:new Lt({"line-opacity":new Xe(ut.paint_line["line-opacity"]),"line-color":new Xe(ut.paint_line["line-color"]),"line-translate":new qe(ut.paint_line["line-translate"]),"line-translate-anchor":new qe(ut.paint_line["line-translate-anchor"]),"line-width":new Xe(ut.paint_line["line-width"]),"line-gap-width":new Xe(ut.paint_line["line-gap-width"]),"line-offset":new Xe(ut.paint_line["line-offset"]),"line-blur":new Xe(ut.paint_line["line-blur"]),"line-dasharray":new Xe(ut.paint_line["line-dasharray"]),"line-pattern":new Xe(ut.paint_line["line-pattern"]),"line-gradient":new Mt(ut.paint_line["line-gradient"]),"line-trim-offset":new qe(ut.paint_line["line-trim-offset"])}),layout:eC};const wc=new class extends Xe{possiblyEvaluate(a,o){return o=new Ze(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(a,o)}evaluate(a,o,l,p){return o=gt({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(a,o,l,p)}}(ny.paint.properties["line-width"].specification);function mg(a,o){return o>0?o+2*a:a}wc.useIntegerZoom=!0;const gg=yn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),t0=yn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),iy=yn([{name:"a_projected_pos",components:4,type:"Float32"}],4);yn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const n0=yn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),ry=yn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);yn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const id=yn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Cc=yn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);yn([{name:"triangle",components:3,type:"Uint16"}]),yn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),yn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),yn([{type:"Float32",name:"offsetX"}]),yn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Fs=24;const jl=128;function r0(a,o){const{expression:l}=o;if("constant"===l.kind)return{kind:"constant",layoutSize:l.evaluate(new Ze(a+1))};if("source"===l.kind)return{kind:"source"};{const{zoomStops:p,interpolationType:y}=l;let w=0;for(;w<p.length&&p[w]<=a;)w++;w=Math.max(0,w-1);let E=w;for(;E<p.length&&p[E]<a+1;)E++;E=Math.min(p.length-1,E);const M=p[w],k=p[E];return"composite"===l.kind?{kind:"composite",minZoom:M,maxZoom:k,interpolationType:y}:{kind:"camera",minZoom:M,maxZoom:k,minSize:l.evaluate(new Ze(M)),maxSize:l.evaluate(new Ze(k)),interpolationType:y}}}function oy(a,{uSize:o,uSizeT:l},{lowerSize:p,upperSize:y}){return"source"===a.kind?p/jl:"composite"===a.kind?di(p/jl,y/jl,l):o}function Hf(a,o){let l=0,p=0;if("constant"===a.kind)p=a.layoutSize;else if("source"!==a.kind){const{interpolationType:y,minZoom:w,maxZoom:E}=a,M=y?Bt(Xa.interpolationFactor(y,o,w,E),0,1):0;"camera"===a.kind?p=di(a.minSize,a.maxSize,M):l=M}return{uSizeT:l,uSize:p}}var _g=Object.freeze({__proto__:null,getSizeData:r0,evaluateSizeForFeature:oy,evaluateSizeForZoom:Hf,SIZE_PACK_FACTOR:jl});function Px(a,o,l){return a.sections.forEach(p=>{p.text=function(y,w,E){const M=w.layout.get("text-transform").evaluate(E,{});return"uppercase"===M?y=y.toLocaleUpperCase():"lowercase"===M&&(y=y.toLocaleLowerCase()),Ue.applyArabicShaping&&(y=Ue.applyArabicShaping(y)),y}(p.text,o,l)}),a}const $l={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function Ox(a){return"\ufe36"===a||"\ufe48"===a||"\ufe38"===a||"\ufe44"===a||"\ufe42"===a||"\ufe3e"===a||"\ufe3c"===a||"\ufe3a"===a||"\ufe18"===a||"\ufe40"===a||"\ufe10"===a||"\ufe13"===a||"\ufe14"===a||"\uff40"===a||"\uffe3"===a||"\ufe11"===a||"\ufe12"===a}function ba(a){return"\ufe35"===a||"\ufe47"===a||"\ufe37"===a||"\ufe43"===a||"\ufe41"===a||"\ufe3d"===a||"\ufe3b"===a||"\ufe39"===a||"\ufe17"===a||"\ufe3f"===a}var ko=Lr,o0=function(a,o,l,p,y){var w,E,M=8*y-p-1,k=(1<<M)-1,F=k>>1,U=-7,z=l?y-1:0,Z=l?-1:1,te=a[o+z];for(z+=Z,w=te&(1<<-U)-1,te>>=-U,U+=M;U>0;w=256*w+a[o+z],z+=Z,U-=8);for(E=w&(1<<-U)-1,w>>=-U,U+=p;U>0;E=256*E+a[o+z],z+=Z,U-=8);if(0===w)w=1-F;else{if(w===k)return E?NaN:1/0*(te?-1:1);E+=Math.pow(2,p),w-=F}return(te?-1:1)*E*Math.pow(2,w-p)},du=function(a,o,l,p,y,w){var E,M,k,F=8*w-y-1,U=(1<<F)-1,z=U>>1,Z=23===y?Math.pow(2,-24)-Math.pow(2,-77):0,te=p?0:w-1,ie=p?1:-1,K=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(M=isNaN(o)?1:0,E=U):(E=Math.floor(Math.log(o)/Math.LN2),o*(k=Math.pow(2,-E))<1&&(E--,k*=2),(o+=E+z>=1?Z/k:Z*Math.pow(2,1-z))*k>=2&&(E++,k/=2),E+z>=U?(M=0,E=U):E+z>=1?(M=(o*k-1)*Math.pow(2,y),E+=z):(M=o*Math.pow(2,z-1)*Math.pow(2,y),E=0));y>=8;a[l+te]=255&M,te+=ie,M/=256,y-=8);for(E=E<<y|M,F+=y;F>0;a[l+te]=255&E,te+=ie,E/=256,F-=8);a[l+te-ie]|=128*K};function Lr(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Lr.Varint=0,Lr.Fixed64=1,Lr.Bytes=2,Lr.Fixed32=5;var hm=4294967296,sy=1/hm,s0=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function rd(a){return a.type===Lr.Bytes?a.readVarint()+a.pos:a.pos+1}function ay(a,o,l){var p=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));l.realloc(p);for(var y=l.pos-1;y>=a;y--)l.buf[y+p]=l.buf[y]}function kx(a,o){for(var l=0;l<a.length;l++)o.writeVarint(a[l])}function ly(a,o){for(var l=0;l<a.length;l++)o.writeSVarint(a[l])}function cy(a,o){for(var l=0;l<a.length;l++)o.writeFloat(a[l])}function Rx(a,o){for(var l=0;l<a.length;l++)o.writeDouble(a[l])}function Fx(a,o){for(var l=0;l<a.length;l++)o.writeBoolean(a[l])}function Lx(a,o){for(var l=0;l<a.length;l++)o.writeFixed32(a[l])}function tC(a,o){for(var l=0;l<a.length;l++)o.writeSFixed32(a[l])}function Nx(a,o){for(var l=0;l<a.length;l++)o.writeFixed64(a[l])}function hu(a,o){for(var l=0;l<a.length;l++)o.writeSFixed64(a[l])}function $h(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+16777216*a[o+3]}function Wf(a,o,l){a[l]=o,a[l+1]=o>>>8,a[l+2]=o>>>16,a[l+3]=o>>>24}function uy(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+(a[o+3]<<24)}function a0(a,o,l){o.glyphs=[],1===a&&l.readMessage(zx,o)}function zx(a,o,l){if(3===a){const{id:p,bitmap:y,width:w,height:E,left:M,top:k,advance:F}=l.readMessage(Bx,{});o.glyphs.push({id:p,bitmap:new Js({width:w+6,height:E+6},y),metrics:{width:w,height:E,left:M,top:k,advance:F}})}else 4===a?o.ascender=l.readSVarint():5===a&&(o.descender=l.readSVarint())}function Bx(a,o,l){1===a?o.id=l.readVarint():2===a?o.bitmap=l.readBytes():3===a?o.width=l.readVarint():4===a?o.height=l.readVarint():5===a?o.left=l.readSVarint():6===a?o.top=l.readSVarint():7===a&&(o.advance=l.readVarint())}function yg(a){let o=0,l=0;for(const E of a)o+=E.w*E.h,l=Math.max(l,E.w);a.sort((E,M)=>M.h-E.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),l),h:1/0}];let y=0,w=0;for(const E of a)for(let M=p.length-1;M>=0;M--){const k=p[M];if(!(E.w>k.w||E.h>k.h)){if(E.x=k.x,E.y=k.y,w=Math.max(w,E.y+E.h),y=Math.max(y,E.x+E.w),E.w===k.w&&E.h===k.h){const F=p.pop();M<p.length&&(p[M]=F)}else E.h===k.h?(k.x+=E.w,k.w-=E.w):E.w===k.w?(k.y+=E.h,k.h-=E.h):(p.push({x:k.x+E.w,y:k.y,w:k.w-E.w,h:E.h}),k.y+=E.h,k.h-=E.h);break}}return{w:y,h:w,fill:o/(y*w)||0}}Lr.prototype={destroy:function(){this.buf=null},readFields:function(a,o,l){for(l=l||this.length;this.pos<l;){var p=this.readVarint(),y=p>>3,w=this.pos;this.type=7&p,a(y,o,this),this.pos===w&&this.skip(p)}return o},readMessage:function(a,o){return this.readFields(a,o,this.readVarint()+this.pos)},readFixed32:function(){var a=$h(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=uy(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=$h(this.buf,this.pos)+$h(this.buf,this.pos+4)*hm;return this.pos+=8,a},readSFixed64:function(){var a=$h(this.buf,this.pos)+uy(this.buf,this.pos+4)*hm;return this.pos+=8,a},readFloat:function(){var a=o0(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=o0(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var o,l,p=this.buf;return o=127&(l=p[this.pos++]),l<128?o:(o|=(127&(l=p[this.pos++]))<<7,l<128?o:(o|=(127&(l=p[this.pos++]))<<14,l<128?o:(o|=(127&(l=p[this.pos++]))<<21,l<128?o:function(y,w,E){var M,k,F=E.buf;if(M=(112&(k=F[E.pos++]))>>4,k<128||(M|=(127&(k=F[E.pos++]))<<3,k<128)||(M|=(127&(k=F[E.pos++]))<<10,k<128)||(M|=(127&(k=F[E.pos++]))<<17,k<128)||(M|=(127&(k=F[E.pos++]))<<24,k<128)||(M|=(1&(k=F[E.pos++]))<<31,k<128))return function qf(a,o,l){return l?4294967296*o+(a>>>0):4294967296*(o>>>0)+(a>>>0)}(y,M,w);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(l=p[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,o=this.pos;return this.pos=a,a-o>=12&&s0?s0.decode(this.buf.subarray(o,a)):function(l,p,y){for(var w="",E=p;E<y;){var M,k,F,U=l[E],z=null,Z=U>239?4:U>223?3:U>191?2:1;if(E+Z>y)break;1===Z?U<128&&(z=U):2===Z?128==(192&(M=l[E+1]))&&(z=(31&U)<<6|63&M)<=127&&(z=null):3===Z?(k=l[E+2],128==(192&(M=l[E+1]))&&128==(192&k)&&((z=(15&U)<<12|(63&M)<<6|63&k)<=2047||z>=55296&&z<=57343)&&(z=null)):4===Z&&(k=l[E+2],F=l[E+3],128==(192&(M=l[E+1]))&&128==(192&k)&&128==(192&F)&&((z=(15&U)<<18|(63&M)<<12|(63&k)<<6|63&F)<=65535||z>=1114112)&&(z=null)),null===z?(z=65533,Z=1):z>65535&&(z-=65536,w+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),w+=String.fromCharCode(z),E+=Z}return w}(this.buf,o,a)},readBytes:function(){var a=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,a);return this.pos=a,o},readPackedVarint:function(a,o){if(this.type!==Lr.Bytes)return a.push(this.readVarint(o));var l=rd(this);for(a=a||[];this.pos<l;)a.push(this.readVarint(o));return a},readPackedSVarint:function(a){if(this.type!==Lr.Bytes)return a.push(this.readSVarint());var o=rd(this);for(a=a||[];this.pos<o;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Lr.Bytes)return a.push(this.readBoolean());var o=rd(this);for(a=a||[];this.pos<o;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Lr.Bytes)return a.push(this.readFloat());var o=rd(this);for(a=a||[];this.pos<o;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Lr.Bytes)return a.push(this.readDouble());var o=rd(this);for(a=a||[];this.pos<o;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Lr.Bytes)return a.push(this.readFixed32());var o=rd(this);for(a=a||[];this.pos<o;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Lr.Bytes)return a.push(this.readSFixed32());var o=rd(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Lr.Bytes)return a.push(this.readFixed64());var o=rd(this);for(a=a||[];this.pos<o;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Lr.Bytes)return a.push(this.readSFixed64());var o=rd(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed64());return a},skip:function(a){var o=7&a;if(o===Lr.Varint)for(;this.buf[this.pos++]>127;);else if(o===Lr.Bytes)this.pos=this.readVarint()+this.pos;else if(o===Lr.Fixed32)this.pos+=4;else{if(o!==Lr.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(a,o){this.writeVarint(a<<3|o)},realloc:function(a){for(var o=this.length||16;o<this.pos+a;)o*=2;if(o!==this.length){var l=new Uint8Array(o);l.set(this.buf),this.buf=l,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Wf(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Wf(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Wf(this.buf,-1&a,this.pos),Wf(this.buf,Math.floor(a*sy),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Wf(this.buf,-1&a,this.pos),Wf(this.buf,Math.floor(a*sy),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(o,l){var p,y,w,M;if(o>=0?(p=o%4294967296|0,y=o/4294967296|0):(y=~(-o/4294967296),4294967295^(p=~(-o%4294967296))?p=p+1|0:(p=0,y=y+1|0)),o>=0x10000000000000000||o<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),w=p,(M=l).buf[M.pos++]=127&w|128,w>>>=7,M.buf[M.pos++]=127&w|128,w>>>=7,M.buf[M.pos++]=127&w|128,w>>>=7,M.buf[M.pos++]=127&w|128,M.buf[M.pos]=127&(w>>>=7),function(w,E){var M=(7&w)<<4;E.buf[E.pos++]|=M|((w>>>=3)?128:0),w&&(E.buf[E.pos++]=127&w|((w>>>=7)?128:0),w&&(E.buf[E.pos++]=127&w|((w>>>=7)?128:0),w&&(E.buf[E.pos++]=127&w|((w>>>=7)?128:0),w&&(E.buf[E.pos++]=127&w|((w>>>=7)?128:0),w&&(E.buf[E.pos++]=127&w)))))}(y,l)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var o=this.pos;this.pos=function(p,y,w){for(var E,M,k=0;k<y.length;k++){if((E=y.charCodeAt(k))>55295&&E<57344){if(!M){E>56319||k+1===y.length?(p[w++]=239,p[w++]=191,p[w++]=189):M=E;continue}if(E<56320){p[w++]=239,p[w++]=191,p[w++]=189,M=E;continue}E=M-55296<<10|E-56320|65536,M=null}else M&&(p[w++]=239,p[w++]=191,p[w++]=189,M=null);E<128?p[w++]=E:(E<2048?p[w++]=E>>6|192:(E<65536?p[w++]=E>>12|224:(p[w++]=E>>18|240,p[w++]=E>>12&63|128),p[w++]=E>>6&63|128),p[w++]=63&E|128)}return w}(this.buf,a,this.pos);var l=this.pos-o;l>=128&&ay(o,l,this),this.pos=o-1,this.writeVarint(l),this.pos+=l},writeFloat:function(a){this.realloc(4),du(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),du(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var o=a.length;this.writeVarint(o),this.realloc(o);for(var l=0;l<o;l++)this.buf[this.pos++]=a[l]},writeRawMessage:function(a,o){this.pos++;var l=this.pos;a(o,this);var p=this.pos-l;p>=128&&ay(l,p,this),this.pos=l-1,this.writeVarint(p),this.pos+=p},writeMessage:function(a,o,l){this.writeTag(a,Lr.Bytes),this.writeRawMessage(o,l)},writePackedVarint:function(a,o){o.length&&this.writeMessage(a,kx,o)},writePackedSVarint:function(a,o){o.length&&this.writeMessage(a,ly,o)},writePackedBoolean:function(a,o){o.length&&this.writeMessage(a,Fx,o)},writePackedFloat:function(a,o){o.length&&this.writeMessage(a,cy,o)},writePackedDouble:function(a,o){o.length&&this.writeMessage(a,Rx,o)},writePackedFixed32:function(a,o){o.length&&this.writeMessage(a,Lx,o)},writePackedSFixed32:function(a,o){o.length&&this.writeMessage(a,tC,o)},writePackedFixed64:function(a,o){o.length&&this.writeMessage(a,Nx,o)},writePackedSFixed64:function(a,o){o.length&&this.writeMessage(a,hu,o)},writeBytesField:function(a,o){this.writeTag(a,Lr.Bytes),this.writeBytes(o)},writeFixed32Field:function(a,o){this.writeTag(a,Lr.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(a,o){this.writeTag(a,Lr.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(a,o){this.writeTag(a,Lr.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(a,o){this.writeTag(a,Lr.Fixed64),this.writeSFixed64(o)},writeVarintField:function(a,o){this.writeTag(a,Lr.Varint),this.writeVarint(o)},writeSVarintField:function(a,o){this.writeTag(a,Lr.Varint),this.writeSVarint(o)},writeStringField:function(a,o){this.writeTag(a,Lr.Bytes),this.writeString(o)},writeFloatField:function(a,o){this.writeTag(a,Lr.Fixed32),this.writeFloat(o)},writeDoubleField:function(a,o){this.writeTag(a,Lr.Fixed64),this.writeDouble(o)},writeBooleanField:function(a,o){this.writeVarintField(a,Boolean(o))}};class Gh{constructor(o,{pixelRatio:l,version:p,stretchX:y,stretchY:w,content:E}){this.paddedRect=o,this.pixelRatio=l,this.stretchX=y,this.stretchY=w,this.content=E,this.version=p}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class l0{constructor(o,l){const p={},y={};this.haveRenderCallbacks=[];const w=[];this.addImages(o,p,w),this.addImages(l,y,w);const{w:E,h:M}=yg(w),k=new Ua({width:E||1,height:M||1});for(const F in o){const U=o[F],z=p[F].paddedRect;Ua.copy(U.data,k,{x:0,y:0},{x:z.x+1,y:z.y+1},U.data)}for(const F in l){const U=l[F],z=y[F].paddedRect,Z=z.x+1,te=z.y+1,ie=U.data.width,K=U.data.height;Ua.copy(U.data,k,{x:0,y:0},{x:Z,y:te},U.data),Ua.copy(U.data,k,{x:0,y:K-1},{x:Z,y:te-1},{width:ie,height:1}),Ua.copy(U.data,k,{x:0,y:0},{x:Z,y:te+K},{width:ie,height:1}),Ua.copy(U.data,k,{x:ie-1,y:0},{x:Z-1,y:te},{width:1,height:K}),Ua.copy(U.data,k,{x:0,y:0},{x:Z+ie,y:te},{width:1,height:K})}this.image=k,this.iconPositions=p,this.patternPositions=y}addImages(o,l,p){for(const y in o){const w=o[y],E={x:0,y:0,w:w.data.width+2,h:w.data.height+2};p.push(E),l[y]=new Gh(E,w),w.hasRenderCallback&&this.haveRenderCallbacks.push(y)}}patchUpdatedImages(o,l){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>o.hasImage(p)),o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in o.updatedImages)this.patchUpdatedImage(this.iconPositions[p],o.getImage(p),l),this.patchUpdatedImage(this.patternPositions[p],o.getImage(p),l)}patchUpdatedImage(o,l,p){if(!o||!l||o.version===l.version)return;o.version=l.version;const[y,w]=o.tl;p.update(l.data,void 0,{x:y,y:w})}}mn(Gh,"ImagePosition"),mn(l0,"ImageAtlas");const dl={horizontal:1,vertical:2,horizontalOnly:3};class $d{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,l){const p=new $d;return p.scale=o||1,p.fontStack=l,p}static forImage(o){const l=new $d;return l.imageName=o,l}}class Jo{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,l){const p=new Jo;for(let y=0;y<o.sections.length;y++){const w=o.sections[y];w.image?p.addImageSection(w):p.addTextSection(w,l)}return p}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(o){this.text=function(l,p){let y="";for(let w=0;w<l.length;w++){const E=l.charCodeAt(w+1)||null,M=l.charCodeAt(w-1)||null;y+=!p&&(E&&G(E)&&!$l[l[w+1]]||M&&G(M)&&!$l[l[w-1]])||!$l[l[w]]?l[w]:$l[l[w]]}return y}(this.text,o)}trim(){let o=0;for(let p=0;p<this.text.length&&dy[this.text.charCodeAt(p)];p++)o++;let l=this.text.length;for(let p=this.text.length-1;p>=0&&p>=o&&dy[this.text.charCodeAt(p)];p--)l--;this.text=this.text.substring(o,l),this.sectionIndex=this.sectionIndex.slice(o,l)}substring(o,l){const p=new Jo;return p.text=this.text.substring(o,l),p.sectionIndex=this.sectionIndex.slice(o,l),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,l)=>Math.max(o,this.sections[l].scale),0)}addTextSection(o,l){this.text+=o.text,this.sections.push($d.forText(o.scale,o.fontStack||l));const p=this.sections.length-1;for(let y=0;y<o.text.length;++y)this.sectionIndex.push(p)}addImageSection(o){const l=o.image?o.image.name:"";if(0===l.length)return void Pi("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push($d.forImage(l)),this.sectionIndex.push(this.sections.length-1)):Pi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function hl(a,o,l,p,y,w,E,M,k,F,U,z,Z,te,ie){const K=Jo.fromFeature(a,y);z===dl.vertical&&K.verticalizePunctuation(Z);let pe=[];const Ee=function(ke,st,rt,bt,Gt,ht){if(!ke)return[];const Tt=[],xt=function(ln,Wn,fn,An,Wt,ti){let Di=0;for(let Ri=0;Ri<ln.length();Ri++){const Ai=ln.getSection(Ri);Di+=ZT(ln.getCharCode(Ri),Ai,An,Wt,Wn,ti)}return Di/Math.max(1,Math.ceil(Di/fn))}(ke,st,rt,bt,Gt,ht),kt=ke.text.indexOf("\u200b")>=0;let At=0;for(let ln=0;ln<ke.length();ln++){const Wn=ke.getSection(ln),fn=ke.getCharCode(ln);if(dy[fn]||(At+=ZT(fn,Wn,bt,Gt,st,ht)),ln<ke.length()-1){const An=!((ct=fn)<11904||!(Tf(ct)||no(ct)||v(ct)||Fd(ct)||tu(ct)||Lp(ct)||fa(ct)||Ra(ct)||Np(ct)||nu(ct)||pa(ct)||C(ct)||wh(ct)||xh(ct)||Zm(ct)||Eh(ct)||Ch(ct)||Mi(ct)||Th(ct)||Hu(ct)));(Vx[fn]||An||Wn.imageName)&&Tt.push(bg(ln+1,At,xt,Tt,hy(fn,ke.getCharCode(ln+1),An&&kt),!1))}}var ct;return fm(bg(ke.length(),At,xt,Tt,0,!0))}(K,F,w,o,p,te),{processBidirectionalText:xe,processStyledBidirectionalText:we}=Ue;if(xe&&1===K.sections.length){const ke=xe(K.toString(),Ee);for(const st of ke){const rt=new Jo;rt.text=st,rt.sections=K.sections;for(let bt=0;bt<st.length;bt++)rt.sectionIndex.push(0);pe.push(rt)}}else if(we){const ke=we(K.text,K.sectionIndex,Ee);for(const st of ke){const rt=new Jo;rt.text=st[0],rt.sectionIndex=st[1],rt.sections=K.sections,pe.push(rt)}}else pe=function(ke,st){const rt=[],bt=ke.text;let Gt=0;for(const ht of st)rt.push(ke.substring(Gt,ht)),Gt=ht;return Gt<bt.length&&rt.push(ke.substring(Gt,bt.length)),rt}(K,Ee);const Ce=[],Le={positionedLines:Ce,text:K.toString(),top:U[1],bottom:U[1],left:U[0],right:U[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ke,st,rt,bt,Gt,ht,Tt,xt,kt,At,ct,ln){let Wn=0,fn=0,An=0;const Wt="right"===xt?1:"left"===xt?0:.5;let ti=!1;for(const hi of Gt){const Vi=hi.getSections();for(const Tr of Vi){if(Tr.imageName)continue;const yr=st[Tr.fontStack];if(yr&&(ti=void 0!==yr.ascender&&void 0!==yr.descender,!ti))break}if(!ti)break}let Di=0;for(const hi of Gt){hi.trim();const Vi=hi.getMaxScale(),Tr=(Vi-1)*Fs,yr={positionedGlyphs:[],lineOffset:0};ke.positionedLines[Di]=yr;const Dr=yr.positionedGlyphs;let Ar=0;if(!hi.length()){fn+=ht,++Di;continue}let Br=0,To=0;for(let mr=0;mr<hi.length();mr++){const Fo=hi.getSection(mr),Io=hi.getSectionIndex(mr),nr=hi.getCharCode(mr);let Yr=Fo.scale,es=null,_r=null,go=null,qs=Fs,Lo=0;const Cs=!(kt===dl.horizontal||!ct&&!B(nr)||ct&&(dy[nr]||(Ri=nr,Gu(Ri)||bh(Ri)||Wm(Ri)||zp(Ri)||g(Ri))));if(Fo.imageName){const ps=bt[Fo.imageName];if(!ps)continue;go=Fo.imageName,ke.iconsInText=ke.iconsInText||!0,_r=ps.paddedRect;const Es=ps.displaySize;Yr=Yr*Fs/ln,es={width:Es[0],height:Es[1],left:1,top:-3,advance:Cs?Es[1]:Es[0],localGlyph:!1},Lo=ti?-es.height*Yr:Vi*Fs-17-Es[1]*Yr,qs=es.advance;const yu=(Cs?Es[0]:Es[1])*Yr-Fs*Vi;yu>0&&yu>Ar&&(Ar=yu)}else{const ps=rt[Fo.fontStack];if(!ps)continue;ps[nr]&&(_r=ps[nr]);const Es=st[Fo.fontStack];if(!Es)continue;const yu=Es.glyphs[nr];if(!yu)continue;if(es=yu.metrics,qs=8203!==nr?Fs:0,ti){const cd=void 0!==Es.ascender?Math.abs(Es.ascender):0,Wl=void 0!==Es.descender?Math.abs(Es.descender):0,wm=(cd+Wl)*Yr;Br<wm&&(Br=wm,To=(cd-Wl)/2*Yr),Lo=-cd*Yr}else Lo=(Vi-Yr)*Fs-17}Cs?(ke.verticalizable=!0,Dr.push({glyph:nr,imageName:go,x:Wn,y:fn+Lo,vertical:Cs,scale:Yr,localGlyph:es.localGlyph,fontStack:Fo.fontStack,sectionIndex:Io,metrics:es,rect:_r}),Wn+=qs*Yr+At):(Dr.push({glyph:nr,imageName:go,x:Wn,y:fn+Lo,vertical:Cs,scale:Yr,localGlyph:es.localGlyph,fontStack:Fo.fontStack,sectionIndex:Io,metrics:es,rect:_r}),Wn+=es.advance*Yr+At)}0!==Dr.length&&(An=Math.max(Wn-At,An),ti?Ec(Dr,Wt,Ar,To,ht*Vi/2):Ec(Dr,Wt,Ar,0,ht/2)),Wn=0;const ws=ht*Vi+Ar;yr.lineOffset=Math.max(Ar,Tr),fn+=ws,++Di}var Ri;const Ai=fn,{horizontalAlign:Jn,verticalAlign:Gi}=xg(Tt);(function(hi,Vi,Tr,yr,Dr,Ar){const Br=(Vi-Tr)*Dr,To=-Ar*yr;for(const ws of hi)for(const mr of ws.positionedGlyphs)mr.x+=Br,mr.y+=To})(ke.positionedLines,Wt,Jn,Gi,An,Ai),ke.top+=-Gi*Ai,ke.bottom=ke.top+Ai,ke.left+=-Jn*An,ke.right=ke.left+An,ke.hasBaseline=ti}(Le,o,l,p,pe,E,M,k,z,F,Z,ie),!function(ke){for(const st of ke)if(0!==st.positionedGlyphs.length)return!1;return!0}(Ce)&&Le}const dy={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Vx={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function ZT(a,o,l,p,y,w){if(o.imageName){const E=p[o.imageName];return E?E.displaySize[0]*o.scale*Fs/w+y:0}{const E=l[o.fontStack],M=E&&E.glyphs[a];return M?M.metrics.advance*o.scale+y:0}}function vg(a,o,l,p){const y=Math.pow(a-o,2);return p?a<o?y/2:2*y:y+Math.abs(l)*l}function hy(a,o,l){let p=0;return 10===a&&(p-=1e4),l&&(p+=150),40!==a&&65288!==a||(p+=50),41!==o&&65289!==o||(p+=50),p}function bg(a,o,l,p,y,w){let E=null,M=vg(o,l,y,w);for(const k of p){const F=vg(o-k.x,l,y,w)+k.badness;F<=M&&(E=k,M=F)}return{index:a,x:o,priorBreak:E,badness:M}}function fm(a){return a?fm(a.priorBreak).concat(a.index):[]}function xg(a){let o=.5,l=.5;switch(a){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:o,verticalAlign:l}}function Ec(a,o,l,p,y){if(!(o||l||p||y))return;const w=a.length-1,E=a[w],M=(E.x+E.metrics.advance*E.scale)*o;for(let k=0;k<=w;k++)a[k].x-=M,a[k].y+=l+p+y}function fy(a,o,l){const{horizontalAlign:p,verticalAlign:y}=xg(l),w=o[0]-a.displaySize[0]*p,E=o[1]-a.displaySize[1]*y;return{image:a,top:E,bottom:E+a.displaySize[1],left:w,right:w+a.displaySize[0]}}function py(a,o,l,p,y,w){const E=a.image;let M;if(E.content){const pe=E.content,Ee=E.pixelRatio||1;M=[pe[0]/Ee,pe[1]/Ee,E.displaySize[0]-pe[2]/Ee,E.displaySize[1]-pe[3]/Ee]}const k=o.left*w,F=o.right*w;let U,z,Z,te;"width"===l||"both"===l?(te=y[0]+k-p[3],z=y[0]+F+p[1]):(te=y[0]+(k+F-E.displaySize[0])/2,z=te+E.displaySize[0]);const ie=o.top*w,K=o.bottom*w;return"height"===l||"both"===l?(U=y[1]+ie-p[0],Z=y[1]+K+p[2]):(U=y[1]+(ie+K-E.displaySize[1])/2,Z=U+E.displaySize[1]),{image:E,top:U,right:z,bottom:Z,left:te,collisionPadding:M}}class Tc extends Ye{constructor(o,l,p,y,w){super(o,l),this.angle=y,this.z=p,void 0!==w&&(this.segment=w)}clone(){return new Tc(this.x,this.y,this.z,this.angle,this.segment)}}function nC(a,o,l,p,y){if(void 0===o.segment)return!0;let w=o,E=o.segment+1,M=0;for(;M>-l/2;){if(E--,E<0)return!1;M-=a[E].dist(w),w=a[E]}M+=a[E].dist(a[E+1]),E++;const k=[];let F=0;for(;M<l/2;){const U=a[E],z=a[E+1];if(!z)return!1;let Z=a[E-1].angleTo(U)-U.angleTo(z);for(Z=Math.abs((Z+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:M,angleDelta:Z}),F+=Z;M-k[0].distance>p;)F-=k.shift().angleDelta;if(F>y)return!1;E++,M+=U.dist(z)}return!0}function Ux(a){let o=0;for(let l=0;l<a.length-1;l++)o+=a[l].dist(a[l+1]);return o}function jx(a,o,l){return a?.6*o*l:0}function iC(a,o){return Math.max(a?a.right-a.left:0,o?o.right-o.left:0)}function YT(a,o,l,p,y,w){const E=jx(l,y,w),M=iC(l,p)*w;let k=0;const F=Ux(a)/2;for(let U=0;U<a.length-1;U++){const z=a[U],Z=a[U+1],te=z.dist(Z);if(k+te>F){const ie=(F-k)/te,K=di(z.x,Z.x,ie),pe=di(z.y,Z.y,ie),Ee=new Tc(K,pe,0,Z.angleTo(z),U);return!E||nC(a,Ee,M,E,o)?Ee:void 0}k+=te}}function wg(a,o,l,p,y,w,E,M,k){const F=jx(p,w,E),U=iC(p,y),z=U*E,Z=0===a[0].x||a[0].x===k||0===a[0].y||a[0].y===k;return o-z<o/4&&(o=z+o/4),c0(a,Z?o/2*M%o:(U/2+2*w)*E*M%o,o,F,l,z,Z,!1,k)}function c0(a,o,l,p,y,w,E,M,k){const F=w/2,U=Ux(a);let z=0,Z=o-l,te=[];for(let ie=0;ie<a.length-1;ie++){const K=a[ie],pe=a[ie+1],Ee=K.dist(pe),xe=pe.angleTo(K);for(;Z+l<z+Ee;){Z+=l;const we=(Z-z)/Ee,Ce=di(K.x,pe.x,we),Le=di(K.y,pe.y,we);if(Ce>=0&&Ce<k&&Le>=0&&Le<k&&Z-F>=0&&Z+F<=U){const ke=new Tc(Ce,Le,0,xe,ie);ke._round(),p&&!nC(a,ke,w,p,y)||te.push(ke)}}z+=Ee}return M||te.length||E||(te=c0(a,z/2,l,p,y,w,E,!0,k)),te}function rC(a,o,l,p,y){const w=[];for(let E=0;E<a.length;E++){const M=a[E];let k;for(let F=0;F<M.length-1;F++){let U=M[F],z=M[F+1];U.x<o&&z.x<o||(U.x<o?U=new Ye(o,U.y+(o-U.x)/(z.x-U.x)*(z.y-U.y))._round():z.x<o&&(z=new Ye(o,U.y+(o-U.x)/(z.x-U.x)*(z.y-U.y))._round()),U.y<l&&z.y<l||(U.y<l?U=new Ye(U.x+(l-U.y)/(z.y-U.y)*(z.x-U.x),l)._round():z.y<l&&(z=new Ye(U.x+(l-U.y)/(z.y-U.y)*(z.x-U.x),l)._round()),U.x>=p&&z.x>=p||(U.x>=p?U=new Ye(p,U.y+(p-U.x)/(z.x-U.x)*(z.y-U.y))._round():z.x>=p&&(z=new Ye(p,U.y+(p-U.x)/(z.x-U.x)*(z.y-U.y))._round()),U.y>=y&&z.y>=y||(U.y>=y?U=new Ye(U.x+(y-U.y)/(z.y-U.y)*(z.x-U.x),y)._round():z.y>=y&&(z=new Ye(U.x+(y-U.y)/(z.y-U.y)*(z.x-U.x),y)._round()),k&&U.equals(k[k.length-1])||(k=[U],w.push(k)),k.push(z)))))}}return w}mn(Tc,"Anchor");const Cg=1e20;function $x(a,o,l,p,y,w,E,M,k){for(let F=o;F<o+p;F++)my(a,l*w+F,w,y,E,M,k);for(let F=l;F<l+y;F++)my(a,F*w+o,1,p,E,M,k)}function my(a,o,l,p,y,w,E){w[0]=0,E[0]=-Cg,E[1]=Cg,y[0]=a[o];for(let M=1,k=0,F=0;M<p;M++){y[M]=a[o+M*l];const U=M*M;do{const z=w[k];F=(y[M]-y[z]+U-z*z)/(M-z)/2}while(F<=E[k]&&--k>-1);k++,w[k]=M,E[k]=F,E[k+1]=Cg}for(let M=0,k=0;M<p;M++){for(;E[k+1]<M;)k++;const F=w[k],U=M-F;a[o+M*l]=y[F]+U*U}}const Zf={none:0,ideographs:1,all:2};class Gd{constructor(o,l,p){this.requestManager=o,this.localGlyphMode=l,this.localFontFamily=p,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o){this.url=o}getGlyphs(o,l){const p=[];for(const y in o)for(const w of o[y])p.push({stack:y,id:w});On(p,({stack:y,id:w},E)=>{let M=this.entries[y];M||(M=this.entries[y]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let k=M.glyphs[w];if(void 0!==k)return void E(null,{stack:y,id:w,glyph:k});if(k=this._tinySDF(M,y,w),k)return M.glyphs[w]=k,void E(null,{stack:y,id:w,glyph:k});const F=Math.floor(w/256);if(256*F>65535)return void E(new Error("glyphs > 65535 not supported"));if(M.ranges[F])return void E(null,{stack:y,id:w,glyph:k});let U=M.requests[F];U||(U=M.requests[F]=[],Gd.loadGlyphRange(y,F,this.url,this.requestManager,(z,Z)=>{if(Z){M.ascender=Z.ascender,M.descender=Z.descender;for(const te in Z.glyphs)this._doesCharSupportLocalGlyph(+te)||(M.glyphs[+te]=Z.glyphs[+te]);M.ranges[F]=!0}for(const te of U)te(z,Z);delete M.requests[F]})),U.push((z,Z)=>{z?E(z):Z&&E(null,{stack:y,id:w,glyph:Z.glyphs[w]||null})})},(y,w)=>{if(y)l(y);else if(w){const E={};for(const{stack:M,id:k,glyph:F}of w)void 0===E[M]&&(E[M]={}),void 0===E[M].glyphs&&(E[M].glyphs={}),E[M].glyphs[k]=F&&{id:F.id,bitmap:F.bitmap.clone(),metrics:F.metrics},E[M].ascender=this.entries[M].ascender,E[M].descender=this.entries[M].descender;l(null,E)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==Zf.none&&(this.localGlyphMode===Zf.all?!!this.localFontFamily:!!this.localFontFamily&&(nu(o)||Ym(o)||wh(o)||Ch(o)||Ra(o)))}_tinySDF(o,l,p){const y=this.localFontFamily;if(!y||!this._doesCharSupportLocalGlyph(p))return;let w=o.tinySDF;if(!w){let K="400";/bold/i.test(l)?K="900":/medium/i.test(l)?K="500":/light/i.test(l)&&(K="200"),w=o.tinySDF=new Gd.TinySDF({fontFamily:y,fontWeight:K,fontSize:48,buffer:6,radius:16}),w.fontWeight=K}if(this.localGlyphs[w.fontWeight][p])return this.localGlyphs[w.fontWeight][p];const E=String.fromCharCode(p),{data:M,width:k,height:F,glyphWidth:U,glyphHeight:z,glyphLeft:Z,glyphTop:te,glyphAdvance:ie}=w.draw(E);return this.localGlyphs[w.fontWeight][p]={id:p,bitmap:new Js({width:k,height:F},M),metrics:{width:U/2,height:z/2,left:Z/2,top:te/2-27,advance:ie/2,localGlyph:!0}}}}function Yf(a,o,l,p){const y=[],w=a.image,E=w.pixelRatio,M=w.paddedRect.w-2,k=w.paddedRect.h-2,F=a.right-a.left,U=a.bottom-a.top,z=w.stretchX||[[0,M]],Z=w.stretchY||[[0,k]],te=(ht,Tt)=>ht+Tt[1]-Tt[0],ie=z.reduce(te,0),K=Z.reduce(te,0),pe=M-ie,Ee=k-K;let xe=0,we=ie,Ce=0,Le=K,ke=0,st=pe,rt=0,bt=Ee;if(w.content&&p){const ht=w.content;xe=Hh(z,0,ht[0]),Ce=Hh(Z,0,ht[1]),we=Hh(z,ht[0],ht[2]),Le=Hh(Z,ht[1],ht[3]),ke=ht[0]-xe,rt=ht[1]-Ce,st=ht[2]-ht[0]-we,bt=ht[3]-ht[1]-Le}const Gt=(ht,Tt,xt,kt)=>{const At=pm(ht.stretch-xe,we,F,a.left),ct=mm(ht.fixed-ke,st,ht.stretch,ie),ln=pm(Tt.stretch-Ce,Le,U,a.top),Wn=mm(Tt.fixed-rt,bt,Tt.stretch,K),fn=pm(xt.stretch-xe,we,F,a.left),An=mm(xt.fixed-ke,st,xt.stretch,ie),Wt=pm(kt.stretch-Ce,Le,U,a.top),ti=mm(kt.fixed-rt,bt,kt.stretch,K),Di=new Ye(At,ln),Ri=new Ye(fn,ln),Ai=new Ye(fn,Wt),Jn=new Ye(At,Wt),Gi=new Ye(ct/E,Wn/E),hi=new Ye(An/E,ti/E),Vi=o*Math.PI/180;if(Vi){const Dr=Math.sin(Vi),Ar=Math.cos(Vi),Br=[Ar,-Dr,Dr,Ar];Di._matMult(Br),Ri._matMult(Br),Jn._matMult(Br),Ai._matMult(Br)}const Tr=ht.stretch+ht.fixed,yr=Tt.stretch+Tt.fixed;return{tl:Di,tr:Ri,bl:Jn,br:Ai,tex:{x:w.paddedRect.x+1+Tr,y:w.paddedRect.y+1+yr,w:xt.stretch+xt.fixed-Tr,h:kt.stretch+kt.fixed-yr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Gi,pixelOffsetBR:hi,minFontScaleX:st/E/F,minFontScaleY:bt/E/U,isSDF:l}};if(p&&(w.stretchX||w.stretchY)){const ht=Eg(z,pe,ie),Tt=Eg(Z,Ee,K);for(let xt=0;xt<ht.length-1;xt++){const kt=ht[xt],At=ht[xt+1];for(let ct=0;ct<Tt.length-1;ct++)y.push(Gt(kt,Tt[ct],At,Tt[ct+1]))}}else y.push(Gt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:k+1}));return y}function Hh(a,o,l){let p=0;for(const y of a)p+=Math.max(o,Math.min(l,y[1]))-Math.max(o,Math.min(l,y[0]));return p}function Eg(a,o,l){const p=[{fixed:-1,stretch:0}];for(const[y,w]of a){const E=p[p.length-1];p.push({fixed:y-E.stretch,stretch:E.stretch}),p.push({fixed:y-E.stretch,stretch:E.stretch+(w-y)})}return p.push({fixed:o+1,stretch:l}),p}function pm(a,o,l,p){return a/o*l+p}function mm(a,o,l,p){return a-o*l/p}function u0(a,o,l,p){const y=o+a.positionedLines[p].lineOffset;return 0===p?l+y/2:l+(y+(o+a.positionedLines[p-1].lineOffset))/2}Gd.loadGlyphRange=function(a,o,l,p,y){const w=256*o,E=w+255,M=p.transformRequest(p.normalizeGlyphsURL(l).replace("{fontstack}",a).replace("{range}",`${w}-${E}`),jn.Glyphs);Xr(M,(k,F)=>{if(k)y(k);else if(F){const U={},z=new ko(F).readFields(a0,{});for(const Z of z.glyphs)U[Z.id]=Z;y(null,{glyphs:U,ascender:z.ascender,descender:z.descender})}})},Gd.TinySDF=class{constructor({fontSize:a=24,buffer:o=3,radius:l=8,cutoff:p=.25,fontFamily:y="sans-serif",fontWeight:w="normal",fontStyle:E="normal"}={}){this.buffer=o,this.cutoff=p,this.radius=l;const M=this.size=a+4*o,k=this._createCanvas(M),F=this.ctx=k.getContext("2d",{willReadFrequently:!0});F.font=`${E} ${w} ${a}px ${y}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(a){const o=document.createElement("canvas");return o.width=o.height=a,o}draw(a){const{width:o,actualBoundingBoxAscent:l,actualBoundingBoxDescent:p,actualBoundingBoxLeft:y,actualBoundingBoxRight:w}=this.ctx.measureText(a),E=Math.ceil(l),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-y))),k=Math.min(this.size-this.buffer,E+Math.ceil(p)),F=M+2*this.buffer,U=k+2*this.buffer,z=Math.max(F*U,0),Z=new Uint8ClampedArray(z),te={data:Z,width:F,height:U,glyphWidth:M,glyphHeight:k,glyphTop:E,glyphLeft:0,glyphAdvance:o};if(0===M||0===k)return te;const{ctx:ie,buffer:K,gridInner:pe,gridOuter:Ee}=this;ie.clearRect(K,K,M,k),ie.fillText(a,K,K+E);const xe=ie.getImageData(K,K,M,k);Ee.fill(Cg,0,z),pe.fill(0,0,z);for(let we=0;we<k;we++)for(let Ce=0;Ce<M;Ce++){const Le=xe.data[4*(we*M+Ce)+3]/255;if(0===Le)continue;const ke=(we+K)*F+Ce+K;if(1===Le)Ee[ke]=0,pe[ke]=Cg;else{const st=.5-Le;Ee[ke]=st>0?st*st:0,pe[ke]=st<0?st*st:0}}$x(Ee,0,0,F,U,F,this.f,this.v,this.z),$x(pe,K,K,M,k,F,this.f,this.v,this.z);for(let we=0;we<z;we++){const Ce=Math.sqrt(Ee[we])-Math.sqrt(pe[we]);Z[we]=Math.round(255-255*(Ce/this.radius+this.cutoff))}return te}};class gy{constructor(o=[],l=Gx){if(this.data=o,this.length=this.data.length,this.compare=l,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const o=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:l,compare:p}=this,y=l[o];for(;o>0;){const w=o-1>>1,E=l[w];if(p(y,E)>=0)break;l[o]=E,o=w}l[o]=y}_down(o){const{data:l,compare:p}=this,y=this.length>>1,w=l[o];for(;o<y;){let E=1+(o<<1),M=l[E];const k=E+1;if(k<this.length&&p(l[k],M)<0&&(E=k,M=l[k]),p(M,w)>=0)break;l[o]=M,o=E}l[o]=w}}function Gx(a,o){return a<o?-1:a>o?1:0}function Hx(a,o=1,l=!1){let p=1/0,y=1/0,w=-1/0,E=-1/0;const M=a[0];for(let te=0;te<M.length;te++){const ie=M[te];(!te||ie.x<p)&&(p=ie.x),(!te||ie.y<y)&&(y=ie.y),(!te||ie.x>w)&&(w=ie.x),(!te||ie.y>E)&&(E=ie.y)}const k=Math.min(w-p,E-y);let F=k/2;const U=new gy([],_y);if(0===k)return new Ye(p,y);for(let te=p;te<w;te+=k)for(let ie=y;ie<E;ie+=k)U.push(new od(te+F,ie+F,F,a));let z=function(te){let ie=0,K=0,pe=0;const Ee=te[0];for(let xe=0,we=Ee.length,Ce=we-1;xe<we;Ce=xe++){const Le=Ee[xe],ke=Ee[Ce],st=Le.x*ke.y-ke.x*Le.y;K+=(Le.x+ke.x)*st,pe+=(Le.y+ke.y)*st,ie+=3*st}return new od(K/ie,pe/ie,0,te)}(a),Z=U.length;for(;U.length;){const te=U.pop();(te.d>z.d||!z.d)&&(z=te,l&&console.log("found best %d after %d probes",Math.round(1e4*te.d)/1e4,Z)),te.max-z.d<=o||(F=te.h/2,U.push(new od(te.p.x-F,te.p.y-F,F,a)),U.push(new od(te.p.x+F,te.p.y-F,F,a)),U.push(new od(te.p.x-F,te.p.y+F,F,a)),U.push(new od(te.p.x+F,te.p.y+F,F,a)),Z+=4)}return l&&(console.log(`num probes: ${Z}`),console.log(`best distance: ${z.d}`)),z.p}function _y(a,o){return o.max-a.max}function od(a,o,l,p){this.p=new Ye(a,o),this.h=l,this.d=function(y,w){let E=!1,M=1/0;for(let k=0;k<w.length;k++){const F=w[k];for(let U=0,z=F.length,Z=z-1;U<z;Z=U++){const te=F[U],ie=F[Z];te.y>y.y!=ie.y>y.y&&y.x<(ie.x-te.x)*(y.y-te.y)/(ie.y-te.y)+te.x&&(E=!E),M=Math.min(M,Vh(y,te,ie))}}return(E?1:-1)*Math.sqrt(M)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}const qx=Number.POSITIVE_INFINITY,KT=Math.sqrt(2);function yy(a,[o,l]){let p=0,y=0;if(l===qx){o<0&&(o=0);const w=o/KT;switch(a){case"top-right":case"top-left":y=w-7;break;case"bottom-right":case"bottom-left":y=7-w;break;case"bottom":y=7-o;break;case"top":y=o-7}switch(a){case"top-right":case"bottom-right":p=-w;break;case"top-left":case"bottom-left":p=w;break;case"left":p=o;break;case"right":p=-o}}else{switch(o=Math.abs(o),l=Math.abs(l),a){case"top-right":case"top-left":case"top":y=l-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-l}switch(a){case"top-right":case"bottom-right":case"right":p=-o;break;case"top-left":case"bottom-left":case"left":p=o}}return[p,y]}function oC(a,o,l,p,y,w,E,M,k,F){a.createArrays(),a.tilePixelRatio=Qn/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const U=a.layers[0].layout,z=a.layers[0]._unevaluatedLayout._values,Z={};if("composite"===a.textSizeData.kind){const{minZoom:K,maxZoom:pe}=a.textSizeData;Z.compositeTextSizes=[z["text-size"].possiblyEvaluate(new Ze(K),M),z["text-size"].possiblyEvaluate(new Ze(pe),M)]}if("composite"===a.iconSizeData.kind){const{minZoom:K,maxZoom:pe}=a.iconSizeData;Z.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new Ze(K),M),z["icon-size"].possiblyEvaluate(new Ze(pe),M)]}Z.layoutTextSize=z["text-size"].possiblyEvaluate(new Ze(k+1),M),Z.layoutIconSize=z["icon-size"].possiblyEvaluate(new Ze(k+1),M),Z.textMaxSize=z["text-size"].possiblyEvaluate(new Ze(18),M);const te="map"===U.get("text-rotation-alignment")&&"point"!==U.get("symbol-placement"),ie=U.get("text-size");for(const K of a.features){const pe=U.get("text-font").evaluate(K,{},M).join(","),Ee=ie.evaluate(K,{},M),xe=Z.layoutTextSize.evaluate(K,{},M),we=(Z.layoutIconSize.evaluate(K,{},M),{horizontal:{},vertical:void 0}),Ce=K.text;let Le,ke=[0,0];if(Ce){const bt=Ce.toString(),Gt=U.get("text-letter-spacing").evaluate(K,{},M)*Fs,ht=U.get("text-line-height").evaluate(K,{},M)*Fs,Tt=D(bt)?Gt:0,xt=U.get("text-anchor").evaluate(K,{},M),kt=U.get("text-variable-anchor");if(!kt){const fn=U.get("text-radial-offset").evaluate(K,{},M);ke=fn?yy(xt,[fn*Fs,qx]):U.get("text-offset").evaluate(K,{},M).map(An=>An*Fs)}let At=te?"center":U.get("text-justify").evaluate(K,{},M);const ct="point"===U.get("symbol-placement"),ln=ct?U.get("text-max-width").evaluate(K,{},M)*Fs:1/0,Wn=fn=>{a.allowVerticalPlacement&&S(bt)&&(we.vertical=hl(Ce,o,l,y,pe,ln,ht,xt,fn,Tt,ke,dl.vertical,!0,xe,Ee))};if(!te&&kt){const fn="auto"===At?kt.map(Wt=>Hd(Wt)):[At];let An=!1;for(let Wt=0;Wt<fn.length;Wt++){const ti=fn[Wt];if(!we.horizontal[ti])if(An)we.horizontal[ti]=we.horizontal[0];else{const Di=hl(Ce,o,l,y,pe,ln,ht,"center",ti,Tt,ke,dl.horizontal,!1,xe,Ee);Di&&(we.horizontal[ti]=Di,An=1===Di.positionedLines.length)}}Wn("left")}else{if("auto"===At&&(At=Hd(xt)),ct||U.get("text-writing-mode").indexOf("horizontal")>=0||!S(bt)){const fn=hl(Ce,o,l,y,pe,ln,ht,xt,At,Tt,ke,dl.horizontal,!1,xe,Ee);fn&&(we.horizontal[At]=fn)}Wn(ct?"left":At)}}let st=!1;if(K.icon&&K.icon.name){const bt=p[K.icon.name];bt&&(Le=fy(y[K.icon.name],U.get("icon-offset").evaluate(K,{},M),U.get("icon-anchor").evaluate(K,{},M)),st=bt.sdf,void 0===a.sdfIcons?a.sdfIcons=bt.sdf:a.sdfIcons!==bt.sdf&&Pi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(bt.pixelRatio!==a.pixelRatio||0!==U.get("icon-rotate").constantOr(1))&&(a.iconsNeedLinear=!0))}const rt=qh(we.horizontal)||we.vertical;a.iconsInText||(a.iconsInText=!!rt&&rt.iconsInText),(rt||Le)&&vy(a,K,we,Le,p,Z,xe,0,ke,st,E,M,F)}w&&a.generateCollisionDebugBuffers(k,a.collisionBoxArray)}function Hd(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vy(a,o,l,p,y,w,E,M,k,F,U,z,Z){let te=w.textMaxSize.evaluate(o,{},z);void 0===te&&(te=E);const ie=a.layers[0].layout,K=ie.get("icon-offset").evaluate(o,{},z),pe=qh(l.horizontal)||l.vertical,Ee="globe"===Z.name,xe=E/24,we=a.tilePixelRatio*te/24,Ce=(Tt=a.overscaling,a.zoom>18&&Tt>2&&(Tt>>=1),Math.max(Qn/(512*Tt),1)*ie.get("symbol-spacing")),Le=ie.get("text-padding")*a.tilePixelRatio,ke=ie.get("icon-padding")*a.tilePixelRatio,st=Ct(ie.get("text-max-angle")),rt="map"===ie.get("text-rotation-alignment")&&"point"!==ie.get("symbol-placement"),bt="map"===ie.get("icon-rotation-alignment")&&"point"!==ie.get("symbol-placement"),Gt=ie.get("symbol-placement"),ht=Ce/2;var Tt;const xt=ie.get("icon-text-fit");let kt;p&&"none"!==xt&&(a.allowVerticalPlacement&&l.vertical&&(kt=py(p,l.vertical,xt,ie.get("icon-text-fit-padding"),K,xe)),pe&&(p=py(p,pe,xt,ie.get("icon-text-fit-padding"),K,xe)));const At=(ct,ln,Wn)=>{if(ln.x<0||ln.x>=Qn||ln.y<0||ln.y>=Qn)return;let fn=null;if(Ee){const{x:An,y:Wt,z:ti}=Z.projectTilePoint(ln.x,ln.y,Wn);fn={anchor:new Tc(An,Wt,ti,0,void 0),up:Z.upVector(Wn,ln.x,ln.y)}}!function(An,Wt,ti,Di,Ri,Ai,Jn,Gi,hi,Vi,Tr,yr,Dr,Ar,Br,To,ws,mr,Fo,Io,nr,Yr,es,_r,go){const qs=An.addToLineVertexArray(Wt,Di);let Lo,Cs,ps,Es,yu,cd,Wl,wm=0,D0=0,Zh=0,Py=0,rp=-1,Oy=-1;const Zl={};let jg=Nl("");const op=ti?ti.anchor:Wt;let mi=0,A0=0;if(void 0===hi._unevaluatedLayout.getValue("text-radial-offset")?[mi,A0]=hi.layout.get("text-offset").evaluate(nr,{},go).map(Ga=>Ga*Fs):(mi=hi.layout.get("text-radial-offset").evaluate(nr,{},go)*Fs,A0=qx),An.allowVerticalPlacement&&Ri.vertical){const Ga=Ri.vertical;if(Br)cd=d0(Ga),Gi&&(Wl=d0(Gi));else{const ea=hi.layout.get("text-rotate").evaluate(nr,{},go)+90;ps=Kf(Vi,op,Wt,Tr,yr,Dr,Ga,Ar,ea,To),Gi&&(Es=Kf(Vi,op,Wt,Tr,yr,Dr,Gi,mr,ea))}}if(Ai){const Ga=hi.layout.get("icon-rotate").evaluate(nr,{},go),ea="none"!==hi.layout.get("icon-text-fit"),ud=Yf(Ai,Ga,es,ea),_o=Gi?Yf(Gi,Ga,es,ea):void 0;Cs=Kf(Vi,op,Wt,Tr,yr,Dr,Ai,mr,Ga),wm=4*ud.length;const P0=An.iconSizeData;let So=null;"source"===P0.kind?(So=[jl*hi.layout.get("icon-size").evaluate(nr,{},go)],So[0]>Ic&&Pi(`${An.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===P0.kind&&(So=[jl*Yr.compositeIconSizes[0].evaluate(nr,{},go),jl*Yr.compositeIconSizes[1].evaluate(nr,{},go)],(So[0]>Ic||So[1]>Ic)&&Pi(`${An.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),An.addSymbols(An.icon,ud,So,Io,Fo,nr,!1,ti,Wt,qs.lineStartIndex,qs.lineLength,-1,_r,go),rp=An.icon.placedSymbolArray.length-1,_o&&(D0=4*_o.length,An.addSymbols(An.icon,_o,So,Io,Fo,nr,dl.vertical,ti,Wt,qs.lineStartIndex,qs.lineLength,-1,_r,go),Oy=An.icon.placedSymbolArray.length-1)}for(const Ga in Ri.horizontal){const ea=Ri.horizontal[Ga];Lo||(jg=Nl(ea.text),Br?yu=d0(ea):Lo=Kf(Vi,op,Wt,Tr,yr,Dr,ea,Ar,hi.layout.get("text-rotate").evaluate(nr,{},go),To));const ud=1===ea.positionedLines.length;if(Zh+=Tg(An,ti,Wt,ea,Jn,hi,Br,nr,To,qs,Ri.vertical?dl.horizontal:dl.horizontalOnly,ud?Object.keys(Ri.horizontal):[Ga],Zl,rp,Yr,_r,go),ud)break}Ri.vertical&&(Py+=Tg(An,ti,Wt,Ri.vertical,Jn,hi,Br,nr,To,qs,dl.vertical,["vertical"],Zl,Oy,Yr,_r,go));let Yd=-1;const ky=(Ga,ea)=>Ga?Math.max(Ga,ea):ea;Yd=ky(yu,Yd),Yd=ky(cd,Yd),Yd=ky(Wl,Yd);const Yh=Yd>-1?1:0;An.glyphOffsetArray.length>=ad.MAX_GLYPHS&&Pi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==nr.sortKey&&An.addToSortKeyRanges(An.symbolInstances.length,nr.sortKey),An.symbolInstances.emplaceBack(op.x,op.y,op.z,Wt.x,Wt.y,Zl.right>=0?Zl.right:-1,Zl.center>=0?Zl.center:-1,Zl.left>=0?Zl.left:-1,Zl.vertical>=0?Zl.vertical:-1,rp,Oy,jg,void 0!==Lo?Lo:An.collisionBoxArray.length,void 0!==Lo?Lo+1:An.collisionBoxArray.length,void 0!==ps?ps:An.collisionBoxArray.length,void 0!==ps?ps+1:An.collisionBoxArray.length,void 0!==Cs?Cs:An.collisionBoxArray.length,void 0!==Cs?Cs+1:An.collisionBoxArray.length,Es||An.collisionBoxArray.length,Es?Es+1:An.collisionBoxArray.length,Tr,Zh,Py,wm,D0,Yh,0,mi,A0,Yd)}(a,ln,fn,ct,l,p,y,kt,a.layers[0],a.collisionBoxArray,o.index,o.sourceLayerIndex,a.index,Le,rt,k,0,ke,bt,K,o,w,F,U,z)};if("line"===Gt)for(const ct of rC(o.geometry,0,0,Qn,Qn)){const ln=wg(ct,Ce,st,l.vertical||pe,p,24,we,a.overscaling,Qn);for(const Wn of ln)pe&&Ig(a,pe.text,ht,Wn)||At(ct,Wn,z)}else if("line-center"===Gt){for(const ct of o.geometry)if(ct.length>1){const ln=YT(ct,st,l.vertical||pe,p,24,we);ln&&At(ct,ln,z)}}else if("Polygon"===o.type)for(const ct of q_(o.geometry,0)){const ln=Hx(ct,16);At(ct[0],new Tc(ln.x,ln.y,0,0,void 0),z)}else if("LineString"===o.type)for(const ct of o.geometry)At(ct,new Tc(ct[0].x,ct[0].y,0,0,void 0),z);else if("Point"===o.type)for(const ct of o.geometry)for(const ln of ct)At([ln],new Tc(ln.x,ln.y,0,0,void 0),z)}const Ic=32640;function Tg(a,o,l,p,y,w,E,M,k,F,U,z,Z,te,ie,K,pe){const Ee=function(Ce,Le,ke,st,rt,bt,Gt,ht){const Tt=[];if(0===Le.positionedLines.length)return Tt;const xt=st.layout.get("text-rotate").evaluate(bt,{})*Math.PI/180,kt=function(fn){const An=fn[0],Wt=fn[1],ti=An*Wt;return ti>0?[An,-Wt]:ti<0?[-An,Wt]:0===An?[Wt,An]:[Wt,-An]}(ke);let At=Math.abs(Le.top-Le.bottom);for(const fn of Le.positionedLines)At-=fn.lineOffset;const ct=Le.positionedLines.length,ln=At/ct;let Wn=Le.top-ke[1];for(let fn=0;fn<ct;++fn){const An=Le.positionedLines[fn];Wn=u0(Le,ln,Wn,fn);for(const Wt of An.positionedGlyphs){if(!Wt.rect)continue;const ti=Wt.rect||{};let Di=4,Ri=!0,Ai=1,Jn=0;if(Wt.imageName){const _r=Gt[Wt.imageName];if(!_r)continue;if(_r.sdf){Pi("SDF images are not supported in formatted text and will be ignored.");continue}Ri=!1,Ai=_r.pixelRatio,Di=1/Ai}const Gi=(rt||ht)&&Wt.vertical,hi=Wt.metrics.advance*Wt.scale/2,Vi=Wt.metrics,Tr=Wt.rect;if(null===Tr)continue;ht&&Le.verticalizable&&(Jn=Wt.imageName?hi-Wt.metrics.width*Wt.scale/2:0);const yr=rt?[Wt.x+hi,Wt.y]:[0,0];let Dr=[0,0],Ar=[0,0],Br=!1;rt||(Gi?(Ar=[Wt.x+hi+kt[0],Wt.y+kt[1]-Jn],Br=!0):Dr=[Wt.x+hi+ke[0],Wt.y+ke[1]-Jn]);const To=Tr.w*Wt.scale/(Ai*(Wt.localGlyph?2:1)),ws=Tr.h*Wt.scale/(Ai*(Wt.localGlyph?2:1));let mr,Fo,Io,nr;if(Gi){const _r=Wt.y-Wn,go=new Ye(-hi,hi-_r),qs=-Math.PI/2,Lo=new Ye(...Ar);mr=new Ye(-hi+Dr[0],Dr[1]),mr._rotateAround(qs,go)._add(Lo),mr.x+=-_r+hi,mr.y-=(Vi.left-Di)*Wt.scale;const Cs=Wt.imageName?Vi.advance*Wt.scale:Fs*Wt.scale,ps=String.fromCharCode(Wt.glyph);Ox(ps)?mr.x+=(1-Di)*Wt.scale:ba(ps)?mr.x+=Cs-Vi.height*Wt.scale+(-Di-1)*Wt.scale:mr.x+=Wt.imageName||Vi.width+2*Di===Tr.w&&Vi.height+2*Di===Tr.h?(Cs-ws)/2:(Cs-(Vi.height+2*Di)*Wt.scale)/2,Fo=new Ye(mr.x,mr.y-To),Io=new Ye(mr.x+ws,mr.y),nr=new Ye(mr.x+ws,mr.y-To)}else{const _r=(Vi.left-Di)*Wt.scale-hi+Dr[0],go=(-Vi.top-Di)*Wt.scale+Dr[1],qs=_r+To,Lo=go+ws;mr=new Ye(_r,go),Fo=new Ye(qs,go),Io=new Ye(_r,Lo),nr=new Ye(qs,Lo)}if(xt){let _r;_r=rt?new Ye(0,0):Br?new Ye(kt[0],kt[1]):new Ye(ke[0],ke[1]),mr._rotateAround(xt,_r),Fo._rotateAround(xt,_r),Io._rotateAround(xt,_r),nr._rotateAround(xt,_r)}const Yr=new Ye(0,0),es=new Ye(0,0);Tt.push({tl:mr,tr:Fo,bl:Io,br:nr,tex:ti,writingMode:Le.writingMode,glyphOffset:yr,sectionIndex:Wt.sectionIndex,isSDF:Ri,pixelOffsetTL:Yr,pixelOffsetBR:es,minFontScaleX:0,minFontScaleY:0})}}return Tt}(0,p,k,w,E,M,y,a.allowVerticalPlacement),xe=a.textSizeData;let we=null;"source"===xe.kind?(we=[jl*w.layout.get("text-size").evaluate(M,{},pe)],we[0]>Ic&&Pi(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===xe.kind&&(we=[jl*ie.compositeTextSizes[0].evaluate(M,{},pe),jl*ie.compositeTextSizes[1].evaluate(M,{},pe)],(we[0]>Ic||we[1]>Ic)&&Pi(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,Ee,we,k,E,M,U,o,l,F.lineStartIndex,F.lineLength,te,K,pe);for(const Ce of z)Z[Ce]=a.text.placedSymbolArray.length-1;return 4*Ee.length}function qh(a){for(const o in a)return a[o];return null}function Kf(a,o,l,p,y,w,E,M,k,F){let U=E.top,z=E.bottom,Z=E.left,te=E.right;const ie=E.collisionPadding;if(ie&&(Z-=ie[0],U-=ie[1],te+=ie[2],z+=ie[3]),k){const K=new Ye(Z,U),pe=new Ye(te,U),Ee=new Ye(Z,z),xe=new Ye(te,z),we=Ct(k);let Ce=new Ye(0,0);F&&(Ce=new Ye(F[0],F[1])),K._rotateAround(we,Ce),pe._rotateAround(we,Ce),Ee._rotateAround(we,Ce),xe._rotateAround(we,Ce),Z=Math.min(K.x,pe.x,Ee.x,xe.x),te=Math.max(K.x,pe.x,Ee.x,xe.x),U=Math.min(K.y,pe.y,Ee.y,xe.y),z=Math.max(K.y,pe.y,Ee.y,xe.y)}return a.emplaceBack(o.x,o.y,o.z,l.x,l.y,Z,U,te,z,M,p,y,w),a.length-1}function d0(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const o=a.bottom-a.top;return o>0?Math.max(10,o):null}function Ig(a,o,l,p){const y=a.compareText;if(o in y){const w=y[o];for(let E=w.length-1;E>=0;E--)if(p.dist(w[E])<l)return!0}else y[o]=[];return y[o].push(p),!1}function Sg(a,o){const l=a.fovAboveCenter,p=a.elevation?a.elevation.getMinElevationBelowMSL()*o:0,y=(a._camera.position[2]*a.worldSize-p)/Math.cos(a._pitch),w=Math.sin(l)*y/Math.sin(Math.max(Math.PI/2-a._pitch-l,.01)),E=Math.sin(a._pitch)*w+y;return Math.min(1.01*E,y*(1/a._horizonShift))}function xa(a,o){if(!o.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:o};const l=Math.pow(2,-a.z),p=a.x*l,y=(a.x+1)*l,w=a.y*l,E=(a.y+1)*l,M=Va(p),k=Va(y),F=Qs(w),U=Qs(E),z=o.project(M,F),Z=o.project(k,F),te=o.project(k,U),ie=o.project(M,U);let K=Math.min(z.x,Z.x,te.x,ie.x),pe=Math.min(z.y,Z.y,te.y,ie.y),Ee=Math.max(z.x,Z.x,te.x,ie.x),xe=Math.max(z.y,Z.y,te.y,ie.y);const we=l/16;function Ce(ke,st,rt,bt,Gt,ht){const Tt=(rt+Gt)/2,xt=(bt+ht)/2,kt=o.project(Va(Tt),Qs(xt)),At=Math.max(0,K-kt.x,pe-kt.y,kt.x-Ee,kt.y-xe);K=Math.min(K,kt.x),Ee=Math.max(Ee,kt.x),pe=Math.min(pe,kt.y),xe=Math.max(xe,kt.y),At>we&&(Ce(ke,kt,rt,bt,Tt,xt),Ce(kt,st,Tt,xt,Gt,ht))}Ce(z,Z,p,w,y,w),Ce(Z,te,y,w,y,E),Ce(te,ie,y,E,p,E),Ce(ie,z,p,E,p,w),K-=we,pe-=we,Ee+=we,xe+=we;const Le=1/Math.max(Ee-K,xe-pe);return{scale:Le,x:K*Le,y:pe*Le,x2:Ee*Le,y2:xe*Le,projection:o}}const Mg=_c(new Float32Array(16));class Ro{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,l){return{x:0,y:0,z:0}}unproject(o,l){return new tr(0,0)}projectTilePoint(o,l,p){return{x:o,y:l,z:0}}locationPoint(o,l,p=!0){return o._coordinatePoint(o.locationCoordinate(l),p)}pixelsPerMeter(o,l){return Ul(1,o)*l}pixelSpaceConversion(o,l,p){return 1}farthestPixelDistance(o){return Sg(o,o.pixelsPerMeter)}pointCoordinate(o,l,p,y){const w=o.horizonLineFromTop(!1),E=new Ye(l,Math.max(w,p));return o.rayIntersectionCoordinate(o.pointRayIntersection(E,y))}pointCoordinate3D(o,l,p){const y=new Ye(l,p);if(o.elevation)return o.elevation.pointCoordinate(y);{const w=this.pointCoordinate(o,y.x,y.y,0);return[w.x,w.y,w.z]}}isPointAboveHorizon(o,l){if(o.elevation)return!this.pointCoordinate3D(o,l.x,l.y);const p=o.horizonLineFromTop();return l.y<p}createInversionMatrix(o,l){return Mg}createTileMatrix(o,l,p){let y,w,E;const M=p.canonical,k=_c(new Float64Array(16));if(this.isReprojectedInTileSpace){const F=xa(M,this);y=1,w=F.x+p.wrap*F.scale,E=F.y,yc(k,k,[y/F.scale,y/F.scale,o.pixelsPerMeter/l])}else y=l/o.zoomScale(M.z),w=(M.x+Math.pow(2,M.z)*p.wrap)*y,E=M.y*y;return Fh(k,k,[w,E,0]),yc(k,k,[y/Qn,y/Qn,1]),k}upVector(o,l,p){return[0,0,1]}upVectorScale(o,l,p){return{metersToTile:1}}}class Xf extends Ro{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[l,p]=this.parallels=o.parallels||[29.5,45.5],y=Math.sin(Ct(l));this.n=(y+Math.sin(Ct(p)))/2,this.c=1+y*(2*this.n-y),this.r0=Math.sqrt(this.c)/this.n}project(o,l){const{n:p,c:y,r0:w}=this,E=Ct(o-this.center[0]),M=Ct(l),k=Math.sqrt(y-2*p*Math.sin(M))/p;return{x:k*Math.sin(E*p),y:k*Math.cos(E*p)-w,z:0}}unproject(o,l){const{n:p,c:y,r0:w}=this,E=w+l;let M=Math.atan2(o,Math.abs(E))*Math.sign(E);E*p<0&&(M-=Math.PI*Math.sign(o)*Math.sign(E));const k=Ct(this.center[0])*p;M=oi(M,-Math.PI-k,Math.PI-k);const F=Bt(Pt(M/p)+this.center[0],-180,180),U=Math.asin(Bt((y-(o*o+E*E)*p*p)/(2*p),-1,1)),z=Bt(Pt(U),-Eo,Eo);return new tr(F,z)}}const qd=1.340264,wa=-.081106,gm=893e-6,sd=.003796,fu=Math.sqrt(3)/2;class Dg extends Ro{project(o,l){l=l/180*Math.PI,o=o/180*Math.PI;const p=Math.asin(fu*Math.sin(l)),y=p*p,w=y*y*y;return{x:.5*(o*Math.cos(p)/(fu*(qd+3*wa*y+w*(7*gm+9*sd*y)))/Math.PI+.5),y:1-.5*(p*(qd+wa*y+w*(gm+sd*y))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let p=l=(2*(1-l)-1)*Math.PI,y=p*p,w=y*y*y;for(let U,z,Z,te=0;te<12&&(z=p*(qd+wa*y+w*(gm+sd*y))-l,Z=qd+3*wa*y+w*(7*gm+9*sd*y),U=z/Z,p=Bt(p-U,-Math.PI/3,Math.PI/3),y=p*p,w=y*y*y,!(Math.abs(U)<1e-12));++te);const E=fu*o*(qd+3*wa*y+w*(7*gm+9*sd*y))/Math.cos(p),M=Math.asin(Math.sin(p)/fu),k=Bt(180*E/Math.PI,-180,180),F=Bt(180*M/Math.PI,-Eo,Eo);return new tr(k,F)}}class Ag extends Ro{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){return{x:.5+o/360,y:.5-l/360,z:0}}unproject(o,l){const p=360*(o-.5),y=Bt(360*(.5-l),-Eo,Eo);return new tr(p,y)}}const Gl=Math.PI/2;function Wd(a){return Math.tan((Gl+a)/2)}class Qf extends Ro{constructor(o){super(o),this.center=o.center||[0,30];const[l,p]=this.parallels=o.parallels||[30,30];let y=Ct(l),w=Ct(p);this.southernCenter=y+w<0,this.southernCenter&&(y=-y,w=-w);const E=Math.cos(y),M=Wd(y);this.n=y===w?Math.sin(y):Math.log(E/Math.cos(w))/Math.log(Wd(w)/M),this.f=E*Math.pow(Wd(y),this.n)/this.n}project(o,l){l=Ct(l),this.southernCenter&&(l=-l),o=Ct(o-this.center[0]);const p=1e-6,{n:y,f:w}=this;w>0?l<-Gl+p&&(l=-Gl+p):l>Gl-p&&(l=Gl-p);const E=w/Math.pow(Wd(l),y);let M=E*Math.sin(y*o),k=w-E*Math.cos(y*o);return M=.5*(M/Math.PI+.5),k=.5*(k/Math.PI+.5),{x:M,y:this.southernCenter?k:1-k,z:0}}unproject(o,l){o=(2*o-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:p,f:y}=this,w=y-l,E=Math.sign(w),M=Math.sign(p)*Math.sqrt(o*o+w*w);let k=Math.atan2(o,Math.abs(w))*E;w*p<0&&(k-=Math.PI*Math.sign(o)*E);const F=Bt(Pt(k/p)+this.center[0],-180,180),U=Bt(Pt(2*Math.atan(Math.pow(y/M,1/p))-Gl),-Eo,Eo);return new tr(F,this.southernCenter?-U:U)}}class Zd extends Ro{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,l){return{x:Ju(o),y:ed(l),z:0}}unproject(o,l){const p=Va(o),y=Qs(l);return new tr(p,y)}}const Jf=Ct(Eo);class sC extends Ro{project(o,l){const p=(l=Ct(l))*l,y=p*p;return{x:.5*((o=Ct(o))*(.8707-.131979*p+y*(y*(.003971*p-.001529*y)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+p*(.015085+y*(.028874*p-.044475-.005916*y)))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let p=l=(2*(1-l)-1)*Math.PI,y=25,w=0,E=p*p;do{E=p*p;const F=E*E;w=(p*(1.007226+E*(.015085+F*(.028874*E-.044475-.005916*F)))-l)/(1.007226+E*(.045255+F*(.259866*E-.311325-.005916*11*F))),p=Bt(p-w,-Jf,Jf)}while(Math.abs(w)>1e-6&&--y>0);E=p*p;const M=Bt(Pt(o/(.8707+E*(E*(E*E*E*(.003971-.001529*E)-.013791)-.131979))),-180,180),k=Pt(p);return new tr(M,k)}}const h0=Ct(Eo);class _m extends Ro{project(o,l){l=Ct(l),o=Ct(o);const p=Math.cos(l),y=2/Math.PI,w=Math.acos(p*Math.cos(o/2)),E=Math.sin(w)/w,M=.5*(o*y+2*p*Math.sin(o/2)/E)||0,k=.5*(l+Math.sin(l)/E)||0;return{x:.5*(M/Math.PI+.5),y:1-.5*(k/Math.PI+1),z:0}}unproject(o,l){let p=o=(2*o-.5)*Math.PI,y=l=(2*(1-l)-1)*Math.PI,w=25;const E=1e-6;let M=0,k=0;do{const F=Math.cos(y),U=Math.sin(y),z=2*U*F,Z=U*U,te=F*F,ie=Math.cos(p/2),K=Math.sin(p/2),pe=2*ie*K,Ee=K*K,xe=1-te*ie*ie,we=xe?1/xe:0,Ce=xe?Math.acos(F*ie)*Math.sqrt(1/xe):0,Le=.5*(2*Ce*F*K+2*p/Math.PI)-o,ke=.5*(Ce*U+y)-l,st=.5*we*(te*Ee+Ce*F*ie*Z)+1/Math.PI,rt=we*(pe*z/4-Ce*U*K),bt=.125*we*(z*K-Ce*U*te*pe),Gt=.5*we*(Z*ie+Ce*Ee*F)+.5,ht=rt*bt-Gt*st;M=(ke*rt-Le*Gt)/ht,k=(Le*bt-ke*st)/ht,p=Bt(p-M,-Math.PI,Math.PI),y=Bt(y-k,-h0,h0)}while((Math.abs(M)>E||Math.abs(k)>E)&&--w>0);return new tr(Pt(p),Pt(y))}}class ym extends Ro{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ct(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){const{scale:p,cosPhi:y}=this;return{x:Ct(o)*y*p+.5,y:-Math.sin(Ct(l))/y*p+.5,z:0}}unproject(o,l){const{scale:p,cosPhi:y}=this,w=-(l-.5)/p,E=Bt(Pt((o-.5)/p)/y,-180,180),M=Math.asin(Bt(w*y,-1,1)),k=Bt(Pt(M),-Eo,Eo);return new tr(E,k)}}class f0 extends Zd{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,l,p){const y=Jm(o,l,p);return mo(y,y,Qp(Vl(p))),{x:y[0],y:y[1],z:y[2]}}locationPoint(o,l){const p=Qu(l.lat,l.lng),y=_a([],p),w=o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(l),o._centerAltitude):o._centerAltitude;Qm(p,p,y,Ul(1,0)*Qn*w);const E=_c(new Float64Array(16));return Ld(E,o.pixelMatrix,o.globeMatrix),mo(p,p,E),new Ye(p[0],p[1])}pixelsPerMeter(o,l){return Ul(1,0)*l}pixelSpaceConversion(o,l,p){const y=Ul(1,o)*l,w=di(Ul(1,45)*l,y,p);return this.pixelsPerMeter(o,l)/w}createTileMatrix(o,l,p){const y=Lv(Vl(p.canonical));return Ld(new Float64Array(16),o.globeMatrix,y)}createInversionMatrix(o,l){const{center:p}=o,y=Qp(Vl(l));return $p(y,y,Ct(p.lng)),Nd(y,y,Ct(p.lat)),yc(y,y,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(y)}pointCoordinate(o,l,p,y){return Xu(o,l,p,!0)||new Ff(0,0)}pointCoordinate3D(o,l,p){const y=this.pointCoordinate(o,l,p,0);return[y.x,y.y,y.z]}isPointAboveHorizon(o,l){return!Xu(o,l.x,l.y,!1)}farthestPixelDistance(o){const l=function(y,w){const E=y.cameraToCenterDistance,M=y._centerAltitude*w,k=y._camera,F=y._camera.forward(),U=Ba([],Hs([],F,-E),[0,0,M]),z=y.worldSize/(2*Math.PI),Z=[0,0,-z],te=y.width/y.height,ie=Math.tan(y.fovAboveCenter),K=Hs([],k.up(),ie),pe=Hs([],k.right(),ie*te),Ee=_a([],Ba([],Ba([],F,K),pe)),xe=[];let we;if(new Fv(U,Ee).closestPointOnSphere(Z,z,xe)){const Ce=Ba([],xe,Z),Le=al([],Ce,U);we=Math.cos(y.fovAboveCenter)*sl(Le)}else{const Ce=al([],U,Z),Le=al([],Z,U);_a(Le,Le);const ke=sl(Ce)-z;we=Math.sqrt(ke*(ke+2*z));const st=Math.acos(we/(z+ke))-Math.acos(su(F,Le));we*=Math.cos(st)}return 1.01*we}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),p=Jp(o.zoom);if(p>0){const y=Sg(o,Ul(1,o.center.lat)*o.worldSize),w=o.worldSize/(2*Math.PI),E=Math.max(o.width,o.height)/o.worldSize*Math.PI;return di(l,y+w*(1-Math.cos(E)),Math.pow(p,10))}return l}upVector(o,l,p){return Jm(l,p,o,1)}upVectorScale(o){return{metersToTile:bc(L_(Vl(o)))}}}function by(a){const o=a.parallels,l=!!o&&Math.abs(o[0]+o[1])<.01;switch(a.name){case"mercator":return new Zd(a);case"equirectangular":return new Ag(a);case"naturalEarth":return new sC(a);case"equalEarth":return new Dg(a);case"winkelTripel":return new _m(a);case"albers":return l?new ym(a):new Xf(a);case"lambertConformalConic":return l?new ym(a):new Qf(a);case"globe":return new f0(a)}throw new Error(`Invalid projection name: ${a.name}`)}const vm=Gf.types,aC=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Pg(a,o,l,p,y,w,E,M,k,F,U,z,Z){const te=M?Math.min(Ic,Math.round(M[0])):0,ie=M?Math.min(Ic,Math.round(M[1])):0;a.emplaceBack(o,l,Math.round(32*p),Math.round(32*y),w,E,(te<<1)+(k?1:0),ie,16*F,16*U,256*z,256*Z)}function Og(a,o,l,p,y,w,E){a.emplaceBack(o,l,p,y,w,E)}function p0(a,o,l,p,y){a.emplaceBack(o,l,p,y),a.emplaceBack(o,l,p,y),a.emplaceBack(o,l,p,y),a.emplaceBack(o,l,p,y)}function lC(a){for(const o of a.sections)if(oe(o.text))return!0;return!1}class Wx{constructor(o){this.layoutVertexArray=new Fa,this.indexArray=new ho,this.programConfigurations=o,this.segments=new Zr,this.dynamicLayoutVertexArray=new vi,this.opacityVertexArray=new ar,this.placedSymbolArray=new Bp,this.globeExtVertexArray=new Er}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(o,l,p,y){this.isEmpty()||(p&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,gg.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,iy.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,aC,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,t0.members,!0)),this.opacityVertexBuffer.itemSize=1),(p||y)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}mn(Wx,"SymbolBuffers");class m0{constructor(o,l,p){this.layoutVertexArray=new o,this.layoutAttributes=l,this.indexArray=new p,this.segments=new Zr,this.collisionVertexArray=new Li,this.collisionVertexArrayExt=new xs}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,n0.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,ry.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}mn(m0,"CollisionBuffers");class ad{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(E=>E.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=_c([]),this.placementViewportMatrix=_c([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=r0(this.zoom,l["text-size"]),this.iconSizeData=r0(this.zoom,l["icon-size"]);const p=this.layers[0].layout,y=p.get("symbol-sort-key"),w=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==w&&void 0!==y.constantOr(1),this.sortFeaturesByY=("viewport-y"===w||"auto"===w&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(E=>dl[E]),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=o.sourceID,this.projection=o.projection}createArrays(){this.text=new Wx(new mc(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new Wx(new mc(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new qu,this.lineVertexArray=new Sh,this.symbolInstances=new fs}calculateGlyphDependencies(o,l,p,y,w){for(let E=0;E<o.length;E++)if(l[o.charCodeAt(E)]=!0,y&&w){const M=$l[o.charAt(E)];M&&(l[M.charCodeAt(0)]=!0)}}populate(o,l,p,y){const w=this.layers[0],E=w.layout,M="globe"===this.projection.name,k=E.get("text-font"),F=E.get("text-field"),U=E.get("icon-image"),z=("constant"!==F.value.kind||F.value.value instanceof xo&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&("constant"!==k.value.kind||k.value.value.length>0),Z="constant"!==U.value.kind||!!U.value.value||Object.keys(U.parameters).length>0,te=E.get("symbol-sort-key");if(this.features=[],!z&&!Z)return;const ie=l.iconDependencies,K=l.glyphDependencies,pe=l.availableImages,Ee=new Ze(this.zoom);for(const{feature:xe,id:we,index:Ce,sourceLayerIndex:Le}of o){const ke=w._featureFilter.needGeometry,st=Nf(xe,ke);if(!w._featureFilter.filter(Ee,st,p))continue;if(ke||(st.geometry=au(xe,p,y)),M&&1!==xe.type&&p.z<=5){const ht=st.geometry,Tt=.98078528056,xt=(kt,At)=>su(Jm(kt.x,kt.y,p,1),Jm(At.x,At.y,p,1))<Tt;for(let kt=0;kt<ht.length;kt++)ht[kt]=ax(ht[kt],xt)}let rt,bt;if(z){const ht=w.getValueAndResolveTokens("text-field",st,p,pe),Tt=xo.factory(ht);lC(Tt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Fe()||this.hasRTLText&&Ue.isParsed())&&(rt=Px(Tt,w,st))}if(Z){const ht=w.getValueAndResolveTokens("icon-image",st,p,pe);bt=ht instanceof Cr?ht:Cr.fromString(ht)}if(!rt&&!bt)continue;const Gt=this.sortFeaturesByKey?te.evaluate(st,{},p):void 0;if(this.features.push({id:we,text:rt,icon:bt,index:Ce,sourceLayerIndex:Le,geometry:st.geometry,properties:xe.properties,type:vm[xe.type],sortKey:Gt}),bt&&(ie[bt.name]=!0),rt){const ht=k.evaluate(st,{},p).join(","),Tt="map"===E.get("text-rotation-alignment")&&"point"!==E.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(dl.vertical)>=0;for(const xt of rt.sections)if(xt.image)ie[xt.image.name]=!0;else{const kt=S(rt.toString()),At=xt.fontStack||ht,ct=K[At]=K[At]||{};this.calculateGlyphDependencies(xt.text,ct,Tt,this.allowVerticalPlacement,kt)}}}"line"===E.get("symbol-placement")&&(this.features=function(xe){const we={},Ce={},Le=[];let ke=0;function st(ht){Le.push(xe[ht]),ke++}function rt(ht,Tt,xt){const kt=Ce[ht];return delete Ce[ht],Ce[Tt]=kt,Le[kt].geometry[0].pop(),Le[kt].geometry[0]=Le[kt].geometry[0].concat(xt[0]),kt}function bt(ht,Tt,xt){const kt=we[Tt];return delete we[Tt],we[ht]=kt,Le[kt].geometry[0].shift(),Le[kt].geometry[0]=xt[0].concat(Le[kt].geometry[0]),kt}function Gt(ht,Tt,xt){const kt=xt?Tt[0][Tt[0].length-1]:Tt[0][0];return`${ht}:${kt.x}:${kt.y}`}for(let ht=0;ht<xe.length;ht++){const Tt=xe[ht],xt=Tt.geometry,kt=Tt.text?Tt.text.toString():null;if(!kt){st(ht);continue}const At=Gt(kt,xt),ct=Gt(kt,xt,!0);if(At in Ce&&ct in we&&Ce[At]!==we[ct]){const ln=bt(At,ct,xt),Wn=rt(At,ct,Le[ln].geometry);delete we[At],delete Ce[ct],Ce[Gt(kt,Le[Wn].geometry,!0)]=Wn,Le[ln].geometry=null}else At in Ce?rt(At,ct,xt):ct in we?bt(At,ct,xt):(st(ht),we[At]=ke-1,Ce[ct]=ke-1)}return Le.filter(ht=>ht.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((xe,we)=>xe.sortKey-we.sortKey)}update(o,l,p,y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,l,this.layers,p,y),this.icon.programConfigurations.updatePaintArrays(o,l,this.layers,p,y))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=by(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,l){const p=this.lineVertexArray.length;if(void 0!==o.segment)for(const{x:y,y:w}of l)this.lineVertexArray.emplaceBack(y,w);return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(o,l,p,y,w,E,M,k,F,U,z,Z,te,ie){const K=o.indexArray,pe=o.layoutVertexArray,Ee=o.globeExtVertexArray,xe=o.segments.prepareSegment(4*l.length,pe,K,this.canOverlap?E.sortKey:void 0),we=this.glyphOffsetArray.length,Ce=xe.vertexLength,Le=this.allowVerticalPlacement&&M===dl.vertical?Math.PI/2:0,ke=E.text&&E.text.sections;for(let rt=0;rt<l.length;rt++){const{tl:bt,tr:Gt,bl:ht,br:Tt,tex:xt,pixelOffsetTL:kt,pixelOffsetBR:At,minFontScaleX:ct,minFontScaleY:ln,glyphOffset:Wn,isSDF:fn,sectionIndex:An}=l[rt],Wt=xe.vertexLength,ti=Wn[1];if(Pg(pe,F.x,F.y,bt.x,ti+bt.y,xt.x,xt.y,p,fn,kt.x,kt.y,ct,ln),Pg(pe,F.x,F.y,Gt.x,ti+Gt.y,xt.x+xt.w,xt.y,p,fn,At.x,kt.y,ct,ln),Pg(pe,F.x,F.y,ht.x,ti+ht.y,xt.x,xt.y+xt.h,p,fn,kt.x,At.y,ct,ln),Pg(pe,F.x,F.y,Tt.x,ti+Tt.y,xt.x+xt.w,xt.y+xt.h,p,fn,At.x,At.y,ct,ln),k){const{x:Di,y:Ri,z:Ai}=k.anchor,[Jn,Gi,hi]=k.up;Og(Ee,Di,Ri,Ai,Jn,Gi,hi),Og(Ee,Di,Ri,Ai,Jn,Gi,hi),Og(Ee,Di,Ri,Ai,Jn,Gi,hi),Og(Ee,Di,Ri,Ai,Jn,Gi,hi),p0(o.dynamicLayoutVertexArray,Di,Ri,Ai,Le)}else p0(o.dynamicLayoutVertexArray,F.x,F.y,F.z,Le);K.emplaceBack(Wt,Wt+1,Wt+2),K.emplaceBack(Wt+1,Wt+2,Wt+3),xe.vertexLength+=4,xe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Wn[0]),rt!==l.length-1&&An===l[rt+1].sectionIndex||o.programConfigurations.populatePaintArrays(pe.length,E,E.index,{},te,ie,ke&&ke[An])}const st=k?k.anchor:F;o.placedSymbolArray.emplaceBack(st.x,st.y,st.z,F.x,F.y,we,this.glyphOffsetArray.length-we,Ce,U,z,F.segment,p?p[0]:0,p?p[1]:0,y[0],y[1],M,0,!1,0,Z,0)}_commitLayoutVertex(o,l,p,y,w,E,M){o.emplaceBack(l,p,y,w,E,Math.round(M.x),Math.round(M.y))}_addCollisionDebugVertices(o,l,p,y,w,E,M){const k=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),F=k.vertexLength,U=M.tileAnchorX,z=M.tileAnchorY;for(let te=0;te<4;te++)p.collisionVertexArray.emplaceBack(0,0,0,0);p.collisionVertexArrayExt.emplaceBack(l,-o.padding,-o.padding),p.collisionVertexArrayExt.emplaceBack(l,o.padding,-o.padding),p.collisionVertexArrayExt.emplaceBack(l,o.padding,o.padding),p.collisionVertexArrayExt.emplaceBack(l,-o.padding,o.padding),this._commitLayoutVertex(p.layoutVertexArray,y,w,E,U,z,new Ye(o.x1,o.y1)),this._commitLayoutVertex(p.layoutVertexArray,y,w,E,U,z,new Ye(o.x2,o.y1)),this._commitLayoutVertex(p.layoutVertexArray,y,w,E,U,z,new Ye(o.x2,o.y2)),this._commitLayoutVertex(p.layoutVertexArray,y,w,E,U,z,new Ye(o.x1,o.y2)),k.vertexLength+=4;const Z=p.indexArray;Z.emplaceBack(F,F+1),Z.emplaceBack(F+1,F+2),Z.emplaceBack(F+2,F+3),Z.emplaceBack(F+3,F),k.primitiveLength+=4}_addTextDebugCollisionBoxes(o,l,p,y,w,E){for(let M=y;M<w;M++){const k=p.get(M),F=this.getSymbolInstanceTextSize(o,E,l,M);this._addCollisionDebugVertices(k,F,this.textCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,E)}}_addIconDebugCollisionBoxes(o,l,p,y,w,E){for(let M=y;M<w;M++){const k=p.get(M),F=this.getSymbolInstanceIconSize(o,l,E.placedIconSymbolIndex);this._addCollisionDebugVertices(k,F,this.iconCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,E)}}generateCollisionDebugBuffers(o,l){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new m0(Fr,id.members,Ll),this.iconCollisionBox=new m0(Fr,id.members,Ll);const p=Hf(this.iconSizeData,o),y=Hf(this.textSizeData,o);for(let w=0;w<this.symbolInstances.length;w++){const E=this.symbolInstances.get(w);this._addTextDebugCollisionBoxes(y,o,l,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(y,o,l,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(p,o,l,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(p,o,l,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(o,l,p,y){const w=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:y),E=oy(this.textSizeData,o,w)/Fs;return this.tilePixelRatio*E}getSymbolInstanceIconSize(o,l,p){const y=this.icon.placedSymbolArray.get(p),w=oy(this.iconSizeData,o,y);return this.tilePixelRatio*w}_commitDebugCollisionVertexUpdate(o,l,p){o.emplaceBack(l,-p,-p),o.emplaceBack(l,p,-p),o.emplaceBack(l,p,p),o.emplaceBack(l,-p,p)}_updateTextDebugCollisionBoxes(o,l,p,y,w,E){for(let M=y;M<w;M++){const k=p.get(M),F=this.getSymbolInstanceTextSize(o,E,l,M);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,F,k.padding)}}_updateIconDebugCollisionBoxes(o,l,p,y,w,E){for(let M=y;M<w;M++){const k=p.get(M),F=this.getSymbolInstanceIconSize(o,l,E);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,F,k.padding)}}updateCollisionDebugBuffers(o,l){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const p=Hf(this.iconSizeData,o),y=Hf(this.textSizeData,o);for(let w=0;w<this.symbolInstances.length;w++){const E=this.symbolInstances.get(w);this._updateTextDebugCollisionBoxes(y,o,l,E.textBoxStartIndex,E.textBoxEndIndex,E),this._updateTextDebugCollisionBoxes(y,o,l,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._updateIconDebugCollisionBoxes(p,o,l,E.iconBoxStartIndex,E.iconBoxEndIndex,E.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(p,o,l,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,l,p,y,w,E,M,k,F){const U={};if(l<p){const{x1:z,y1:Z,x2:te,y2:ie,padding:K,projectedAnchorX:pe,projectedAnchorY:Ee,projectedAnchorZ:xe,tileAnchorX:we,tileAnchorY:Ce,featureIndex:Le}=o.get(l);U.textBox={x1:z,y1:Z,x2:te,y2:ie,padding:K,projectedAnchorX:pe,projectedAnchorY:Ee,projectedAnchorZ:xe,tileAnchorX:we,tileAnchorY:Ce},U.textFeatureIndex=Le}if(y<w){const{x1:z,y1:Z,x2:te,y2:ie,padding:K,projectedAnchorX:pe,projectedAnchorY:Ee,projectedAnchorZ:xe,tileAnchorX:we,tileAnchorY:Ce,featureIndex:Le}=o.get(y);U.verticalTextBox={x1:z,y1:Z,x2:te,y2:ie,padding:K,projectedAnchorX:pe,projectedAnchorY:Ee,projectedAnchorZ:xe,tileAnchorX:we,tileAnchorY:Ce},U.verticalTextFeatureIndex=Le}if(E<M){const{x1:z,y1:Z,x2:te,y2:ie,padding:K,projectedAnchorX:pe,projectedAnchorY:Ee,projectedAnchorZ:xe,tileAnchorX:we,tileAnchorY:Ce,featureIndex:Le}=o.get(E);U.iconBox={x1:z,y1:Z,x2:te,y2:ie,padding:K,projectedAnchorX:pe,projectedAnchorY:Ee,projectedAnchorZ:xe,tileAnchorX:we,tileAnchorY:Ce},U.iconFeatureIndex=Le}if(k<F){const{x1:z,y1:Z,x2:te,y2:ie,padding:K,projectedAnchorX:pe,projectedAnchorY:Ee,projectedAnchorZ:xe,tileAnchorX:we,tileAnchorY:Ce,featureIndex:Le}=o.get(k);U.verticalIconBox={x1:z,y1:Z,x2:te,y2:ie,padding:K,projectedAnchorX:pe,projectedAnchorY:Ee,projectedAnchorZ:xe,tileAnchorX:we,tileAnchorY:Ce},U.verticalIconFeatureIndex=Le}return U}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const p=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,l){const p=o.placedSymbolArray.get(l),y=p.vertexStartIndex+4*p.numGlyphs;for(let w=p.vertexStartIndex;w<y;w+=4)o.indexArray.emplaceBack(w,w+1,w+2),o.indexArray.emplaceBack(w+1,w+2,w+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const l=Math.sin(o),p=Math.cos(o),y=[],w=[],E=[];for(let M=0;M<this.symbolInstances.length;++M){E.push(M);const k=this.symbolInstances.get(M);y.push(0|Math.round(l*k.tileAnchorX+p*k.tileAnchorY)),w.push(k.featureIndex)}return E.sort((M,k)=>y[M]-y[k]||w[k]-w[M]),E}addToSortKeyRanges(o,l){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===l?p.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const p=this.symbolInstances.get(l);this.featureSortOrder.push(p.featureIndex);const{rightJustifiedTextSymbolIndex:y,centerJustifiedTextSymbolIndex:w,leftJustifiedTextSymbolIndex:E,verticalPlacedTextSymbolIndex:M,placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:F}=p;y>=0&&this.addIndicesForPlacedSymbol(this.text,y),w>=0&&w!==y&&this.addIndicesForPlacedSymbol(this.text,w),E>=0&&E!==w&&E!==y&&this.addIndicesForPlacedSymbol(this.text,E),M>=0&&this.addIndicesForPlacedSymbol(this.text,M),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k),F>=0&&this.addIndicesForPlacedSymbol(this.icon,F)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}mn(ad,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),ad.MAX_GLYPHS=65535,ad.addDynamicAttributes=p0;const xy=new Lt({"symbol-placement":new qe(ut.layout_symbol["symbol-placement"]),"symbol-spacing":new qe(ut.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new qe(ut.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Xe(ut.layout_symbol["symbol-sort-key"]),"symbol-z-order":new qe(ut.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new qe(ut.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new qe(ut.layout_symbol["icon-ignore-placement"]),"icon-optional":new qe(ut.layout_symbol["icon-optional"]),"icon-rotation-alignment":new qe(ut.layout_symbol["icon-rotation-alignment"]),"icon-size":new Xe(ut.layout_symbol["icon-size"]),"icon-text-fit":new qe(ut.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new qe(ut.layout_symbol["icon-text-fit-padding"]),"icon-image":new Xe(ut.layout_symbol["icon-image"]),"icon-rotate":new Xe(ut.layout_symbol["icon-rotate"]),"icon-padding":new qe(ut.layout_symbol["icon-padding"]),"icon-keep-upright":new qe(ut.layout_symbol["icon-keep-upright"]),"icon-offset":new Xe(ut.layout_symbol["icon-offset"]),"icon-anchor":new Xe(ut.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new qe(ut.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new qe(ut.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new qe(ut.layout_symbol["text-rotation-alignment"]),"text-field":new Xe(ut.layout_symbol["text-field"]),"text-font":new Xe(ut.layout_symbol["text-font"]),"text-size":new Xe(ut.layout_symbol["text-size"]),"text-max-width":new Xe(ut.layout_symbol["text-max-width"]),"text-line-height":new Xe(ut.layout_symbol["text-line-height"]),"text-letter-spacing":new Xe(ut.layout_symbol["text-letter-spacing"]),"text-justify":new Xe(ut.layout_symbol["text-justify"]),"text-radial-offset":new Xe(ut.layout_symbol["text-radial-offset"]),"text-variable-anchor":new qe(ut.layout_symbol["text-variable-anchor"]),"text-anchor":new Xe(ut.layout_symbol["text-anchor"]),"text-max-angle":new qe(ut.layout_symbol["text-max-angle"]),"text-writing-mode":new qe(ut.layout_symbol["text-writing-mode"]),"text-rotate":new Xe(ut.layout_symbol["text-rotate"]),"text-padding":new qe(ut.layout_symbol["text-padding"]),"text-keep-upright":new qe(ut.layout_symbol["text-keep-upright"]),"text-transform":new Xe(ut.layout_symbol["text-transform"]),"text-offset":new Xe(ut.layout_symbol["text-offset"]),"text-allow-overlap":new qe(ut.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new qe(ut.layout_symbol["text-ignore-placement"]),"text-optional":new qe(ut.layout_symbol["text-optional"])});var g0={paint:new Lt({"icon-opacity":new Xe(ut.paint_symbol["icon-opacity"]),"icon-color":new Xe(ut.paint_symbol["icon-color"]),"icon-halo-color":new Xe(ut.paint_symbol["icon-halo-color"]),"icon-halo-width":new Xe(ut.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Xe(ut.paint_symbol["icon-halo-blur"]),"icon-translate":new qe(ut.paint_symbol["icon-translate"]),"icon-translate-anchor":new qe(ut.paint_symbol["icon-translate-anchor"]),"text-opacity":new Xe(ut.paint_symbol["text-opacity"]),"text-color":new Xe(ut.paint_symbol["text-color"],{runtimeType:ur,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Xe(ut.paint_symbol["text-halo-color"]),"text-halo-width":new Xe(ut.paint_symbol["text-halo-width"]),"text-halo-blur":new Xe(ut.paint_symbol["text-halo-blur"]),"text-translate":new qe(ut.paint_symbol["text-translate"]),"text-translate-anchor":new qe(ut.paint_symbol["text-translate-anchor"])}),layout:xy};class bm{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:Ti,this.defaultValue=o}evaluate(o){if(o.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(o.formattedSection))return l.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}mn(bm,"FormatSectionOverride",{omit:["defaultValue"]});class Wh extends Na{constructor(o){super(o,g0)}recalculate(o,l){super.recalculate(o,l),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const y=[];for(const w of p)y.indexOf(w)<0&&y.push(w);this.layout._values["text-writing-mode"]=y}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(o,l,p,y){const w=this.layout.get(o).evaluate(l,{},p,y),E=this._unevaluatedLayout._values[o];return E.isDataDriven()||fh(E.value)||!w?w:(M=l.properties,w.replace(/{([^{}]+)}/g,(F,U)=>U in M?String(M[U]):""));var M}createBucket(o){return new ad(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of g0.paint.overridableProperties){if(!Wh.hasPaintOverride(this.layout,o))continue;const l=this.paint.get(o),p=new bm(l),y=new Sd(p,l.property.specification);let w=null;w="constant"===l.value.kind||"source"===l.value.kind?new kp("source",y):new Ol("composite",y,l.value.zoomStops,l.value._interpolationType),this.paint._values[o]=new Ot(l.property,w,l.parameters)}}_handleOverridablePaintPropertyUpdate(o,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&Wh.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,l){const p=o.get("text-field"),y=g0.paint.properties[l];let w=!1;const E=M=>{for(const k of M)if(y.overrides&&y.overrides.hasOverride(k))return void(w=!0)};if("constant"===p.value.kind&&p.value.value instanceof xo)E(p.value.value.sections);else if("source"===p.value.kind){const M=F=>{w||(F instanceof js&&Ji(F.value)===Cl?E(F.value.sections):F instanceof Tl?E(F.sections):F.eachChild(M))},k=p.value;k._styleExpression&&M(k._styleExpression.expression)}return w}getProgramConfiguration(o){return new ou(this,o)}}var kg={paint:new Lt({"background-color":new qe(ut.paint_background["background-color"]),"background-pattern":new qe(ut.paint_background["background-pattern"]),"background-opacity":new qe(ut.paint_background["background-opacity"])})},cC={paint:new Lt({"raster-opacity":new qe(ut.paint_raster["raster-opacity"]),"raster-hue-rotate":new qe(ut.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new qe(ut.paint_raster["raster-brightness-min"]),"raster-brightness-max":new qe(ut.paint_raster["raster-brightness-max"]),"raster-saturation":new qe(ut.paint_raster["raster-saturation"]),"raster-contrast":new qe(ut.paint_raster["raster-contrast"]),"raster-resampling":new qe(ut.paint_raster["raster-resampling"]),"raster-fade-duration":new qe(ut.paint_raster["raster-fade-duration"])})};class Rg extends Na{constructor(o){super(o,{}),this.implementation=o}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}var wy={paint:new Lt({"sky-type":new qe(ut.paint_sky["sky-type"]),"sky-atmosphere-sun":new qe(ut.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new qe(ut.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new qe(ut.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new qe(ut.paint_sky["sky-gradient-radius"]),"sky-gradient":new Mt(ut.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new qe(ut.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new qe(ut.paint_sky["sky-atmosphere-color"]),"sky-opacity":new qe(ut.paint_sky["sky-opacity"])})};function Cy(a,o,l){const p=[0,0,1],y=ix([]);return O_(y,y,l?-Ct(a)+Math.PI:Ct(a)),Ov(y,y,-Ct(o)),tx(p,p,y),_a(p,p)}const _0={circle:class extends Na{constructor(a){super(a,jv)}createBucket(a){return new tm(a)}queryRadius(a){const o=a;return zf("circle-radius",this,o)+zf("circle-stroke-width",this,o)+cu(this.paint.get("circle-translate"))}queryIntersectsFeature(a,o,l,p,y,w,E,M){const k=$_(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),w.angle,a.pixelToTileUnitsFactor),F=this.paint.get("circle-radius").evaluate(o,l)+this.paint.get("circle-stroke-width").evaluate(o,l);return ux(a,p,w,E,M,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),k,F)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new ou(this,a)}},heatmap:class extends Na{createBucket(a){return new $v(a)}constructor(a){super(a,fx),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"heatmap-color"===a&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Gv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return zf("heatmap-radius",this,a)}queryIntersectsFeature(a,o,l,p,y,w,E,M){const k=this.paint.get("heatmap-radius").evaluate(o,l);return ux(a,p,w,E,M,!0,!0,new Ye(0,0),k)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new ou(this,a)}},hillshade:class extends Na{constructor(a){super(a,N1)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Na{constructor(a){super(a,Y_)}getProgramIds(){const a=this.paint.get("fill-pattern"),o=a&&a.constantOr(1),l=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getProgramConfiguration(a){return new ou(this,a)}recalculate(a,o){super.recalculate(a,o);const l=this.paint._values["fill-outline-color"];"constant"===l.value.kind&&void 0===l.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new Z_(a)}queryRadius(){return cu(this.paint.get("fill-translate"))}queryIntersectsFeature(a,o,l,p,y,w){return!a.queryGeometry.isAboveHorizon&&U_(Uv(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),w.angle,a.pixelToTileUnitsFactor),p)}isTileClipped(){return!0}},"fill-extrusion":class extends Na{constructor(a){super(a,Tx)}createBucket(a){return new lm(a)}queryRadius(){return cu(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new ou(this,a)}queryIntersectsFeature(a,o,l,p,y,w,E,M,k){const F=$_(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),w.angle,a.pixelToTileUnitsFactor),U=this.paint.get("fill-extrusion-height").evaluate(o,l),z=this.paint.get("fill-extrusion-base").evaluate(o,l),Z=[0,0],te=M&&w.elevation,ie=w.elevation?w.elevation.exaggeration():1,K=a.tile.getBucket(this);if(te&&K instanceof lm){const Ce=K.centroidVertexArray,Le=k+1;Le<Ce.length&&(Z[0]=Ce.geta_centroid_pos0(Le),Z[1]=Ce.geta_centroid_pos1(Le))}if(0===Z[0]&&1===Z[1])return!1;"globe"===w.projection.name&&(p=Ex([p],[new Ye(0,0),new Ye(Qn,Qn)],a.tileID.canonical).map(Ce=>Ce.polygon).flat());const pe=te?M:null,[Ee,xe]=(Le=p,ke=z,st=U,rt=F,bt=E,Gt=pe,ht=Z,Tt=ie,xt=w.center.lat,"globe"===(Ce=w).projection.name?function(At,ct,ln,Wn,fn,An,Wt,ti,Di,Ri,Ai){const Jn=[],Gi=[],hi=At.projection.upVectorScale(Ai,At.center.lat,At.worldSize).metersToTile,Vi=[0,0,0,1],Tr=[0,0,0,1],yr=(Ar,Br,To,ws)=>{Ar[0]=Br,Ar[1]=To,Ar[2]=ws,Ar[3]=1},Dr=Jv();ln>0&&(ln+=Dr),Wn+=Dr;for(const Ar of ct){const Br=[],To=[];for(const ws of Ar){const mr=ws.x+fn.x,Fo=ws.y+fn.y,Io=At.projection.projectTilePoint(mr,Fo,Ai),nr=At.projection.upVector(Ai,ws.x,ws.y);let Yr=ln,es=Wn;if(Wt){const _r=ty(mr,Fo,ln,Wn,Wt,ti,Di,Ri);Yr+=_r.base,es+=_r.top}0!==ln?yr(Vi,Io.x+nr[0]*hi*Yr,Io.y+nr[1]*hi*Yr,Io.z+nr[2]*hi*Yr):yr(Vi,Io.x,Io.y,Io.z),yr(Tr,Io.x+nr[0]*hi*es,Io.y+nr[1]*hi*es,Io.z+nr[2]*hi*es),mo(Vi,Vi,An),mo(Tr,Tr,An),Br.push(new um(Vi[0],Vi[1],Vi[2])),To.push(new um(Tr[0],Tr[1],Tr[2]))}Jn.push(Br),Gi.push(To)}return[Jn,Gi]}(Ce,Le,ke,st,rt,bt,Gt,ht,Tt,xt,a.tileID.canonical):Gt?function(At,ct,ln,Wn,fn,An,Wt,ti,Di){const Ri=[],Ai=[],Jn=[0,0,0,1];for(const Gi of At){const hi=[],Vi=[];for(const Tr of Gi){const yr=Tr.x+Wn.x,Dr=Tr.y+Wn.y,Ar=ty(yr,Dr,ct,ln,An,Wt,ti,Di);Jn[0]=yr,Jn[1]=Dr,Jn[2]=Ar.base,Jn[3]=1,zl(Jn,Jn,fn),Jn[3]=Math.max(Jn[3],1e-5);const Br=new um(Jn[0]/Jn[3],Jn[1]/Jn[3],Jn[2]/Jn[3]);Jn[0]=yr,Jn[1]=Dr,Jn[2]=Ar.top,Jn[3]=1,zl(Jn,Jn,fn),Jn[3]=Math.max(Jn[3],1e-5);const To=new um(Jn[0]/Jn[3],Jn[1]/Jn[3],Jn[2]/Jn[3]);hi.push(Br),Vi.push(To)}Ri.push(hi),Ai.push(Vi)}return[Ri,Ai]}(Le,ke,st,rt,bt,Gt,ht,Tt,xt):function(At,ct,ln,Wn,fn){const An=[],Wt=[],ti=fn[8]*ct,Di=fn[9]*ct,Ri=fn[10]*ct,Ai=fn[11]*ct,Jn=fn[8]*ln,Gi=fn[9]*ln,hi=fn[10]*ln,Vi=fn[11]*ln;for(const Tr of At){const yr=[],Dr=[];for(const Ar of Tr){const Br=Ar.x+Wn.x,To=Ar.y+Wn.y,ws=fn[0]*Br+fn[4]*To+fn[12],mr=fn[1]*Br+fn[5]*To+fn[13],Fo=fn[2]*Br+fn[6]*To+fn[14],Io=fn[3]*Br+fn[7]*To+fn[15],nr=ws+ti,Yr=mr+Di,es=Fo+Ri,_r=Math.max(Io+Ai,1e-5),go=ws+Jn,qs=mr+Gi,Lo=Fo+hi,Cs=Math.max(Io+Vi,1e-5);yr.push(new um(nr/_r,Yr/_r,es/_r)),Dr.push(new um(go/Cs,qs/Cs,Lo/Cs))}An.push(yr),Wt.push(Dr)}return[An,Wt]}(Le,ke,st,rt,bt)),we=a.queryGeometry;var Ce,Le,ke,st,rt,bt,Gt,ht,Tt,xt;return function(Ce,Le,ke){let st=1/0;U_(ke,Le)&&(st=Q1(ke,Le[0]));for(let rt=0;rt<Le.length;rt++){const bt=Le[rt],Gt=Ce[rt];for(let ht=0;ht<bt.length-1;ht++){const Tt=bt[ht],xt=[Tt,bt[ht+1],Gt[ht+1],Gt[ht],Tt];lu(ke,xt)&&(st=Math.min(st,Q1(ke,xt)))}}return st!==1/0&&st}(Ee,xe,we.isPointQuery()?we.screenBounds:we.screenGeometry)}},line:class extends Na{constructor(a){super(a,ny),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if("line-gradient"===a){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof la,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,o){super.recalculate(a,o),this.paint._values["line-floorwidth"]=wc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new pg(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new ou(this,a)}queryRadius(a){const o=a,l=mg(zf("line-width",this,o),zf("line-gap-width",this,o)),p=zf("line-offset",this,o);return l/2+Math.abs(p)+cu(this.paint.get("line-translate"))}queryIntersectsFeature(a,o,l,p,y,w){if(a.queryGeometry.isAboveHorizon)return!1;const E=Uv(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),w.angle,a.pixelToTileUnitsFactor),M=a.pixelToTileUnitsFactor/2*mg(this.paint.get("line-width").evaluate(o,l),this.paint.get("line-gap-width").evaluate(o,l)),k=this.paint.get("line-offset").evaluate(o,l);return k&&(p=function(F,U){const z=[],Z=new Ye(0,0);for(let te=0;te<F.length;te++){const ie=F[te],K=[];for(let pe=0;pe<ie.length;pe++){const xe=ie[pe],we=ie[pe+1],Ce=0===pe?Z:xe.sub(ie[pe-1])._unit()._perp(),Le=pe===ie.length-1?Z:we.sub(xe)._unit()._perp(),ke=Ce._add(Le)._unit();ke._mult(1/(ke.x*Le.x+ke.y*Le.y)),K.push(ke._mult(U)._add(xe))}z.push(K)}return z}(p,k*a.pixelToTileUnitsFactor)),function(F,U,z){for(let Z=0;Z<U.length;Z++){const te=U[Z];if(F.length>=3)for(let ie=0;ie<te.length;ie++)if(Bd(F,te[ie]))return!0;if(j_(F,te,z))return!0}return!1}(E,p,M)}isTileClipped(){return!0}},symbol:Wh,background:class extends Na{constructor(a){super(a,kg)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Na{constructor(a){super(a,cC)}getProgramIds(){return["raster"]}},sky:class extends Na{constructor(a){super(a,wy),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"sky-gradient"===a?this._updateColorRamp():"sky-atmosphere-sun"!==a&&"sky-atmosphere-halo-color"!==a&&"sky-atmosphere-color"!==a&&"sky-atmosphere-sun-intensity"!==a||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Gv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(a,o){if("atmosphere"===this.paint.get("sky-type")){const p=this.paint.get("sky-atmosphere-sun"),y=!p,w=a.style.light,E=w.properties.get("position");return y&&"viewport"===w.properties.get("anchor")&&Pi("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),y?Cy(E.azimuthal,90-E.polar,o):Cy(p[0],90-p[1],o)}const l=this.paint.get("sky-gradient-center");return Cy(l[0],90-l[1],o)}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return"atmosphere"===a?["skyboxCapture","skybox"]:"gradient"===a?["skyboxGradient"]:null}}};class ep{constructor(o,l,p,y){this.context=o,this.format=p,this.texture=o.gl.createTexture(),this.update(l,y)}update(o,l,p){const{width:y,height:w}=o,{context:E}=this,{gl:M}=E,{HTMLImageElement:k,HTMLCanvasElement:F,HTMLVideoElement:U,ImageData:z,ImageBitmap:Z}=$e;if(M.bindTexture(M.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!l||!1!==l.premultiply)),p||this.size&&this.size[0]===y&&this.size[1]===w){const{x:te,y:ie}=p||{x:0,y:0};o instanceof k||o instanceof F||o instanceof U||o instanceof z||Z&&o instanceof Z?M.texSubImage2D(M.TEXTURE_2D,0,te,ie,M.RGBA,M.UNSIGNED_BYTE,o):M.texSubImage2D(M.TEXTURE_2D,0,te,ie,y,w,M.RGBA,M.UNSIGNED_BYTE,o.data)}else this.size=[y,w],o instanceof k||o instanceof F||o instanceof U||o instanceof z||Z&&o instanceof Z?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,o):M.texImage2D(M.TEXTURE_2D,0,this.format,y,w,0,this.format,M.UNSIGNED_BYTE,o.data);this.useMipmap=Boolean(l&&l.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&M.generateMipmap(M.TEXTURE_2D)}bind(o,l){const{context:p}=this,{gl:y}=p;y.bindTexture(y.TEXTURE_2D,this.texture),o!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,o),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,this.useMipmap?o===y.NEAREST?y.NEAREST_MIPMAP_NEAREST:y.LINEAR_MIPMAP_NEAREST:o),this.filter=o),l!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,l),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class y0{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Zx{constructor(){this.tasks={},this.taskQueue=[],Cn(["process"],this),this.invoker=new y0(this.process),this.nextId=0}add(o,l){const p=this.nextId++,y=function({type:w,isSymbolTile:E,zoom:M}){return M=M||0,"message"===w?0:"maybePrepare"!==w||E?"parseTile"!==w||E?"parseTile"===w&&E?300-M:"maybePrepare"===w&&E?400-M:500:200-M:100-M}(l);if(0===y){kr();try{o()}finally{}return{cancel:()=>{}}}return this.tasks[p]={fn:o,metadata:l,priority:y,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){kr();try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const o=this.pick();if(null===o)return;const l=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let o=null,l=1/0;for(let y=0;y<this.taskQueue.length;y++){const w=this.tasks[this.taskQueue[y]];w.priority<l&&(l=w.priority,o=y)}if(null===o)return null;const p=this.taskQueue[o];return this.taskQueue.splice(o,1),p}remove(){this.invoker.remove()}}class Fg{constructor(o){this._stringToNumber={},this._numberToString=[];for(let l=0;l<o.length;l++){const p=o[l];this._stringToNumber[p]=l,this._numberToString[l]=p}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const Ey=["tile","layer","source","sourceLayer","state"];class Yx{constructor(o,l,p,y,w){this.type="Feature",this._vectorTileFeature=o,this._z=l,this._x=p,this._y=y,this.properties=o.properties,this.id=w}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(o.id=this.id);for(const l of Ey)void 0!==this[l]&&(o[l]=this[l]);return o}}const fl=32,pu=33,pl=new Uint16Array(8184);for(let a=0;a<2046;a++){let o=a+2,l=0,p=0,y=0,w=0,E=0,M=0;for(1&o?y=w=E=fl:l=p=M=fl;(o>>=1)>1;){const F=l+y>>1,U=p+w>>1;1&o?(y=l,w=p,l=E,p=M):(l=y,p=w,y=E,w=M),E=F,M=U}const k=4*a;pl[k+0]=l,pl[k+1]=p,pl[k+2]=y,pl[k+3]=w}const mu=new Uint16Array(2178),ld=new Uint8Array(1089),Lg=new Uint16Array(1089);function Ng(a){return 0===a?-.03125:32===a?.03125:0}var zg=yn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Ty={type:2,extent:Qn,loadGeometry:()=>[[new Ye(0,0),new Ye(8193,0),new Ye(8193,8193),new Ye(0,8193),new Ye(0,0)]]};class tp{constructor(o,l,p,y,w){this.tileID=o,this.uid=Ht(),this.uses=0,this.tileSize=l,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=w,this.expiredRequestCount=0,this.state="loading",y&&y.transform&&(this.projection=y.transform.projection)}registerFadeDuration(o){const l=o+this.timeAdded;l<gi.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=xa(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,l,p){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(y,w){const E={};if(!w)return E;for(const M of y){const k=M.layerIds.map(F=>w.getLayer(F)).filter(Boolean);if(0!==k.length){M.layers=k,M.stateDependentLayerIds&&(M.stateDependentLayers=M.stateDependentLayerIds.map(F=>k.filter(U=>U.id===F)[0]));for(const F of k)E[F.id]=M}}return E}(o.buckets,l.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const w=this.buckets[y];if(w instanceof ad){if(this.hasSymbolBuckets=!0,!p)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const w=this.buckets[y];if(w instanceof ad&&w.hasRTLText){this.hasRTLText=!0,Ue.isLoading()||Ue.isLoaded()||"deferred"!==Fe()||Re();break}}this.queryPadding=0;for(const y in this.buckets){const w=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(y).queryRadius(w))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas)}else this.collisionBoxArray=new hs}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(o){return this.buckets[o.id]}upload(o){for(const p in this.buckets){const y=this.buckets[p];y.uploadPending()&&y.upload(o)}const l=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ep(o,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ep(o,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new ep(o,this.lineAtlas.image,l.ALPHA),this.lineAtlas.uploaded=!0)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,l,p,y,w,E,M,k){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:y,pixelPosMatrix:M,transform:E,params:w,tileTransform:this.tileTransform},o,l,p):{}}querySourceFeatures(o,l){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const y=p.loadVTLayers(),w=l?l.sourceLayer:"",E=y._geojsonTileLayer||y[w];if(!E)return;const M=Xc(l&&l.filter),{z:k,x:F,y:U}=this.tileID.canonical,z={z:k,x:F,y:U};for(let Z=0;Z<E.length;Z++){const te=E.feature(Z);if(M.needGeometry){const pe=Nf(te,!0);if(!M.filter(new Ze(this.tileID.overscaledZ),pe,this.tileID.canonical))continue}else if(!M.filter(new Ze(this.tileID.overscaledZ),te))continue;const ie=p.getId(te,w),K=new Yx(te,k,F,U,ie);K.tile=z,o.push(K)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const l=this.expirationTime;if(o.cacheControl){const p=oo(o.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const p=Date.now();let y=!1;if(this.expirationTime>p)y=!1;else if(l)if(this.expirationTime<l)y=!0;else{const w=this.expirationTime-l;w?this.expirationTime=p+Math.max(w,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(o,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(o).length||!l)return;const p=this.latestFeatureIndex.loadVTLayers(),y=l.style.listImages();for(const w in this.buckets){if(!l.style.hasLayer(w))continue;const E=this.buckets[w],M=E.layers[0].sourceLayer||"_geojsonTileLayer",k=p[M],F=o[M];if(!k||!F||0===Object.keys(F).length)continue;if(E.update(F,k,y,this.imageAtlas&&this.imageAtlas.patternPositions||{}),E instanceof pg||E instanceof Z_){const z=l.style._getSourceCache(E.layers[0].source);l._terrain&&l._terrain.enabled&&z&&E.programConfigurations.needsUpload&&l._terrain._clearRenderCacheForTile(z.id,this.tileID)}const U=l&&l.style&&l.style.getLayer(w);U&&(this.queryPadding=Math.max(this.queryPadding,U.queryRadius(E)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<gi.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=gi.now()+o}setTexture(o,l){const p=l.context,y=p.gl;this.texture=this.texture||l.getTileTexture(o.width),this.texture?this.texture.update(o,{useMipmap:!0}):(this.texture=new ep(p,o,y.RGBA,{useMipmap:!0}),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE),p.extTextureFilterAnisotropic&&y.texParameterf(y.TEXTURE_2D,p.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,p.extTextureFilterAnisotropicMax))}setDependencies(o,l){const p={};for(const y of l)p[y]=!0;this.dependencies[o]=p}hasDependency(o,l){for(const p of o){const y=this.dependencies[p];if(y)for(const w of l)if(y[w])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,l){if(!l||"mercator"===l.name||this._tileDebugBuffer)return;const p=au(Ty,this.tileID.canonical,this.tileTransform)[0],y=new Bn,w=new il;for(let E=0;E<p.length;E++){const{x:M,y:k}=p[E];y.emplaceBack(M,k),w.emplaceBack(E)}w.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(w),this._tileDebugBuffer=o.createVertexBuffer(y,Zp.members),this._tileDebugSegments=Zr.simpleSegment(0,0,y.length,w.length)}_makeTileBoundsBuffers(o,l){if(this._tileBoundsBuffer||!l||"mercator"===l.name)return;const p=au(Ty,this.tileID.canonical,this.tileTransform)[0];let y,w;if(this.isRaster){const E=function(M,k){const F=xa(M,k),U=Math.pow(2,M.z);for(let pe=0;pe<pu;pe++)for(let Ee=0;Ee<pu;Ee++){const xe=Va((M.x+(Ee+Ng(Ee))/fl)/U),we=Qs((M.y+(pe+Ng(pe))/fl)/U),Ce=k.project(xe,we),Le=pe*pu+Ee;mu[2*Le+0]=Math.round((Ce.x*F.scale-F.x)*Qn),mu[2*Le+1]=Math.round((Ce.y*F.scale-F.y)*Qn)}ld.fill(0),Lg.fill(0);for(let pe=2045;pe>=0;pe--){const Ee=4*pe,xe=pl[Ee+0],we=pl[Ee+1],Ce=pl[Ee+2],Le=pl[Ee+3],ke=xe+Ce>>1,st=we+Le>>1,rt=ke+st-we,bt=st+xe-ke,Gt=we*pu+xe,ht=Le*pu+Ce,Tt=st*pu+ke,xt=Math.hypot((mu[2*Gt+0]+mu[2*ht+0])/2-mu[2*Tt+0],(mu[2*Gt+1]+mu[2*ht+1])/2-mu[2*Tt+1])>=16;ld[Tt]=ld[Tt]||(xt?1:0),pe<1022&&(ld[Tt]=ld[Tt]||ld[(we+bt>>1)*pu+(xe+rt>>1)]||ld[(Le+bt>>1)*pu+(Ce+rt>>1)])}const z=new Fi,Z=new ho;let te=0;function ie(pe,Ee){const xe=Ee*pu+pe;return 0===Lg[xe]&&(z.emplaceBack(mu[2*xe+0],mu[2*xe+1],pe*Qn/fl,Ee*Qn/fl),Lg[xe]=++te),Lg[xe]-1}function K(pe,Ee,xe,we,Ce,Le){const ke=pe+xe>>1,st=Ee+we>>1;if(Math.abs(pe-Ce)+Math.abs(Ee-Le)>1&&ld[st*pu+ke])K(Ce,Le,pe,Ee,ke,st),K(xe,we,Ce,Le,ke,st);else{const rt=ie(pe,Ee),bt=ie(xe,we),Gt=ie(Ce,Le);Z.emplaceBack(rt,bt,Gt)}}return K(0,0,fl,fl,fl,0),K(fl,fl,0,0,0,fl),{vertices:z,indices:Z}}(this.tileID.canonical,l);y=E.vertices,w=E.indices}else{y=new Fi,w=new ho;for(const{x:M,y:k}of p)y.emplaceBack(M,k,0,0);const E=Uh(y.int16,void 0,4);for(let M=0;M<E.length;M+=3)w.emplaceBack(E[M],E[M+1],E[M+2])}this._tileBoundsBuffer=o.createVertexBuffer(y,zg.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(w),this._tileBoundsSegments=Zr.simpleSegment(0,0,y.length,w.length)}_makeGlobeTileDebugBuffers(o,l){const p=l.projection;if(!p||"globe"!==p.name||l.freezeTileCoverage)return;const y=this.tileID.canonical,w=Qp(ox(y,l)),E=Jp(l.zoom);let M;E>0&&(M=Xm(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,y,l,w,M,E),this._makeGlobeTileDebugTextBuffer(o,y,l,w,M,E)}_globePoint(o,l,p,y,w,E,M){let k=Jm(o,l,p);if(E){const F=1<<p.z,U=Ju(y.center.lng),z=ed(y.center.lat),Z=(p.x+.5)/F-U;let te=0;Z>.5?te=-1:Z<-.5&&(te=1);let ie=(o/Qn+p.x)/F+te,K=(l/Qn+p.y)/F;ie=(ie-U)*y._pixelsPerMercatorPixel+U,K=(K-z)*y._pixelsPerMercatorPixel+z;const pe=[ie*y.worldSize,K*y.worldSize,0];mo(pe,pe,E),k=Of(k,pe,M)}return mo(k,k,w)}_makeGlobeTileDebugBorderBuffer(o,l,p,y,w,E){const M=new Bn,k=new il,F=new er,U=(Z,te,ie,K,pe)=>{const Ee=(ie-Z)/(pe-1),xe=(K-te)/(pe-1),we=M.length;for(let Ce=0;Ce<pe;Ce++){const Le=Z+Ce*Ee,ke=te+Ce*xe;M.emplaceBack(Le,ke);const st=this._globePoint(Le,ke,l,p,y,w,E);F.emplaceBack(st[0],st[1],st[2]),k.emplaceBack(we+Ce)}},z=Qn;U(0,0,z,0,16),U(z,0,z,z,16),U(z,z,0,z,16),U(0,z,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(k),this._tileDebugBuffer=o.createVertexBuffer(M,Zp.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(F,Rv.members),this._tileDebugSegments=Zr.simpleSegment(0,0,M.length,k.length)}_makeGlobeTileDebugTextBuffer(o,l,p,y,w,E){const M=new Bn,k=new ho,F=new er,U=25;k.reserve(32),M.reserve(U),F.reserve(U);const z=(Z,te)=>U*Z+te;for(let Z=0;Z<U;Z++){const te=2048*Z;for(let ie=0;ie<U;ie++){const K=2048*ie;M.emplaceBack(K,te);const pe=this._globePoint(K,te,l,p,y,w,E);F.emplaceBack(pe[0],pe[1],pe[2])}}for(let Z=0;Z<4;Z++)for(let te=0;te<4;te++){const ie=z(Z,te),K=z(Z,te+1),pe=z(Z+1,te),Ee=z(Z+1,te+1);k.emplaceBack(ie,K,pe),k.emplaceBack(pe,K,Ee)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(k),this._tileDebugTextBuffer=o.createVertexBuffer(M,Zp.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(F,Rv.members),this._tileDebugTextSegments=Zr.simpleSegment(0,0,U,32)}}class Kx{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,l,p){const y=String(l);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][y]=this.stateChanges[o][y]||{},gt(this.stateChanges[o][y],p),null===this.deletedStates[o]){this.deletedStates[o]={};for(const w in this.state[o])w!==y&&(this.deletedStates[o][w]=null)}else if(this.deletedStates[o]&&null===this.deletedStates[o][y]){this.deletedStates[o][y]={};for(const w in this.state[o][y])p[w]||(this.deletedStates[o][y][w]=null)}else for(const w in p)this.deletedStates[o]&&this.deletedStates[o][y]&&null===this.deletedStates[o][y][w]&&delete this.deletedStates[o][y][w]}removeFeatureState(o,l,p){if(null===this.deletedStates[o])return;const y=String(l);if(this.deletedStates[o]=this.deletedStates[o]||{},p&&void 0!==l)null!==this.deletedStates[o][y]&&(this.deletedStates[o][y]=this.deletedStates[o][y]||{},this.deletedStates[o][y][p]=null);else if(void 0!==l)if(this.stateChanges[o]&&this.stateChanges[o][y])for(p in this.deletedStates[o][y]={},this.stateChanges[o][y])this.deletedStates[o][y][p]=null;else this.deletedStates[o][y]=null;else this.deletedStates[o]=null}getState(o,l){const p=String(l),y=gt({},(this.state[o]||{})[p],(this.stateChanges[o]||{})[p]);if(null===this.deletedStates[o])return{};if(this.deletedStates[o]){const w=this.deletedStates[o][l];if(null===w)return{};for(const E in w)delete y[E]}return y}initializeTileState(o,l){o.setFeatureState(this.state,l)}coalesceChanges(o,l){const p={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const w={};for(const E in this.stateChanges[y])this.state[y][E]||(this.state[y][E]={}),gt(this.state[y][E],this.stateChanges[y][E]),w[E]=this.state[y][E];p[y]=w}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const w={};if(null===this.deletedStates[y])for(const E in this.state[y])w[E]={},this.state[y][E]={};else for(const E in this.deletedStates[y]){if(null===this.deletedStates[y][E])this.state[y][E]={};else if(this.state[y][E])for(const M of Object.keys(this.deletedStates[y][E]))delete this.state[y][E][M];w[E]=this.state[y][E]}p[y]=p[y]||{},gt(p[y],w)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(p).length)for(const y in o)o[y].setFeatureState(p,l)}}class Iy{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,l){const p=this.toIdx(o,l);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(o,l){return this.leaves[this.toIdx(o,l)]}toIdx(o,l){return l*this.size+o}}function v0(a,o,l,p){let y=0,w=Number.MAX_VALUE;for(let E=0;E<3;E++)if(Math.abs(p[E])<1e-15){if(l[E]<a[E]||l[E]>o[E])return null}else{const M=1/p[E];let k=(a[E]-l[E])*M,F=(o[E]-l[E])*M;if(k>F){const U=k;k=F,F=U}if(k>y&&(y=k),F<w&&(w=F),y>w)return null}return y}function Bg(a,o,l,p,y,w,E,M,k,F,U){const z=p-a,Z=y-o,te=w-l,ie=E-a,K=M-o,pe=k-l,Ee=U[1]*pe-U[2]*K,xe=U[2]*ie-U[0]*pe,we=U[0]*K-U[1]*ie,Ce=z*Ee+Z*xe+te*we;if(Math.abs(Ce)<1e-15)return null;const Le=1/Ce,ke=F[0]-a,st=F[1]-o,rt=F[2]-l,bt=(ke*Ee+st*xe+rt*we)*Le;if(bt<0||bt>1)return null;const Gt=st*te-rt*Z,ht=rt*z-ke*te,Tt=ke*Z-st*z,xt=(U[0]*Gt+U[1]*ht+U[2]*Tt)*Le;return xt<0||bt+xt>1?null:(ie*Gt+K*ht+pe*Tt)*Le}function b0(a,o,l){return(a-o)/(l-o)}function x0(a,o,l,p,y,w,E,M,k){const F=1<<l,U=w-p,z=E-y,Z=(a+1)/F*U+p,te=(o+0)/F*z+y,ie=(o+1)/F*z+y;M[0]=(a+0)/F*U+p,M[1]=te,k[0]=Z,k[1]=ie}class Sy{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(w){const E=Math.ceil(Math.log2(w.dim/8)),M=[];let k=Math.ceil(Math.pow(2,E));const F=1/k,U=(te,ie,K,pe,Ee)=>{const xe=pe?1:0,we=(te+1)*K-xe,Ce=ie*K,Le=(ie+1)*K-xe;Ee[0]=te*K,Ee[1]=Ce,Ee[2]=we,Ee[3]=Le};let z=new Iy(k);const Z=[];for(let te=0;te<k*k;te++){U(te%k,Math.floor(te/k),F,!1,Z);const ie=ml(Z[0],Z[1],w),K=ml(Z[2],Z[1],w),pe=ml(Z[2],Z[3],w),Ee=ml(Z[0],Z[3],w);z.minimums.push(Math.min(ie,K,pe,Ee)),z.maximums.push(Math.max(ie,K,pe,Ee)),z.leaves.push(1)}for(M.push(z),k/=2;k>=1;k/=2){const te=M[M.length-1];z=new Iy(k);for(let ie=0;ie<k*k;ie++){U(ie%k,Math.floor(ie/k),2,!0,Z);const K=te.getElevation(Z[0],Z[1]),pe=te.getElevation(Z[2],Z[1]),Ee=te.getElevation(Z[2],Z[3]),xe=te.getElevation(Z[0],Z[3]),we=te.isLeaf(Z[0],Z[1]),Ce=te.isLeaf(Z[2],Z[1]),Le=te.isLeaf(Z[2],Z[3]),ke=te.isLeaf(Z[0],Z[3]),st=Math.min(K.min,pe.min,Ee.min,xe.min),rt=Math.max(K.max,pe.max,Ee.max,xe.max),bt=we&&Ce&&Le&&ke;z.maximums.push(rt),z.minimums.push(st),z.leaves.push(rt-st<=5&&bt?1:0)}M.push(z)}return M}(this.dem),p=l.length-1,y=l[p];this._addNode(y.minimums[0],y.maximums[0],y.leaves[0]),this._construct(l,0,0,p,0)}raycastRoot(o,l,p,y,w,E,M=1){return v0([o,l,-100],[p,y,this.maximums[0]*M],w,E)}raycast(o,l,p,y,w,E,M=1){if(!this.nodeCount)return null;const k=this.raycastRoot(o,l,p,y,w,E,M);if(null==k)return null;const F=[],U=[],z=[],Z=[],te=[{idx:0,t:k,nodex:0,nodey:0,depth:0}];for(;te.length>0;){const{idx:ie,t:K,nodex:pe,nodey:Ee,depth:xe}=te.pop();if(this.leaves[ie]){x0(pe,Ee,xe,o,l,p,y,z,Z);const Ce=1<<xe,Le=(pe+0)/Ce,ke=(pe+1)/Ce,st=(Ee+0)/Ce,rt=(Ee+1)/Ce,bt=ml(Le,st,this.dem)*M,Gt=ml(ke,st,this.dem)*M,ht=ml(ke,rt,this.dem)*M,Tt=ml(Le,rt,this.dem)*M,xt=Bg(z[0],z[1],bt,Z[0],z[1],Gt,Z[0],Z[1],ht,w,E),kt=Bg(Z[0],Z[1],ht,z[0],Z[1],Tt,z[0],z[1],bt,w,E),At=Math.min(null!==xt?xt:Number.MAX_VALUE,null!==kt?kt:Number.MAX_VALUE);if(At!==Number.MAX_VALUE)return At;{const ct=Qm([],w,E,K);if(Vg(bt,Gt,Tt,ht,b0(ct[0],z[0],Z[0]),b0(ct[1],z[1],Z[1]))>=ct[2])return K}continue}let we=0;for(let Ce=0;Ce<this._siblingOffset.length;Ce++){x0((pe<<1)+this._siblingOffset[Ce][0],(Ee<<1)+this._siblingOffset[Ce][1],xe+1,o,l,p,y,z,Z),z[2]=-100,Z[2]=this.maximums[this.childOffsets[ie]+Ce]*M;const Le=v0(z,Z,w,E);if(null!=Le){const ke=Le;F[Ce]=ke;let st=!1;for(let rt=0;rt<we&&!st;rt++)ke>=F[U[rt]]&&(U.splice(rt,0,Ce),st=!0);st||(U[we]=Ce),we++}}for(let Ce=0;Ce<we;Ce++){const Le=U[Ce];te.push({idx:this.childOffsets[ie]+Le,t:F[Le],nodex:(pe<<1)+this._siblingOffset[Le][0],nodey:(Ee<<1)+this._siblingOffset[Le][1],depth:xe+1})}}return null}_addNode(o,l,p){return this.minimums.push(o),this.maximums.push(l),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(o,l,p,y,w){if(1===o[y].isLeaf(l,p))return;this.childOffsets[w]||(this.childOffsets[w]=this.nodeCount);const E=y-1,M=o[E];let k=0,F=0;for(let U=0;U<this._siblingOffset.length;U++){const z=2*l+this._siblingOffset[U][0],Z=2*p+this._siblingOffset[U][1],te=M.getElevation(z,Z),ie=M.isLeaf(z,Z),K=this._addNode(te.min,te.max,ie);ie&&(k|=1<<U),F||(F=K)}for(let U=0;U<this._siblingOffset.length;U++)k&1<<U||this._construct(o,2*l+this._siblingOffset[U][0],2*p+this._siblingOffset[U][1],E,F+U)}}function Vg(a,o,l,p,y,w){return di(di(a,l,w),di(o,p,w),y)}function ml(a,o,l){const p=l.dim,y=Bt(a*p-.5,0,p-1),w=Bt(o*p-.5,0,p-1),E=Math.floor(y),M=Math.floor(w),k=Math.min(E+1,p-1),F=Math.min(M+1,p-1);return Vg(l.get(E,M),l.get(k,M),l.get(E,F),l.get(k,F),y-E,w-M)}const My={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Dy{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,l,p,y=!1,w=!1){if(this.uid=o,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(p&&"mapbox"!==p&&"terrarium"!==p)return Pi(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const E=this.dim=l.height-2,M=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.encoding=p||"mapbox",this.borderReady=y,!y){for(let k=0;k<E;k++)M[this._idx(-1,k)]=M[this._idx(0,k)],M[this._idx(E,k)]=M[this._idx(E-1,k)],M[this._idx(k,-1)]=M[this._idx(k,0)],M[this._idx(k,E)]=M[this._idx(k,E-1)];M[this._idx(-1,-1)]=M[this._idx(0,0)],M[this._idx(E,-1)]=M[this._idx(E-1,0)],M[this._idx(-1,E)]=M[this._idx(0,E-1)],M[this._idx(E,E)]=M[this._idx(E-1,E-1)],w&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Sy(this)}get(o,l,p=!1){p&&(o=Bt(o,-1,this.dim),l=Bt(l,-1,this.dim));const y=4*this._idx(o,l);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[y],this.pixels[y+1],this.pixels[y+2])}static getUnpackVector(o){return My[o]}get unpackVector(){return My[this.encoding]}_idx(o,l){if(o<-1||o>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(o+1)}_unpackMapbox(o,l,p){return(256*o*256+256*l+p)/10-1e4}_unpackTerrarium(o,l,p){return 256*o+l+p/256-32768}static pack(o,l){const p=[0,0,0,0],y=Dy.getUnpackVector(l);let w=Math.floor((o+y[3])/y[2]);return p[2]=w%256,w=Math.floor(w/256),p[1]=w%256,w=Math.floor(w/256),p[0]=w,p}getPixels(){return new Ua({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,l,p){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let y=l*this.dim,w=l*this.dim+this.dim,E=p*this.dim,M=p*this.dim+this.dim;switch(l){case-1:y=w-1;break;case 1:w=y+1}switch(p){case-1:E=M-1;break;case 1:M=E+1}const k=-l*this.dim,F=-p*this.dim;for(let U=E;U<M;U++)for(let z=y;z<w;z++){const Z=4*this._idx(z,U),te=4*this._idx(z+k,U+F);this.pixels[Z+0]=o.pixels[te+0],this.pixels[Z+1]=o.pixels[te+1],this.pixels[Z+2]=o.pixels[te+2],this.pixels[Z+3]=o.pixels[te+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}mn(Dy,"DEMData"),mn(Sy,"DemMinMaxQuadTree",{omit:["dem"]});class Ay{constructor(o,l){this.max=o,this.onRemove=l,this.reset()}reset(){for(const o in this.data)for(const l of this.data[o])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(o,l,p){const y=o.wrapped().key;void 0===this.data[y]&&(this.data[y]=[]);const w={value:l,timeout:void 0};if(void 0!==p&&(w.timeout=setTimeout(()=>{this.remove(o,w)},p)),this.data[y].push(w),this.order.push(y),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const l=this.data[o].shift();return l.timeout&&clearTimeout(l.timeout),0===this.data[o].length&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),l.value}getByKey(o){const l=this.data[o];return l?l[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,l){if(!this.has(o))return this;const p=o.wrapped().key,y=void 0===l?0:this.data[p].indexOf(l),w=this.data[p][y];return this.data[p].splice(y,1),w.timeout&&clearTimeout(w.timeout),0===this.data[p].length&&delete this.data[p],this.onRemove(w.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(o){const l=[];for(const p in this.data)for(const y of this.data[p])o(y.value)||l.push(y);for(const p of l)this.remove(p.value.tileID,p)}}class Hl{constructor(o,l,p){this.func=o,this.mask=l,this.range=p}}Hl.ReadOnly=!1,Hl.ReadWrite=!0,Hl.disabled=new Hl(519,Hl.ReadOnly,[0,1]);class w0{constructor(o,l,p,y,w,E){this.test=o,this.ref=l,this.mask=p,this.fail=y,this.depthFail=w,this.pass=E}}w0.disabled=new w0({func:519,mask:0},0,0,7680,7680,7680);class ql{constructor(o,l,p){this.blendFunction=o,this.blendColor=l,this.mask=p}}ql.Replace=[1,0],ql.disabled=new ql(ql.Replace,Jr.transparent,[!1,!1,!1,!1]),ql.unblended=new ql(ql.Replace,Jr.transparent,[!0,!0,!0,!0]),ql.alphaBlended=new ql([1,771],Jr.transparent,[!0,!0,!0,!0]);class _u{constructor(o,l,p){this.enable=o,this.mode=l,this.frontFace=p}}_u.disabled=new _u(!1,1029,2305),_u.backCCW=new _u(!0,1029,2305),_u.backCW=new _u(!0,1029,2304),_u.frontCW=new _u(!0,1028,2304),_u.frontCCW=new _u(!0,1028,2305);class np extends Rr{constructor(o,l,p){super(),this.id=o,this._onlySymbols=p,l.on("data",y=>{"source"===y.dataType&&"metadata"===y.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===y.dataType&&"content"===y.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new Ay(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Kx,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(o){this.map=o,this._minTileCacheSize=void 0===this._minTileCacheSize&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const l=this._tiles[o];if("loaded"!==l.state&&"errored"!==l.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,l){return o.isSymbolTile=this._onlySymbols,this._source.loadTile(o,l)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o,()=>{})}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const p=this._tiles[l];p.upload(o),p.prepare(this.map.style.imageManager)}}getIds(){return mt(this._tiles).map(o=>o.tileID).sort(Ug).map(o=>o.key)}getRenderableIds(o){const l=[];for(const p in this._tiles)this._isIdRenderable(+p,o)&&l.push(this._tiles[p]);return o?l.sort((p,y)=>{const w=p.tileID,E=y.tileID,M=new Ye(w.canonical.x,w.canonical.y)._rotate(this.transform.angle),k=new Ye(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return w.overscaledZ-E.overscaledZ||k.y-M.y||k.x-M.x}).map(p=>p.tileID.key):l.map(p=>p.tileID).sort(Ug).map(p=>p.key)}hasRenderableParent(o){const l=this.findLoadedParent(o,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(o,l){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(l||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(+o,"reloading")}}_reloadTile(o,l){const p=this._tiles[o];p&&("loading"!==p.state&&(p.state=l),this._loadTile(p,this._tileLoaded.bind(this,p,o,l)))}_tileLoaded(o,l,p,y){if(y)if(o.state="errored",404!==y.status)this._source.fire(new Zi(y,{tile:o}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const w=this.map.painter.terrain;this.update(this.transform,w.getScaledDemTileSize(),!0),w.resetTileLookupCache(this.id)}else this.update(this.transform);else o.timeAdded=gi.now(),"expired"===p&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(l,o),"raster-dem"===this._source.type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new fr("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const l=this.getRenderableIds();for(let y=0;y<l.length;y++){const w=l[y];if(o.neighboringTiles&&o.neighboringTiles[w]){const E=this.getTileByID(w);p(o,E),p(E,o)}}function p(y,w){if(!y.dem||y.dem.borderReady)return;y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0;let E=w.tileID.canonical.x-y.tileID.canonical.x;const M=w.tileID.canonical.y-y.tileID.canonical.y,k=Math.pow(2,y.tileID.canonical.z),F=w.tileID.key;0===E&&0===M||Math.abs(M)>1||(Math.abs(E)>1&&(1===Math.abs(E+k)?E+=k:1===Math.abs(E-k)&&(E-=k)),w.dem&&y.dem&&(y.dem.backfillBorder(w.dem,E,M),y.neighboringTiles&&y.neighboringTiles[F]&&(y.neighboringTiles[F].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,l,p,y){for(const w in this._tiles){let E=this._tiles[w];if(y[w]||!E.hasData()||E.tileID.overscaledZ<=l||E.tileID.overscaledZ>p)continue;let M=E.tileID;for(;E&&E.tileID.overscaledZ>l+1;){const F=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[F.key],E&&E.hasData()&&(M=F)}let k=M;for(;k.overscaledZ>l;)if(k=k.scaledTo(k.overscaledZ-1),o[k.key]){y[M.key]=M;break}}}findLoadedParent(o,l){if(o.key in this._loadedParentTiles){const p=this._loadedParentTiles[o.key];return p&&p.tileID.overscaledZ>=l?p:null}for(let p=o.overscaledZ-1;p>=l;p--){const y=o.scaledTo(p),w=this._getLoadedTile(y);if(w)return w}}_getLoadedTile(o){const l=this._tiles[o.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,l){l=l||this._source.tileSize;const p=Math.ceil(o.width/l)+1,y=Math.ceil(o.height/l)+1,w=Math.floor(p*y*5),E="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,w):w,M="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(M)}handleWrapJump(o){const l=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,l){const p={};for(const y in this._tiles){const w=this._tiles[y];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+l),p[w.tileID.key]=w}this._tiles=p;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(+y,this._tiles[y])}}update(o,l,p){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;let y;this.updateCacheSize(o,l),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?y=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new $a(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(y=o.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(y=y.filter(M=>this._source.hasTile(M)))):y=[];const w=this._updateRetainedTiles(y);if(E0(this._source.type)&&0!==y.length){const M={},k={},F=Object.keys(w);for(const z of F){const Z=w[z],te=this._tiles[z];if(!te||te.fadeEndTime&&te.fadeEndTime<=gi.now())continue;const ie=this.findLoadedParent(Z,Math.max(Z.overscaledZ-np.maxOverzooming,this._source.minzoom));ie&&(this._addTile(ie.tileID),M[ie.tileID.key]=ie.tileID),k[z]=Z}const U=y[y.length-1].overscaledZ;for(const z in this._tiles){const Z=this._tiles[z];if(w[z]||!Z.hasData())continue;let te=Z.tileID;for(;te.overscaledZ>U;){te=te.scaledTo(te.overscaledZ-1);const ie=this._tiles[te.key];if(ie&&ie.hasData()&&k[te.key]){w[z]=Z.tileID;break}}}for(const z in M)w[z]||(this._coveredTiles[z]=!0,w[z]=M[z])}for(const M in w)this._tiles[M].clearFadeHold();const E=function(M,k){const F=[];for(const U in M)U in k||F.push(U);return F}(this._tiles,w);for(const M of E){const k=this._tiles[M];k.hasSymbolBuckets&&!k.holdingForFade()?k.setHoldDuration(this.map._fadeDuration):k.hasSymbolBuckets&&!k.symbolFadeFinished()||this._removeTile(+M)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const l={};if(0===o.length)return l;const p={},y=o.reduce((F,U)=>Math.min(F,U.overscaledZ),1/0),w=o[0].overscaledZ,E=Math.max(w-np.maxOverzooming,this._source.minzoom),M=Math.max(w+np.maxUnderzooming,this._source.minzoom),k={};for(const F of o){const U=this._addTile(F);l[F.key]=F,U.hasData()||y<this._source.maxzoom&&(k[F.key]=F)}this._retainLoadedChildren(k,y,M,l);for(const F of o){let U=this._tiles[F.key];if(U.hasData())continue;if(F.canonical.z>=this._source.maxzoom){const Z=F.children(this._source.maxzoom)[0],te=this.getTile(Z);if(te&&te.hasData()){l[Z.key]=Z;continue}}else{const Z=F.children(this._source.maxzoom);if(l[Z[0].key]&&l[Z[1].key]&&l[Z[2].key]&&l[Z[3].key])continue}let z=U.wasRequested();for(let Z=F.overscaledZ-1;Z>=E;--Z){const te=F.scaledTo(Z);if(p[te.key]||(p[te.key]=!0,U=this.getTile(te),!U&&z&&(U=this._addTile(te)),U&&(l[te.key]=te,z=U.wasRequested(),U.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const l=[];let p,y=this._tiles[o].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){p=this._loadedParentTiles[y.key];break}l.push(y.key);const w=y.scaledTo(y.overscaledZ-1);if(p=this._getLoadedTile(w),p)break;y=w}for(const w of l)this._loadedParentTiles[w]=p}}_addTile(o){let l=this._tiles[o.key];if(l)return l;l=this._cache.getAndRemove(o),l&&(this._setTileReloadTimer(o.key,l),l.tileID=o,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,l)));const p=Boolean(l);if(!p){const y=this.map?this.map.painter:null;l=new tp(o,this._source.tileSize*o.overscaleFactor(),this.transform.tileZoom,y,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,o.key,l.state))}return l?(l.uses++,this._tiles[o.key]=l,p||this._source.fire(new fr("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(o,l){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const p=l.getExpiryTimeout();p&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},p))}_removeTile(o){const l=this._tiles[o];l&&(l.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),l.uses>0||(l.hasData()&&"reloading"!==l.state?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,l,p){const y=[],w=this.transform;if(!w)return y;const E="globe"===w.projection.name,M=Ju(w.center.lng);for(const k in this._tiles){const F=this._tiles[k];if(p&&F.clearQueryDebugViz(),F.holdingForFade())continue;let U;if(E){const z=F.tileID.canonical;if(0===z.z){const Z=[Math.abs(Bt(M,...$o(z,-1))-M),Math.abs(Bt(M,...$o(z,1))-M)];U=[0,2*Z.indexOf(Math.min(...Z))-1]}else{const Z=[Math.abs(Bt(M,...$o(z,-1))-M),Math.abs(Bt(M,...$o(z,0))-M),Math.abs(Bt(M,...$o(z,1))-M)];U=[Z.indexOf(Math.min(...Z))-1]}}else U=[0];for(const z of U){const Z=o.containsTile(F,w,l,z);Z&&y.push(Z)}}return y}getVisibleCoordinates(o){const l=this.getRenderableIds(o).map(p=>this._tiles[p].tileID);for(const p of l)p.projMatrix=this.transform.calculateProjMatrix(p.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(E0(this._source.type))for(const o in this._tiles){const l=this._tiles[o];if(void 0!==l.fadeEndTime&&l.fadeEndTime>=gi.now())return!0}return!1}setFeatureState(o,l,p){this._state.updateState(o=o||"_geojsonTileLayer",l,p)}removeFeatureState(o,l,p){this._state.removeFeatureState(o=o||"_geojsonTileLayer",l,p)}getFeatureState(o,l){return this._state.getState(o=o||"_geojsonTileLayer",l)}setDependencies(o,l,p){const y=this._tiles[o];y&&y.setDependencies(l,p)}reloadTilesForDependencies(o,l){for(const p in this._tiles)this._tiles[p].hasDependency(o,l)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(o,l))}_preloadTiles(o,l){const p=new Map,y=Array.isArray(o)?o:[o],w=this.map.painter.terrain,E=this.usedForTerrain&&w?w.getScaledDemTileSize():this._source.tileSize;for(const M of y){const k=M.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const F of k)p.set(F.key,F);this.usedForTerrain&&M.updateElevation(!1)}On(Array.from(p.values()),(M,k)=>{const F=new tp(M,this._source.tileSize*M.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(F,U=>{"raster-dem"===this._source.type&&F.dem&&this._backfillDEM(F),k(U,F)})},l)}}function Ug(a,o){const l=Math.abs(2*a.wrap)-+(a.wrap<0),p=Math.abs(2*o.wrap)-+(o.wrap<0);return a.overscaledZ-o.overscaledZ||p-l||o.canonical.y-a.canonical.y||o.canonical.x-a.canonical.x}function E0(a){return"raster"===a||"image"===a||"video"===a||"custom"===a}function $o(a,o){const l=1<<a.z;return[a.x/l+o,(a.x+1)/l+o]}np.maxOverzooming=10,np.maxUnderzooming=3;class xm{constructor(o,l,p){this._demTile=o,this._dem=this._demTile.dem,this._scale=l,this._offset=p}static create(o,l,p){const y=p||o.findDEMTileFor(l);if(!y||!y.dem)return;const w=y.dem,E=y.tileID,M=1<<l.canonical.z-E.canonical.z;return new xm(y,y.tileSize/Qn/M,[(l.canonical.x/M-E.canonical.x)*w.dim,(l.canonical.y/M-E.canonical.y)*w.dim])}tileCoordToPixel(o,l){const p=l*this._scale+this._offset[1],y=Math.floor(o*this._scale+this._offset[0]),w=Math.floor(p);return new Ye(y,w)}getElevationAt(o,l,p,y){const w=o*this._scale+this._offset[0],E=l*this._scale+this._offset[1],M=Math.floor(w),k=Math.floor(E),F=this._dem;return y=!!y,p?di(di(F.get(M,k,y),F.get(M,k+1,y),E-k),di(F.get(M+1,k,y),F.get(M+1,k+1,y),E-k),w-M):F.get(M,k,y)}getElevationAtPixel(o,l,p){return this._dem.get(o,l,!!p)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*Ul(1,o)*this._dem.stride}}class Qx{constructor(o,l){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new ka(Qn,16,0),this.featureIndexArray=new Up,this.promoteId=l}insert(o,l,p,y,w,E=0){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,y,w,E);const k=this.grid;for(let F=0;F<l.length;F++){const U=l[F],z=[1/0,1/0,-1/0,-1/0];for(let Z=0;Z<U.length;Z++){const te=U[Z];z[0]=Math.min(z[0],te.x),z[1]=Math.min(z[1],te.y),z[2]=Math.max(z[2],te.x),z[3]=Math.max(z[3],te.y)}z[0]<Qn&&z[1]<Qn&&z[2]>=0&&z[3]>=0&&k.insert(M,z[0],z[1],z[2],z[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new $f(new ko(this.rawTileData)).layers,this.sourceLayerCoder=new Fg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,l,p,y){this.loadVTLayers();const w=o.params||{},E=Xc(w.filter),M=o.tileResult,k=o.transform,F=M.bufferedTilespaceBounds,U=this.grid.query(F.min.x,F.min.y,F.max.x,F.max.y,(ie,K,pe,Ee)=>lx(M.bufferedTilespaceGeometry,ie,K,pe,Ee));U.sort(Jx);let z=null;k.elevation&&U.length>0&&(z=xm.create(k.elevation,this.tileID));const Z={};let te;for(let ie=0;ie<U.length;ie++){const K=U[ie];if(K===te)continue;te=K;const pe=this.featureIndexArray.get(K);let Ee=null;this.loadMatchingFeature(Z,pe,E,w.layers,w.availableImages,l,p,y,(xe,we,Ce,Le=0)=>(Ee||(Ee=au(xe,this.tileID.canonical,o.tileTransform)),we.queryIntersectsFeature(M,xe,Ce,Ee,this.z,o.transform,o.pixelPosMatrix,z,Le)))}return Z}loadMatchingFeature(o,l,p,y,w,E,M,k,F){const{featureIndex:U,bucketIndex:z,sourceLayerIndex:Z,layoutVertexArrayOffset:te}=l,ie=this.bucketLayerIDs[z];if(y&&!function(xe,we){for(let Ce=0;Ce<xe.length;Ce++)if(we.indexOf(xe[Ce])>=0)return!0;return!1}(y,ie))return;const K=this.sourceLayerCoder.decode(Z),pe=this.vtLayers[K].feature(U);if(p.needGeometry){const xe=Nf(pe,!0);if(!p.filter(new Ze(this.tileID.overscaledZ),xe,this.tileID.canonical))return}else if(!p.filter(new Ze(this.tileID.overscaledZ),pe))return;const Ee=this.getId(pe,K);for(let xe=0;xe<ie.length;xe++){const we=ie[xe];if(y&&y.indexOf(we)<0)continue;const Ce=E[we];if(!Ce)continue;let Le={};void 0!==Ee&&k&&(Le=k.getState(Ce.sourceLayer||"_geojsonTileLayer",Ee));const ke=gt({},M[we]);ke.paint=T0(ke.paint,Ce.paint,pe,Le,w),ke.layout=T0(ke.layout,Ce.layout,pe,Le,w);const st=!F||F(pe,Ce,Le,te);if(!st)continue;const rt=new Yx(pe,this.z,this.x,this.y,Ee);rt.layer=ke;let bt=o[we];void 0===bt&&(bt=o[we]=[]),bt.push({featureIndex:U,feature:rt,intersectionZ:st})}}lookupSymbolFeatures(o,l,p,y,w,E,M,k){const F={};this.loadVTLayers();const U=Xc(w);for(const z of o)this.loadMatchingFeature(F,{bucketIndex:p,sourceLayerIndex:y,featureIndex:z,layoutVertexArrayOffset:0},U,E,M,k,l);return F}loadFeature(o){const{featureIndex:l,sourceLayerIndex:p}=o;this.loadVTLayers();const y=this.sourceLayerCoder.decode(p),w=this.vtFeatures[y];if(w[l])return w[l];const E=this.vtLayers[y].feature(l);return w[l]=E,E}hasLayer(o){for(const l of this.bucketLayerIDs)for(const p of l)if(o===p)return!0;return!1}getId(o,l){let p=o.id;if(this.promoteId){const y="string"==typeof this.promoteId?this.promoteId:this.promoteId[l];null!=y&&(p=o.properties[y]),"boolean"==typeof p&&(p=Number(p))}return p}}function T0(a,o,l,p,y){return qn(a,(w,E)=>{const M=o instanceof et?o.get(E):null;return M&&M.evaluate?M.evaluate(l,p,y):M})}function Jx(a,o){return o-a}mn(Qx,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class I0{constructor(o,l){this.width=o,this.height=l,this.nextRow=0,this.image=new Js({width:o,height:l}),this.positions={},this.uploaded=!1}getDash(o,l){const p=this.getKey(o,l);return this.positions[p]}trim(){const o=this.width,l=this.height=en(this.nextRow);this.image.resize({width:o,height:l})}getKey(o,l){return o.join(",")+l}getDashRanges(o,l,p){const y=[];let w=o.length%2==1?-o[o.length-1]*p:0,E=o[0]*p,M=!0;y.push({left:w,right:E,isDash:M,zeroLength:0===o[0]});let k=o[0];for(let F=1;F<o.length;F++){M=!M;const U=o[F];w=k*p,k+=U,E=k*p,y.push({left:w,right:E,isDash:M,zeroLength:0===U})}return y}addRoundDash(o,l,p){const y=l/2;for(let w=-p;w<=p;w++){const E=this.width*(this.nextRow+p+w);let M=0,k=o[M];for(let F=0;F<this.width;F++){F/k.right>1&&(k=o[++M]);const U=Math.abs(F-k.left),z=Math.abs(F-k.right),Z=Math.min(U,z);let te;const ie=w/p*(y+1);if(k.isDash){const K=y-Math.abs(ie);te=Math.sqrt(Z*Z+K*K)}else te=y-Math.sqrt(Z*Z+ie*ie);this.image.data[E+F]=Math.max(0,Math.min(255,te+128))}}}addRegularDash(o,l){for(let k=o.length-1;k>=0;--k){const F=o[k],U=o[k+1];F.zeroLength?o.splice(k,1):U&&U.isDash===F.isDash&&(U.left=F.left,o.splice(k,1))}const p=o[0],y=o[o.length-1];p.isDash===y.isDash&&(p.left=y.left-this.width,y.right=p.right+this.width);const w=this.width*this.nextRow;let E=0,M=o[E];for(let k=0;k<this.width;k++){k/M.right>1&&(M=o[++E]);const F=Math.abs(k-M.left),U=Math.abs(k-M.right),z=Math.min(F,U);this.image.data[w+k]=Math.max(0,Math.min(255,(M.isDash?z:-z)+l+128))}}addDash(o,l){const p=this.getKey(o,l);if(this.positions[p])return this.positions[p];const y="round"===l,w=y?7:0,E=2*w+1;if(this.nextRow+E>this.height)return Pi("LineAtlas out of space"),null;0===o.length&&o.push(1);let M=0;for(let U=0;U<o.length;U++)o[U]<0&&(Pi("Negative value is found in line dasharray, replacing values with 0"),o[U]=0),M+=o[U];if(0!==M){const U=this.width/M,z=this.getDashRanges(o,this.width,U);y?this.addRoundDash(z,U,w):this.addRegularDash(z,"square"===l?.5*U:0)}const k=this.nextRow+w;this.nextRow+=E;const F={tl:[k,w],br:[M,0]};return this.positions[p]=F,F}}mn(I0,"LineAtlas");class S0{constructor(o){const l={},p=[];for(const M in o){const k=o[M],F=l[M]={};for(const U in k.glyphs){const z=k.glyphs[+U];if(!z||0===z.bitmap.width||0===z.bitmap.height)continue;const Z=z.metrics.localGlyph?2:1,te={x:0,y:0,w:z.bitmap.width+2*Z,h:z.bitmap.height+2*Z};p.push(te),F[U]=te}}const{w:y,h:w}=yg(p),E=new Js({width:y||1,height:w||1});for(const M in o){const k=o[M];for(const F in k.glyphs){const U=k.glyphs[+F];if(!U||0===U.bitmap.width||0===U.bitmap.height)continue;const z=l[M][F],Z=U.metrics.localGlyph?2:1;Js.copy(U.bitmap,E,{x:0,y:0},{x:z.x+Z,y:z.y+Z},U.bitmap)}}this.image=E,this.positions=l}}mn(S0,"GlyphAtlas");class M0{constructor(o){this.tileID=new $a(o.tileID.overscaledZ,o.tileID.wrap,o.tileID.canonical.z,o.tileID.canonical.x,o.tileID.canonical.y),this.tileZoom=o.tileZoom,this.uid=o.uid,this.zoom=o.zoom,this.canonical=o.tileID.canonical,this.pixelRatio=o.pixelRatio,this.tileSize=o.tileSize,this.source=o.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=o.showCollisionBoxes,this.collectResourceTiming=!!o.collectResourceTiming,this.returnDependencies=!!o.returnDependencies,this.promoteId=o.promoteId,this.enableTerrain=!!o.enableTerrain,this.isSymbolTile=o.isSymbolTile,this.tileTransform=xa(o.tileID.canonical,o.projection),this.projection=o.projection}parse(o,l,p,y,w){this.status="parsing",this.data=o,this.collisionBoxArray=new hs;const E=new Fg(Object.keys(o.layers).sort()),M=new Qx(this.tileID,this.promoteId);M.bucketLayerIDs=[];const k={},F=new I0(256,256),U={featureIndex:M,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:F,availableImages:p},z=l.familiesBySource[this.source];for(const Le in z){const ke=o.layers[Le];if(!ke)continue;let st=!1,rt=!1;for(const ht of z[Le])"symbol"===ht[0].type?st=!0:rt=!0;if(!0===this.isSymbolTile&&!st||!1===this.isSymbolTile&&!rt)continue;1===ke.version&&Pi(`Vector tile source "${this.source}" layer "${Le}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const bt=E.encode(Le),Gt=[];for(let ht=0;ht<ke.length;ht++){const Tt=ke.feature(ht),xt=M.getId(Tt,Le);Gt.push({feature:Tt,id:xt,index:ht,sourceLayerIndex:bt})}for(const ht of z[Le]){const Tt=ht[0];void 0!==this.isSymbolTile&&"symbol"===Tt.type!==this.isSymbolTile||Tt.minzoom&&this.zoom<Math.floor(Tt.minzoom)||Tt.maxzoom&&this.zoom>=Tt.maxzoom||"none"!==Tt.visibility&&(ip(ht,this.zoom,p),(k[Tt.id]=Tt.createBucket({index:M.bucketLayerIDs.length,layers:ht,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:bt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:p})).populate(Gt,U,this.tileID.canonical,this.tileTransform),M.bucketLayerIDs.push(ht.map(xt=>xt.id)))}}let Z,te,ie,K;F.trim();const pe={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Ee=qn(U.glyphDependencies,Le=>Object.keys(Le).map(Number));Object.keys(Ee).length?y.send("getGlyphs",{uid:this.uid,stacks:Ee},(Le,ke)=>{Z||(Z=Le,te=ke,Ce.call(this))},void 0,!1,pe):te={};const xe=Object.keys(U.iconDependencies);xe.length?y.send("getImages",{icons:xe,source:this.source,tileID:this.tileID,type:"icons"},(Le,ke)=>{Z||(Z=Le,ie=ke,Ce.call(this))},void 0,!1,pe):ie={};const we=Object.keys(U.patternDependencies);function Ce(){if(Z)return w(Z);if(te&&ie&&K){const Le=new S0(te),ke=new l0(ie,K);for(const st in k){const rt=k[st];rt instanceof ad?(ip(rt.layers,this.zoom,p),oC(rt,te,Le.positions,ie,ke.iconPositions,this.showCollisionBoxes,p,this.tileID.canonical,this.tileZoom,this.projection)):rt.hasPattern&&(rt instanceof pg||rt instanceof Z_||rt instanceof lm)&&(ip(rt.layers,this.zoom,p),rt.addFeatures(U,this.tileID.canonical,ke.patternPositions,p,this.tileTransform))}this.status="done",w(null,{buckets:mt(k).filter(st=>!st.isEmpty()),featureIndex:M,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Le.image,lineAtlas:F,imageAtlas:ke,glyphMap:this.returnDependencies?te:null,iconMap:this.returnDependencies?ie:null,glyphPositions:this.returnDependencies?Le.positions:null})}}we.length?y.send("getImages",{icons:we,source:this.source,tileID:this.tileID,type:"patterns"},(Le,ke)=>{Z||(Z=Le,K=ke,Ce.call(this))},void 0,!1,pe):K={},Ce.call(this)}}function ip(a,o,l){const p=new Ze(o);for(const y of a)y.recalculate(p,l)}class uC{constructor(o){this.entries={},this.scheduler=o}request(o,l,p,y){const w=this.entries[o]=this.entries[o]||{callbacks:[]};if(w.result){const[E,M]=w.result;return this.scheduler?this.scheduler.add(()=>{y(E,M)},l):y(E,M),()=>{}}return w.callbacks.push(y),w.cancel||(w.cancel=p((E,M)=>{w.result=[E,M];for(const k of w.callbacks)this.scheduler?this.scheduler.add(()=>{k(E,M)},l):k(E,M);setTimeout(()=>delete this.entries[o],3e3)})),()=>{w.result||(w.callbacks=w.callbacks.filter(E=>E!==y),w.callbacks.length||(w.cancel(),delete this.entries[o]))}}}function dC(a,o,l){const p=JSON.stringify(a.request);return a.data&&(this.deduped.entries[p]={result:[null,a.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},y=>{const w=Xr(a.request,(E,M,k,F)=>{E?y(E):M&&y(null,{vectorTile:l?void 0:new $f(new ko(M)),rawData:M,cacheControl:k,expires:F})});return()=>{w.cancel(),y()}},o)}_.ARRAY_TYPE=za,_.AUTH_ERR_MSG=Ei,_.Aabb=ya,_.Actor=class{constructor(a,o,l){this.target=a,this.parent=o,this.mapId=l,this.callbacks={},this.cancelCallbacks={},Cn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=kr()?a:$e,this.scheduler=new Zx}send(a,o,l,p,y=!1,w){const E=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=w,this.callbacks[E]=l);const M=so(this.globalScope)?void 0:[];return this.target.postMessage({id:E,type:a,hasCallback:!!l,targetMapId:p,mustQueue:y,sourceMapId:this.mapId,data:xr(o,M)},M),{cancel:()=>{l&&delete this.callbacks[E],this.target.postMessage({id:E,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(a){const o=a.data,l=o.id;if(l&&(!o.targetMapId||this.mapId===o.targetMapId))if("<cancel>"===o.type){const p=this.cancelCallbacks[l];delete this.cancelCallbacks[l],p&&p.cancel()}else if(o.mustQueue||kr()){const p=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,o),p&&p.metadata||{type:"message"})}else this.processTask(l,o)}processTask(a,o){if("<response>"===o.type){const l=this.callbacks[a];delete this.callbacks[a],l&&(o.error?l($u(o.error)):l(null,$u(o.data)))}else{const l=so(this.globalScope)?void 0:[],p=o.hasCallback?(w,E)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:w?xr(w):null,data:xr(E,l)},l)}:w=>{},y=$u(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,y,p);else if(this.parent.getWorkerSource){const w=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,w[0],y.source)[w[1]](y,p)}else p(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},_.CanonicalTileID=e0,_.Color=Jr,_.ColorMode=ql,_.CullFaceMode=_u,_.DEMData=Dy,_.DataConstantProperty=qe,_.DedupedRequest=uC,_.DepthMode=Hl,_.EXTENT=Qn,_.Elevation=class{isDataAvailableAtPoint(a){const o=this._source();if(this.isUsingMockSource()||!o||a.y<0||a.y>1)return!1;const l=o.getSource().maxzoom,p=1<<l,y=Math.floor(a.x),w=Math.floor((a.x-y)*p),E=Math.floor(a.y*p),M=this.findDEMTileFor(new $a(l,y,l,w,E));return!(!M||!M.dem)}getAtPointOrZero(a,o=0){return this.getAtPoint(a,o)||0}getAtPoint(a,o,l=!0){if(this.isUsingMockSource())return null;null==o&&(o=null);const p=this._source();if(!p||a.y<0||a.y>1)return o;const y=p.getSource().maxzoom,w=1<<y,E=Math.floor(a.x),M=a.x-E,k=new $a(y,E,y,Math.floor(M*w),Math.floor(a.y*w)),F=this.findDEMTileFor(k);if(!F||!F.dem)return o;const U=F.dem,z=1<<F.tileID.canonical.z,Z=(M*z-F.tileID.canonical.x)*U.dim,te=(a.y*z-F.tileID.canonical.y)*U.dim,ie=Math.floor(Z),K=Math.floor(te);return(l?this.exaggeration():1)*di(di(U.get(ie,K),U.get(ie,K+1),te-K),di(U.get(ie+1,K),U.get(ie+1,K+1),te-K),Z-ie)}getAtTileOffset(a,o,l){const p=1<<a.canonical.z;return this.getAtPointOrZero(new Ff(a.wrap+(a.canonical.x+o/Qn)/p,(a.canonical.y+l/Qn)/p))}getAtTileOffsetFunc(a,o,l,p){return y=>{const w=this.getAtTileOffset(a,y.x,y.y),E=p.upVector(a.canonical,y.x,y.y);return Hs(E,E,w*p.upVectorScale(a.canonical,o,l).metersToTile),E}}getForTilePoints(a,o,l,p){if(this.isUsingMockSource())return!1;const y=xm.create(this,a,p);return!!y&&(o.forEach(w=>{w[2]=this.exaggeration()*y.getElevationAt(w[0],w[1],l)}),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(a);if(!o||!o.dem)return null;const l=o.dem.tree,p=o.tileID,y=1<<a.canonical.z-p.canonical.z;let w=a.canonical.x/y-p.canonical.x,E=a.canonical.y/y-p.canonical.y,M=0;for(let k=0;k<a.canonical.z-p.canonical.z&&!l.leaves[M];k++){w*=2,E*=2;const F=2*Math.floor(E)+Math.floor(w);M=l.childOffsets[M]+F,w%=1,E%=1}return{min:this.exaggeration()*l.minimums[M],max:this.exaggeration()*l.maximums[M]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,o,l){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},_.ErrorEvent=Zi,_.EvaluationParameters=Ze,_.Event=fr,_.Evented=Rr,_.FillExtrusionBucket=lm,_.Frustum=k_,_.FrustumCorners=Nh,_.GLOBE_RADIUS=ll,_.GLOBE_SCALE_MATCH_LATITUDE=45,_.GLOBE_ZOOM_THRESHOLD_MAX=6,_.GLOBE_ZOOM_THRESHOLD_MIN=5,_.GlobeSharedBuffers=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const a of this._wireframeSegments)a.destroy()}}_fillGridMeshWithLods(a,o){const l=new Bn,p=new ho,y=[],w=a+1+2,E=o[0]+1,M=o[0]+1+(1+o.length),k=(F,U,z)=>{let Z=F===w-1?F-2:0===F?F:F-1;return Z+=z?24575:0,[Z,U]};for(let F=0;F<w;++F)l.emplaceBack(...k(F,0,!0));for(let F=0;F<E;++F)for(let U=0;U<w;++U)l.emplaceBack(...k(U,F,(0===U||U===w-1)&&!0));for(let F=0;F<o.length;++F){const U=o[F];for(let z=0;z<w;++z)l.emplaceBack(...k(z,U,!0))}for(let F=0;F<o.length;++F){const U=p.length,z=o[F]+1+2,Z=new ho;for(let K=0;K<z-1;K++){const pe=K===z-2,Ee=pe?w*(M-o.length+F-K):w;for(let xe=0;xe<w-1;xe++){const we=K*w+xe;0===K||pe||0===xe||xe===w-2?(Z.emplaceBack(we+1,we,we+Ee),Z.emplaceBack(we+Ee,we+Ee+1,we+1)):(p.emplaceBack(we+1,we,we+Ee),p.emplaceBack(we+Ee,we+Ee+1,we+1))}}const te=Zr.simpleSegment(0,U,l.length,p.length-U);for(let K=0;K<Z.uint16.length;K+=3)p.emplaceBack(Z.uint16[K],Z.uint16[K+1],Z.uint16[K+2]);const ie=Zr.simpleSegment(0,U,l.length,p.length-U);y.push({withoutSkirts:te,withSkirts:ie})}return{vertices:l,indices:p,segments:y}}_createGrid(a){const o=this._fillGridMeshWithLods(64,Pf);this._gridSegments=o.segments,this._gridBuffer=a.createVertexBuffer(o.vertices,Zp.members),this._gridIndexBuffer=a.createIndexBuffer(o.indices,!0)}_createPoles(a){const o=new ho;for(let y=0;y<=64;y++)o.emplaceBack(0,y+1,y+2);this._poleIndexBuffer=a.createIndexBuffer(o,!0);const l=new Ks,p=new Ks;this._poleSegments=[];for(let y=0,w=0;y<5;y++){const E=360/(1<<y);l.emplaceBack(0,-ll,0,.5,0),p.emplaceBack(0,-ll,0,.5,1);for(let M=0;M<=64;M++){const k=M/64,F=di(0,E,k),[U,z,Z]=Bh(R1,F1,F,ll);l.emplaceBack(U,z,Z,k,0),p.emplaceBack(U,z,Z,k,1)}this._poleSegments.push(Zr.simpleSegment(w,0,66,64)),w+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(l,vc,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(p,vc,!1)}getGridBuffers(a,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}getWirefameBuffers(a,o){if(!this._wireframeSegments){const l=new Ll,p=64,y=p+1+2,w=1;this._wireframeSegments=[];for(let E=0,M=0;E<Pf.length;E++){const k=Pf[E];for(let U=w;U<k+w;U++)for(let z=w;z<p+w;z++){const Z=U*y+z;l.emplaceBack(Z,Z+1),l.emplaceBack(Z,Z+y),l.emplaceBack(Z,Z+y+1)}const F=k*p*3;this._wireframeSegments.push(Zr.simpleSegment(0,M,(k+1)*y,F)),M+=F}this._wireframeIndexBuffer=a.createIndexBuffer(l)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[o]]}},_.GlyphManager=Gd,_.ImagePosition=Gh,_.LivePerformanceUtils=it,_.LngLat=tr,_.LngLatBounds=gc,_.LocalGlyphMode=Zf,_.MAX_MERCATOR_LATITUDE=Eo,_.MercatorCoordinate=Ff,_.ONE_EM=Fs,_.OverscaledTileID=$a,_.PerformanceMarkers=He,_.Properties=Lt,_.RGBAImage=Ua,_.Ray=Fv,_.RequestManager=class{constructor(a,o,l){this._transformRequestFn=a,this._customAccessToken=o,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const a=function(){let o="";for(let l=0;l<10;l++)o+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",bn,o].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,o){return this._transformRequestFn&&this._transformRequestFn(a,o)||{url:a}}normalizeStyleURL(a,o){if(!lo(a))return a;const l=ei(a);return l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||o)}normalizeGlyphsURL(a,o){if(!lo(a))return a;const l=ei(a);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||o)}normalizeSourceURL(a,o,l,p){if(!lo(a))return a;const y=ei(a);return y.path=`/v4/${y.authority}.json`,y.params.push("secure"),l&&y.params.push(`language=${l}`),p&&y.params.push(`worldview=${p}`),this._makeAPIURL(y,this._customAccessToken||o)}normalizeSpriteURL(a,o,l,p){const y=ei(a);return lo(a)?(y.path=`/styles/v1${y.path}/sprite${o}${l}`,this._makeAPIURL(y,this._customAccessToken||p)):(y.path+=`${o}${l}`,ki(y))}normalizeTileURL(a,o,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!lo(a))return a;const p=ei(a);p.path=p.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${o||l&&"raster"!==p.authority&&512===l?"@2x":""}${It.supported?".webp":"$1"}`),"raster"===p.authority?p.path=`/${yt.RASTER_URL_PREFIX}${p.path}`:(p.path=p.path.replace(/^.+\/v4\//,"/"),p.path=`/${yt.TILE_URL_VERSION}${p.path}`);const y=this._customAccessToken||function(w){for(const E of w){const M=E.match(/^access_token=(.*)$/);if(M)return M[1]}return null}(p.params)||yt.ACCESS_TOKEN;return yt.REQUIRE_ACCESS_TOKEN&&y&&this._skuToken&&p.params.push(`sku=${this._skuToken}`),this._makeAPIURL(p,y)}canonicalizeTileURL(a,o){const l=ei(a);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return a;let p="mapbox://";l.path.match(/^\/raster\/v1\//)?p+=`raster/${l.path.replace(`/${yt.RASTER_URL_PREFIX}/`,"")}`:p+=`tiles/${l.path.replace(`/${yt.TILE_URL_VERSION}/`,"")}`;let y=l.params;return o&&(y=y.filter(w=>!w.match(/^access_token=/))),y.length&&(p+=`?${y.join("&")}`),p}canonicalizeTileset(a,o){const l=!!o&&lo(o),p=[];for(const y of a.tiles||[])Hr(y)?p.push(this.canonicalizeTileURL(y,l)):p.push(y);return p}_makeAPIURL(a,o){const l="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",p=ei(yt.API_URL);if(a.protocol=p.protocol,a.authority=p.authority,"http"===a.protocol){const y=a.params.indexOf("secure");y>=0&&a.params.splice(y,1)}if("/"!==p.path&&(a.path=`${p.path}${a.path}`),!yt.REQUIRE_ACCESS_TOKEN)return ki(a);if(o=o||yt.ACCESS_TOKEN,!this._silenceAuthErrors){if(!o)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if("s"===o[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return a.params=a.params.filter(y=>-1===y.indexOf("access_token")),a.params.push(`access_token=${o||""}`),ki(a)}},_.ResourceType=jn,_.SegmentVector=Zr,_.SourceCache=np,_.StencilMode=w0,_.StructArrayLayout1ui2=il,_.StructArrayLayout2f1f2i16=Xn,_.StructArrayLayout2i4=Bn,_.StructArrayLayout2ui4=Ll,_.StructArrayLayout3f12=xs,_.StructArrayLayout3ui6=ho,_.StructArrayLayout4i8=Fi,_.StructArrayLayout5f20=Ks,_.Texture=ep,_.Tile=tp,_.Transitionable=Ut,_.Uniform1f=lt,_.Uniform1i=class extends _e{constructor(a){super(a),this.current=0}set(a,o,l){this.fetchUniformLocation(a,o)&&this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},_.Uniform2f=class extends _e{constructor(a){super(a),this.current=[0,0]}set(a,o,l){this.fetchUniformLocation(a,o)&&(l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1])))}},_.Uniform3f=class extends _e{constructor(a){super(a),this.current=[0,0,0]}set(a,o,l){this.fetchUniformLocation(a,o)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2])))}},_.Uniform4f=$t,_.UniformColor=Tn,_.UniformMatrix2f=class extends _e{constructor(a){super(a),this.current=po}set(a,o,l){if(this.fetchUniformLocation(a,o))for(let p=0;p<4;p++)if(l[p]!==this.current[p]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}},_.UniformMatrix3f=class extends _e{constructor(a){super(a),this.current=zi}set(a,o,l){if(this.fetchUniformLocation(a,o))for(let p=0;p<9;p++)if(l[p]!==this.current[p]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}},_.UniformMatrix4f=class extends _e{constructor(a){super(a),this.current=ii}set(a,o,l){if(this.fetchUniformLocation(a,o)){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let p=1;p<16;p++)if(l[p]!==this.current[p]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}}},_.UnwrappedTileID=Sx,_.ValidationError=hn,_.VectorTileFeature=Gf,_.VectorTileWorkerSource=class extends Rr{constructor(a,o,l,p,y){super(),this.actor=a,this.layerIndex=o,this.availableImages=l,this.loadVectorData=y||dC,this.loading={},this.loaded={},this.deduped=new uC(a.scheduler),this.isSpriteLoaded=p,this.scheduler=a.scheduler}loadTile(a,o){const l=a.uid,p=a&&a.request,y=p&&p.collectResourceTiming,w=this.loading[l]=new M0(a);w.abort=this.loadVectorData(a,(E,M)=>{const k=!this.loading[l];if(delete this.loading[l],k||E||!M)return w.status="done",k||(this.loaded[l]=w),o(E);const F=M.rawData,U={};M.expires&&(U.expires=M.expires),M.cacheControl&&(U.cacheControl=M.cacheControl),w.vectorTile=M.vectorTile||new $f(new ko(F));const z=()=>{w.parse(w.vectorTile,this.layerIndex,this.availableImages,this.actor,(Z,te)=>{if(Z||!te)return o(Z);const ie={};if(y){const K=En(p);K.length>0&&(ie.resourceTiming=JSON.parse(JSON.stringify(K)))}o(null,gt({rawTileData:F.slice(0)},te,U,ie))})};this.isSpriteLoaded?z():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(z,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):z()}),this.loaded=this.loaded||{},this.loaded[l]=w})}reloadTile(a,o){const l=this.loaded,p=a.uid,y=this;if(l&&l[p]){const w=l[p];w.showCollisionBoxes=a.showCollisionBoxes,w.enableTerrain=!!a.enableTerrain,w.projection=a.projection,w.tileTransform=xa(a.tileID.canonical,a.projection);const E=(M,k)=>{const F=w.reloadCallback;F&&(delete w.reloadCallback,w.parse(w.vectorTile,y.layerIndex,this.availableImages,y.actor,F)),o(M,k)};"parsing"===w.status?w.reloadCallback=E:"done"===w.status&&(w.vectorTile?w.parse(w.vectorTile,this.layerIndex,this.availableImages,this.actor,E):E())}}abortTile(a,o){const l=a.uid,p=this.loading[l];p&&(p.abort&&p.abort(),delete this.loading[l]),o()}removeTile(a,o){const l=this.loaded,p=a.uid;l&&l[p]&&delete l[p],o()}},_.WritingMode=dl,_.ZoomDependentExpression=Ol,_.add=Ba,_.addDynamicAttributes=p0,_.adjoint=function(a,o){var l=o[0],p=o[1],y=o[2],w=o[3],E=o[4],M=o[5],k=o[6],F=o[7],U=o[8];return a[0]=E*U-M*F,a[1]=y*F-p*U,a[2]=p*M-y*E,a[3]=M*k-w*U,a[4]=l*U-y*k,a[5]=y*w-l*M,a[6]=w*F-E*k,a[7]=p*k-l*F,a[8]=l*E-p*w,a},_.asyncAll=On,_.bezier=pt,_.bindAll=Cn,_.boundsAttributes=zg,_.bufferConvexPolygon=function(a,o){const l=[];for(let p=0;p<a.length;p++){const y=oi(p-1,-1,a.length-1),w=oi(p+1,-1,a.length-1),E=a[p],M=a[w],k=a[y].sub(E).unit(),F=M.sub(E).unit(),U=F.angleWithSep(k.x,k.y),z=k.add(F).unit().mult(-1*o/Math.sin(U/2));l.push(E.add(z))}return l},_.cacheEntryPossiblyAdded=function(a){pi++,pi>ls&&(a.getActor().send("enforceCacheSizeLimit",zo),pi=0)},_.calculateGlobeLabelMatrix=function(a,o){const{x:l,y:p}=a.point,y=N_(l,p,a.worldSize/a._pixelsPerMercatorPixel,0,0);return Ld(y,y,Lv(Vl(o)))},_.calculateGlobeMatrix=function(a){const{x:o,y:l}=a.point,{lng:p,lat:y}=a._center;return N_(o,l,a.worldSize,p,y)},_.calculateGlobeMercatorMatrix=function(a){const o=a.pixelsPerMeter,l=o/Ul(1,a.center.lat),p=_c(new Float64Array(16));return Fh(p,p,[a.point.x,a.point.y,0]),yc(p,p,[l,l,o]),Float32Array.from(p)},_.circumferenceAtLatitude=kf,_.clamp=Bt,_.clearTileCache=function(a){if(!vo())return;const o=$e.caches.delete(Ir);a&&o.catch(a).then(()=>a())},_.clipLine=rC,_.clone=function(a){var o=new za(16);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],o[4]=a[4],o[5]=a[5],o[6]=a[6],o[7]=a[7],o[8]=a[8],o[9]=a[9],o[10]=a[10],o[11]=a[11],o[12]=a[12],o[13]=a[13],o[14]=a[14],o[15]=a[15],o},_.clone$1=vn,_.collisionCircleLayout=Cc,_.config=yt,_.conjugate=function(a,o){return a[0]=-o[0],a[1]=-o[1],a[2]=-o[2],a[3]=o[3],a},_.create=function(){var a=new za(16);return za!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},_.create$1=M_,_.createExpression=Pl,_.createLayout=yn,_.createStyleLayer=function(a){return"custom"===a.type?new Rg(a):new _0[a.type](a)},_.cross=Mv,_.degToRad=Ct,_.distance=function(a,o){return Math.hypot(o[0]-a[0],o[1]-a[1],o[2]-a[2])},_.div=function(a,o,l){return a[0]=o[0]/l[0],a[1]=o[1]/l[1],a[2]=o[2]/l[2],a},_.dot=su,_.earthRadius=zd,_.ease=zt,_.easeCubicInOut=tt,_.ecefToLatLng=function([a,o,l]){const p=Math.hypot(a,o,l),y=Math.atan2(a,l),w=.5*Math.PI-Math.acos(-o/p);return new tr(Pt(y),Pt(w))},_.emitValidationErrors=Uu,_.endsWith=rr,_.enforceCacheSizeLimit=function(a){$r(),jr&&jr.then(o=>{o.keys().then(l=>{for(let p=0;p<l.length-a;p++)o.delete(l[p])})})},_.evaluateSizeForFeature=oy,_.evaluateSizeForZoom=Hf,_.evaluateVariableOffset=yy,_.evented=De,_.exactEquals=function(a,o){return a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]&&a[3]===o[3]},_.exactEquals$1=function(a,o){return a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]},_.exported=gi,_.exported$1=It,_.extend=gt,_.extend$1=Ao,_.fillExtrusionHeightLift=Jv,_.filterObject=zn,_.fromMat4=function(a,o){return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[4],a[4]=o[5],a[5]=o[6],a[6]=o[8],a[7]=o[9],a[8]=o[10],a},_.fromQuat=function(a,o){var l=o[0],p=o[1],y=o[2],w=o[3],E=l+l,M=p+p,k=y+y,F=l*E,U=p*E,z=p*M,Z=y*E,te=y*M,ie=y*k,K=w*E,pe=w*M,Ee=w*k;return a[0]=1-z-ie,a[1]=U+Ee,a[2]=Z-pe,a[3]=0,a[4]=U-Ee,a[5]=1-F-ie,a[6]=te+K,a[7]=0,a[8]=Z+pe,a[9]=te-K,a[10]=1-F-z,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},_.fromRotation=function(a,o){var l=Math.sin(o),p=Math.cos(o);return a[0]=p,a[1]=l,a[2]=0,a[3]=-l,a[4]=p,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},_.fromScaling=Gp,_.furthestTileCorner=function(a){const o=Math.round((a+45+360)%360/90)%4;return un[o]},_.getAABBPointSquareDist=function(a,o,l){let p=0;for(let y=0;y<2;++y){const w=l?l[y]:0;a[y]>w&&(p+=(a[y]-w)*(a[y]-w)),o[y]<w&&(p+=(w-o[y])*(w-o[y]))}return p},_.getAnchorAlignment=xg,_.getAnchorJustification=Hd,_.getBounds=function(a){let o=1/0,l=1/0,p=-1/0,y=-1/0;for(const w of a)o=Math.min(o,w.x),l=Math.min(l,w.y),p=Math.max(p,w.x),y=Math.max(y,w.y);return{min:new Ye(o,l),max:new Ye(p,y)}},_.getColumn=_s,_.getGridMatrix=function(a,o,l,p){const y=o.getNorth(),w=o.getSouth(),E=o.getWest(),M=o.getEast(),k=1<<a.z,F=M-E,U=y-w,z=F/64,Z=-U/Pf[l],te=[0,z,0,Z,0,0,y,E,0];if(a.z>0){const ie=180/p;Rh(te,te,[ie/F+1,0,0,0,ie/U+1,0,-.5*ie/z,.5*ie/Z,1])}return te[2]=k,te[5]=a.x,te[8]=a.y,te},_.getImage=Vs,_.getJSON=function(a,o){return Sr(gt(a,{type:"json"}),o)},_.getLatitudinalLod=function(a){const o=Eo-5;a=Bt(a,-o,o)/o*90;const l=Math.pow(Math.abs(Math.sin(Ct(a))),3);return Math.round(l*(Pf.length-1))},_.getMapSessionAPI=Be,_.getPerformanceMeasurement=En,_.getProjection=by,_.getRTLTextPluginStatus=Fe,_.getReferrer=Nr,_.getTilePoint=function(a,{x:o,y:l},p=0){return new Ye(((o-p)*a.scale-a.x)*Qn,(l*a.scale-a.y)*Qn)},_.getTileVec3=function(a,o,l=0){return Lh(((o.x-l)*a.scale-a.x)*Qn,(o.y*a.scale-a.y)*Qn,em(o.z,o.y))},_.getVideo=function(a,o){const l=$e.document.createElement("video");l.muted=!0,l.onloadstart=function(){o(null,l)};for(let p=0;p<a.length;p++){const y=$e.document.createElement("source");Do(a[p])||(l.crossOrigin="Anonymous"),y.src=a[p],l.appendChild(y)}return{cancel:()=>{}}},_.globeCenterToScreenPoint=function(a){const o=[0,0,0],l=_c(new Float64Array(16));return Ld(l,a.pixelMatrix,a.globeMatrix),mo(o,o,l),new Ye(o[0],o[1])},_.globeDenormalizeECEF=Lv,_.globeECEFOrigin=function(a,o){const l=[0,0,0];return mo(l,l,Qp(Vl(o.canonical))),mo(l,l,a),l},_.globeMetersToEcef=bc,_.globeNormalizeECEF=Qp,_.globePixelsToTileUnits=function(a,o){return Qn/(512*Math.pow(2,a))*L_(Vl(o))},_.globePoleMatrixForTile=function(a,o,l){const p=_c(new Float64Array(16)),y=(o/(1<<a)-.5)*Math.PI*2;return $p(p,l.globeMatrix,y),Float32Array.from(p)},_.globeTileBounds=Vl,_.globeTiltAtLngLat=Nv,_.globeToMercatorTransition=Jp,_.globeUseCustomAntiAliasing=function(a,o,l){const p=Jp(l.zoom),y=a.style.map._antialias,w=!!o.extStandardDerivatives,E=o.extStandardDerivativesForceOff||a.terrain&&a.terrain.exaggeration()>0;return 0===p&&!y&&!E&&w},_.identity=_c,_.identity$1=ix,_.invert=Xm,_.isFullscreen=function(){return!!$e.document.fullscreenElement||!!$e.document.webkitFullscreenElement},_.isLngLatBehindGlobe=tg,_.isMapAuthenticated=function(a){return Pe.has(a)},_.isMapboxURL=lo,_.isSafariWithAntialiasingBug=function(a){const o=a.navigator?a.navigator.userAgent:null;return!!so(a)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},_.latFromMercatorY=Qs,_.latLngToECEF=Qu,_.len=Dv,_.length=sl,_.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},_.lngFromMercatorX=Va,_.loadVectorTile=dC,_.makeRequest=Sr,_.mapValue=function(a,o,l,p,y){return Bt((a-o)/(l-o)*(y-p)+p,p,y)},_.mercatorScale=Rf,_.mercatorXfromLng=Ju,_.mercatorYfromLat=ed,_.mercatorZfromAltitude=Ul,_.mul=Hp,_.mul$1=P_,_.multiply=Ld,_.multiply$1=Rh,_.multiply$2=qp,_.nextPowerOfTwo=en,_.normalize=_a,_.normalize$1=kv,_.normalize$2=Pv,_.number=di,_.ortho=function(a,o,l,p,y,w,E){var M=1/(o-l),k=1/(p-y),F=1/(w-E);return a[0]=-2*M,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*k,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*F,a[11]=0,a[12]=(o+l)*M,a[13]=(y+p)*k,a[14]=(E+w)*F,a[15]=1,a},_.pbf=ko,_.perspective=function(a,o,l,p,y){var w,E=1/Math.tan(o/2);return a[0]=E/l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=E,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=y&&y!==1/0?(a[10]=(y+p)*(w=1/(p-y)),a[14]=2*y*p*w):(a[10]=-1,a[14]=-2*p),a},_.pick=function(a,o){const l={};for(let p=0;p<o.length;p++){const y=o[p];y in a&&(l[y]=a[y])}return l},_.plugin=Ue,_.pointGeometry=Ye,_.polesInViewport=function(a){const o=_c(new Float64Array(16));Ld(o,a.pixelMatrix,a.globeMatrix);const l=[0,Bl,0],p=[0,cl,0];return mo(l,l,o),mo(p,p,o),[l[0]>0&&l[0]<=a.width&&l[1]>0&&l[1]<=a.height&&!tg(a,new tr(a.center.lat,90)),p[0]>0&&p[0]<=a.width&&p[1]>0&&p[1]<=a.height&&!tg(a,new tr(a.center.lat,-90))]},_.polygonContainsPoint=Bd,_.polygonIntersectsBox=lx,_.polygonIntersectsPolygon=lu,_.polygonizeBounds=function(a,o,l=0,p=!0){const y=new Ye(l,l),w=a.sub(y),E=o.add(y),M=[w,new Ye(E.x,w.y),E,new Ye(w.x,E.y)];return p&&M.push(w.clone()),M},_.posAttributes=Zp,_.postMapLoadEvent=Y,_.postPerformanceEvent=fe,_.postTurnstileEvent=$,_.potpack=yg,_.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},_.radToDeg=Pt,_.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],_.registerForPluginStateChange=function(a){return a({pluginStatus:be,pluginURL:ce}),De.on("pluginStateChange",a),a},_.removeAuthState=function(a){Pe.delete(a)},_.renderColorRamp=Gv,_.resample=ng,_.rotateX=Nd,_.rotateX$1=Ov,_.rotateY=$p,_.rotateY$1=O_,_.rotateZ=function(a,o,l){var p=Math.sin(l),y=Math.cos(l),w=o[0],E=o[1],M=o[2],k=o[3],F=o[4],U=o[5],z=o[6],Z=o[7];return o!==a&&(a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=w*y+F*p,a[1]=E*y+U*p,a[2]=M*y+z*p,a[3]=k*y+Z*p,a[4]=F*y-w*p,a[5]=U*y-E*p,a[6]=z*y-M*p,a[7]=Z*y-k*p,a},_.rotateZ$1=function(a,o,l){l*=.5;var p=o[0],y=o[1],w=o[2],E=o[3],M=Math.sin(l),k=Math.cos(l);return a[0]=p*k+y*M,a[1]=y*k-p*M,a[2]=w*k+E*M,a[3]=E*k-w*M,a},_.scale=yc,_.scale$1=Av,_.scale$2=Hs,_.scaleAndAdd=Qm,_.set=function(a,o,l,p){return a[0]=o,a[1]=l,a[2]=p,a},_.setCacheLimits=function(a,o){zo=a,ls=o},_.setColumn=function(a,o,l){a[4*o+0]=l[0],a[4*o+1]=l[1],a[4*o+2]=l[2],a[4*o+3]=l[3]},_.setRTLTextPlugin=function(a,o,l=!1){if(be===de||be===ge||be===ue)throw new Error("setRTLTextPlugin cannot be called multiple times.");ce=gi.resolveURL(a),be=de,ye=o,ve(),l||Re()},_.smoothstep=an,_.spec=ut,_.squaredLength=function(a){var o=a[0],l=a[1],p=a[2];return o*o+l*l+p*p},_.storeAuthState=function(a,o){o?Pe.add(a):Pe.delete(a)},_.sub=al,_.subtract=Df,_.symbolSize=_g,_.tileAABB=function(a,o,l,p,y,w,E,M,k){if("globe"===k.name)return function F_(a,o,l){const p=o/a.worldSize,y=a.globeMatrix;if(l.z<=1){const rt=Vl(l).getCorners();return sx(rt,y,p),ya.fromPoints(rt)}const w=Kp(l),E=Xp(w);sx(E,y,p);const M=Number.MAX_VALUE,k=[-M,-M,-M],F=[M,M,M];if(w.contains(a.center)){for(const Gt of E)Ku(F,F,Gt),Af(k,k,Gt);k[2]=0;const rt=a.point,bt=[rt.x*p,rt.y*p,0];return Ku(F,F,bt),Af(k,k,bt),new ya(F,k)}const U=[y[12]*p,y[13]*p,y[14]*p],z=w.getCenter(),Z=Bt(a.center.lat,-Eo,Eo),te=Bt(z.lat,-Eo,Eo),ie=Ju(a.center.lng),K=ed(Z);let pe=ie-Ju(z.lng);const Ee=K-ed(te);pe>.5?pe-=1:pe<-.5&&(pe+=1);let xe=0;Math.abs(pe)>Math.abs(Ee)?xe=pe>=0?1:3:(xe=Ee>=0?0:2,Qm(U,U,[y[4]*p,y[5]*p,y[6]*p],-Math.sin(Ct(Ee>=0?w.getSouth():w.getNorth()))*ll));const we=E[xe],Ce=E[(xe+1)%4],Le=new rx(we,Ce,U),ke=[R_(Le,0)||we[0],R_(Le,1)||we[1],R_(Le,2)||we[2]],st=Jp(a.zoom);if(st>0){const rt=function({x:Gt,y:ht,z:Tt},xt,kt,At,ct){const ln=1/(1<<Tt);let Wn=Gt*ln,fn=Wn+ln,An=ht*ln,Wt=An+ln,ti=0;const Di=(Wn+fn)/2-At;return Di>.5?ti=-1:Di<-.5&&(ti=1),Wn=((Wn+ti)*xt-(At*=xt))*kt+At,fn=((fn+ti)*xt-At)*kt+At,An=(An*xt-(ct*=xt))*kt+ct,Wt=(Wt*xt-ct)*kt+ct,[[Wn,Wt,0],[fn,Wt,0],[fn,An,0],[Wn,An,0]]}(l,o,a._pixelsPerMercatorPixel,ie,K);for(let Gt=0;Gt<E.length;Gt++)Of(E[Gt],rt[Gt],st);const bt=Ba([],rt[xe],rt[(xe+1)%4]);Hs(bt,bt,.5),Of(ke,bt,st)}for(const rt of E)Ku(F,F,rt),Af(k,k,rt);return F[2]=Math.min(we[2],Ce[2]),Ku(F,F,ke),Af(k,k,ke),new ya(F,k)}(a,o,new e0(l,p,y));const F=xa({z:l,x:p,y},k);return new ya([(w+F.x/F.scale)*o,o*(F.y/F.scale),E],[(w+F.x2/F.scale)*o,o*(F.y2/F.scale),M])},_.tileCornersToBounds=Kp,_.tileTransform=xa,_.transformMat3=function(a,o,l){var p=o[0],y=o[1],w=o[2];return a[0]=p*l[0]+y*l[3]+w*l[6],a[1]=p*l[1]+y*l[4]+w*l[7],a[2]=p*l[2]+y*l[5]+w*l[8],a},_.transformMat4=mo,_.transformMat4$1=zl,_.transformQuat=tx,_.transitionTileAABBinECEF=ox,_.translate=Fh,_.transpose=function(a,o){if(a===o){var l=o[1],p=o[2],y=o[5];a[1]=o[3],a[2]=o[6],a[3]=l,a[5]=o[7],a[6]=p,a[7]=y}else a[0]=o[0],a[1]=o[3],a[2]=o[6],a[3]=o[1],a[4]=o[4],a[5]=o[7],a[6]=o[2],a[7]=o[5],a[8]=o[8];return a},_.triggerPluginCompletionEvent=Te,_.uniqueId=Ht,_.updateGlobeVertexNormal=function(a,o,l,p,y){const w=5*o+2;a.float32[w+0]=l,a.float32[w+1]=p,a.float32[w+2]=y},_.validateCustomStyleLayer=function(a){const o=[],l=a.id;return void 0===l&&o.push({message:`layers.${l}: missing required property "id"`}),void 0===a.render&&o.push({message:`layers.${l}: missing required method "render"`}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&o.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),o},_.validateFilter=a=>Rs(Bu(a)),_.validateFog=a=>Rs(Jc(a)),_.validateLayer=a=>Rs(yh(a)),_.validateLight=a=>Rs(xf(a)),_.validateSource=a=>Rs(da(a)),_.validateStyle=Cf,_.validateTerrain=a=>Rs(Rd(a)),_.values=mt,_.vectorTile=X_,_.version=ft,_.warnOnce=Pi,_.window=$e,_.wrap=oi}),Ne(0,function(_){function $e(ne){if("number"==typeof ne||"boolean"==typeof ne||"string"==typeof ne||null==ne)return JSON.stringify(ne);if(Array.isArray(ne)){let H="[";for(const Y of ne)H+=`${$e(Y)},`;return`${H}]`}let $="{";for(const H of Object.keys(ne).sort())$+=`${H}:${$e(ne[H])},`;return`${$}}`}function ft(ne){let $="";for(const H of _.refProperties)$+=`/${$e(ne[H])}`;return $}class on{constructor($){this.keyCache={},$&&this.replace($)}replace($){this._layerConfigs={},this._layers={},this.update($,[])}update($,H){for(const se of $)this._layerConfigs[se.id]=se,(this._layers[se.id]=_.createStyleLayer(se)).compileFilter(),this.keyCache[se.id]&&delete this.keyCache[se.id];for(const se of H)delete this.keyCache[se],delete this._layerConfigs[se],delete this._layers[se];this.familiesBySource={};const Y=function(se,fe){const Oe={};for(let Pe=0;Pe<se.length;Pe++){const He=fe&&fe[se[Pe].id]||ft(se[Pe]);fe&&(fe[se[Pe].id]=He);let it=Oe[He];it||(it=Oe[He]=[]),it.push(se[Pe])}const Be=[];for(const Pe in Oe)Be.push(Oe[Pe]);return Be}(_.values(this._layerConfigs),this.keyCache);for(const se of Y){const fe=se.map(jt=>this._layers[jt.id]),Oe=fe[0];if("none"===Oe.visibility)continue;const Be=Oe.source||"";let Pe=this.familiesBySource[Be];Pe||(Pe=this.familiesBySource[Be]={});const He=Oe.sourceLayer||"_geojsonTileLayer";let it=Pe[He];it||(it=Pe[He]=[]),it.push(fe)}}}class yt{loadTile($,H){const{uid:Y,encoding:se,rawImageData:fe,padding:Oe,buildQuadTree:Be}=$,Pe=_.window.ImageBitmap&&fe instanceof _.window.ImageBitmap?this.getImageData(fe,Oe):fe;H(null,new _.DEMData(Y,Pe,se,Oe<1,Be))}getImageData($,H){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas($.width,$.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=$.width,this.offscreenCanvas.height=$.height,this.offscreenCanvasContext.drawImage($,0,0,$.width,$.height);const Y=this.offscreenCanvasContext.getImageData(-H,-H,$.width+2*H,$.height+2*H);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Y}}var It=function ne($,H){var Y,se=$&&$.type;if("FeatureCollection"===se)for(Y=0;Y<$.features.length;Y++)ne($.features[Y],H);else if("GeometryCollection"===se)for(Y=0;Y<$.geometries.length;Y++)ne($.geometries[Y],H);else if("Feature"===se)ne($.geometry,H);else if("Polygon"===se)Ve($.coordinates,H);else if("MultiPolygon"===se)for(Y=0;Y<$.coordinates.length;Y++)Ve($.coordinates[Y],H);return $};function Ve(ne,$){if(0!==ne.length){je(ne[0],$);for(var H=1;H<ne.length;H++)je(ne[H],!$)}}function je(ne,$){for(var H=0,Y=0,se=0,fe=ne.length,Oe=fe-1;se<fe;Oe=se++){var Be=(ne[se][0]-ne[Oe][0])*(ne[Oe][1]+ne[se][1]),Pe=H+Be;Y+=Math.abs(H)>=Math.abs(Be)?H-Pe+Be:Be-Pe+H,H=Pe}H+Y>=0!=!!$&&ne.reverse()}const Ke=_.VectorTileFeature.prototype.toGeoJSON;class pn{constructor($){this._feature=$,this.extent=_.EXTENT,this.type=$.type,this.properties=$.tags,"id"in $&&!isNaN($.id)&&(this.id=parseInt($.id,10))}loadGeometry(){if(1===this._feature.type){const $=[];for(const H of this._feature.geometry)$.push([new _.pointGeometry(H[0],H[1])]);return $}{const $=[];for(const H of this._feature.geometry){const Y=[];for(const se of H)Y.push(new _.pointGeometry(se[0],se[1]));$.push(Y)}return $}}toGeoJSON($,H,Y){return Ke.call(this,$,H,Y)}}class tn{constructor($){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=_.EXTENT,this.length=$.length,this._features=$}feature($){return new pn(this._features[$])}}var bn={},Dn={get exports(){return bn},set exports(ne){bn=ne}},vt=_.pointGeometry,Ye=_.vectorTile.VectorTileFeature,Ft=Jt;function Jt(ne,$){this.options=$||{},this.features=ne,this.length=ne.length}function Xt(ne,$){this.id="number"==typeof ne.id?ne.id:void 0,this.type=ne.type,this.rawGeometry=1===ne.type?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=$||4096}Jt.prototype.feature=function(ne){return new Xt(this.features[ne],this.options.extent)},Xt.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var $=0;$<ne.length;$++){for(var H=ne[$],Y=[],se=0;se<H.length;se++)Y.push(new vt(H[se][0],H[se][1]));this.geometry.push(Y)}return this.geometry},Xt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,$=1/0,H=-1/0,Y=1/0,se=-1/0,fe=0;fe<ne.length;fe++)for(var Oe=ne[fe],Be=0;Be<Oe.length;Be++){var Pe=Oe[Be];$=Math.min($,Pe.x),H=Math.max(H,Pe.x),Y=Math.min(Y,Pe.y),se=Math.max(se,Pe.y)}return[$,Y,H,se]},Xt.prototype.toGeoJSON=Ye.prototype.toGeoJSON;var Ct=_.pbf,Pt=Ft;function un(ne){var $=new Ct;return function(H,Y){for(var se in H.layers)Y.writeMessage(3,tt,H.layers[se])}(ne,$),$.finish()}function tt(ne,$){var H;$.writeVarintField(15,ne.version||1),$.writeStringField(1,ne.name||""),$.writeVarintField(5,ne.extent||4096);var Y={keys:[],values:[],keycache:{},valuecache:{}};for(H=0;H<ne.length;H++)Y.feature=ne.feature(H),$.writeMessage(2,pt,Y);var se=Y.keys;for(H=0;H<se.length;H++)$.writeStringField(3,se[H]);var fe=Y.values;for(H=0;H<fe.length;H++)$.writeMessage(4,On,fe[H])}function pt(ne,$){var H=ne.feature;void 0!==H.id&&$.writeVarintField(1,H.id),$.writeMessage(2,zt,ne),$.writeVarintField(3,H.type),$.writeMessage(4,oi,H)}function zt(ne,$){var H=ne.feature,Y=ne.keys,se=ne.values,fe=ne.keycache,Oe=ne.valuecache;for(var Be in H.properties){var Pe=H.properties[Be],He=fe[Be];if(null!==Pe){void 0===He&&(Y.push(Be),fe[Be]=He=Y.length-1),$.writeVarint(He);var it=typeof Pe;"string"!==it&&"boolean"!==it&&"number"!==it&&(Pe=JSON.stringify(Pe));var jt=it+":"+Pe,_t=Oe[jt];void 0===_t&&(se.push(Pe),Oe[jt]=_t=se.length-1),$.writeVarint(_t)}}}function Bt(ne,$){return($<<3)+(7&ne)}function an(ne){return ne<<1^ne>>31}function oi(ne,$){for(var H=ne.loadGeometry(),Y=ne.type,se=0,fe=0,Oe=H.length,Be=0;Be<Oe;Be++){var Pe=H[Be],He=1;1===Y&&(He=Pe.length),$.writeVarint(Bt(1,He));for(var it=3===Y?Pe.length-1:Pe.length,jt=0;jt<it;jt++){1===jt&&1!==Y&&$.writeVarint(Bt(2,it-1));var _t=Pe[jt].x-se,En=Pe[jt].y-fe;$.writeVarint(an(_t)),$.writeVarint(an(En)),se+=_t,fe+=En}3===Y&&$.writeVarint(Bt(7,1))}}function On(ne,$){var H=typeof ne;"string"===H?$.writeStringField(1,ne):"boolean"===H?$.writeBooleanField(7,ne):"number"===H&&(ne%1!=0?$.writeDoubleField(3,ne):ne<0?$.writeSVarintField(6,ne):$.writeVarintField(5,ne))}function mt(ne,$,H,Y,se,fe){if(se-Y<=H)return;const Oe=Y+se>>1;gt(ne,$,Oe,Y,se,fe%2),mt(ne,$,H,Y,Oe-1,fe+1),mt(ne,$,H,Oe+1,se,fe+1)}function gt(ne,$,H,Y,se,fe){for(;se>Y;){if(se-Y>600){const He=se-Y+1,it=H-Y+1,jt=Math.log(He),_t=.5*Math.exp(2*jt/3),En=.5*Math.sqrt(jt*_t*(He-_t)/He)*(it-He/2<0?-1:1);gt(ne,$,H,Math.max(Y,Math.floor(H-it*_t/He+En)),Math.min(se,Math.floor(H+(He-it)*_t/He+En)),fe)}const Oe=$[2*H+fe];let Be=Y,Pe=se;for(Dt(ne,$,Y,H),$[2*se+fe]>Oe&&Dt(ne,$,Y,se);Be<Pe;){for(Dt(ne,$,Be,Pe),Be++,Pe--;$[2*Be+fe]<Oe;)Be++;for(;$[2*Pe+fe]>Oe;)Pe--}$[2*Y+fe]===Oe?Dt(ne,$,Y,Pe):(Pe++,Dt(ne,$,Pe,se)),Pe<=H&&(Y=Pe+1),H<=Pe&&(se=Pe-1)}}function Dt(ne,$,H,Y){Ht(ne,H,Y),Ht($,2*H,2*Y),Ht($,2*H+1,2*Y+1)}function Ht(ne,$,H){const Y=ne[$];ne[$]=ne[H],ne[H]=Y}function nn(ne,$,H,Y){const se=ne-H,fe=$-Y;return se*se+fe*fe}Dn.exports=un,bn.fromVectorTileJs=un,bn.fromGeojsonVt=function(ne,$){$=$||{};var H={};for(var Y in ne)H[Y]=new Pt(ne[Y].features,$),H[Y].name=Y,H[Y].version=$.version,H[Y].extent=$.extent;return un({layers:H})},bn.GeoJSONWrapper=Pt;const en=ne=>ne[0],wn=ne=>ne[1];class Cn{constructor($,H=en,Y=wn,se=64,fe=Float64Array){this.nodeSize=se,this.points=$;const Oe=$.length<65536?Uint16Array:Uint32Array,Be=this.ids=new Oe($.length),Pe=this.coords=new fe(2*$.length);for(let He=0;He<$.length;He++)Be[He]=He,Pe[2*He]=H($[He]),Pe[2*He+1]=Y($[He]);mt(Be,Pe,se,0,Be.length-1,0)}range($,H,Y,se){return function(fe,Oe,Be,Pe,He,it,jt){const _t=[0,fe.length-1,0],En=[];let Ln,Fn;for(;_t.length;){const ni=_t.pop(),Ci=_t.pop(),gi=_t.pop();if(Ci-gi<=jt){for(let fr=gi;fr<=Ci;fr++)Ln=Oe[2*fr],Fn=Oe[2*fr+1],Ln>=Be&&Ln<=He&&Fn>=Pe&&Fn<=it&&En.push(fe[fr]);continue}const $n=Math.floor((gi+Ci)/2);Ln=Oe[2*$n],Fn=Oe[2*$n+1],Ln>=Be&&Ln<=He&&Fn>=Pe&&Fn<=it&&En.push(fe[$n]);const hr=(ni+1)%2;(0===ni?Be<=Ln:Pe<=Fn)&&(_t.push(gi),_t.push($n-1),_t.push(hr)),(0===ni?He>=Ln:it>=Fn)&&(_t.push($n+1),_t.push(Ci),_t.push(hr))}return En}(this.ids,this.coords,$,H,Y,se,this.nodeSize)}within($,H,Y){return function(se,fe,Oe,Be,Pe,He){const it=[0,se.length-1,0],jt=[],_t=Pe*Pe;for(;it.length;){const En=it.pop(),Ln=it.pop(),Fn=it.pop();if(Ln-Fn<=He){for(let hr=Fn;hr<=Ln;hr++)nn(fe[2*hr],fe[2*hr+1],Oe,Be)<=_t&&jt.push(se[hr]);continue}const ni=Math.floor((Fn+Ln)/2),Ci=fe[2*ni],gi=fe[2*ni+1];nn(Ci,gi,Oe,Be)<=_t&&jt.push(se[ni]);const $n=(En+1)%2;(0===En?Oe-Pe<=Ci:Be-Pe<=gi)&&(it.push(Fn),it.push(ni-1),it.push($n)),(0===En?Oe+Pe>=Ci:Be+Pe>=gi)&&(it.push(ni+1),it.push(Ln),it.push($n))}return jt}(this.ids,this.coords,$,H,Y,this.nodeSize)}}const rr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ne=>ne},qn=Math.fround||(zn=new Float32Array(1),ne=>(zn[0]=+ne,zn[0]));var zn;class vn{constructor($){this.options=so(Object.create(rr),$),this.trees=new Array(this.options.maxZoom+1)}load($){const{log:H,minZoom:Y,maxZoom:se,nodeSize:fe}=this.options;H&&console.time("total time");const Oe=`prepare ${$.length} points`;H&&console.time(Oe),this.points=$;let Be=[];for(let Pe=0;Pe<$.length;Pe++)$[Pe].geometry&&Be.push(Pi($[Pe],Pe));this.trees[se+1]=new Cn(Be,Ds,_s,fe,Float32Array),H&&console.timeEnd(Oe);for(let Pe=se;Pe>=Y;Pe--){const He=+Date.now();Be=this._cluster(Be,Pe),this.trees[Pe]=new Cn(Be,Ds,_s,fe,Float32Array),H&&console.log("z%d: %d clusters in %dms",Pe,Be.length,+Date.now()-He)}return H&&console.timeEnd("total time"),this}getClusters($,H){let Y=(($[0]+180)%360+360)%360-180;const se=Math.max(-90,Math.min(90,$[1]));let fe=180===$[2]?180:(($[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)Y=-180,fe=180;else if(Y>fe){const it=this.getClusters([Y,se,180,Oe],H),jt=this.getClusters([-180,se,fe,Oe],H);return it.concat(jt)}const Be=this.trees[this._limitZoom(H)],Pe=Be.range(kr(Y),oo(Oe),kr(fe),oo(se)),He=[];for(const it of Pe){const jt=Be.points[it];He.push(jt.numPoints?dr(jt):this.points[jt.index])}return He}getChildren($){const H=this._getOriginId($),Y=this._getOriginZoom($),se="No cluster with the specified id.",fe=this.trees[Y];if(!fe)throw new Error(se);const Oe=fe.points[H];if(!Oe)throw new Error(se);const Be=this.options.radius/(this.options.extent*Math.pow(2,Y-1)),Pe=fe.within(Oe.x,Oe.y,Be),He=[];for(const it of Pe){const jt=fe.points[it];jt.parentId===$&&He.push(jt.numPoints?dr(jt):this.points[jt.index])}if(0===He.length)throw new Error(se);return He}getLeaves($,H,Y){const se=[];return this._appendLeaves(se,$,H=H||10,Y=Y||0,0),se}getTile($,H,Y){const se=this.trees[this._limitZoom($)],fe=Math.pow(2,$),{extent:Oe,radius:Be}=this.options,Pe=Be/Oe,He=(Y-Pe)/fe,it=(Y+1+Pe)/fe,jt={features:[]};return this._addTileFeatures(se.range((H-Pe)/fe,He,(H+1+Pe)/fe,it),se.points,H,Y,fe,jt),0===H&&this._addTileFeatures(se.range(1-Pe/fe,He,1,it),se.points,fe,Y,fe,jt),H===fe-1&&this._addTileFeatures(se.range(0,He,Pe/fe,it),se.points,-1,Y,fe,jt),jt.features.length?jt:null}getClusterExpansionZoom($){let H=this._getOriginZoom($)-1;for(;H<=this.options.maxZoom;){const Y=this.getChildren($);if(H++,1!==Y.length)break;$=Y[0].properties.cluster_id}return H}_appendLeaves($,H,Y,se,fe){const Oe=this.getChildren(H);for(const Be of Oe){const Pe=Be.properties;if(Pe&&Pe.cluster?fe+Pe.point_count<=se?fe+=Pe.point_count:fe=this._appendLeaves($,Pe.cluster_id,Y,se,fe):fe<se?fe++:$.push(Be),$.length===Y)break}return fe}_addTileFeatures($,H,Y,se,fe,Oe){for(const Be of $){const Pe=H[Be],He=Pe.numPoints;let it,jt,_t;if(He)it=Vn(Pe),jt=Pe.x,_t=Pe.y;else{const Fn=this.points[Pe.index];it=Fn.properties,jt=kr(Fn.geometry.coordinates[0]),_t=oo(Fn.geometry.coordinates[1])}const En={type:1,geometry:[[Math.round(this.options.extent*(jt*fe-Y)),Math.round(this.options.extent*(_t*fe-se))]],tags:it};let Ln;He?Ln=Pe.id:this.options.generateId?Ln=Pe.index:this.points[Pe.index].id&&(Ln=this.points[Pe.index].id),void 0!==Ln&&(En.id=Ln),Oe.features.push(En)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,H){const Y=[],{radius:se,extent:fe,reduce:Oe,minPoints:Be}=this.options,Pe=se/(fe*Math.pow(2,H));for(let He=0;He<$.length;He++){const it=$[He];if(it.zoom<=H)continue;it.zoom=H;const jt=this.trees[H+1],_t=jt.within(it.x,it.y,Pe),En=it.numPoints||1;let Ln=En;for(const Fn of _t){const ni=jt.points[Fn];ni.zoom>H&&(Ln+=ni.numPoints||1)}if(Ln>En&&Ln>=Be){let Fn=it.x*En,ni=it.y*En,Ci=Oe&&En>1?this._map(it,!0):null;const gi=(He<<5)+(H+1)+this.points.length;for(const $n of _t){const hr=jt.points[$n];if(hr.zoom<=H)continue;hr.zoom=H;const fr=hr.numPoints||1;Fn+=hr.x*fr,ni+=hr.y*fr,hr.parentId=gi,Oe&&(Ci||(Ci=this._map(it,!0)),Oe(Ci,this._map(hr)))}it.parentId=gi,Y.push(Qi(Fn/Ln,ni/Ln,gi,Ln,Ci))}else if(Y.push(it),Ln>1)for(const Fn of _t){const ni=jt.points[Fn];ni.zoom<=H||(ni.zoom=H,Y.push(ni))}}return Y}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,H){if($.numPoints)return H?so({},$.properties):$.properties;const Y=this.points[$.index].properties,se=this.options.map(Y);return H&&se===Y?so({},se):se}}function Qi(ne,$,H,Y,se){return{x:qn(ne),y:qn($),zoom:1/0,id:H,parentId:-1,numPoints:Y,properties:se}}function Pi(ne,$){const[H,Y]=ne.geometry.coordinates;return{x:qn(kr(H)),y:qn(oo(Y)),zoom:1/0,index:$,parentId:-1}}function dr(ne){return{type:"Feature",id:ne.id,properties:Vn(ne),geometry:{type:"Point",coordinates:[($=ne.x,360*($-.5)),Ms(ne.y)]}};var $}function Vn(ne){const $=ne.numPoints,H=$>=1e4?`${Math.round($/1e3)}k`:$>=1e3?Math.round($/100)/10+"k":$;return so(so({},ne.properties),{cluster:!0,cluster_id:ne.id,point_count:$,point_count_abbreviated:H})}function kr(ne){return ne/360+.5}function oo(ne){const $=Math.sin(ne*Math.PI/180),H=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return H<0?0:H>1?1:H}function Ms(ne){const $=(180-360*ne)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function so(ne,$){for(const H in $)ne[H]=$[H];return ne}function Ds(ne){return ne.x}function _s(ne){return ne.y}function Ir(ne,$,H,Y){for(var se,fe=Y,Oe=H-$>>1,Be=H-$,Pe=ne[$],He=ne[$+1],it=ne[H],jt=ne[H+1],_t=$+3;_t<H;_t+=3){var En=jr(ne[_t],ne[_t+1],Pe,He,it,jt);if(En>fe)se=_t,fe=En;else if(En===fe){var Ln=Math.abs(_t-Oe);Ln<Be&&(se=_t,Be=Ln)}}fe>Y&&(se-$>3&&Ir(ne,$,se,Y),ne[se+2]=fe,H-se>3&&Ir(ne,se,H,Y))}function jr(ne,$,H,Y,se,fe){var Oe=se-H,Be=fe-Y;if(0!==Oe||0!==Be){var Pe=((ne-H)*Oe+($-Y)*Be)/(Oe*Oe+Be*Be);Pe>1?(H=se,Y=fe):Pe>0&&(H+=Oe*Pe,Y+=Be*Pe)}return(Oe=ne-H)*Oe+(Be=$-Y)*Be}function In(ne,$,H,Y){var se={id:void 0===ne?null:ne,type:$,geometry:H,tags:Y,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(fe){var Oe=fe.geometry,Be=fe.type;if("Point"===Be||"MultiPoint"===Be||"LineString"===Be)zo(fe,Oe);else if("Polygon"===Be||"MultiLineString"===Be)for(var Pe=0;Pe<Oe.length;Pe++)zo(fe,Oe[Pe]);else if("MultiPolygon"===Be)for(Pe=0;Pe<Oe.length;Pe++)for(var He=0;He<Oe[Pe].length;He++)zo(fe,Oe[Pe][He])}(se),se}function zo(ne,$){for(var H=0;H<$.length;H+=3)ne.minX=Math.min(ne.minX,$[H]),ne.minY=Math.min(ne.minY,$[H+1]),ne.maxX=Math.max(ne.maxX,$[H]),ne.maxY=Math.max(ne.maxY,$[H+1])}function ls(ne,$,H,Y){if($.geometry){var se=$.geometry.coordinates,fe=$.geometry.type,Oe=Math.pow(H.tolerance/((1<<H.maxZoom)*H.extent),2),Be=[],Pe=$.id;if(H.promoteId?Pe=$.properties[H.promoteId]:H.generateId&&(Pe=Y||0),"Point"===fe)vo(se,Be);else if("MultiPoint"===fe)for(var He=0;He<se.length;He++)vo(se[He],Be);else if("LineString"===fe)$r(se,Be,Oe,!1);else if("MultiLineString"===fe){if(H.lineMetrics){for(He=0;He<se.length;He++)$r(se[He],Be=[],Oe,!1),ne.push(In(Pe,"LineString",Be,$.properties));return}cs(se,Be,Oe,!1)}else if("Polygon"===fe)cs(se,Be,Oe,!0);else{if("MultiPolygon"!==fe){if("GeometryCollection"===fe){for(He=0;He<$.geometry.geometries.length;He++)ls(ne,{id:Pe,geometry:$.geometry.geometries[He],properties:$.properties},H,Y);return}throw new Error("Input data is not a valid GeoJSON object.")}for(He=0;He<se.length;He++){var it=[];cs(se[He],it,Oe,!0),Be.push(it)}}ne.push(In(Pe,fe,Be,$.properties))}}function vo(ne,$){$.push(pi(ne[0])),$.push(jn(ne[1])),$.push(0)}function $r(ne,$,H,Y){for(var se,fe,Oe=0,Be=0;Be<ne.length;Be++){var Pe=pi(ne[Be][0]),He=jn(ne[Be][1]);$.push(Pe),$.push(He),$.push(0),Be>0&&(Oe+=Y?(se*He-Pe*fe)/2:Math.sqrt(Math.pow(Pe-se,2)+Math.pow(He-fe,2))),se=Pe,fe=He}var it=$.length-3;$[2]=1,Ir($,0,it,H),$[it+2]=1,$.size=Math.abs(Oe),$.start=0,$.end=$.size}function cs(ne,$,H,Y){for(var se=0;se<ne.length;se++){var fe=[];$r(ne[se],fe,H,Y),$.push(fe)}}function pi(ne){return ne/360+.5}function jn(ne){var $=Math.sin(ne*Math.PI/180),H=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return H<0?0:H>1?1:H}function Kn(ne,$,H,Y,se,fe,Oe,Be){if(Y/=$,fe>=(H/=$)&&Oe<Y)return ne;if(Oe<H||fe>=Y)return null;for(var Pe=[],He=0;He<ne.length;He++){var it=ne[He],jt=it.geometry,_t=it.type,En=0===se?it.minX:it.minY,Ln=0===se?it.maxX:it.maxY;if(En>=H&&Ln<Y)Pe.push(it);else if(!(Ln<H||En>=Y)){var Fn=[];if("Point"===_t||"MultiPoint"===_t)Nr(jt,Fn,H,Y,se);else if("LineString"===_t)Sr(jt,Fn,H,Y,se,!1,Be.lineMetrics);else if("MultiLineString"===_t)Do(jt,Fn,H,Y,se,!1);else if("Polygon"===_t)Do(jt,Fn,H,Y,se,!0);else if("MultiPolygon"===_t)for(var ni=0;ni<jt.length;ni++){var Ci=[];Do(jt[ni],Ci,H,Y,se,!0),Ci.length&&Fn.push(Ci)}if(Fn.length){if(Be.lineMetrics&&"LineString"===_t){for(ni=0;ni<Fn.length;ni++)Pe.push(In(it.id,_t,Fn[ni],it.tags));continue}"LineString"!==_t&&"MultiLineString"!==_t||(1===Fn.length?(_t="LineString",Fn=Fn[0]):_t="MultiLineString"),"Point"!==_t&&"MultiPoint"!==_t||(_t=3===Fn.length?"Point":"MultiPoint"),Pe.push(In(it.id,_t,Fn,it.tags))}}}return Pe.length?Pe:null}function Nr(ne,$,H,Y,se){for(var fe=0;fe<ne.length;fe+=3){var Oe=ne[fe+se];Oe>=H&&Oe<=Y&&($.push(ne[fe]),$.push(ne[fe+1]),$.push(ne[fe+2]))}}function Sr(ne,$,H,Y,se,fe,Oe){for(var Be,Pe,He=Xr(ne),it=0===se?ys:wi,jt=ne.start,_t=0;_t<ne.length-3;_t+=3){var En=ne[_t],Ln=ne[_t+1],Fn=ne[_t+2],ni=ne[_t+3],Ci=ne[_t+4],gi=0===se?En:Ln,$n=0===se?ni:Ci,hr=!1;Oe&&(Be=Math.sqrt(Math.pow(En-ni,2)+Math.pow(Ln-Ci,2))),gi<H?$n>H&&(Pe=it(He,En,Ln,ni,Ci,H),Oe&&(He.start=jt+Be*Pe)):gi>Y?$n<Y&&(Pe=it(He,En,Ln,ni,Ci,Y),Oe&&(He.start=jt+Be*Pe)):ao(He,En,Ln,Fn),$n<H&&gi>=H&&(Pe=it(He,En,Ln,ni,Ci,H),hr=!0),$n>Y&&gi<=Y&&(Pe=it(He,En,Ln,ni,Ci,Y),hr=!0),!fe&&hr&&(Oe&&(He.end=jt+Be*Pe),$.push(He),He=Xr(ne)),Oe&&(jt+=Be)}var fr=ne.length-3;En=ne[fr],Ln=ne[fr+1],Fn=ne[fr+2],(gi=0===se?En:Ln)>=H&&gi<=Y&&ao(He,En,Ln,Fn),fr=He.length-3,fe&&fr>=3&&(He[fr]!==He[0]||He[fr+1]!==He[1])&&ao(He,He[0],He[1],He[2]),He.length&&$.push(He)}function Xr(ne){var $=[];return $.size=ne.size,$.start=ne.start,$.end=ne.end,$}function Do(ne,$,H,Y,se,fe){for(var Oe=0;Oe<ne.length;Oe++)Sr(ne[Oe],$,H,Y,se,fe,!1)}function ao(ne,$,H,Y){ne.push($),ne.push(H),ne.push(Y)}function ys(ne,$,H,Y,se,fe){var Oe=(fe-$)/(Y-$);return ne.push(fe),ne.push(H+(se-H)*Oe),ne.push(1),Oe}function wi(ne,$,H,Y,se,fe){var Oe=(fe-H)/(se-H);return ne.push($+(Y-$)*Oe),ne.push(fe),ne.push(1),Oe}function Vs(ne,$){for(var H=[],Y=0;Y<ne.length;Y++){var se,fe=ne[Y],Oe=fe.type;if("Point"===Oe||"MultiPoint"===Oe||"LineString"===Oe)se=Ei(fe.geometry,$);else if("MultiLineString"===Oe||"Polygon"===Oe){se=[];for(var Be=0;Be<fe.geometry.length;Be++)se.push(Ei(fe.geometry[Be],$))}else if("MultiPolygon"===Oe)for(se=[],Be=0;Be<fe.geometry.length;Be++){for(var Pe=[],He=0;He<fe.geometry[Be].length;He++)Pe.push(Ei(fe.geometry[Be][He],$));se.push(Pe)}H.push(In(fe.id,Oe,se,fe.tags))}return H}function Ei(ne,$){var H=[];H.size=ne.size,void 0!==ne.start&&(H.start=ne.start,H.end=ne.end);for(var Y=0;Y<ne.length;Y+=3)H.push(ne[Y]+$,ne[Y+1],ne[Y+2]);return H}function lo(ne,$){if(ne.transformed)return ne;var H,Y,se,fe=1<<ne.z,Oe=ne.x,Be=ne.y;for(H=0;H<ne.features.length;H++){var Pe=ne.features[H],He=Pe.geometry,it=Pe.type;if(Pe.geometry=[],1===it)for(Y=0;Y<He.length;Y+=2)Pe.geometry.push(Hr(He[Y],He[Y+1],$,fe,Oe,Be));else for(Y=0;Y<He.length;Y++){var jt=[];for(se=0;se<He[Y].length;se+=2)jt.push(Hr(He[Y][se],He[Y][se+1],$,fe,Oe,Be));Pe.geometry.push(jt)}}return ne.transformed=!0,ne}function Hr(ne,$,H,Y,se,fe){return[Math.round(H*(ne*Y-se)),Math.round(H*($*Y-fe))]}function cn(ne,$,H,Y,se){for(var fe=$===se.maxZoom?0:se.tolerance/((1<<$)*se.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:H,y:Y,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Be=0;Be<ne.length;Be++){Oe.numFeatures++,Vt(Oe,ne[Be],fe,se);var Pe=ne[Be].minX,He=ne[Be].minY,it=ne[Be].maxX,jt=ne[Be].maxY;Pe<Oe.minX&&(Oe.minX=Pe),He<Oe.minY&&(Oe.minY=He),it>Oe.maxX&&(Oe.maxX=it),jt>Oe.maxY&&(Oe.maxY=jt)}return Oe}function Vt(ne,$,H,Y){var se=$.geometry,fe=$.type,Oe=[];if("Point"===fe||"MultiPoint"===fe)for(var Be=0;Be<se.length;Be+=3)Oe.push(se[Be]),Oe.push(se[Be+1]),ne.numPoints++,ne.numSimplified++;else if("LineString"===fe)Sn(Oe,se,ne,H,!1,!1);else if("MultiLineString"===fe||"Polygon"===fe)for(Be=0;Be<se.length;Be++)Sn(Oe,se[Be],ne,H,"Polygon"===fe,0===Be);else if("MultiPolygon"===fe)for(var Pe=0;Pe<se.length;Pe++){var He=se[Pe];for(Be=0;Be<He.length;Be++)Sn(Oe,He[Be],ne,H,!0,0===Be)}if(Oe.length){var it=$.tags||null;if("LineString"===fe&&Y.lineMetrics){for(var jt in it={},$.tags)it[jt]=$.tags[jt];it.mapbox_clip_start=se.start/se.size,it.mapbox_clip_end=se.end/se.size}var _t={geometry:Oe,type:"Polygon"===fe||"MultiPolygon"===fe?3:"LineString"===fe||"MultiLineString"===fe?2:1,tags:it};null!==$.id&&(_t.id=$.id),ne.features.push(_t)}}function Sn(ne,$,H,Y,se,fe){var Oe=Y*Y;if(Y>0&&$.size<(se?Oe:Y))H.numPoints+=$.length/3;else{for(var Be=[],Pe=0;Pe<$.length;Pe+=3)(0===Y||$[Pe+2]>Oe)&&(H.numSimplified++,Be.push($[Pe]),Be.push($[Pe+1])),H.numPoints++;se&&function(He,it){for(var jt=0,_t=0,En=He.length,Ln=En-2;_t<En;Ln=_t,_t+=2)jt+=(He[_t]-He[Ln])*(He[_t+1]+He[Ln+1]);if(jt>0===it)for(_t=0,En=He.length;_t<En/2;_t+=2){var Fn=He[_t],ni=He[_t+1];He[_t]=He[En-2-_t],He[_t+1]=He[En-1-_t],He[En-2-_t]=Fn,He[En-1-_t]=ni}}(Be,fe),ne.push(Be)}}function Zn(ne,$){var H=($=this.options=function(se,fe){for(var Oe in fe)se[Oe]=fe[Oe];return se}(Object.create(this.options),$)).debug;if(H&&console.time("preprocess data"),$.maxZoom<0||$.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if($.promoteId&&$.generateId)throw new Error("promoteId and generateId cannot be used together.");var se,fe,Oe,Be,Pe,He,Y=function(se,fe){var Oe=[];if("FeatureCollection"===se.type)for(var Be=0;Be<se.features.length;Be++)ls(Oe,se.features[Be],fe,Be);else ls(Oe,"Feature"===se.type?se:{geometry:se},fe);return Oe}(ne,$);this.tiles={},this.tileCoords=[],H&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",$.indexMaxZoom,$.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Be=se=Y,Pe=Kn(se,1,-1-(Oe=(fe=$).buffer/fe.extent),Oe,0,-1,2,fe),He=Kn(se,1,1-Oe,2+Oe,0,-1,2,fe),(Pe||He)&&(Be=Kn(se,1,-Oe,1+Oe,0,-1,2,fe)||[],Pe&&(Be=Vs(Pe,1).concat(Be)),He&&(Be=Be.concat(Vs(He,-1)))),(Y=Be).length&&this.splitTile(Y,0,0,0),H&&(Y.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ei(ne,$,H){return 32*((1<<ne)*H+$)+ne}function ki(ne,$){const H=ne.tileID.canonical;if(!this._geoJSONIndex)return $(null,null);const Y=this._geoJSONIndex.getTile(H.z,H.x,H.y);if(!Y)return $(null,null);const se=new tn(Y.features);let fe=bn(se);0===fe.byteOffset&&fe.byteLength===fe.buffer.byteLength||(fe=new Uint8Array(fe)),$(null,{vectorTile:se,rawData:fe.buffer})}Zn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Zn.prototype.splitTile=function(ne,$,H,Y,se,fe,Oe){for(var Be=[ne,$,H,Y],Pe=this.options,He=Pe.debug;Be.length;){Y=Be.pop(),H=Be.pop(),$=Be.pop(),ne=Be.pop();var it=1<<$,jt=ei($,H,Y),_t=this.tiles[jt];if(!_t&&(He>1&&console.time("creation"),_t=this.tiles[jt]=cn(ne,$,H,Y,Pe),this.tileCoords.push({z:$,x:H,y:Y}),He)){He>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",$,H,Y,_t.numFeatures,_t.numPoints,_t.numSimplified),console.timeEnd("creation"));var En="z"+$;this.stats[En]=(this.stats[En]||0)+1,this.total++}if(_t.source=ne,se){if($===Pe.maxZoom||$===se)continue;var Ln=1<<se-$;if(H!==Math.floor(fe/Ln)||Y!==Math.floor(Oe/Ln))continue}else if($===Pe.indexMaxZoom||_t.numPoints<=Pe.indexMaxPoints)continue;if(_t.source=null,0!==ne.length){He>1&&console.time("clipping");var Fn,ni,Ci,gi,$n,hr,fr=.5*Pe.buffer/Pe.extent,Zi=.5-fr,Rr=.5+fr,ut=1+fr;Fn=ni=Ci=gi=null,$n=Kn(ne,it,H-fr,H+Rr,0,_t.minX,_t.maxX,Pe),hr=Kn(ne,it,H+Zi,H+ut,0,_t.minX,_t.maxX,Pe),ne=null,$n&&(Fn=Kn($n,it,Y-fr,Y+Rr,1,_t.minY,_t.maxY,Pe),ni=Kn($n,it,Y+Zi,Y+ut,1,_t.minY,_t.maxY,Pe),$n=null),hr&&(Ci=Kn(hr,it,Y-fr,Y+Rr,1,_t.minY,_t.maxY,Pe),gi=Kn(hr,it,Y+Zi,Y+ut,1,_t.minY,_t.maxY,Pe),hr=null),He>1&&console.timeEnd("clipping"),Be.push(Fn||[],$+1,2*H,2*Y),Be.push(ni||[],$+1,2*H,2*Y+1),Be.push(Ci||[],$+1,2*H+1,2*Y),Be.push(gi||[],$+1,2*H+1,2*Y+1)}}},Zn.prototype.getTile=function(ne,$,H){var Y=this.options,se=Y.extent,fe=Y.debug;if(ne<0||ne>24)return null;var Oe=1<<ne,Be=ei(ne,$=($%Oe+Oe)%Oe,H);if(this.tiles[Be])return lo(this.tiles[Be],se);fe>1&&console.log("drilling down to z%d-%d-%d",ne,$,H);for(var Pe,He=ne,it=$,jt=H;!Pe&&He>0;)He--,it=Math.floor(it/2),jt=Math.floor(jt/2),Pe=this.tiles[ei(He,it,jt)];return Pe&&Pe.source?(fe>1&&console.log("found parent tile z%d-%d-%d",He,it,jt),fe>1&&console.time("drilling down"),this.splitTile(Pe.source,He,it,jt,ne,$,H),fe>1&&console.timeEnd("drilling down"),this.tiles[Be]?lo(this.tiles[Be],se):null):null};class Qr extends _.VectorTileWorkerSource{constructor($,H,Y,se,fe){super($,H,Y,se,ki),fe&&(this.loadGeoJSON=fe)}loadData($,H){const Y=$&&$.request,se=Y&&Y.collectResourceTiming;this.loadGeoJSON($,(fe,Oe)=>{if(fe||!Oe)return H(fe);if("object"!=typeof Oe)return H(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));{It(Oe,!0);try{if($.filter){const Pe=_.createExpression($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Pe.result)throw new Error(Pe.value.map(it=>`${it.key}: ${it.message}`).join(", "));Oe={type:"FeatureCollection",features:Oe.features.filter(it=>Pe.value.evaluate({zoom:0},it))}}this._geoJSONIndex=$.cluster?new vn(function({superclusterOptions:Pe,clusterProperties:He}){if(!He||!Pe)return Pe;const it={},jt={},_t={accumulated:null,zoom:0},En={properties:null},Ln=Object.keys(He);for(const Fn of Ln){const[ni,Ci]=He[Fn],gi=_.createExpression(Ci),$n=_.createExpression("string"==typeof ni?[ni,["accumulated"],["get",Fn]]:ni);it[Fn]=gi.value,jt[Fn]=$n.value}return Pe.map=Fn=>{En.properties=Fn;const ni={};for(const Ci of Ln)ni[Ci]=it[Ci].evaluate(_t,En);return ni},Pe.reduce=(Fn,ni)=>{En.properties=ni;for(const Ci of Ln)_t.accumulated=Fn[Ci],Fn[Ci]=jt[Ci].evaluate(_t,En)},Pe}($)).load(Oe.features):new Zn(Pe=Oe,$.geojsonVtOptions)}catch(Pe){return H(Pe)}this.loaded={};const Be={};if(se){const Pe=_.getPerformanceMeasurement(Y);Pe&&(Be.resourceTiming={},Be.resourceTiming[$.source]=JSON.parse(JSON.stringify(Pe)))}H(null,Be)}var Pe})}reloadTile($,H){const Y=this.loaded;return Y&&Y[$.uid]?super.reloadTile($,H):this.loadTile($,H)}loadGeoJSON($,H){if($.request)_.getJSON($.request,H);else{if("string"!=typeof $.data)return H(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));try{return H(null,JSON.parse($.data))}catch{return H(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom($,H){try{H(null,this._geoJSONIndex.getClusterExpansionZoom($.clusterId))}catch(Y){H(Y)}}getClusterChildren($,H){try{H(null,this._geoJSONIndex.getChildren($.clusterId))}catch(Y){H(Y)}}getClusterLeaves($,H){try{H(null,this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset))}catch(Y){H(Y)}}}class ze{constructor($){this.self=$,this.actor=new _.Actor($,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=_.getProjection({name:"mercator"}),this.workerSourceTypes={vector:_.VectorTileWorkerSource,geojson:Qr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(H,Y)=>{if(this.workerSourceTypes[H])throw new Error(`Worker source with name "${H}" already registered.`);this.workerSourceTypes[H]=Y},this.self.registerRTLTextPlugin=H=>{if(_.plugin.isParsed())throw new Error("RTL text plugin already registered.");_.plugin.applyArabicShaping=H.applyArabicShaping,_.plugin.processBidirectionalText=H.processBidirectionalText,_.plugin.processStyledBidirectionalText=H.processStyledBidirectionalText}}clearCaches($,H,Y){delete this.layerIndexes[$],delete this.availableImages[$],delete this.workerSources[$],delete this.demWorkerSources[$],Y()}checkIfReady($,H,Y){Y()}setReferrer($,H){this.referrer=H}spriteLoaded($,H){this.isSpriteLoaded[$]=H;for(const Y in this.workerSources[$]){const se=this.workerSources[$][Y];for(const fe in se)se[fe]instanceof _.VectorTileWorkerSource&&(se[fe].isSpriteLoaded=H,se[fe].fire(new _.Event("isSpriteLoaded")))}}setImages($,H,Y){this.availableImages[$]=H;for(const se in this.workerSources[$]){const fe=this.workerSources[$][se];for(const Oe in fe)fe[Oe].availableImages=H}Y()}enableTerrain($,H,Y){this.terrain=H,Y()}setProjection($,H){this.projections[$]=_.getProjection(H)}setLayers($,H,Y){this.getLayerIndex($).replace(H),Y()}updateLayers($,H,Y){this.getLayerIndex($).update(H.layers,H.removedIds),Y()}loadTile($,H,Y){const se=this.enableTerrain?_.extend({enableTerrain:this.terrain},H):H;se.projection=this.projections[$]||this.defaultProjection,this.getWorkerSource($,H.type,H.source).loadTile(se,Y)}loadDEMTile($,H,Y){const se=this.enableTerrain?_.extend({buildQuadTree:this.terrain},H):H;this.getDEMWorkerSource($,H.source).loadTile(se,Y)}reloadTile($,H,Y){const se=this.enableTerrain?_.extend({enableTerrain:this.terrain},H):H;se.projection=this.projections[$]||this.defaultProjection,this.getWorkerSource($,H.type,H.source).reloadTile(se,Y)}abortTile($,H,Y){this.getWorkerSource($,H.type,H.source).abortTile(H,Y)}removeTile($,H,Y){this.getWorkerSource($,H.type,H.source).removeTile(H,Y)}removeSource($,H,Y){if(!this.workerSources[$]||!this.workerSources[$][H.type]||!this.workerSources[$][H.type][H.source])return;const se=this.workerSources[$][H.type][H.source];delete this.workerSources[$][H.type][H.source],void 0!==se.removeSource?se.removeSource(H,Y):Y()}loadWorkerSource($,H,Y){try{this.self.importScripts(H.url),Y()}catch(se){Y(se.toString())}}syncRTLPluginState($,H,Y){try{_.plugin.setState(H);const se=_.plugin.getPluginURL();if(_.plugin.isLoaded()&&!_.plugin.isParsed()&&null!=se){this.self.importScripts(se);const fe=_.plugin.isParsed();Y(fe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${se}`),fe)}}catch(se){Y(se.toString())}}getAvailableImages($){let H=this.availableImages[$];return H||(H=[]),H}getLayerIndex($){let H=this.layerIndexes[$];return H||(H=this.layerIndexes[$]=new on),H}getWorkerSource($,H,Y){return this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][H]||(this.workerSources[$][H]={}),this.workerSources[$][H][Y]||(this.workerSources[$][H][Y]=new this.workerSourceTypes[H]({send:(fe,Oe,Be,Pe,He,it)=>{this.actor.send(fe,Oe,Be,$,He,it)},scheduler:this.actor.scheduler},this.getLayerIndex($),this.getAvailableImages($),this.isSpriteLoaded[$])),this.workerSources[$][H][Y]}getDEMWorkerSource($,H){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][H]||(this.demWorkerSources[$][H]=new yt),this.demWorkerSources[$][H]}enforceCacheSizeLimit($,H){_.enforceCacheSizeLimit(H)}getWorkerPerformanceMetrics($,H,Y){Y(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new ze(self)),ze}),Ne(0,function(_){function $e(v,c){if(Array.isArray(v)){if(!Array.isArray(c)||v.length!==c.length)return!1;for(let g=0;g<v.length;g++)if(!$e(v[g],c[g]))return!1;return!0}if("object"==typeof v&&null!==v&&null!==c){if("object"!=typeof c||Object.keys(v).length!==Object.keys(c).length)return!1;for(const g in v)if(!$e(v[g],c[g]))return!1;return!0}return v===c}var ft=on;function on(v){return c=v,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var C,S,D=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(D);try{S=new Worker(L),C=!0}catch{C=!1}return S&&S.terminate(),URL.revokeObjectURL(L),C}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var C=document.createElement("canvas");C.width=C.height=1;var S=C.getContext("2d");if(!S)return!1;var D=S.getImageData(0,0,1,1);return D&&D.width===C.width}()||(void 0===yt[g=c&&c.failIfMajorPerformanceCaveat]&&(yt[g]=function(C){var S,L,B,G,D=(L=C,B=document.createElement("canvas"),(G=Object.create(on.webGLContextAttributes)).failIfMajorPerformanceCaveat=L,B.getContext("webgl",G)||B.getContext("experimental-webgl",G));if(!D)return!1;try{S=D.createShader(D.VERTEX_SHADER)}catch{return!1}return!(!S||D.isContextLost())&&(D.shaderSource(S,"void main() {}"),D.compileShader(S),!0===D.getShaderParameter(S,D.COMPILE_STATUS))}(g)),!yt[g]||document.documentMode));var c,g}var yt={};function It(v,c,g){const C=_.window.document.createElement(v);return void 0!==c&&(C.className=c),g&&g.appendChild(C),C}function Ve(v,c,g){const C=_.window.document.createElementNS("http://www.w3.org/2000/svg",v);for(const S of Object.keys(c))C.setAttributeNS(null,S,c[S]);return g&&g.appendChild(C),C}on.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const je=_.window.document&&_.window.document.documentElement.style,Ke=je&&void 0!==je.userSelect?"userSelect":"WebkitUserSelect";let pn;function tn(){je&&Ke&&(pn=je[Ke],je[Ke]="none")}function bn(){je&&Ke&&(je[Ke]=pn)}function Dn(v){v.preventDefault(),v.stopPropagation(),_.window.removeEventListener("click",Dn,!0)}function vt(){_.window.addEventListener("click",Dn,!0),_.window.setTimeout(()=>{_.window.removeEventListener("click",Dn,!0)},0)}function Ye(v,c){const g=v.getBoundingClientRect();return Xt(v,g,c)}function Ft(v,c){const g=v.getBoundingClientRect(),C=[];for(let S=0;S<c.length;S++)C.push(Xt(v,g,c[S]));return C}function Jt(v){return void 0!==_.window.InstallTrigger&&2===v.button&&v.ctrlKey&&_.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:v.button}function Xt(v,c,g){const C=v.offsetWidth===c.width?1:v.offsetWidth/c.width;return new _.pointGeometry((g.clientX-c.left)*C,(g.clientY-c.top)*C)}function Ct(v,c){var g=c[0],C=c[1],S=c[2],D=c[3],L=g*D-S*C;return L?(v[0]=D*(L=1/L),v[1]=-C*L,v[2]=-S*L,v[3]=g*L,v):null}function Pt(v){const{userImage:c}=v;return!!(c&&c.render&&c.render())&&(v.data.replace(new Uint8Array(c.data.buffer)),!0)}class un extends _.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new _.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:g,callback:C}of this.requestors)this._notify(g,C);this.requestors=[]}}hasImage(c){return!!this.getImage(c)}getImage(c){return this.images[c]}addImage(c,g){this._validate(c,g)&&(this.images[c]=g)}_validate(c,g){let C=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new _.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),C=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new _.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),C=!1),this._validateContent(g.content,g)||(this.fire(new _.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),C=!1),C}_validateStretch(c,g){if(!c)return!0;let C=0;for(const S of c){if(S[0]<C||S[1]<S[0]||g<S[1])return!1;C=S[1]}return!0}_validateContent(c,g){return!(c&&(4!==c.length||c[0]<0||g.data.width<c[0]||c[1]<0||g.data.height<c[1]||c[2]<0||g.data.width<c[2]||c[3]<0||g.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,g){g.version=this.images[c].version+1,this.images[c]=g,this.updatedImages[c]=!0}removeImage(c){const g=this.images[c];delete this.images[c],delete this.patterns[c],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,g){let C=!0;if(!this.isLoaded())for(const S of c)this.images[S]||(C=!1);this.isLoaded()||C?this._notify(c,g):this.requestors.push({ids:c,callback:g})}_notify(c,g){const C={};for(const S of c){this.images[S]||this.fire(new _.Event("styleimagemissing",{id:S}));const D=this.images[S];D?C[S]={data:D.data.clone(),pixelRatio:D.pixelRatio,sdf:D.sdf,version:D.version,stretchX:D.stretchX,stretchY:D.stretchY,content:D.content,hasRenderCallback:Boolean(D.userImage&&D.userImage.render)}:_.warnOnce(`Image "${S}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}g(null,C)}getPixelSize(){const{width:c,height:g}=this.atlasImage;return{width:c,height:g}}getPattern(c){const g=this.patterns[c],C=this.getImage(c);if(!C)return null;if(g&&g.position.version===C.version)return g.position;if(g)g.position.version=C.version;else{const S={w:C.data.width+2,h:C.data.height+2,x:0,y:0},D=new _.ImagePosition(S,C);this.patterns[c]={bin:S,position:D}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const g=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new _.Texture(c,this.atlasImage,g.RGBA),this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const D in this.patterns)c.push(this.patterns[D].bin);const{w:g,h:C}=_.potpack(c),S=this.atlasImage;S.resize({width:g||1,height:C||1});for(const D in this.patterns){const{bin:L}=this.patterns[D],B=L.x+1,G=L.y+1,J=this.images[D].data,ee=J.width,oe=J.height;_.RGBAImage.copy(J,S,{x:0,y:0},{x:B,y:G},{width:ee,height:oe}),_.RGBAImage.copy(J,S,{x:0,y:oe-1},{x:B,y:G-1},{width:ee,height:1}),_.RGBAImage.copy(J,S,{x:0,y:0},{x:B,y:G+oe},{width:ee,height:1}),_.RGBAImage.copy(J,S,{x:ee-1,y:0},{x:B-1,y:G},{width:1,height:oe}),_.RGBAImage.copy(J,S,{x:0,y:0},{x:B+ee,y:G},{width:1,height:oe})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const g of c){if(this.callbackDispatchedThisFrame[g])continue;this.callbackDispatchedThisFrame[g]=!0;const C=this.images[g];Pt(C)&&this.updateImage(g,C)}}}const tt=new _.Properties({anchor:new _.DataConstantProperty(_.spec.light.anchor),position:new class{constructor(){this.specification=_.spec.light.position}possiblyEvaluate(v,c){return function([g,C,S]){const D=_.degToRad(C+90),L=_.degToRad(S);return{x:g*Math.cos(D)*Math.sin(L),y:g*Math.sin(D)*Math.sin(L),z:g*Math.cos(L),azimuthal:C,polar:S}}(v.expression.evaluate(c))}interpolate(v,c,g){return{x:_.number(v.x,c.x,g),y:_.number(v.y,c.y,g),z:_.number(v.z,c.z,g),azimuthal:_.number(v.azimuthal,c.azimuthal,g),polar:_.number(v.polar,c.polar,g)}}},color:new _.DataConstantProperty(_.spec.light.color),intensity:new _.DataConstantProperty(_.spec.light.intensity)}),pt="-transition";class zt extends _.Evented{constructor(c){super(),this._transitionable=new _.Transitionable(tt),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,g={}){if(!this._validate(_.validateLight,c,g))for(const C in c){const S=c[C];_.endsWith(C,pt)?this._transitionable.setTransition(C.slice(0,-pt.length),S):this._transitionable.setValue(C,S)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,g,C){return(!C||!1!==C.validate)&&_.emitValidationErrors(this,c.call(_.validateStyle,_.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:_.spec})))}}const Bt=new _.Properties({source:new _.DataConstantProperty(_.spec.terrain.source),exaggeration:new _.DataConstantProperty(_.spec.terrain.exaggeration)}),an="-transition";class oi extends _.Evented{constructor(c,g){super(),this._transitionable=new _.Transitionable(Bt),this.set(c),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=g}get(){return this._transitionable.serialize()}set(c){for(const g in c){const C=c[g];_.endsWith(g,an)?this._transitionable.setTransition(g.slice(0,-an.length),C):this._transitionable.setValue(g,C)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}}function On(v,c,g,C){const S=_.smoothstep(45,65,g),[D,L]=mt(v,C),B=_.length(c);let G=1-Math.min(1,Math.exp((B-D)/(L-D)*-6));return G*=G*G,G=Math.min(1,1.00747*G),G*S*v.alpha}function mt(v,c){const g=.5/Math.tan(.5*c);return[v.range[0]+g,v.range[1]+g]}const gt=new _.Properties({range:new _.DataConstantProperty(_.spec.fog.range),color:new _.DataConstantProperty(_.spec.fog.color),"high-color":new _.DataConstantProperty(_.spec.fog["high-color"]),"space-color":new _.DataConstantProperty(_.spec.fog["space-color"]),"horizon-blend":new _.DataConstantProperty(_.spec.fog["horizon-blend"]),"star-intensity":new _.DataConstantProperty(_.spec.fog["star-intensity"])}),Dt="-transition";class Ht extends _.Evented{constructor(c,g){super(),this._transitionable=new _.Transitionable(gt),this.set(c),this._transitioning=this._transitionable.untransitioned(),this._transform=g}get state(){const c=this._transform,g="globe"===c.projection.name,C=_.globeToMercatorTransition(c.zoom),S=this.properties.get("range"),D=[.5,3];return{range:g?[_.number(D[0],S[0],C),_.number(D[1],S[1],C)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(c,g={}){if(!this._validate(_.validateFog,c,g)){for(const C of Object.keys(_.spec.fog))c&&void 0===c[C]&&(c[C]=_.spec.fog[C].default);for(const C in c){const S=c[C];_.endsWith(C,Dt)?this._transitionable.setTransition(C.slice(0,-Dt.length),S):this._transitionable.setValue(C,S)}}}getOpacity(c){if(!this._transform.projection.supportsFog)return 0;const g=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:_.smoothstep(45,65,c))*g.a}getOpacityAtLatLng(c,g){return this._transform.projection.supportsFog?function(C,S,D){const L=_.MercatorCoordinate.fromLngLat(S),B=D.elevation?D.elevation.getAtPointOrZero(L):0,G=[L.x,L.y,B];return _.transformMat4(G,G,D.mercatorFogMatrix),On(C,G,D.pitch,D._fov)}(this.state,c,g):0}getFovAdjustedRange(c){return this._transform.projection.supportsFog?mt(this.state,c):[0,1]}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,g,C){return(!C||!1!==C.validate)&&_.emitValidationErrors(this,c.call(_.validateStyle,_.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:_.spec})))}}class nn{constructor(c,g){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=_.uniqueId();const C=this.workerPool.acquire(this.id);for(let S=0;S<C.length;S++){const D=new nn.Actor(C[S],g,this.id);D.name=`Worker ${S}`,this.actors.push(D)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(c,g,C){_.asyncAll(this.actors,(S,D)=>{S.send(c,g,D)},C=C||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function en(v,c,g){return c*(_.EXTENT/(v.tileSize*Math.pow(2,g-v.tileID.overscaledZ)))}nn.Actor=_.Actor;class wn{constructor(c,g,C,S){this.screenBounds=c,this.cameraPoint=g,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=C,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(c,g){let C,S;if(c instanceof _.pointGeometry||"number"==typeof c[0]){const D=_.pointGeometry.convert(c);C=[D],S=g.isPointAboveHorizon(D)}else{const D=_.pointGeometry.convert(c[0]),L=_.pointGeometry.convert(c[1]);C=[D,L],S=_.polygonizeBounds(D,L).every(B=>g.isPointAboveHorizon(B))}return new wn(C,g.getCameraPoint(),S,g)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(c){return _.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],c)}bufferedCameraGeometry(c){const g=this.screenBounds[0],C=1===this.screenBounds.length?this.screenBounds[0].add(new _.pointGeometry(1,1)):this.screenBounds[1],S=_.polygonizeBounds(g,C,0,!1);return this.cameraPoint.y>C.y&&(this.cameraPoint.x>g.x&&this.cameraPoint.x<C.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=C.x?S[2]=this.cameraPoint:this.cameraPoint.x<=g.x&&(S[3]=this.cameraPoint)),_.bufferConvexPolygon(S,c)}bufferedCameraGeometryGlobe(c){const g=this.screenBounds[0],C=1===this.screenBounds.length?this.screenBounds[0].add(new _.pointGeometry(1,1)):this.screenBounds[1],S=_.polygonizeBounds(g,C,c),D=this.cameraPoint.clone();switch(3*((D.y>g.y)+(D.y>C.y))+((D.x>g.x)+(D.x>C.x))){case 0:S[0]=D,S[4]=D.clone();break;case 1:S.splice(1,0,D);break;case 2:S[1]=D;break;case 3:S.splice(4,0,D);break;case 5:S.splice(2,0,D);break;case 6:S[3]=D;break;case 7:S.splice(3,0,D);break;case 8:S[2]=D}return S}containsTile(c,g,C,S=0){const D=c.queryPadding/g._pixelsPerMercatorPixel+1,L=C?this._bufferedCameraMercator(D,g):this._bufferedScreenMercator(D,g);let B=c.tileID.wrap+(L.unwrapped?S:0);const G=L.polygon.map(be=>_.getTilePoint(c.tileTransform,be,B));if(!_.polygonIntersectsBox(G,0,0,_.EXTENT,_.EXTENT))return;B=c.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const J=this.screenGeometryMercator.polygon.map(be=>_.getTileVec3(c.tileTransform,be,B)),ee=J.map(be=>new _.pointGeometry(be[0],be[1])),oe=g.getFreeCameraOptions().position||new _.MercatorCoordinate(0,0,0),de=_.getTileVec3(c.tileTransform,oe,B),ge=J.map(be=>{const ce=_.sub(be,be,de);return _.normalize(ce,ce),new _.Ray(de,ce)}),ue=en(c,1,g.zoom)*g._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:ee,tilespaceRays:ge,bufferedTilespaceGeometry:G,bufferedTilespaceBounds:(ye=_.getBounds(G),ye.min.x=_.clamp(ye.min.x,0,_.EXTENT),ye.min.y=_.clamp(ye.min.y,0,_.EXTENT),ye.max.x=_.clamp(ye.max.x,0,_.EXTENT),ye.max.y=_.clamp(ye.max.y,0,_.EXTENT),ye),tile:c,tileID:c.tileID,pixelToTileUnitsFactor:ue};var ye}_bufferedScreenMercator(c,g){const C=qn(c);if(this._screenRaycastCache[C])return this._screenRaycastCache[C];{let S;return S="globe"===g.projection.name?this._projectAndResample(this.bufferedScreenGeometry(c),g):{polygon:this.bufferedScreenGeometry(c).map(D=>g.pointCoordinate3D(D)),unwrapped:!0},this._screenRaycastCache[C]=S,S}}_bufferedCameraMercator(c,g){const C=qn(c);if(this._cameraRaycastCache[C])return this._cameraRaycastCache[C];{let S;return S="globe"===g.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(c),g):{polygon:this.bufferedCameraGeometry(c).map(D=>g.pointCoordinate3D(D)),unwrapped:!0},this._cameraRaycastCache[C]=S,S}}_projectAndResample(c,g){const C=function(D,L){const B=_.multiply([],L.pixelMatrix,L.globeMatrix),G=[0,-_.GLOBE_RADIUS,0,1],J=[0,_.GLOBE_RADIUS,0,1],ee=[0,0,0,1];_.transformMat4$1(G,G,B),_.transformMat4$1(J,J,B),_.transformMat4$1(ee,ee,B);const oe=new _.pointGeometry(G[0]/G[3],G[1]/G[3]),de=new _.pointGeometry(J[0]/J[3],J[1]/J[3]),ge=_.polygonContainsPoint(D,oe)&&G[3]<ee[3],ue=_.polygonContainsPoint(D,de)&&J[3]<ee[3];if(!ge&&!ue)return null;const ye=function(Ue,Ze,nt){for(let ot=1;ot<Ue.length;ot++){const Ut=rr(Ze.pointCoordinate3D(Ue[ot-1]).x),Qe=rr(Ze.pointCoordinate3D(Ue[ot]).x);if(nt<0){if(Ut<Qe)return{idx:ot,t:-Ut/(Qe-1-Ut)}}else if(Qe<Ut)return{idx:ot,t:(1-Ut)/(Qe+1-Ut)}}return null}(D,L,ge?-1:1);if(!ye)return null;const{idx:be,t:ce}=ye;let Te=be>1?Cn(D.slice(0,be),L):[],ve=be<D.length?Cn(D.slice(be),L):[];Te=Te.map(Ue=>new _.pointGeometry(rr(Ue.x),Ue.y)),ve=ve.map(Ue=>new _.pointGeometry(rr(Ue.x),Ue.y));const De=[...Te];0===De.length&&De.push(ve[ve.length-1]);const Fe=_.number(De[De.length-1].y,(0===ve.length?Te[0]:ve[0]).y,ce);let Re;return Re=ge?[new _.pointGeometry(0,Fe),new _.pointGeometry(0,0),new _.pointGeometry(1,0),new _.pointGeometry(1,Fe)]:[new _.pointGeometry(1,Fe),new _.pointGeometry(1,1),new _.pointGeometry(0,1),new _.pointGeometry(0,Fe)],De.push(...Re),0===ve.length?De.push(Te[0]):De.push(...ve),{polygon:De.map(Ue=>new _.MercatorCoordinate(Ue.x,Ue.y)),unwrapped:!1}}(c,g);if(C)return C;const S=function(D,L){let B=!1,G=-1/0,J=0;for(let oe=0;oe<D.length-1;oe++)D[oe].x>G&&(G=D[oe].x,J=oe);for(let oe=0;oe<D.length-1;oe++){const de=(J+oe)%(D.length-1),ge=D[de],ue=D[de+1];Math.abs(ge.x-ue.x)>.5&&(ge.x<ue.x?(ge.x+=1,0===de&&(D[D.length-1].x+=1)):(ue.x+=1,de+1===D.length-1&&(D[0].x+=1)),B=!0)}const ee=_.mercatorXfromLng(L.center.lng);return B&&ee<Math.abs(ee-1)&&D.forEach(oe=>{oe.x-=1}),{polygon:D,unwrapped:B}}(Cn(c,g).map(D=>new _.pointGeometry(rr(D.x),D.y)),g);return{polygon:S.polygon.map(D=>new _.MercatorCoordinate(D.x,D.y)),unwrapped:S.unwrapped}}}function Cn(v,c){return _.resample(v,g=>{const C=c.pointCoordinate3D(g);g.x=C.x,g.y=C.y},1/256)}function rr(v){return v<0?1+v%1:v%1}function qn(v){return 100*v|0}function zn(v,c,g,C,S){const D=function(L,B){if(L)return S(L);if(B){v.url&&B.tiles&&v.tiles&&delete v.tiles;const G=_.pick(_.extend(B,v),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);B.vector_layers&&(G.vectorLayers=B.vector_layers,G.vectorLayerIds=G.vectorLayers.map(J=>J.id)),G.tiles=c.canonicalizeTileset(G,v.url),S(null,G)}};return v.url?_.getJSON(c.transformRequest(c.normalizeSourceURL(v.url,null,g,C),_.ResourceType.Source),D):_.exported.frame(()=>D(null,v))}class vn{constructor(c,g,C){this.bounds=_.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=g||0,this.maxzoom=C||24}validateBounds(c){return Array.isArray(c)&&4===c.length?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const g=Math.pow(2,c.z),C=Math.floor(_.mercatorXfromLng(this.bounds.getWest())*g),S=Math.floor(_.mercatorYfromLat(this.bounds.getNorth())*g),D=Math.ceil(_.mercatorXfromLng(this.bounds.getEast())*g),L=Math.ceil(_.mercatorYfromLat(this.bounds.getSouth())*g);return c.x>=C&&c.x<D&&c.y>=S&&c.y<L}}class Qi{constructor(c,g,C){this.context=c;const S=c.gl;this.buffer=S.createBuffer(),this.dynamicDraw=Boolean(C),this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||g.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const g=this.context.gl;this.context.unbindVAO(),this.bind(),g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Pi={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class dr{constructor(c,g,C,S){this.length=g.length,this.attributes=C,this.itemSize=g.bytesPerElement,this.dynamicDraw=S,this.context=c;const D=c.gl;this.buffer=D.createBuffer(),c.bindVertexBuffer.set(this.buffer),D.bufferData(D.ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||g.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){const g=this.context.gl;this.bind(),g.bufferSubData(g.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,g){for(let C=0;C<this.attributes.length;C++){const S=g.attributes[this.attributes[C].name];void 0!==S&&c.enableVertexAttribArray(S)}}setVertexAttribPointers(c,g,C){for(let S=0;S<this.attributes.length;S++){const D=this.attributes[S],L=g.attributes[D.name];void 0!==L&&c.vertexAttribPointer(L,D.components,c[Pi[D.type]],!1,this.itemSize,D.offset+this.itemSize*(C||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Vn{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class kr extends Vn{getDefault(){return _.Color.transparent}set(c){const g=this.current;(c.r!==g.r||c.g!==g.g||c.b!==g.b||c.a!==g.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class oo extends Vn{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class Ms extends Vn{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class so extends Vn{getDefault(){return[!0,!0,!0,!0]}set(c){const g=this.current;(c[0]!==g[0]||c[1]!==g[1]||c[2]!==g[2]||c[3]!==g[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Ds extends Vn{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class _s extends Vn{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Ir extends Vn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const g=this.current;(c.func!==g.func||c.ref!==g.ref||c.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class jr extends Vn{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const g=this.current;(c[0]!==g[0]||c[1]!==g[1]||c[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class In extends Vn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;c?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=c,this.dirty=!1}}class zo extends Vn{getDefault(){return[0,1]}set(c){const g=this.current;(c[0]!==g[0]||c[1]!==g[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class ls extends Vn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;c?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=c,this.dirty=!1}}class vo extends Vn{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class $r extends Vn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;c?g.enable(g.BLEND):g.disable(g.BLEND),this.current=c,this.dirty=!1}}class cs extends Vn{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const g=this.current;(c[0]!==g[0]||c[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class pi extends Vn{getDefault(){return _.Color.transparent}set(c){const g=this.current;(c.r!==g.r||c.g!==g.g||c.b!==g.b||c.a!==g.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class jn extends Vn{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class Kn extends Vn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;c?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=c,this.dirty=!1}}class Nr extends Vn{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class Sr extends Vn{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class Xr extends Vn{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class Do extends Vn{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class ao extends Vn{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const g=this.current;(c[0]!==g[0]||c[1]!==g[1]||c[2]!==g[2]||c[3]!==g[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class ys extends Vn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class wi extends Vn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Vs extends Vn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.bindTexture(g.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class Ei extends Vn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class lo extends Vn{getDefault(){return null}set(c){const g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Hr extends Vn{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class cn extends Vn{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class Vt extends Vn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class Sn extends Vn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class Zn extends Vn{constructor(c,g){super(c),this.context=c,this.parent=g}getDefault(){return null}}class ei extends Zn{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class ki extends Zn{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,this.attachment(),g.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Qr extends ki{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ze{constructor(c,g,C,S){this.context=c,this.width=g,this.height=C;const D=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new ei(c,D),S&&(this.depthAttachment=new ki(c,D))}destroy(){const c=this.context.gl,g=this.colorAttachment.get();if(g&&c.deleteTexture(g),this.depthAttachment){const C=this.depthAttachment.get();C&&c.deleteRenderbuffer(C)}c.deleteFramebuffer(this.framebuffer)}}class ne{constructor(c,g=!1){if(this.gl=c,this.isWebGL2=g,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),g){const C=c;this.extVertexArrayObject={createVertexArrayOES:C.createVertexArray.bind(c),deleteVertexArrayOES:C.deleteVertexArray.bind(c),bindVertexArrayOES:C.bindVertexArray.bind(c)}}this.clearColor=new kr(this),this.clearDepth=new oo(this),this.clearStencil=new Ms(this),this.colorMask=new so(this),this.depthMask=new Ds(this),this.stencilMask=new _s(this),this.stencilFunc=new Ir(this),this.stencilOp=new jr(this),this.stencilTest=new In(this),this.depthRange=new zo(this),this.depthTest=new ls(this),this.depthFunc=new vo(this),this.blend=new $r(this),this.blendFunc=new cs(this),this.blendColor=new pi(this),this.blendEquation=new jn(this),this.cullFace=new Kn(this),this.cullFaceSide=new Nr(this),this.frontFace=new Sr(this),this.program=new Xr(this),this.activeTexture=new Do(this),this.viewport=new ao(this),this.bindFramebuffer=new ys(this),this.bindRenderbuffer=new wi(this),this.bindTexture=new Vs(this),this.bindVertexBuffer=new Ei(this),this.bindElementBuffer=new lo(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Hr(this),this.pixelStoreUnpack=new cn(this),this.pixelStoreUnpackPremultiplyAlpha=new Vt(this),this.pixelStoreUnpackFlipY=new Sn(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=c.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=c.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=c.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),g||(this.extTextureHalfFloat=c.getExtension("OES_texture_half_float")),(g||this.extTextureHalfFloat&&c.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=g||c.getExtension("OES_standard_derivatives"),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,g){return new Qi(this,c,g)}createVertexBuffer(c,g,C){return new dr(this,c,g,C)}createRenderbuffer(c,g,C){const S=this.gl,D=S.createRenderbuffer();return this.bindRenderbuffer.set(D),S.renderbufferStorage(S.RENDERBUFFER,c,g,C),this.bindRenderbuffer.set(null),D}createFramebuffer(c,g,C){return new ze(this,c,g,C)}clear({color:c,depth:g,stencil:C}){const S=this.gl;let D=0;c&&(D|=S.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),void 0!==g&&(D|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(g),this.depthMask.set(!0)),void 0!==C&&(D|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(C),this.stencilMask.set(255)),S.clear(D)}setCullFace(c){!1===c.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){$e(c.blendFunction,_.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class $ extends _.Evented{constructor(c,g,C,S){if(super(),this.id=c,this.dispatcher=C,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,_.extend(this,_.pick(g,["url","scheme","tileSize","promoteId"])),this._options=_.extend({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new _.DedupedRequest}load(c){this._loaded=!1,this.fire(new _.Event("dataloading",{dataType:"source"}));const g=Array.isArray(this.map._language)?this.map._language.join():this.map._language,C=this.map._worldview;this._tileJSONRequest=zn(this._options,this.map._requestManager,g,C,(S,D)=>{this._tileJSONRequest=null,this._loaded=!0,S?(g&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${g}`),C&&2!==C.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${C}`),this.fire(new _.ErrorEvent(S))):D&&(_.extend(this,D),D.bounds&&(this.tileBounds=new vn(D.bounds,this.minzoom,this.maxzoom)),_.postTurnstileEvent(D.tiles,this.map._requestManager._customAccessToken),this.fire(new _.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(S)})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return _.extend({},this._options)}loadTile(c,g){const C=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(C,_.ResourceType.Tile),data:void 0,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:_.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:c.isSymbolTile};if(S.request.collectResourceTiming=this._collectResourceTiming,c.actor&&"expired"!==c.state)"loading"===c.state?c.reloadCallback=g:c.request=c.actor.send("reloadTile",S,D.bind(this));else if(c.actor=this._tileWorkers[C]=this._tileWorkers[C]||this.dispatcher.getActor(),this.dispatcher.ready)c.request=c.actor.send("loadTile",S,D.bind(this),void 0,!0);else{const L=_.loadVectorTile.call({deduped:this._deduped},S,(B,G)=>{B||!G?D.call(this,B):(S.data={cacheControl:G.cacheControl,expires:G.expires,rawData:G.rawData.slice(0)},c.actor&&c.actor.send("loadTile",S,D.bind(this),void 0,!0))},!0);c.request={cancel:L}}function D(L,B){return delete c.request,c.aborted?g(null):L&&404!==L.status?g(L):(B&&B.resourceTiming&&(c.resourceTiming=B.resourceTiming),this.map._refreshExpiredTiles&&B&&c.setExpiryData(B),c.loadVectorData(B,this.map.painter),_.cacheEntryPossiblyAdded(this.dispatcher),g(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id})}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class H extends _.Evented{constructor(c,g,C,S){super(),this.id=c,this.dispatcher=C,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=_.extend({type:"raster"},g),_.extend(this,_.pick(g,["url","scheme","tileSize"]))}load(c){this._loaded=!1,this.fire(new _.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=zn(this._options,this.map._requestManager,null,null,(g,C)=>{this._tileJSONRequest=null,this._loaded=!0,g?this.fire(new _.ErrorEvent(g)):C&&(_.extend(this,C),C.bounds&&(this.tileBounds=new vn(C.bounds,this.minzoom,this.maxzoom)),_.postTurnstileEvent(C.tiles),this.fire(new _.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(g)})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return _.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,g){const C=_.exported.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),C,this.tileSize);c.request=_.getImage(this.map._requestManager.transformRequest(S,_.ResourceType.Tile),(D,L,B,G)=>(delete c.request,c.aborted?(c.state="unloaded",g(null)):D?(c.state="errored",g(D)):L?(this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:B,expires:G}),c.setTexture(L,this.map.painter),c.state="loaded",_.cacheEntryPossiblyAdded(this.dispatcher),void g(null)):g(null)))}static loadTileData(c,g,C){c.setTexture(g,C)}static unloadTileData(c,g){c.texture&&g.saveTileTexture(c.texture)}abortTile(c,g){c.request&&(c.request.cancel(),delete c.request),g()}unloadTile(c,g){c.texture&&this.map.painter.saveTileTexture(c.texture),g()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let Y;function se(v,c,g,C,S,D,L,B){const G=[v,g,S,c,C,D,1,1,1],J=[L,B,1],ee=_.adjoint([],G),[oe,de,ge]=_.transformMat3(J,J,_.transpose(ee,ee));return _.multiply$1(G,[oe,0,0,0,de,0,0,0,ge],G)}class fe extends _.Evented{constructor(c,g,C,S){super(),this.id=c,this.dispatcher=C,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(S),this.options=g,this._dirty=!1}load(c,g){this._loaded=g||!1,this.fire(new _.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=_.getImage(this.map._requestManager.transformRequest(this.url,_.ResourceType.Image),(C,S)=>{if(this._imageRequest=null,this._loaded=!0,C)this.fire(new _.ErrorEvent(C));else if(S){const{HTMLImageElement:D}=_.window;this.image=S instanceof D?_.exported.getImageData(S):S,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,c&&(this.coordinates=c),this._finishLoading()}})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this._imageRequest&&c.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=c.url,this.load(c.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new _.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(c){this.coordinates=c,this._boundsArray=void 0;const g=c.map(_.MercatorCoordinate.fromLngLat);return this.tileID=function(C){let S=1/0,D=1/0,L=-1/0,B=-1/0;for(const oe of C)S=Math.min(S,oe.x),D=Math.min(D,oe.y),L=Math.max(L,oe.x),B=Math.max(B,oe.y);const G=Math.max(L-S,B-D),J=Math.max(0,Math.floor(-Math.log(G)/Math.LN2)),ee=Math.pow(2,J);return new _.CanonicalTileID(J,Math.floor((S+L)/2*ee),Math.floor((D+B)/2*ee))}(g),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new _.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(c){for(const G in this.tiles){const J=this.tiles[G];"loaded"!==J.state&&(J.state="loaded",J.texture=this.texture)}if(this._boundsArray)return;const g=_.tileTransform(this.tileID,this.map.transform.projection),[C,S,D,L]=this.coordinates.map(G=>{const J=g.projection.project(G[0],G[1]);return _.getTilePoint(g,J)._round()});this.perspectiveTransform=function(G,J,ee,oe,de,ge,ue,ye,be,ce){const Te=se(0,0,G,0,0,J,G,J),ve=se(ee,oe,de,ge,ue,ye,be,ce);return _.multiply$1(ve,_.adjoint(Te,Te),ve),[ve[6]/ve[8]*G/_.EXTENT,ve[7]/ve[8]*J/_.EXTENT]}(this.width,this.height,C.x,C.y,S.x,S.y,L.x,L.y,D.x,D.y);const B=this._boundsArray=new _.StructArrayLayout4i8;B.emplaceBack(C.x,C.y,0,0),B.emplaceBack(S.x,S.y,_.EXTENT,0),B.emplaceBack(L.x,L.y,0,_.EXTENT),B.emplaceBack(D.x,D.y,_.EXTENT,_.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=c.createVertexBuffer(B,_.boundsAttributes.members),this.boundsSegments=_.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const c=this.map.painter.context,g=c.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new _.Texture(c,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(c)}loadTile(c,g){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},g(null)):(c.state="errored",g(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Oe={vector:$,raster:H,"raster-dem":class extends H{constructor(v,c,g,C){super(v,c,g,C),this.type="raster-dem",this.maxzoom=22,this._options=_.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}loadTile(v,c){const g=this.map._requestManager.normalizeTileURL(v.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function C(S,D){S&&(v.state="errored",c(S)),D&&(v.dem=D,v.dem.onDeserialize(),v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0,v.state="loaded",c(null))}v.request=_.getImage(this.map._requestManager.transformRequest(g,_.ResourceType.Tile),function(S,D,L,B){if(delete v.request,v.aborted)v.state="unloaded",c(null);else if(S)v.state="errored",c(S);else if(D){this.map._refreshExpiredTiles&&v.setExpiryData({cacheControl:L,expires:B});const G=_.window.ImageBitmap&&D instanceof _.window.ImageBitmap&&(null==Y&&(Y=_.window.OffscreenCanvas&&new _.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof _.window.createImageBitmap),Y),J=1-(D.width-_.prevPowerOfTwo(D.width))/2;J<1||v.neighboringTiles||(v.neighboringTiles=this._getNeighboringTiles(v.tileID));const ee=G?D:_.exported.getImageData(D,J),oe={uid:v.uid,coord:v.tileID,source:this.id,rawImageData:ee,encoding:this.encoding,padding:J};v.actor&&"expired"!==v.state||(v.actor=this.dispatcher.getActor(),v.actor.send("loadDEMTile",oe,C.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(v){const c=v.canonical,g=Math.pow(2,c.z),C=(c.x-1+g)%g,S=0===c.x?v.wrap-1:v.wrap,D=(c.x+1+g)%g,L=c.x+1===g?v.wrap+1:v.wrap,B={};return B[new _.OverscaledTileID(v.overscaledZ,S,c.z,C,c.y).key]={backfilled:!1},B[new _.OverscaledTileID(v.overscaledZ,L,c.z,D,c.y).key]={backfilled:!1},c.y>0&&(B[new _.OverscaledTileID(v.overscaledZ,S,c.z,C,c.y-1).key]={backfilled:!1},B[new _.OverscaledTileID(v.overscaledZ,v.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},B[new _.OverscaledTileID(v.overscaledZ,L,c.z,D,c.y-1).key]={backfilled:!1}),c.y+1<g&&(B[new _.OverscaledTileID(v.overscaledZ,S,c.z,C,c.y+1).key]={backfilled:!1},B[new _.OverscaledTileID(v.overscaledZ,v.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},B[new _.OverscaledTileID(v.overscaledZ,L,c.z,D,c.y+1).key]={backfilled:!1}),B}unloadTile(v){v.demTexture&&this.map.painter.saveTileTexture(v.demTexture),v.fbo&&(v.fbo.destroy(),delete v.fbo),v.dem&&delete v.dem,delete v.neighboringTiles,v.state="unloaded"}},geojson:class extends _.Evented{constructor(v,c,g,C){super(),this.id=v,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=g.getActor(),this.setEventedParent(C),this._data=c.data,this._options=_.extend({},c),this._collectResourceTiming=c.collectResourceTiming,void 0!==c.maxzoom&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const S=_.EXTENT/this.tileSize;this.workerOptions=_.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(void 0!==c.buffer?c.buffer:128)*S,tolerance:(void 0!==c.tolerance?c.tolerance:.375)*S,extent:_.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:void 0!==c.clusterMaxZoom?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:_.EXTENT,radius:(void 0!==c.clusterRadius?c.clusterRadius:50)*S,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}onAdd(v){this.map=v,this.setData(this._data)}setData(v){return this._data=v,this._updateWorkerData(),this}getClusterExpansionZoom(v,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:v,source:this.id},c),this}getClusterChildren(v,c){return this.actor.send("geojson.getClusterChildren",{clusterId:v,source:this.id},c),this}getClusterLeaves(v,c,g,C){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:v,limit:c,offset:g},C),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new _.Event("dataloading",{dataType:"source"})),this._loaded=!1;const v=_.extend({},this.workerOptions),c=this._data;"string"==typeof c?(v.request=this.map._requestManager.transformRequest(_.exported.resolveURL(c),_.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,v,(g,C)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new _.ErrorEvent(g));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&C&&C.resourceTiming&&C.resourceTiming[this.id]&&(S.resourceTiming=C.resourceTiming[this.id]),this.fire(new _.Event("data",S)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(v,c){const g=v.actor?"reloadTile":"loadTile";v.actor=this.actor,v.request=this.actor.send(g,{type:this.type,uid:v.uid,tileID:v.tileID,tileZoom:v.tileZoom,zoom:v.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:_.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(C,S)=>(delete v.request,v.unloadVectorData(),v.aborted?c(null):C?c(C):(v.loadVectorData(S,this.map.painter,"reloadTile"===g),c(null))),void 0,"loadTile"===g)}abortTile(v){v.request&&(v.request.cancel(),delete v.request),v.aborted=!0}unloadTile(v){v.unloadVectorData(),this.actor.send("removeTile",{uid:v.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return _.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends fe{constructor(v,c,g,C){super(v,c,g,C),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const v=this.options;this.urls=[];for(const c of v.urls)this.urls.push(this.map._requestManager.transformRequest(c,_.ResourceType.Source).url);_.getVideo(this.urls,(c,g)=>{this._loaded=!0,c?this.fire(new _.ErrorEvent(c)):g&&(this.video=g,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(v){if(this.video){const c=this.video.seekable;v<c.start(0)||v>c.end(0)?this.fire(new _.ErrorEvent(new _.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=v}}getVideo(){return this.video}onAdd(v){this.map||(this.map=v,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const v=this.map.painter.context,c=v.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new _.Texture(v,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(v)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:fe,canvas:class extends fe{constructor(v,c,g,C){super(v,c,g,C),c.coordinates?Array.isArray(c.coordinates)&&4===c.coordinates.length&&!c.coordinates.some(S=>!Array.isArray(S)||2!==S.length||S.some(D=>"number"!=typeof D))||this.fire(new _.ErrorEvent(new _.ValidationError(`sources.${v}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new _.ErrorEvent(new _.ValidationError(`sources.${v}`,null,'missing required property "coordinates"'))),c.animate&&"boolean"!=typeof c.animate&&this.fire(new _.ErrorEvent(new _.ValidationError(`sources.${v}`,null,'optional "animate" property must be a boolean value'))),c.canvas?"string"==typeof c.canvas||c.canvas instanceof _.window.HTMLCanvasElement||this.fire(new _.ErrorEvent(new _.ValidationError(`sources.${v}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new _.ErrorEvent(new _.ValidationError(`sources.${v}`,null,'missing required property "canvas"'))),this.options=c,this.animate=void 0===c.animate||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof _.window.HTMLCanvasElement?this.options.canvas:_.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new _.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(v){this.map=v,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let v=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,v=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,v=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const c=this.map.painter.context;this.texture?(v||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new _.Texture(c,this.canvas,c.gl.RGBA,{premultiply:!0}),this._prepareData(c)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const v of[this.canvas.width,this.canvas.height])if(isNaN(v)||v<=0)return!0;return!1}},custom:class extends _.Evented{constructor(v,c,g,C){super(),this.id=v,this.type="custom",this._dataType="raster",this._dispatcher=g,this._implementation=c,this.setEventedParent(C),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new _.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new _.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new vn(this._implementation.bounds,this.minzoom,this.maxzoom)),c.update=this._update.bind(this),c.clearTiles=this._clearTiles.bind(this),c.coveringTiles=this._coveringTiles.bind(this),_.extend(this,_.pick(c,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return _.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new _.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(v){this._map=v,this._loaded=!1,this.fire(new _.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(v),this.load()}onRemove(v){this._implementation.onRemove&&this._implementation.onRemove(v)}hasTile(v){if(this._implementation.hasTile){const{x:c,y:g,z:C}=v.canonical;return this._implementation.hasTile({x:c,y:g,z:C})}return!this.tileBounds||this.tileBounds.contains(v.canonical)}loadTile(v,c){const{x:g,y:C,z:S}=v.tileID.canonical,D=new _.window.AbortController;v.request=Promise.resolve(this._implementation.loadTile({x:g,y:C,z:S},{signal:D.signal})).then(function(L){return delete v.request,v.aborted?(v.state="unloaded",c(null)):void 0===L?(v.state="errored",c(null)):null===L?(this.loadTileData(v,{width:this.tileSize,height:this.tileSize,data:null}),v.state="loaded",c(null)):(B=L)instanceof _.window.ImageData||B instanceof _.window.HTMLCanvasElement||B instanceof _.window.ImageBitmap||B instanceof _.window.HTMLImageElement?(this.loadTileData(v,L),v.state="loaded",void c(null)):(v.state="errored",c(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var B}.bind(this)).catch(L=>{20!==L.code&&(v.state="errored",c(L))}),v.request.cancel=()=>D.abort()}loadTileData(v,c){H.loadTileData(v,c,this._map.painter)}unloadTileData(v){H.unloadTileData(v,this._map.painter)}unloadTile(v,c){if(this.unloadTileData(v),this._implementation.unloadTile){const{x:g,y:C,z:S}=v.tileID.canonical;this._implementation.unloadTile({x:g,y:C,z:S})}c()}abortTile(v,c){v.request&&v.request.cancel&&(v.request.cancel(),delete v.request),c()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(v=>({x:v.canonical.x,y:v.canonical.y,z:v.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new _.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Be=function(v,c,g,C){const S=new Oe[c.type](v,c,g,C);if(S.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${S.id}`);return _.bindAll(["load","abort","unload","serialize","prepare"],S),S};function Pe(v,c){const g=_.identity([]);return _.scale(g,g,[.5*v.width,.5*-v.height,1]),_.translate(g,g,[1,-1,0]),_.multiply(g,g,v.calculateProjMatrix(c.toUnwrapped())),Float32Array.from(g)}function He(v,c,g,C,S,D,L,B=!1){const G=v.tilesIn(C,L,B);G.sort(jt);const J=[];for(const oe of G)J.push({wrappedTileID:oe.tile.tileID.wrapped().key,queryResults:oe.tile.queryRenderedFeatures(c,g,v._state,oe,S,D,Pe(v.transform,oe.tile.tileID),B)});const ee=function(oe){const de={},ge={};for(const ue of oe){const ye=ue.queryResults,be=ue.wrappedTileID,ce=ge[be]=ge[be]||{};for(const Te in ye){const ve=ye[Te],De=ce[Te]=ce[Te]||{},Fe=de[Te]=de[Te]||[];for(const Re of ve)De[Re.featureIndex]||(De[Re.featureIndex]=!0,Fe.push(Re))}}return de}(J);for(const oe in ee)ee[oe].forEach(de=>{const ge=de.feature,ue=ge.layer;ue&&"background"!==ue.type&&"sky"!==ue.type&&(ge.source=ue.source,ue["source-layer"]&&(ge.sourceLayer=ue["source-layer"]),ge.state=void 0!==ge.id?v.getFeatureState(ue["source-layer"],ge.id):{})});return ee}function it(v,c){const g=v.getRenderableIds().map(D=>v.getTileByID(D)),C=[],S={};for(let D=0;D<g.length;D++){const L=g[D],B=L.tileID.canonical.key;S[B]||(S[B]=!0,L.querySourceFeatures(C,c))}return C}function jt(v,c){const g=v.tileID,C=c.tileID;return g.overscaledZ-C.overscaledZ||g.canonical.y-C.canonical.y||g.wrap-C.wrap||g.canonical.x-C.canonical.x}function _t(){return null!=Mi.workerClass?new Mi.workerClass:new _.window.Worker(Mi.workerUrl)}const En="mapboxgl_preloaded_worker_pool";class Ln{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<Ln.workerCount;)this.workers.push(new _t);return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],0===this.numActive()&&(this.workers.forEach(g=>{g.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[En]}numActive(){return Object.keys(this.active).length}}let Fn;function ni(){return Fn||(Fn=new Ln),Fn}function Ci(v,c){const g={};for(const C in v)"ref"!==C&&(g[C]=v[C]);return _.refProperties.forEach(C=>{C in c&&(g[C]=c[C])}),g}function gi(v){v=v.slice();const c=Object.create(null);for(let g=0;g<v.length;g++)c[v[g].id]=v[g];for(let g=0;g<v.length;g++)"ref"in v[g]&&(v[g]=Ci(v[g],c[v[g].ref]));return v}Ln.workerCount=2;const $n={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function hr(v,c,g){g.push({command:$n.addSource,args:[v,c[v]]})}function fr(v,c,g){c.push({command:$n.removeSource,args:[v]}),g[v]=!0}function Zi(v,c,g,C){fr(v,g,C),hr(v,c,g)}function Rr(v,c,g){let C;for(C in v[g])if(v[g].hasOwnProperty(C)&&"data"!==C&&!$e(v[g][C],c[g][C]))return!1;for(C in c[g])if(c[g].hasOwnProperty(C)&&"data"!==C&&!$e(v[g][C],c[g][C]))return!1;return!0}function ut(v,c,g,C,S,D){let L;for(L in c=c||{},v=v||{})v.hasOwnProperty(L)&&($e(v[L],c[L])||g.push({command:D,args:[C,L,c[L],S]}));for(L in c)c.hasOwnProperty(L)&&!v.hasOwnProperty(L)&&($e(v[L],c[L])||g.push({command:D,args:[C,L,c[L],S]}))}function Ao(v){return v.id}function cr(v,c){return v[c.id]=c,v}class Ya{constructor(c,g){this.reset(c,g)}reset(c,g){this.points=c||[],this._distances=[0];for(let C=1;C<this.points.length;C++)this._distances[C]=this._distances[C-1]+this.points[C].dist(this.points[C-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(g||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(1===this.points.length)return this.points[0];c=_.clamp(c,0,1);let g=1,C=this._distances[g];const S=c*this.paddedLength+this.padding;for(;C<S&&g<this._distances.length;)C=this._distances[++g];const D=g-1,L=this._distances[D],B=C-L,G=B>0?(S-L)/B:0;return this.points[D].mult(1-G).add(this.points[g].mult(G))}}class oh{constructor(c,g,C){const S=this.boxCells=[],D=this.circleCells=[];this.xCellCount=Math.ceil(c/C),this.yCellCount=Math.ceil(g/C);for(let L=0;L<this.xCellCount*this.yCellCount;L++)S.push([]),D.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=g,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/g,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,g,C,S,D){this._forEachCell(g,C,S,D,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(g),this.bboxes.push(C),this.bboxes.push(S),this.bboxes.push(D)}insertCircle(c,g,C,S){this._forEachCell(g-S,C-S,g+S,C+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(g),this.circles.push(C),this.circles.push(S)}_insertBoxCell(c,g,C,S,D,L){this.boxCells[D].push(L)}_insertCircleCell(c,g,C,S,D,L){this.circleCells[D].push(L)}_query(c,g,C,S,D,L){if(C<0||c>this.width||S<0||g>this.height)return!D&&[];const B=[];if(c<=0&&g<=0&&this.width<=C&&this.height<=S){if(D)return!0;for(let G=0;G<this.boxKeys.length;G++)B.push({key:this.boxKeys[G],x1:this.bboxes[4*G],y1:this.bboxes[4*G+1],x2:this.bboxes[4*G+2],y2:this.bboxes[4*G+3]});for(let G=0;G<this.circleKeys.length;G++){const J=this.circles[3*G],ee=this.circles[3*G+1],oe=this.circles[3*G+2];B.push({key:this.circleKeys[G],x1:J-oe,y1:ee-oe,x2:J+oe,y2:ee+oe})}return L?B.filter(L):B}return this._forEachCell(c,g,C,S,this._queryCell,B,{hitTest:D,seenUids:{box:{},circle:{}}},L),D?B.length>0:B}_queryCircle(c,g,C,S,D){const L=c-C,B=c+C,G=g-C,J=g+C;if(B<0||L>this.width||J<0||G>this.height)return!S&&[];const ee=[];return this._forEachCell(L,G,B,J,this._queryCellCircle,ee,{hitTest:S,circle:{x:c,y:g,radius:C},seenUids:{box:{},circle:{}}},D),S?ee.length>0:ee}query(c,g,C,S,D){return this._query(c,g,C,S,!1,D)}hitTest(c,g,C,S,D){return this._query(c,g,C,S,!0,D)}hitTestCircle(c,g,C,S){return this._queryCircle(c,g,C,!0,S)}_queryCell(c,g,C,S,D,L,B,G){const J=B.seenUids,ee=this.boxCells[D];if(null!==ee){const de=this.bboxes;for(const ge of ee)if(!J.box[ge]){J.box[ge]=!0;const ue=4*ge;if(c<=de[ue+2]&&g<=de[ue+3]&&C>=de[ue+0]&&S>=de[ue+1]&&(!G||G(this.boxKeys[ge]))){if(B.hitTest)return L.push(!0),!0;L.push({key:this.boxKeys[ge],x1:de[ue],y1:de[ue+1],x2:de[ue+2],y2:de[ue+3]})}}}const oe=this.circleCells[D];if(null!==oe){const de=this.circles;for(const ge of oe)if(!J.circle[ge]){J.circle[ge]=!0;const ue=3*ge;if(this._circleAndRectCollide(de[ue],de[ue+1],de[ue+2],c,g,C,S)&&(!G||G(this.circleKeys[ge]))){if(B.hitTest)return L.push(!0),!0;{const ye=de[ue],be=de[ue+1],ce=de[ue+2];L.push({key:this.circleKeys[ge],x1:ye-ce,y1:be-ce,x2:ye+ce,y2:be+ce})}}}}}_queryCellCircle(c,g,C,S,D,L,B,G){const J=B.circle,ee=B.seenUids,oe=this.boxCells[D];if(null!==oe){const ge=this.bboxes;for(const ue of oe)if(!ee.box[ue]){ee.box[ue]=!0;const ye=4*ue;if(this._circleAndRectCollide(J.x,J.y,J.radius,ge[ye+0],ge[ye+1],ge[ye+2],ge[ye+3])&&(!G||G(this.boxKeys[ue])))return L.push(!0),!0}}const de=this.circleCells[D];if(null!==de){const ge=this.circles;for(const ue of de)if(!ee.circle[ue]){ee.circle[ue]=!0;const ye=3*ue;if(this._circlesCollide(ge[ye],ge[ye+1],ge[ye+2],J.x,J.y,J.radius)&&(!G||G(this.circleKeys[ue])))return L.push(!0),!0}}}_forEachCell(c,g,C,S,D,L,B,G){const J=this._convertToXCellCoord(c),ee=this._convertToYCellCoord(g),oe=this._convertToXCellCoord(C),de=this._convertToYCellCoord(S);for(let ge=J;ge<=oe;ge++)for(let ue=ee;ue<=de;ue++)if(D.call(this,c,g,C,S,this.xCellCount*ue+ge,L,B,G))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,g,C,S,D,L){const B=S-c,G=D-g,J=C+L;return J*J>B*B+G*G}_circleAndRectCollide(c,g,C,S,D,L,B){const G=(L-S)/2,J=Math.abs(c-(S+G));if(J>G+C)return!1;const ee=(B-D)/2,oe=Math.abs(g-(D+ee));if(oe>ee+C)return!1;if(J<=G||oe<=ee)return!0;const de=J-G,ge=oe-ee;return de*de+ge*ge<=C*C}}const us=Math.tan(85*Math.PI/180);function As(v,c,g,C,S,D,L){const B=_.create();if(g)if("globe"===D.name){const G=_.calculateGlobeLabelMatrix(S,c);_.multiply(B,B,G)}else{const G=Ct([],L);B[0]=G[0],B[1]=G[1],B[4]=G[2],B[5]=G[3],C||_.rotateZ(B,B,S.angle)}else _.multiply(B,S.labelPlaneMatrix,v);return B}function Mn(v,c,g,C,S,D,L){const B=As(v,c,g,C,S,D,L);return"globe"===D.name&&g||(B[2]=B[6]=B[10]=B[14]=0),B}function Ti(v,c,g,C,S,D,L){if(g){if("globe"===D.name){const B=As(v,c,g,C,S,D,L);return _.invert(B,B),_.multiply(B,v,B),B}{const B=_.clone(v),G=_.identity([]);return G[0]=L[0],G[1]=L[1],G[4]=L[2],G[5]=L[3],_.multiply(B,B,G),C||_.rotateZ(B,B,-S.angle),B}}return S.glCoordMatrix}function Nt(v,c,g,C){const S=[v,c,g,1];g?_.transformMat4$1(S,S,C):_d(S,S,C);const D=S[3];return S[0]/=D,S[1]/=D,S[2]/=D,S}function ri(v,c){return Math.min(.5+v/c*.5,1.5)}function _i(v,c){const g=v[0]/v[3],C=v[1]/v[3];return g>=-c[0]&&g<=c[0]&&C>=-c[1]&&C<=c[1]}function ur(v,c,g,C,S,D,L,B,G,J){const ee=g.transform,oe=C?v.textSizeData:v.iconSizeData,de=_.evaluateSizeForZoom(oe,g.transform.zoom),ge="globe"===ee.projection.name,ue=[256/g.width*2+1,256/g.height*2+1],ye=C?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;ye.clear();let be=null;ge&&(be=C?v.text.globeExtVertexArray:v.icon.globeExtVertexArray);const ce=v.lineVertexArray,Te=C?v.text.placedSymbolArray:v.icon.placedSymbolArray,ve=g.transform.width/g.transform.height;let De,Fe=!1;for(let Re=0;Re<Te.length;Re++){const Ue=Te.get(Re),{numGlyphs:Ze,writingMode:nt}=Ue;if(nt!==_.WritingMode.vertical||Fe||De===_.WritingMode.horizontal||(Fe=!0),De=nt,(Ue.hidden||nt===_.WritingMode.vertical)&&!Fe){ji(Ze,ye);continue}Fe=!1;const ot=new _.pointGeometry(Ue.tileAnchorX,Ue.tileAnchorY);let{x:Ut,y:Qe,z:St}=ee.projection.projectTilePoint(ot.x,ot.y,J.canonical);if(G){const[Yn,gn,Yt]=G(ot);Ut+=Yn,Qe+=gn,St+=Yt}const at=[Ut,Qe,St,1];if(_.transformMat4$1(at,at,c),!_i(at,ue)){ji(Ze,ye);continue}const Ot=ri(g.transform.cameraToCenterDistance,at[3]),et=_.evaluateSizeForFeature(oe,de,Ue),qe=L?et/Ot:et*Ot,Xe=Nt(Ut,Qe,St,S);if(Xe[3]<=0){ji(Ze,ye);continue}let Mt={};const Lt=L?null:G,dn=Bo(Ue,qe,!1,B,c,S,D,v.glyphOffsetArray,ce,ye,be,Xe,ot,Mt,ve,Lt,ee.projection,J,L);Fe=dn.useVertical,Lt&&dn.needsFlipping&&(Mt={}),(dn.notEnoughRoom||Fe||dn.needsFlipping&&Bo(Ue,qe,!0,B,c,S,D,v.glyphOffsetArray,ce,ye,be,Xe,ot,Mt,ve,Lt,ee.projection,J,L).notEnoughRoom)&&ji(Ze,ye)}C?(v.text.dynamicLayoutVertexBuffer.updateData(ye),be&&v.text.globeExtVertexBuffer.updateData(be)):(v.icon.dynamicLayoutVertexBuffer.updateData(ye),be&&v.icon.globeExtVertexBuffer.updateData(be))}function Ps(v,c,g,C,S,D,L,B,G,J,ee,oe,de,ge,ue,ye){const{lineStartIndex:be,glyphStartIndex:ce,segment:Te}=B,ve=ce+B.numGlyphs,De=be+B.lineLength,Fe=c.getoffsetX(ce),Re=c.getoffsetX(ve-1),Ue=Vo(v*Fe,g,C,S,D,L,Te,be,De,G,J,ee,oe,de,!0,ge,ue,ye);if(!Ue)return null;const Ze=Vo(v*Re,g,C,S,D,L,Te,be,De,G,J,ee,oe,de,!0,ge,ue,ye);return Ze?{first:Ue,last:Ze}:null}function Gn(v,c,g,C){return v===_.WritingMode.horizontal&&Math.abs(C)>Math.abs(g)?{useVertical:!0}:v===_.WritingMode.vertical?C>0?{needsFlipping:!0}:null:0!==c&&(0===(S=g)||Math.abs(C/S)>us)?1===c?{needsFlipping:!0}:null:g<0?{needsFlipping:!0}:null;var S}function Bo(v,c,g,C,S,D,L,B,G,J,ee,oe,de,ge,ue,ye,be,ce,Te){const ve=c/24,De=v.lineOffsetX*ve,Fe=v.lineOffsetY*ve,{lineStartIndex:Re,glyphStartIndex:Ue,numGlyphs:Ze,segment:nt,writingMode:ot,flipState:Ut}=v,Qe=Re+v.lineLength,St=at=>{if(ee){const[Xe,Mt,Lt]=at.up,dn=J.length;_.updateGlobeVertexNormal(ee,dn+0,Xe,Mt,Lt),_.updateGlobeVertexNormal(ee,dn+1,Xe,Mt,Lt),_.updateGlobeVertexNormal(ee,dn+2,Xe,Mt,Lt),_.updateGlobeVertexNormal(ee,dn+3,Xe,Mt,Lt)}const[Ot,et,qe]=at.point;_.addDynamicAttributes(J,Ot,et,qe,at.angle)};if(Ze>1){const at=Ps(ve,B,De,Fe,g,oe,de,v,G,D,ge,ye,!1,be,ce,Te);if(!at)return{notEnoughRoom:!0};if(C&&!g){let[Ot,et,qe]=at.first.point,[Xe,Mt,Lt]=at.last.point;[Ot,et]=Nt(Ot,et,qe,L),[Xe,Mt]=Nt(Xe,Mt,Lt,L);const dn=Gn(ot,Ut,(Xe-Ot)*ue,Mt-et);if(v.flipState=dn&&dn.needsFlipping?1:2,dn)return dn}St(at.first);for(let Ot=Ue+1;Ot<Ue+Ze-1;Ot++){const et=Vo(ve*B.getoffsetX(Ot),De,Fe,g,oe,de,nt,Re,Qe,G,D,ge,ye,!1,!1,be,ce,Te);if(!et)return J.length-=4*(Ot-Ue),{notEnoughRoom:!0};St(et)}St(at.last)}else{if(C&&!g){const Ot=Nt(de.x,de.y,0,S),et=Re+nt+1,qe=new _.pointGeometry(G.getx(et),G.gety(et)),Xe=Nt(qe.x,qe.y,0,S),Mt=Xe[3]>0?Xe:bi(de,qe,Ot,1,S,void 0,be,ce.canonical),Lt=Gn(ot,Ut,(Mt[0]-Ot[0])*ue,Mt[1]-Ot[1]);if(v.flipState=Lt&&Lt.needsFlipping?1:2,Lt)return Lt}const at=Vo(ve*B.getoffsetX(Ue),De,Fe,g,oe,de,nt,Re,Qe,G,D,ge,ye,!1,!1,be,ce,Te);if(!at)return{notEnoughRoom:!0};St(at)}return{}}function Cl(v,c,g,C,S){const{x:D,y:L,z:B}=C.projectTilePoint(v.x,v.y,c);if(!S)return Nt(D,L,B,g);const[G,J,ee]=S(v);return Nt(D+G,L+J,B+ee,g)}function bi(v,c,g,C,S,D,L,B){const G=Cl(v.sub(c)._unit()._add(v),B,S,L,D);return _.sub(G,g,G),_.normalize(G,G),_.scaleAndAdd(G,g,G,C)}function Vo(v,c,g,C,S,D,L,B,G,J,ee,oe,de,ge,ue,ye,be,ce){const Te=C?v-c:v+c;let ve=Te>0?1:-1,De=0;C&&(ve*=-1,De=Math.PI),ve<0&&(De+=Math.PI);let Fe=B+L+(ve>0?0:1)|0,Re=S,Ue=S,Ze=0,nt=0;const ot=Math.abs(Te),Ut=[],Qe=[];let St=D,at=St;const Ot=()=>bi(at,St,Ue,ot-Ze+1,ee,de,ye,be.canonical);for(;Ze+nt<=ot;){if(Fe+=ve,Fe<B||Fe>=G)return null;if(Ue=Re,at=St,Ut.push(Ue),ge&&Qe.push(at),St=new _.pointGeometry(J.getx(Fe),J.gety(Fe)),Re=oe[Fe],!Re){const Yt=Cl(St,be.canonical,ee,ye,de);Re=Yt[3]>0?oe[Fe]=Yt:Ot()}Ze+=nt,nt=_.distance(Ue,Re)}ue&&de&&(oe[Fe]&&(Re=Ot(),nt=_.distance(Ue,Re)),oe[Fe]=Re);const et=(ot-Ze)/nt,qe=St.sub(at)._mult(et)._add(at),Xe=_.sub([],Re,Ue),Mt=_.scaleAndAdd([],Ue,Xe,et);let Lt=[0,0,1],dn=Xe[0],Yn=Xe[1];if(ce&&(Lt=ye.upVector(be.canonical,qe.x,qe.y),0!==Lt[0]||0!==Lt[1]||1!==Lt[2])){const Yt=[Lt[2],0,-Lt[0]],yn=_.cross([],Lt,Yt);_.normalize(Yt,Yt),_.normalize(yn,yn),dn=_.dot(Xe,Yt),Yn=_.dot(Xe,yn)}if(g){const Yt=_.cross([],Lt,Xe);_.normalize(Yt,Yt),_.scaleAndAdd(Mt,Mt,Yt,g*ve)}const gn=De+Math.atan2(Yn,dn);return Ut.push(Mt),ge&&Qe.push(qe),{point:Mt,angle:gn,path:Ut,tilePath:Qe,up:Lt}}function ji(v,c){const g=c.length,C=g+4*v;c.resize(C),c.float32.fill(-1/0,4*g,4*C)}function _d(v,c,g){const C=c[0],S=c[1];return v[0]=g[0]*C+g[4]*S+g[12],v[1]=g[1]*C+g[5]*S+g[13],v[3]=g[3]*C+g[7]*S+g[15],v}const co=100;class ds{constructor(c,g,C=new oh(c.width+200,c.height+200,25),S=new oh(c.width+200,c.height+200,25)){this.transform=c,this.grid=C,this.ignoredGrid=S,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+co,this.screenBottomBoundary=c.height+co,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.fogState=g}placeCollisionBox(c,g,C,S,D,L,B,G){let J=C.projectedAnchorX,ee=C.projectedAnchorY,oe=C.projectedAnchorZ;const de=C.elevation,ge=C.tileID,ue=c.getProjection();if(de&&ge){const[Re,Ue,Ze]=ue.upVector(ge.canonical,C.tileAnchorX,C.tileAnchorY),nt=ue.upVectorScale(ge.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;J+=Re*de*nt,ee+=Ue*de*nt,oe+=Ze*de*nt}const ye=this.projectAndGetPerspectiveRatio(B,J,ee,oe,C.tileID,"globe"===ue.name||!!de||this.transform.pitch>0,ue),be=L*ye.perspectiveRatio,ce=(C.x1*g+S.x-C.padding)*be+ye.point.x,Te=(C.y1*g+S.y-C.padding)*be+ye.point.y,ve=(C.x2*g+S.x+C.padding)*be+ye.point.x,De=(C.y2*g+S.y+C.padding)*be+ye.point.y,Fe=ye.perspectiveRatio<=.55||ye.occluded;return!this.isInsideGrid(ce,Te,ve,De)||!D&&this.grid.hitTest(ce,Te,ve,De,G)||Fe?{box:[],offscreen:!1,occluded:ye.occluded}:{box:[ce,Te,ve,De],offscreen:this.isOffscreen(ce,Te,ve,De),occluded:!1}}placeCollisionCircles(c,g,C,S,D,L,B,G,J,ee,oe,de,ge,ue,ye){const be=[],ce=this.transform.elevation,Te=c.getProjection(),ve=ce?ce.getAtTileOffsetFunc(ye,this.transform.center.lat,this.transform.worldSize,Te):null,De=new _.pointGeometry(C.tileAnchorX,C.tileAnchorY);let{x:Fe,y:Re,z:Ue}=Te.projectTilePoint(De.x,De.y,ye.canonical);if(ve){const[qe,Xe,Mt]=ve(De);Fe+=qe,Re+=Xe,Ue+=Mt}const Ze="globe"===Te.name,nt=this.projectAndGetPerspectiveRatio(B,Fe,Re,Ue,ye,Ze||!!ce||this.transform.pitch>0,Te),{perspectiveRatio:ot}=nt,Ut=(oe?L/ot:L*ot)/_.ONE_EM,Qe=Nt(Fe,Re,Ue,G),St=nt.signedDistanceFromCamera>0?Ps(Ut,D,C.lineOffsetX*Ut,C.lineOffsetY*Ut,!1,Qe,De,C,S,G,{},ce&&!oe?ve:null,oe&&!!ce,Te,ye,oe):null;let at=!1,Ot=!1,et=!0;if(St&&!nt.occluded){const qe=.5*ge*ot+ue,Xe=new _.pointGeometry(-100,-100),Mt=new _.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Lt=new Ya,{first:dn,last:Yn}=St,gn=dn.path.length;let Yt=[];for(let Bn=gn-1;Bn>=1;Bn--)Yt.push(dn.path[Bn]);for(let Bn=1;Bn<Yn.path.length;Bn++)Yt.push(Yn.path[Bn]);const yn=2.5*qe;J&&(Yt=Yt.map(([Bn,er,Fi],sr)=>(ve&&!Ze&&(Fi=ve(sr<gn-1?dn.tilePath[gn-1-sr]:Yn.tilePath[sr-gn+2])[2]),Nt(Bn,er,Fi,J))),Yt.some(Bn=>Bn[3]<=0)&&(Yt=[]));let xi=[];if(Yt.length>0){let Bn=1/0,er=-1/0,Fi=1/0,sr=-1/0;for(const vi of Yt)Bn=Math.min(Bn,vi[0]),Fi=Math.min(Fi,vi[1]),er=Math.max(er,vi[0]),sr=Math.max(sr,vi[1]);er>=Xe.x&&Bn<=Mt.x&&sr>=Xe.y&&Fi<=Mt.y&&(xi=[Yt.map(vi=>new _.pointGeometry(vi[0],vi[1]))],(Bn<Xe.x||er>Mt.x||Fi<Xe.y||sr>Mt.y)&&(xi=_.clipLine(xi,Xe.x,Xe.y,Mt.x,Mt.y)))}for(const Bn of xi){Lt.reset(Bn,.25*qe);let er=0;er=Lt.length<=.5*qe?1:Math.ceil(Lt.paddedLength/yn)+1;for(let Fi=0;Fi<er;Fi++){const sr=Fi/Math.max(er-1,1),vi=Lt.lerp(sr),Mr=vi.x+co,Ys=vi.y+co;be.push(Mr,Ys,qe,0);const Gs=Mr-qe,Fa=Ys-qe,Er=Mr+qe,ar=Ys+qe;if(et=et&&this.isOffscreen(Gs,Fa,Er,ar),Ot=Ot||this.isInsideGrid(Gs,Fa,Er,ar),!g&&this.grid.hitTestCircle(Mr,Ys,qe,de)&&(at=!0,!ee))return{circles:[],offscreen:!1,collisionDetected:at,occluded:!1}}}}return{circles:!ee&&at||!Ot?[]:be,offscreen:et,collisionDetected:at,occluded:nt.occluded}}queryRenderedSymbols(c){if(0===c.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const g=[];let C=1/0,S=1/0,D=-1/0,L=-1/0;for(const ee of c){const oe=new _.pointGeometry(ee.x+co,ee.y+co);C=Math.min(C,oe.x),S=Math.min(S,oe.y),D=Math.max(D,oe.x),L=Math.max(L,oe.y),g.push(oe)}const B=this.grid.query(C,S,D,L).concat(this.ignoredGrid.query(C,S,D,L)),G={},J={};for(const ee of B){const oe=ee.key;if(void 0===G[oe.bucketInstanceId]&&(G[oe.bucketInstanceId]={}),G[oe.bucketInstanceId][oe.featureIndex])continue;const de=[new _.pointGeometry(ee.x1,ee.y1),new _.pointGeometry(ee.x2,ee.y1),new _.pointGeometry(ee.x2,ee.y2),new _.pointGeometry(ee.x1,ee.y2)];_.polygonIntersectsPolygon(g,de)&&(G[oe.bucketInstanceId][oe.featureIndex]=!0,void 0===J[oe.bucketInstanceId]&&(J[oe.bucketInstanceId]=[]),J[oe.bucketInstanceId].push(oe.featureIndex))}return J}insertCollisionBox(c,g,C,S,D){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:S,collisionGroupID:D},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,g,C,S,D){const L=g?this.ignoredGrid:this.grid,B={bucketInstanceId:C,featureIndex:S,collisionGroupID:D};for(let G=0;G<c.length;G+=4)L.insertCircle(B,c[G],c[G+1],c[G+2])}projectAndGetPerspectiveRatio(c,g,C,S,D,L,B){const G=[g,C,S,1];let J=!1;S||this.transform.pitch>0?(_.transformMat4$1(G,G,c),this.fogState&&D&&"globe"!==B.name&&(J=function(ge,ue,ye,be,ce,Te){const ve=Te.calculateFogTileMatrix(ce),De=[ue,ye,be];return _.transformMat4(De,De,ve),On(ge,De,Te.pitch,Te._fov)}(this.fogState,g,C,S,D.toUnwrapped(),this.transform)>.9)):_d(G,G,c);const ee=G[3];return{point:new _.pointGeometry((G[0]/ee+1)/2*this.transform.width+co,(-G[1]/ee+1)/2*this.transform.height+co),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(B)/ee*.5,1.5),signedDistanceFromCamera:ee,occluded:L&&G[2]>ee||J}}isOffscreen(c,g,C,S){return C<co||c>=this.screenRightBoundary||S<co||g>this.screenBottomBoundary}isInsideGrid(c,g,C,S){return C>=0&&c<this.gridRightBoundary&&S>=0&&g<this.gridBottomBoundary}getViewportMatrix(){const c=_.identity([]);return _.translate(c,c,[-100,-100,0]),c}}function Us(v,c,g){const C=c.createTileMatrix(v,v.worldSize,g.toUnwrapped());return _.multiply(new Float32Array(16),v.projMatrix,C)}function sa(v,c,g){if(c.projection.name===g.projection.name)return v.projMatrix;const C=g.clone();return C.setProjection(c.projection),Us(C,c.getProjection(),v)}function bo(v,c,g){return c.name===g.projection.name?v.projMatrix:Us(g,c,v)}class aa{constructor(c,g,C,S){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?g:-g))):S&&C?1:0,this.placed=C}isHidden(){return 0===this.opacity&&!this.placed}}class Fc{constructor(c,g,C,S,D,L=!1){this.text=new aa(c?c.text:null,g,C,D),this.icon=new aa(c?c.icon:null,g,S,D),this.clipped=L}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class yi{constructor(c,g,C,S=!1){this.text=c,this.icon=g,this.skipFade=C,this.clipped=S}}class xp{constructor(){this.invProjMatrix=_.create(),this.viewportMatrix=_.create(),this.circles=[]}}class Zo{constructor(c,g,C,S,D){this.bucketInstanceId=c,this.featureIndex=g,this.sourceLayerIndex=C,this.bucketIndex=S,this.tileID=D}}class Jr{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const g=++this.maxGroupID;this.collisionGroups[c]={ID:g,predicate:C=>C.collisionGroupID===g}}return this.collisionGroups[c]}}function El(v,c,g,C,S){const{horizontalAlign:D,verticalAlign:L}=_.getAnchorAlignment(v),B=-(D-.5)*c,G=-(L-.5)*g,J=_.evaluateVariableOffset(v,C);return new _.pointGeometry(B+J[0]*S,G+J[1]*S)}function nc(v,c,g,C,S){const D=new _.pointGeometry(v,c);return g&&D._rotate(C?S:-S),D}class xo{constructor(c,g,C,S,D){this.transform=c.clone(),this.projection=c.projection.name,this.collisionIndex=new ds(this.transform,D),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new Jr(C),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,g,C,S){const D=C.getBucket(g),L=C.latestFeatureIndex;if(!D||!L||g.id!==D.layerIds[0])return;const B=D.layers[0].layout,G=C.collisionBoxArray,J=Math.pow(2,this.transform.zoom-C.tileID.overscaledZ),ee=C.tileSize/_.EXTENT,oe=C.tileID.toUnwrapped();this.transform.setProjection(D.projection);const de=(ge=C.tileID,ue=D.getProjection(),ye=this.transform,ue.name===this.projection?ye.calculateProjMatrix(ge.toUnwrapped()):Us(ye,ue,ge));var ge,ue,ye;const be="map"===B.get("text-pitch-alignment"),ce="map"===B.get("text-rotation-alignment");g.compileFilter();const Te=g.dynamicFilter(),ve=g.dynamicFilterNeedsFeature(),De=this.transform.calculatePixelsToTileUnitsMatrix(C),Fe=Mn(de,C.tileID.canonical,be,ce,this.transform,D.getProjection(),De);let Re=null;if(be){const nt=Ti(de,C.tileID.canonical,be,ce,this.transform,D.getProjection(),De);Re=_.multiply([],this.transform.labelPlaneMatrix,nt)}let Ue=null;Te&&C.latestFeatureIndex&&(Ue={unwrappedTileID:oe,dynamicFilter:Te,dynamicFilterNeedsFeature:ve,featureIndex:C.latestFeatureIndex}),this.retainedQueryData[D.bucketInstanceId]=new Zo(D.bucketInstanceId,L,D.sourceLayerIndex,D.index,C.tileID);const Ze={bucket:D,layout:B,posMatrix:de,textLabelPlaneMatrix:Fe,labelToScreenMatrix:Re,clippingData:Ue,scale:J,textPixelRatio:ee,holdingForFade:C.holdingForFade(),collisionBoxArray:G,partiallyEvaluatedTextSize:_.evaluateSizeForZoom(D.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:_.evaluateSizeForZoom(D.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(D.sourceID)};if(S)for(const nt of D.sortKeyRanges){const{sortKey:ot,symbolInstanceStart:Ut,symbolInstanceEnd:Qe}=nt;c.push({sortKey:ot,symbolInstanceStart:Ut,symbolInstanceEnd:Qe,parameters:Ze})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:D.symbolInstances.length,parameters:Ze})}attemptAnchorPlacement(c,g,C,S,D,L,B,G,J,ee,oe,de,ge,ue,ye,be,ce,Te){const{textOffset0:ve,textOffset1:De,crossTileID:Fe}=de,Re=[ve,De],Ue=El(c,C,S,Re,D),Ze=this.collisionIndex.placeCollisionBox(ue,D,g,nc(Ue.x,Ue.y,L,B,this.transform.angle),oe,G,J,ee.predicate);if(be){const nt=ue.getSymbolInstanceIconSize(Te,this.transform.zoom,de.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(ue,nt,be,nc(Ue.x,Ue.y,L,B,this.transform.angle),oe,G,J,ee.predicate).box.length)return}if(Ze.box.length>0){let nt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Fe]&&this.prevPlacement.placements[Fe]&&this.prevPlacement.placements[Fe].text&&(nt=this.prevPlacement.variableOffsets[Fe].anchor),this.variableOffsets[Fe]={textOffset:Re,width:C,height:S,anchor:c,textScale:D,prevAnchor:nt},this.markUsedJustification(ue,c,de,ye),ue.allowVerticalPlacement&&(this.markUsedOrientation(ue,ye,de),this.placedOrientations[Fe]=ye),{shift:Ue,placedGlyphBoxes:Ze}}}placeLayerBucketPart(c,g,C,S){const{bucket:D,layout:L,posMatrix:B,textLabelPlaneMatrix:G,labelToScreenMatrix:J,clippingData:ee,textPixelRatio:oe,holdingForFade:de,collisionBoxArray:ge,partiallyEvaluatedTextSize:ue,partiallyEvaluatedIconSize:ye,collisionGroup:be}=c.parameters,ce=L.get("text-optional"),Te=L.get("icon-optional"),ve=L.get("text-allow-overlap"),De=L.get("icon-allow-overlap"),Fe="map"===L.get("text-rotation-alignment"),Re="map"===L.get("text-pitch-alignment"),Ue="none"!==L.get("icon-text-fit"),Ze="viewport-y"===L.get("symbol-z-order");this.transform.setProjection(D.projection);let nt=ve&&(De||!D.hasIconData()||Te),ot=De&&(ve||!D.hasTextData()||ce);!D.collisionArrays&&ge&&D.deserializeCollisionBoxes(ge),C&&S&&D.updateCollisionDebugBuffers(this.transform.zoom,ge);const Ut=(Qe,St,at)=>{const{crossTileID:Ot,numVerticalGlyphVertices:et}=Qe;if(ee){const Er={zoom:this.transform.zoom,pitch:this.transform.pitch};let ar=null;if(ee.dynamicFilterNeedsFeature){const Ki=this.retainedQueryData[D.bucketInstanceId];ar=ee.featureIndex.loadFeature({featureIndex:Qe.featureIndex,bucketIndex:Ki.bucketIndex,sourceLayerIndex:Ki.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,ee.dynamicFilter)(Er,ar,this.retainedQueryData[D.bucketInstanceId].tileID.canonical,new _.pointGeometry(Qe.tileAnchorX,Qe.tileAnchorY),this.transform.calculateDistanceTileData(ee.unwrappedTileID)))return this.placements[Ot]=new yi(!1,!1,!1,!0),void(g[Ot]=!0)}if(g[Ot])return;if(de)return void(this.placements[Ot]=new yi(!1,!1,!1));let qe=!1,Xe=!1,Mt=!0,Lt=!1,dn=!1,Yn=null,gn={box:null,offscreen:null,occluded:null},Yt={box:null,offscreen:null,occluded:null},yn=null,xi=null,Bn=null,er=0,Fi=0,sr=0;at.textFeatureIndex?er=at.textFeatureIndex:Qe.useRuntimeCollisionCircles&&(er=Qe.featureIndex),at.verticalTextFeatureIndex&&(Fi=at.verticalTextFeatureIndex);const vi=Er=>{Er.tileID=this.retainedQueryData[D.bucketInstanceId].tileID;const ar=this.transform.elevation;(ar||Er.elevation)&&(Er.elevation=ar?ar.getAtTileOffset(Er.tileID,Er.tileAnchorX,Er.tileAnchorY):0)},Mr=at.textBox;if(Mr){vi(Mr);const Er=Ki=>{let Fr=_.WritingMode.horizontal;if(D.allowVerticalPlacement&&!Ki&&this.prevPlacement){const Xn=this.prevPlacement.placedOrientations[Ot];Xn&&(this.placedOrientations[Ot]=Xn,Fr=Xn,this.markUsedOrientation(D,Fr,Qe))}return Fr},ar=(Ki,Fr)=>{if(D.allowVerticalPlacement&&et>0&&at.verticalTextBox){for(const Xn of D.writingModes)if(Xn===_.WritingMode.vertical?(gn=Fr(),Yt=gn):gn=Ki(),gn&&gn.box&&gn.box.length)break}else gn=Ki()};if(L.get("text-variable-anchor")){let Ki=L.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ot]){const Li=this.prevPlacement.variableOffsets[Ot];Ki.indexOf(Li.anchor)>0&&(Ki=Ki.filter(xs=>xs!==Li.anchor),Ki.unshift(Li.anchor))}const Fr=(Li,xs,ho)=>{const dc=D.getSymbolInstanceTextSize(ue,Qe,this.transform.zoom,St),iu=(Li.x2-Li.x1)*dc+2*Li.padding,Wr=(Li.y2-Li.y1)*dc+2*Li.padding,Ks=Ue&&!De?xs:null;Ks&&vi(Ks);let ma={box:[],offscreen:!1,occluded:!1};const Ll=ve?2*Ki.length:Ki.length;for(let il=0;il<Ll;++il){const fo=this.attemptAnchorPlacement(Ki[il%Ki.length],Li,iu,Wr,dc,Fe,Re,oe,B,be,il>=Ki.length,Qe,St,D,ho,Ks,ue,ye);if(fo&&(ma=fo.placedGlyphBoxes,ma&&ma.box&&ma.box.length)){qe=!0,Yn=fo.shift;break}}return ma};ar(()=>Fr(Mr,at.iconBox,_.WritingMode.horizontal),()=>{const Li=at.verticalTextBox;return Li&&vi(Li),D.allowVerticalPlacement&&!(gn&&gn.box&&gn.box.length)&&et>0&&Li?Fr(Li,at.verticalIconBox,_.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),gn&&(qe=gn.box,Mt=gn.offscreen,Lt=gn.occluded);const Xn=Er(gn&&gn.box);if(!qe&&this.prevPlacement){const Li=this.prevPlacement.variableOffsets[Ot];Li&&(this.variableOffsets[Ot]=Li,this.markUsedJustification(D,Li.anchor,Qe,Xn))}}else{const Ki=(Fr,Xn)=>{const Li=D.getSymbolInstanceTextSize(ue,Qe,this.transform.zoom,St),xs=this.collisionIndex.placeCollisionBox(D,Li,Fr,new _.pointGeometry(0,0),ve,oe,B,be.predicate);return xs&&xs.box&&xs.box.length&&(this.markUsedOrientation(D,Xn,Qe),this.placedOrientations[Ot]=Xn),xs};ar(()=>Ki(Mr,_.WritingMode.horizontal),()=>{const Fr=at.verticalTextBox;return D.allowVerticalPlacement&&et>0&&Fr?(vi(Fr),Ki(Fr,_.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Er(gn&&gn.box&&gn.box.length)}}if(yn=gn,qe=yn&&yn.box&&yn.box.length>0,Mt=yn&&yn.offscreen,Lt=yn&&yn.occluded,Qe.useRuntimeCollisionCircles){const Er=D.text.placedSymbolArray.get(Qe.centerJustifiedTextSymbolIndex>=0?Qe.centerJustifiedTextSymbolIndex:Qe.verticalPlacedTextSymbolIndex),ar=_.evaluateSizeForFeature(D.textSizeData,ue,Er),Ki=L.get("text-padding");xi=this.collisionIndex.placeCollisionCircles(D,ve,Er,D.lineVertexArray,D.glyphOffsetArray,ar,B,G,J,C,Re,be.predicate,Qe.collisionCircleDiameter*ar/_.ONE_EM,Ki,this.retainedQueryData[D.bucketInstanceId].tileID),qe=ve||xi.circles.length>0&&!xi.collisionDetected,Mt=Mt&&xi.offscreen,Lt=xi.occluded}if(at.iconFeatureIndex&&(sr=at.iconFeatureIndex),at.iconBox){const Er=ar=>{vi(ar);const Ki=Ue&&Yn?nc(Yn.x,Yn.y,Fe,Re,this.transform.angle):new _.pointGeometry(0,0),Fr=D.getSymbolInstanceIconSize(ye,this.transform.zoom,Qe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(D,Fr,ar,Ki,De,oe,B,be.predicate)};Yt&&Yt.box&&Yt.box.length&&at.verticalIconBox?(Bn=Er(at.verticalIconBox),Xe=Bn.box.length>0):(Bn=Er(at.iconBox),Xe=Bn.box.length>0),Mt=Mt&&Bn.offscreen,dn=Bn.occluded}const Ys=ce||0===Qe.numHorizontalGlyphVertices&&0===et,Gs=Te||0===Qe.numIconVertices;if(Ys||Gs?Gs?Ys||(Xe=Xe&&qe):qe=Xe&&qe:Xe=qe=Xe&&qe,qe&&yn&&yn.box&&this.collisionIndex.insertCollisionBox(yn.box,L.get("text-ignore-placement"),D.bucketInstanceId,Yt&&Yt.box&&Fi?Fi:er,be.ID),Xe&&Bn&&this.collisionIndex.insertCollisionBox(Bn.box,L.get("icon-ignore-placement"),D.bucketInstanceId,sr,be.ID),xi&&(qe&&this.collisionIndex.insertCollisionCircles(xi.circles,L.get("text-ignore-placement"),D.bucketInstanceId,er,be.ID),C)){const Er=D.bucketInstanceId;let ar=this.collisionCircleArrays[Er];void 0===ar&&(ar=this.collisionCircleArrays[Er]=new xp);for(let Ki=0;Ki<xi.circles.length;Ki+=4)ar.circles.push(xi.circles[Ki+0]),ar.circles.push(xi.circles[Ki+1]),ar.circles.push(xi.circles[Ki+2]),ar.circles.push(xi.collisionDetected?1:0)}const Fa="globe"!==D.projection.name;nt=nt&&(Fa||!Lt),ot=ot&&(Fa||!dn),this.placements[Ot]=new yi(qe||nt,Xe||ot,Mt||D.justReloaded),g[Ot]=!0};if(Ze){const Qe=D.getSortedSymbolIndexes(this.transform.angle);for(let St=Qe.length-1;St>=0;--St){const at=Qe[St];Ut(D.symbolInstances.get(at),at,D.collisionArrays[at])}}else for(let Qe=c.symbolInstanceStart;Qe<c.symbolInstanceEnd;Qe++)Ut(D.symbolInstances.get(Qe),Qe,D.collisionArrays[Qe]);if(C&&D.bucketInstanceId in this.collisionCircleArrays){const Qe=this.collisionCircleArrays[D.bucketInstanceId];_.invert(Qe.invProjMatrix,B),Qe.viewportMatrix=this.collisionIndex.getViewportMatrix()}D.justReloaded=!1}markUsedJustification(c,g,C,S){const{leftJustifiedTextSymbolIndex:D,centerJustifiedTextSymbolIndex:L,rightJustifiedTextSymbolIndex:B,verticalPlacedTextSymbolIndex:G,crossTileID:J}=C,ee=_.getAnchorJustification(g),oe=S===_.WritingMode.vertical?G:"left"===ee?D:"center"===ee?L:"right"===ee?B:-1;D>=0&&(c.text.placedSymbolArray.get(D).crossTileID=oe>=0&&D!==oe?0:J),L>=0&&(c.text.placedSymbolArray.get(L).crossTileID=oe>=0&&L!==oe?0:J),B>=0&&(c.text.placedSymbolArray.get(B).crossTileID=oe>=0&&B!==oe?0:J),G>=0&&(c.text.placedSymbolArray.get(G).crossTileID=oe>=0&&G!==oe?0:J)}markUsedOrientation(c,g,C){const S=g===_.WritingMode.horizontal||g===_.WritingMode.horizontalOnly?g:0,D=g===_.WritingMode.vertical?g:0,{leftJustifiedTextSymbolIndex:L,centerJustifiedTextSymbolIndex:B,rightJustifiedTextSymbolIndex:G,verticalPlacedTextSymbolIndex:J}=C,ee=c.text.placedSymbolArray;L>=0&&(ee.get(L).placedOrientation=S),B>=0&&(ee.get(B).placedOrientation=S),G>=0&&(ee.get(G).placedOrientation=S),J>=0&&(ee.get(J).placedOrientation=D)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const g=this.prevPlacement;let C=!1;this.prevZoomAdjustment=g?g.zoomAdjustment(this.transform.zoom):0;const S=g?g.symbolFadeChange(c):1,D=g?g.opacities:{},L=g?g.variableOffsets:{},B=g?g.placedOrientations:{};for(const G in this.placements){const J=this.placements[G],ee=D[G];ee?(this.opacities[G]=new Fc(ee,S,J.text,J.icon,null,J.clipped),C=C||J.text!==ee.text.placed||J.icon!==ee.icon.placed):(this.opacities[G]=new Fc(null,S,J.text,J.icon,J.skipFade,J.clipped),C=C||J.text||J.icon)}for(const G in D){const J=D[G];if(!this.opacities[G]){const ee=new Fc(J,S,!1,!1);ee.isHidden()||(this.opacities[G]=ee,C=C||J.text.placed||J.icon.placed)}}for(const G in L)this.variableOffsets[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.variableOffsets[G]=L[G]);for(const G in B)this.placedOrientations[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.placedOrientations[G]=B[G]);C?this.lastPlacementChangeTime=c:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=g?g.lastPlacementChangeTime:c)}updateLayerOpacities(c,g){const C={};for(const S of g){const D=S.getBucket(c);D&&S.latestFeatureIndex&&c.id===D.layerIds[0]&&this.updateBucketOpacities(D,C,S.collisionBoxArray)}}updateBucketOpacities(c,g,C){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const S=c.layers[0].layout,D=!!c.layers[0].dynamicFilter(),L=new Fc(null,0,!1,!1,!0),B=S.get("text-allow-overlap"),G=S.get("icon-allow-overlap"),J=S.get("text-variable-anchor"),ee="map"===S.get("text-rotation-alignment"),oe="map"===S.get("text-pitch-alignment"),de="none"!==S.get("icon-text-fit"),ge=new Fc(null,0,B&&(G||!c.hasIconData()||S.get("icon-optional")),G&&(B||!c.hasTextData()||S.get("text-optional")),!0);!c.collisionArrays&&C&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(C);const ue=(be,ce,Te)=>{for(let ve=0;ve<ce/4;ve++)be.opacityVertexArray.emplaceBack(Te)};let ye=0;for(let be=0;be<c.symbolInstances.length;be++){const ce=c.symbolInstances.get(be),{numHorizontalGlyphVertices:Te,numVerticalGlyphVertices:ve,crossTileID:De,numIconVertices:Fe}=ce;let Re=this.opacities[De];g[De]?Re=L:Re||(Re=ge,this.opacities[De]=Re),g[De]=!0;const Ue=Te>0||ve>0,Ze=Fe>0,nt=this.placedOrientations[De],ot=nt===_.WritingMode.vertical,Ut=nt===_.WritingMode.horizontal||nt===_.WritingMode.horizontalOnly;if(!Ue&&!Ze||Re.isHidden()||ye++,Ue){const Qe=Eu(Re.text);ue(c.text,Te,ot?Zs:Qe),ue(c.text,ve,Ut?Zs:Qe);const St=Re.text.isHidden(),{leftJustifiedTextSymbolIndex:at,centerJustifiedTextSymbolIndex:Ot,rightJustifiedTextSymbolIndex:et,verticalPlacedTextSymbolIndex:qe}=ce,Xe=c.text.placedSymbolArray,Mt=St||ot?1:0;at>=0&&(Xe.get(at).hidden=Mt),Ot>=0&&(Xe.get(Ot).hidden=Mt),et>=0&&(Xe.get(et).hidden=Mt),qe>=0&&(Xe.get(qe).hidden=St||Ut?1:0);const Lt=this.variableOffsets[De];Lt&&this.markUsedJustification(c,Lt.anchor,ce,nt);const dn=this.placedOrientations[De];dn&&(this.markUsedJustification(c,"left",ce,dn),this.markUsedOrientation(c,dn,ce))}if(Ze){const Qe=Eu(Re.icon),{placedIconSymbolIndex:St,verticalPlacedIconSymbolIndex:at}=ce,Ot=c.icon.placedSymbolArray,et=Re.icon.isHidden()?1:0;St>=0&&(ue(c.icon,Fe,ot?Zs:Qe),Ot.get(St).hidden=et),at>=0&&(ue(c.icon,ce.numVerticalIconVertices,Ut?Zs:Qe),Ot.get(at).hidden=et)}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const Qe=c.collisionArrays[be];if(Qe){let St=new _.pointGeometry(0,0),at=!0;if(Qe.textBox||Qe.verticalTextBox){if(J){const et=this.variableOffsets[De];et?(St=El(et.anchor,et.width,et.height,et.textOffset,et.textScale),ee&&St._rotate(oe?this.transform.angle:-this.transform.angle)):at=!1}D&&(at=!Re.clipped),Qe.textBox&&Cr(c.textCollisionBox.collisionVertexArray,Re.text.placed,!at||ot,St.x,St.y),Qe.verticalTextBox&&Cr(c.textCollisionBox.collisionVertexArray,Re.text.placed,!at||Ut,St.x,St.y)}const Ot=at&&Boolean(!Ut&&Qe.verticalIconBox);Qe.iconBox&&Cr(c.iconCollisionBox.collisionVertexArray,Re.icon.placed,Ot,de?St.x:0,de?St.y:0),Qe.verticalIconBox&&Cr(c.iconCollisionBox.collisionVertexArray,Re.icon.placed,!Ot,de?St.x:0,de?St.y:0)}}}if(c.fullyClipped=0===ye,c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){const be=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=be.invProjMatrix,c.placementViewportMatrix=be.viewportMatrix,c.collisionCircleArray=be.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return 0===this.fadeDuration?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,g){const C=this.zoomAtLastRecencyCheck===g?1-this.zoomAdjustment(g):1;return this.zoomAtLastRecencyCheck=g,this.commitTime+this.fadeDuration*C>c}setStale(){this.stale=!0}}function Cr(v,c,g,C,S){v.emplaceBack(c?1:0,g?1:0,C||0,S||0),v.emplaceBack(c?1:0,g?1:0,C||0,S||0),v.emplaceBack(c?1:0,g?1:0,C||0,S||0),v.emplaceBack(c?1:0,g?1:0,C||0,S||0)}const Um=Math.pow(2,25),Yo=Math.pow(2,24),Ji=Math.pow(2,17),Lc=Math.pow(2,16),Nc=Math.pow(2,9),js=Math.pow(2,8),zr=Math.pow(2,1);function Eu(v){if(0===v.opacity&&!v.placed)return 0;if(1===v.opacity&&v.placed)return 4294967295;const c=v.placed?1:0,g=Math.floor(127*v.opacity);return g*Um+c*Yo+g*Ji+c*Lc+g*Nc+c*js+g*zr+c}const Zs=0;class $s{constructor(c){this._sortAcrossTiles="viewport-y"!==c.layout.get("symbol-z-order")&&void 0!==c.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,g,C,S,D){const L=this._bucketParts;for(;this._currentTileIndex<c.length;)if(g.getBucketParts(L,S,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,D())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((B,G)=>B.sortKey-G.sortKey));this._currentPartIndex<L.length;){const B=L[this._currentPartIndex];if(g.placeLayerBucketPart(B,this._seenCrossTileIDs,C,0===B.symbolInstanceStart),this._currentPartIndex++,D())return!0}return!1}}class Tl{constructor(c,g,C,S,D,L,B,G){this.placement=new xo(c,D,L,B,G),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(c,g,C){const S=_.exported.now(),D=()=>{const L=_.exported.now()-S;return!this._forceFullPlacement&&L>2};for(;this._currentPlacementIndex>=0;){const L=g[c[this._currentPlacementIndex]],B=this.placement.collisionIndex.transform.zoom;if("symbol"===L.type&&(!L.minzoom||L.minzoom<=B)&&(!L.maxzoom||L.maxzoom>B)){if(this._inProgressLayer||(this._inProgressLayer=new $s(L)),this._inProgressLayer.continuePlacement(C[L.source],this.placement,this._showCollisionBoxes,L,D))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const uf=512/_.EXTENT/2;class jm{constructor(c,g,C){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=C;for(let S=0;S<g.length;S++){const D=g.get(S),L=D.key;this.indexedSymbolInstances[L]||(this.indexedSymbolInstances[L]=[]),this.indexedSymbolInstances[L].push({crossTileID:D.crossTileID,coord:this.getScaledCoordinates(D,c)})}}getScaledCoordinates(c,g){const C=uf/Math.pow(2,g.canonical.z-this.tileID.canonical.z);return{x:Math.floor((g.canonical.x*_.EXTENT+c.tileAnchorX)*C),y:Math.floor((g.canonical.y*_.EXTENT+c.tileAnchorY)*C)}}findMatches(c,g,C){const S=this.tileID.canonical.z<g.canonical.z?1:Math.pow(2,this.tileID.canonical.z-g.canonical.z);for(let D=0;D<c.length;D++){const L=c.get(D);if(L.crossTileID)continue;const B=this.indexedSymbolInstances[L.key];if(!B)continue;const G=this.getScaledCoordinates(L,g);for(const J of B)if(Math.abs(J.coord.x-G.x)<=S&&Math.abs(J.coord.y-G.y)<=S&&!C[J.crossTileID]){C[J.crossTileID]=!0,L.crossTileID=J.crossTileID;break}}}}class wp{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class yd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const g=Math.round((c-this.lng)/360);if(0!==g)for(const C in this.indexes){const S=this.indexes[C],D={};for(const L in S){const B=S[L];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+g),D[B.tileID.key]=B}this.indexes[C]=D}this.lng=c}addBucket(c,g,C){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===g.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let D=0;D<g.symbolInstances.length;D++)g.symbolInstances.get(D).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const S=this.usedCrossTileIDs[c.overscaledZ];for(const D in this.indexes){const L=this.indexes[D];if(Number(D)>c.overscaledZ)for(const B in L){const G=L[B];G.tileID.isChildOf(c)&&G.findMatches(g.symbolInstances,c,S)}else{const B=L[c.scaledTo(Number(D)).key];B&&B.findMatches(g.symbolInstances,c,S)}}for(let D=0;D<g.symbolInstances.length;D++){const L=g.symbolInstances.get(D);L.crossTileID||(L.crossTileID=C.generate(),S[L.crossTileID]=!0)}return void 0===this.indexes[c.overscaledZ]&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new jm(c,g.symbolInstances,g.bucketInstanceId),!0}removeBucketCrossTileIDs(c,g){for(const C in g.indexedSymbolInstances)for(const S of g.indexedSymbolInstances[C])delete this.usedCrossTileIDs[c][S.crossTileID]}removeStaleBuckets(c){let g=!1;for(const C in this.indexes){const S=this.indexes[C];for(const D in S)c[S[D].bucketInstanceId]||(this.removeBucketCrossTileIDs(C,S[D]),delete S[D],g=!0)}return g}}class Tu{constructor(){this.layerIndexes={},this.crossTileIDs=new wp,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,g,C,S){let D=this.layerIndexes[c.id];void 0===D&&(D=this.layerIndexes[c.id]=new yd);let L=!1;const B={};"globe"!==S.name&&D.handleWrapJump(C);for(const G of g){const J=G.getBucket(c);J&&c.id===J.layerIds[0]&&(J.bucketInstanceId||(J.bucketInstanceId=++this.maxBucketInstanceId),D.addBucket(G.tileID,J,this.crossTileIDs)&&(L=!0),B[J.bucketInstanceId]=!0)}return D.removeStaleBuckets(B)&&(L=!0),L}pruneUnusedLayers(c){const g={};c.forEach(C=>{g[C]=!0});for(const C in this.layerIndexes)g[C]||delete this.layerIndexes[C]}}const Iu=(v,c)=>_.emitValidationErrors(v,c&&c.filter(g=>"source.canvas"!==g.identifier)),Ka=_.pick($n,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Su=_.pick($n,["setCenter","setZoom","setBearing","setPitch"]),df={version:8,layers:[],sources:{}},vs={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class eo extends _.Evented{constructor(c,g={}){super(),this.map=c,this.dispatcher=new nn(ni(),this),this.imageManager=new un,this.imageManager.setEventedParent(this),this.glyphManager=new _.GlyphManager(c._requestManager,g.localFontFamily?_.LocalGlyphMode.all:g.localIdeographFontFamily?_.LocalGlyphMode.ideographs:_.LocalGlyphMode.none,g.localFontFamily||g.localIdeographFontFamily),this.crossTileSymbolIndex=new Tu,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",_.getReferrer());const C=this;this._rtlTextPluginCallback=eo.registerForPluginStateChange(S=>{C.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(D,L)=>{if(_.triggerPluginCompletionEvent(D),L&&L.every(B=>B))for(const B in C._sourceCaches){const G=C._sourceCaches[B],J=G.getSource().type;"vector"!==J&&"geojson"!==J||G.reload()}})}),this.on("data",S=>{if("source"!==S.dataType||"metadata"!==S.sourceDataType)return;const D=this.getSource(S.sourceId);if(D&&D.vectorLayerIds)for(const L in this._layers){const B=this._layers[L];B.source===D.id&&this._validateLayer(B)}})}loadURL(c,g={}){this.fire(new _.Event("dataloading",{dataType:"style"}));const C="boolean"==typeof g.validate?g.validate:!_.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,g.accessToken);const S=this.map._requestManager.transformRequest(c,_.ResourceType.Style);this._request=_.getJSON(S,(D,L)=>{this._request=null,D?this.fire(new _.ErrorEvent(D)):L&&this._load(L,C)})}loadJSON(c,g={}){this.fire(new _.Event("dataloading",{dataType:"style"})),this._request=_.exported.frame(()=>{this._request=null,this._load(c,!1!==g.validate)})}loadEmpty(){this.fire(new _.Event("dataloading",{dataType:"style"})),this._load(df,!1)}_updateLayerCount(c,g){const C=g?1:-1;c.is3D()&&(this._num3DLayers+=C),"circle"===c.type&&(this._numCircleLayers+=C),"symbol"===c.type&&(this._numSymbolLayers+=C)}_load(c,g){if(g&&Iu(this,_.validateStyle(c)))return;this._loaded=!0,this.stylesheet=_.clone$1(c),this._updateMapProjection();for(const S in c.sources)this.addSource(S,c.sources[S],{validate:!1});this._changed=!1,c.sprite?this._loadSprite(c.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(c.glyphs);const C=gi(this.stylesheet.layers);this._order=C.map(S=>S.id),this._layers={},this._serializedLayers={};for(let S of C)S=_.createStyleLayer(S),S.setEventedParent(this,{layer:{id:S.id}}),this._layers[S.id]=S,this._serializedLayers[S.id]=S.serialize(),this._updateLayerCount(S,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new zt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new _.Event("data",{dataType:"style"})),this.fire(new _.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(c){c?this.stylesheet.projection=c:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(c){this._spriteRequest=function(g,C,S){let D,L,B;const G=_.exported.devicePixelRatio>1?"@2x":"";let J=_.getJSON(C.transformRequest(C.normalizeSpriteURL(g,G,".json"),_.ResourceType.SpriteJSON),(de,ge)=>{J=null,B||(B=de,D=ge,oe())}),ee=_.getImage(C.transformRequest(C.normalizeSpriteURL(g,G,".png"),_.ResourceType.SpriteImage),(de,ge)=>{ee=null,B||(B=de,L=ge,oe())});function oe(){if(B)S(B);else if(D&&L){const de=_.exported.getImageData(L),ge={};for(const ue in D){const{width:ye,height:be,x:ce,y:Te,sdf:ve,pixelRatio:De,stretchX:Fe,stretchY:Re,content:Ue}=D[ue],Ze=new _.RGBAImage({width:ye,height:be});_.RGBAImage.copy(de,Ze,{x:ce,y:Te},{x:0,y:0},{width:ye,height:be}),ge[ue]={data:Ze,pixelRatio:De,sdf:ve,stretchX:Fe,stretchY:Re,content:Ue}}S(null,ge)}}return{cancel(){J&&(J.cancel(),J=null),ee&&(ee.cancel(),ee=null)}}}(c,this.map._requestManager,(g,C)=>{if(this._spriteRequest=null,g)this.fire(new _.ErrorEvent(g));else if(C)for(const S in C)this.imageManager.addImage(S,C[S]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new _.Event("data",{dataType:"style"}))})}_validateLayer(c){const g=this.getSource(c.source);if(!g)return;const C=c.sourceLayer;C&&("geojson"===g.type||g.vectorLayerIds&&-1===g.vectorLayerIds.indexOf(C))&&this.fire(new _.ErrorEvent(new Error(`Source layer "${C}" does not exist on source "${g.id}" as specified by style layer "${c.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this._sourceCaches)if(!this._sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const g=[];for(const C of c){const S=this._layers[C];"custom"!==S.type&&g.push(S.serialize())}return g}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const c in this._sourceCaches)if(this._sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(c){return!!this.terrain&&("function"==typeof c.isLayerDraped?c.isLayerDraped():vs[c.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(c){if(!this._loaded)return;const g=this._changed;if(this._changed){const S=Object.keys(this._updatedLayers),D=Object.keys(this._removedLayers);(S.length||D.length)&&this._updateWorkerLayers(S,D);for(const L in this._updatedSources){const B=this._updatedSources[L];"reload"===B?this._reloadSource(L):"clear"===B&&this._clearSource(L)}this._updateTilesForChangedImages();for(const L in this._updatedPaintProps)this._layers[L].updateTransitions(c);this.light.updateTransitions(c),this.fog&&this.fog.updateTransitions(c),this._resetUpdates()}const C={};for(const S in this._sourceCaches){const D=this._sourceCaches[S];C[S]=D.used,D.used=!1}for(const S of this._order){const D=this._layers[S];if(D.recalculate(c,this._availableImages),!D.isHidden(c.zoom)){const B=this._getLayerSourceCache(D);B&&(B.used=!0)}const L=this.map.painter;if(L){const B=D.getProgramIds();if(!B)continue;const G=D.getProgramConfiguration(c.zoom);for(const J of B)L.useProgram(J,G)}}for(const S in C){const D=this._sourceCaches[S];C[S]!==D.used&&D.getSource().fire(new _.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light.recalculate(c),this.terrain&&this.terrain.recalculate(c),this.fog&&this.fog.recalculate(c),this.z=c.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),g&&this.fire(new _.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const g in this._sourceCaches)this._sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,g){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:g})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(c){if(this._checkLoaded(),Iu(this,_.validateStyle(c)))return!1;(c=_.clone$1(c)).layers=gi(c.layers);const g=function(S,D){if(!S)return[{command:$n.setStyle,args:[D]}];let L=[];try{if(!$e(S.version,D.version))return[{command:$n.setStyle,args:[D]}];$e(S.center,D.center)||L.push({command:$n.setCenter,args:[D.center]}),$e(S.zoom,D.zoom)||L.push({command:$n.setZoom,args:[D.zoom]}),$e(S.bearing,D.bearing)||L.push({command:$n.setBearing,args:[D.bearing]}),$e(S.pitch,D.pitch)||L.push({command:$n.setPitch,args:[D.pitch]}),$e(S.sprite,D.sprite)||L.push({command:$n.setSprite,args:[D.sprite]}),$e(S.glyphs,D.glyphs)||L.push({command:$n.setGlyphs,args:[D.glyphs]}),$e(S.transition,D.transition)||L.push({command:$n.setTransition,args:[D.transition]}),$e(S.light,D.light)||L.push({command:$n.setLight,args:[D.light]}),$e(S.fog,D.fog)||L.push({command:$n.setFog,args:[D.fog]}),$e(S.projection,D.projection)||L.push({command:$n.setProjection,args:[D.projection]});const B={},G=[];!function(oe,de,ge,ue){let ye;for(ye in de=de||{},oe=oe||{})oe.hasOwnProperty(ye)&&(de.hasOwnProperty(ye)||fr(ye,ge,ue));for(ye in de)de.hasOwnProperty(ye)&&(oe.hasOwnProperty(ye)?$e(oe[ye],de[ye])||("geojson"===oe[ye].type&&"geojson"===de[ye].type&&Rr(oe,de,ye)?ge.push({command:$n.setGeoJSONSourceData,args:[ye,de[ye].data]}):Zi(ye,de,ge,ue)):hr(ye,de,ge))}(S.sources,D.sources,G,B);const J=[];S.layers&&S.layers.forEach(oe=>{oe.source&&B[oe.source]?L.push({command:$n.removeLayer,args:[oe.id]}):J.push(oe)});let ee=S.terrain;ee&&B[ee.source]&&(L.push({command:$n.setTerrain,args:[void 0]}),ee=void 0),L=L.concat(G),$e(ee,D.terrain)||L.push({command:$n.setTerrain,args:[D.terrain]}),function(oe,de,ge){de=de||[];const ue=(oe=oe||[]).map(Ao),ye=de.map(Ao),be=oe.reduce(cr,{}),ce=de.reduce(cr,{}),Te=ue.slice(),ve=Object.create(null);let De,Fe,Re,Ue,Ze,nt,ot;for(De=0,Fe=0;De<ue.length;De++)Re=ue[De],ce.hasOwnProperty(Re)?Fe++:(ge.push({command:$n.removeLayer,args:[Re]}),Te.splice(Te.indexOf(Re,Fe),1));for(De=0,Fe=0;De<ye.length;De++)Re=ye[ye.length-1-De],Te[Te.length-1-De]!==Re&&(be.hasOwnProperty(Re)?(ge.push({command:$n.removeLayer,args:[Re]}),Te.splice(Te.lastIndexOf(Re,Te.length-Fe),1)):Fe++,nt=Te[Te.length-De],ge.push({command:$n.addLayer,args:[ce[Re],nt]}),Te.splice(Te.length-De,0,Re),ve[Re]=!0);for(De=0;De<ye.length;De++)if(Re=ye[De],Ue=be[Re],Ze=ce[Re],!ve[Re]&&!$e(Ue,Ze))if($e(Ue.source,Ze.source)&&$e(Ue["source-layer"],Ze["source-layer"])&&$e(Ue.type,Ze.type)){for(ot in ut(Ue.layout,Ze.layout,ge,Re,null,$n.setLayoutProperty),ut(Ue.paint,Ze.paint,ge,Re,null,$n.setPaintProperty),$e(Ue.filter,Ze.filter)||ge.push({command:$n.setFilter,args:[Re,Ze.filter]}),$e(Ue.minzoom,Ze.minzoom)&&$e(Ue.maxzoom,Ze.maxzoom)||ge.push({command:$n.setLayerZoomRange,args:[Re,Ze.minzoom,Ze.maxzoom]}),Ue)Ue.hasOwnProperty(ot)&&"layout"!==ot&&"paint"!==ot&&"filter"!==ot&&"metadata"!==ot&&"minzoom"!==ot&&"maxzoom"!==ot&&(0===ot.indexOf("paint.")?ut(Ue[ot],Ze[ot],ge,Re,ot.slice(6),$n.setPaintProperty):$e(Ue[ot],Ze[ot])||ge.push({command:$n.setLayerProperty,args:[Re,ot,Ze[ot]]}));for(ot in Ze)Ze.hasOwnProperty(ot)&&!Ue.hasOwnProperty(ot)&&"layout"!==ot&&"paint"!==ot&&"filter"!==ot&&"metadata"!==ot&&"minzoom"!==ot&&"maxzoom"!==ot&&(0===ot.indexOf("paint.")?ut(Ue[ot],Ze[ot],ge,Re,ot.slice(6),$n.setPaintProperty):$e(Ue[ot],Ze[ot])||ge.push({command:$n.setLayerProperty,args:[Re,ot,Ze[ot]]}))}else ge.push({command:$n.removeLayer,args:[Re]}),nt=Te[Te.lastIndexOf(Re)+1],ge.push({command:$n.addLayer,args:[Ze,nt]})}(J,D.layers,L)}catch(B){console.warn("Unable to compute style diff:",B),L=[{command:$n.setStyle,args:[D]}]}return L}(this.serialize(),c).filter(S=>!(S.command in Su));if(0===g.length)return!1;const C=g.filter(S=>!(S.command in Ka));if(C.length>0)throw new Error(`Unimplemented: ${C.map(S=>S.command).join(", ")}.`);return g.forEach(S=>{"setTransition"!==S.command&&"setProjection"!==S.command&&this[S.command].apply(this,S.args)}),this.stylesheet=c,this._updateMapProjection(),!0}addImage(c,g){return this.getImage(c)?this.fire(new _.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(c,g),this._afterImageUpdated(c),this)}updateImage(c,g){this.imageManager.updateImage(c,g)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){return this.getImage(c)?(this.imageManager.removeImage(c),this._afterImageUpdated(c),this):this.fire(new _.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new _.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(c,g,C={}){if(this._checkLoaded(),void 0!==this.getSource(c))throw new Error("There is already a source with this ID");if(!g.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(g).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(_.validateSource,`sources.${c}`,g,null,C))return;this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);const S=Be(c,g,this.dispatcher,this);S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(c),source:S.serialize(),sourceId:c}));const D=L=>{const B=(L?"symbol:":"other:")+c,G=this._sourceCaches[B]=new _.SourceCache(B,S,L);(L?this._symbolSourceCaches:this._otherSourceCaches)[c]=G,G.style=this,G.onAdd(this.map)};D(!1),"vector"!==g.type&&"geojson"!==g.type||D(!0),S.onAdd&&S.onAdd(this.map),this._changed=!0}removeSource(c){this._checkLoaded();const g=this.getSource(c);if(!g)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===c)return this.fire(new _.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.get().source===c)return this.fire(new _.ErrorEvent(new Error(`Source "${c}" cannot be removed while terrain is using it.`)));const C=this._getSourceCaches(c);for(const S of C)delete this._sourceCaches[S.id],delete this._updatedSources[S.id],S.fire(new _.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles();return delete this._otherSourceCaches[c],delete this._symbolSourceCaches[c],g.setEventedParent(null),g.onRemove&&g.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(c,g){this._checkLoaded(),this.getSource(c).setData(g),this._changed=!0}getSource(c){const g=this._getSourceCache(c);return g&&g.getSource()}_getSources(){const c=[];for(const g in this._otherSourceCaches){const C=this._getSourceCache(g);C&&c.push(C.getSource())}return c}addLayer(c,g,C={}){this._checkLoaded();const S=c.id;if(this.getLayer(S))return void this.fire(new _.ErrorEvent(new Error(`Layer with id "${S}" already exists on this map`)));let D;if("custom"===c.type){if(Iu(this,_.validateCustomStyleLayer(c)))return;D=_.createStyleLayer(c)}else{if("object"==typeof c.source&&(this.addSource(S,c.source),c=_.clone$1(c),c=_.extend(c,{source:S})),this._validate(_.validateLayer,`layers.${S}`,c,{arrayIndex:-1},C))return;D=_.createStyleLayer(c),this._validateLayer(D),D.setEventedParent(this,{layer:{id:S}}),this._serializedLayers[D.id]=D.serialize(),this._updateLayerCount(D,!0)}const L=g?this._order.indexOf(g):this._order.length;if(g&&-1===L)return void this.fire(new _.ErrorEvent(new Error(`Layer with id "${g}" does not exist on this map.`)));this._order.splice(L,0,S),this._layerOrderChanged=!0,this._layers[S]=D;const B=this._getLayerSourceCache(D);if(this._removedLayers[S]&&D.source&&B&&"custom"!==D.type){const G=this._removedLayers[S];delete this._removedLayers[S],G.type!==D.type?this._updatedSources[D.source]="clear":(this._updatedSources[D.source]="reload",B.pause())}this._updateLayer(D),D.onAdd&&D.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(c,g){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===g)return;const C=this._order.indexOf(c);this._order.splice(C,1);const S=g?this._order.indexOf(g):this._order.length;g&&-1===S?this.fire(new _.ErrorEvent(new Error(`Layer with id "${g}" does not exist on this map.`))):(this._order.splice(S,0,c),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(c){this._checkLoaded();const g=this._layers[c];if(!g)return void this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be removed.`)));g.setEventedParent(null),this._updateLayerCount(g,!1);const C=this._order.indexOf(c);this._order.splice(C,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=g,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],g.onRemove&&g.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}hasLayerType(c){for(const g in this._layers)if(this._layers[g].type===c)return!0;return!1}setLayerZoomRange(c,g,C){this._checkLoaded();const S=this.getLayer(c);S?S.minzoom===g&&S.maxzoom===C||(null!=g&&(S.minzoom=g),null!=C&&(S.maxzoom=C),this._updateLayer(S)):this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(c,g,C={}){this._checkLoaded();const S=this.getLayer(c);if(S){if(!$e(S.filter,g))return null==g?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(_.validateFilter,`layers.${S.id}.filter`,g,{layerType:S.type},C)||(S.filter=_.clone$1(g),this._updateLayer(S)))}else this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be filtered.`)))}getFilter(c){const g=this.getLayer(c);return g&&_.clone$1(g.filter)}setLayoutProperty(c,g,C,S={}){this._checkLoaded();const D=this.getLayer(c);D?$e(D.getLayoutProperty(g),C)||(D.setLayoutProperty(g,C,S),this._updateLayer(D)):this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(c,g){const C=this.getLayer(c);if(C)return C.getLayoutProperty(g);this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style.`)))}setPaintProperty(c,g,C,S={}){this._checkLoaded();const D=this.getLayer(c);D?$e(D.getPaintProperty(g),C)||(D.setPaintProperty(g,C,S)&&this._updateLayer(D),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(c,g){const C=this.getLayer(c);return C&&C.getPaintProperty(g)}setFeatureState(c,g){this._checkLoaded();const C=c.source,S=c.sourceLayer,D=this.getSource(C);if(!D)return void this.fire(new _.ErrorEvent(new Error(`The source '${C}' does not exist in the map's style.`)));const L=D.type;if("geojson"===L&&S)return void this.fire(new _.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===L&&!S)return void this.fire(new _.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===c.id&&this.fire(new _.ErrorEvent(new Error("The feature id parameter must be provided.")));const B=this._getSourceCaches(C);for(const G of B)G.setFeatureState(S,c.id,g)}removeFeatureState(c,g){this._checkLoaded();const C=c.source,S=this.getSource(C);if(!S)return void this.fire(new _.ErrorEvent(new Error(`The source '${C}' does not exist in the map's style.`)));const D=S.type,L="vector"===D?c.sourceLayer:void 0;if("vector"===D&&!L)return void this.fire(new _.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(g&&"string"!=typeof c.id&&"number"!=typeof c.id)return void this.fire(new _.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const B=this._getSourceCaches(C);for(const G of B)G.removeFeatureState(L,c.id,g)}getFeatureState(c){this._checkLoaded();const g=c.source,C=c.sourceLayer,S=this.getSource(g);if(S){if("vector"!==S.type||C)return void 0===c.id&&this.fire(new _.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(g)[0].getFeatureState(C,c.id);this.fire(new _.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new _.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)))}getTransition(){return _.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const c={};for(const g in this._sourceCaches){const C=this._sourceCaches[g].getSource();c[C.id]||(c[C.id]=C.serialize())}return _.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:c,layers:this._serializeLayers(this._order)},g=>void 0!==g)}_updateLayer(c){this._updatedLayers[c.id]=!0;const g=this._getLayerSourceCache(c);c.source&&!this._updatedSources[c.source]&&g&&"raster"!==g.getSource().type&&(this._updatedSources[c.source]="reload",g.pause()),this._changed=!0,c.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(c){const g=L=>"fill-extrusion"===this._layers[L].type,C={},S=[];for(let L=this._order.length-1;L>=0;L--){const B=this._order[L];if(g(B)){C[B]=L;for(const G of c){const J=G[B];if(J)for(const ee of J)S.push(ee)}}}S.sort((L,B)=>B.intersectionZ-L.intersectionZ);const D=[];for(let L=this._order.length-1;L>=0;L--){const B=this._order[L];if(g(B))for(let G=S.length-1;G>=0;G--){const J=S[G].feature;if(C[J.layer.id]<L)break;D.push(J),S.pop()}else for(const G of c){const J=G[B];if(J)for(const ee of J)D.push(ee.feature)}}return D}queryRenderedFeatures(c,g,C){g&&g.filter&&this._validate(_.validateFilter,"queryRenderedFeatures.filter",g.filter,null,g);const S={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new _.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const G of g.layers){const J=this._layers[G];if(!J)return this.fire(new _.ErrorEvent(new Error(`The layer '${G}' does not exist in the map's style and cannot be queried for features.`))),[];S[J.source]=!0}}const D=[];g.availableImages=this._availableImages;const L=g&&g.layers?g.layers.some(G=>{const J=this.getLayer(G);return J&&J.is3D()}):this.has3DLayers(),B=wn.createFromScreenPoints(c,C);for(const G in this._sourceCaches){const J=this._sourceCaches[G].getSource().id;g.layers&&!S[J]||D.push(He(this._sourceCaches[G],this._layers,this._serializedLayers,B,g,C,L,!!this.map._showQueryGeometry))}return this.placement&&D.push(function(G,J,ee,oe,de,ge,ue){const ye={},be=ge.queryRenderedSymbols(oe),ce=[];for(const Te of Object.keys(be).map(Number))ce.push(ue[Te]);ce.sort(jt);for(const Te of ce){const ve=Te.featureIndex.lookupSymbolFeatures(be[Te.bucketInstanceId],J,Te.bucketIndex,Te.sourceLayerIndex,de.filter,de.layers,de.availableImages,G);for(const De in ve){const Fe=ye[De]=ye[De]||[],Re=ve[De];Re.sort((Ue,Ze)=>{const nt=Te.featureSortOrder;if(nt){const ot=nt.indexOf(Ue.featureIndex);return nt.indexOf(Ze.featureIndex)-ot}return Ze.featureIndex-Ue.featureIndex});for(const Ue of Re)Fe.push(Ue)}}for(const Te in ye)ye[Te].forEach(ve=>{const De=ve.feature,Fe=ee(G[Te]).getFeatureState(De.layer["source-layer"],De.id);De.source=De.layer.source,De.layer["source-layer"]&&(De.sourceLayer=De.layer["source-layer"]),De.state=Fe});return ye}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),B.screenGeometry,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(D)}querySourceFeatures(c,g){g&&g.filter&&this._validate(_.validateFilter,"querySourceFeatures.filter",g.filter,null,g);const C=this._getSourceCaches(c);let S=[];for(const D of C)S=S.concat(it(D,g));return S}addSourceType(c,g,C){return eo.getSourceType(c)?C(new Error(`A source type called "${c}" already exists.`)):(eo.setSourceType(c,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:g.workerSourceURL},C):C(null,null))}getLight(){return this.light.getLight()}setLight(c,g={}){this._checkLoaded();const C=this.light.getLight();let S=!1;for(const L in c)if(!$e(c[L],C[L])){S=!0;break}if(!S)return;const D=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(c,g),this.light.updateTransitions(D)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(c,g=1){if(this._checkLoaded(),!c)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===g){if("object"==typeof c.source){const C="terrain-dem-src";this.addSource(C,c.source),c=_.clone$1(c),c=_.extend(c,{source:C})}if(this._validate(_.validateTerrain,"terrain",c))return}if(!this.terrain||this.terrain&&g!==this.terrain.drapeRenderMode)this._createTerrain(c,g);else{const C=this.terrain,S=C.get();for(const D of Object.keys(_.spec.terrain))!c.hasOwnProperty(D)&&_.spec.terrain[D].default&&(c[D]=_.spec.terrain[D].default);for(const D in c)if(!$e(c[D],S[D])){C.set(c),this.stylesheet.terrain=c;const L=this._setTransitionParameters({duration:0});C.updateTransitions(L);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(c){const g=this.fog=new Ht(c,this.map.transform);this.stylesheet.fog=c;const C=this._setTransitionParameters({duration:0});g.updateTransitions(C)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const c of this.map._markers)c._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(c){if(this._checkLoaded(),!c)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const g=this.fog,C=g.get();0===Object.keys(c).length&&g.set(c);for(const S in c)if(!$e(c[S],C[S])){g.set(c),this.stylesheet.fog=c;const D=this._setTransitionParameters({duration:0});g.updateTransitions(D);break}}else this._createFog(c);this._markersNeedUpdate=!0}_setTransitionParameters(c){return{now:_.exported.now(),transition:_.extend(c,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const c=this._order.filter(C=>this.isLayerDraped(this._layers[C])),g=this._order.filter(C=>!this.isLayerDraped(this._layers[C]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...c),this._drapedFirstOrder.push(...g)}_createTerrain(c,g){const C=this.terrain=new oi(c,g);this.stylesheet.terrain=c,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const S=this._setTransitionParameters({duration:0});C.updateTransitions(S)}_force3DLayerUpdate(){for(const c in this._layers){const g=this._layers[c];"fill-extrusion"===g.type&&this._updateLayer(g)}}_forceSymbolLayerUpdate(){for(const c in this._layers){const g=this._layers[c];"symbol"===g.type&&this._updateLayer(g)}}_validate(c,g,C,S,D={}){return(!D||!1!==D.validate)&&Iu(this,c.call(_.validateStyle,_.extend({key:g,style:this.serialize(),value:C,styleSpec:_.spec},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),_.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this._sourceCaches)this._sourceCaches[c].clearTiles(),this._sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){const g=this._getSourceCaches(c);for(const C of g)C.clearTiles()}_reloadSource(c){const g=this._getSourceCaches(c);for(const C of g)C.resume(),C.reload()}_reloadSources(){for(const c of this._getSources())c.reload&&c.reload()}_updateSources(c){for(const g in this._sourceCaches)this._sourceCaches[g].update(c)}_generateCollisionBoxes(){for(const c in this._sourceCaches){const g=this._sourceCaches[c];g.resume(),g.reload()}}_updatePlacement(c,g,C,S,D=!1){let L=!1,B=!1;const G={};for(const J of this._order){const ee=this._layers[J];if("symbol"!==ee.type)continue;if(!G[ee.source]){const de=this._getLayerSourceCache(ee);if(!de)continue;G[ee.source]=de.getRenderableIds(!0).map(ge=>de.getTileByID(ge)).sort((ge,ue)=>ue.tileID.overscaledZ-ge.tileID.overscaledZ||(ge.tileID.isLessThan(ue.tileID)?-1:1))}const oe=this.crossTileSymbolIndex.addLayer(ee,G[ee.source],c.center.lng,c.projection);L=L||oe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),D=D||this._layerOrderChanged||0===C,this._layerOrderChanged&&this.fire(new _.Event("neworder")),(D||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(_.exported.now(),c.zoom))&&(this.pauseablePlacement=new Tl(c,this._order,D,g,C,S,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,G),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(_.exported.now()),B=!0),L&&this.pauseablePlacement.placement.setStale()),B||L)for(const J of this._order){const ee=this._layers[J];"symbol"===ee.type&&this.placement.updateLayerOpacities(ee,G[ee.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(_.exported.now())}_releaseSymbolFadeTiles(){for(const c in this._sourceCaches)this._sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,g,C){this.imageManager.getImages(g.icons,C),this._updateTilesForChangedImages();const S=D=>{D&&D.setDependencies(g.tileID.key,g.type,g.icons)};S(this._otherSourceCaches[g.source]),S(this._symbolSourceCaches[g.source])}getGlyphs(c,g,C){this.glyphManager.getGlyphs(g.stacks,C)}getResource(c,g,C){return _.makeRequest(g,C)}_getSourceCache(c){return this._otherSourceCaches[c]}_getLayerSourceCache(c){return"symbol"===c.type?this._symbolSourceCaches[c.source]:this._otherSourceCaches[c.source]}_getSourceCaches(c){const g=[];return this._otherSourceCaches[c]&&g.push(this._otherSourceCaches[c]),this._symbolSourceCaches[c]&&g.push(this._symbolSourceCaches[c]),g}_isSourceCacheLoaded(c){const g=this._getSourceCaches(c);return 0===g.length?(this.fire(new _.ErrorEvent(new Error(`There is no source with ID '${c}'`))),!1):g.every(C=>C.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}eo.getSourceType=function(v){return Oe[v]},eo.setSourceType=function(v,c){Oe[v]=c},eo.registerForPluginStateChange=_.registerForPluginStateChange;var vd="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",hf="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",bd="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Mu="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",ff="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Cp={},ic={};const zc=[];oc(vd,zc),oc(bd,zc),oc(Mu,zc),oc(ff,zc),Cp=Yi("",bd),ic=Yi(ff,Mu);const Du=Yi("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),Bc=vd,rc="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var xd={background:Yi("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Yi("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Yi("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Yi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Yi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Yi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Yi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Yi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Yi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:Yi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Yi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Yi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Yi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Yi("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Yi("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Yi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Yi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Yi("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Yi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Yi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Yi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Yi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Yi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Yi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:Yi("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Yi("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",hf),skyboxGradient:Yi("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",hf),skyboxCapture:Yi("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Yi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:Yi("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function oc(v,c){const g=v.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let C of g)if(C=C.trim(),"#"===C[0]&&C.includes("if")&&!C.includes("endif")){C=C.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=C.split(" ");for(const D of S)c.includes(D)||c.push(D)}}function Yi(v,c){const g=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,C=c.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),S={},D=[...zc];return oc(v,D),oc(c,D),{fragmentSource:v=v.replace(g,(L,B,G,J,ee)=>(S[ee]=!0,"define"===B?`\n#ifndef HAS_UNIFORM_u_${ee}\nvarying ${G} ${J} ${ee};\n#else\nuniform ${G} ${J} u_${ee};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${ee}\n    ${G} ${J} ${ee} = u_${ee};\n#endif\n`)),vertexSource:c=c.replace(g,(L,B,G,J,ee)=>{const oe="float"===J?"vec2":"vec4",de=ee.match(/color/)?"color":oe;return S[ee]?"define"===B?`\n#ifndef HAS_UNIFORM_u_${ee}\nuniform lowp float u_${ee}_t;\nattribute ${G} ${oe} a_${ee};\nvarying ${G} ${J} ${ee};\n#else\nuniform ${G} ${J} u_${ee};\n#endif\n`:"vec4"===de?`\n#ifndef HAS_UNIFORM_u_${ee}\n    ${ee} = a_${ee};\n#else\n    ${G} ${J} ${ee} = u_${ee};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${ee}\n    ${ee} = unpack_mix_${de}(a_${ee}, u_${ee}_t);\n#else\n    ${G} ${J} ${ee} = u_${ee};\n#endif\n`:"define"===B?`\n#ifndef HAS_UNIFORM_u_${ee}\nuniform lowp float u_${ee}_t;\nattribute ${G} ${oe} a_${ee};\n#else\nuniform ${G} ${J} u_${ee};\n#endif\n`:"vec4"===de?`\n#ifndef HAS_UNIFORM_u_${ee}\n    ${G} ${J} ${ee} = a_${ee};\n#else\n    ${G} ${J} ${ee} = u_${ee};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${ee}\n    ${G} ${J} ${ee} = unpack_mix_${de}(a_${ee}, u_${ee}_t);\n#else\n    ${G} ${J} ${ee} = u_${ee};\n#endif\n`}),staticAttributes:C,usedDefines:D}}class wd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(c,g,C,S,D,L,B){this.context=c;let G=this.boundPaintVertexBuffers.length!==S.length;for(let ee=0;!G&&ee<S.length;ee++)this.boundPaintVertexBuffers[ee]!==S[ee]&&(G=!0);let J=this.boundDynamicVertexBuffers.length!==B.length;for(let ee=0;!J&&ee<B.length;ee++)this.boundDynamicVertexBuffers[ee]!==B[ee]&&(J=!0);if(!c.extVertexArrayObject||!this.vao||this.boundProgram!==g||this.boundLayoutVertexBuffer!==C||G||J||this.boundIndexBuffer!==D||this.boundVertexOffset!==L)this.freshBind(g,C,S,D,L,B);else{c.bindVertexArrayOES.set(this.vao);for(const ee of B)ee&&ee.bind();D&&D.dynamicDraw&&D.bind()}}freshBind(c,g,C,S,D,L){let B;const G=c.numAttributes,J=this.context,ee=J.gl;if(J.extVertexArrayObject)this.vao&&this.destroy(),this.vao=J.extVertexArrayObject.createVertexArrayOES(),J.bindVertexArrayOES.set(this.vao),B=0,this.boundProgram=c,this.boundLayoutVertexBuffer=g,this.boundPaintVertexBuffers=C,this.boundIndexBuffer=S,this.boundVertexOffset=D,this.boundDynamicVertexBuffers=L;else{B=J.currentNumAttributes||0;for(let oe=G;oe<B;oe++)ee.disableVertexAttribArray(oe)}g.enableAttributes(ee,c),g.bind(),g.setVertexAttribPointers(ee,c,D);for(const oe of C)oe.enableAttributes(ee,c),oe.bind(),oe.setVertexAttribPointers(ee,c,D);for(const oe of L)oe&&(oe.enableAttributes(ee,c),oe.bind(),oe.setVertexAttribPointers(ee,c,D));S&&S.bind(),J.currentNumAttributes=G}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Il(v,c){const g=Math.pow(2,c.canonical.z),C=c.canonical.y;return[new _.MercatorCoordinate(0,C/g).toLngLat().lat,new _.MercatorCoordinate(0,(C+1)/g).toLngLat().lat]}function Vc(v,c,g,C,S,D,L){const B=v.context,G=B.gl,J=g.fbo;if(!J)return;v.prepareDrawTile();const ee=v.useProgram("hillshade");B.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,J.colorAttachment.get());const oe=((ye,be,ce,Te)=>{const ve=ce.paint.get("hillshade-shadow-color"),De=ce.paint.get("hillshade-highlight-color"),Fe=ce.paint.get("hillshade-accent-color");let Re=ce.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ce.paint.get("hillshade-illumination-anchor")&&(Re-=ye.transform.angle);const Ue=!ye.options.moving;return{u_matrix:Te||ye.transform.calculateProjMatrix(be.tileID.toUnwrapped(),Ue),u_image:0,u_latrange:Il(0,be.tileID),u_light:[ce.paint.get("hillshade-exaggeration"),Re],u_shadow:ve,u_highlight:De,u_accent:Fe}})(v,g,C,v.terrain?c.projMatrix:null);v.prepareDrawProgram(B,ee,c.toUnwrapped());const{tileBoundsBuffer:de,tileBoundsIndexBuffer:ge,tileBoundsSegments:ue}=v.getTileBoundsBuffers(g);ee.draw(B,G.TRIANGLES,S,D,L,_.CullFaceMode.disabled,oe,C.id,de,ge,ue)}function Ko(v,c,g){if(!c.needsDEMTextureUpload)return;const C=v.context,S=C.gl;C.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||v.getTileTexture(g.stride);const D=g.getPixels();c.demTexture?c.demTexture.update(D,{premultiply:!1}):c.demTexture=new _.Texture(C,D,S.RGBA,{premultiply:!1}),c.needsDEMTextureUpload=!1}function Au(v,c,g,C,S,D){const L=v.context,B=L.gl;if(!c.dem)return;const G=c.dem;if(L.activeTexture.set(B.TEXTURE1),Ko(v,c,G),!c.demTexture)return;c.demTexture.bind(B.NEAREST,B.CLAMP_TO_EDGE);const J=G.dim;L.activeTexture.set(B.TEXTURE0);let ee=c.fbo;if(!ee){const ue=new _.Texture(L,{width:J,height:J,data:null},B.RGBA);ue.bind(B.LINEAR,B.CLAMP_TO_EDGE),ee=c.fbo=L.createFramebuffer(J,J,!0),ee.colorAttachment.set(ue.texture)}L.bindFramebuffer.set(ee.framebuffer),L.viewport.set([0,0,J,J]);const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:de,tileBoundsSegments:ge}=v.getMercatorTileBoundsBuffers();v.useProgram("hillshadePrepare").draw(L,B.TRIANGLES,C,S,D,_.CullFaceMode.disabled,((ue,ye)=>{const be=ye.stride,ce=_.create();return _.ortho(ce,0,_.EXTENT,-_.EXTENT,0,0,1),_.translate(ce,ce,[0,-_.EXTENT,0]),{u_matrix:ce,u_image:1,u_dimension:[be,be],u_zoom:ue.overscaledZ,u_unpack:ye.unpackVector}})(c.tileID,G),g.id,oe,de,ge),c.needsHillshadePrepare=!1}const Uc=v=>({u_matrix:new _.UniformMatrix4f(v),u_image0:new _.Uniform1i(v),u_skirt_height:new _.Uniform1f(v)}),to=(v,c)=>({u_matrix:v,u_image0:0,u_skirt_height:c}),Pu=(v,c,g,C,S,D,L,B,G,J,ee,oe,de,ge,ue)=>({u_proj_matrix:Float32Array.from(v),u_globe_matrix:c,u_normalize_matrix:Float32Array.from(C),u_merc_matrix:g,u_zoom_transition:S,u_merc_center:D,u_image0:0,u_frustum_tl:L,u_frustum_tr:B,u_frustum_br:G,u_frustum_bl:J,u_globe_pos:ee,u_globe_radius:oe,u_viewport:de,u_grid_matrix:ue?Float32Array.from(ue):new Float32Array(9),u_skirt_height:ge});function Sl(v,c){return null!=v&&null!=c&&!(!v.hasData()||!c.hasData())&&null!=v.demTexture&&null!=c.demTexture&&v.tileID.key!==c.tileID.key}const uo=new class{constructor(){this.operations={}}newMorphing(v,c,g,C,S){if(v in this.operations){const D=this.operations[v];D.to.tileID.key!==g.tileID.key&&(D.queued=g)}else this.operations[v]={startTime:C,phase:0,duration:S,from:c,to:g,queued:null}}getMorphValuesForProxy(v){if(!(v in this.operations))return null;const c=this.operations[v];return{from:c.from,to:c.to,phase:c.phase}}update(v){for(const c in this.operations){const g=this.operations[c];for(g.phase=(v-g.startTime)/g.duration;g.phase>=1||!this._validOp(g);)if(!this._nextOp(g,v)){delete this.operations[c];break}}}_nextOp(v,c){return!!v.queued&&(v.from=v.to,v.to=v.queued,v.queued=null,v.phase=0,v.startTime=c,!0)}_validOp(v){return v.from.hasData()&&v.to.hasData()}},jc={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Ou(v){return 6*Math.pow(1.5,22-v)}function la(v,c){const g=1<<v.z;return!c&&(0===v.x||v.x===g-1)||0===v.y||v.y===g-1}const di=v=>({u_matrix:v});function $c(v,c,g,C,S){if(S>0){const D=_.exported.now(),L=(D-v.timeAdded)/S,B=c?(D-c.timeAdded)/S:-1,G=g.getSource(),J=C.coveringZoomLevel({tileSize:G.tileSize,roundZoom:G.roundZoom}),ee=!c||Math.abs(c.tileID.overscaledZ-J)>Math.abs(v.tileID.overscaledZ-J),oe=ee&&v.refreshedUponExpiration?1:_.clamp(ee?L:1-B,0,1);return v.refreshedUponExpiration&&L>=1&&(v.refreshedUponExpiration=!1),c?{opacity:1,mix:1-oe}:{opacity:oe,mix:0}}return{opacity:1,mix:0}}class sc extends _.SourceCache{constructor(c){const g={type:"raster-dem",maxzoom:c.transform.maxZoom},C=new nn(ni(),null),S=Be("mock-dem",g,C,c.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(c,g){c.state="loaded",g(null)}}class $m extends _.SourceCache{constructor(c){const g=Be("proxy",{type:"geojson",maxzoom:c.transform.maxZoom},new nn(ni(),null),c.style);super("proxy",g,!1),g.setEventedParent(this),this.map=this.getSource().map=c,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(c,g,C){if(c.freezeTileCoverage)return;this.transform=c;const S=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((D,L)=>{if(D[L.key]="",!this._tiles[L.key]){const B=new _.Tile(L,this._source.tileSize*L.overscaleFactor(),c.tileZoom);B.state="loaded",this._tiles[L.key]=B}return D},{});for(const D in this._tiles)D in S||(this.freeFBO(D),this._tiles[D].unloadVectorData(),delete this._tiles[D])}freeFBO(c){const g=this.proxyCachedFBO[c];if(void 0!==g){const C=Object.values(g);this.renderCachePool.push(...C),delete this.proxyCachedFBO[c]}}deallocRenderCache(){this.renderCache.forEach(c=>c.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ca extends _.OverscaledTileID{constructor(c,g,C){super(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y),this.proxyTileKey=g,this.projMatrix=C}}class sh extends _.Elevation{constructor(c,g){super(),this.painter=c,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[C,S,D]=function(G){const J=new _.StructArrayLayout2i4,ee=new _.StructArrayLayout3ui6;J.reserve(17161),ee.reserve(33800);const de=_.EXTENT/128,ge=_.EXTENT+de/2,ue=ge+de;for(let be=-de;be<ue;be+=de)for(let ce=-de;ce<ue;ce+=de){const Te=ce<0||ce>ge||be<0||be>ge?24575:0,ve=_.clamp(Math.round(ce),0,_.EXTENT),De=_.clamp(Math.round(be),0,_.EXTENT);J.emplaceBack(ve+Te,De)}const ye=(be,ce)=>{const Te=131*ce+be;ee.emplaceBack(Te+1,Te,Te+131),ee.emplaceBack(Te+131,Te+131+1,Te+1)};for(let be=1;be<129;be++)for(let ce=1;ce<129;ce++)ye(ce,be);return[0,129].forEach(be=>{for(let ce=0;ce<130;ce++)ye(ce,be),ye(be,ce)}),[J,ee,32768]}(),L=c.context;this.gridBuffer=L.createVertexBuffer(C,_.posAttributes.members),this.gridIndexBuffer=L.createIndexBuffer(S),this.gridSegments=_.SegmentVector.simpleSegment(0,0,C.length,S.length),this.gridNoSkirtSegments=_.SegmentVector.simpleSegment(0,0,C.length,D),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new $m(g.map),this.orthoMatrix=_.create(),_.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,_.EXTENT,0,_.EXTENT,0,1);const B=L.gl;this._overlapStencilMode=new _.StencilMode({func:B.GEQUAL,mask:255},0,255,B.KEEP,B.KEEP,B.REPLACE),this._previousZoom=c.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=g,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new sc(g.map)}set style(c){c.on("data",this._onStyleDataEvent.bind(this)),c.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=c,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(c,g,C){if(c&&c.terrain){this._style!==c&&(this.style=c),this.enabled=!0;const S=c.terrain.properties;this.sourceCache=0===c.terrain.drapeRenderMode?this._mockSourceCache:c._getSourceCache(S.get("source")),this._exaggeration=S.get("exaggeration");const D=()=>{this.sourceCache.used&&_.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const L=this.getScaledDemTileSize();this.sourceCache.update(g,L,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,D(),this._initializing=!0),D(),g.updateElevation(!0,C),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(g),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(c){this._findCoveringTileCache[c]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const c=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==c.efficiency&&_.warnOnce(`Terrain render cache efficiency is not optimal (${c.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${c.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(c){c.coord&&"source"===c.dataType?this._clearRenderCacheForTile(c.sourceCacheId,c.coord):"style"===c.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const c in this._style._sourceCaches)this._style._sourceCaches[c].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(c=>c.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const c=2*this.proxySourceCache.getSource().tileSize;return[c,c]}set useVertexMorphing(c){this._useVertexMorphing=c}updateTileBinding(c){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const g=this.proxySourceCache,C=this.painter.transform;this._initializing&&(this._initializing=0===C._centerAltitude&&-1===this.getAtPointOrZero(_.MercatorCoordinate.fromLngLat(C.center),-1),this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=g.getIds().map(G=>{const J=g.getTileByID(G).tileID;return J.projMatrix=C.calculateProjMatrix(J.toUnwrapped()),J});(function(G,J){const ee=J.transform.pointCoordinate(J.transform.getCameraPoint()),oe=new _.pointGeometry(ee.x,ee.y);G.sort((de,ge)=>{if(ge.overscaledZ-de.overscaledZ)return ge.overscaledZ-de.overscaledZ;const ue=new _.pointGeometry(de.canonical.x+(1<<de.canonical.z)*de.wrap,de.canonical.y),ye=new _.pointGeometry(ge.canonical.x+(1<<ge.canonical.z)*ge.wrap,ge.canonical.y),be=oe.mult(1<<de.canonical.z);return be.x-=.5,be.y-=.5,be.distSqr(ue)-be.distSqr(ye)})})(S,this.painter),this._previousZoom=C.zoom;const D=this.proxyToSource||{};this.proxyToSource={},S.forEach(G=>{this.proxyToSource[G.key]={}}),this.terrainTileForTile={};const L=this._style._sourceCaches;for(const G in L){const J=L[G];if(!J.used||(J!==this.sourceCache&&this.resetTileLookupCache(J.id),this._setupProxiedCoordsForOrtho(J,c[G],D),J.usedForTerrain))continue;const ee=c[G];J.getSource().reparseOverscaled&&this._assignTerrainTiles(ee)}this.proxiedCoords[g.id]=S.map(G=>new ca(G,G.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(D),this.renderingToTexture=!1,this._updateTimestamp=_.exported.now();const B={};this._visibleDemTiles=[];for(const G of this.proxyCoords){const J=this.terrainTileForTile[G.key];if(!J)continue;const ee=J.tileID.key;ee in B||(this._visibleDemTiles.push(J),B[ee]=ee)}}_assignTerrainTiles(c){this._initializing||c.forEach(g=>{if(this.terrainTileForTile[g.key])return;const C=this._findTileCoveringTileID(g,this.sourceCache);C&&(this.terrainTileForTile[g.key]=C)})}_prepareDEMTextures(){const c=this.painter.context,g=c.gl;for(const C in this.terrainTileForTile){const S=this.terrainTileForTile[C],D=S.dem;!D||S.demTexture&&!S.needsDEMTextureUpload||(c.activeTexture.set(g.TEXTURE1),Ko(this.painter,S,D))}}_prepareDemTileUniforms(c,g,C,S){if(!g||null==g.demTexture)return!1;const D=c.tileID.canonical,L=Math.pow(2,g.tileID.canonical.z-D.z),B=S||"";return C[`u_dem_tl${B}`]=[D.x*L%1,D.y*L%1],C[`u_dem_scale${B}`]=L,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const c=this.painter.context,g=c.gl;if(!this._emptyDepthBufferTexture){const C=new _.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new _.Texture(c,C,g.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let c=0;const g=this._visibleDemTiles.reduce((C,S)=>{if(!S.dem)return C;const D=S.dem.tree.minimums[0];return D>0&&c++,C+D},0);return c?g/c:0}_updateEmptyDEMTexture(){const c=this.painter.context,g=c.gl;c.activeTexture.set(g.TEXTURE2);const C=this._getLoadedAreaMinimum(),S=new _.RGBAImage({width:1,height:1},new Uint8Array(_.DEMData.pack(C,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let D=this._emptyDEMTexture;return D?D.update(S,{premultiply:!1}):D=this._emptyDEMTexture=new _.Texture(c,S,g.RGBA,{premultiply:!1}),D}setupElevationDraw(c,g,C){const S=this.painter.context,D=S.gl,L=(B=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:_.DEMData.getUnpackVector(B),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var B;L.u_dem_size=this.sourceCache.getSource().tileSize,L.u_exaggeration=this.exaggeration();let G=null,J=null,ee=1;if(C&&C.morphing&&this._useVertexMorphing){const oe=C.morphing.srcDemTile,de=C.morphing.dstDemTile;ee=C.morphing.phase,oe&&de&&(this._prepareDemTileUniforms(c,oe,L,"_prev")&&(J=oe),this._prepareDemTileUniforms(c,de,L)&&(G=de))}if(J&&G?(S.activeTexture.set(D.TEXTURE2),G.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE,D.NEAREST),S.activeTexture.set(D.TEXTURE4),J.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE,D.NEAREST),L.u_dem_lerp=ee):(G=this.terrainTileForTile[c.tileID.key],S.activeTexture.set(D.TEXTURE2),(this._prepareDemTileUniforms(c,G,L)?G.demTexture:this.emptyDEMTexture).bind(D.NEAREST,D.CLAMP_TO_EDGE)),S.activeTexture.set(D.TEXTURE3),C&&C.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE),this._depthFBO&&(L.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE),L.u_depth_size_inv=[1,1]),C&&C.useMeterToDem&&G){const oe=(1<<G.tileID.canonical.z)*_.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;L.u_meter_to_dem=oe}if(C&&C.labelPlaneMatrixInv&&(L.u_label_plane_matrix_inv=C.labelPlaneMatrixInv),g.setTerrainUniformValues(S,L),"globe"===this.painter.transform.projection.name){const oe=this.globeUniformValues(this.painter.transform,c.tileID.canonical,C&&C.useDenormalizedUpVectorScale);g.setGlobeUniformValues(S,oe)}}globeUniformValues(c,g,C){const S=c.projection;return{u_tile_tl_up:S.upVector(g,0,0),u_tile_tr_up:S.upVector(g,_.EXTENT,0),u_tile_br_up:S.upVector(g,_.EXTENT,_.EXTENT),u_tile_bl_up:S.upVector(g,0,_.EXTENT),u_tile_up_scale:C?_.globeMetersToEcef(1):S.upVectorScale(g,c.center.lat,c.worldSize).metersToTile}}renderToBackBuffer(c){const g=this.painter,C=this.painter.context;0!==c.length&&(C.bindFramebuffer.set(null),C.viewport.set([0,0,g.width,g.height]),g.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,D,L,B,G){if("globe"===S.transform.projection.name)!function(J,ee,oe,de,ge){const ue=J.context,ye=ue.gl;let be,ce;const Te=J.options.showTerrainWireframe?2:0,ve=J.transform,De=_.globeUseCustomAntiAliasing(J,ue,ve),Fe=(Ot,et)=>{if(ce===Ot)return;const qe=[jc[Ot],"PROJECTION_GLOBE_VIEW"];De&&qe.push("CUSTOM_ANTIALIASING"),et&&qe.push(jc[Te]),be=J.useProgram("globeRaster",null,qe),ce=Ot},Re=J.colorModeForRenderPass(),Ue=new _.DepthMode(ye.LEQUAL,_.DepthMode.ReadWrite,J.depthRangeFor3D);uo.update(ge);const Ze=_.calculateGlobeMercatorMatrix(ve),nt=[_.mercatorXfromLng(ve.center.lng),_.mercatorYfromLat(ve.center.lat)],ot=Te?[!1,!0]:[!1],Ut=J.globeSharedBuffers,Qe=[ve.width*_.exported.devicePixelRatio,ve.height*_.exported.devicePixelRatio],St=Float32Array.from(ve.globeMatrix),at={useDenormalizedUpVectorScale:!0};if(ot.forEach(Ot=>{const et=J.transform,qe=Ou(et.zoom)*ee.exaggeration();ce=-1;const Xe=Ot?ye.LINES:ye.TRIANGLES;for(const Mt of de){const Lt=oe.getTile(Mt),dn=_.StencilMode.disabled,Yn=ee.prevTerrainTileForTile[Mt.key],gn=ee.terrainTileForTile[Mt.key];Sl(Yn,gn)&&uo.newMorphing(Mt.key,Yn,gn,ge,250),ue.activeTexture.set(ye.TEXTURE0),Lt.texture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE);const Yt=uo.getMorphValuesForProxy(Mt.key),yn=Yt?1:0;Yt&&_.extend$1(at,{morphing:{srcDemTile:Yt.from,dstDemTile:Yt.to,phase:_.easeCubicInOut(Yt.phase)}});const xi=_.tileCornersToBounds(Mt.canonical),Bn=_.getLatitudinalLod(xi.getCenter().lat),er=_.getGridMatrix(Mt.canonical,xi,Bn,et.worldSize/et._pixelsPerMercatorPixel),Fi=_.globeNormalizeECEF(_.globeTileBounds(Mt.canonical)),sr=Pu(et.projMatrix,St,Ze,Fi,_.globeToMercatorTransition(et.zoom),nt,et.frustumCorners.TL,et.frustumCorners.TR,et.frustumCorners.BR,et.frustumCorners.BL,et.globeCenterInViewSpace,et.globeRadius,Qe,qe,er);if(Fe(yn,Ot),ee.setupElevationDraw(Lt,be,at),J.prepareDrawProgram(ue,be,Mt.toUnwrapped()),Ut){const[vi,Mr,Ys]=Ot?Ut.getWirefameBuffers(J.context,Bn):Ut.getGridBuffers(Bn,0!==qe);be.draw(ue,Xe,Ue,dn,Re,_.CullFaceMode.backCCW,sr,"globe_raster",vi,Mr,Ys)}}}),Ut){const Ot=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];De&&Ot.push("CUSTOM_ANTIALIASING"),be=J.useProgram("globeRaster",null,Ot);for(const et of de){const{x:qe,y:Xe,z:Mt}=et.canonical,Lt=0===Xe,dn=Xe===(1<<Mt)-1,[Yn,gn,Yt,yn]=Ut.getPoleBuffers(Mt);if(yn&&(Lt||dn)){const xi=oe.getTile(et);ue.activeTexture.set(ye.TEXTURE0),xi.texture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE);let Bn=_.globePoleMatrixForTile(Mt,qe,ve);const er=_.globeNormalizeECEF(_.globeTileBounds(et.canonical)),Fi=(sr,vi)=>sr.draw(ue,ye.TRIANGLES,Ue,_.StencilMode.disabled,Re,_.CullFaceMode.disabled,Pu(ve.projMatrix,Bn,Bn,er,0,nt,ve.frustumCorners.TL,ve.frustumCorners.TR,ve.frustumCorners.BR,ve.frustumCorners.BL,ve.globeCenterInViewSpace,ve.globeRadius,Qe,0),"globe_pole_raster",vi,Yt,yn);ee.setupElevationDraw(xi,be,at),J.prepareDrawProgram(ue,be,et.toUnwrapped()),Lt&&Fi(be,Yn),dn&&(Bn=_.scale(_.create(),Bn,[1,-1,1]),Fi(be,gn))}}}}(S,D,L,B,G);else{const J=S.context,ee=J.gl;let oe,de;const ge=S.options.showTerrainWireframe?2:0,ue=(ve,De)=>{if(de===ve)return;const Fe=[jc[ve]];De&&Fe.push(jc[ge]),oe=S.useProgram("terrainRaster",null,Fe),de=ve},ye=S.colorModeForRenderPass(),be=new _.DepthMode(ee.LEQUAL,_.DepthMode.ReadWrite,S.depthRangeFor3D);uo.update(G);const ce=S.transform,Te=Ou(ce.zoom)*D.exaggeration();(ge?[!1,!0]:[!1]).forEach(ve=>{de=-1;const De=ve?ee.LINES:ee.TRIANGLES,[Fe,Re]=ve?D.getWirefameBuffer():[D.gridIndexBuffer,D.gridSegments];for(const Ue of B){const Ze=L.getTile(Ue),nt=_.StencilMode.disabled,ot=D.prevTerrainTileForTile[Ue.key],Ut=D.terrainTileForTile[Ue.key];Sl(ot,Ut)&&uo.newMorphing(Ue.key,ot,Ut,G,250),J.activeTexture.set(ee.TEXTURE0),Ze.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE,ee.LINEAR_MIPMAP_NEAREST);const Qe=uo.getMorphValuesForProxy(Ue.key),St=Qe?1:0;let at;Qe&&(at={morphing:{srcDemTile:Qe.from,dstDemTile:Qe.to,phase:_.easeCubicInOut(Qe.phase)}});const Ot=to(Ue.projMatrix,la(Ue.canonical,ce.renderWorldCopies)?Te/10:Te);ue(St,ve),D.setupElevationDraw(Ze,oe,at),S.prepareDrawProgram(J,oe,Ue.toUnwrapped()),oe.draw(J,De,be,nt,ye,_.CullFaceMode.backCCW,Ot,"terrain_raster",D.gridBuffer,Fe,Re)}})}}(g,this,this.proxySourceCache,c,this._updateTimestamp),this.renderingToTexture=!0,g.gpuTimingDeferredRenderEnd(),c.splice(0,c.length))}renderBatch(c){if(0===this._drapedRenderBatches.length)return c+1;this.renderingToTexture=!0;const g=this.painter,C=this.painter.context,S=this.proxySourceCache,D=this.proxiedCoords[S.id],L=this._drapedRenderBatches.shift(),B=[],G=g.style.order;let J=0;for(const ee of D){const oe=S.getTileByID(ee.proxyTileKey),de=S.proxyCachedFBO[ee.key]?S.proxyCachedFBO[ee.key][c]:void 0,ge=void 0!==de?S.renderCache[de]:this.pool[J++],ue=void 0!==de;if(oe.texture=ge.tex,ue&&!ge.dirty){B.push(oe.tileID);continue}let ye;C.bindFramebuffer.set(ge.fb.framebuffer),this.renderedToTile=!1,ge.dirty&&(C.clear({color:_.Color.transparent,stencil:0}),ge.dirty=!1);for(let be=L.start;be<=L.end;++be){const ce=g.style._layers[G[be]];if(ce.isHidden(g.transform.zoom))continue;const Te=g.style._getLayerSourceCache(ce),ve=Te?this.proxyToSource[ee.key][Te.id]:[ee];if(!ve)continue;const De=ve;C.viewport.set([0,0,ge.fb.width,ge.fb.height]),ye!==(Te?Te.id:null)&&(this._setupStencil(ge,ve,ce,Te),ye=Te?Te.id:null),g.renderLayer(g,Te,ce,De)}this.renderedToTile?(ge.dirty=!0,B.push(oe.tileID)):ue||--J,5===J&&(J=0,this.renderToBackBuffer(B))}return this.renderToBackBuffer(B),this.renderingToTexture=!1,C.bindFramebuffer.set(null),C.viewport.set([0,0,g.width,g.height]),L.end+1}postRender(){}renderCacheEfficiency(c){const g=c.order.length;if(0===g)return{efficiency:100};let C,S=0,D=0,L=!1;for(let B=0;B<g;++B){const G=c._layers[c.order[B]];this._style.isLayerDraped(G)?(L&&++S,++D):L||(L=!0,C=G.id)}return 0===D?{efficiency:100}:{efficiency:100*(1-S/D),firstUndrapedLayer:C}}getMinElevationBelowMSL(){let c=0;return this._visibleDemTiles.filter(g=>g.dem).forEach(g=>{c=Math.min(c,g.dem.tree.minimums[0])}),0===c?c:(c-30)*this._exaggeration}raycast(c,g,C){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(D=>D.dem).map(D=>{const L=D.tileID,B=1<<L.overscaledZ,{x:G,y:J}=L.canonical,ee=G/B,oe=(G+1)/B,de=J/B,ge=(J+1)/B;return{minx:ee,miny:de,maxx:oe,maxy:ge,t:D.dem.tree.raycastRoot(ee,de,oe,ge,c,g,C),tile:D}});S.sort((D,L)=>(null!==D.t?D.t:Number.MAX_VALUE)-(null!==L.t?L.t:Number.MAX_VALUE));for(const D of S){if(null==D.t)return null;const L=D.tile.dem.tree.raycast(D.minx,D.miny,D.maxx,D.maxy,c,g,C);if(null!=L)return L}return null}_createFBO(){const c=this.painter.context,g=c.gl,C=this.drapeBufferSize;c.activeTexture.set(g.TEXTURE0);const S=new _.Texture(c,{width:C[0],height:C[1],data:null},g.RGBA);S.bind(g.LINEAR,g.CLAMP_TO_EDGE);const D=c.createFramebuffer(C[0],C[1],!1);return D.colorAttachment.set(S.texture),D.depthAttachment=new Qr(c,D.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=c.createRenderbuffer(c.gl.DEPTH_STENCIL,C[0],C[1]),this._stencilRef=0,D.depthAttachment.set(this._sharedDepthStencil),c.clear({stencil:0})):D.depthAttachment.set(this._sharedDepthStencil),c.extTextureFilterAnisotropic&&!c.extTextureFilterAnisotropicForceOff&&g.texParameterf(g.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax),{fb:D,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c].hasTransition())return!0;return this._style.order.some(c=>{const g=this._style._layers[c],C=g.isHidden(this.painter.transform.zoom);return"custom"===g.type?!C&&g.shouldRedrape():!C&&g.hasTransition()})}_clearLineLayersFromRenderCache(){let c=!1;for(const C of this._style._getSources())if(C instanceof $){c=!0;break}if(!c)return;const g={};for(let C=0;C<this._style.order.length;++C){const S=this._style._layers[this._style.order[C]],D=this._style._getLayerSourceCache(S);if(D&&!g[D.id]&&!S.isHidden(this.painter.transform.zoom)&&"line"===S.type&&S.widthExpression()instanceof _.ZoomDependentExpression){g[D.id]=!0;for(const L of this.proxyCoords){const B=this.proxyToSource[L.key][D.id];if(B)for(const G of B)this._clearRenderCacheForTile(D.id,G)}}}}_clearRasterLayersFromRenderCache(){let c=!1;for(const C in this._style._sourceCaches)if(this._style._sourceCaches[C]._source instanceof H){c=!0;break}if(!c)return;const g={};for(let C=0;C<this._style.order.length;++C){const S=this._style._layers[this._style.order[C]],D=this._style._getLayerSourceCache(S);if(!D||g[D.id]||S.isHidden(this.painter.transform.zoom)||"raster"!==S.type)continue;const L=S.paint.get("raster-fade-duration");for(const B of this.proxyCoords){const G=this.proxyToSource[B.key][D.id];if(G)for(const J of G){const ee=$c(D.getTile(J),D.findLoadedParent(J,0),D,this.painter.transform,L);(1!==ee.opacity||0!==ee.mix)&&this._clearRenderCacheForTile(D.id,J)}}}}_setupDrapedRenderBatches(){const c=this._style.order,g=c.length;if(0===g)return;const C=[];let S,D=0,L=this._style._layers[c[D]];for(;!this._style.isLayerDraped(L)&&L.isHidden(this.painter.transform.zoom)&&++D<g;)L=this._style._layers[c[D]];for(;D<g;++D){const B=this._style._layers[c[D]];B.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(B)?void 0===S&&(S=D):void 0!==S&&(C.push({start:S,end:D-1}),S=void 0))}void 0!==S&&C.push({start:S,end:D-1}),this._drapedRenderBatches=C}_setupRenderCache(c){const g=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,g.renderCache.length>g.renderCachePool.length){const L=Object.values(g.proxyCachedFBO);g.proxyCachedFBO={};for(let B=0;B<L.length;++B){const G=Object.values(L[B]);g.renderCachePool.push(...G)}}return}this._clearRasterLayersFromRenderCache();const C=this.proxyCoords,S=this._tilesDirty;for(let L=C.length-1;L>=0;L--){const B=C[L];if(g.getTileByID(B.key),void 0!==g.proxyCachedFBO[B.key]){const G=c[B.key],J=this.proxyToSource[B.key];let ee=0;for(const oe in J){const de=J[oe],ge=G[oe];if(!ge||ge.length!==de.length||de.some((ue,ye)=>ue!==ge[ye]||S[oe]&&S[oe].hasOwnProperty(ue.key))){ee=-1;break}++ee}for(const oe in g.proxyCachedFBO[B.key])g.renderCache[g.proxyCachedFBO[B.key][oe]].dirty=ee<0||ee!==Object.values(G).length}}const D=[...this._drapedRenderBatches];D.sort((L,B)=>B.end-B.start-(L.end-L.start));for(const L of D)for(const B of C){if(g.proxyCachedFBO[B.key])continue;let G=g.renderCachePool.pop();void 0===G&&g.renderCache.length<50&&(G=g.renderCache.length,g.renderCache.push(this._createFBO())),void 0!==G&&(g.proxyCachedFBO[B.key]={},g.proxyCachedFBO[B.key][L.start]=G,g.renderCache[G].dirty=!0)}this._tilesDirty={}}_setupStencil(c,g,C,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const D=this.painter.context,L=D.gl;if(g.length<=1)return void(this._overlapStencilType=!1);let B;if(C.isTileClipped())B=g.length,this._overlapStencilMode.test={func:L.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(g[0].overscaledZ>g[g.length-1].overscaledZ))return void(this._overlapStencilType=!1);B=1,this._overlapStencilMode.test={func:L.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+B>255&&(D.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=B,this._overlapStencilMode.ref=this._stencilRef,C.isTileClipped()&&this._renderTileClippingMasks(g,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(c){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[c.key]),this._overlapStencilMode):_.StencilMode.disabled}_renderTileClippingMasks(c,g){const C=this.painter,S=this.painter.context,D=S.gl;C._tileClippingMaskIDs={},S.setColorMode(_.ColorMode.disabled),S.setDepthMode(_.DepthMode.disabled);const L=C.useProgram("clippingMask");for(const B of c){const G=C._tileClippingMaskIDs[B.key]=--g;L.draw(S,D.TRIANGLES,_.DepthMode.disabled,new _.StencilMode({func:D.ALWAYS,mask:0},G,255,D.KEEP,D.KEEP,D.REPLACE),_.ColorMode.disabled,_.CullFaceMode.disabled,di(B.projMatrix),"$clipping",C.tileExtentBuffer,C.quadTriangleIndexBuffer,C.tileExtentSegments)}}pointCoordinate(c){const g=this.painter.transform;if(c.x<0||c.x>g.width||c.y<0||c.y>g.height)return null;const C=[c.x,c.y,1,1];_.transformMat4$1(C,C,g.pixelMatrixInverse),_.scale$1(C,C,1/C[3]),C[0]/=g.worldSize,C[1]/=g.worldSize;const S=g._camera.position,D=_.mercatorZfromAltitude(1,g.center.lat),L=[S[0],S[1],S[2]/D,0],B=_.subtract([],C.slice(0,3),L);_.normalize(B,B);const G=this.raycast(L,B,this._exaggeration);return null!==G&&G?(_.scaleAndAdd(L,L,B,G),L[3]=L[2],L[2]*=D,L):null}drawDepth(){const c=this.painter,g=c.context,C=this.proxySourceCache,S=Math.ceil(c.width),D=Math.ceil(c.height);if(!this._depthFBO||this._depthFBO.width===S&&this._depthFBO.height===D||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const L=g.gl,B=g.createFramebuffer(S,D,!0);g.activeTexture.set(L.TEXTURE0);const G=new _.Texture(g,{width:S,height:D,data:null},L.RGBA);G.bind(L.NEAREST,L.CLAMP_TO_EDGE),B.colorAttachment.set(G.texture);const J=g.createRenderbuffer(g.gl.DEPTH_COMPONENT16,S,D);B.depthAttachment.set(J),this._depthFBO=B,this._depthTexture=G}g.bindFramebuffer.set(this._depthFBO.framebuffer),g.viewport.set([0,0,S,D]),function(L,B,G,J){if("globe"===L.transform.projection.name)return;const ee=L.context,oe=ee.gl;ee.clear({depth:1});const de=L.useProgram("terrainDepth"),ge=new _.DepthMode(oe.LESS,_.DepthMode.ReadWrite,L.depthRangeFor3D);for(const ue of J){const ye=G.getTile(ue),be=to(ue.projMatrix,0);B.setupElevationDraw(ye,de),de.draw(ee,oe.TRIANGLES,ge,_.StencilMode.disabled,_.ColorMode.unblended,_.CullFaceMode.backCCW,be,"terrain_depth",B.gridBuffer,B.gridIndexBuffer,B.gridNoSkirtSegments)}}(c,this,C,this.proxyCoords)}_setupProxiedCoordsForOrtho(c,g,C){if(c.getSource()instanceof fe)return this._setupProxiedCoordsForImageSource(c,g,C);this._findCoveringTileCache[c.id]=this._findCoveringTileCache[c.id]||{};const S=this.proxiedCoords[c.id]=[],D=this.proxyCoords;for(let B=0;B<D.length;B++){const G=D[B],J=this._findTileCoveringTileID(G,c);if(J){const ee=this._createProxiedId(G,J,C[G.key]&&C[G.key][c.id]);S.push(ee),this.proxyToSource[G.key][c.id]=[ee]}}let L=!1;for(let B=0;B<g.length;B++){const G=c.getTile(g[B]);if(!G||!G.hasData())continue;const J=this._findTileCoveringTileID(G.tileID,this.proxySourceCache);if(J&&J.tileID.canonical.z!==G.tileID.canonical.z){const ee=this.proxyToSource[J.tileID.key][c.id],oe=this._createProxiedId(J.tileID,G,C[J.tileID.key]&&C[J.tileID.key][c.id]);ee?ee.splice(ee.length-1,0,oe):this.proxyToSource[J.tileID.key][c.id]=[oe],S.push(oe),L=!0}}this._sourceTilesOverlap[c.id]=L}_setupProxiedCoordsForImageSource(c,g,C){if(!c.getSource().loaded())return;const S=this.proxiedCoords[c.id]=[],D=this.proxyCoords,L=c.getSource(),B=new _.pointGeometry(L.tileID.x,L.tileID.y)._div(1<<L.tileID.z),G=L.coordinates.map(_.MercatorCoordinate.fromLngLat).reduce((ee,oe)=>(ee.min.x=Math.min(ee.min.x,oe.x-B.x),ee.min.y=Math.min(ee.min.y,oe.y-B.y),ee.max.x=Math.max(ee.max.x,oe.x-B.x),ee.max.y=Math.max(ee.max.y,oe.y-B.y),ee),{min:new _.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new _.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),J=(ee,oe)=>{const de=ee.wrap+ee.canonical.x/(1<<ee.canonical.z),ge=ee.canonical.y/(1<<ee.canonical.z),ue=_.EXTENT/(1<<ee.canonical.z),ye=oe.wrap+oe.canonical.x/(1<<oe.canonical.z),be=oe.canonical.y/(1<<oe.canonical.z);return de+ue<ye+G.min.x||de>ye+G.max.x||ge+ue<be+G.min.y||ge>be+G.max.y};for(let ee=0;ee<D.length;ee++){const oe=D[ee];for(let de=0;de<g.length;de++){const ge=c.getTile(g[de]);if(!ge||!ge.hasData()||J(oe,ge.tileID))continue;const ue=this._createProxiedId(oe,ge,C[oe.key]&&C[oe.key][c.id]),ye=this.proxyToSource[oe.key][c.id];ye?ye.push(ue):this.proxyToSource[oe.key][c.id]=[ue],S.push(ue)}}}_createProxiedId(c,g,C){let S=this.orthoMatrix;if(C){const D=C.find(L=>L.key===g.tileID.key);if(D)return D}if(g.tileID.key!==c.key){const D=c.canonical.z-g.tileID.canonical.z;let L,B,G;S=_.create();const J=g.tileID.wrap-c.wrap<<c.overscaledZ;D>0?(L=_.EXTENT>>D,B=L*((g.tileID.canonical.x<<D)-c.canonical.x+J),G=L*((g.tileID.canonical.y<<D)-c.canonical.y)):(L=_.EXTENT<<-D,B=_.EXTENT*(g.tileID.canonical.x-(c.canonical.x+J<<-D)),G=_.EXTENT*(g.tileID.canonical.y-(c.canonical.y<<-D))),_.ortho(S,0,L,0,L,0,1),_.translate(S,S,[B,G,0])}return new ca(g.tileID,c.key,S)}_findTileCoveringTileID(c,g){let C=g.getTile(c);if(C&&C.hasData())return C;const S=this._findCoveringTileCache[g.id],D=S[c.key];if(C=D?g.getTileByID(D):null,C&&C.hasData()||null===D)return C;let L=C?C.tileID:c,B=L.overscaledZ;const G=g.getSource().minzoom,J=[];if(!D){const oe=g.getSource().maxzoom;if(c.canonical.z>=oe){const de=c.canonical.z-oe;g.getSource().reparseOverscaled?(B=Math.max(c.canonical.z+2,g.transform.tileZoom),L=new _.OverscaledTileID(B,c.wrap,oe,c.canonical.x>>de,c.canonical.y>>de)):0!==de&&(B=oe,L=new _.OverscaledTileID(B,c.wrap,oe,c.canonical.x>>de,c.canonical.y>>de))}L.key!==c.key&&(J.push(L.key),C=g.getTile(L))}const ee=oe=>{J.forEach(de=>{S[de]=oe}),J.length=0};for(B-=1;B>=G&&(!C||!C.hasData());B--){C&&ee(C.tileID.key);const oe=L.calculateScaledKey(B);if(C=g.getTileByID(oe),C&&C.hasData())break;const de=S[oe];if(null===de)break;void 0===de?J.push(oe):C=g.getTileByID(de)}return ee(C?C.tileID.key:null),C&&C.hasData()?C:null}findDEMTileFor(c){return this.enabled?this._findTileCoveringTileID(c,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(c,g){let C=this._tilesDirty[c];C||(C=this._tilesDirty[c]={}),C[g.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const c=function(g){let C=0;const S=new _.StructArrayLayout2ui4,D=131;for(let L=1;L<129;L++){for(let B=1;B<129;B++)C=L*D+B,S.emplaceBack(C,C+1),S.emplaceBack(C,C+D),S.emplaceBack(C+1,C+D),128===L&&S.emplaceBack(C+D,C+D+1);S.emplaceBack(C+1,C+1+D)}return S}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(c),this.wireframeSegments=_.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,c.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Gc{static cacheKey(c,g,C,S){let D=`${g}${S?S.cacheKey:""}`;for(const L of C)c.usedDefines.includes(L)&&(D+=`/${L}`);return D}constructor(c,g,C,S,D,L){const B=c.gl;this.program=B.createProgram();const G=function(ce){const Te=[];for(let ve=0;ve<ce.length;ve++){if(null===ce[ve])continue;const De=ce[ve].split(" ");Te.push(De.pop())}return Te}(C.staticAttributes),J=S?S.getBinderAttributes():[],ee=G.concat(J);let oe=S?S.defines():[];oe=oe.concat(L.map(ce=>`#define ${ce}`));const de=c.isWebGL2?"#version 300 es\n":"",ge=de+oe.concat(c.extStandardDerivatives&&0===de.length?"#extension GL_OES_standard_derivatives : enable\n".concat(rc):rc,rc,Bc,Du.fragmentSource,ic.fragmentSource,C.fragmentSource).join("\n"),ue=de+oe.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",Bc,Du.vertexSource,ic.vertexSource,Cp.vertexSource,C.vertexSource).join("\n"),ye=B.createShader(B.FRAGMENT_SHADER);if(B.isContextLost())return void(this.failedToCreate=!0);B.shaderSource(ye,ge),B.compileShader(ye),B.attachShader(this.program,ye);const be=B.createShader(B.VERTEX_SHADER);if(B.isContextLost())this.failedToCreate=!0;else{B.shaderSource(be,ue),B.compileShader(be),B.attachShader(this.program,be),this.attributes={},this.numAttributes=ee.length;for(let ce=0;ce<this.numAttributes;ce++)ee[ce]&&(B.bindAttribLocation(this.program,ce,ee[ce]),this.attributes[ee[ce]]=ce);B.linkProgram(this.program),B.deleteShader(be),B.deleteShader(ye),this.fixedUniforms=D(c),this.binderUniforms=S?S.getUniforms(c):[],L.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new _.Uniform1i(ce=c),u_dem_prev:new _.Uniform1i(ce),u_dem_unpack:new _.Uniform4f(ce),u_dem_tl:new _.Uniform2f(ce),u_dem_scale:new _.Uniform1f(ce),u_dem_tl_prev:new _.Uniform2f(ce),u_dem_scale_prev:new _.Uniform1f(ce),u_dem_size:new _.Uniform1f(ce),u_dem_lerp:new _.Uniform1f(ce),u_exaggeration:new _.Uniform1f(ce),u_depth:new _.Uniform1i(ce),u_depth_size_inv:new _.Uniform2f(ce),u_meter_to_dem:new _.Uniform1f(ce),u_label_plane_matrix_inv:new _.UniformMatrix4f(ce)}),L.includes("GLOBE")&&(this.globeUniforms=(ce=>({u_tile_tl_up:new _.Uniform3f(ce),u_tile_tr_up:new _.Uniform3f(ce),u_tile_br_up:new _.Uniform3f(ce),u_tile_bl_up:new _.Uniform3f(ce),u_tile_up_scale:new _.Uniform1f(ce)}))(c)),L.includes("FOG")&&(this.fogUniforms=(ce=>({u_fog_matrix:new _.UniformMatrix4f(ce),u_fog_range:new _.Uniform2f(ce),u_fog_color:new _.Uniform4f(ce),u_fog_horizon_blend:new _.Uniform1f(ce),u_fog_temporal_offset:new _.Uniform1f(ce),u_frustum_tl:new _.Uniform3f(ce),u_frustum_tr:new _.Uniform3f(ce),u_frustum_br:new _.Uniform3f(ce),u_frustum_bl:new _.Uniform3f(ce),u_globe_pos:new _.Uniform3f(ce),u_globe_radius:new _.Uniform1f(ce),u_globe_transition:new _.Uniform1f(ce),u_is_globe:new _.Uniform1i(ce),u_viewport:new _.Uniform2f(ce)}))(c))}var ce}setTerrainUniformValues(c,g){if(!this.terrainUniforms)return;const C=this.terrainUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const S in g)C[S]&&C[S].set(this.program,S,g[S])}}setGlobeUniformValues(c,g){if(!this.globeUniforms)return;const C=this.globeUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const S in g)C[S]&&C[S].set(this.program,S,g[S])}}setFogUniformValues(c,g){if(!this.fogUniforms)return;const C=this.fogUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const S in g)C[S].set(this.program,S,g[S])}}draw(c,g,C,S,D,L,B,G,J,ee,oe,de,ge,ue,ye){const be=c.gl;if(this.failedToCreate)return;c.program.set(this.program),c.setDepthMode(C),c.setStencilMode(S),c.setColorMode(D),c.setCullFace(L);for(const Te of Object.keys(this.fixedUniforms))this.fixedUniforms[Te].set(this.program,Te,B[Te]);ue&&ue.setUniforms(this.program,c,this.binderUniforms,de,{zoom:ge});const ce={[be.LINES]:2,[be.TRIANGLES]:3,[be.LINE_STRIP]:1}[g];for(const Te of oe.get()){const ve=Te.vaos||(Te.vaos={});(ve[G]||(ve[G]=new wd)).bind(c,this,J,ue?ue.getPaintVertexBuffers():[],ee,Te.vertexOffset,ye||[]),be.drawElements(g,Te.primitiveLength*ce,be.UNSIGNED_SHORT,Te.primitiveOffset*ce*2)}}}function Ii(v,c){const g=Math.pow(2,c.tileID.overscaledZ),C=c.tileSize*Math.pow(2,v.transform.tileZoom)/g,S=C*(c.tileID.canonical.x+c.tileID.wrap*g),D=C*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_tile_units_to_pixels:1/en(c,1,v.transform.tileZoom),u_pixel_coord_upper:[S>>16,D>>16],u_pixel_coord_lower:[65535&S,65535&D]}}const pf=_.create(),ah=(v,c,g,C,S,D,L,B,G,J,ee)=>{const oe=c.style.light,de=oe.properties.get("position"),ge=[de.x,de.y,de.z],ue=_.create$1();"viewport"===oe.properties.get("anchor")&&(_.fromRotation(ue,-c.transform.angle),_.transformMat3(ge,ge,ue));const ye=oe.properties.get("color"),be=c.transform,ce={u_matrix:v,u_lightpos:ge,u_lightintensity:oe.properties.get("intensity"),u_lightcolor:[ye.r,ye.g,ye.b],u_vertical_gradient:+g,u_opacity:C,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:pf,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:S,u_edge_radius:D};return"globe"===be.projection.name&&(ce.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],ce.u_zoom_transition=G,ce.u_inv_rot_matrix=ee,ce.u_merc_center=J,ce.u_up_dir=be.projection.upVector(new _.CanonicalTileID(0,0,0),J[0]*_.EXTENT,J[1]*_.EXTENT),ce.u_height_lift=B),ce},Cd=(v,c,g,C,S,D,L,B,G,J,ee,oe)=>{const de=ah(v,c,g,C,S,D,L,G,J,ee,oe),ge={u_height_factor:-Math.pow(2,L.overscaledZ)/B.tileSize/8};return _.extend(de,Ii(c,B),ge)},lh=v=>({u_matrix:v}),ku=(v,c,g)=>_.extend(lh(v),Ii(c,g)),Ep=(v,c)=>({u_matrix:v,u_world:c}),ch=(v,c,g,C)=>_.extend(ku(v,c,g),{u_world:C}),wo=_.create(),qt=(v,c,g,C,S,D)=>{const L=v.transform,B="globe"===L.projection.name;let G;if("map"===D.paint.get("circle-pitch-alignment"))if(B){const ee=_.globePixelsToTileUnits(L.zoom,c.canonical)*L._pixelsPerMercatorPixel;G=Float32Array.from([ee,0,0,ee])}else G=L.calculatePixelsToTileUnitsMatrix(g);else G=new Float32Array([L.pixelsToGLUnits[0],0,0,L.pixelsToGLUnits[1]]);const J={u_camera_to_center_distance:L.cameraToCenterDistance,u_matrix:v.translatePosMatrix(c.projMatrix,g,D.paint.get("circle-translate"),D.paint.get("circle-translate-anchor")),u_device_pixel_ratio:_.exported.devicePixelRatio,u_extrude_scale:G,u_inv_rot_matrix:wo,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(B){J.u_inv_rot_matrix=C,J.u_merc_center=S,J.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],J.u_zoom_transition=_.globeToMercatorTransition(L.zoom);const ee=S[0]*_.EXTENT,oe=S[1]*_.EXTENT;J.u_up_dir=L.projection.upVector(new _.CanonicalTileID(0,0,0),ee,oe)}return J},$i=v=>{const c=[];return"map"===v.paint.get("circle-pitch-alignment")&&c.push("PITCH_WITH_MAP"),"map"===v.paint.get("circle-pitch-scale")&&c.push("SCALE_WITH_MAP"),c},Tp=(v,c,g,C)=>{const S=_.EXTENT/g.tileSize;return{u_matrix:v,u_camera_to_center_distance:c.getCameraToCenterDistance(C),u_extrude_scale:[c.pixelsToGLUnits[0]/S,c.pixelsToGLUnits[1]/S]}},Ed=(v,c,g=1)=>({u_matrix:v,u_color:c,u_overlay:0,u_overlay_scale:g}),Po=_.create(),Xa=(v,c,g,C,S,D,L)=>{const B=v.transform,G="globe"===B.projection.name,J=G?_.globePixelsToTileUnits(B.zoom,c.canonical)*B._pixelsPerMercatorPixel:en(g,1,D),ee={u_matrix:c.projMatrix,u_extrude_scale:J,u_intensity:L,u_inv_rot_matrix:Po,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(G){ee.u_inv_rot_matrix=C,ee.u_merc_center=S,ee.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],ee.u_zoom_transition=_.globeToMercatorTransition(B.zoom);const oe=S[0]*_.EXTENT,de=S[1]*_.EXTENT;ee.u_up_dir=B.projection.upVector(new _.CanonicalTileID(0,0,0),oe,de)}return ee},Ml=(v,c,g,C,S,D,L)=>{const B=v.transform,G=B.calculatePixelsToTileUnitsMatrix(c);return{u_matrix:uh(v,c,g,C),u_pixels_to_tile_units:G,u_device_pixel_ratio:D,u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:S,u_texsize:qc(g)?c.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Hc(c,v.transform),u_alpha_discard_threshold:0,u_trim_offset:L}},Qa=(v,c,g,C,S)=>{const D=v.transform;return{u_matrix:uh(v,c,g,C),u_texsize:c.imageAtlasTexture.size,u_pixels_to_tile_units:D.calculatePixelsToTileUnitsMatrix(c),u_device_pixel_ratio:S,u_image:0,u_tile_units_to_pixels:Hc(c,D),u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Hc(v,c){return 1/en(v,1,c.tileZoom)}function uh(v,c,g,C){return v.translatePosMatrix(C||c.tileID.projMatrix,c,g.paint.get("line-translate"),g.paint.get("line-translate-anchor"))}function qc(v){const c=v.paint.get("line-dasharray").value;return c.value||"constant"!==c.kind}const T_=(v,c,g,C,S,D)=>{return{u_matrix:v,u_tl_parent:c,u_scale_parent:g,u_fade_t:C.mix,u_opacity:C.opacity*S.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:S.paint.get("raster-brightness-min"),u_brightness_high:S.paint.get("raster-brightness-max"),u_saturation_factor:(B=S.paint.get("raster-saturation"),B>0?1-1/(1.001-B):-B),u_contrast_factor:(L=S.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:Ru(S.paint.get("raster-hue-rotate")),u_perspective_transform:D};var L,B};function Ru(v){v*=Math.PI/180;const c=Math.sin(v),g=Math.cos(v);return[(2*g+1)/3,(-Math.sqrt(3)*c-g+1)/3,(Math.sqrt(3)*c-g+1)/3]}const Xo=_.create(),Uo=(v,c,g,C,S,D,L,B,G,J,ee,oe,de,ge,ue,ye)=>{const be=S.transform,ce={u_is_size_zoom_constant:+("constant"===v||"source"===v),u_is_size_feature_constant:+("constant"===v||"camera"===v),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:be.cameraToCenterDistance,u_rotate_symbol:+g,u_aspect_ratio:be.width/be.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:L,u_coord_matrix:B,u_is_text:+G,u_pitch_with_map:+C,u_texsize:J,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Xo,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Xo,u_up_vector:[0,-1,0]};return"globe"===ye.name&&(ce.u_tile_id=[ee.canonical.x,ee.canonical.y,1<<ee.canonical.z],ce.u_zoom_transition=oe,ce.u_inv_rot_matrix=ge,ce.u_merc_center=de,ce.u_camera_forward=be._camera.forward(),ce.u_ecef_origin=_.globeECEFOrigin(be.globeMatrix,ee.toUnwrapped()),ce.u_tile_matrix=Float32Array.from(be.globeMatrix),ce.u_up_vector=ue),ce},Ip=(v,c,g,C,S,D,L,B,G,J,ee,oe,de,ge,ue,ye,be)=>_.extend(Uo(v,c,g,C,S,D,L,B,G,J,oe,de,ge,ue,ye,be),{u_gamma_scale:C?S.transform.cameraToCenterDistance*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:_.exported.devicePixelRatio,u_is_halo:+ee}),Dl=(v,c,g,C,S,D,L,B,G,J,ee,oe,de,ge,ue,ye)=>_.extend(Ip(v,c,g,C,S,D,L,B,!0,G,!0,ee,oe,de,ge,ue,ye),{u_texsize_icon:J,u_texture_icon:1}),Ja=(v,c,g)=>({u_matrix:v,u_opacity:c,u_color:g}),dh=(v,c,g,C,S)=>_.extend(function(D,L,B){const G=L.imageManager.getPattern(D.toString()),{width:J,height:ee}=L.imageManager.getPixelSize(),oe=Math.pow(2,B.tileID.overscaledZ),de=B.tileSize*Math.pow(2,L.transform.tileZoom)/oe,ge=de*(B.tileID.canonical.x+B.tileID.wrap*oe),ue=de*B.tileID.canonical.y;return{u_image:0,u_pattern_tl:G.tl,u_pattern_br:G.br,u_texsize:[J,ee],u_pattern_size:G.displaySize,u_tile_units_to_pixels:1/en(B,1,L.transform.tileZoom),u_pixel_coord_upper:[ge>>16,ue>>16],u_pixel_coord_lower:[65535&ge,65535&ue]}}(C,g,S),{u_matrix:v,u_opacity:c}),Sp={fillExtrusion:v=>({u_matrix:new _.UniformMatrix4f(v),u_lightpos:new _.Uniform3f(v),u_lightintensity:new _.Uniform1f(v),u_lightcolor:new _.Uniform3f(v),u_vertical_gradient:new _.Uniform1f(v),u_opacity:new _.Uniform1f(v),u_edge_radius:new _.Uniform1f(v),u_ao:new _.Uniform2f(v),u_tile_id:new _.Uniform3f(v),u_zoom_transition:new _.Uniform1f(v),u_inv_rot_matrix:new _.UniformMatrix4f(v),u_merc_center:new _.Uniform2f(v),u_up_dir:new _.Uniform3f(v),u_height_lift:new _.Uniform1f(v)}),fillExtrusionPattern:v=>({u_matrix:new _.UniformMatrix4f(v),u_lightpos:new _.Uniform3f(v),u_lightintensity:new _.Uniform1f(v),u_lightcolor:new _.Uniform3f(v),u_vertical_gradient:new _.Uniform1f(v),u_height_factor:new _.Uniform1f(v),u_edge_radius:new _.Uniform1f(v),u_ao:new _.Uniform2f(v),u_tile_id:new _.Uniform3f(v),u_zoom_transition:new _.Uniform1f(v),u_inv_rot_matrix:new _.UniformMatrix4f(v),u_merc_center:new _.Uniform2f(v),u_up_dir:new _.Uniform3f(v),u_height_lift:new _.Uniform1f(v),u_image:new _.Uniform1i(v),u_texsize:new _.Uniform2f(v),u_pixel_coord_upper:new _.Uniform2f(v),u_pixel_coord_lower:new _.Uniform2f(v),u_tile_units_to_pixels:new _.Uniform1f(v),u_opacity:new _.Uniform1f(v)}),fill:v=>({u_matrix:new _.UniformMatrix4f(v)}),fillPattern:v=>({u_matrix:new _.UniformMatrix4f(v),u_image:new _.Uniform1i(v),u_texsize:new _.Uniform2f(v),u_pixel_coord_upper:new _.Uniform2f(v),u_pixel_coord_lower:new _.Uniform2f(v),u_tile_units_to_pixels:new _.Uniform1f(v)}),fillOutline:v=>({u_matrix:new _.UniformMatrix4f(v),u_world:new _.Uniform2f(v)}),fillOutlinePattern:v=>({u_matrix:new _.UniformMatrix4f(v),u_world:new _.Uniform2f(v),u_image:new _.Uniform1i(v),u_texsize:new _.Uniform2f(v),u_pixel_coord_upper:new _.Uniform2f(v),u_pixel_coord_lower:new _.Uniform2f(v),u_tile_units_to_pixels:new _.Uniform1f(v)}),circle:v=>({u_camera_to_center_distance:new _.Uniform1f(v),u_extrude_scale:new _.UniformMatrix2f(v),u_device_pixel_ratio:new _.Uniform1f(v),u_matrix:new _.UniformMatrix4f(v),u_inv_rot_matrix:new _.UniformMatrix4f(v),u_merc_center:new _.Uniform2f(v),u_tile_id:new _.Uniform3f(v),u_zoom_transition:new _.Uniform1f(v),u_up_dir:new _.Uniform3f(v)}),collisionBox:v=>({u_matrix:new _.UniformMatrix4f(v),u_camera_to_center_distance:new _.Uniform1f(v),u_extrude_scale:new _.Uniform2f(v)}),collisionCircle:v=>({u_matrix:new _.UniformMatrix4f(v),u_inv_matrix:new _.UniformMatrix4f(v),u_camera_to_center_distance:new _.Uniform1f(v),u_viewport_size:new _.Uniform2f(v)}),debug:v=>({u_color:new _.UniformColor(v),u_matrix:new _.UniformMatrix4f(v),u_overlay:new _.Uniform1i(v),u_overlay_scale:new _.Uniform1f(v)}),clippingMask:v=>({u_matrix:new _.UniformMatrix4f(v)}),heatmap:v=>({u_extrude_scale:new _.Uniform1f(v),u_intensity:new _.Uniform1f(v),u_matrix:new _.UniformMatrix4f(v),u_inv_rot_matrix:new _.UniformMatrix4f(v),u_merc_center:new _.Uniform2f(v),u_tile_id:new _.Uniform3f(v),u_zoom_transition:new _.Uniform1f(v),u_up_dir:new _.Uniform3f(v)}),heatmapTexture:v=>({u_image:new _.Uniform1i(v),u_color_ramp:new _.Uniform1i(v),u_opacity:new _.Uniform1f(v)}),hillshade:v=>({u_matrix:new _.UniformMatrix4f(v),u_image:new _.Uniform1i(v),u_latrange:new _.Uniform2f(v),u_light:new _.Uniform2f(v),u_shadow:new _.UniformColor(v),u_highlight:new _.UniformColor(v),u_accent:new _.UniformColor(v)}),hillshadePrepare:v=>({u_matrix:new _.UniformMatrix4f(v),u_image:new _.Uniform1i(v),u_dimension:new _.Uniform2f(v),u_zoom:new _.Uniform1f(v),u_unpack:new _.Uniform4f(v)}),line:v=>({u_matrix:new _.UniformMatrix4f(v),u_pixels_to_tile_units:new _.UniformMatrix2f(v),u_device_pixel_ratio:new _.Uniform1f(v),u_units_to_pixels:new _.Uniform2f(v),u_dash_image:new _.Uniform1i(v),u_gradient_image:new _.Uniform1i(v),u_image_height:new _.Uniform1f(v),u_texsize:new _.Uniform2f(v),u_tile_units_to_pixels:new _.Uniform1f(v),u_alpha_discard_threshold:new _.Uniform1f(v),u_trim_offset:new _.Uniform2f(v)}),linePattern:v=>({u_matrix:new _.UniformMatrix4f(v),u_texsize:new _.Uniform2f(v),u_pixels_to_tile_units:new _.UniformMatrix2f(v),u_device_pixel_ratio:new _.Uniform1f(v),u_image:new _.Uniform1i(v),u_units_to_pixels:new _.Uniform2f(v),u_tile_units_to_pixels:new _.Uniform1f(v),u_alpha_discard_threshold:new _.Uniform1f(v)}),raster:v=>({u_matrix:new _.UniformMatrix4f(v),u_tl_parent:new _.Uniform2f(v),u_scale_parent:new _.Uniform1f(v),u_fade_t:new _.Uniform1f(v),u_opacity:new _.Uniform1f(v),u_image0:new _.Uniform1i(v),u_image1:new _.Uniform1i(v),u_brightness_low:new _.Uniform1f(v),u_brightness_high:new _.Uniform1f(v),u_saturation_factor:new _.Uniform1f(v),u_contrast_factor:new _.Uniform1f(v),u_spin_weights:new _.Uniform3f(v),u_perspective_transform:new _.Uniform2f(v)}),symbolIcon:v=>({u_is_size_zoom_constant:new _.Uniform1i(v),u_is_size_feature_constant:new _.Uniform1i(v),u_size_t:new _.Uniform1f(v),u_size:new _.Uniform1f(v),u_camera_to_center_distance:new _.Uniform1f(v),u_rotate_symbol:new _.Uniform1i(v),u_aspect_ratio:new _.Uniform1f(v),u_fade_change:new _.Uniform1f(v),u_matrix:new _.UniformMatrix4f(v),u_label_plane_matrix:new _.UniformMatrix4f(v),u_coord_matrix:new _.UniformMatrix4f(v),u_is_text:new _.Uniform1i(v),u_pitch_with_map:new _.Uniform1i(v),u_texsize:new _.Uniform2f(v),u_tile_id:new _.Uniform3f(v),u_zoom_transition:new _.Uniform1f(v),u_inv_rot_matrix:new _.UniformMatrix4f(v),u_merc_center:new _.Uniform2f(v),u_camera_forward:new _.Uniform3f(v),u_tile_matrix:new _.UniformMatrix4f(v),u_up_vector:new _.Uniform3f(v),u_ecef_origin:new _.Uniform3f(v),u_texture:new _.Uniform1i(v)}),symbolSDF:v=>({u_is_size_zoom_constant:new _.Uniform1i(v),u_is_size_feature_constant:new _.Uniform1i(v),u_size_t:new _.Uniform1f(v),u_size:new _.Uniform1f(v),u_camera_to_center_distance:new _.Uniform1f(v),u_rotate_symbol:new _.Uniform1i(v),u_aspect_ratio:new _.Uniform1f(v),u_fade_change:new _.Uniform1f(v),u_matrix:new _.UniformMatrix4f(v),u_label_plane_matrix:new _.UniformMatrix4f(v),u_coord_matrix:new _.UniformMatrix4f(v),u_is_text:new _.Uniform1i(v),u_pitch_with_map:new _.Uniform1i(v),u_texsize:new _.Uniform2f(v),u_texture:new _.Uniform1i(v),u_gamma_scale:new _.Uniform1f(v),u_device_pixel_ratio:new _.Uniform1f(v),u_tile_id:new _.Uniform3f(v),u_zoom_transition:new _.Uniform1f(v),u_inv_rot_matrix:new _.UniformMatrix4f(v),u_merc_center:new _.Uniform2f(v),u_camera_forward:new _.Uniform3f(v),u_tile_matrix:new _.UniformMatrix4f(v),u_up_vector:new _.Uniform3f(v),u_ecef_origin:new _.Uniform3f(v),u_is_halo:new _.Uniform1i(v)}),symbolTextAndIcon:v=>({u_is_size_zoom_constant:new _.Uniform1i(v),u_is_size_feature_constant:new _.Uniform1i(v),u_size_t:new _.Uniform1f(v),u_size:new _.Uniform1f(v),u_camera_to_center_distance:new _.Uniform1f(v),u_rotate_symbol:new _.Uniform1i(v),u_aspect_ratio:new _.Uniform1f(v),u_fade_change:new _.Uniform1f(v),u_matrix:new _.UniformMatrix4f(v),u_label_plane_matrix:new _.UniformMatrix4f(v),u_coord_matrix:new _.UniformMatrix4f(v),u_is_text:new _.Uniform1i(v),u_pitch_with_map:new _.Uniform1i(v),u_texsize:new _.Uniform2f(v),u_texsize_icon:new _.Uniform2f(v),u_texture:new _.Uniform1i(v),u_texture_icon:new _.Uniform1i(v),u_gamma_scale:new _.Uniform1f(v),u_device_pixel_ratio:new _.Uniform1f(v),u_is_halo:new _.Uniform1i(v)}),background:v=>({u_matrix:new _.UniformMatrix4f(v),u_opacity:new _.Uniform1f(v),u_color:new _.UniformColor(v)}),backgroundPattern:v=>({u_matrix:new _.UniformMatrix4f(v),u_opacity:new _.Uniform1f(v),u_image:new _.Uniform1i(v),u_pattern_tl:new _.Uniform2f(v),u_pattern_br:new _.Uniform2f(v),u_texsize:new _.Uniform2f(v),u_pattern_size:new _.Uniform2f(v),u_pixel_coord_upper:new _.Uniform2f(v),u_pixel_coord_lower:new _.Uniform2f(v),u_tile_units_to_pixels:new _.Uniform1f(v)}),terrainRaster:Uc,terrainDepth:Uc,skybox:v=>({u_matrix:new _.UniformMatrix4f(v),u_sun_direction:new _.Uniform3f(v),u_cubemap:new _.Uniform1i(v),u_opacity:new _.Uniform1f(v),u_temporal_offset:new _.Uniform1f(v)}),skyboxGradient:v=>({u_matrix:new _.UniformMatrix4f(v),u_color_ramp:new _.Uniform1i(v),u_center_direction:new _.Uniform3f(v),u_radius:new _.Uniform1f(v),u_opacity:new _.Uniform1f(v),u_temporal_offset:new _.Uniform1f(v)}),skyboxCapture:v=>({u_matrix_3f:new _.UniformMatrix3f(v),u_sun_direction:new _.Uniform3f(v),u_sun_intensity:new _.Uniform1f(v),u_color_tint_r:new _.Uniform4f(v),u_color_tint_m:new _.Uniform4f(v),u_luminance:new _.Uniform1f(v)}),globeRaster:v=>({u_proj_matrix:new _.UniformMatrix4f(v),u_globe_matrix:new _.UniformMatrix4f(v),u_normalize_matrix:new _.UniformMatrix4f(v),u_merc_matrix:new _.UniformMatrix4f(v),u_zoom_transition:new _.Uniform1f(v),u_merc_center:new _.Uniform2f(v),u_image0:new _.Uniform1i(v),u_grid_matrix:new _.UniformMatrix3f(v),u_skirt_height:new _.Uniform1f(v),u_frustum_tl:new _.Uniform3f(v),u_frustum_tr:new _.Uniform3f(v),u_frustum_br:new _.Uniform3f(v),u_frustum_bl:new _.Uniform3f(v),u_globe_pos:new _.Uniform3f(v),u_globe_radius:new _.Uniform1f(v),u_viewport:new _.Uniform2f(v)}),globeAtmosphere:v=>({u_frustum_tl:new _.Uniform3f(v),u_frustum_tr:new _.Uniform3f(v),u_frustum_br:new _.Uniform3f(v),u_frustum_bl:new _.Uniform3f(v),u_horizon:new _.Uniform1f(v),u_transition:new _.Uniform1f(v),u_fadeout_range:new _.Uniform1f(v),u_color:new _.Uniform4f(v),u_high_color:new _.Uniform4f(v),u_space_color:new _.Uniform4f(v),u_star_intensity:new _.Uniform1f(v),u_star_density:new _.Uniform1f(v),u_star_size:new _.Uniform1f(v),u_temporal_offset:new _.Uniform1f(v),u_horizon_angle:new _.Uniform1f(v),u_rotation_matrix:new _.UniformMatrix4f(v)})};let ac;function Mp(v,c,g,C,S,D,L){const B=v.context,G=B.gl,J=v.transform,ee=v.useProgram("collisionBox"),oe=[];let de=0,ge=0;for(let De=0;De<C.length;De++){const Fe=C[De],Re=c.getTile(Fe),Ue=Re.getBucket(g);if(!Ue)continue;const Ze=sa(Fe,Ue,J);let nt=Ze;0===S[0]&&0===S[1]||(nt=v.translatePosMatrix(Ze,Re,S,D));const ot=L?Ue.textCollisionBox:Ue.iconCollisionBox,Ut=Ue.collisionCircleArray;if(Ut.length>0){const Qe=_.create(),St=nt;_.mul(Qe,Ue.placementInvProjMatrix,J.glCoordMatrix),_.mul(Qe,Qe,Ue.placementViewportMatrix),oe.push({circleArray:Ut,circleOffset:ge,transform:St,invTransform:Qe,projection:Ue.getProjection()}),de+=Ut.length/4,ge=de}ot&&(v.terrain&&v.terrain.setupElevationDraw(Re,ee),ee.draw(B,G.LINES,_.DepthMode.disabled,_.StencilMode.disabled,v.colorModeForRenderPass(),_.CullFaceMode.disabled,Tp(nt,J,Re,Ue.getProjection()),g.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,null,J.zoom,null,[ot.collisionVertexBuffer,ot.collisionVertexBufferExt]))}if(!L||!oe.length)return;const ue=v.useProgram("collisionCircle"),ye=new _.StructArrayLayout2f1f2i16;ye.resize(4*de),ye._trim();let be=0;for(const De of oe)for(let Fe=0;Fe<De.circleArray.length/4;Fe++){const Re=4*Fe,Ue=De.circleArray[Re+0],Ze=De.circleArray[Re+1],nt=De.circleArray[Re+2],ot=De.circleArray[Re+3];ye.emplace(be++,Ue,Ze,nt,ot,0),ye.emplace(be++,Ue,Ze,nt,ot,1),ye.emplace(be++,Ue,Ze,nt,ot,2),ye.emplace(be++,Ue,Ze,nt,ot,3)}(!ac||ac.length<2*de)&&(ac=function(De){const Fe=2*De,Re=new _.StructArrayLayout3ui6;Re.resize(Fe),Re._trim();for(let Ue=0;Ue<Fe;Ue++){const Ze=6*Ue;Re.uint16[Ze+0]=4*Ue+0,Re.uint16[Ze+1]=4*Ue+1,Re.uint16[Ze+2]=4*Ue+2,Re.uint16[Ze+3]=4*Ue+2,Re.uint16[Ze+4]=4*Ue+3,Re.uint16[Ze+5]=4*Ue+0}return Re}(de));const ce=B.createIndexBuffer(ac,!0),Te=B.createVertexBuffer(ye,_.collisionCircleLayout.members,!0);for(const De of oe){const Fe={u_matrix:De.transform,u_inv_matrix:De.invTransform,u_camera_to_center_distance:(ve=J).getCameraToCenterDistance(De.projection),u_viewport_size:[ve.width,ve.height]};ue.draw(B,G.TRIANGLES,_.DepthMode.disabled,_.StencilMode.disabled,v.colorModeForRenderPass(),_.CullFaceMode.disabled,Fe,g.id,Te,ce,_.SegmentVector.simpleSegment(0,2*De.circleOffset,De.circleArray.length,De.circleArray.length/2),null,J.zoom)}var ve;Te.destroy(),ce.destroy()}const Ma=_.create();function hh({width:v,height:c,anchor:g,textOffset:C,textScale:S},D){const{horizontalAlign:L,verticalAlign:B}=_.getAnchorAlignment(g),G=-(L-.5)*v,J=-(B-.5)*c,ee=_.evaluateVariableOffset(g,C);return new _.pointGeometry((G/S+ee[0])*D,(J/S+ee[1])*D)}function Fu(v,c,g,C,S,D,L,B,G,J,ee){const oe=v.text.placedSymbolArray,de=v.text.dynamicLayoutVertexArray,ge=v.icon.dynamicLayoutVertexArray,ue={},ye=v.getProjection(),be=bo(B,ye,D),ce=D.elevation,Te=ye.upVectorScale(B.canonical,D.center.lat,D.worldSize).metersToTile;de.clear();for(let ve=0;ve<oe.length;ve++){const De=oe.get(ve),{tileAnchorX:Fe,tileAnchorY:Re,numGlyphs:Ue}=De,nt=De.hidden||!De.crossTileID||v.allowVerticalPlacement&&!De.placedOrientation?null:C[De.crossTileID];if(nt){let ot=0,Ut=0,Qe=0;if(ce){const dn=ce?ce.getAtTileOffset(B,Fe,Re):0,[Yn,gn,Yt]=ye.upVector(B.canonical,Fe,Re);ot=dn*Yn*Te,Ut=dn*gn*Te,Qe=dn*Yt*Te}let[St,at,Ot,et]=Nt(De.projectedAnchorX+ot,De.projectedAnchorY+Ut,De.projectedAnchorZ+Qe,g?be:L);const qe=ri(D.getCameraToCenterDistance(ye),et);let Xe=S.evaluateSizeForFeature(v.textSizeData,J,De)*qe/_.ONE_EM;g&&(Xe*=v.tilePixelRatio/G);const Mt=hh(nt,Xe);g?(({x:St,y:at,z:Ot}=ye.projectTilePoint(Fe+Mt.x,Re+Mt.y,B.canonical)),[St,at,Ot]=Nt(St+ot,at+Ut,Ot+Qe,L)):(c&&Mt._rotate(-D.angle),St+=Mt.x,at+=Mt.y,Ot=0);const Lt=v.allowVerticalPlacement&&De.placedOrientation===_.WritingMode.vertical?Math.PI/2:0;for(let dn=0;dn<Ue;dn++)_.addDynamicAttributes(de,St,at,Ot,Lt);ee&&De.associatedIconIndex>=0&&(ue[De.associatedIconIndex]={x:St,y:at,z:Ot,angle:Lt})}else ji(Ue,de)}if(ee){ge.clear();const ve=v.icon.placedSymbolArray;for(let De=0;De<ve.length;De++){const Fe=ve.get(De),{numGlyphs:Re}=Fe,Ue=ue[De];if(Fe.hidden||!Ue)ji(Re,ge);else{const{x:Ze,y:nt,z:ot,angle:Ut}=Ue;for(let Qe=0;Qe<Re;Qe++)_.addDynamicAttributes(ge,Ze,nt,ot,Ut)}}v.icon.dynamicLayoutVertexBuffer.updateData(ge)}v.text.dynamicLayoutVertexBuffer.updateData(de)}function Dp(v,c,g){return g.iconsInText&&c?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function Gm(v,c,g,C,S,D,L,B,G,J,ee,oe){const de=v.context,ge=de.gl,ue=v.transform,ye="map"===B,be="map"===G,ce=ye&&"point"!==g.layout.get("symbol-placement"),Te=ye&&!be&&!ce,ve=void 0!==g.layout.get("symbol-sort-key").constantOr(1);let De=!1;const Fe=v.depthModeForSublayer(0,_.DepthMode.ReadOnly),Re=[_.mercatorXfromLng(ue.center.lng),_.mercatorYfromLat(ue.center.lat)],Ue=g.layout.get("text-variable-anchor"),Ze="globe"===ue.projection.name,nt=[],ot=[0,-1,0];let Ut=ot;!Ze&&!ue.mercatorFromTransition||ye||(Ut=function(Qe){const St=Qe._camera.getWorldToCamera(Qe.worldSize,1),at=_.multiply([],St,Qe.globeMatrix);_.invert(at,at);const Ot=[0,0,0],et=[0,1,0,0];return _.transformMat4$1(et,et,at),Ot[0]=et[0],Ot[1]=et[1],Ot[2]=et[2],_.normalize(Ot,Ot),Ot}(ue));for(const Qe of C){const St=c.getTile(Qe),at=St.getBucket(g);if(!at||"mercator"===at.projection.name&&Ze)continue;const Ot=S?at.text:at.icon;if(!Ot||at.fullyClipped||!Ot.segments.get().length)continue;const et=Ot.programConfigurations.get(g.id),qe=S||at.sdfIcons,Xe=S?at.textSizeData:at.iconSizeData,Mt=be||0!==ue.pitch,Lt=_.evaluateSizeForZoom(Xe,ue.zoom);let dn,Yn,gn,Yt,yn=[0,0],xi=null;if(S)Yn=St.glyphAtlasTexture,gn=ge.LINEAR,dn=St.glyphAtlasTexture.size,at.iconsInText&&(yn=St.imageAtlasTexture.size,xi=St.imageAtlasTexture,Yt=Mt||v.options.rotating||v.options.zooming||"composite"===Xe.kind||"camera"===Xe.kind?ge.LINEAR:ge.NEAREST);else{const Wr=1!==g.layout.get("icon-size").constantOr(0)||at.iconsNeedLinear;Yn=St.imageAtlasTexture,gn=qe||v.options.rotating||v.options.zooming||Wr||Mt?ge.LINEAR:ge.NEAREST,dn=St.imageAtlasTexture.size}const Bn="globe"===at.projection.name,er=Bn?Ut:ot,Fi=Bn?_.globeToMercatorTransition(ue.zoom):0,sr=bo(Qe,at.getProjection(),ue),vi=ue.calculatePixelsToTileUnitsMatrix(St),Mr=As(sr,St.tileID.canonical,be,ye,ue,at.getProjection(),vi),Ys=v.terrain&&be&&ce?_.invert(_.create(),Mr):Ma,Gs=Ti(sr,St.tileID.canonical,be,ye,ue,at.getProjection(),vi),Fa=Ue&&at.hasTextData(),Er="none"!==g.layout.get("icon-text-fit")&&Fa&&at.hasIconData();if(ce){const Wr=ue.elevation,Ks=Wr?Wr.getAtTileOffsetFunc(Qe,ue.center.lat,ue.worldSize,at.getProjection()):null,ma=Mn(sr,St.tileID.canonical,be,ye,ue,at.getProjection(),vi);ur(at,sr,v,S,ma,Gs,be,J,Ks,Qe)}const ar=ce||S&&Ue||Er,Ki=v.translatePosMatrix(sr,St,D,L),Fr=ar?Ma:Mr,Xn=v.translatePosMatrix(Gs,St,D,L,!0),Li=at.getProjection().createInversionMatrix(ue,Qe.canonical),xs=[];v.terrainRenderModeElevated()&&be&&xs.push("PITCH_WITH_MAP_TERRAIN"),Bn&&xs.push("PROJECTION_GLOBE_VIEW"),ar&&xs.push("PROJECTED_POS_ON_VIEWPORT");const ho=qe&&0!==g.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1);let dc;dc=qe?at.iconsInText?Dl(Xe.kind,Lt,Te,be,v,Ki,Fr,Xn,dn,yn,Qe,Fi,Re,Li,er,at.getProjection()):Ip(Xe.kind,Lt,Te,be,v,Ki,Fr,Xn,S,dn,!0,Qe,Fi,Re,Li,er,at.getProjection()):Uo(Xe.kind,Lt,Te,be,v,Ki,Fr,Xn,S,dn,Qe,Fi,Re,Li,er,at.getProjection());const iu={program:v.useProgram(Dp(qe,S,at),et,xs),buffers:Ot,uniformValues:dc,atlasTexture:Yn,atlasTextureIcon:xi,atlasInterpolation:gn,atlasInterpolationIcon:Yt,isSDF:qe,hasHalo:ho,tile:St,labelPlaneMatrixInv:Ys};if(ve&&at.canOverlap){De=!0;const Wr=Ot.segments.get();for(const Ks of Wr)nt.push({segments:new _.SegmentVector([Ks]),sortKey:Ks.sortKey,state:iu})}else nt.push({segments:Ot.segments,sortKey:0,state:iu})}De&&nt.sort((Qe,St)=>Qe.sortKey-St.sortKey);for(const Qe of nt){const St=Qe.state;if(v.terrain&&v.terrain.setupElevationDraw(St.tile,St.program,{useDepthForOcclusion:!Ze,labelPlaneMatrixInv:St.labelPlaneMatrixInv}),de.activeTexture.set(ge.TEXTURE0),St.atlasTexture.bind(St.atlasInterpolation,ge.CLAMP_TO_EDGE),St.atlasTextureIcon&&(de.activeTexture.set(ge.TEXTURE1),St.atlasTextureIcon&&St.atlasTextureIcon.bind(St.atlasInterpolationIcon,ge.CLAMP_TO_EDGE)),St.isSDF){const at=St.uniformValues;St.hasHalo&&(at.u_is_halo=1,Ap(St.buffers,Qe.segments,g,v,St.program,Fe,ee,oe,at)),at.u_is_halo=0}Ap(St.buffers,Qe.segments,g,v,St.program,Fe,ee,oe,St.uniformValues)}}function Ap(v,c,g,C,S,D,L,B,G){const J=C.context,ee=[v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer,v.globeExtVertexBuffer];S.draw(J,J.gl.TRIANGLES,D,L,B,_.CullFaceMode.disabled,G,g.id,v.layoutVertexBuffer,v.indexBuffer,c,g.paint,C.transform.zoom,v.programConfigurations.get(g.id),ee)}function mf(v,c,g,C,S,D,L){const B=v.context.gl,G=g.paint.get("fill-pattern"),J=G&&G.constantOr(1);let ee,oe,de,ge,ue;L?(oe=J&&!g.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ee=B.LINES):(oe=J?"fillPattern":"fill",ee=B.TRIANGLES);for(const ye of C){const be=c.getTile(ye);if(J&&!be.patternsLoaded())continue;const ce=be.getBucket(g);if(!ce)continue;v.prepareDrawTile();const Te=ce.programConfigurations.get(g.id),ve=v.useProgram(oe,Te);J&&(v.context.activeTexture.set(B.TEXTURE0),be.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),Te.updatePaintBuffers());const De=G.constantOr(null);if(De&&be.imageAtlas){const Re=be.imageAtlas.patternPositions[De.toString()];Re&&Te.setConstantPatternPositions(Re)}const Fe=v.translatePosMatrix(ye.projMatrix,be,g.paint.get("fill-translate"),g.paint.get("fill-translate-anchor"));if(L){ge=ce.indexBuffer2,ue=ce.segments2;const Re=v.terrain&&v.terrain.renderingToTexture?v.terrain.drapeBufferSize:[B.drawingBufferWidth,B.drawingBufferHeight];de="fillOutlinePattern"===oe&&J?ch(Fe,v,be,Re):Ep(Fe,Re)}else ge=ce.indexBuffer,ue=ce.segments,de=J?ku(Fe,v,be):lh(Fe);v.prepareDrawProgram(v.context,ve,ye.toUnwrapped()),ve.draw(v.context,ee,S,v.stencilModeForClipping(ye),D,_.CullFaceMode.disabled,de,g.id,ce.layoutVertexBuffer,ge,ue,g.paint,v.transform.zoom,Te)}}function Pp(v,c,g,C,S,D,L){const B=v.context,G=B.gl,J=v.transform,ee=g.paint.get("fill-extrusion-pattern"),oe=ee.constantOr(1),de=g.paint.get("fill-extrusion-opacity"),ge=[g.paint.get("fill-extrusion-ambient-occlusion-intensity"),g.paint.get("fill-extrusion-ambient-occlusion-radius")],ue=g.layout.get("fill-extrusion-edge-radius"),ye="globe"===J.projection.name?_.fillExtrusionHeightLift():0,be="globe"===J.projection.name,ce=be?_.globeToMercatorTransition(J.zoom):0,Te=[_.mercatorXfromLng(J.center.lng),_.mercatorYfromLat(J.center.lat)],ve=[];be&&ve.push("PROJECTION_GLOBE_VIEW"),ge[0]>0&&ve.push("FAUX_AO");for(const De of C){const Fe=c.getTile(De),Re=Fe.getBucket(g);if(!Re||Re.projection.name!==J.projection.name)continue;const Ue=Re.programConfigurations.get(g.id),Ze=v.useProgram(oe?"fillExtrusionPattern":"fillExtrusion",Ue,ve);if(v.terrain){const Ot=v.terrain;if(v.style.terrainSetForDrapingOnly())Ot.setupElevationDraw(Fe,Ze,{useMeterToDem:!0});else{if(!Re.enableTerrain)continue;if(Ot.setupElevationDraw(Fe,Ze,{useMeterToDem:!0}),Hm(B,c,De,Re,g,Ot),!Re.centroidVertexBuffer){const et=Ze.attributes.a_centroid_pos;void 0!==et&&G.vertexAttrib2f(et,0,0)}}}oe&&(v.context.activeTexture.set(G.TEXTURE0),Fe.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),Ue.updatePaintBuffers());const nt=ee.constantOr(null);if(nt&&Fe.imageAtlas){const Ot=Fe.imageAtlas.patternPositions[nt.toString()];Ot&&Ue.setConstantPatternPositions(Ot)}const ot=v.translatePosMatrix(De.projMatrix,Fe,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),Ut=J.projection.createInversionMatrix(J,De.canonical),Qe=g.paint.get("fill-extrusion-vertical-gradient"),St=oe?Cd(ot,v,Qe,de,ge,ue,De,Fe,ye,ce,Te,Ut):ah(ot,v,Qe,de,ge,ue,De,ye,ce,Te,Ut);v.prepareDrawProgram(B,Ze,De.toUnwrapped());const at=[];v.terrain&&at.push(Re.centroidVertexBuffer),be&&at.push(Re.layoutVertexExtBuffer),Ze.draw(B,B.gl.TRIANGLES,S,D,L,_.CullFaceMode.backCCW,St,g.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,g.paint,v.transform.zoom,Ue,at)}}function Hm(v,c,g,C,S,D){const L=[ce=>{let Te=ce.canonical.x-1,ve=ce.wrap;return Te<0&&(Te=(1<<ce.canonical.z)-1,ve--),new _.OverscaledTileID(ce.overscaledZ,ve,ce.canonical.z,Te,ce.canonical.y)},ce=>{let Te=ce.canonical.x+1,ve=ce.wrap;return Te===1<<ce.canonical.z&&(Te=0,ve++),new _.OverscaledTileID(ce.overscaledZ,ve,ce.canonical.z,Te,ce.canonical.y)},ce=>new _.OverscaledTileID(ce.overscaledZ,ce.wrap,ce.canonical.z,ce.canonical.x,(0===ce.canonical.y?1<<ce.canonical.z:ce.canonical.y)-1),ce=>new _.OverscaledTileID(ce.overscaledZ,ce.wrap,ce.canonical.z,ce.canonical.x,ce.canonical.y===(1<<ce.canonical.z)-1?0:ce.canonical.y+1)],B=ce=>{const Te=c.getSource().minzoom,ve=Fe=>{const Re=c.getTileByID(Fe);if(Re&&Re.hasData())return Re.getBucket(S)},De=[0,-1,1];for(const Fe of De){if(ce.overscaledZ+Fe<Te)continue;const Re=ve(ce.calculateScaledKey(ce.overscaledZ+Fe));if(Re)return Re}},G=[0,0,0],J=(ce,Te)=>(G[0]=Math.min(ce.min.y,Te.min.y),G[1]=Math.max(ce.max.y,Te.max.y),G[2]=_.EXTENT-Te.min.x>ce.max.x?Te.min.x-_.EXTENT:ce.max.x,G),ee=(ce,Te)=>(G[0]=Math.min(ce.min.x,Te.min.x),G[1]=Math.max(ce.max.x,Te.max.x),G[2]=_.EXTENT-Te.min.y>ce.max.y?Te.min.y-_.EXTENT:ce.max.y,G),oe=[(ce,Te)=>J(ce,Te),(ce,Te)=>J(Te,ce),(ce,Te)=>ee(ce,Te),(ce,Te)=>ee(Te,ce)],de=new _.pointGeometry(0,0);let ge,ue,ye;const be=(ce,Te,ve,De,Fe)=>{const Re=[[De?ve:ce,De?ce:ve,0],[De?ve:Te,De?Te:ve,0]],Ue=Fe<0?_.EXTENT+Fe:Fe,Ze=[De?Ue:(ce+Te)/2,De?(ce+Te)/2:Ue,0];return 0===ve&&Fe<0||0!==ve&&Fe>0?D.getForTilePoints(ye,[Ze],!0,ue):Re.push(Ze),D.getForTilePoints(g,Re,!0,ge),Math.max(Re[0][2],Re[1][2],Ze[2])/D.exaggeration()};for(let ce=0;ce<4;ce++){const Te=(ce<2?1:5)-ce,ve=C.borders[ce];if(0===ve.length)continue;const De=ye=L[ce](g),Fe=B(De);if(!(Fe&&Fe instanceof _.FillExtrusionBucket&&Fe.enableTerrain)||C.borderDoneWithNeighborZ[ce]===Fe.canonical.z&&Fe.borderDoneWithNeighborZ[Te]===C.canonical.z||(ue=D.findDEMTileFor(De),!ue||!ue.dem))continue;if(!ge){const nt=D.findDEMTileFor(g);if(!nt||!nt.dem)return;ge=nt}const Re=Fe.borders[Te];let Ue=0;const Ze=Fe.borderDoneWithNeighborZ[Te]!==C.canonical.z;if(C.canonical.z===Fe.canonical.z){for(let nt=0;nt<ve.length;nt++){const ot=C.featuresOnBorder[ve[nt]],Ut=ot.borders[ce];let Qe;for(;Ue<Re.length&&(Qe=Fe.featuresOnBorder[Re[Ue]],!(Qe.borders[Te][1]>Ut[0]+3));)Ze&&Fe.encodeCentroid(void 0,Qe,!1),Ue++;if(Qe&&Ue<Re.length){const St=Ue;let at=0;for(;!(Qe.borders[Te][0]>Ut[1]-3)&&(at++,++Ue!==Re.length);)Qe=Fe.featuresOnBorder[Re[Ue]];if(Qe=Fe.featuresOnBorder[Re[St]],ot.intersectsCount()>1||Qe.intersectsCount()>1||1!==at){1!==at&&(Ue=St),C.encodeCentroid(void 0,ot,!1),Ze&&Fe.encodeCentroid(void 0,Qe,!1);continue}const Ot=oe[ce](ot,Qe),et=ce%2?_.EXTENT-1:0;de.x=be(Ot[0],Math.min(_.EXTENT-1,Ot[1]),et,ce<2,Ot[2]),de.y=0,C.encodeCentroid(de,ot,!1),Ze&&Fe.encodeCentroid(de,Qe,!1)}else C.encodeCentroid(void 0,ot,!1)}C.borderDoneWithNeighborZ[ce]=Fe.canonical.z,C.needsCentroidUpdate=!0,Ze&&(Fe.borderDoneWithNeighborZ[Te]=C.canonical.z,Fe.needsCentroidUpdate=!0)}else{for(const nt of ve)C.encodeCentroid(void 0,C.featuresOnBorder[nt],!1);if(Ze){for(const nt of Re)Fe.encodeCentroid(void 0,Fe.featuresOnBorder[nt],!1);Fe.borderDoneWithNeighborZ[Te]=C.canonical.z,Fe.needsCentroidUpdate=!0}C.borderDoneWithNeighborZ[ce]=Fe.canonical.z,C.needsCentroidUpdate=!0}}(C.needsCentroidUpdate||!C.centroidVertexBuffer&&0!==C.centroidVertexArray.length)&&C.uploadCentroid(v)}const gf=new _.Color(1,0,0,1),_f=new _.Color(0,1,0,1),yf=new _.Color(0,0,1,1),I_=new _.Color(1,0,1,1),qm=new _.Color(0,1,1,1);function bs(v,c,g){const C=v.context,S=v.transform,D=C.gl,L="globe"===S.projection.name,B=L?["PROJECTION_GLOBE_VIEW"]:null;let G=g.projMatrix;if(L&&_.globeToMercatorTransition(S.zoom)>0){const ot=_.transitionTileAABBinECEF(g.canonical,S),Ut=_.globeDenormalizeECEF(ot);G=_.multiply(new Float32Array(16),S.globeMatrix,Ut),_.multiply(G,S.projMatrix,G)}const J=v.useProgram("debug",null,B),ee=c.getTileByID(g.key);v.terrain&&v.terrain.setupElevationDraw(ee,J);const oe=_.DepthMode.disabled,de=_.StencilMode.disabled,ge=v.colorModeForRenderPass();C.activeTexture.set(D.TEXTURE0),v.emptyTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),L?ee._makeGlobeTileDebugBuffers(v.context,S):ee._makeDebugTileBoundsBuffers(v.context,S.projection);const ye=ee._tileDebugBuffer||v.debugBuffer,be=ee._tileDebugIndexBuffer||v.debugIndexBuffer,ce=ee._tileDebugSegments||v.debugSegments;J.draw(C,D.LINE_STRIP,oe,de,ge,_.CullFaceMode.disabled,Ed(G,_.Color.red),"$debug",ye,be,ce,null,null,null,[ee._globeTileDebugBorderBuffer]);const Te=ee.latestRawTileData,ve=Math.floor((Te&&Te.byteLength||0)/1024),De=c.getTile(g).tileSize,Fe=512/Math.min(De,512)*(g.overscaledZ/S.zoom)*.5;let Re=g.canonical.toString();g.overscaledZ!==g.canonical.z&&(Re+=` => ${g.overscaledZ}`),Re+=` ${ve}kb`,function(ot,Ut){ot.initDebugOverlayCanvas();const Qe=ot.debugOverlayCanvas,St=ot.context.gl,at=ot.debugOverlayCanvas.getContext("2d");at.clearRect(0,0,Qe.width,Qe.height),at.shadowColor="white",at.shadowBlur=2,at.lineWidth=1.5,at.strokeStyle="white",at.textBaseline="top",at.font="bold 36px Open Sans, sans-serif",at.fillText(Ut,5,5),at.strokeText(Ut,5,5),ot.debugOverlayTexture.update(Qe),ot.debugOverlayTexture.bind(St.LINEAR,St.CLAMP_TO_EDGE)}(v,Re);const Ue=ee._tileDebugTextBuffer||v.debugBuffer,Ze=ee._tileDebugTextIndexBuffer||v.quadTriangleIndexBuffer,nt=ee._tileDebugTextSegments||v.debugSegments;J.draw(C,D.TRIANGLES,oe,de,_.ColorMode.alphaBlended,_.CullFaceMode.disabled,Ed(G,_.Color.transparent,Fe),"$debug",Ue,Ze,nt,null,null,null,[ee._globeTileDebugTextBuffer])}function Os(v,c,g,C){Wc(v,0,c+g/2,v.transform.width,g,C)}function pr(v,c,g,C){Wc(v,c-g/2,0,g,v.transform.height,C)}function Wc(v,c,g,C,S,D){const L=v.context,B=L.gl;B.enable(B.SCISSOR_TEST),B.scissor(c*_.exported.devicePixelRatio,g*_.exported.devicePixelRatio,C*_.exported.devicePixelRatio,S*_.exported.devicePixelRatio),L.clear({color:D}),B.disable(B.SCISSOR_TEST)}const Td=_.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Lu}=Td;function lc(v,c,g,C){v.emplaceBack(c,g,C)}class Op{constructor(c){this.vertexArray=new _.StructArrayLayout3f12,this.indices=new _.StructArrayLayout3ui6,lc(this.vertexArray,-1,-1,1),lc(this.vertexArray,1,-1,1),lc(this.vertexArray,-1,1,1),lc(this.vertexArray,1,1,1),lc(this.vertexArray,-1,-1,-1),lc(this.vertexArray,1,-1,-1),lc(this.vertexArray,-1,1,-1),lc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=c.createVertexBuffer(this.vertexArray,Lu),this.indexBuffer=c.createIndexBuffer(this.indices),this.segment=_.SegmentVector.simpleSegment(0,0,36,12)}}function qi(v,c,g,C,S,D){const L=v.gl,B=c.paint.get("sky-atmosphere-color"),G=c.paint.get("sky-atmosphere-halo-color"),J=c.paint.get("sky-atmosphere-sun-intensity"),ee={u_matrix_3f:_.fromMat4(_.create$1(),C),u_sun_direction:S,u_sun_intensity:J,u_color_tint_r:[(ue=B).r,ue.g,ue.b,ue.a],u_color_tint_m:[(ye=G).r,ye.g,ye.b,ye.a],u_luminance:5e-5};var ue,ye;L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_CUBE_MAP_POSITIVE_X+D,c.skyboxTexture,0),g.draw(v,L.TRIANGLES,_.DepthMode.disabled,_.StencilMode.disabled,_.ColorMode.unblended,_.CullFaceMode.frontCW,ee,"skyboxCapture",c.skyboxGeometry.vertexBuffer,c.skyboxGeometry.indexBuffer,c.skyboxGeometry.segment)}const Nu=_.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Id{constructor(c){const g=new _.StructArrayLayout5f20;g.emplaceBack(-1,1,1,0,0),g.emplaceBack(1,1,1,1,0),g.emplaceBack(1,-1,1,1,1),g.emplaceBack(-1,-1,1,0,1);const C=new _.StructArrayLayout3ui6;C.emplaceBack(0,1,2),C.emplaceBack(2,3,0),this.vertexBuffer=c.createVertexBuffer(g,Nu.members),this.indexBuffer=c.createIndexBuffer(C),this.segments=_.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const cc={symbol:function(v,c,g,C,S){if("translucent"!==v.renderPass)return;const D=_.StencilMode.disabled,L=v.colorModeForRenderPass();g.layout.get("text-variable-anchor")&&function(B,G,J,ee,oe,de,ge){const ue=G.transform,ye="map"===oe,be="map"===de;for(const ce of B){const Te=ee.getTile(ce),ve=Te.getBucket(J);if(!ve||!ve.text||!ve.text.segments.get().length)continue;const De=_.evaluateSizeForZoom(ve.textSizeData,ue.zoom),Fe=bo(ce,ve.getProjection(),ue),Re=ue.calculatePixelsToTileUnitsMatrix(Te),Ue=As(Fe,Te.tileID.canonical,be,ye,ue,ve.getProjection(),Re),Ze="none"!==J.layout.get("icon-text-fit")&&ve.hasIconData();if(De){const nt=Math.pow(2,ue.zoom-Te.tileID.overscaledZ);Fu(ve,ye,be,ge,_.symbolSize,ue,Ue,ce,nt,De,Ze)}}}(C,v,g,c,g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),S),0!==g.paint.get("icon-opacity").constantOr(1)&&Gm(v,c,g,C,!1,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),g.layout.get("icon-rotation-alignment"),g.layout.get("icon-pitch-alignment"),g.layout.get("icon-keep-upright"),D,L),0!==g.paint.get("text-opacity").constantOr(1)&&Gm(v,c,g,C,!0,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),g.layout.get("text-keep-upright"),D,L),c.map.showCollisionBoxes&&(Mp(v,c,g,C,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),!0),Mp(v,c,g,C,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),!1))},circle:function(v,c,g,C){if("translucent"!==v.renderPass)return;const S=g.paint.get("circle-opacity"),D=g.paint.get("circle-stroke-width"),L=g.paint.get("circle-stroke-opacity"),B=void 0!==g.layout.get("circle-sort-key").constantOr(1);if(0===S.constantOr(1)&&(0===D.constantOr(1)||0===L.constantOr(1)))return;const G=v.context,J=G.gl,ee=v.transform,oe=v.depthModeForSublayer(0,_.DepthMode.ReadOnly),de=_.StencilMode.disabled,ge=v.colorModeForRenderPass(),ue="globe"===ee.projection.name,ye=[_.mercatorXfromLng(ee.center.lng),_.mercatorYfromLat(ee.center.lat)],be=[];for(let Te=0;Te<C.length;Te++){const ve=C[Te],De=c.getTile(ve),Fe=De.getBucket(g);if(!Fe||Fe.projection.name!==ee.projection.name)continue;const Re=Fe.programConfigurations.get(g.id),Ue=$i(g);ue&&Ue.push("PROJECTION_GLOBE_VIEW");const Ze=v.useProgram("circle",Re,Ue),nt=Fe.layoutVertexBuffer,ot=Fe.globeExtVertexBuffer,Ut=Fe.indexBuffer,Qe=ee.projection.createInversionMatrix(ee,ve.canonical),St={programConfiguration:Re,program:Ze,layoutVertexBuffer:nt,globeExtVertexBuffer:ot,indexBuffer:Ut,uniformValues:qt(v,ve,De,Qe,ye,g),tile:De};if(B){const at=Fe.segments.get();for(const Ot of at)be.push({segments:new _.SegmentVector([Ot]),sortKey:Ot.sortKey,state:St})}else be.push({segments:Fe.segments,sortKey:0,state:St})}B&&be.sort((Te,ve)=>Te.sortKey-ve.sortKey);const ce={useDepthForOcclusion:!ue};for(const Te of be){const{programConfiguration:ve,program:De,layoutVertexBuffer:Fe,globeExtVertexBuffer:Re,indexBuffer:Ue,uniformValues:Ze,tile:nt}=Te.state,ot=Te.segments;v.terrain&&v.terrain.setupElevationDraw(nt,De,ce),v.prepareDrawProgram(G,De,nt.tileID.toUnwrapped()),De.draw(G,J.TRIANGLES,oe,de,ge,_.CullFaceMode.disabled,Ze,g.id,Fe,Ue,ot,g.paint,ee.zoom,ve,[Re])}},heatmap:function(v,c,g,C){if(0!==g.paint.get("heatmap-opacity"))if("offscreen"===v.renderPass){const S=v.context,D=S.gl,L=_.StencilMode.disabled,B=new _.ColorMode([D.ONE,D.ONE],_.Color.transparent,[!0,!0,!0,!0]);(function(ge,ue,ye,be){const ce=ge.gl,Te=ue.width*be,ve=ue.height*be;ge.activeTexture.set(ce.TEXTURE1),ge.viewport.set([0,0,Te,ve]);let De=ye.heatmapFbo;if(!De||De&&(De.width!==Te||De.height!==ve)){De&&De.destroy();const Fe=ce.createTexture();ce.bindTexture(ce.TEXTURE_2D,Fe),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_WRAP_S,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_WRAP_T,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_MIN_FILTER,ce.LINEAR),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_MAG_FILTER,ce.LINEAR),De=ye.heatmapFbo=ge.createFramebuffer(Te,ve,!1),function(Re,Ue,Ze,nt,ot,Ut){const Qe=Re.gl;Qe.texImage2D(Qe.TEXTURE_2D,0,Re.isWebGL2&&Re.extRenderToTextureHalfFloat?Qe.RGBA16F:Qe.RGBA,ot,Ut,0,Qe.RGBA,Re.extRenderToTextureHalfFloat?Re.isWebGL2?Qe.HALF_FLOAT:Re.extTextureHalfFloat.HALF_FLOAT_OES:Qe.UNSIGNED_BYTE,null),nt.colorAttachment.set(Ze)}(ge,0,Fe,De,Te,ve)}else ce.bindTexture(ce.TEXTURE_2D,De.colorAttachment.get()),ge.bindFramebuffer.set(De.framebuffer)})(S,v,g,"globe"===v.transform.projection.name?.5:.25),S.clear({color:_.Color.transparent});const G=v.transform,J="globe"===G.projection.name,ee=J?["PROJECTION_GLOBE_VIEW"]:null,oe=J?_.CullFaceMode.frontCCW:_.CullFaceMode.disabled,de=[_.mercatorXfromLng(G.center.lng),_.mercatorYfromLat(G.center.lat)];for(let ge=0;ge<C.length;ge++){const ue=C[ge];if(c.hasRenderableParent(ue))continue;const ye=c.getTile(ue),be=ye.getBucket(g);if(!be||be.projection.name!==G.projection.name)continue;const ce=be.programConfigurations.get(g.id),Te=v.useProgram("heatmap",ce,ee),{zoom:ve}=v.transform;v.terrain&&v.terrain.setupElevationDraw(ye,Te),v.prepareDrawProgram(S,Te,ue.toUnwrapped());const De=G.projection.createInversionMatrix(G,ue.canonical);Te.draw(S,D.TRIANGLES,_.DepthMode.disabled,L,B,oe,Xa(v,ue,ye,De,de,ve,g.paint.get("heatmap-intensity")),g.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,g.paint,v.transform.zoom,ce,J?[be.globeExtVertexBuffer]:null)}S.viewport.set([0,0,v.width,v.height])}else"translucent"===v.renderPass&&(v.context.setColorMode(v.colorModeForRenderPass()),function(S,D){const L=S.context,B=L.gl,G=D.heatmapFbo;if(!G)return;L.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,G.colorAttachment.get()),L.activeTexture.set(B.TEXTURE1);let J=D.colorRampTexture;J||(J=D.colorRampTexture=new _.Texture(L,D.colorRamp,B.RGBA)),J.bind(B.LINEAR,B.CLAMP_TO_EDGE),S.useProgram("heatmapTexture").draw(L,B.TRIANGLES,_.DepthMode.disabled,_.StencilMode.disabled,S.colorModeForRenderPass(),_.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:D.paint.get("heatmap-opacity")},D.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,D.paint,S.transform.zoom)}(v,g))},line:function(v,c,g,C){if("translucent"!==v.renderPass)return;const S=g.paint.get("line-opacity"),D=g.paint.get("line-width");if(0===S.constantOr(1)||0===D.constantOr(1))return;const L=v.depthModeForSublayer(0,_.DepthMode.ReadOnly),B=v.colorModeForRenderPass(),G=v.terrain&&v.terrain.renderingToTexture?1:_.exported.devicePixelRatio,J=g.paint.get("line-dasharray"),ee=J.constantOr(1),oe=g.layout.get("line-cap"),de=g.paint.get("line-pattern"),ge=de.constantOr(1),ue=g.paint.get("line-gradient"),ye=ge?"linePattern":"line",be=v.context,ce=be.gl,Te=(De=>{const Fe=[];qc(De)&&Fe.push("RENDER_LINE_DASH"),De.paint.get("line-gradient")&&Fe.push("RENDER_LINE_GRADIENT");const Re=De.paint.get("line-trim-offset");0===Re[0]&&0===Re[1]||Fe.push("RENDER_LINE_TRIM_OFFSET");const Ue=De.paint.get("line-pattern").constantOr(1),Ze=1!==De.paint.get("line-opacity").constantOr(1);return!Ue&&Ze&&Fe.push("RENDER_LINE_ALPHA_DISCARD"),Fe})(g);let ve=Te.includes("RENDER_LINE_ALPHA_DISCARD");v.terrain&&v.terrain.clipOrMaskOverlapStencilType()&&(ve=!1);for(const De of C){const Fe=c.getTile(De);if(ge&&!Fe.patternsLoaded())continue;const Re=Fe.getBucket(g);if(!Re)continue;v.prepareDrawTile();const Ue=Re.programConfigurations.get(g.id),Ze=v.useProgram(ye,Ue,Te),nt=de.constantOr(null);if(nt&&Fe.imageAtlas){const qe=Fe.imageAtlas.patternPositions[nt.toString()];qe&&Ue.setConstantPatternPositions(qe)}const ot=J.constantOr(null),Ut=oe.constantOr(null);if(!ge&&ot&&Ut&&Fe.lineAtlas){const qe=Fe.lineAtlas.getDash(ot,Ut);qe&&Ue.setConstantPatternPositions(qe)}let[Qe,St]=g.paint.get("line-trim-offset");("round"===Ut||"square"===Ut)&&Qe!==St&&(0===Qe&&(Qe-=1),1===St&&(St+=1));const at=v.terrain?De.projMatrix:null,Ot=ge?Qa(v,Fe,g,at,G):Ml(v,Fe,g,at,Re.lineClipsArray.length,G,[Qe,St]);if(ue){const qe=Re.gradients[g.id];let Xe=qe.texture;if(g.gradientVersion!==qe.version){let Mt=256;if(g.stepInterpolant){const Lt=c.getSource().maxzoom,dn=De.canonical.z===Lt?Math.ceil(1<<v.transform.maxZoom-De.canonical.z):1;Mt=_.clamp(_.nextPowerOfTwo(Re.maxLineLength/_.EXTENT*1024*dn),256,be.maxTextureSize)}qe.gradient=_.renderColorRamp({expression:g.gradientExpression(),evaluationKey:"lineProgress",resolution:Mt,image:qe.gradient||void 0,clips:Re.lineClipsArray}),qe.texture?qe.texture.update(qe.gradient):qe.texture=new _.Texture(be,qe.gradient,ce.RGBA),qe.version=g.gradientVersion,Xe=qe.texture}be.activeTexture.set(ce.TEXTURE1),Xe.bind(g.stepInterpolant?ce.NEAREST:ce.LINEAR,ce.CLAMP_TO_EDGE)}ee&&(be.activeTexture.set(ce.TEXTURE0),Fe.lineAtlasTexture.bind(ce.LINEAR,ce.REPEAT),Ue.updatePaintBuffers()),ge&&(be.activeTexture.set(ce.TEXTURE0),Fe.imageAtlasTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),Ue.updatePaintBuffers()),v.prepareDrawProgram(be,Ze,De.toUnwrapped());const et=qe=>{Ze.draw(be,ce.TRIANGLES,L,qe,B,_.CullFaceMode.disabled,Ot,g.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,g.paint,v.transform.zoom,Ue,[Re.layoutVertexBuffer2])};if(ve){const qe=v.stencilModeForClipping(De).ref;0===qe&&v.terrain&&be.clear({stencil:0});const Xe={func:ce.EQUAL,mask:255};Ot.u_alpha_discard_threshold=.8,et(new _.StencilMode(Xe,qe,255,ce.KEEP,ce.KEEP,ce.INVERT)),Ot.u_alpha_discard_threshold=0,et(new _.StencilMode(Xe,qe,255,ce.KEEP,ce.KEEP,ce.KEEP))}else et(v.stencilModeForClipping(De))}ve&&(v.resetStencilClippingMasks(),v.terrain&&be.clear({stencil:0}))},fill:function(v,c,g,C){const S=g.paint.get("fill-color"),D=g.paint.get("fill-opacity");if(0===D.constantOr(1))return;const L=v.colorModeForRenderPass(),B=g.paint.get("fill-pattern"),G=v.opaquePassEnabledForLayer()&&!B.constantOr(1)&&1===S.constantOr(_.Color.transparent).a&&1===D.constantOr(0)?"opaque":"translucent";if(v.renderPass===G){const J=v.depthModeForSublayer(1,"opaque"===v.renderPass?_.DepthMode.ReadWrite:_.DepthMode.ReadOnly);mf(v,c,g,C,J,L,!1)}if("translucent"===v.renderPass&&g.paint.get("fill-antialias")){const J=v.depthModeForSublayer(g.getPaintProperty("fill-outline-color")?2:0,_.DepthMode.ReadOnly);mf(v,c,g,C,J,L,!0)}},"fill-extrusion":function(v,c,g,C){const S=g.paint.get("fill-extrusion-opacity");if(0!==S&&"translucent"===v.renderPass){const D=new _.DepthMode(v.context.gl.LEQUAL,_.DepthMode.ReadWrite,v.depthRangeFor3D);if(1!==S||g.paint.get("fill-extrusion-pattern").constantOr(1))Pp(v,c,g,C,D,_.StencilMode.disabled,_.ColorMode.disabled),Pp(v,c,g,C,D,v.stencilModeFor3D(),v.colorModeForRenderPass()),v.resetStencilClippingMasks();else{const L=v.colorModeForRenderPass();Pp(v,c,g,C,D,_.StencilMode.disabled,L)}}},hillshade:function(v,c,g,C){if("offscreen"!==v.renderPass&&"translucent"!==v.renderPass)return;const S=v.context,D=v.depthModeForSublayer(0,_.DepthMode.ReadOnly),L=v.colorModeForRenderPass(),B=v.terrain&&v.terrain.renderingToTexture,[G,J]="translucent"!==v.renderPass||B?[{},C]:v.stencilConfigForOverlap(C);for(const ee of J){const oe=c.getTile(ee);if(oe.needsHillshadePrepare&&"offscreen"===v.renderPass)Au(v,oe,g,D,_.StencilMode.disabled,L);else if("translucent"===v.renderPass){const de=B&&v.terrain?v.terrain.stencilModeForRTTOverlap(ee):G[ee.overscaledZ];Vc(v,ee,oe,g,D,de,L)}}S.viewport.set([0,0,v.width,v.height]),v.resetStencilClippingMasks()},raster:function(v,c,g,C,S,D){if("translucent"!==v.renderPass||0===g.paint.get("raster-opacity")||!C.length)return;const L=v.context,B=L.gl,G=c.getSource(),J=v.useProgram("raster"),ee=v.colorModeForRenderPass(),oe=v.terrain&&v.terrain.renderingToTexture,[de,ge]=G instanceof fe||oe?[{},C]:v.stencilConfigForOverlap(C),ue=ge[ge.length-1].overscaledZ,ye=!v.options.moving;for(const be of ge){const ce=oe?_.DepthMode.disabled:v.depthModeForSublayer(be.overscaledZ-ue,1===g.paint.get("raster-opacity")?_.DepthMode.ReadWrite:_.DepthMode.ReadOnly,B.LESS),Te=be.toUnwrapped(),ve=c.getTile(be);if(oe&&(!ve||!ve.hasData()))continue;const De=oe?be.projMatrix:v.transform.calculateProjMatrix(Te,ye),Fe=v.terrain&&oe?v.terrain.stencilModeForRTTOverlap(be):de[be.overscaledZ],Re=D?0:g.paint.get("raster-fade-duration");ve.registerFadeDuration(Re);const Ue=c.findLoadedParent(be,0),Ze=$c(ve,Ue,c,v.transform,Re);let nt,ot;v.terrain&&v.terrain.prepareDrawTile();const Ut="nearest"===g.paint.get("raster-resampling")?B.NEAREST:B.LINEAR;L.activeTexture.set(B.TEXTURE0),ve.texture.bind(Ut,B.CLAMP_TO_EDGE),L.activeTexture.set(B.TEXTURE1),Ue?(Ue.texture.bind(Ut,B.CLAMP_TO_EDGE),nt=Math.pow(2,Ue.tileID.overscaledZ-ve.tileID.overscaledZ),ot=[ve.tileID.canonical.x*nt%1,ve.tileID.canonical.y*nt%1]):ve.texture.bind(Ut,B.CLAMP_TO_EDGE);const Qe=T_(De,ot||[0,0],nt||1,Ze,g,G instanceof fe?G.perspectiveTransform:[0,0]);if(v.prepareDrawProgram(L,J,Te),G instanceof fe)G.boundsBuffer&&G.boundsSegments&&J.draw(L,B.TRIANGLES,ce,_.StencilMode.disabled,ee,_.CullFaceMode.disabled,Qe,g.id,G.boundsBuffer,v.quadTriangleIndexBuffer,G.boundsSegments);else{const{tileBoundsBuffer:St,tileBoundsIndexBuffer:at,tileBoundsSegments:Ot}=v.getTileBoundsBuffers(ve);J.draw(L,B.TRIANGLES,ce,Fe,ee,_.CullFaceMode.disabled,Qe,g.id,St,at,Ot)}}v.resetStencilClippingMasks()},background:function(v,c,g,C){const S=g.paint.get("background-color"),D=g.paint.get("background-opacity");if(0===D)return;const L=v.context,B=L.gl,G=v.transform,J=G.tileSize,ee=g.paint.get("background-pattern");if(v.isPatternMissing(ee))return;const oe=!ee&&1===S.a&&1===D&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==oe)return;const de=_.StencilMode.disabled,ge=v.depthModeForSublayer(0,"opaque"===oe?_.DepthMode.ReadWrite:_.DepthMode.ReadOnly),ue=v.colorModeForRenderPass(),ye=v.useProgram(ee?"backgroundPattern":"background");let be,ce=C;ce||(be=v.getBackgroundTiles(),ce=Object.values(be).map(Te=>Te.tileID)),ee&&(L.activeTexture.set(B.TEXTURE0),v.imageManager.bind(v.context));for(const Te of ce){const ve=Te.toUnwrapped(),De=C?Te.projMatrix:v.transform.calculateProjMatrix(ve);v.prepareDrawTile();const Fe=c?c.getTile(Te):be?be[Te.key]:new _.Tile(Te,J,G.zoom,v),Re=ee?dh(De,D,v,ee,{tileID:Te,tileSize:J}):Ja(De,D,S);v.prepareDrawProgram(L,ye,ve);const{tileBoundsBuffer:Ue,tileBoundsIndexBuffer:Ze,tileBoundsSegments:nt}=v.getTileBoundsBuffers(Fe);ye.draw(L,B.TRIANGLES,ge,de,ue,_.CullFaceMode.disabled,Re,g.id,Ue,Ze,nt)}},sky:function(v,c,g){const C=v.transform,S="mercator"===C.projection.name||"globe"===C.projection.name?1:_.smoothstep(7,8,C.zoom),D=g.paint.get("sky-opacity")*S;if(0===D)return;const L=v.context,B=g.paint.get("sky-type"),G=new _.DepthMode(L.gl.LEQUAL,_.DepthMode.ReadOnly,[0,1]),J=v.frameCounter/1e3%1;"atmosphere"===B?"offscreen"===v.renderPass?g.needsSkyboxCapture(v)&&(function(ee,oe,de,ge){const ue=ee.context,ye=ue.gl;let be=oe.skyboxFbo;if(!be){be=oe.skyboxFbo=ue.createFramebuffer(32,32,!1),oe.skyboxGeometry=new Op(ue),oe.skyboxTexture=ue.gl.createTexture(),ye.bindTexture(ye.TEXTURE_CUBE_MAP,oe.skyboxTexture),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_WRAP_S,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_WRAP_T,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_MIN_FILTER,ye.LINEAR),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_MAG_FILTER,ye.LINEAR);for(let De=0;De<6;++De)ye.texImage2D(ye.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,ye.RGBA,32,32,0,ye.RGBA,ye.UNSIGNED_BYTE,null)}ue.bindFramebuffer.set(be.framebuffer),ue.viewport.set([0,0,32,32]);const ce=oe.getCenter(ee,!0),Te=ee.useProgram("skyboxCapture"),ve=new Float64Array(16);_.identity(ve),_.rotateY(ve,ve,.5*-Math.PI),qi(ue,oe,Te,ve,ce,0),_.identity(ve),_.rotateY(ve,ve,.5*Math.PI),qi(ue,oe,Te,ve,ce,1),_.identity(ve),_.rotateX(ve,ve,.5*-Math.PI),qi(ue,oe,Te,ve,ce,2),_.identity(ve),_.rotateX(ve,ve,.5*Math.PI),qi(ue,oe,Te,ve,ce,3),_.identity(ve),qi(ue,oe,Te,ve,ce,4),_.identity(ve),_.rotateY(ve,ve,Math.PI),qi(ue,oe,Te,ve,ce,5),ue.viewport.set([0,0,ee.width,ee.height])}(v,g),g.markSkyboxValid(v)):"sky"===v.renderPass&&function(ee,oe,de,ge,ue){const ye=ee.context,be=ye.gl,ce=ee.transform,Te=ee.useProgram("skybox");ye.activeTexture.set(be.TEXTURE0),be.bindTexture(be.TEXTURE_CUBE_MAP,oe.skyboxTexture);const ve={u_matrix:ce.skyboxMatrix,u_sun_direction:oe.getCenter(ee,!1),u_cubemap:0,u_opacity:ge,u_temporal_offset:ue};ee.prepareDrawProgram(ye,Te),Te.draw(ye,be.TRIANGLES,de,_.StencilMode.disabled,ee.colorModeForRenderPass(),_.CullFaceMode.backCW,ve,"skybox",oe.skyboxGeometry.vertexBuffer,oe.skyboxGeometry.indexBuffer,oe.skyboxGeometry.segment)}(v,g,G,D,J):"gradient"===B&&"sky"===v.renderPass&&function(ee,oe,de,ge,ue){const ye=ee.context,be=ye.gl,ce=ee.transform,Te=ee.useProgram("skyboxGradient");oe.skyboxGeometry||(oe.skyboxGeometry=new Op(ye)),ye.activeTexture.set(be.TEXTURE0);let ve=oe.colorRampTexture;ve||(ve=oe.colorRampTexture=new _.Texture(ye,oe.colorRamp,be.RGBA)),ve.bind(be.LINEAR,be.CLAMP_TO_EDGE);const De=(Fe=ce.skyboxMatrix,Re=oe.getCenter(ee,!1),Ue=oe.paint.get("sky-gradient-radius"),Ze=ge,nt=ue,{u_matrix:Fe,u_color_ramp:0,u_center_direction:Re,u_radius:_.degToRad(Ue),u_opacity:Ze,u_temporal_offset:nt});var Fe,Re,Ue,Ze,nt;ee.prepareDrawProgram(ye,Te),Te.draw(ye,be.TRIANGLES,de,_.StencilMode.disabled,ee.colorModeForRenderPass(),_.CullFaceMode.backCW,De,"skyboxGradient",oe.skyboxGeometry.vertexBuffer,oe.skyboxGeometry.indexBuffer,oe.skyboxGeometry.segment)}(v,g,G,D,J)},debug:function(v,c,g){for(let C=0;C<g.length;C++)bs(v,c,g[C])},custom:function(v,c,g,C){const S=v.context,D=g.implementation;if(!v.transform.projection.unsupportedLayers||!v.transform.projection.unsupportedLayers.includes("custom")||v.terrain&&(v.terrain.renderingToTexture||"offscreen"===v.renderPass)&&g.isLayerDraped()){if("offscreen"===v.renderPass){const L=D.prerender;if(L){if(v.setCustomLayerDefaults(),S.setColorMode(v.colorModeForRenderPass()),"globe"===v.transform.projection.name){const B=v.transform.pointMerc;L.call(D,S.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),_.globeToMercatorTransition(v.transform.zoom),[B.x,B.y],v.transform.pixelsPerMeterRatio)}else L.call(D,S.gl,v.transform.customLayerMatrix());S.setDirty(),v.setBaseState()}}else if("translucent"===v.renderPass){if(v.terrain&&v.terrain.renderingToTexture){const B=D.renderToTile;if(B){const G=C[0].canonical,J=new _.MercatorCoordinate(G.x+C[0].wrap*(1<<G.z),G.y,G.z);S.setDepthMode(_.DepthMode.disabled),S.setStencilMode(_.StencilMode.disabled),S.setColorMode(v.colorModeForRenderPass()),v.setCustomLayerDefaults(),B.call(D,S.gl,J),S.setDirty(),v.setBaseState()}return}v.setCustomLayerDefaults(),S.setColorMode(v.colorModeForRenderPass()),S.setStencilMode(_.StencilMode.disabled);const L="3d"===D.renderingMode?new _.DepthMode(v.context.gl.LEQUAL,_.DepthMode.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,_.DepthMode.ReadOnly);if(S.setDepthMode(L),"globe"===v.transform.projection.name){const B=v.transform.pointMerc;D.render(S.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),_.globeToMercatorTransition(v.transform.zoom),[B.x,B.y],v.transform.pixelsPerMeterRatio)}else D.render(S.gl,v.transform.customLayerMatrix());S.setDirty(),v.setBaseState(),S.bindFramebuffer.set(null)}}else _.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Al{constructor(c,g,C=!1){this.context=new ne(c,C),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=_.SourceCache.maxUnderzooming+_.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Tu,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(c,g){const C=!!c&&!!c.terrain&&this.transform.projection.supportsTerrain;if(!(C||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new sh(this,c));const S=this._terrain;this.transform.elevation=C?S:null,S.update(c,this.transform,g)}_updateFog(c){const g=c.fog;if(!g||"globe"===this.transform.projection.name||g.getOpacity(this.transform.pitch)<1||g.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[C,S]=g.getFovAdjustedRange(this.transform._fov);if(C>S)return void(this.transform.fogCullDistSq=null);const D=C+.78*(S-C);this.transform.fogCullDistSq=D*D}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(c,g){if(this.width=c*_.exported.devicePixelRatio,this.height=g*_.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const C of this.style.order)this.style._layers[C].resize()}setup(){const c=this.context,g=new _.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(_.EXTENT,0),g.emplaceBack(0,_.EXTENT),g.emplaceBack(_.EXTENT,_.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(g,_.posAttributes.members),this.tileExtentSegments=_.SegmentVector.simpleSegment(0,0,4,2);const C=new _.StructArrayLayout2i4;C.emplaceBack(0,0),C.emplaceBack(_.EXTENT,0),C.emplaceBack(0,_.EXTENT),C.emplaceBack(_.EXTENT,_.EXTENT),this.debugBuffer=c.createVertexBuffer(C,_.posAttributes.members),this.debugSegments=_.SegmentVector.simpleSegment(0,0,4,5);const S=new _.StructArrayLayout2i4;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(S,_.posAttributes.members),this.viewportSegments=_.SegmentVector.simpleSegment(0,0,4,2);const D=new _.StructArrayLayout4i8;D.emplaceBack(0,0,0,0),D.emplaceBack(_.EXTENT,0,_.EXTENT,0),D.emplaceBack(0,_.EXTENT,0,_.EXTENT),D.emplaceBack(_.EXTENT,_.EXTENT,_.EXTENT,_.EXTENT),this.mercatorBoundsBuffer=c.createVertexBuffer(D,_.boundsAttributes.members),this.mercatorBoundsSegments=_.SegmentVector.simpleSegment(0,0,4,2);const L=new _.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(L);const B=new _.StructArrayLayout1ui2;for(const J of[0,1,3,2,0])B.emplaceBack(J);this.debugIndexBuffer=c.createIndexBuffer(B),this.emptyTexture=new _.Texture(c,new _.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),c.gl.RGBA),this.identityMat=_.create();const G=this.context.gl;this.stencilClearMode=new _.StencilMode({func:G.ALWAYS,mask:0},0,255,G.ZERO,G.ZERO,G.ZERO),this.loadTimeStamps.push(_.window.performance.now()),this.atmosphereBuffer=new Id(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(c){return c._makeTileBoundsBuffers(this.context,this.transform.projection),c._tileBoundsBuffer?{tileBoundsBuffer:c._tileBoundsBuffer,tileBoundsIndexBuffer:c._tileBoundsIndexBuffer,tileBoundsSegments:c._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const c=this.context,g=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(c,g.TRIANGLES,_.DepthMode.disabled,this.stencilClearMode,_.ColorMode.disabled,_.CullFaceMode.disabled,di(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(c,g,C){if(!g||this.currentStencilSource===g.id||!c.isTileClipped()||!C||0===C.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let B=!1;for(const G of C)if(void 0===this._tileClippingMaskIDs[G.key]){B=!0;break}if(!B)return}this.currentStencilSource=g.id;const S=this.context,D=S.gl;this.nextStencilID+C.length>256&&this.clearStencil(),S.setColorMode(_.ColorMode.disabled),S.setDepthMode(_.DepthMode.disabled);const L=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const B of C){const G=g.getTile(B),J=this._tileClippingMaskIDs[B.key]=this.nextStencilID++,{tileBoundsBuffer:ee,tileBoundsIndexBuffer:oe,tileBoundsSegments:de}=this.getTileBoundsBuffers(G);L.draw(S,D.TRIANGLES,_.DepthMode.disabled,new _.StencilMode({func:D.ALWAYS,mask:0},J,255,D.KEEP,D.KEEP,D.REPLACE),_.ColorMode.disabled,_.CullFaceMode.disabled,di(B.projMatrix),"$clipping",ee,oe,de)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,g=this.context.gl;return new _.StencilMode({func:g.NOTEQUAL,mask:255},c,255,g.KEEP,g.KEEP,g.REPLACE)}stencilModeForClipping(c){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(c);const g=this.context.gl;return new _.StencilMode({func:g.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,g.KEEP,g.KEEP,g.REPLACE)}stencilConfigForOverlap(c){const g=this.context.gl,C=c.sort((L,B)=>B.overscaledZ-L.overscaledZ),S=C[C.length-1].overscaledZ,D=C[0].overscaledZ-S+1;if(D>1){this.currentStencilSource=void 0,this.nextStencilID+D>256&&this.clearStencil();const L={};for(let B=0;B<D;B++)L[B+S]=new _.StencilMode({func:g.GEQUAL,mask:255},B+this.nextStencilID,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID+=D,[L,C]}return[{[S]:_.StencilMode.disabled},C]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new _.ColorMode([c.CONSTANT_COLOR,c.ONE],new _.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?_.ColorMode.unblended:_.ColorMode.alphaBlended}depthModeForSublayer(c,g,C){if(!this.opaquePassEnabledForLayer())return _.DepthMode.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new _.DepthMode(C||this.context.gl.LEQUAL,g,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,g){this.style=c,this.options=g,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(_.exported.now()),this.imageManager.beginFrame();const C=this.style.order,S=this.style._sourceCaches;for(const G in S){const J=S[G];J.used&&J.prepare(this.context)}const D={},L={},B={};for(const G in S){const J=S[G];D[G]=J.getVisibleCoordinates(),L[G]=D[G].slice().reverse(),B[G]=J.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<C.length;G++)if(this.style._layers[C[G]].is3D()){this.opaquePassCutoff=G;break}if(this.terrain&&(this.terrain.updateTileBinding(B),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new _.GlobeSharedBuffers(this.context)),_.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const G of C){const J=this.style._layers[G],ee=c._getLayerSourceCache(J);if(!J.hasOffscreenPass()||J.isHidden(this.transform.zoom))continue;const oe=ee?L[ee.id]:void 0;("custom"===J.type||J.isSky()||oe&&oe.length)&&this.renderLayer(this,ee,J,oe)}if(this.depthRangeFor3D=[0,1-(c.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:g.showOverdrawInspector?_.Color.black:_.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=g.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=C.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[C[this.currentLayer]],J=c._getLayerSourceCache(G);if(G.isSky())continue;const ee=J?L[J.id]:void 0;this._renderTileClippingMasks(G,J,ee),this.renderLayer(this,J,G,ee)}if(this.style.fog&&this.transform.projection.supportsFog&&function(G,J){const ee=G.context,oe=ee.gl,de=G.transform,ge=new _.DepthMode(oe.LEQUAL,_.DepthMode.ReadOnly,[0,1]),ue=G.useProgram("globeAtmosphere",null,"globe"===de.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ye=_.globeToMercatorTransition(de.zoom),be=J.properties.get("color").toArray01(),ce=J.properties.get("high-color").toArray01(),Te=J.properties.get("space-color").toArray01PremultipliedAlpha(),ve=_.identity$1([]);_.rotateY$1(ve,ve,-_.degToRad(de._center.lng)),_.rotateX$1(ve,ve,_.degToRad(de._center.lat)),_.rotateZ$1(ve,ve,de.angle),_.rotateX$1(ve,ve,-de._pitch);const De=_.fromQuat(new Float32Array(16),ve),Fe=_.mapValue(J.properties.get("star-intensity"),0,1,0,.25),Ue=_.mapValue(J.properties.get("horizon-blend"),0,1,5e-4,.25),Ze=_.globeUseCustomAntiAliasing(G,ee,de)&&5e-4===Ue?de.worldSize/(2*Math.PI*1.025)-1:de.globeRadius,nt=G.frameCounter/1e3%1,ot=_.length(de.globeCenterInViewSpace),Ut=Math.sqrt(Math.pow(ot,2)-Math.pow(Ze,2)),Qe=Math.acos(Ut/ot),St={u_frustum_tl:de.frustumCorners.TL,u_frustum_tr:de.frustumCorners.TR,u_frustum_br:de.frustumCorners.BR,u_frustum_bl:de.frustumCorners.BL,u_horizon:de.frustumCorners.horizon,u_transition:ye,u_fadeout_range:Ue,u_color:be,u_high_color:ce,u_space_color:Te,u_star_intensity:Fe,u_star_size:5*_.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:nt,u_horizon_angle:Qe,u_rotation_matrix:De};G.prepareDrawProgram(ee,ue);const at=G.atmosphereBuffer;at&&ue.draw(ee,oe.TRIANGLES,ge,_.StencilMode.disabled,_.ColorMode.alphaBlended,_.CullFaceMode.backCW,St,"skybox",at.vertexBuffer,at.indexBuffer,at.segments)}(this,this.style.fog),this.renderPass="sky",(_.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<C.length;this.currentLayer++){const G=this.style._layers[C[this.currentLayer]],J=c._getLayerSourceCache(G);G.isSky()&&this.renderLayer(this,J,G,J?L[J.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<C.length;){const G=this.style._layers[C[this.currentLayer]],J=c._getLayerSourceCache(G);if(G.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(G)){if(G.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const ee=J?("symbol"===G.type?B:L)[J.id]:void 0;this._renderTileClippingMasks(G,J,J?D[J.id]:void 0),this.renderLayer(this,J,G,ee),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let G=null;_.values(this.style._layers).forEach(J=>{const ee=c._getLayerSourceCache(J);ee&&!J.isHidden(this.transform.zoom)&&(!G||G.getSource().maxzoom<ee.getSource().maxzoom)&&(G=ee)}),G&&this.options.showTileBoundaries&&cc.debug(this,G,G.getVisibleCoordinates())}this.options.showPadding&&function(G){const J=G.transform.padding;Os(G,G.transform.height-(J.top||0),3,gf),Os(G,J.bottom||0,3,_f),pr(G,J.left||0,3,yf),pr(G,G.transform.width-(J.right||0),3,I_);const ee=G.transform.centerPoint;var oe,de,ge,ue;Wc(oe=G,(de=ee.x)-1,(ge=G.transform.height-ee.y)-10,2,20,ue=qm),Wc(oe,de-10,ge-1,20,2,ue)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(_.window.performance.now()),this.saveCanvasCopy())}}renderLayer(c,g,C,S){C.isHidden(this.transform.zoom)||("background"===C.type||"sky"===C.type||"custom"===C.type||S&&S.length)&&(this.id=C.id,this.gpuTimingStart(C),(!c.transform.projection.unsupportedLayers||!c.transform.projection.unsupportedLayers.includes(C.type)||c.terrain&&"custom"===C.type)&&cc[C.type](c,g,C,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const g=this.context.extTimerQuery;let C=this.gpuTimers[c.id];C||(C=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:g.createQueryEXT()}),C.calls++,g.beginQueryEXT(g.TIME_ELAPSED_EXT,C.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const c=this.context.extTimerQuery,g=c.createQueryEXT();this.deferredRenderGpuTimeQueries.push(g),c.beginQueryEXT(c.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}collectDeferredRenderGpuQueries(){const c=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],c}queryGpuTimers(c){const g={};for(const C in c){const S=c[C],D=this.context.extTimerQuery,L=D.getQueryObjectEXT(S.query,D.QUERY_RESULT_EXT)/1e6;D.deleteQueryEXT(S.query),g[C]=L}return g}queryGpuTimeDeferredRender(c){if(!this.options.gpuTimingDeferredRender)return 0;const g=this.context.extTimerQuery;let C=0;for(const S of c)C+=g.getQueryObjectEXT(S,g.QUERY_RESULT_EXT)/1e6,g.deleteQueryEXT(S);return C}translatePosMatrix(c,g,C,S,D){if(!C[0]&&!C[1])return c;const L=D?"map"===S?this.transform.angle:0:"viewport"===S?-this.transform.angle:0;if(L){const J=Math.sin(L),ee=Math.cos(L);C=[C[0]*ee-C[1]*J,C[0]*J+C[1]*ee]}const B=[D?C[0]:en(g,C[0],this.transform.zoom),D?C[1]:en(g,C[1],this.transform.zoom),0],G=new Float32Array(16);return _.translate(G,c,B),G}saveTileTexture(c){const g=this._tileTextures[c.size[0]];g?g.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const g=this._tileTextures[c];return g&&g.length>0?g.pop():null}isPatternMissing(c){return null===c||void 0!==c&&!this.imageManager.getPattern(c.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const c=this.terrain&&this.terrain.renderingToTexture,g=this.terrain&&0===this.terrain.exaggeration(),C=this.style&&this.style.fog,S=[];return this.terrainRenderModeElevated()&&S.push("TERRAIN"),"globe"===this.transform.projection.name&&S.push("GLOBE"),g&&S.push("ZERO_EXAGGERATION"),C&&!c&&0!==C.getOpacity(this.transform.pitch)&&S.push("FOG"),c&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}useProgram(c,g,C){this.cache=this.cache||{};const S=C||[],D=this.currentGlobalDefines().concat(S),L=Gc.cacheKey(xd[c],c,D,g);return this.cache[L]||(this.cache[L]=new Gc(this.context,c,xd[c],g,Sp[c],D)),this.cache[L]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=_.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new _.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(c,g,C){if(this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const D=S.getOpacity(this.transform.pitch),L=((B,G,J,ee,oe,de,ge,ue,ye,be,ce)=>{const Te=B.transform,ve=G.properties.get("color").toArray01();ve[3]=ee;const De=B.frameCounter/1e3%1;return{u_fog_matrix:J?Te.calculateFogTileMatrix(J):B.identityMat,u_fog_range:G.getFovAdjustedRange(Te._fov),u_fog_color:ve,u_fog_horizon_blend:G.properties.get("horizon-blend"),u_fog_temporal_offset:De,u_frustum_tl:oe,u_frustum_tr:de,u_frustum_br:ge,u_frustum_bl:ue,u_globe_pos:ye,u_globe_radius:be,u_viewport:ce,u_globe_transition:_.globeToMercatorTransition(Te.zoom),u_is_globe:+("globe"===Te.projection.name)}})(this,S,C,D,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*_.exported.devicePixelRatio,this.transform.height*_.exported.devicePixelRatio]);g.setFogUniformValues(c,L)}}setTileLoadedFlag(c){this.tileLoaded=c}saveCanvasCopy(){const c=this.canvasCopy();c&&(this.frameCopies.push(c),this.tileLoaded=!1)}canvasCopy(){const c=this.context.gl,g=c.createTexture();return c.bindTexture(c.TEXTURE_2D,g),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,c.drawingBufferWidth,c.drawingBufferHeight,0),g}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const c=this.style&&this.style.fog;return!!c&&0!==c.getOpacity(this.transform.pitch)}getBackgroundTiles(){const c=this._backgroundTiles,g=this._backgroundTiles={},C=this.transform.coveringTiles({tileSize:512});for(const S of C)g[S.key]=c[S.key]||new _.Tile(S,512,this.transform.tileZoom,this);return g}clearBackgroundTiles(){this._backgroundTiles={}}}class Da{constructor(c=0,g=0,C=0,S=0){if(isNaN(c)||c<0||isNaN(g)||g<0||isNaN(C)||C<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=g,this.left=C,this.right=S}interpolate(c,g,C){return null!=g.top&&null!=c.top&&(this.top=_.number(c.top,g.top,C)),null!=g.bottom&&null!=c.bottom&&(this.bottom=_.number(c.bottom,g.bottom,C)),null!=g.left&&null!=c.left&&(this.left=_.number(c.left,g.left,C)),null!=g.right&&null!=c.right&&(this.right=_.number(c.right,g.right,C)),this}getCenter(c,g){const C=_.clamp((this.left+c-this.right)/2,0,c),S=_.clamp((this.top+g-this.bottom)/2,0,g);return new _.pointGeometry(C,S)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Da(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function vf(v,c){const g=_.getColumn(v,3);_.fromQuat(v,c),_.setColumn(v,3,g)}function ua(v,c){const g=_.identity$1([]);return _.rotateZ$1(g,g,-c),_.rotateX$1(g,g,-v),g}function zu(v,c){const g=[v[0],v[1],0],C=[c[0],c[1],0];if(_.length(g)>=1e-15){const L=_.normalize([],g);_.scale$2(C,L,_.dot(C,L)),c[0]=C[0],c[1]=C[1]}const S=_.cross([],c,v);if(_.len(S)<1e-15)return null;const D=Math.atan2(-S[1],S[0]);return ua(Math.atan2(Math.sqrt(v[0]*v[0]+v[1]*v[1]),-v[2]),D)}class Sd{constructor(c,g){this.position=c,this.orientation=g}get position(){return this._position}set position(c){if(c){const g=c instanceof _.MercatorCoordinate?c:new _.MercatorCoordinate(c[0],c[1],c[2]);this._renderWorldCopies&&(g.x=_.wrap(g.x,0,1)),this._position=g}else this._position=null}lookAtPoint(c,g){if(this.orientation=null,!this.position)return;const C=this._elevation?this._elevation.getAtPointOrZero(_.MercatorCoordinate.fromLngLat(c)):0,S=this.position,D=_.MercatorCoordinate.fromLngLat(c,C),L=[D.x-S.x,D.y-S.y,D.z-S.z];g||(g=[0,0,1]),g[2]=Math.abs(g[2]),this.orientation=zu(L,g)}setPitchBearing(c,g){this.orientation=ua(_.degToRad(c),_.degToRad(-g))}}class fh{constructor(c,g){this._transform=_.identity([]),this.orientation=g,this.position=c}get mercatorPosition(){const c=this.position;return new _.MercatorCoordinate(c[0],c[1],c[2])}get position(){const c=_.getColumn(this._transform,3);return[c[0],c[1],c[2]]}set position(c){var g;c&&_.setColumn(this._transform,3,[(g=c)[0],g[1],g[2],1])}get orientation(){return this._orientation}set orientation(c){this._orientation=c||_.identity$1([]),c&&vf(this._transform,this._orientation)}getPitchBearing(){const c=this.forward(),g=this.right();return{bearing:Math.atan2(-g[1],g[0]),pitch:Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2])}}setPitchBearing(c,g){this._orientation=ua(c,g),vf(this._transform,this._orientation)}forward(){const c=_.getColumn(this._transform,2);return[-c[0],-c[1],-c[2]]}up(){const c=_.getColumn(this._transform,1);return[-c[0],-c[1],-c[2]]}right(){const c=_.getColumn(this._transform,0);return[c[0],c[1],c[2]]}getCameraToWorld(c,g){const C=new Float64Array(16);return _.invert(C,this.getWorldToCamera(c,g)),C}getWorldToCameraPosition(c,g,C){const S=this.position;_.scale$2(S,S,-c);const D=new Float64Array(16);return _.fromScaling(D,[C,C,C]),_.translate(D,D,S),D[10]*=g,D}getWorldToCamera(c,g){const C=new Float64Array(16),S=new Float64Array(4),D=this.position;return _.conjugate(S,this._orientation),_.scale$2(D,D,-c),_.fromQuat(C,S),_.translate(C,C,D),C[1]*=-1,C[5]*=-1,C[9]*=-1,C[13]*=-1,C[8]*=g,C[9]*=g,C[10]*=g,C[11]*=g,C}getCameraToClipPerspective(c,g,C,S){const D=new Float64Array(16);return _.perspective(D,c,g,C,S),D}getDistanceToElevation(c,g=!1){const C=0===c?0:_.mercatorZfromAltitude(c,g?_.latFromMercatorY(this.position[1]):this.position[1]),S=this.forward();return(C-this.position[2])/S[2]}clone(){return new fh([...this.position],[...this.orientation])}}function Pl(v,c){const g=Ol(v.projection,v.zoom,v.width,v.height),C=function(D,L,B,G,J){const ee=new _.LngLat(B.lng-180*el,B.lat),oe=new _.LngLat(B.lng+180*el,B.lat),de=D.project(ee.lng,ee.lat),ge=D.project(oe.lng,oe.lat),ue=-Math.atan2(ge.y-de.y,ge.x-de.x),ye=_.MercatorCoordinate.fromLngLat(B);ye.y=_.clamp(ye.y,-.999975,.999975);const be=ye.toLngLat(),ce=D.project(be.lng,be.lat),Te=_.MercatorCoordinate.fromLngLat(be);Te.x+=el;const ve=Te.toLngLat(),De=D.project(ve.lng,ve.lat),Fe=kl(De.x-ce.x,De.y-ce.y,ue),Re=_.MercatorCoordinate.fromLngLat(be);Re.y+=el;const Ue=Re.toLngLat(),Ze=D.project(Ue.lng,Ue.lat),nt=kl(Ze.x-ce.x,Ze.y-ce.y,ue),ot=Math.abs(Fe.x)/Math.abs(nt.y),Ut=_.identity([]);_.rotateZ(Ut,Ut,-ue*(1-(J?0:G)));const Qe=_.identity([]);return _.scale(Qe,Qe,[1,1-(1-ot)*G,1]),Qe[4]=-nt.x/nt.y*G,_.rotateZ(Qe,Qe,ue),_.multiply(Qe,Ut,Qe),Qe}(v.projection,0,v.center,g,c),S=kp(v);return _.scale(C,C,[S,S,1]),C}function kp(v){const c=v.projection,g=Ol(v.projection,v.zoom,v.width,v.height),C=Zc(c,v.center),S=Zc(c,_.LngLat.convert(c.center));return Math.pow(2,C*g+(1-g)*S)}function Ol(v,c,g,C,S=1/0){const D=v.range;if(!D)return 0;const L=Math.min(S,Math.max(g,C)),B=Math.log(L/1024)/Math.LN2;return _.smoothstep(D[0]+B,D[1]+B,c)}const el=1/4e4;function Zc(v,c){const g=_.clamp(c.lat,-_.MAX_MERCATOR_LATITUDE,_.MAX_MERCATOR_LATITUDE),C=new _.LngLat(c.lng-180*el,g),S=new _.LngLat(c.lng+180*el,g),D=v.project(C.lng,g),L=v.project(S.lng,g),B=_.MercatorCoordinate.fromLngLat(C),G=_.MercatorCoordinate.fromLngLat(S),J=L.x-D.x,ee=L.y-D.y,oe=G.x-B.x,de=G.y-B.y,ge=Math.sqrt((oe*oe+de*de)/(J*J+ee*ee));return Math.log(ge)/Math.LN2}function kl(v,c,g){const C=Math.cos(g),S=Math.sin(g);return{x:v*C-c*S,y:v*S+c*C}}class hn{constructor(c,g,C,S,D,L,B){this.tileSize=512,this._renderWorldCopies=void 0===D||D,this._minZoom=c||0,this._maxZoom=g||22,this._minPitch=C??0,this._maxPitch=S??60,this.setProjection(L),this.setMaxBounds(B),this.width=0,this.height=0,this._center=new _.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Da,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new fh,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const c=new hn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return c._elevation=this._elevation,c._centerAltitude=this._centerAltitude,c._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,c.tileSize=this.tileSize,c.mercatorFromTransition=this.mercatorFromTransition,c.width=this.width,c.height=this.height,c.cameraElevationReference=this.cameraElevationReference,c._center=this._center,c._setZoom(this.zoom),c._seaLevelZoom=this._seaLevelZoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._nearZ=this._nearZ,c._farZ=this._farZ,c._averageElevation=this._averageElevation,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._camera=this._camera.clone(),c._calcMatrices(),c.freezeTileCoverage=this.freezeTileCoverage,c.frustumCorners=this.frustumCorners,c}get elevation(){return this._elevation}set elevation(c){this._elevation!==c&&(this._elevation=c,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(c,g=!1){const C=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||C)&&this._updateCameraOnTerrain(),(c||C)&&this._constrainCamera(g),this._calcMatrices()}getProjection(){return _.pick(this.projection,["name","center","parallels"])}setProjection(c){this.projectionOptions=c||{name:"mercator"};const g=this.projection?this.getProjection():void 0;this.projection=_.getProjection(this.projectionOptions);const C=!$e(g,this.getProjection());return C&&this._calcMatrices(),this.mercatorFromTransition=!1,C}setMercatorFromTransition(){const c=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=_.getProjection({name:"mercator"});const g=c!==this.projection.name;return g&&this._calcMatrices(),g}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(c){void 0===c?c=!0:null===c&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get cameraWorldSize(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return _.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new _.pointGeometry(this.width,this.height)}get bearing(){return _.wrap(this.rotation,-180,180)}set bearing(c){this.rotation=c}get rotation(){return-this.angle/Math.PI*180}set rotation(c){const g=-c*Math.PI/180;var C,S,D,L,B,G,J,ee,oe,de;this.angle!==g&&(this._unmodified=!1,this.angle=g,this._calcMatrices(),this.rotationMatrix=(C=new _.ARRAY_TYPE(4),_.ARRAY_TYPE!=Float32Array&&(C[1]=0,C[2]=0),C[0]=1,C[3]=1,C),S=this.rotationMatrix,L=this.angle,B=(D=this.rotationMatrix)[0],G=D[1],J=D[2],ee=D[3],oe=Math.sin(L),de=Math.cos(L),S[0]=B*de+J*oe,S[1]=G*de+ee*oe,S[2]=B*-oe+J*de,S[3]=G*-oe+ee*de)}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const g=_.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==g&&(this._unmodified=!1,this._pitch=g,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const c=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/c)}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=_.degToRad(c),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(c){this._averageElevation=c,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(c){const g=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==g&&(this._unmodified=!1,this._setZoom(g),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(c){this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const c=this._elevation;this._centerAltitude=c.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=c.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const c=this._elevation,g=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],C=this.horizonLineFromTop();let S=0,D=0;for(let L=0;L<g.length;L++){const B=new _.pointGeometry(g[L][0]*this.width,C+g[L][1]*(this.height-C)),G=c.pointCoordinate(B);if(!G)continue;const J=1/Math.hypot(G[0]-this._camera.position[0],G[1]-this._camera.position[1]);S+=G[3]*J,D+=J}return 0===D?NaN:S/D}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const c=this._seaLevelZoom,g=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),C=this.pixelsPerMeter/this.worldSize*g,S=this._mercatorZfromZoom(c),D=this._mercatorZfromZoom(this._maxZoom),L=Math.max(S-C,D);this._setZoom(this._zoomFromMercatorZ(L))}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}computeZoomRelativeTo(c){const g=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,c.toAltitude()));let C;C=c.z<this._camera.position[2]?[g.x,g.y,g.z]:[c.x,c.y,c.z];const S=_.length(_.sub([],this._camera.position,C));return _.clamp(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(c){if(!this.height||!c.position&&!c.orientation)return;this._updateCameraState();let g=!1;if(c.orientation&&!_.exactEquals(c.orientation,this._camera.orientation)&&(g=this._setCameraOrientation(c.orientation)),c.position){const C=[c.position.x,c.position.y,c.position.z];_.exactEquals$1(C,this._camera.position)||(this._setCameraPosition(C),g=!0)}g&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const c=this._camera.position,g=new Sd;return g.position=new _.MercatorCoordinate(c[0],c[1],c[2]),g.orientation=this._camera.orientation,g._elevation=this.elevation,g._renderWorldCopies=this.renderWorldCopies,g}_setCameraOrientation(c){if(!_.length$1(c))return!1;_.normalize$1(c,c);const g=_.transformQuat([],[0,0,-1],c),C=_.transformQuat([],[0,-1,0],c);if(C[2]<0)return!1;const S=zu(g,C);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(c){const g=this.zoomScale(this.minZoom)*this.tileSize,C=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;c[2]=_.clamp(c[2],S/C,S/g),this._camera.position=c}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,g,C){this._unmodified=!1,this._edgeInsets.interpolate(c,g,C),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const g=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,g)}getVisibleUnwrappedCoordinates(c){const g=[new _.UnwrappedTileID(0,c)];if(this.renderWorldCopies){const C=this.pointCoordinate(new _.pointGeometry(0,0)),S=this.pointCoordinate(new _.pointGeometry(this.width,0)),D=this.pointCoordinate(new _.pointGeometry(this.width,this.height)),L=this.pointCoordinate(new _.pointGeometry(0,this.height)),B=Math.floor(Math.min(C.x,S.x,D.x,L.x)),G=Math.floor(Math.max(C.x,S.x,D.x,L.x)),J=1;for(let ee=B-J;ee<=G+J;ee++)0!==ee&&g.push(new _.UnwrappedTileID(ee,c))}return g}coveringTiles(c){let g=this.coveringZoomLevel(c);const C=g,S=this.elevation&&!c.isTerrainDEM,D="mercator"===this.projection.name;if(void 0!==c.minzoom&&g<c.minzoom)return[];void 0!==c.maxzoom&&g>c.maxzoom&&(g=c.maxzoom);const L=this.locationCoordinate(this.center),B=this.center.lat,G=1<<g,J=[G*L.x,G*L.y,0],ee="globe"===this.projection.name,oe=!ee,de=_.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,g,oe),ge=ee?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ue=G*_.mercatorZfromAltitude(1,this.center.lat),ye=this._camera.position[2]/_.mercatorZfromAltitude(1,this.center.lat),be=[G*ge.x,G*ge.y,ye*(oe?1:ue)],ce=this.cameraToCenterDistance/c.tileSize*(c.roundZoom?1:.502),Te=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?g:0,ve=c.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,De=c.isTerrainDEM?-ve:this._elevation?this._elevation.getMinElevationBelowMSL():0,Fe=this.projection.isReprojectedInTileSpace?kp(this):1,Re=et=>{const Xe=new _.MercatorCoordinate(et.x+25e-6,et.y,et.z),Mt=new _.MercatorCoordinate(et.x,et.y+25e-6,et.z),Lt=et.toLngLat(),dn=Xe.toLngLat(),Yn=Mt.toLngLat(),gn=this.locationCoordinate(Lt),Yt=this.locationCoordinate(dn),yn=this.locationCoordinate(Yn),xi=Math.hypot(Yt.x-gn.x,Yt.y-gn.y),Bn=Math.hypot(yn.x-gn.x,yn.y-gn.y);return Math.sqrt(xi*Bn)*Fe/25e-6},Ue=et=>{const qe=ve,Xe=De;return{aabb:_.tileAABB(this,G,0,0,0,et,Xe,qe,this.projection),zoom:0,x:0,y:0,minZ:Xe,maxZ:qe,wrap:et,fullyVisible:!1}},Ze=[];let nt=[];const ot=g,Ut=c.reparseOverscaled?C:g,Qe=et=>et*et,St=Qe((ye-this._centerAltitude)*ue),at=et=>{if(!this._elevation||!et.tileID||!D)return;const qe=this._elevation.getMinMaxForTile(et.tileID),Xe=et.aabb;qe?(Xe.min[2]=qe.min,Xe.max[2]=qe.max,Xe.center[2]=(Xe.min[2]+Xe.max[2])/2):(et.shouldSplit=Ot(et),et.shouldSplit||(Xe.min[2]=Xe.max[2]=Xe.center[2]=this._centerAltitude))},Ot=et=>{if(et.zoom<Te)return!0;if(et.zoom===ot)return!1;if(null!=et.shouldSplit)return et.shouldSplit;const qe=et.aabb.distanceX(be),Xe=et.aabb.distanceY(be);let Mt=St,Lt=1;if(ee){Mt=Qe(et.aabb.distanceZ(be));const gn=Math.pow(2,et.zoom),Yt=_.latFromMercatorY((et.y+1)/gn),yn=_.latFromMercatorY(et.y/gn),xi=Math.min(Math.max(B,Yt),yn),Bn=_.circumferenceAtLatitude(xi)/_.circumferenceAtLatitude(B);if(Lt=xi===B?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Bn/this._mercatorScaleRatio),this.zoom<=_.GLOBE_ZOOM_THRESHOLD_MIN&&et.zoom===ot-1&&Bn>=.9)return!0}else if(S&&(Mt=Qe(et.aabb.distanceZ(be)*ue)),this.projection.isReprojectedInTileSpace&&C<=5){const gn=Math.pow(2,et.zoom),Yt=Re(new _.MercatorCoordinate((et.x+.5)/gn,(et.y+.5)/gn));Lt=Yt>.85?1:Yt}const dn=qe*qe+Xe*Xe+Mt;return dn<Qe((1<<ot-et.zoom)*ce*Lt*((gn,Yt)=>{if(Yt*Qe(.707)<gn)return 1;const yn=Math.sqrt(Yt/gn);return yn/(1.4144271570014144+(Math.pow(1.1,yn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Mt,St),dn))};if(this.renderWorldCopies)for(let et=1;et<=3;et++)Ze.push(Ue(-et)),Ze.push(Ue(et));for(Ze.push(Ue(0));Ze.length>0;){const et=Ze.pop(),qe=et.x,Xe=et.y;let Mt=et.fullyVisible;if(!Mt){const Lt=et.aabb.intersects(de);if(0===Lt)continue;Mt=2===Lt}if(et.zoom!==ot&&Ot(et))for(let Lt=0;Lt<4;Lt++){const dn=(qe<<1)+Lt%2,Yn=(Xe<<1)+(Lt>>1),gn={aabb:D?et.aabb.quadrant(Lt):_.tileAABB(this,G,et.zoom+1,dn,Yn,et.wrap,et.minZ,et.maxZ,this.projection),zoom:et.zoom+1,x:dn,y:Yn,wrap:et.wrap,fullyVisible:Mt,tileID:void 0,shouldSplit:void 0,minZ:et.minZ,maxZ:et.maxZ};S&&!ee&&(gn.tileID=new _.OverscaledTileID(et.zoom+1===ot?Ut:et.zoom+1,et.wrap,et.zoom+1,dn,Yn),at(gn)),Ze.push(gn)}else{const Lt=et.zoom===ot?Ut:et.zoom;if(c.minzoom&&c.minzoom>Lt)continue;const dn=J[0]-(.5+qe+(et.wrap<<et.zoom))*(1<<g-et.zoom),Yn=J[1]-.5-Xe,gn=et.tileID?et.tileID:new _.OverscaledTileID(Lt,et.wrap,et.zoom,qe,Xe);nt.push({tileID:gn,distanceSq:dn*dn+Yn*Yn})}}if(this.fogCullDistSq){const et=this.fogCullDistSq,qe=this.horizonLineFromTop();nt=nt.filter(Xe=>{const Mt=[0,0,0,1],Lt=[_.EXTENT,_.EXTENT,0,1],dn=this.calculateFogTileMatrix(Xe.tileID.toUnwrapped());_.transformMat4$1(Mt,Mt,dn),_.transformMat4$1(Lt,Lt,dn);const Yn=_.getAABBPointSquareDist(Mt,Lt);if(0===Yn)return!0;let gn=!1;const Yt=this._elevation;if(Yt&&Yn>et&&0!==qe){const yn=this.calculateProjMatrix(Xe.tileID.toUnwrapped());let xi;c.isTerrainDEM||(xi=Yt.getMinMaxForTile(Xe.tileID)),xi||(xi={min:De,max:ve});const Bn=_.furthestTileCorner(this.rotation),er=[Bn[0]*_.EXTENT,Bn[1]*_.EXTENT,xi.max];_.transformMat4(er,er,yn),gn=(1-er[1])*this.height*.5<qe}return Yn<et||gn})}return nt.sort((et,qe)=>et.distanceSq-qe.distanceSq).map(et=>et.tileID)}resize(c,g){this.width=c,this.height=g,this.pixelsToGLUnits=[2/c,-2/g],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const g=_.clamp(c.lat,-_.MAX_MERCATOR_LATITUDE,_.MAX_MERCATOR_LATITUDE),C=this.projection.project(c.lng,g);return new _.pointGeometry(C.x*this.worldSize,C.y*this.worldSize)}unproject(c){return this.projection.unproject(c.x/this.worldSize,c.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/_.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(c,g){let C,S;const D=this.centerPoint;if("globe"===this.projection.name){const B=this.worldSize;C=(g.x-D.x)/B,S=(g.y-D.y)/B}else{const B=this.pointCoordinate(g),G=this.pointCoordinate(D);C=B.x-G.x,S=B.y-G.y}const L=this.locationCoordinate(c);this.setLocation(new _.MercatorCoordinate(L.x-C,L.y-S))}setLocation(c){this.center=this.coordinateLocation(c),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(c){return this.projection.locationPoint(this,c)}locationPoint3D(c){return this.projection.locationPoint(this,c,!0)}pointLocation(c){return this.coordinateLocation(this.pointCoordinate(c))}pointLocation3D(c){return this.coordinateLocation(this.pointCoordinate3D(c))}locationCoordinate(c,g){const C=g?_.mercatorZfromAltitude(g,c.lat):void 0,S=this.projection.project(c.lng,c.lat);return new _.MercatorCoordinate(S.x,S.y,C)}coordinateLocation(c){return this.projection.unproject(c.x,c.y)}pointRayIntersection(c,g){const C=g??this._centerAltitude,S=[c.x,c.y,0,1],D=[c.x,c.y,1,1];_.transformMat4$1(S,S,this.pixelMatrixInverse),_.transformMat4$1(D,D,this.pixelMatrixInverse);const L=D[3];_.scale$1(S,S,1/S[3]),_.scale$1(D,D,1/L);const B=S[2],G=D[2];return{p0:S,p1:D,t:B===G?0:(C-B)/(G-B)}}screenPointToMercatorRay(c){const g=[c.x,c.y,0,1],C=[c.x,c.y,1,1];return _.transformMat4$1(g,g,this.pixelMatrixInverse),_.transformMat4$1(C,C,this.pixelMatrixInverse),_.scale$1(g,g,1/g[3]),_.scale$1(C,C,1/C[3]),g[2]=_.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,C[2]=_.mercatorZfromAltitude(C[2],this._center.lat)*this.worldSize,_.scale$1(g,g,1/this.worldSize),_.scale$1(C,C,1/this.worldSize),new _.Ray([g[0],g[1],g[2]],_.normalize([],_.sub([],C,g)))}rayIntersectionCoordinate(c){const{p0:g,p1:C,t:S}=c,D=_.mercatorZfromAltitude(g[2],this._center.lat),L=_.mercatorZfromAltitude(C[2],this._center.lat);return new _.MercatorCoordinate(_.number(g[0],C[0],S)/this.worldSize,_.number(g[1],C[1],S)/this.worldSize,_.number(D,L,S))}pointCoordinate(c,g=this._centerAltitude){return this.projection.pointCoordinate(this,c.x,c.y,g)}pointCoordinate3D(c){if(!this.elevation)return this.pointCoordinate(c);let g=this.projection.pointCoordinate3D(this,c.x,c.y);if(g)return new _.MercatorCoordinate(g[0],g[1],g[2]);let C=0,S=this.horizonLineFromTop();if(c.y>S)return this.pointCoordinate(c);const D=.02*S,L=c.clone();for(let B=0;B<10&&S-C>D;B++){L.y=_.number(C,S,.66);const G=this.projection.pointCoordinate3D(this,L.x,L.y);G?(S=L.y,g=G):C=L.y}return g?new _.MercatorCoordinate(g[0],g[1],g[2]):this.pointCoordinate(c)}isPointAboveHorizon(c){return this.projection.isPointAboveHorizon(this,c)}_coordinatePoint(c,g){const C=g&&this.elevation?this.elevation.getAtPointOrZero(c,this._centerAltitude):this._centerAltitude,S=[c.x*this.worldSize,c.y*this.worldSize,C+c.toAltitude(),1];return _.transformMat4$1(S,S,this.pixelMatrix),S[3]>0?new _.pointGeometry(S[0]/S[3],S[1]/S[3]):new _.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:c,left:g}=this._edgeInsets,C=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,D=this.pointLocation3D(new _.pointGeometry(g,c)),L=this.pointLocation3D(new _.pointGeometry(S,c)),B=this.pointLocation3D(new _.pointGeometry(S,C)),G=this.pointLocation3D(new _.pointGeometry(g,C));let J=Math.min(D.lng,L.lng,B.lng,G.lng),ee=Math.max(D.lng,L.lng,B.lng,G.lng),oe=Math.min(D.lat,L.lat,B.lat,G.lat),de=Math.max(D.lat,L.lat,B.lat,G.lat);const ge=Math.pow(2,-this.zoom)/16*270,ue="globe"===this.projection.name?1:4,ye=(be,ce,Te,ve,De)=>{const Fe=(be+Te)/2,Re=(ce+ve)/2,Ue=new _.pointGeometry(Fe,Re),{lng:Ze,lat:nt}=this.pointLocation3D(Ue),ot=Math.max(0,J-Ze,oe-nt,Ze-ee,nt-de);J=Math.min(J,Ze),ee=Math.max(ee,Ze),oe=Math.min(oe,nt),de=Math.max(de,nt),(De<ue||ot>ge)&&(ye(be,ce,Fe,Re,De+1),ye(Fe,Re,Te,ve,De+1))};if(ye(g,c,S,c,1),ye(S,c,S,C,1),ye(S,C,g,C,1),ye(g,C,g,c,1),"globe"===this.projection.name){const[be,ce]=_.polesInViewport(this);be?(de=90,ee=180,J=-180):ce&&(oe=-90,ee=180,J=-180)}return new _.LngLatBounds(new _.LngLat(J,oe),new _.LngLat(ee,de))}_getBoundsRectangular(c,g){const{top:C,left:S}=this._edgeInsets,D=this.height-this._edgeInsets.bottom,L=this.width-this._edgeInsets.right,B=new _.pointGeometry(S,C),G=new _.pointGeometry(L,C),J=new _.pointGeometry(L,D),ee=new _.pointGeometry(S,D);let oe=this.pointCoordinate(B,c),de=this.pointCoordinate(G,c);const ge=this.pointCoordinate(J,g),ue=this.pointCoordinate(ee,g),ye=(be,ce)=>(ce.y-be.y)/(ce.x-be.x);return oe.y>1&&de.y>=0?oe=new _.MercatorCoordinate((1-ue.y)/ye(ue,oe)+ue.x,1):oe.y<0&&de.y<=1&&(oe=new _.MercatorCoordinate(-ue.y/ye(ue,oe)+ue.x,0)),de.y>1&&oe.y>=0?de=new _.MercatorCoordinate((1-ge.y)/ye(ge,de)+ge.x,1):de.y<0&&oe.y<=1&&(de=new _.MercatorCoordinate(-ge.y/ye(ge,de)+ge.x,0)),(new _.LngLatBounds).extend(this.coordinateLocation(oe)).extend(this.coordinateLocation(de)).extend(this.coordinateLocation(ue)).extend(this.coordinateLocation(ge))}_getBoundsRectangularTerrain(){const c=this.elevation;if(!c.visibleDemTiles.length||c.isUsingMockSource())return this._getBoundsRectangular(0,0);const g=c.visibleDemTiles.reduce((C,S)=>{if(S.dem){const D=S.dem.tree;C.min=Math.min(C.min,D.minimums[0]),C.max=Math.max(C.max,D.maximums[0])}return C},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(g.min*c.exaggeration(),g.max*c.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(c=!0){const g=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,C=this.height/2-g*(1-this._horizonShift);return c?Math.max(0,C):C}getMaxBounds(){return this.maxBounds}setMaxBounds(c){this.maxBounds=c,this.minLat=-_.MAX_MERCATOR_LATITUDE,this.maxLat=_.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,c&&(this.minLat=c.getSouth(),this.maxLat=c.getNorth(),this.minLng=c.getWest(),this.maxLng=c.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=_.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=_.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=_.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=_.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(c,g){return this.projection.createTileMatrix(this,g,c)}calculateDistanceTileData(c){const g=c.key,C=this._distanceTileDataCache;if(C[g])return C[g];const S=c.canonical,D=1/this.height,L=this.cameraWorldSize,B=L/this.zoomScale(S.z),G=(S.x+Math.pow(2,S.z)*c.wrap)*B,J=S.y*B,ee=this.point;ee.x*=L/this.worldSize,ee.y*=L/this.worldSize;const oe=this.angle,de=Math.sin(-oe),ge=-Math.cos(-oe);return C[g]={bearing:[de,ge],center:[(ee.x-G)*D,(ee.y-J)*D],scale:B/_.EXTENT*D},C[g]}calculateFogTileMatrix(c){const g=c.key,C=this._fogTileMatrixCache;if(C[g])return C[g];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,c);return _.multiply(S,this.worldToFogMatrix,S),C[g]=new Float32Array(S),C[g]}calculateProjMatrix(c,g=!1){const C=c.key,S=g?this._alignedProjMatrixCache:this._projMatrixCache;if(S[C])return S[C];const D=this.calculatePosMatrix(c,this.worldSize);return _.multiply(D,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.alignedProjMatrix:this.projMatrix,D),S[C]=new Float32Array(D),S[C]}calculatePixelsToTileUnitsMatrix(c){const g=c.tileID.key,C=this._pixelsToTileUnitsCache;if(C[g])return C[g];const S=function(D,L){const{scale:B}=D.tileTransform,G=B*_.EXTENT/(D.tileSize*Math.pow(2,L.zoom-D.tileID.overscaledZ+D.tileID.canonical.z));return J=new Float32Array(4),de=(ee=L.inverseAdjustmentMatrix)[1],ge=ee[2],ue=ee[3],be=(oe=[G,G])[1],J[0]=ee[0]*(ye=oe[0]),J[1]=de*ye,J[2]=ge*be,J[3]=ue*be,J;var J,ee,oe,de,ge,ue,ye,be}(c,this);return C[g]=S,C[g]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const c=1/this.worldSize,g=_.fromScaling([],[c,c,c]);return _.multiply(g,g,this.globeMatrix),g}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const c=this._elevation;this._updateCameraState();const g=_.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,C=this._computeCameraPosition(g),S=this._camera.forward(),D=_.mercatorZfromAltitude(1,this._center.lat);C[2]/=D,S[2]/=D,_.normalize(S,S);const L=c.raycast(C,S,c.exaggeration());if(L){const B=_.scaleAndAdd([],C,S,L),G=new _.MercatorCoordinate(B[0],B[1],_.mercatorZfromAltitude(B[2],_.latFromMercatorY(B[1]))),J=(G.z+_.length([G.x-C[0],G.y-C[1],G.z-C[2]*D]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(J),this._centerAltitude=G.toAltitude(),this._center=this.coordinateLocation(G),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(c=!1){if(!this._elevation)return;const g=this._elevation,C=_.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(C),D=g.getAtPointOrZero(new _.MercatorCoordinate(...S)),L=this.pixelsPerMeter/this.worldSize*D,B=this._minimumHeightOverTerrain(),G=S[2]-L;if(G<=B)if(G<0||c){const J=this.locationCoordinate(this._center,this._centerAltitude),ee=[S[0],S[1],J.z-S[2]],oe=_.length(ee);ee[2]-=(B-G)/this._pixelsPerMercatorPixel;const de=_.length(ee);if(0===de)return;_.scale$2(ee,ee,oe/de*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],J.z*this._pixelsPerMercatorPixel-ee[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const c="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||c){const de=this.center;return de.lat=_.clamp(de.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!c)&&(de.lng=_.clamp(de.lng,this.minLng,this.maxLng)),this.center=de,void(this._constraining=!1)}const g=this._unmodified,{x:C,y:S}=this.point;let D=0,L=C,B=S;const G=this.width/2,J=this.height/2,ee=this.worldMinY*this.scale,oe=this.worldMaxY*this.scale;if(S-J<ee&&(B=ee+J),S+J>oe&&(B=oe-J),oe-ee<this.height&&(D=Math.max(D,this.height/(oe-ee)),B=(oe+ee)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const de=this.worldMinX*this.scale,ge=this.worldMaxX*this.scale,ue=this.worldSize/2-(de+ge)/2;L=(C+ue+this.worldSize)%this.worldSize-ue,L-G<de&&(L=de+G),L+G>ge&&(L=ge-G),ge-de<this.width&&(D=Math.max(D,this.width/(ge-de)),L=(ge+de)/2)}L===C&&B===S||(this.center=this.unproject(new _.pointGeometry(L,B))),D&&(this.zoom+=this.scaleZoom(D)),this._constrainCamera(),this._unmodified=g,this._constraining=!1}_minZoomForBounds(){let c=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(c=Math.max(c,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),c}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,g=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=_.mercatorZfromAltitude(1,this.center.lat)/_.mercatorZfromAltitude(1,_.GLOBE_SCALE_MATCH_LATITUDE));const C=Ol(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,C),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S="meters"===this.projection.zAxisUnit?g:1,D=this._camera.getWorldToCamera(this.worldSize,S),L=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);L[8]=2*-c.x/this.width,L[9]=2*c.y/this.height;let B=_.mul([],L,D);if(this.projection.isReprojectedInTileSpace){const Re=this.locationCoordinate(this.center),Ue=_.identity([]);_.translate(Ue,Ue,[Re.x*this.worldSize,Re.y*this.worldSize,0]),_.multiply(Ue,Ue,Pl(this)),_.translate(Ue,Ue,[-Re.x*this.worldSize,-Re.y*this.worldSize,0]),_.multiply(B,B,Ue),this.inverseAdjustmentMatrix=function(Ze){const nt=Pl(Ze,!0);return Ct([],[nt[0],nt[1],nt[4],nt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=_.scale([],B,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=B,this.invProjMatrix=_.invert(new Float64Array(16),this.projMatrix);const G=_.invert([],L);this.frustumCorners=_.FrustumCorners.fromInvProjectionMatrix(G,this.horizonLineFromTop(),this.height);const J=new Float32Array(16);_.identity(J),_.scale(J,J,[1,-1,1]),_.rotateX(J,J,this._pitch),_.rotateZ(J,J,this.angle);const ee=_.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),oe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ee[8]=2*-c.x/this.width,ee[9]=2*(c.y+oe)/this.height,this.skyboxMatrix=_.multiply(J,ee,J);const de=this.point,ge=de.x,ue=de.y,ye=this.width%2/2,be=this.height%2/2,ce=Math.cos(this.angle),Te=Math.sin(this.angle),ve=ge-Math.round(ge)+ce*ye+Te*be,De=ue-Math.round(ue)+ce*be+Te*ye,Fe=new Float64Array(B);if(_.translate(Fe,Fe,[ve>.5?ve-1:ve,De>.5?De-1:De,0]),this.alignedProjMatrix=Fe,B=_.create(),_.scale(B,B,[this.width/2,-this.height/2,1]),_.translate(B,B,[1,-1,0]),this.labelPlaneMatrix=B,B=_.create(),_.scale(B,B,[1,-1,1]),_.translate(B,B,[-1,-1,0]),_.scale(B,B,[2/this.width,2/this.height,1]),this.glCoordMatrix=B,this.pixelMatrix=_.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},B=_.invert(new Float64Array(16),this.pixelMatrix),!B)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=B,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=_.calculateGlobeMatrix(this);const Re=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=_.transformMat4(Re,Re,D),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=B;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const c=this.cameraWorldSizeForFog,g=this.cameraPixelsPerMeter,C=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,D=[c,c,g];_.scale$2(D,D,S),_.scale$2(C,C,-1),_.multiply$2(C,C,D);const L=_.create();_.translate(L,L,C),_.scale(L,L,D),this.mercatorFogMatrix=L,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(c,g,S)}_computeCameraPosition(c){const g=(c=c||this.pixelsPerMeter)/this.pixelsPerMeter,C=this._camera.forward(),S=this.point,D=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*g-c/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-C[0]*D,S.y/this.worldSize-C[1]*D,c/this.worldSize*this._centerAltitude-C[2]*D]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(c){const g=this._maxCameraBoundsDistance()*Math.cos(this._pitch),C=this._camera.position[2],S=c[2];let D=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(D=Math.min((g-C)/S,1)),this._camera.position=_.scaleAndAdd([],this._camera.position,c,D),this._updateStateFromCamera()}_updateStateFromCamera(){const c=this._camera.position,g=this._camera.forward(),{pitch:C,bearing:S}=this._camera.getPitchBearing(),D=_.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,L=this._mercatorZfromZoom(this._maxZoom)*Math.cos(_.degToRad(this._maxPitch)),B=Math.max((c[2]-D)/Math.cos(C),L),G=this._zoomFromMercatorZ(B);_.scaleAndAdd(c,c,g,B),this._pitch=_.clamp(C,_.degToRad(this.minPitch),_.degToRad(this.maxPitch)),this.angle=_.wrap(S,-Math.PI,Math.PI),this._setZoom(_.clamp(G,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new _.MercatorCoordinate(c[0],c[1],c[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(c){return Math.pow(2,c)*this.tileSize}_mercatorZfromZoom(c){return this.cameraToCenterDistance/this._worldSizeFromZoom(c)}_minimumHeightOverTerrain(){const c=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(c)}_zoomFromMercatorZ(c){return this.scaleZoom(this.cameraToCenterDistance/(c*this.tileSize))}zoomFromMercatorZAdjusted(c){let g=0,C=_.GLOBE_ZOOM_THRESHOLD_MAX,S=0,D=1/0;for(;C-g>1e-6&&C>g;){const L=g+.5*(C-g),B=this.tileSize*Math.pow(2,L),G=this.getCameraToCenterDistance(this.projection,L,B),J=this.scaleZoom(G/(c*this.tileSize)),ee=Math.abs(L-J);ee<D&&(D=ee,S=L),L<J?g=L:C=L}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(_.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(c,g){const C=Math.min(c.x,g.x),S=Math.max(c.x,g.x),D=Math.min(c.y,g.y),L=Math.max(c.y,g.y);if(D<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const B=[new _.pointGeometry(C,D),new _.pointGeometry(S,L),new _.pointGeometry(C,L),new _.pointGeometry(S,D)],G=this.renderWorldCopies?-3:0,J=this.renderWorldCopies?4:1;for(const ee of B){const oe=this.pointRayIntersection(ee);if(oe.t<0)return!0;const de=this.rayIntersectionCoordinate(oe);if(de.x<G||de.y<0||de.x>J||de.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+_.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new _.pointGeometry(0,0),new _.pointGeometry(this.width,this.height))}zoomDeltaToMovement(c,g){const C=_.length(_.sub([],this._camera.position,c)),S=this._zoomFromMercatorZ(C)+g;return C-this._mercatorZfromZoom(S)}getCameraPoint(){if("globe"===this.projection.name){const c=function([g,C,S],D){const L=[g,C,S,1];_.transformMat4$1(L,L,D);const B=L[3]=Math.max(L[3],1e-6);return L[0]/=B,L[1]/=B,L[2]/=B,L}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new _.pointGeometry(c[0],c[1])}{const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new _.pointGeometry(0,c))}}getCameraToCenterDistance(c,g=this.zoom,C=this.worldSize){const S=Ol(c,g,this.width,this.height,1024),D=c.pixelSpaceConversion(this.center.lat,C,S);return.5/Math.tan(.5*this._fov)*this.height*D}getWorldToCameraMatrix(){const c=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&_.multiply(c,c,this.globeMatrix),c}}function or(v,c){let g=!1,C=null;const S=()=>{C=null,g&&(v(),C=setTimeout(S,c),g=!1)};return()=>(g=!0,C||S(),C)}class Md{constructor(c){this._hashName=c&&encodeURIComponent(c),_.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=or(this._updateHashUnthrottled.bind(this),300)}addTo(c){return this._map=c,_.window.addEventListener("hashchange",this._onHashChange,!1),c.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),_.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const c=this._map;if(!c)return"";const g=Aa(c);if(this._hashName){const C=this._hashName;let S=!1;const D=_.window.location.hash.slice(1).split("&").map(L=>{const B=L.split("=")[0];return B===C?(S=!0,`${B}=${g}`):L}).filter(L=>L);return S||D.push(`${C}=${g}`),`#${D.join("&")}`}return`#${g}`}_getCurrentHash(){const c=_.window.location.hash.replace("#","");if(this._hashName){let g;return c.split("&").map(C=>C.split("=")).forEach(C=>{C[0]===this._hashName&&(g=C)}),(g&&g[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._map;if(!c)return!1;const g=this._getCurrentHash();if(g.length>=3&&!g.some(C=>isNaN(C))){const C=c.dragRotate.isEnabled()&&c.touchZoomRotate.isEnabled()?+(g[3]||0):c.getBearing();return c.jumpTo({center:[+g[2],+g[1]],zoom:+g[0],bearing:C,pitch:+(g[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=_.window.location.href.replace(/(#.+)?$/,this.getHashString());_.window.history.replaceState(_.window.history.state,null,c)}}function Aa(v,c){const g=v.getCenter(),C=Math.round(100*v.getZoom())/100,S=Math.ceil((C*Math.LN2+Math.log(512/360/.5))/Math.LN10),D=Math.pow(10,S),L=Math.round(g.lng*D)/D,B=Math.round(g.lat*D)/D,G=v.getBearing(),J=v.getPitch();let ee=c?`/${L}/${B}/${C}`:`${C}/${B}/${L}`;return(G||J)&&(ee+="/"+Math.round(10*G)/10),J&&(ee+=`/${Math.round(J)}`),ee}const Yc={linearity:.3,easing:_.bezier(0,0,.3,1)},tl=_.extend({deceleration:2500,maxSpeed:1400},Yc),Dd=_.extend({deceleration:20,maxSpeed:1400},Yc),ph=_.extend({deceleration:1e3,maxSpeed:360},Yc),Kc=_.extend({deceleration:1e3,maxSpeed:90},Yc);class Xc{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:_.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,g=_.exported.now();for(;c.length>0&&g-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const g={zoom:0,bearing:0,pitch:0,pan:new _.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:D}of this._inertiaBuffer)g.zoom+=D.zoomDelta||0,g.bearing+=D.bearingDelta||0,g.pitch+=D.pitchDelta||0,D.panDelta&&g.pan._add(D.panDelta),D.around&&(g.around=D.around),D.pinchAround&&(g.pinchAround=D.pinchAround);const C=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(g.pan.mag()){const D=Ad(g.pan.mag(),C,_.extend({},tl,c||{}));S.offset=g.pan.mult(D.amount/g.pan.mag()),S.center=this._map.transform.center,Pa(S,D)}if(g.zoom){const D=Ad(g.zoom,C,Dd);S.zoom=this._map.transform.zoom+D.amount,Pa(S,D)}if(g.bearing){const D=Ad(g.bearing,C,ph);S.bearing=this._map.transform.bearing+_.clamp(D.amount,-179,179),Pa(S,D)}if(g.pitch){const D=Ad(g.pitch,C,Kc);S.pitch=this._map.transform.pitch+D.amount,Pa(S,D)}if(S.zoom||S.bearing){const D=void 0===g.pinchAround?g.around:g.pinchAround;S.around=D?this._map.unproject(D):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function Pa(v,c){(!v.duration||v.duration<c.duration)&&(v.duration=c.duration,v.easing=c.easing)}function Ad(v,c,g){const{maxSpeed:C,linearity:S,deceleration:D}=g,L=_.clamp(v*S/(c/1e3),-C,C),B=Math.abs(L)/(D*S);return{easing:g.easing,duration:1e3*B,amount:L*(B/2)}}class qr extends _.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,g,C,S={}){const D=Ye(g.getCanvasContainer(),C),L=g.unproject(D);super(c,_.extend({point:D,lngLat:L,originalEvent:C},S)),this._defaultPrevented=!1,this.target=g}}class Rl extends _.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,g,C){const S="touchend"===c?C.changedTouches:C.touches,D=Ft(g.getCanvasContainer(),S),L=D.map(G=>g.unproject(G)),B=D.reduce((G,J,ee,oe)=>G.add(J.div(oe.length)),new _.pointGeometry(0,0));super(c,{points:D,point:B,lngLats:L,lngLat:g.unproject(B),originalEvent:C}),this._defaultPrevented=!1}}class mh extends _.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,g,C){super(c,{originalEvent:C}),this._defaultPrevented=!1}}class ks{constructor(c,g){this._map=c,this._clickTolerance=g.clickTolerance}reset(){this._mousedownPos=void 0}wheel(c){return this._firePreventable(new mh(c.type,this._map,c))}mousedown(c,g){return this._mousedownPos=g,this._firePreventable(new qr(c.type,this._map,c))}mouseup(c){this._map.fire(new qr(c.type,this._map,c))}preclick(c){const g=_.extend({},c);g.type="preclick",this._map.fire(new qr(g.type,this._map,g))}click(c,g){this._mousedownPos&&this._mousedownPos.dist(g)>=this._clickTolerance||(this.preclick(c),this._map.fire(new qr(c.type,this._map,c)))}dblclick(c){return this._firePreventable(new qr(c.type,this._map,c))}mouseover(c){this._map.fire(new qr(c.type,this._map,c))}mouseout(c){this._map.fire(new qr(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Rl(c.type,this._map,c))}touchmove(c){this._map.fire(new Rl(c.type,this._map,c))}touchend(c){this._map.fire(new Rl(c.type,this._map,c))}touchcancel(c){this._map.fire(new Rl(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pd{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(c){this._map.fire(new qr(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new qr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new qr(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fl{constructor(c,g){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=g.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,g){this.isEnabled()&&c.shiftKey&&0===c.button&&(tn(),this._startPos=this._lastPos=g,this._active=!0)}mousemoveWindow(c,g){if(!this._active)return;const C=g,S=this._startPos,D=this._lastPos;if(!S||!D||D.equals(C)||!this._box&&C.dist(S)<this._clickTolerance)return;this._lastPos=C,this._box||(this._box=It("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const L=Math.min(S.x,C.x),B=Math.max(S.x,C.x),G=Math.min(S.y,C.y),J=Math.max(S.y,C.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${L}px,${G}px)`,this._box.style.width=B-L+"px",this._box.style.height=J-G+"px")})}mouseupWindow(c,g){if(!this._active)return;const C=this._startPos,S=g;if(C&&0===c.button){if(this.reset(),vt(),C.x!==S.x||C.y!==S.y)return this._map.fire(new _.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:D=>D.fitScreenCoordinates(C,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",c)}}keydown(c){this._active&&27===c.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",c))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),bn(),delete this._startPos,delete this._lastPos}_fireEvent(c,g){return this._map.fire(new _.Event(c,{originalEvent:g}))}}function Qc(v,c){const g={};for(let C=0;C<v.length;C++)g[v[C].identifier]=c[C];return g}class Od{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(c,g,C){(this.centroid||C.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=c.timeStamp),C.length===this.numTouches&&(this.centroid=function(S){const D=new _.pointGeometry(0,0);for(const L of S)D._add(L);return D.div(S.length)}(g),this.touches=Qc(C,g)))}touchmove(c,g,C){if(this.aborted||!this.centroid)return;const S=Qc(C,g);for(const D in this.touches){const B=S[D];(!B||B.dist(this.touches[D])>30)&&(this.aborted=!0)}}touchend(c,g,C){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),0===C.length){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Oa{constructor(c){this.singleTap=new Od(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(c,g,C){this.singleTap.touchstart(c,g,C)}touchmove(c,g,C){this.singleTap.touchmove(c,g,C)}touchend(c,g,C){const S=this.singleTap.touchend(c,g,C);if(S){const D=c.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(S)<30;if(D&&L||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class Bu{constructor(){this._zoomIn=new Oa({numTouches:1,numTaps:2}),this._zoomOut=new Oa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,g,C){this._zoomIn.touchstart(c,g,C),this._zoomOut.touchstart(c,g,C)}touchmove(c,g,C){this._zoomIn.touchmove(c,g,C),this._zoomOut.touchmove(c,g,C)}touchend(c,g,C){const S=this._zoomIn.touchend(c,g,C),D=this._zoomOut.touchend(c,g,C);return S?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()+1,around:L.unproject(S)},{originalEvent:c})}):D?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()-1,around:L.unproject(D)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Rp={0:1,2:2};class kd{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(c,g){return!1}_move(c,g){return{}}mousedown(c,g){if(this._lastPoint)return;const C=Jt(c);this._correctButton(c,C)&&(this._lastPoint=g,this._eventButton=C)}mousemoveWindow(c,g){const C=this._lastPoint;if(C)if(c.preventDefault(),null!=this._eventButton&&function(S,D){const L=Rp[D];return void 0===S.buttons||(S.buttons&L)!==L}(c,this._eventButton))this.reset();else if(this._moved||!(g.dist(C)<this._clickTolerance))return this._moved=!0,this._lastPoint=g,this._move(C,g)}mouseupWindow(c){this._lastPoint&&Jt(c)===this._eventButton&&(this._moved&&vt(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gh extends kd{mousedown(c,g){super.mousedown(c,g),this._lastPoint&&(this._active=!0)}_correctButton(c,g){return 0===g&&!c.ctrlKey}_move(c,g){return{around:g,panDelta:g.sub(c)}}}class _h extends kd{_correctButton(c,g){return 0===g&&c.ctrlKey||2===g}_move(c,g){const C=.8*(g.x-c.x);if(C)return this._active=!0,{bearingDelta:C}}contextmenu(c){c.preventDefault()}}class yh extends kd{_correctButton(c,g){return 0===g&&c.ctrlKey||2===g}_move(c,g){const C=-.5*(g.y-c.y);if(C)return this._active=!0,{pitchDelta:C}}contextmenu(c){c.preventDefault()}}class uc{constructor(c,g){this._map=c,this._el=c.getCanvasContainer(),this._minTouches=1,this._clickTolerance=g.clickTolerance||1,this.reset(),_.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new _.pointGeometry(0,0)}touchstart(c,g,C){return this._calculateTransform(c,g,C)}touchmove(c,g,C){if(this._active&&!(C.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===C.length&&!_.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return c.cancelable&&c.preventDefault(),this._calculateTransform(c,g,C)}}touchend(c,g,C){this._calculateTransform(c,g,C),this._active&&C.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,g,C){C.length>0&&(this._active=!0);const S=Qc(C,g),D=new _.pointGeometry(0,0),L=new _.pointGeometry(0,0);let B=0;for(const J in S){const ee=S[J],oe=this._touches[J];oe&&(D._add(ee),L._add(ee.sub(oe)),B++,S[J]=ee)}if(this._touches=S,B<this._minTouches||!L.mag())return;const G=L.div(B);return this._sum._add(G),this._sum.mag()<this._clickTolerance?void 0:{around:D.div(B),panDelta:G}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=It("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Vu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(c){}_move(c,g,C){return{}}touchstart(c,g,C){this._firstTwoTouches||C.length<2||(this._firstTwoTouches=[C[0].identifier,C[1].identifier],this._start([g[0],g[1]]))}touchmove(c,g,C){const S=this._firstTwoTouches;if(!S)return;c.preventDefault();const[D,L]=S,B=da(C,g,D),G=da(C,g,L);if(!B||!G)return;const J=this._aroundCenter?null:B.add(G).div(2);return this._move([B,G],J,c)}touchend(c,g,C){if(!this._firstTwoTouches)return;const[S,D]=this._firstTwoTouches,L=da(C,g,S),B=da(C,g,D);L&&B||(this._active&&vt(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function da(v,c,g){for(let C=0;C<v.length;C++)if(v[C].identifier===g)return c[C]}function bf(v,c){return Math.log(v/c)/Math.LN2}class xf extends Vu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,g){const C=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(bf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:bf(this._distance,C),pinchAround:g}}}function Rd(v,c){return 180*v.angleWith(c)/Math.PI}class Jc extends Vu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,g){const C=this._vector;if(this._vector=c[0].sub(c[1]),C&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Rd(this._vector,C),pinchAround:g}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const g=25/(Math.PI*this._minDiameter)*360,C=this._startVector;if(!C)return!1;const S=Rd(c,C);return Math.abs(S)<g}}function vh(v){return Math.abs(v.y)>Math.abs(v.x)}class Co extends Vu{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(c){this._lastPoints=c,vh(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,g,C){const S=this._lastPoints;if(!S)return;const D=c[0].sub(S[0]),L=c[1].sub(S[1]);return this._map._cooperativeGestures&&!_.isFullscreen()&&C.touches.length<3||(this._valid=this.gestureBeginsVertically(D,L,C.timeStamp),!this._valid)?void 0:(this._lastPoints=c,this._active=!0,{pitchDelta:(D.y+L.y)/2*-.5})}gestureBeginsVertically(c,g,C){if(void 0!==this._valid)return this._valid;const S=c.mag()>=2,D=g.mag()>=2;if(!S&&!D)return;if(!S||!D)return null==this._firstMove&&(this._firstMove=C),C-this._firstMove<100&&void 0;const L=c.y>0==g.y>0;return vh(c)&&vh(g)&&L}}const wf={panStep:100,bearingStep:15,pitchStep:10};class Cf{constructor(){const c=wf;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let g=0,C=0,S=0,D=0,L=0;switch(c.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:c.shiftKey?C=-1:(c.preventDefault(),D=-1);break;case 39:c.shiftKey?C=1:(c.preventDefault(),D=1);break;case 38:c.shiftKey?S=1:(c.preventDefault(),L=-1);break;case 40:c.shiftKey?S=-1:(c.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(C=0,S=0),{cameraAnimation:B=>{const G=B.getZoom();B.easeTo({duration:300,easeId:"keyboardHandler",easing:Ef,zoom:g?Math.round(G)+g*(c.shiftKey?2:1):G,bearing:B.getBearing()+C*this._bearingStep,pitch:B.getPitch()+S*this._pitchStep,offset:[-D*this._panStep,-L*this._panStep],center:B.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ef(v){return v*(2-v)}const eu=4.000244140625;class Rs{constructor(c,g){this._map=c,this._el=c.getCanvasContainer(),this._handler=g,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,_.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(c.ctrlKey||c.metaKey||this.isZooming()||_.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let g=c.deltaMode===_.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const C=_.exported.now(),S=C-(this._lastWheelEventTime||0);this._lastWheelEventTime=C,0!==g&&g%eu==0?this._type="wheel":0!==g&&Math.abs(g)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=g,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(S*g)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,g+=this._lastValue)),c.shiftKey&&g&&(g/=4),this._type&&(this._lastWheelEvent=c,this._delta-=g,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const g=Ye(this._el,c);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:g,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;"wheel"===this._type&&c.projection.wrap&&(c._center.lng>=180||c._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const g=()=>c._terrainEnabled()&&this._aroundCoord?c.computeZoomRelativeTo(this._aroundCoord):c.zoom;if(0!==this._delta){const G="wheel"===this._type&&Math.abs(this._delta)>eu?this._wheelZoomRate:this._defaultZoomRate;let J=2/(1+Math.exp(-Math.abs(this._delta*G)));this._delta<0&&0!==J&&(J=1/J);const ee=g(),oe=Math.pow(2,ee),de="number"==typeof this._targetZoom?c.zoomScale(this._targetZoom):oe;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(de*J))),"wheel"===this._type&&(this._startZoom=ee,this._easing=this._smoothOutEasing(200)),this._delta=0}const C="number"==typeof this._targetZoom?this._targetZoom:g(),S=this._startZoom,D=this._easing;let L,B=!1;if("wheel"===this._type&&S&&D){const G=Math.min((_.exported.now()-this._lastWheelEventTime)/200,1),J=D(G);L=_.number(S,C,J),G<1?this._frameId||(this._frameId=!0):B=!0}else L=C,B=!0;return this._active=!0,B&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!B,zoomDelta:L-g(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let g=_.ease;if(this._prevEase){const C=this._prevEase,S=(_.exported.now()-C.start)/C.duration,D=C.easing(S+.01)-C.easing(S),L=.27/Math.sqrt(D*D+1e-4)*.01,B=Math.sqrt(.0729-L*L);g=_.bezier(L,B,.25,1)}return this._prevEase={start:_.exported.now(),duration:c,easing:g},g}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=It("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(_.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Uu{constructor(c,g){this._clickZoom=c,this._tapZoom=g}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ka{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(c,g){return c.preventDefault(),{cameraAnimation:C=>{C.easeTo({duration:300,zoom:C.getZoom()+(c.shiftKey?-1:1),around:C.unproject(g)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nl{constructor(){this._tap=new Oa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(c,g,C){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?C.length>0&&(this._swipePoint=g[0],this._swipeTouch=C[0].identifier):this._tap.touchstart(c,g,C))}touchmove(c,g,C){if(this._tapTime){if(this._swipePoint){if(C[0].identifier!==this._swipeTouch)return;const S=g[0],D=S.y-this._swipePoint.y;return this._swipePoint=S,c.preventDefault(),this._active=!0,{zoomDelta:D/128}}}else this._tap.touchmove(c,g,C)}touchend(c,g,C){this._tapTime?this._swipePoint&&0===C.length&&this.reset():this._tap.touchend(c,g,C)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ju{constructor(c,g,C){this._el=c,this._mousePan=g,this._touchPan=C}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class mn{constructor(c,g,C){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=g,this._mousePitch=C}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Fp{constructor(c,g,C,S){this._el=c,this._touchZoom=g,this._touchRotate=C,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ha=v=>v.zoom||v.drag||v.pitch||v.rotate;class xr extends _.Event{}class $u{constructor(){this.constants=[1,1,.01],this.radius=0}setup(c,g){const C=_.sub([],g,c);this.radius=_.length(C[2]<0?_.div([],C,this.constants):[C[0],C[1],0])}projectRay(c){_.div(c,c,this.constants),_.normalize(c,c),_.mul$1(c,c,this.constants);const g=_.scale$2([],c,this.radius);if(g[2]>0){const C=_.scale$2([],[0,0,1],_.dot(g,[0,0,1])),S=_.scale$2([],_.normalize([],[g[0],g[1],0]),this.radius),D=_.add([],g,_.scale$2([],_.sub([],_.add([],S,C),g),2));g[0]=D[0],g[1]=D[1]}return g}}function Gu(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class bh{constructor(c,g){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Xc(c),this._bearingSnap=g.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new $u,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(g),_.bindAll(["handleEvent","handleWindowEvent"],this);const C=this._el;this._listeners=[[C,"touchstart",{passive:!0}],[C,"touchmove",{passive:!1}],[C,"touchend",void 0],[C,"touchcancel",void 0],[C,"mousedown",void 0],[C,"mousemove",void 0],[C,"mouseup",void 0],[_.window.document,"mousemove",{capture:!0}],[_.window.document,"mouseup",void 0],[C,"mouseover",void 0],[C,"mouseout",void 0],[C,"dblclick",void 0],[C,"click",void 0],[C,"keydown",{capture:!1}],[C,"keyup",void 0],[C,"wheel",{passive:!1}],[C,"contextmenu",void 0],[_.window,"blur",void 0]];for(const[S,D,L]of this._listeners)S.addEventListener(D,S===_.window.document?this.handleWindowEvent:this.handleEvent,L)}destroy(){for(const[c,g,C]of this._listeners)c.removeEventListener(g,c===_.window.document?this.handleWindowEvent:this.handleEvent,C)}_addDefaultHandlers(c){const g=this._map,C=g.getCanvasContainer();this._add("mapEvent",new ks(g,c));const S=g.boxZoom=new Fl(g,c);this._add("boxZoom",S);const D=new Bu,L=new ka;g.doubleClickZoom=new Uu(L,D),this._add("tapZoom",D),this._add("clickZoom",L);const B=new nl;this._add("tapDragZoom",B);const G=g.touchPitch=new Co(g);this._add("touchPitch",G);const J=new _h(c),ee=new yh(c);g.dragRotate=new mn(c,J,ee),this._add("mouseRotate",J,["mousePitch"]),this._add("mousePitch",ee,["mouseRotate"]);const oe=new gh(c),de=new uc(g,c);g.dragPan=new ju(C,oe,de),this._add("mousePan",oe),this._add("touchPan",de,["touchZoom","touchRotate"]);const ge=new Jc,ue=new xf;g.touchZoomRotate=new Fp(C,ue,ge,B),this._add("touchRotate",ge,["touchPan","touchZoom"]),this._add("touchZoom",ue,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Pd(g));const ye=g.scrollZoom=new Rs(g,this);this._add("scrollZoom",ye,["mousePan"]);const be=g.keyboard=new Cf;this._add("keyboard",be);for(const ce of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[ce]&&g[ce].enable(c[ce])}_add(c,g,C){this._handlers.push({handlerName:c,handler:g,allowed:C}),this._handlersById[c]=g}stop(c){if(!this._updatingCamera){for(const{handler:g}of this._handlers)g.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ha(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(c,g,C){for(const S in c)if(S!==C&&(!g||g.indexOf(S)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const g=[];for(const C of c)this._el.contains(C.target)&&g.push(C);return g}handleEvent(c,g){this._updatingCamera=!0;const C="renderFrame"===c.type,S=C?void 0:c,D={needsRenderFrame:!1},L={},B={},G=c.touches?this._getMapTouches(c.touches):void 0,J=G?Ft(this._el,G):C?void 0:Ye(this._el,c);for(const{handlerName:de,handler:ge,allowed:ue}of this._handlers){if(!ge.isEnabled())continue;let ye;this._blockedByActive(B,ue,de)?ge.reset():ge[g||c.type]&&(ye=ge[g||c.type](c,J,G),this.mergeHandlerResult(D,L,ye,de,S),ye&&ye.needsRenderFrame&&this._triggerRenderFrame()),(ye||ge.isActive())&&(B[de]=ge)}const ee={};for(const de in this._previousActiveHandlers)B[de]||(ee[de]=S);this._previousActiveHandlers=B,(Object.keys(ee).length||Gu(D))&&(this._changes.push([D,L,ee]),this._triggerRenderFrame()),(Object.keys(B).length||Gu(D))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:oe}=D;oe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],oe(this._map))}mergeHandlerResult(c,g,C,S,D){if(!C)return;_.extend(c,C);const L={handlerName:S,originalEvent:C.originalEvent||D};void 0!==C.zoomDelta&&(g.zoom=L),void 0!==C.panDelta&&(g.drag=L),void 0!==C.pitchDelta&&(g.pitch=L),void 0!==C.bearingDelta&&(g.rotate=L)}_applyChanges(){const c={},g={},C={};for(const[S,D,L]of this._changes)S.panDelta&&(c.panDelta=(c.panDelta||new _.pointGeometry(0,0))._add(S.panDelta)),S.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+S.pitchDelta),void 0!==S.around&&(c.around=S.around),void 0!==S.aroundCoord&&(c.aroundCoord=S.aroundCoord),void 0!==S.pinchAround&&(c.pinchAround=S.pinchAround),S.noInertia&&(c.noInertia=S.noInertia),_.extend(g,D),_.extend(C,L);this._updateMapTransform(c,g,C),this._changes=[]}_updateMapTransform(c,g,C){const S=this._map,D=S.transform,L=Te=>[Te.x,Te.y,Te.z];if((Te=>{const ve=this._eventsInProgress.drag;return ve&&!this._handlersById[ve.handlerName].isActive()})()&&!Gu(c)){const Te=D.zoom;D.cameraElevationReference="sea",D.recenterOnTerrain(),D.cameraElevationReference="ground",Te!==D.zoom&&this._map._update(!0)}if(D._isCameraConstrained&&S._stop(!0),!Gu(c))return void this._fireEvents(g,C,!0);let{panDelta:B,zoomDelta:G,bearingDelta:J,pitchDelta:ee,around:oe,aroundCoord:de,pinchAround:ge}=c;D._isCameraConstrained&&(G>0&&(G=0),D._isCameraConstrained=!1),void 0!==ge&&(oe=ge),(G||(Te=>g.drag&&!this._eventsInProgress.drag)())&&oe&&(this._dragOrigin=L(D.pointCoordinate3D(oe)),this._trackingEllipsoid.setup(D._camera.position,this._dragOrigin)),D.cameraElevationReference="sea",S._stop(!0),oe=oe||S.transform.centerPoint,J&&(D.bearing+=J),ee&&(D.pitch+=ee),D._updateCameraState();const ue=[0,0,0];if(B)if("mercator"===D.projection.name){const Te=this._trackingEllipsoid.projectRay(D.screenPointToMercatorRay(oe).dir),ve=this._trackingEllipsoid.projectRay(D.screenPointToMercatorRay(oe.sub(B)).dir);ue[0]=ve[0]-Te[0],ue[1]=ve[1]-Te[1]}else{const Te=D.pointCoordinate(oe);if("globe"===D.projection.name){B=B.rotate(-D.angle);const ve=D._pixelsPerMercatorPixel/D.worldSize;ue[0]=-B.x*_.mercatorScale(_.latFromMercatorY(Te.y))*ve,ue[1]=-B.y*_.mercatorScale(D.center.lat)*ve}else{const ve=D.pointCoordinate(oe.sub(B));Te&&ve&&(ue[0]=ve.x-Te.x,ue[1]=ve.y-Te.y)}}const ye=D.zoom,be=[0,0,0];if(G){const Te=L(de||D.pointCoordinate3D(oe)),ve={dir:_.normalize([],_.sub([],Te,D._camera.position))};if(ve.dir[2]<0){const De=D.zoomDeltaToMovement(Te,G);_.scale$2(be,ve.dir,De)}}const ce=_.add(ue,ue,be);D._translateCameraConstrained(ce),G&&Math.abs(D.zoom-ye)>1e-4&&D.recenterOnTerrain(),D.cameraElevationReference="ground",this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(g,C,!0)}_fireEvents(c,g,C){const S=ha(this._eventsInProgress),D=ha(c),L={};for(const ee in c){const{originalEvent:oe}=c[ee];this._eventsInProgress[ee]||(L[`${ee}start`]=oe),this._eventsInProgress[ee]=c[ee]}!S&&D&&this._fireEvent("movestart",D.originalEvent);for(const ee in L)this._fireEvent(ee,L[ee]);D&&this._fireEvent("move",D.originalEvent);for(const ee in c){const{originalEvent:oe}=c[ee];this._fireEvent(ee,oe)}const B={};let G;for(const ee in this._eventsInProgress){const{handlerName:oe,originalEvent:de}=this._eventsInProgress[ee];this._handlersById[oe].isActive()||(delete this._eventsInProgress[ee],G=g[oe]||de,B[`${ee}end`]=G)}for(const ee in B)this._fireEvent(ee,B[ee]);const J=ha(this._eventsInProgress);if(C&&(S||D)&&!J){this._updatingCamera=!0;const ee=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),oe=de=>0!==de&&-this._bearingSnap<de&&de<this._bearingSnap;ee?(oe(ee.bearing||this._map.getBearing())&&(ee.bearing=0),this._map.easeTo(ee,{originalEvent:G})):(this._map.fire(new _.Event("moveend",{originalEvent:G})),oe(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,g){this._map.fire(new _.Event(c,g?{originalEvent:g}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{this._frameId=void 0,this.handleEvent(new xr("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Wm="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Lp extends _.Evented{constructor(c,g){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=g.bearingSnap,_.bindAll(["_renderFrameCallback"],this)}getCenter(){return new _.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,g){return this.jumpTo({center:c},g)}panBy(c,g,C){return c=_.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,_.extend({offset:c},g),C)}panTo(c,g,C){return this.easeTo(_.extend({center:c},g),C)}getZoom(){return this.transform.zoom}setZoom(c,g){return this.jumpTo({zoom:c},g),this}zoomTo(c,g,C){return this.easeTo(_.extend({zoom:c},g),C)}zoomIn(c,g){return this.zoomTo(this.getZoom()+1,c,g),this}zoomOut(c,g){return this.zoomTo(this.getZoom()-1,c,g),this}getBearing(){return this.transform.bearing}setBearing(c,g){return this.jumpTo({bearing:c},g),this}getPadding(){return this.transform.padding}setPadding(c,g){return this.jumpTo({padding:c},g),this}rotateTo(c,g,C){return this.easeTo(_.extend({bearing:c},g),C)}resetNorth(c,g){return this.rotateTo(0,_.extend({duration:1e3},c),g),this}resetNorthPitch(c,g){return this.easeTo(_.extend({bearing:0,pitch:0,duration:1e3},c),g),this}snapToNorth(c,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,g):this}getPitch(){return this.transform.pitch}setPitch(c,g){return this.jumpTo({pitch:c},g),this}cameraForBounds(c,g){c=_.LngLatBounds.convert(c);const C=g&&g.bearing||0,S=g&&g.pitch||0,D=c.getNorthWest(),L=c.getSouthEast();return this._cameraForBounds(this.transform,D,L,C,S,g)}_extendCameraOptions(c){const g={top:0,bottom:0,right:0,left:0};if("number"==typeof(c=_.extend({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding){const C=c.padding;c.padding={top:C,bottom:C,right:C,left:C}}return c.padding=_.extend(g,c.padding),c}_minimumAABBFrustumDistance(c,g){const C=g.max[0]-g.min[0],S=g.max[1]-g.min[1];return C/S>c.aspect?C/(2*Math.tan(.5*c.fovX)*c.aspect):S/(2*Math.tan(.5*c.fovY)*c.aspect)}_cameraForBoundsOnGlobe(c,g,C,S,D,L){const B=c.clone(),G=this._extendCameraOptions(L);B.bearing=S,B.pitch=D;const J=_.LngLat.convert(g),ee=_.LngLat.convert(C),oe=.5*(J.lat+ee.lat),de=.5*(J.lng+ee.lng),ge=_.latLngToECEF(oe,de),ue=_.normalize([],ge),ye=_.normalize([],_.cross([],ue,[0,1,0])),be=_.cross([],ye,ue),ce=[ye[0],ye[1],ye[2],0,be[0],be[1],be[2],0,ue[0],ue[1],ue[2],0,0,0,0,1],Te=[ge,_.latLngToECEF(J.lat,J.lng),_.latLngToECEF(ee.lat,J.lng),_.latLngToECEF(ee.lat,ee.lng),_.latLngToECEF(J.lat,ee.lng),_.latLngToECEF(oe,J.lng),_.latLngToECEF(oe,ee.lng),_.latLngToECEF(J.lat,de),_.latLngToECEF(ee.lat,de)];let ve=_.Aabb.fromPoints(Te.map(Mt=>[_.dot(ye,Mt),_.dot(be,Mt),_.dot(ue,Mt)]));const De=_.transformMat4([],ve.center,ce);0===_.squaredLength(De)&&_.set(De,0,0,1),_.normalize(De,De),_.scale$2(De,De,_.GLOBE_RADIUS),B.center=_.ecefToLatLng(De);const Fe=B.getWorldToCameraMatrix(),Re=_.invert(new Float64Array(16),Fe);ve=_.Aabb.applyTransform(ve,_.multiply([],Fe,ce)),_.transformMat4(De,De,Fe);const Ue=.5*(ve.max[2]-ve.min[2]),Ze=this._minimumAABBFrustumDistance(B,ve),nt=_.scale$2([],[0,0,1],Ue),ot=_.add(nt,De,nt),Ut=Ze+(0===B.pitch?0:_.distance(De,ot)),Qe=B.globeCenterInViewSpace,St=_.sub([],De,[Qe[0],Qe[1],Qe[2]]);_.normalize(St,St),_.scale$2(St,St,Ut);const at=_.add([],De,St);_.transformMat4(at,at,Re);const Ot=_.earthRadius/_.GLOBE_RADIUS,et=_.length(at),qe=_.mercatorZfromAltitude(Math.max(et*Ot-_.earthRadius,Number.EPSILON),0),Xe=Math.min(B.zoomFromMercatorZAdjusted(qe),G.maxZoom);return Xe>.5*(_.GLOBE_ZOOM_THRESHOLD_MIN+_.GLOBE_ZOOM_THRESHOLD_MAX)?(B.setProjection({name:"mercator"}),B.zoom=Xe,this._cameraForBounds(B,g,C,S,D,L)):{center:B.center,zoom:Xe,bearing:S,pitch:D}}queryTerrainElevation(c,g){const C=this.transform.elevation;return C?(g=_.extend({},{exaggerated:!0},g),C.getAtPoint(_.MercatorCoordinate.fromLngLat(c),null,g.exaggerated)):null}_cameraForBounds(c,g,C,S,D,L){if("globe"===c.projection.name)return this._cameraForBoundsOnGlobe(c,g,C,S,D,L);const B=c.clone(),G=this._extendCameraOptions(L),J=B.padding;B.bearing=S,B.pitch=D;const ee=_.LngLat.convert(g),oe=_.LngLat.convert(C),de=new _.LngLat(ee.lng,oe.lat),ge=new _.LngLat(oe.lng,ee.lat),ue=B.project(ee),ye=B.project(oe),be=this.queryTerrainElevation(ee),ce=this.queryTerrainElevation(oe),Te=this.queryTerrainElevation(de),ve=this.queryTerrainElevation(ge),De=[[ue.x,ue.y,Math.min(be||0,ce||0,Te||0,ve||0)],[ye.x,ye.y,Math.max(be||0,ce||0,Te||0,ve||0)]];let Fe=_.Aabb.fromPoints(De);const Re=B.getWorldToCameraMatrix(),Ue=_.invert(new Float64Array(16),Re);Fe=_.Aabb.applyTransform(Fe,Re);const Ze=_.sub([],Fe.max,Fe.min),nt=J.left||0,ot=J.right||0,Ut=J.bottom||0,Qe=J.top||0,{left:St,right:at,top:Ot,bottom:et}=G.padding,qe=.5*(nt+ot),Xe=.5*(Qe+Ut),Mt=Math.min(B.scaleZoom(B.scale*Math.min((B.width-(nt+ot+St+at))/Ze[0],(B.height-(Ut+Qe+et+Ot))/Ze[1])),G.maxZoom),Lt=B.scale/B.zoomScale(Mt);Fe=new _.Aabb([Fe.min[0]-(St+qe)*Lt,Fe.min[1]-(et+Xe)*Lt,Fe.min[2]],[Fe.max[0]+(at+qe)*Lt,Fe.max[1]+(Ot+Xe)*Lt,Fe.max[2]]);const dn=.5*Ze[2],Yn=this._minimumAABBFrustumDistance(B,Fe),gn=[0,0,1,0];_.transformMat4$1(gn,gn,Re),_.normalize$2(gn,gn);const Yt=_.scale$2([],gn,Yn+dn),yn=_.add([],Fe.center,Yt),xi=("number"==typeof G.offset.x&&"number"==typeof G.offset.y?new _.pointGeometry(G.offset.x,G.offset.y):_.pointGeometry.convert(G.offset)).rotate(-_.degToRad(S));Fe.center[0]-=xi.x*Lt,Fe.center[1]+=xi.y*Lt,_.transformMat4(Fe.center,Fe.center,Ue),_.transformMat4(yn,yn,Ue);const Bn=[Fe.center[0],Fe.center[1],yn[2]*B.pixelsPerMeter];_.scale$2(Bn,Bn,1/B.worldSize);const er=_.lngFromMercatorX(Bn[0]),Fi=_.latFromMercatorY(Bn[1]),sr=Math.min(B._zoomFromMercatorZ(Bn[2]),G.maxZoom),vi=new _.LngLat(er,Fi);return B.mercatorFromTransition&&sr<.5*(_.GLOBE_ZOOM_THRESHOLD_MIN+_.GLOBE_ZOOM_THRESHOLD_MAX)?(B.setProjection({name:"globe"}),B.zoom=sr,this._cameraForBounds(B,g,C,S,D,L)):{center:vi,zoom:sr,bearing:S,pitch:D}}fitBounds(c,g,C){const S=this.cameraForBounds(c,g);return this._fitInternal(S,g,C)}fitScreenCoordinates(c,g,C,S,D){const L=_.pointGeometry.convert(c),B=_.pointGeometry.convert(g),G=new _.pointGeometry(Math.min(L.x,B.x),Math.min(L.y,B.y)),J=new _.pointGeometry(Math.max(L.x,B.x),Math.max(L.y,B.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(L,B))return this;const ee=this.transform.pointLocation3D(G),oe=this.transform.pointLocation3D(J),de=this.transform.pointLocation3D(new _.pointGeometry(G.x,J.y)),ge=this.transform.pointLocation3D(new _.pointGeometry(J.x,G.y)),ue=[Math.min(ee.lng,oe.lng,de.lng,ge.lng),Math.min(ee.lat,oe.lat,de.lat,ge.lat)],ye=[Math.max(ee.lng,oe.lng,de.lng,ge.lng),Math.max(ee.lat,oe.lat,de.lat,ge.lat)],be=S&&S.pitch?S.pitch:this.getPitch(),ce=this._cameraForBounds(this.transform,ue,ye,C,be,S);return this._fitInternal(ce,S,D)}_fitInternal(c,g,C){return c?(delete(g=_.extend(c,g)).padding,g.linear?this.easeTo(g,C):this.flyTo(g,C)):this}jumpTo(c,g){this.stop();const C=c.preloadOnly?this.transform.clone():this.transform;let S=!1,D=!1,L=!1;return"zoom"in c&&C.zoom!==+c.zoom&&(S=!0,C.zoom=+c.zoom),void 0!==c.center&&(C.center=_.LngLat.convert(c.center)),"bearing"in c&&C.bearing!==+c.bearing&&(D=!0,C.bearing=+c.bearing),"pitch"in c&&C.pitch!==+c.pitch&&(L=!0,C.pitch=+c.pitch),null==c.padding||C.isPaddingEqual(c.padding)||(C.padding=c.padding),c.preloadOnly?(this._preloadTiles(C),this):(this.fire(new _.Event("movestart",g)).fire(new _.Event("move",g)),S&&this.fire(new _.Event("zoomstart",g)).fire(new _.Event("zoom",g)).fire(new _.Event("zoomend",g)),D&&this.fire(new _.Event("rotatestart",g)).fire(new _.Event("rotate",g)).fire(new _.Event("rotateend",g)),L&&this.fire(new _.Event("pitchstart",g)).fire(new _.Event("pitch",g)).fire(new _.Event("pitchend",g)),this.fire(new _.Event("moveend",g)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||_.warnOnce(Wm),this.transform.getFreeCameraOptions()}setFreeCameraOptions(c,g){const C=this.transform;if(!C.projection.supportsFreeCamera)return _.warnOnce(Wm),this;this.stop();const S=C.zoom,D=C.pitch,L=C.bearing;C.setFreeCameraOptions(c);const B=S!==C.zoom,G=D!==C.pitch,J=L!==C.bearing;return this.fire(new _.Event("movestart",g)).fire(new _.Event("move",g)),B&&this.fire(new _.Event("zoomstart",g)).fire(new _.Event("zoom",g)).fire(new _.Event("zoomend",g)),J&&this.fire(new _.Event("rotatestart",g)).fire(new _.Event("rotate",g)).fire(new _.Event("rotateend",g)),G&&this.fire(new _.Event("pitchstart",g)).fire(new _.Event("pitch",g)).fire(new _.Event("pitchend",g)),this.fire(new _.Event("moveend",g)),this}easeTo(c,g){this._stop(!1,c.easeId),(!1===(c=_.extend({offset:[0,0],duration:500,easing:_.ease},c)).animate||!c.essential&&_.exported.prefersReducedMotion)&&(c.duration=0);const C=this.transform,S=this.getZoom(),D=this.getBearing(),L=this.getPitch(),B=this.getPadding(),G="zoom"in c?+c.zoom:S,J="bearing"in c?this._normalizeBearing(c.bearing,D):D,ee="pitch"in c?+c.pitch:L,oe="padding"in c?c.padding:C.padding,de=_.pointGeometry.convert(c.offset);let ge,ue,ye;if("globe"===C.projection.name){const nt=_.MercatorCoordinate.fromLngLat(C.center),ot=de.rotate(-C.angle);nt.x+=ot.x/C.worldSize,nt.y+=ot.y/C.worldSize;const Ut=nt.toLngLat(),Qe=_.LngLat.convert(c.center||Ut);this._normalizeCenter(Qe),ge=C.centerPoint.add(ot),ue=new _.pointGeometry(nt.x,nt.y).mult(C.worldSize),ye=new _.pointGeometry(_.mercatorXfromLng(Qe.lng),_.mercatorYfromLat(Qe.lat)).mult(C.worldSize).sub(ue)}else{ge=C.centerPoint.add(de);const nt=C.pointLocation(ge),ot=_.LngLat.convert(c.center||nt);this._normalizeCenter(ot),ue=C.project(nt),ye=C.project(ot).sub(ue)}const be=C.zoomScale(G-S);let ce,Te;c.around&&(ce=_.LngLat.convert(c.around),Te=C.locationPoint(ce));const ve=this._zooming||G!==S,De=this._rotating||D!==J,Fe=this._pitching||ee!==L,Re=!C.isPaddingEqual(oe),Ue=nt=>ot=>{if(ve&&(nt.zoom=_.number(S,G,ot)),De&&(nt.bearing=_.number(D,J,ot)),Fe&&(nt.pitch=_.number(L,ee,ot)),Re&&(nt.interpolatePadding(B,oe,ot),ge=nt.centerPoint.add(de)),ce)nt.setLocationAtPoint(ce,Te);else{const Ut=nt.zoomScale(nt.zoom-S),Qe=G>S?Math.min(2,be):Math.max(.5,be),St=Math.pow(Qe,1-ot),at=nt.unproject(ue.add(ye.mult(ot*St)).mult(Ut));nt.setLocationAtPoint(nt.renderWorldCopies?at.wrap():at,ge)}return c.preloadOnly||this._fireMoveEvents(g),nt};if(c.preloadOnly){const nt=this._emulate(Ue,c.duration,C);return this._preloadTiles(nt),this}const Ze={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ve,this._rotating=De,this._pitching=Fe,this._padding=Re,this._easeId=c.easeId,this._prepareEase(g,c.noMoveStart,Ze),this._ease(Ue(C),nt=>{C.recenterOnTerrain(),this._afterEase(g,nt)},c),this}_prepareEase(c,g,C={}){this._moving=!0,this.transform.cameraElevationReference="sea",g||C.moving||this.fire(new _.Event("movestart",c)),this._zooming&&!C.zooming&&this.fire(new _.Event("zoomstart",c)),this._rotating&&!C.rotating&&this.fire(new _.Event("rotatestart",c)),this._pitching&&!C.pitching&&this.fire(new _.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new _.Event("move",c)),this._zooming&&this.fire(new _.Event("zoom",c)),this._rotating&&this.fire(new _.Event("rotate",c)),this._pitching&&this.fire(new _.Event("pitch",c))}_afterEase(c,g){if(this._easeId&&g&&this._easeId===g)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const C=this._zooming,S=this._rotating,D=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,C&&this.fire(new _.Event("zoomend",c)),S&&this.fire(new _.Event("rotateend",c)),D&&this.fire(new _.Event("pitchend",c)),this.fire(new _.Event("moveend",c))}flyTo(c,g){if(!c.essential&&_.exported.prefersReducedMotion){const Mt=_.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Mt,g)}this.stop(),c=_.extend({offset:[0,0],speed:1.2,curve:1.42,easing:_.ease},c);const C=this.transform,S=this.getZoom(),D=this.getBearing(),L=this.getPitch(),B=this.getPadding(),G="zoom"in c?_.clamp(+c.zoom,C.minZoom,C.maxZoom):S,J="bearing"in c?this._normalizeBearing(c.bearing,D):D,ee="pitch"in c?+c.pitch:L,oe="padding"in c?c.padding:C.padding,de=C.zoomScale(G-S),ge=_.pointGeometry.convert(c.offset);let ue=C.centerPoint.add(ge);const ye=C.pointLocation(ue),be=_.LngLat.convert(c.center||ye);this._normalizeCenter(be);const ce=C.project(ye),Te=C.project(be).sub(ce);let ve=c.curve;const De=Math.max(C.width,C.height),Fe=De/de,Re=Te.mag();if("minZoom"in c){const Mt=_.clamp(Math.min(c.minZoom,S,G),C.minZoom,C.maxZoom),Lt=De/C.zoomScale(Mt-S);ve=Math.sqrt(Lt/Re*2)}const Ue=ve*ve;function Ze(Mt){const Lt=(Fe*Fe-De*De+(Mt?-1:1)*Ue*Ue*Re*Re)/(2*(Mt?Fe:De)*Ue*Re);return Math.log(Math.sqrt(Lt*Lt+1)-Lt)}function nt(Mt){return(Math.exp(Mt)-Math.exp(-Mt))/2}function ot(Mt){return(Math.exp(Mt)+Math.exp(-Mt))/2}const Ut=Ze(0);let Qe=function(Mt){return ot(Ut)/ot(Ut+ve*Mt)},St=function(Mt){return De*((ot(Ut)*(nt(Lt=Ut+ve*Mt)/ot(Lt))-nt(Ut))/Ue)/Re;var Lt},at=(Ze(1)-Ut)/ve;if(Math.abs(Re)<1e-6||!isFinite(at)){if(Math.abs(De-Fe)<1e-6)return this.easeTo(c,g);const Mt=Fe<De?-1:1;at=Math.abs(Math.log(Fe/De))/ve,St=function(){return 0},Qe=function(Lt){return Math.exp(Mt*ve*Lt)}}c.duration="duration"in c?+c.duration:1e3*at/("screenSpeed"in c?+c.screenSpeed/ve:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0);const Ot=D!==J,et=ee!==L,qe=!C.isPaddingEqual(oe),Xe=Mt=>Lt=>{const dn=Lt*at,Yn=1/Qe(dn);Mt.zoom=1===Lt?G:S+Mt.scaleZoom(Yn),Ot&&(Mt.bearing=_.number(D,J,Lt)),et&&(Mt.pitch=_.number(L,ee,Lt)),qe&&(Mt.interpolatePadding(B,oe,Lt),ue=Mt.centerPoint.add(ge));const gn=1===Lt?be:Mt.unproject(ce.add(Te.mult(St(dn))).mult(Yn));return Mt.setLocationAtPoint(Mt.renderWorldCopies?gn.wrap():gn,ue),Mt._updateCameraOnTerrain(),c.preloadOnly||this._fireMoveEvents(g),Mt};if(c.preloadOnly){const Mt=this._emulate(Xe,c.duration,C);return this._preloadTiles(Mt),this}return this._zooming=!0,this._rotating=Ot,this._pitching=et,this._padding=qe,this._prepareEase(g,!1),this._ease(Xe(C),()=>this._afterEase(g),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const C=this._onEaseEnd;this._onEaseEnd=void 0,C.call(this,g)}if(!c){const C=this.handlers;C&&C.stop(!1)}return this}_ease(c,g,C){!1===C.animate||0===C.duration?(c(1),g()):(this._easeStart=_.exported.now(),this._easeOptions=C,this._onEaseFrame=c,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((_.exported.now()-this._easeStart)/this._easeOptions.duration,1),g=this._onEaseFrame;g&&g(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,g){c=_.wrap(c,-180,180);const C=Math.abs(c-g);return Math.abs(c-360-g)<C&&(c-=360),Math.abs(c+360-g)<C&&(c+=360),c}_normalizeCenter(c){const g=this.transform;if(!g.renderWorldCopies||g.maxBounds)return;const C=c.lng-g.center.lng;c.lng+=C>180?-360:C<-180?360:0}_emulate(c,g,C){const S=Math.ceil(15*g/1e3),D=[],L=c(C.clone());for(let B=0;B<=S;B++){const G=L(B/S);D.push(G.clone())}return D}}class Zm{constructor(c={}){this.options=c,_.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){const g=this.options&&this.options.compact;return this._map=c,this._container=It("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=It("button","mapboxgl-ctrl-attrib-button",this._container),It("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=It("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),g&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===g&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(c,g){const C=this._map._getUIString(`AttributionControl.${g}`);c.setAttribute("aria-label",C),c.removeAttribute("title"),c.firstElementChild&&c.firstElementChild.setAttribute("title",C)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));const g=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||_.config.ACCESS_TOKEN}];if(c){const C=g.reduce((S,D,L)=>(D.value&&(S+=`${D.key}=${D.value}${L<g.length-1?"&":""}`),S),"?");c.href=`${_.config.FEEDBACK_URL}/${C}#${Aa(this._map,!0)}`,c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}}_updateData(c){!c||"metadata"!==c.sourceDataType&&"visibility"!==c.sourceDataType&&"style"!==c.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let c=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const g=this._map.style._sourceCaches;for(const S in g){const D=g[S];if(D.used){const L=D.getSource();L.attribution&&c.indexOf(L.attribution)<0&&c.push(L.attribution)}}c.sort((S,D)=>S.length-D.length),c=c.filter((S,D)=>{for(let L=D+1;L<c.length;L++)if(c[L].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=[...this.options.customAttribution,...c]:c.unshift(this.options.customAttribution));const C=c.join(" | ");C!==this._attribHTML&&(this._attribHTML=C,c.length?(this._innerContainer.innerHTML=C,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class xh{constructor(){_.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(c){this._map=c,this._container=It("div","mapboxgl-ctrl");const g=It("a","mapboxgl-ctrl-logo");return g.target="_blank",g.rel="noopener nofollow",g.href="https://www.mapbox.com/",g.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),g.setAttribute("rel","noopener nofollow"),this._container.appendChild(g),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(c){c&&"metadata"!==c.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const c=this._map.style._sourceCaches;if(0===Object.entries(c).length)return!0;for(const g in c){const C=c[g].getSource();if(C.hasOwnProperty("mapbox_logo")&&!C.mapbox_logo)return!1}return!0}_updateCompact(){const c=this._container.children;if(c.length){const g=c[0];this._map.getCanvasContainer().offsetWidth<250?g.classList.add("mapboxgl-compact"):g.classList.remove("mapboxgl-compact")}}}class Ra{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const g=++this._id;return this._queue.push({callback:c,id:g,cancelled:!1}),g}remove(c){const g=this._currentlyRunning,C=g?this._queue.concat(g):this._queue;for(const S of C)if(S.id===c)return void(S.cancelled=!0)}run(c=0){const g=this._currentlyRunning=this._queue;this._queue=[];for(const C of g)if(!C.cancelled&&(C.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function wh(v,c,g){if(v=new _.LngLat(v.lng,v.lat),c){const C=new _.LngLat(v.lng-360,v.lat),S=new _.LngLat(v.lng+360,v.lat),D=360*Math.ceil(Math.abs(v.lng-g.center.lng)/360),L=g.locationPoint(v).distSqr(c),B=c.x<0||c.y<0||c.x>g.width||c.y>g.height;g.locationPoint(C).distSqr(c)<L&&(B||Math.abs(C.lng-g.center.lng)<D)?v=C:g.locationPoint(S).distSqr(c)<L&&(B||Math.abs(S.lng-g.center.lng)<D)&&(v=S)}for(;Math.abs(v.lng-g.center.lng)>180;){const C=g.locationPoint(v);if(C.x>=0&&C.y>=0&&C.x<=g.width&&C.y<=g.height)break;v.lng>g.center.lng?v.lng-=360:v.lng+=360}return v}const Ch={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class no extends _.Evented{constructor(c,g){if(super(),(c instanceof _.window.HTMLElement||g)&&(c=_.extend({element:c},g)),_.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=c&&c.occludedOpacity||.2,c&&c.element)this._element=c.element,this._offset=_.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=It("div");const S=41,D=27,L=Ve("svg",{display:"block",height:S*this._scale+"px",width:D*this._scale+"px",viewBox:`0 0 ${D} ${S}`},this._element),B=Ve("radialGradient",{id:"shadowGradient"},Ve("defs",{},L));Ve("stop",{offset:"10%","stop-opacity":.4},B),Ve("stop",{offset:"100%","stop-opacity":.05},B),Ve("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},L),Ve("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},L),Ve("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},L),Ve("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},L),this._offset=_.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const C=this._element.classList;for(const S in Ch)C.remove(`mapboxgl-marker-anchor-${S}`);C.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(c){return c===this._map||(this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._updateMoving),c.on("moveend",this._update),c.on("remove",this._clearFadeTimer),c._addMarker(this),this.setDraggable(this._draggable),this._update(),c.on("click",this._onMapClick)),this}remove(){const c=this._map;return c&&(c.off("click",this._onMapClick),c.off("move",this._updateMoving),c.off("moveend",this._update),c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler),c.off("mouseup",this._onUp),c.off("touchend",this._onUp),c.off("mousemove",this._onMove),c.off("touchmove",this._onMove),c.off("remove",this._clearFadeTimer),c._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=_.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(24.6+S)],"bottom-right":[-S,-1*(24.6+S)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=c,c._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(c){const g=c.code,C=c.charCode||c.keyCode;"Space"!==g&&"Enter"!==g&&32!==C&&13!==C||this.togglePopup()}_onMapClick(c){const g=c.originalEvent.target,C=this._element;this._popup&&(g===C||C.contains(g))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?(c.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(c.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const c=this._map,g=this._pos;if(!c||!g)return!1;const C=c.unproject(g),S=c.getFreeCameraOptions();if(!S.position)return!1;const D=S.position.toLngLat();return D.distanceTo(C)<.9*D.distanceTo(this._lngLat)}_evaluateOpacity(){const c=this._map;if(!c)return;const g=this._pos;if(!g||g.x<0||g.x>c.transform.width||g.y<0||g.y>c.transform.height)return void this._clearFadeTimer();const C=c.unproject(g);let S;c._showingGlobe()&&_.isLngLatBehindGlobe(c.transform,this._lngLat)?S=0:(S=1-c._queryFogOpacity(C),c.transform._terrainEnabled()&&c.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const c=this._pos;if(!c||!this._map)return;const g=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${c.x}px,${c.y}px)\n            ${Ch[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${g.x}px,${g.y}px)\n        `}_calculateXYTransform(){const c=this._pos,g=this._map,C=this.getPitchAlignment();if(!g||!c||"map"!==C)return"";if(!g._showingGlobe()){const G=g.getPitch();return G?`rotateX(${G}deg)`:""}const S=_.radToDeg(_.globeTiltAtLngLat(g.transform,this._lngLat)),D=c.sub(_.globeCenterToScreenPoint(g.transform)),L=Math.abs(D.x)+Math.abs(D.y);if(0===L)return"";const B=S/L;return`rotateX(${-D.y*B}deg) rotateY(${D.x*B}deg)`}_calculateZTransform(){const c=this._pos,g=this._map;if(!g||!c)return"";let C=0;const S=this.getRotationAlignment();if("map"===S)if(g._showingGlobe()){const D=g.project(new _.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),L=g.project(new _.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(D);C=_.radToDeg(Math.atan2(L.y,L.x))-90}else C=-g.getBearing();else if("horizon"===S){const D=_.smoothstep(4,6,g.getZoom()),L=_.globeCenterToScreenPoint(g.transform);L.y+=D*g.transform.height;const B=c.sub(L),G=_.radToDeg(Math.atan2(B.y,B.x));C=(G>90?G-270:G+90)*(1-D)}return C+=this._rotation,C?`rotateZ(${C}deg)`:""}_update(c){_.window.cancelAnimationFrame(this._updateFrameId);const g=this._map;g&&(g.transform.renderWorldCopies&&(this._lngLat=wh(this._lngLat,this._pos,g.transform)),this._pos=g.project(this._lngLat),!0===c?this._updateFrameId=_.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),g._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(g._showingGlobe()||g.getTerrain()||g.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(c){return this._offset=_.pointGeometry.convert(c),this._update(),this}_onMove(c){const g=this._map;if(!g)return;const C=this._pointerdownPos,S=this._positionDelta;if(C&&S){if(!this._isDragging){const D=this._clickTolerance||g._clickTolerance;if(c.point.dist(C)<D)return;this._isDragging=!0}this._pos=c.point.sub(S),this._lngLat=g.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new _.Event("dragstart"))),this.fire(new _.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const c=this._map;c&&(c.off("mousemove",this._onMove),c.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new _.Event("dragend")),this._state="inactive"}_addDragHandler(c){const g=this._map,C=this._pos;g&&C&&this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(C),this._pointerdownPos=c.point,this._state="pending",g.on("mousemove",this._onMove),g.on("touchmove",this._onMove),g.once("mouseup",this._onUp),g.once("touchend",this._onUp))}setDraggable(c){this._draggable=!!c;const g=this._map;return g&&(c?(g.on("mousedown",this._addDragHandler),g.on("touchstart",this._addDragHandler)):(g.off("mousedown",this._addDragHandler),g.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(c){return this._occludedOpacity=c||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Tf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},fa=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Eh(v=new _.pointGeometry(0,0),c="bottom"){if("number"==typeof v){const g=Math.round(Math.sqrt(.5*Math.pow(v,2)));switch(c){case"top":return new _.pointGeometry(0,v);case"top-left":return new _.pointGeometry(g,g);case"top-right":return new _.pointGeometry(-g,g);case"bottom":return new _.pointGeometry(0,-v);case"bottom-left":return new _.pointGeometry(g,-g);case"bottom-right":return new _.pointGeometry(-g,-g);case"left":return new _.pointGeometry(v,0);case"right":return new _.pointGeometry(-v,0)}return new _.pointGeometry(0,0)}return v instanceof _.pointGeometry||Array.isArray(v)?_.pointGeometry.convert(v):_.pointGeometry.convert(v[c]||[0,0])}class pa{constructor(c){this.jumpTo(c)}getValue(c){if(c<=this._startTime)return this._start;if(c>=this._endTime)return this._end;const g=_.easeCubicInOut((c-this._startTime)/(this._endTime-this._startTime));return this._start*(1-g)+this._end*g}isEasing(c){return c>=this._startTime&&c<=this._endTime}jumpTo(c){this._startTime=-1/0,this._endTime=-1/0,this._start=c,this._end=c}easeTo(c,g,C){this._start=this.getValue(g),this._end=c,this._startTime=g,this._endTime=g+C}}const tu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Np={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},nu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Hu{constructor(c,g,C=!1){this._clickTolerance=10,this.element=g,this.mouseRotate=new _h({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,C&&(this.mousePitch=new yh({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),_.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),g.addEventListener("mousedown",this.mousedown),g.addEventListener("touchstart",this.touchstart,{passive:!1}),g.addEventListener("touchmove",this.touchmove),g.addEventListener("touchend",this.touchend),g.addEventListener("touchcancel",this.reset)}down(c,g){this.mouseRotate.mousedown(c,g),this.mousePitch&&this.mousePitch.mousedown(c,g),tn()}move(c,g){const C=this.map,S=this.mouseRotate.mousemoveWindow(c,g),D=S&&S.bearingDelta;if(D&&C.setBearing(C.getBearing()+D),this.mousePitch){const L=this.mousePitch.mousemoveWindow(c,g),B=L&&L.pitchDelta;B&&C.setPitch(C.getPitch()+B)}}off(){const c=this.element;c.removeEventListener("mousedown",this.mousedown),c.removeEventListener("touchstart",this.touchstart,{passive:!1}),c.removeEventListener("touchmove",this.touchmove),c.removeEventListener("touchend",this.touchend),c.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){bn(),_.window.removeEventListener("mousemove",this.mousemove),_.window.removeEventListener("mouseup",this.mouseup)}mousedown(c){this.down(_.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),Ye(this.element,c)),_.window.addEventListener("mousemove",this.mousemove),_.window.addEventListener("mouseup",this.mouseup)}mousemove(c){this.move(c,Ye(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){1!==c.targetTouches.length?this.reset():(this._startPos=this._lastPos=Ft(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){1!==c.targetTouches.length?this.reset():(this._lastPos=Ft(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){0===c.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Th={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ym={maxWidth:100,unit:"metric"};function Fd(v,c,g){const C=zp(c),S=C/c,D={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[g];this._map._requestDomTask(()=>{this._container.style.width=v*S+"px",this._container.innerHTML=`${C}&nbsp;${D}`})}function zp(v){const c=Math.pow(10,`${Math.floor(v)}`.length-1);let g=v/c;return g=g>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:function(C){const S=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*S)/S}(g),c*g}const Mi={version:_.version,supported:ft,setRTLTextPlugin:_.setRTLTextPlugin,getRTLTextPluginStatus:_.getRTLTextPluginStatus,Map:class extends Lp{constructor(v){if(_.LivePerformanceUtils.mark(_.PerformanceMarkers.create),null!=(v=_.extend({},Np,v)).minZoom&&null!=v.maxZoom&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=v.minPitch&&null!=v.maxPitch&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=v.minPitch&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=v.maxPitch&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(v.antialias&&_.isSafariWithAntialiasingBug(_.window)&&(v.antialias=!1,_.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new hn(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),v),this._interactive=v.interactive,this._minTileCacheSize=v.minTileCacheSize,this._maxTileCacheSize=v.maxTileCacheSize,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._useWebGL2=v.useWebGL2,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=v.crossSourceCollisions,this._collectResourceTiming=v.collectResourceTiming,this._optimizeForTerrain=v.optimizeForTerrain,this._language=this._parseLanguage(v.language),this._worldview=v.worldview,this._renderTaskQueue=new Ra,this._domRenderTaskQueue=new Ra,this._controls=[],this._markers=[],this._popups=[],this._mapId=_.uniqueId(),this._locale=_.extend({},tu,v.locale),this._clickTolerance=v.clickTolerance,this._cooperativeGestures=v.cooperativeGestures,this._performanceMetricsCollection=v.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new pa(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new _.RequestManager(v.transformRequest,v.accessToken,v.testMode),this._silenceAuthErrors=!!v.testMode,"string"==typeof v.container){if(this._container=_.window.document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof _.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(this._container.childNodes.length>0&&_.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),v.maxBounds&&this.setMaxBounds(v.maxBounds),_.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==_.window&&(_.window.addEventListener("online",this._onWindowOnline,!1),_.window.addEventListener("resize",this._onWindowResize,!1),_.window.addEventListener("orientationchange",this._onWindowResize,!1),_.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),_.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new bh(this,v),this._localFontFamily=v.localFontFamily,this._localIdeographFontFamily=v.localIdeographFontFamily,v.style&&this.setStyle(v.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),v.projection&&this.setProjection(v.projection),this._hash=v.hash&&new Md("string"==typeof v.hash&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,_.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),v.attributionControl&&this.addControl(new Zm({customAttribution:v.customAttribution})),this._logoControl=new xh,this.addControl(this._logoControl,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update("style"===c.dataType),this.fire(new _.Event(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new _.Event(`${c.dataType}dataloading`,c))})}_getMapId(){return this._mapId}addControl(v,c){if(void 0===c&&(c=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new _.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const g=v.onAdd(this);this._controls.push(v);const C=this._controlPositions[c];return-1!==c.indexOf("bottom")?C.insertBefore(g,C.firstChild):C.appendChild(g),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new _.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(v);return c>-1&&this._controls.splice(c,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(v){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const c=!this._moving;return c&&this.fire(new _.Event("movestart",v)).fire(new _.Event("move",v)),this.fire(new _.Event("resize",v)),c&&this.fire(new _.Event("moveend",v)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(v){return this.transform.setMaxBounds(_.LngLatBounds.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v?this.setZoom(v):this.fire(new _.Event("zoomstart")).fire(new _.Event("zoom")).fire(new _.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v?this.setZoom(v):this.fire(new _.Event("zoomstart")).fire(new _.Event("zoom")).fire(new _.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v?this.setPitch(v):this.fire(new _.Event("pitchstart")).fire(new _.Event("pitch")).fire(new _.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v?this.setPitch(v):this.fire(new _.Event("pitchstart")).fire(new _.Event("pitch")).fire(new _.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(v){return"auto"===v?_.window.navigator.language:Array.isArray(v)?0===v.length?void 0:v.map(c=>"auto"===c?_.window.navigator.language:c):v}setLanguage(v){const c=this._parseLanguage(v);if(!this.style||c===this._language)return this;this._language=c,this.style._reloadSources();for(const g of this._controls)g._setLanguage&&g._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(v){return this.style&&v!==this._worldview?(this._worldview=v,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(v){return this._lazyInitEmptyStyle(),v?"string"==typeof v&&(v={name:v}):v=null,this._useExplicitProjection=!!v,this._prioritizeAndUpdateProjection(v,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const v=this.transform,c=v.projection.name;let g;"globe"===c&&v.zoom>=_.GLOBE_ZOOM_THRESHOLD_MAX?(v.setMercatorFromTransition(),g=!0):"mercator"===c&&v.zoom<_.GLOBE_ZOOM_THRESHOLD_MAX&&(v.setProjection({name:"globe"}),g=!0),g&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(v,c){return this._updateProjection(v||c||{name:"mercator"})}_updateProjection(v){let c;if(c="globe"===v.name&&this.transform.zoom>=_.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(v),this.style.applyProjectionUpdate(),c){this.painter.clearBackgroundTiles();for(const g in this.style._sourceCaches)this.style._sourceCaches[g].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(v){return this.transform.locationPoint3D(_.LngLat.convert(v))}unproject(v){return this.transform.pointLocation3D(_.pointGeometry.convert(v))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(v,c,g){if("mouseenter"===v||"mouseover"===v){let C=!1;const S=L=>{const B=c.filter(J=>this.getLayer(J)),G=B.length?this.queryRenderedFeatures(L.point,{layers:B}):[];G.length?C||(C=!0,g.call(this,new qr(v,this,L.originalEvent,{features:G}))):C=!1},D=()=>{C=!1};return{layers:new Set(c),listener:g,delegates:{mousemove:S,mouseout:D}}}if("mouseleave"===v||"mouseout"===v){let C=!1;const S=L=>{const B=c.filter(G=>this.getLayer(G));(B.length?this.queryRenderedFeatures(L.point,{layers:B}):[]).length?C=!0:C&&(C=!1,g.call(this,new qr(v,this,L.originalEvent)))},D=L=>{C&&(C=!1,g.call(this,new qr(v,this,L.originalEvent)))};return{layers:new Set(c),listener:g,delegates:{mousemove:S,mouseout:D}}}{const C=S=>{const D=c.filter(B=>this.getLayer(B)),L=D.length?this.queryRenderedFeatures(S.point,{layers:D}):[];L.length&&(S.features=L,g.call(this,S),delete S.features)};return{layers:new Set(c),listener:g,delegates:{[v]:C}}}}on(v,c,g){if(void 0===g)return super.on(v,c);Array.isArray(c)||(c=[c]);const C=this._createDelegatedListener(v,c,g);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(C);for(const S in C.delegates)this.on(S,C.delegates[S]);return this}once(v,c,g){if(void 0===g)return super.once(v,c);Array.isArray(c)||(c=[c]);const C=this._createDelegatedListener(v,c,g);for(const S in C.delegates)this.once(S,C.delegates[S]);return this}off(v,c,g){if(void 0===g)return super.off(v,c);c=new Set(Array.isArray(c)?c:[c]);const C=(D,L)=>{if(D.size!==L.size)return!1;for(const B of D)if(!L.has(B))return!1;return!0},S=this._delegatedListeners?this._delegatedListeners[v]:void 0;return S&&(D=>{for(let L=0;L<D.length;L++){const B=D[L];if(B.listener===g&&C(B.layers,c)){for(const G in B.delegates)this.off(G,B.delegates[G]);return D.splice(L,1),this}}})(S),this}queryRenderedFeatures(v,c){return this.style?(void 0!==c||void 0===v||v instanceof _.pointGeometry||Array.isArray(v)||(c=v,v=void 0),this.style.queryRenderedFeatures(v=v||[[0,0],[this.transform.width,this.transform.height]],c=c||{},this.transform)):[]}querySourceFeatures(v,c){return this.style.querySourceFeatures(v,c)}setStyle(v,c){return!1!==(c=_.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},c)).diff&&c.localIdeographFontFamily===this._localIdeographFontFamily&&c.localFontFamily===this._localFontFamily&&this.style&&v?(this._diffStyle(v,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._localFontFamily=c.localFontFamily,this._updateStyle(v,c))}_getUIString(v){const c=this._locale[v];if(null==c)throw new Error(`Missing UI string '${v}'`);return c}_updateStyle(v,c){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),v&&(this.style=new eo(this,c||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof v?this.style.loadURL(v):this.style.loadJSON(v)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new eo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,c){if("string"==typeof v){const g=this._requestManager.normalizeStyleURL(v),C=this._requestManager.transformRequest(g,_.ResourceType.Style);_.getJSON(C,(S,D)=>{S?this.fire(new _.ErrorEvent(S)):D&&this._updateDiff(D,c)})}else"object"==typeof v&&this._updateDiff(v,c)}_updateDiff(v,c){try{this.style.setState(v)&&this._update(!0)}catch(g){_.warnOnce(`Unable to perform style diff: ${g.message||g.error||g}.  Rebuilding the style from scratch.`),this._updateStyle(v,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(_.warnOnce("There is no style added to the map."),!1)}addSource(v,c){return this._lazyInitEmptyStyle(),this.style.addSource(v,c),this._update(!0)}isSourceLoaded(v){return!!this.style&&this.style._isSourceCacheLoaded(v)}areTilesLoaded(){const v=this.style&&this.style._sourceCaches;for(const c in v){const g=v[c]._tiles;for(const C in g){const S=g[C];if("loaded"!==S.state&&"errored"!==S.state)return!1}}return!0}addSourceType(v,c,g){this._lazyInitEmptyStyle(),this.style.addSourceType(v,c,g)}removeSource(v){return this.style.removeSource(v),this._updateTerrain(),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,c,{pixelRatio:g=1,sdf:C=!1,stretchX:S,stretchY:D,content:L}={}){if(this._lazyInitEmptyStyle(),c instanceof _.window.HTMLImageElement||_.window.ImageBitmap&&c instanceof _.window.ImageBitmap){const{width:B,height:G,data:J}=_.exported.getImageData(c);this.style.addImage(v,{data:new _.RGBAImage({width:B,height:G},J),pixelRatio:g,stretchX:S,stretchY:D,content:L,sdf:C,version:0})}else if(void 0===c.width||void 0===c.height)this.fire(new _.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:B,height:G}=c,J=c;this.style.addImage(v,{data:new _.RGBAImage({width:B,height:G},new Uint8Array(J.data)),pixelRatio:g,stretchX:S,stretchY:D,content:L,sdf:C,version:0,userImage:J}),J.onAdd&&J.onAdd(this,v)}}updateImage(v,c){const g=this.style.getImage(v);if(!g)return void this.fire(new _.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const C=c instanceof _.window.HTMLImageElement||_.window.ImageBitmap&&c instanceof _.window.ImageBitmap?_.exported.getImageData(c):c,{width:S,height:D}=C;void 0!==S&&void 0!==D?S===g.data.width&&D===g.data.height?(g.data.replace(C.data,!(c instanceof _.window.HTMLImageElement||_.window.ImageBitmap&&c instanceof _.window.ImageBitmap)),this.style.updateImage(v,g)):this.fire(new _.ErrorEvent(new Error(`The width and height of the updated image (${S}, ${D})\n                must be that same as the previous version of the image\n                (${g.data.width}, ${g.data.height})`))):this.fire(new _.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new _.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,c){_.getImage(this._requestManager.transformRequest(v,_.ResourceType.Image),(g,C)=>{c(g,C instanceof _.window.HTMLImageElement?_.exported.getImageData(C):C)})}listImages(){return this.style.listImages()}addLayer(v,c){return this._lazyInitEmptyStyle(),this.style.addLayer(v,c),this._update(!0)}moveLayer(v,c){return this.style.moveLayer(v,c),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,c,g){return this.style.setLayerZoomRange(v,c,g),this._update(!0)}setFilter(v,c,g={}){return this.style.setFilter(v,c,g),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,c,g,C={}){return this.style.setPaintProperty(v,c,g,C),this._update(!0)}getPaintProperty(v,c){return this.style.getPaintProperty(v,c)}setLayoutProperty(v,c,g,C={}){return this.style.setLayoutProperty(v,c,g,C),this._update(!0)}getLayoutProperty(v,c){return this.style.getLayoutProperty(v,c)}setLight(v,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,c),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(v){return this._lazyInitEmptyStyle(),!v&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(v),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(v){return this._lazyInitEmptyStyle(),this.style.setFog(v),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(v){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(_.LngLat.convert(v),this.transform):0}setFeatureState(v,c){return this.style.setFeatureState(v,c),this._update()}removeFeatureState(v,c){return this.style.removeFeatureState(v,c),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}_updateContainerDimensions(){if(!this._container)return;const v=this._container.getBoundingClientRect().width||400,c=this._container.getBoundingClientRect().height||300;let g,C,S,D=this._container;for(;D&&(!C||!S);){const L=_.window.getComputedStyle(D).transform;L&&"none"!==L&&(g=L.match(/matrix.*\((.+)\)/)[1].split(", "),g[0]&&"0"!==g[0]&&"1"!==g[0]&&(C=g[0]),g[3]&&"0"!==g[3]&&"1"!==g[3]&&(S=g[3])),D=D.parentElement}this._containerWidth=C?Math.abs(v/C):v,this._containerHeight=S?Math.abs(c/S):c}_detectMissingCSS(){"rgb(250, 128, 114)"!==_.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&_.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const v=this._container;v.classList.add("mapboxgl-map"),(this._missingCSSCanary=It("div","mapboxgl-canary",v)).style.visibility="hidden",this._detectMissingCSS();const c=this._canvasContainer=It("div","mapboxgl-canvas-container",v);this._interactive&&c.classList.add("mapboxgl-interactive"),this._canvas=It("canvas","mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const g=this._controlContainer=It("div","mapboxgl-control-container",v),C=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{C[S]=It("div",`mapboxgl-ctrl-${S}`,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,c){const g=_.exported.devicePixelRatio||1;this._canvas.width=g*Math.ceil(v),this._canvas.height=g*Math.ceil(c),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${c}px`}_addMarker(v){this._markers.push(v)}_removeMarker(v){const c=this._markers.indexOf(v);-1!==c&&this._markers.splice(c,1)}_addPopup(v){this._popups.push(v)}_removePopup(v){const c=this._popups.indexOf(v);-1!==c&&this._popups.splice(c,1)}_setupPainter(){const v=_.extend({},ft.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._useWebGL2&&this._canvas.getContext("webgl2",v),g=c||this._canvas.getContext("webgl",v)||this._canvas.getContext("experimental-webgl",v);g?(this._useWebGL2&&!c&&_.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),_.storeAuthState(g,!0),this.painter=new Al(g,this.transform,!!c),this.on("data",C=>{"source"===C.dataType&&this.painter.setTileLoadedFlag(!0)}),_.exported$1.testSupport(g)):this.fire(new _.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(v){v.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new _.Event("webglcontextlost",{originalEvent:v}))}_contextRestored(v){this._setupPainter(),this.resize(),this._update(),this.fire(new _.Event("webglcontextrestored",{originalEvent:v}))}_onMapScroll(v){if(v.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_requestDomTask(v){!this.loaded()||this.loaded()&&!this.isMoving()?v():this._domRenderTaskQueue.add(v)}_render(v){let c;const g=this.painter.context.extTimerQuery,C=_.exported.now();if(this.listens("gpu-timing-frame")&&(c=g.createQueryEXT(),g.beginQueryEXT(g.TIME_ELAPSED_EXT,c)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],_.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],_.window.performance.now())),this._renderTaskQueue.run(v),this._domRenderTaskQueue.run(v),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const B=this.transform.zoom,G=this.transform.pitch,J=_.exported.now(),ee=new _.EvaluationParameters(B,{now:J,fadeDuration:S,pitch:G,transition:this.style.getTransition()});this.style.update(ee)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let D=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),D=this._updateAverageElevation(C),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):D=this._updateAverageElevation(C),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new _.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new _.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),c){const B=_.exported.now()-C;g.endQueryEXT(g.TIME_ELAPSED_EXT,c),setTimeout(()=>{const G=g.getQueryObjectEXT(c,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(c),this.fire(new _.Event("gpu-timing-frame",{cpuTime:B,gpuTime:G})),_.window.performance.mark("frame-gpu",{startTime:C,detail:{gpuTime:G}})},50)}if(this.listens("gpu-timing-layer")){const B=this.painter.collectGpuTimers();setTimeout(()=>{const G=this.painter.queryGpuTimers(B);this.fire(new _.Event("gpu-timing-layer",{layerTimes:G}))},50)}if(this.listens("gpu-timing-deferred-render")){const B=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const G=this.painter.queryGpuTimeDeferredRender(B);this.fire(new _.Event("gpu-timing-deferred-render",{gpuTime:G}))},50)}const L=this._sourcesDirty||this._styleDirty||this._placementDirty||D;if(L||this._repaint)this.triggerRepaint();else{const B=!this.isMoving()&&this.loaded();if(B&&(D=this._updateAverageElevation(C,!0)),D)this.triggerRepaint();else if(this._triggerFrame(!1),B&&(this.fire(new _.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const G=this._calculateSpeedIndex();this.fire(new _.Event("speedindexcompleted",{speedIndex:G})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||L||(this._fullyLoaded=!0,_.LivePerformanceUtils.mark(_.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&_.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(v){for(const c of this._markers)v&&!this.getRenderWorldCopies()&&(c._lngLat=c._lngLat.wrap()),c._update();for(const c of this._popups)!v||this.getRenderWorldCopies()||c._trackPointer||(c._lngLat=c._lngLat.wrap()),c._update()}_updateAverageElevation(v,c=!1){const g=C=>(this.transform.averageElevation=C,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&g(0);if((c||v-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(v)){const C=this.transform.averageElevation;let S=this.transform.sampleAverageElevation(),D=!1;this.transform.elevation&&(D=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=v;const L=Math.abs(C-S);if(L>1){if(this._isInitialLoad||D)return this._averageElevation.jumpTo(S),g(S);this._averageElevation.easeTo(S,v,300)}else if(L>1e-4)return this._averageElevation.jumpTo(S),g(S)}return!!this._averageElevation.isEasing(v)&&g(this._averageElevation.getValue(v))}_authenticate(){_.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,v=>{if(v&&(v.message===_.AUTH_ERR_MSG||401===v.status)){const c=this.painter.context.gl;_.storeAuthState(c,!1),this._logoControl instanceof xh&&this._logoControl._updateLogo(),c&&c.clear(c.DEPTH_BUFFER_BIT|c.COLOR_BUFFER_BIT|c.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new _.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),_.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const v=this._isDragging();this.painter.updateTerrain(this.style,v)}_calculateSpeedIndex(){const v=this.painter.canvasCopy(),c=this.painter.getCanvasCopiesAndTimestamps();c.timeStamps.push(performance.now());const g=this.painter.context.gl,C=g.createFramebuffer();function S(D){g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,D,0);const L=new Uint8Array(g.drawingBufferWidth*g.drawingBufferHeight*4);return g.readPixels(0,0,g.drawingBufferWidth,g.drawingBufferHeight,g.RGBA,g.UNSIGNED_BYTE,L),L}return g.bindFramebuffer(g.FRAMEBUFFER,C),this._canvasPixelComparison(S(v),c.canvasCopies.map(S),c.timeStamps)}_canvasPixelComparison(v,c,g){let C=g[1]-g[0];const S=v.length/4;for(let D=0;D<c.length;D++){const L=c[D];let B=0;for(let G=0;G<L.length;G+=4)L[G]===v[G]&&L[G+1]===v[G+1]&&L[G+2]===v[G+2]&&L[G+3]===v[G+3]&&(B+=1);C+=(g[D+2]-g[D+1])*(1-B/S)}return C}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==_.window&&(_.window.removeEventListener("resize",this._onWindowResize,!1),_.window.removeEventListener("orientationchange",this._onWindowResize,!1),_.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),_.window.removeEventListener("online",this._onWindowOnline,!1),_.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const v=this.painter.context.gl.getExtension("WEBGL_lose_context");v&&v.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),_.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new _.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(v){this._renderNextFrame=this._renderNextFrame||v,this.style&&!this._frame&&(this._frame=_.exported.frame(c=>{const g=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,g&&this._render(c)}))}_preloadTiles(v){const c=this.style?Object.values(this.style._sourceCaches):[];return _.asyncAll(c,(g,C)=>g._preloadTiles(v,C),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(v){this._trackResize&&this.resize({originalEvent:v})._update()}_onVisibilityChange(){"hidden"===_.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(v){this._showTerrainWireframe!==v&&(this._showTerrainWireframe=v,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(v){this._speedIndexTiming!==v&&(this._speedIndexTiming=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(v){this._showTileAABBs!==v&&(this._showTileAABBs=v,v&&this._update())}_setCacheLimits(v,c){_.setCacheLimits(v,c)}get version(){return _.version}},NavigationControl:class{constructor(v){this.options=_.extend({},nu,v),this._container=It("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(_.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",c=>{this._map&&this._map.zoomIn({},{originalEvent:c})}),It("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",c=>{this._map&&this._map.zoomOut({},{originalEvent:c})}),It("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(_.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",c=>{const g=this._map;g&&(this.options.visualizePitch?g.resetNorthPitch({},{originalEvent:c}):g.resetNorth({},{originalEvent:c}))}),this._compassIcon=It("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const v=this._map;if(!v)return;const c=v.getZoom(),g=c===v.getMaxZoom(),C=c===v.getMinZoom();this._zoomInButton.disabled=g,this._zoomOutButton.disabled=C,this._zoomInButton.setAttribute("aria-disabled",g.toString()),this._zoomOutButton.setAttribute("aria-disabled",C.toString())}_rotateCompassArrow(){const v=this._map;if(!v)return;const c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(v.transform.pitch*(Math.PI/180)),.5)}) rotateX(${v.transform.pitch}deg) rotateZ(${v.transform.angle*(180/Math.PI)}deg)`:`rotate(${v.transform.angle*(180/Math.PI)}deg)`;v._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=c)})}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),v.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&v.on("pitch",this._rotateCompassArrow),v.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Hu(v,this._compass,this.options.visualizePitch)),this._container}onRemove(){const v=this._map;v&&(this._container.remove(),this.options.showZoom&&v.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&v.off("pitch",this._rotateCompassArrow),v.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(v,c){const g=It("button",v,this._container);return g.type="button",g.addEventListener("click",c),g}_setButtonTitle(v,c){if(!this._map)return;const g=this._map._getUIString(`NavigationControl.${c}`);v.setAttribute("aria-label",g),v.firstElementChild&&v.firstElementChild.setAttribute("title",g)}},GeolocateControl:class extends _.Evented{constructor(v){super(),this.options=_.extend({geolocation:_.window.navigator.geolocation},Th,v),_.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=or(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(v){return this._map=v,this._container=It("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(v){const c=(g=!!this.options.geolocation)=>{this._supportsGeolocation=g,v(g)};void 0!==this._supportsGeolocation?v(this._supportsGeolocation):void 0!==_.window.navigator.permissions?_.window.navigator.permissions.query({name:"geolocation"}).then(g=>c("denied"!==g.state)).catch(()=>c()):c()}_isOutOfMapMaxBounds(v){const c=this._map.getMaxBounds(),g=v.coords;return!!c&&(g.longitude<c.getWest()||g.longitude>c.getEast()||g.latitude<c.getSouth()||g.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(v){if(this._map){if(this._isOutOfMapMaxBounds(v))return this._setErrorState(),this.fire(new _.Event("outofmaxbounds",v)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=v,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(v),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(v),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new _.Event("geolocate",v)),this._finish()}}_updateCamera(v){const c=new _.LngLat(v.coords.longitude,v.coords.latitude),g=v.coords.accuracy,C=this._map.getBearing(),S=_.extend({bearing:C},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(g),S,{geolocateSource:!0})}_updateMarker(v){if(v){const c=new _.LngLat(v.coords.longitude,v.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=v.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const v=this._map.transform,c=_.mercatorZfromAltitude(1,v._center.lat)*v.worldSize,g=Math.ceil(2*this._accuracy*c);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(v){if(this._map){if(this.options.trackUserLocation)if(1===v.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===v.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new _.Event("error",v)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(v){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=It("button","mapboxgl-ctrl-geolocate",this._container),It("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===v){_.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=It("div","mapboxgl-user-location"),this._dotElement.appendChild(It("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(It("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new no({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=It("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new no({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||"ACTIVE_LOCK"!==this._watchState||c.originalEvent&&"resize"===c.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new _.Event("trackuserlocationend")))})}}_onDeviceOrientation(v){this._userLocationDotMarker&&(v.webkitCompassHeading?this._heading=v.webkitCompassHeading:!0===v.absolute&&(this._heading=-1*v.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return _.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new _.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new _.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new _.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let v;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(v={maximumAge:6e5,timeout:0},this._noTimeout=!0):(v=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,v),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const v=()=>{_.window.addEventListener("ondeviceorientationabsolute"in _.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==_.window.DeviceMotionEvent&&"function"==typeof _.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(c=>{"granted"===c&&v()}).catch(console.error):v()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),_.window.removeEventListener("deviceorientation",this._onDeviceOrientation),_.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Zm,ScaleControl:class{constructor(v){this.options=_.extend({},Ym,v),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Fd.bind(this)),_.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const v=this.options.maxWidth||100,c=this._map,g=c._containerHeight/2,C=c._containerWidth/2-v/2,S=c.unproject([C,g]),D=c.unproject([C+v,g]),L=S.distanceTo(D);if("imperial"===this.options.unit){const B=3.2808*L;B>5280?this._setScale(v,B/5280,"mile"):this._setScale(v,B,"foot")}else"nautical"===this.options.unit?this._setScale(v,L/1852,"nautical-mile"):L>=1e3?this._setScale(v,L/1e3,"kilometer"):this._setScale(v,L,"meter")}_setScale(v,c,g){const C=zp(c),S=C/c;this._map._requestDomTask(()=>{this._container.style.width=v*S+"px",this._container.innerHTML="nautical-mile"!==g?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:g}).format(C):`${C}&nbsp;nm`})}onAdd(v){return this._map=v,this._language=v.getLanguage(),this._container=It("div","mapboxgl-ctrl mapboxgl-ctrl-scale",v.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(v){this._language=v,this._update()}setUnit(v){this.options.unit=v,this._update()}},FullscreenControl:class{constructor(v){this._fullscreen=!1,v&&v.container&&(v.container instanceof _.window.HTMLElement?this._container=v.container:_.warnOnce("Full screen control 'container' must be a DOM element.")),_.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in _.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in _.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=It("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",_.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,_.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!_.window.document.fullscreenEnabled&&!_.window.document.webkitFullscreenEnabled)}_setupUI(){const v=this._fullscreenButton=It("button","mapboxgl-ctrl-fullscreen",this._controlContainer);It("span","mapboxgl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),_.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",v)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(_.window.document.fullscreenElement||_.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?_.window.document.exitFullscreen?_.window.document.exitFullscreen():_.window.document.webkitCancelFullScreen&&_.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends _.Evented{constructor(v){super(),this.options=_.extend(Object.create(Tf),v),_.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(v&&v.className?v.className.trim().split(/\s+/):[])}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&v.on("preclick",this._onClose),this.options.closeOnMove&&v.on("move",this._onClose),v.on("remove",this.remove),this._update(),v._addPopup(this),this._focusFirstElement(),this._trackPointer?(v.on("mousemove",this._onMouseEvent),v.on("mouseup",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")):v.on("move",this._update),this.fire(new _.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const v=this._map;return v&&(v.off("move",this._update),v.off("move",this._onClose),v.off("preclick",this._onClose),v.off("click",this._onClose),v.off("remove",this.remove),v.off("mousemove",this._onMouseEvent),v.off("mouseup",this._onMouseEvent),v.off("drag",this._onMouseEvent),v._canvasContainer&&v._canvasContainer.classList.remove("mapboxgl-track-pointer"),v._removePopup(this),this._map=void 0),this.fire(new _.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(v){this._lngLat=_.LngLat.convert(v),this._pos=null,this._trackPointer=!1,this._update();const c=this._map;return c&&(c.on("move",this._update),c.off("mousemove",this._onMouseEvent),c._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const v=this._map;return v&&(v.off("move",this._update),v.on("mousemove",this._onMouseEvent),v.on("drag",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(_.window.document.createTextNode(v))}setHTML(v){const c=_.window.document.createDocumentFragment(),g=_.window.document.createElement("body");let C;for(g.innerHTML=v;C=g.firstChild,C;)c.appendChild(C);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){let c=this._content;if(c)for(;c.hasChildNodes();)c.firstChild&&c.removeChild(c.firstChild);else c=this._content=It("div","mapboxgl-popup-content",this._container||void 0);if(c.appendChild(v),this.options.closeButton){const g=this._closeButton=It("button","mapboxgl-popup-close-button",c);g.type="button",g.setAttribute("aria-label","Close popup"),g.setAttribute("aria-hidden","true"),g.innerHTML="&#215;",g.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(v){return this._classList.add(v),this._updateClassList(),this}removeClassName(v){return this._classList.delete(v),this._updateClassList(),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){let c;return this._classList.delete(v)?c=!1:(this._classList.add(v),c=!0),this._updateClassList(),c}_onMouseEvent(v){this._update(v.point)}_getAnchor(v){if(this.options.anchor)return this.options.anchor;const c=this._map,g=this._container,C=this._pos;if(!c||!g||!C)return"bottom";const S=g.offsetWidth,D=g.offsetHeight,L=C.x<S/2,B=C.x>c.transform.width-S/2;if(C.y+v<D)return L?"top-left":B?"top-right":"top";if(C.y>c.transform.height-D){if(L)return"bottom-left";if(B)return"bottom-right"}return L?"left":B?"right":"bottom"}_updateClassList(){const v=this._container;if(!v)return;const c=[...this._classList];c.push("mapboxgl-popup"),this._anchor&&c.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&c.push("mapboxgl-popup-track-pointer"),v.className=c.join(" ")}_update(v){const c=this._map,g=this._content;if(!c||!this._lngLat&&!this._trackPointer||!g)return;let C=this._container;if(C||(C=this._container=It("div","mapboxgl-popup",c.getContainer()),this._tip=It("div","mapboxgl-popup-tip",C),C.appendChild(g)),this.options.maxWidth&&C.style.maxWidth!==this.options.maxWidth&&(C.style.maxWidth=this.options.maxWidth),c.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=wh(this._lngLat,this._pos,c.transform)),!this._trackPointer||v){const S=this._pos=this._trackPointer&&v?v:c.project(this._lngLat),D=Eh(this.options.offset),L=this._anchor=this._getAnchor(D.y),B=Eh(this.options.offset,L),G=S.add(B).round();c._requestDomTask(()=>{this._container&&L&&(this._container.style.transform=`${Ch[L]} translate(${G.x}px,${G.y}px)`)})}if(!this._marker&&c._showingGlobe()){const S=_.isLngLatBehindGlobe(c.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(fa);v&&v.focus()}_onClose(){this.remove()}_setOpacity(v){this._container&&(this._container.style.opacity=`${v}`),this._content&&(this._content.style.pointerEvents=v?"auto":"none")}},Marker:no,Style:eo,LngLat:_.LngLat,LngLatBounds:_.LngLatBounds,Point:_.pointGeometry,MercatorCoordinate:_.MercatorCoordinate,FreeCameraOptions:Sd,Evented:_.Evented,config:_.config,prewarm:function(){ni().acquire(En)},clearPrewarmedResources:function(){const v=Fn;v&&(v.isPreloaded()&&1===v.numActive()?(v.release(En),Fn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return _.config.ACCESS_TOKEN},set accessToken(v){_.config.ACCESS_TOKEN=v},get baseApiUrl(){return _.config.API_URL},set baseApiUrl(v){_.config.API_URL=v},get workerCount(){return Ln.workerCount},set workerCount(v){Ln.workerCount=v},get maxParallelImageRequests(){return _.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(v){_.config.MAX_PARALLEL_IMAGE_REQUESTS=v},clearStorage(v){_.clearTileCache(v)},workerUrl:"",workerClass:null,setNow:_.exported.setNow,restoreNow:_.exported.restoreNow};return Mi}),d}()},9751:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{y:()=>yt});var d=Ae(930),Ne=Ae(727),Me=Ae(8822),_=Ae(9635),$e=Ae(2416),ft=Ae(576),on=Ae(2806);let yt=(()=>{class Ke{constructor(tn){tn&&(this._subscribe=tn)}lift(tn){const bn=new Ke;return bn.source=this,bn.operator=tn,bn}subscribe(tn,bn,Dn){const vt=function je(Ke){return Ke&&Ke instanceof d.Lv||function Ve(Ke){return Ke&&(0,ft.m)(Ke.next)&&(0,ft.m)(Ke.error)&&(0,ft.m)(Ke.complete)}(Ke)&&(0,Ne.Nn)(Ke)}(tn)?tn:new d.Hp(tn,bn,Dn);return(0,on.x)(()=>{const{operator:Ye,source:Ft}=this;vt.add(Ye?Ye.call(vt,Ft):Ft?this._subscribe(vt):this._trySubscribe(vt))}),vt}_trySubscribe(tn){try{return this._subscribe(tn)}catch(bn){tn.error(bn)}}forEach(tn,bn){return new(bn=It(bn))((Dn,vt)=>{const Ye=new d.Hp({next:Ft=>{try{tn(Ft)}catch(Jt){vt(Jt),Ye.unsubscribe()}},error:vt,complete:Dn});this.subscribe(Ye)})}_subscribe(tn){var bn;return null===(bn=this.source)||void 0===bn?void 0:bn.subscribe(tn)}[Me.L](){return this}pipe(...tn){return(0,_.U)(tn)(this)}toPromise(tn){return new(tn=It(tn))((bn,Dn)=>{let vt;this.subscribe(Ye=>vt=Ye,Ye=>Dn(Ye),()=>bn(vt))})}}return Ke.create=pn=>new Ke(pn),Ke})();function It(Ke){var pn;return null!==(pn=Ke??$e.v.Promise)&&void 0!==pn?pn:Promise}},7579:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{x:()=>on});var d=Ae(9751),Ne=Ae(727);const _=(0,Ae(3888).d)(It=>function(){It(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var $e=Ae(8737),ft=Ae(2806);let on=(()=>{class It extends d.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(je){const Ke=new yt(this,this);return Ke.operator=je,Ke}_throwIfClosed(){if(this.closed)throw new _}next(je){(0,ft.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Ke of this.currentObservers)Ke.next(je)}})}error(je){(0,ft.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=je;const{observers:Ke}=this;for(;Ke.length;)Ke.shift().error(je)}})}complete(){(0,ft.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:je}=this;for(;je.length;)je.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var je;return(null===(je=this.observers)||void 0===je?void 0:je.length)>0}_trySubscribe(je){return this._throwIfClosed(),super._trySubscribe(je)}_subscribe(je){return this._throwIfClosed(),this._checkFinalizedStatuses(je),this._innerSubscribe(je)}_innerSubscribe(je){const{hasError:Ke,isStopped:pn,observers:tn}=this;return Ke||pn?Ne.Lc:(this.currentObservers=null,tn.push(je),new Ne.w0(()=>{this.currentObservers=null,(0,$e.P)(tn,je)}))}_checkFinalizedStatuses(je){const{hasError:Ke,thrownError:pn,isStopped:tn}=this;Ke?je.error(pn):tn&&je.complete()}asObservable(){const je=new d.y;return je.source=this,je}}return It.create=(Ve,je)=>new yt(Ve,je),It})();class yt extends on{constructor(Ve,je){super(),this.destination=Ve,this.source=je}next(Ve){var je,Ke;null===(Ke=null===(je=this.destination)||void 0===je?void 0:je.next)||void 0===Ke||Ke.call(je,Ve)}error(Ve){var je,Ke;null===(Ke=null===(je=this.destination)||void 0===je?void 0:je.error)||void 0===Ke||Ke.call(je,Ve)}complete(){var Ve,je;null===(je=null===(Ve=this.destination)||void 0===Ve?void 0:Ve.complete)||void 0===je||je.call(Ve)}_subscribe(Ve){var je,Ke;return null!==(Ke=null===(je=this.source)||void 0===je?void 0:je.subscribe(Ve))&&void 0!==Ke?Ke:Ne.Lc}}},930:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{Hp:()=>Dn,Lv:()=>Ke});var d=Ae(576),Ne=Ae(727),Me=Ae(2416),_=Ae(7849),$e=Ae(5032);const ft=It("C",void 0,void 0);function It(Xt,Ct,Pt){return{kind:Xt,value:Ct,error:Pt}}var Ve=Ae(3410),je=Ae(2806);class Ke extends Ne.w0{constructor(Ct){super(),this.isStopped=!1,Ct?(this.destination=Ct,(0,Ne.Nn)(Ct)&&Ct.add(this)):this.destination=Jt}static create(Ct,Pt,un){return new Dn(Ct,Pt,un)}next(Ct){this.isStopped?Ft(function yt(Xt){return It("N",Xt,void 0)}(Ct),this):this._next(Ct)}error(Ct){this.isStopped?Ft(function on(Xt){return It("E",void 0,Xt)}(Ct),this):(this.isStopped=!0,this._error(Ct))}complete(){this.isStopped?Ft(ft,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Ct){this.destination.next(Ct)}_error(Ct){try{this.destination.error(Ct)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const pn=Function.prototype.bind;function tn(Xt,Ct){return pn.call(Xt,Ct)}class bn{constructor(Ct){this.partialObserver=Ct}next(Ct){const{partialObserver:Pt}=this;if(Pt.next)try{Pt.next(Ct)}catch(un){vt(un)}}error(Ct){const{partialObserver:Pt}=this;if(Pt.error)try{Pt.error(Ct)}catch(un){vt(un)}else vt(Ct)}complete(){const{partialObserver:Ct}=this;if(Ct.complete)try{Ct.complete()}catch(Pt){vt(Pt)}}}class Dn extends Ke{constructor(Ct,Pt,un){let tt;if(super(),(0,d.m)(Ct)||!Ct)tt={next:Ct??void 0,error:Pt??void 0,complete:un??void 0};else{let pt;this&&Me.v.useDeprecatedNextContext?(pt=Object.create(Ct),pt.unsubscribe=()=>this.unsubscribe(),tt={next:Ct.next&&tn(Ct.next,pt),error:Ct.error&&tn(Ct.error,pt),complete:Ct.complete&&tn(Ct.complete,pt)}):tt=Ct}this.destination=new bn(tt)}}function vt(Xt){Me.v.useDeprecatedSynchronousErrorHandling?(0,je.O)(Xt):(0,_.h)(Xt)}function Ft(Xt,Ct){const{onStoppedNotification:Pt}=Me.v;Pt&&Ve.z.setTimeout(()=>Pt(Xt,Ct))}const Jt={closed:!0,next:$e.Z,error:function Ye(Xt){throw Xt},complete:$e.Z}},727:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{Lc:()=>ft,w0:()=>$e,Nn:()=>on});var d=Ae(576);const Me=(0,Ae(3888).d)(It=>function(je){It(this),this.message=je?`${je.length} errors occurred during unsubscription:\n${je.map((Ke,pn)=>`${pn+1}) ${Ke.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=je});var _=Ae(8737);class $e{constructor(Ve){this.initialTeardown=Ve,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Ve;if(!this.closed){this.closed=!0;const{_parentage:je}=this;if(je)if(this._parentage=null,Array.isArray(je))for(const tn of je)tn.remove(this);else je.remove(this);const{initialTeardown:Ke}=this;if((0,d.m)(Ke))try{Ke()}catch(tn){Ve=tn instanceof Me?tn.errors:[tn]}const{_finalizers:pn}=this;if(pn){this._finalizers=null;for(const tn of pn)try{yt(tn)}catch(bn){Ve=Ve??[],bn instanceof Me?Ve=[...Ve,...bn.errors]:Ve.push(bn)}}if(Ve)throw new Me(Ve)}}add(Ve){var je;if(Ve&&Ve!==this)if(this.closed)yt(Ve);else{if(Ve instanceof $e){if(Ve.closed||Ve._hasParent(this))return;Ve._addParent(this)}(this._finalizers=null!==(je=this._finalizers)&&void 0!==je?je:[]).push(Ve)}}_hasParent(Ve){const{_parentage:je}=this;return je===Ve||Array.isArray(je)&&je.includes(Ve)}_addParent(Ve){const{_parentage:je}=this;this._parentage=Array.isArray(je)?(je.push(Ve),je):je?[je,Ve]:Ve}_removeParent(Ve){const{_parentage:je}=this;je===Ve?this._parentage=null:Array.isArray(je)&&(0,_.P)(je,Ve)}remove(Ve){const{_finalizers:je}=this;je&&(0,_.P)(je,Ve),Ve instanceof $e&&Ve._removeParent(this)}}$e.EMPTY=(()=>{const It=new $e;return It.closed=!0,It})();const ft=$e.EMPTY;function on(It){return It instanceof $e||It&&"closed"in It&&(0,d.m)(It.remove)&&(0,d.m)(It.add)&&(0,d.m)(It.unsubscribe)}function yt(It){(0,d.m)(It)?It():It.unsubscribe()}},2416:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{v:()=>d});const d={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{E:()=>Ne});const Ne=new(Ae(9751).y)($e=>$e.complete())},8996:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{D:()=>Ct});var d=Ae(8421),Ne=Ae(5363),Me=Ae(9468),ft=Ae(9751),yt=Ae(2202),It=Ae(576),Ve=Ae(9672);function Ke(Pt,un){if(!Pt)throw new Error("Iterable cannot be null");return new ft.y(tt=>{(0,Ve.f)(tt,un,()=>{const pt=Pt[Symbol.asyncIterator]();(0,Ve.f)(tt,un,()=>{pt.next().then(zt=>{zt.done?tt.complete():tt.next(zt.value)})},0,!0)})})}var pn=Ae(3670),tn=Ae(8239),bn=Ae(1144),Dn=Ae(6495),vt=Ae(2206),Ye=Ae(4532),Ft=Ae(3260);function Ct(Pt,un){return un?function Xt(Pt,un){if(null!=Pt){if((0,pn.c)(Pt))return function _(Pt,un){return(0,d.Xf)(Pt).pipe((0,Me.R)(un),(0,Ne.Q)(un))}(Pt,un);if((0,bn.z)(Pt))return function on(Pt,un){return new ft.y(tt=>{let pt=0;return un.schedule(function(){pt===Pt.length?tt.complete():(tt.next(Pt[pt++]),tt.closed||this.schedule())})})}(Pt,un);if((0,tn.t)(Pt))return function $e(Pt,un){return(0,d.Xf)(Pt).pipe((0,Me.R)(un),(0,Ne.Q)(un))}(Pt,un);if((0,vt.D)(Pt))return Ke(Pt,un);if((0,Dn.T)(Pt))return function je(Pt,un){return new ft.y(tt=>{let pt;return(0,Ve.f)(tt,un,()=>{pt=Pt[yt.h](),(0,Ve.f)(tt,un,()=>{let zt,Bt;try{({value:zt,done:Bt}=pt.next())}catch(an){return void tt.error(an)}Bt?tt.complete():tt.next(zt)},0,!0)}),()=>(0,It.m)(pt?.return)&&pt.return()})}(Pt,un);if((0,Ft.L)(Pt))return function Jt(Pt,un){return Ke((0,Ft.Q)(Pt),un)}(Pt,un)}throw(0,Ye.z)(Pt)}(Pt,un):(0,d.Xf)(Pt)}},8421:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{Xf:()=>pn});var d=Ae(655),Ne=Ae(1144),Me=Ae(8239),_=Ae(9751),$e=Ae(3670),ft=Ae(2206),on=Ae(4532),yt=Ae(6495),It=Ae(3260),Ve=Ae(576),je=Ae(7849),Ke=Ae(8822);function pn(Xt){if(Xt instanceof _.y)return Xt;if(null!=Xt){if((0,$e.c)(Xt))return function tn(Xt){return new _.y(Ct=>{const Pt=Xt[Ke.L]();if((0,Ve.m)(Pt.subscribe))return Pt.subscribe(Ct);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Xt);if((0,Ne.z)(Xt))return function bn(Xt){return new _.y(Ct=>{for(let Pt=0;Pt<Xt.length&&!Ct.closed;Pt++)Ct.next(Xt[Pt]);Ct.complete()})}(Xt);if((0,Me.t)(Xt))return function Dn(Xt){return new _.y(Ct=>{Xt.then(Pt=>{Ct.closed||(Ct.next(Pt),Ct.complete())},Pt=>Ct.error(Pt)).then(null,je.h)})}(Xt);if((0,ft.D)(Xt))return Ye(Xt);if((0,yt.T)(Xt))return function vt(Xt){return new _.y(Ct=>{for(const Pt of Xt)if(Ct.next(Pt),Ct.closed)return;Ct.complete()})}(Xt);if((0,It.L)(Xt))return function Ft(Xt){return Ye((0,It.Q)(Xt))}(Xt)}throw(0,on.z)(Xt)}function Ye(Xt){return new _.y(Ct=>{(function Jt(Xt,Ct){var Pt,un,tt,pt;return(0,d.mG)(this,void 0,void 0,function*(){try{for(Pt=(0,d.KL)(Xt);!(un=yield Pt.next()).done;)if(Ct.next(un.value),Ct.closed)return}catch(zt){tt={error:zt}}finally{try{un&&!un.done&&(pt=Pt.return)&&(yield pt.call(Pt))}finally{if(tt)throw tt.error}}Ct.complete()})})(Xt,Ct).catch(Pt=>Ct.error(Pt))})}},6451:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{T:()=>ft});var d=Ae(8189),Ne=Ae(8421),Me=Ae(515),_=Ae(3269),$e=Ae(8996);function ft(...on){const yt=(0,_.yG)(on),It=(0,_._6)(on,1/0),Ve=on;return Ve.length?1===Ve.length?(0,Ne.Xf)(Ve[0]):(0,d.J)(It)((0,$e.D)(Ve,yt)):Me.E}},5403:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{Q:()=>Me,x:()=>Ne});var d=Ae(930);function Ne(_,$e,ft,on,yt){return new Me(_,$e,ft,on,yt)}class Me extends d.Lv{constructor($e,ft,on,yt,It,Ve){super($e),this.onFinalize=It,this.shouldUnsubscribe=Ve,this._next=ft?function(je){try{ft(je)}catch(Ke){$e.error(Ke)}}:super._next,this._error=yt?function(je){try{yt(je)}catch(Ke){$e.error(Ke)}finally{this.unsubscribe()}}:super._error,this._complete=on?function(){try{on()}catch(je){$e.error(je)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var $e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ft}=this;super.unsubscribe(),!ft&&(null===($e=this.onFinalize)||void 0===$e||$e.call(this))}}}},4004:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{U:()=>Me});var d=Ae(4482),Ne=Ae(5403);function Me(_,$e){return(0,d.e)((ft,on)=>{let yt=0;ft.subscribe((0,Ne.x)(on,It=>{on.next(_.call($e,It,yt++))}))})}},8189:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{J:()=>Me});var d=Ae(5577),Ne=Ae(4671);function Me(_=1/0){return(0,d.z)(Ne.y,_)}},5577:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{z:()=>yt});var d=Ae(4004),Ne=Ae(8421),Me=Ae(4482),_=Ae(9672),$e=Ae(5403),on=Ae(576);function yt(It,Ve,je=1/0){return(0,on.m)(Ve)?yt((Ke,pn)=>(0,d.U)((tn,bn)=>Ve(Ke,tn,pn,bn))((0,Ne.Xf)(It(Ke,pn))),je):("number"==typeof Ve&&(je=Ve),(0,Me.e)((Ke,pn)=>function ft(It,Ve,je,Ke,pn,tn,bn,Dn){const vt=[];let Ye=0,Ft=0,Jt=!1;const Xt=()=>{Jt&&!vt.length&&!Ye&&Ve.complete()},Ct=un=>Ye<Ke?Pt(un):vt.push(un),Pt=un=>{tn&&Ve.next(un),Ye++;let tt=!1;(0,Ne.Xf)(je(un,Ft++)).subscribe((0,$e.x)(Ve,pt=>{pn?.(pt),tn?Ct(pt):Ve.next(pt)},()=>{tt=!0},void 0,()=>{if(tt)try{for(Ye--;vt.length&&Ye<Ke;){const pt=vt.shift();bn?(0,_.f)(Ve,bn,()=>Pt(pt)):Pt(pt)}Xt()}catch(pt){Ve.error(pt)}}))};return It.subscribe((0,$e.x)(Ve,Ct,()=>{Jt=!0,Xt()})),()=>{Dn?.()}}(Ke,pn,It,je)))}},5363:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{Q:()=>_});var d=Ae(9672),Ne=Ae(4482),Me=Ae(5403);function _($e,ft=0){return(0,Ne.e)((on,yt)=>{on.subscribe((0,Me.x)(yt,It=>(0,d.f)(yt,$e,()=>yt.next(It),ft),()=>(0,d.f)(yt,$e,()=>yt.complete(),ft),It=>(0,d.f)(yt,$e,()=>yt.error(It),ft)))})}},3099:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{B:()=>$e});var d=Ae(8421),Ne=Ae(7579),Me=Ae(930),_=Ae(4482);function $e(on={}){const{connector:yt=(()=>new Ne.x),resetOnError:It=!0,resetOnComplete:Ve=!0,resetOnRefCountZero:je=!0}=on;return Ke=>{let pn,tn,bn,Dn=0,vt=!1,Ye=!1;const Ft=()=>{tn?.unsubscribe(),tn=void 0},Jt=()=>{Ft(),pn=bn=void 0,vt=Ye=!1},Xt=()=>{const Ct=pn;Jt(),Ct?.unsubscribe()};return(0,_.e)((Ct,Pt)=>{Dn++,!Ye&&!vt&&Ft();const un=bn=bn??yt();Pt.add(()=>{Dn--,0===Dn&&!Ye&&!vt&&(tn=ft(Xt,je))}),un.subscribe(Pt),!pn&&Dn>0&&(pn=new Me.Hp({next:tt=>un.next(tt),error:tt=>{Ye=!0,Ft(),tn=ft(Jt,It,tt),un.error(tt)},complete:()=>{vt=!0,Ft(),tn=ft(Jt,Ve),un.complete()}}),(0,d.Xf)(Ct).subscribe(pn))})(Ke)}}function ft(on,yt,...It){if(!0===yt)return void on();if(!1===yt)return;const Ve=new Me.Hp({next:()=>{Ve.unsubscribe(),on()}});return(0,d.Xf)(yt(...It)).subscribe(Ve)}},9468:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{R:()=>Ne});var d=Ae(4482);function Ne(Me,_=0){return(0,d.e)(($e,ft)=>{ft.add(Me.schedule(()=>$e.subscribe(ft),_))})}},3410:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{z:()=>d});const d={setTimeout(Ne,Me,..._){const{delegate:$e}=d;return $e?.setTimeout?$e.setTimeout(Ne,Me,..._):setTimeout(Ne,Me,..._)},clearTimeout(Ne){const{delegate:Me}=d;return(Me?.clearTimeout||clearTimeout)(Ne)},delegate:void 0}},2202:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{h:()=>Ne});const Ne=function d(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{L:()=>d});const d="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{_6:()=>ft,jO:()=>_,yG:()=>$e});var d=Ae(576),Ne=Ae(3532);function Me(on){return on[on.length-1]}function _(on){return(0,d.m)(Me(on))?on.pop():void 0}function $e(on){return(0,Ne.K)(Me(on))?on.pop():void 0}function ft(on,yt){return"number"==typeof Me(on)?on.pop():yt}},8737:(ui,Kt,Ae)=>{"use strict";function d(Ne,Me){if(Ne){const _=Ne.indexOf(Me);0<=_&&Ne.splice(_,1)}}Ae.d(Kt,{P:()=>d})},3888:(ui,Kt,Ae)=>{"use strict";function d(Ne){const _=Ne($e=>{Error.call($e),$e.stack=(new Error).stack});return _.prototype=Object.create(Error.prototype),_.prototype.constructor=_,_}Ae.d(Kt,{d:()=>d})},2806:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{O:()=>_,x:()=>Me});var d=Ae(2416);let Ne=null;function Me($e){if(d.v.useDeprecatedSynchronousErrorHandling){const ft=!Ne;if(ft&&(Ne={errorThrown:!1,error:null}),$e(),ft){const{errorThrown:on,error:yt}=Ne;if(Ne=null,on)throw yt}}else $e()}function _($e){d.v.useDeprecatedSynchronousErrorHandling&&Ne&&(Ne.errorThrown=!0,Ne.error=$e)}},9672:(ui,Kt,Ae)=>{"use strict";function d(Ne,Me,_,$e=0,ft=!1){const on=Me.schedule(function(){_(),ft?Ne.add(this.schedule(null,$e)):this.unsubscribe()},$e);if(Ne.add(on),!ft)return on}Ae.d(Kt,{f:()=>d})},4671:(ui,Kt,Ae)=>{"use strict";function d(Ne){return Ne}Ae.d(Kt,{y:()=>d})},1144:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{z:()=>d});const d=Ne=>Ne&&"number"==typeof Ne.length&&"function"!=typeof Ne},2206:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{D:()=>Ne});var d=Ae(576);function Ne(Me){return Symbol.asyncIterator&&(0,d.m)(Me?.[Symbol.asyncIterator])}},576:(ui,Kt,Ae)=>{"use strict";function d(Ne){return"function"==typeof Ne}Ae.d(Kt,{m:()=>d})},3670:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{c:()=>Me});var d=Ae(8822),Ne=Ae(576);function Me(_){return(0,Ne.m)(_[d.L])}},6495:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{T:()=>Me});var d=Ae(2202),Ne=Ae(576);function Me(_){return(0,Ne.m)(_?.[d.h])}},8239:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{t:()=>Ne});var d=Ae(576);function Ne(Me){return(0,d.m)(Me?.then)}},3260:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{L:()=>_,Q:()=>Me});var d=Ae(655),Ne=Ae(576);function Me($e){return(0,d.FC)(this,arguments,function*(){const on=$e.getReader();try{for(;;){const{value:yt,done:It}=yield(0,d.qq)(on.read());if(It)return yield(0,d.qq)(void 0);yield yield(0,d.qq)(yt)}}finally{on.releaseLock()}})}function _($e){return(0,Ne.m)($e?.getReader)}},3532:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{K:()=>Ne});var d=Ae(576);function Ne(Me){return Me&&(0,d.m)(Me.schedule)}},4482:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{A:()=>Ne,e:()=>Me});var d=Ae(576);function Ne(_){return(0,d.m)(_?.lift)}function Me(_){return $e=>{if(Ne($e))return $e.lift(function(ft){try{return _(ft,this)}catch(on){this.error(on)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(ui,Kt,Ae)=>{"use strict";function d(){}Ae.d(Kt,{Z:()=>d})},9635:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{U:()=>Me,z:()=>Ne});var d=Ae(4671);function Ne(..._){return Me(_)}function Me(_){return 0===_.length?d.y:1===_.length?_[0]:function(ft){return _.reduce((on,yt)=>yt(on),ft)}}},7849:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{h:()=>Me});var d=Ae(2416),Ne=Ae(3410);function Me(_){Ne.z.setTimeout(()=>{const{onUnhandledError:$e}=d.v;if(!$e)throw _;$e(_)})}},4532:(ui,Kt,Ae)=>{"use strict";function d(Ne){return new TypeError(`You provided ${null!==Ne&&"object"==typeof Ne?"an invalid object":`'${Ne}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}Ae.d(Kt,{z:()=>d})},655:(ui,Kt,Ae)=>{"use strict";function _(mt,gt){var Dt={};for(var Ht in mt)Object.prototype.hasOwnProperty.call(mt,Ht)&&gt.indexOf(Ht)<0&&(Dt[Ht]=mt[Ht]);if(null!=mt&&"function"==typeof Object.getOwnPropertySymbols){var nn=0;for(Ht=Object.getOwnPropertySymbols(mt);nn<Ht.length;nn++)gt.indexOf(Ht[nn])<0&&Object.prototype.propertyIsEnumerable.call(mt,Ht[nn])&&(Dt[Ht[nn]]=mt[Ht[nn]])}return Dt}function Ke(mt,gt,Dt,Ht){return new(Dt||(Dt=Promise))(function(en,wn){function Cn(zn){try{qn(Ht.next(zn))}catch(vn){wn(vn)}}function rr(zn){try{qn(Ht.throw(zn))}catch(vn){wn(vn)}}function qn(zn){zn.done?en(zn.value):function nn(en){return en instanceof Dt?en:new Dt(function(wn){wn(en)})}(zn.value).then(Cn,rr)}qn((Ht=Ht.apply(mt,gt||[])).next())})}function Xt(mt){return this instanceof Xt?(this.v=mt,this):new Xt(mt)}function Ct(mt,gt,Dt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var nn,Ht=Dt.apply(mt,gt||[]),en=[];return nn={},wn("next"),wn("throw"),wn("return"),nn[Symbol.asyncIterator]=function(){return this},nn;function wn(Qi){Ht[Qi]&&(nn[Qi]=function(Pi){return new Promise(function(dr,Vn){en.push([Qi,Pi,dr,Vn])>1||Cn(Qi,Pi)})})}function Cn(Qi,Pi){try{!function rr(Qi){Qi.value instanceof Xt?Promise.resolve(Qi.value.v).then(qn,zn):vn(en[0][2],Qi)}(Ht[Qi](Pi))}catch(dr){vn(en[0][3],dr)}}function qn(Qi){Cn("next",Qi)}function zn(Qi){Cn("throw",Qi)}function vn(Qi,Pi){Qi(Pi),en.shift(),en.length&&Cn(en[0][0],en[0][1])}}function un(mt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Dt,gt=mt[Symbol.asyncIterator];return gt?gt.call(mt):(mt=function Dn(mt){var gt="function"==typeof Symbol&&Symbol.iterator,Dt=gt&&mt[gt],Ht=0;if(Dt)return Dt.call(mt);if(mt&&"number"==typeof mt.length)return{next:function(){return mt&&Ht>=mt.length&&(mt=void 0),{value:mt&&mt[Ht++],done:!mt}}};throw new TypeError(gt?"Object is not iterable.":"Symbol.iterator is not defined.")}(mt),Dt={},Ht("next"),Ht("throw"),Ht("return"),Dt[Symbol.asyncIterator]=function(){return this},Dt);function Ht(en){Dt[en]=mt[en]&&function(wn){return new Promise(function(Cn,rr){!function nn(en,wn,Cn,rr){Promise.resolve(rr).then(function(qn){en({value:qn,done:Cn})},wn)}(Cn,rr,(wn=mt[en](wn)).done,wn.value)})}}}Ae.d(Kt,{FC:()=>Ct,KL:()=>un,_T:()=>_,mG:()=>Ke,qq:()=>Xt})},4650:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{$8M:()=>eu,$WT:()=>Ao,$Z:()=>Dx,AFp:()=>nS,ALo:()=>FC,AaK:()=>yt,BQk:()=>wy,CHM:()=>Tp,CRH:()=>kn,CZH:()=>Iw,CqO:()=>Zx,D6c:()=>ir,DdM:()=>AC,EJc:()=>IA,EiD:()=>Jp,EpF:()=>_0,F$t:()=>Lg,F4k:()=>y0,FYo:()=>fx,FiY:()=>ge,Gf:()=>si,GfV:()=>px,GkF:()=>Cy,Gpc:()=>je,Gre:()=>Di,Hsn:()=>Ng,Ikx:()=>yu,JOm:()=>Li,JVY:()=>Zp,JZr:()=>Dn,Jf7:()=>Hv,KtG:()=>Ed,L6k:()=>Fv,LAX:()=>k_,LFG:()=>cn,LSH:()=>zd,Lbi:()=>EA,Lck:()=>bI,MAs:()=>m0,MMx:()=>mw,NdJ:()=>Fg,O4$:()=>Wc,OlP:()=>xr,Oqu:()=>xt,P3R:()=>Ul,PXZ:()=>cb,Q6J:()=>ad,QGY:()=>ep,QbO:()=>oS,Qsj:()=>Gv,R0b:()=>ia,RDi:()=>tx,Rgc:()=>Ha,SBq:()=>Js,Sil:()=>lS,Suo:()=>jI,TTD:()=>Du,TgZ:()=>bm,Udp:()=>y,VKq:()=>Y0,W1O:()=>HI,X6Q:()=>iE,XFs:()=>In,Xpm:()=>En,Xts:()=>Eo,Y36:()=>dm,YKP:()=>vI,YNc:()=>lC,Yjl:()=>fr,Yz7:()=>vn,Z0I:()=>Vn,ZZ4:()=>cE,_Bn:()=>yI,_UZ:()=>kg,_Vd:()=>Vd,_c5:()=>UA,_uU:()=>Tt,aQg:()=>r_,c2e:()=>TA,cJS:()=>Pi,cg1:()=>rp,dDg:()=>Xh,dqk:()=>pi,eBb:()=>Nh,eFA:()=>XC,eJc:()=>xw,ekj:()=>w,eoX:()=>Wy,f3M:()=>Sn,g9A:()=>rS,h0i:()=>Zg,hGG:()=>jA,hij:()=>kt,iGM:()=>Hn,ifc:()=>Y,ip1:()=>tS,jDz:()=>wI,kL8:()=>Zl,kcU:()=>Lu,lG2:()=>hr,lqb:()=>Vh,lri:()=>ab,mCW:()=>Yp,n5z:()=>Co,n_E:()=>Yg,oAB:()=>Ci,oxw:()=>mu,pB0:()=>ya,q3G:()=>Qo,q4F:()=>Uh,qLn:()=>ag,qOj:()=>pm,qZA:()=>Wh,qzn:()=>vc,rWj:()=>Sm,s9C:()=>zg,sBO:()=>gS,s_b:()=>vw,soG:()=>ob,tBr:()=>de,tb:()=>Zy,tp0:()=>ye,uIk:()=>gm,vHH:()=>vt,vpe:()=>Xd,wAp:()=>mi,xi3:()=>NC,xp6:()=>vx,ynx:()=>Rg,z2F:()=>gr,z3N:()=>Xs,zSh:()=>U_,zs3:()=>sm});var d=Ae(7579),Ne=Ae(727),Me=Ae(9751),_=Ae(6451),$e=Ae(3099);function ft(u){for(let h in u)if(u[h]===ft)return h;throw Error("Could not find renamed property on target object.")}function on(u,h){for(const m in h)h.hasOwnProperty(m)&&!u.hasOwnProperty(m)&&(u[m]=h[m])}function yt(u){if("string"==typeof u)return u;if(Array.isArray(u))return"["+u.map(yt).join(", ")+"]";if(null==u)return""+u;if(u.overriddenName)return`${u.overriddenName}`;if(u.name)return`${u.name}`;const h=u.toString();if(null==h)return""+h;const m=h.indexOf("\n");return-1===m?h:h.substring(0,m)}function It(u,h){return null==u||""===u?null===h?"":h:null==h||""===h?u:u+" "+h}const Ve=ft({__forward_ref__:ft});function je(u){return u.__forward_ref__=je,u.toString=function(){return yt(this())},u}function Ke(u){return pn(u)?u():u}function pn(u){return"function"==typeof u&&u.hasOwnProperty(Ve)&&u.__forward_ref__===je}function tn(u){return u&&!!u.\u0275providers}const Dn="https://g.co/ng/security#xss";class vt extends Error{constructor(h,m){super(Ye(h,m)),this.code=h}}function Ye(u,h){return`NG0${Math.abs(u)}${h?": "+h.trim():""}`}function Ft(u){return"string"==typeof u?u:null==u?"":String(u)}function un(u,h){throw new vt(-201,!1)}function wn(u,h){null==u&&function Cn(u,h,m,x){throw new Error(`ASSERTION ERROR: ${u}`+(null==x?"":` [Expected=> ${m} ${x} ${h} <=Actual]`))}(h,u,null,"!=")}function vn(u){return{token:u.token,providedIn:u.providedIn||null,factory:u.factory,value:void 0}}function Pi(u){return{providers:u.providers||[],imports:u.imports||[]}}function dr(u){return kr(u,Ds)||kr(u,Ir)}function Vn(u){return null!==dr(u)}function kr(u,h){return u.hasOwnProperty(h)?u[h]:null}function so(u){return u&&(u.hasOwnProperty(_s)||u.hasOwnProperty(jr))?u[_s]:null}const Ds=ft({\u0275prov:ft}),_s=ft({\u0275inj:ft}),Ir=ft({ngInjectableDef:ft}),jr=ft({ngInjectorDef:ft});var In=(()=>((In=In||{})[In.Default=0]="Default",In[In.Host=1]="Host",In[In.Self=2]="Self",In[In.SkipSelf=4]="SkipSelf",In[In.Optional=8]="Optional",In))();let zo;function vo(u){const h=zo;return zo=u,h}function $r(u,h,m){const x=dr(u);return x&&"root"==x.providedIn?void 0===x.value?x.value=x.factory():x.value:m&In.Optional?null:void 0!==h?h:void un(yt(u))}const pi=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Sr={},Xr="__NG_DI_FLAG__",Do="ngTempTokenPath",ao="ngTokenPath",ys=/\n/gm,wi="\u0275",Vs="__source";let Ei;function lo(u){const h=Ei;return Ei=u,h}function Hr(u,h=In.Default){if(void 0===Ei)throw new vt(-203,!1);return null===Ei?$r(u,void 0,h):Ei.get(u,h&In.Optional?null:void 0,h)}function cn(u,h=In.Default){return(function ls(){return zo}()||Hr)(Ke(u),h)}function Sn(u,h=In.Default){return cn(u,Zn(h))}function Zn(u){return typeof u>"u"||"number"==typeof u?u:0|(u.optional&&8)|(u.host&&1)|(u.self&&2)|(u.skipSelf&&4)}function ei(u){const h=[];for(let m=0;m<u.length;m++){const x=Ke(u[m]);if(Array.isArray(x)){if(0===x.length)throw new vt(900,!1);let T,A=In.Default;for(let N=0;N<x.length;N++){const W=x[N],Q=Qr(W);"number"==typeof Q?-1===Q?T=W.token:A|=Q:T=W}h.push(cn(T,A))}else h.push(cn(x))}return h}function ki(u,h){return u[Xr]=h,u.prototype[Xr]=h,u}function Qr(u){return u[Xr]}function $(u){return{toString:u}.toString()}var H=(()=>((H=H||{})[H.OnPush=0]="OnPush",H[H.Default=1]="Default",H))(),Y=(()=>{return(u=Y||(Y={}))[u.Emulated=0]="Emulated",u[u.None=2]="None",u[u.ShadowDom=3]="ShadowDom",Y;var u})();const se={},fe=[],Oe=ft({\u0275cmp:ft}),Be=ft({\u0275dir:ft}),Pe=ft({\u0275pipe:ft}),He=ft({\u0275mod:ft}),it=ft({\u0275fac:ft}),jt=ft({__NG_ELEMENT_ID__:ft});let _t=0;function En(u){return $(()=>{const h=Ya(u),m={...h,decls:u.decls,vars:u.vars,template:u.template,consts:u.consts||null,ngContentSelectors:u.ngContentSelectors,onPush:u.changeDetection===H.OnPush,directiveDefs:null,pipeDefs:null,dependencies:h.standalone&&u.dependencies||null,getStandaloneInjector:null,data:u.data||{},encapsulation:u.encapsulation||Y.Emulated,id:"c"+_t++,styles:u.styles||fe,_:null,schemas:u.schemas||null,tView:null};oh(m);const x=u.dependencies;return m.directiveDefs=us(x,!1),m.pipeDefs=us(x,!0),m})}function Fn(u){return Zi(u)||Rr(u)}function ni(u){return null!==u}function Ci(u){return $(()=>({type:u.type,bootstrap:u.bootstrap||fe,declarations:u.declarations||fe,imports:u.imports||fe,exports:u.exports||fe,transitiveCompileScopes:null,schemas:u.schemas||null,id:u.id||null}))}function $n(u,h){if(null==u)return se;const m={};for(const x in u)if(u.hasOwnProperty(x)){let T=u[x],A=T;Array.isArray(T)&&(A=T[1],T=T[0]),m[T]=x,h&&(h[T]=A)}return m}function hr(u){return $(()=>{const h=Ya(u);return oh(h),h})}function fr(u){return{type:u.type,name:u.name,factory:null,pure:!1!==u.pure,standalone:!0===u.standalone,onDestroy:u.type.prototype.ngOnDestroy||null}}function Zi(u){return u[Oe]||null}function Rr(u){return u[Be]||null}function ut(u){return u[Pe]||null}function Ao(u){const h=Zi(u)||Rr(u)||ut(u);return null!==h&&h.standalone}function cr(u,h){const m=u[He]||null;if(!m&&!0===h)throw new Error(`Type ${yt(u)} does not have '\u0275mod' property.`);return m}function Ya(u){const h={};return{type:u.type,providersResolver:null,factory:null,hostBindings:u.hostBindings||null,hostVars:u.hostVars||0,hostAttrs:u.hostAttrs||null,contentQueries:u.contentQueries||null,declaredInputs:h,exportAs:u.exportAs||null,standalone:!0===u.standalone,selectors:u.selectors||fe,viewQuery:u.viewQuery||null,features:u.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:$n(u.inputs,h),outputs:$n(u.outputs)}}function oh(u){u.features?.forEach(h=>h(u))}function us(u,h){if(!u)return null;const m=h?ut:Fn;return()=>("function"==typeof u?u():u).map(x=>m(x)).filter(ni)}const As=0,Mn=1,Ti=2,Nt=3,ri=4,_i=5,ur=6,Ps=7,Gn=8,Bo=9,Cl=10,bi=11,Vo=12,ji=13,_d=14,co=15,ds=16,Us=17,sa=18,bo=19,aa=20,Fc=21,yi=22,Zo=1,Jr=2,El=7,nc=8,xo=9,Cr=10;function Yo(u){return Array.isArray(u)&&"object"==typeof u[Zo]}function Ji(u){return Array.isArray(u)&&!0===u[Zo]}function Lc(u){return 0!=(4&u.flags)}function Nc(u){return u.componentOffset>-1}function js(u){return 1==(1&u.flags)}function zr(u){return!!u.template}function Eu(u){return 0!=(256&u[Ti])}function ic(u,h){return u.hasOwnProperty(it)?u[it]:null}class zc{constructor(h,m,x){this.previousValue=h,this.currentValue=m,this.firstChange=x}isFirstChange(){return this.firstChange}}function Du(){return Bc}function Bc(u){return u.type.prototype.ngOnChanges&&(u.setInput=xd),rc}function rc(){const u=Yi(this),h=u?.current;if(h){const m=u.previous;if(m===se)u.previous=h;else for(let x in h)m[x]=h[x];u.current=null,this.ngOnChanges(h)}}function xd(u,h,m,x){const T=this.declaredInputs[m],A=Yi(u)||function wd(u,h){return u[oc]=h}(u,{previous:se,current:null}),N=A.current||(A.current={}),W=A.previous,Q=W[T];N[T]=new zc(Q&&Q.currentValue,h,W===se),u[x]=h}Du.ngInherit=!0;const oc="__ngSimpleChanges__";function Yi(u){return u[oc]||null}const Ko=function(u,h,m){},Au="svg";function to(u){for(;Array.isArray(u);)u=u[As];return u}function Sl(u,h){return to(h[u])}function uo(u,h){return to(h[u.index])}function Ou(u,h){return u.data[h]}function la(u,h){return u[h]}function di(u,h){const m=h[u];return Yo(m)?m:m[As]}function sc(u){return 64==(64&u[Ti])}function ca(u,h){return null==h?null:u[h]}function sh(u){u[sa]=0}function Gc(u,h){u[_i]+=h;let m=u,x=u[Nt];for(;null!==x&&(1===h&&1===m[_i]||-1===h&&0===m[_i]);)x[_i]+=h,m=x,x=x[Nt]}const Ii={lFrame:Hm(null),bindingsEnabled:!0};function Ep(){return Ii.bindingsEnabled}function qt(){return Ii.lFrame.lView}function $i(){return Ii.lFrame.tView}function Tp(u){return Ii.lFrame.contextLView=u,u[Gn]}function Ed(u){return Ii.lFrame.contextLView=null,u}function Po(){let u=Xa();for(;null!==u&&64===u.type;)u=u.parent;return u}function Xa(){return Ii.lFrame.currentTNode}function Qa(u,h){const m=Ii.lFrame;m.currentTNode=u,m.isParent=h}function Hc(){return Ii.lFrame.isParent}function uh(){Ii.lFrame.isParent=!1}function Xo(){const u=Ii.lFrame;let h=u.bindingRootIndex;return-1===h&&(h=u.bindingRootIndex=u.tView.bindingStartIndex),h}function Dl(){return Ii.lFrame.bindingIndex++}function Ja(u){const h=Ii.lFrame,m=h.bindingIndex;return h.bindingIndex=h.bindingIndex+u,m}function ac(u,h){const m=Ii.lFrame;m.bindingIndex=m.bindingRootIndex=u,Ma(h)}function Ma(u){Ii.lFrame.currentDirectiveIndex=u}function Fu(){return Ii.lFrame.currentQueryIndex}function Dp(u){Ii.lFrame.currentQueryIndex=u}function Gm(u){const h=u[Mn];return 2===h.type?h.declTNode:1===h.type?u[ur]:null}function Ap(u,h,m){if(m&In.SkipSelf){let T=h,A=u;for(;!(T=T.parent,null!==T||m&In.Host||(T=Gm(A),null===T||(A=A[co],10&T.type))););if(null===T)return!1;h=T,u=A}const x=Ii.lFrame=Pp();return x.currentTNode=h,x.lView=u,!0}function mf(u){const h=Pp(),m=u[Mn];Ii.lFrame=h,h.currentTNode=m.firstChild,h.lView=u,h.tView=m,h.contextLView=u,h.bindingIndex=m.bindingStartIndex,h.inI18n=!1}function Pp(){const u=Ii.lFrame,h=null===u?null:u.child;return null===h?Hm(u):h}function Hm(u){const h={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:u,child:null,inI18n:!1};return null!==u&&(u.child=h),h}function gf(){const u=Ii.lFrame;return Ii.lFrame=u.parent,u.currentTNode=null,u.lView=null,u}const _f=gf;function yf(){const u=gf();u.isParent=!0,u.tView=null,u.selectedIndex=-1,u.contextLView=null,u.elementDepthCount=0,u.currentDirectiveIndex=-1,u.currentNamespace=null,u.bindingRootIndex=-1,u.bindingIndex=-1,u.currentQueryIndex=0}function bs(){return Ii.lFrame.selectedIndex}function Os(u){Ii.lFrame.selectedIndex=u}function pr(){const u=Ii.lFrame;return Ou(u.tView,u.selectedIndex)}function Wc(){Ii.lFrame.currentNamespace=Au}function Lu(){!function lc(){Ii.lFrame.currentNamespace=null}()}function Nu(u,h){for(let m=h.directiveStart,x=h.directiveEnd;m<x;m++){const A=u.data[m].type.prototype,{ngAfterContentInit:N,ngAfterContentChecked:W,ngAfterViewInit:Q,ngAfterViewChecked:re,ngOnDestroy:he}=A;N&&(u.contentHooks??(u.contentHooks=[])).push(-m,N),W&&((u.contentHooks??(u.contentHooks=[])).push(m,W),(u.contentCheckHooks??(u.contentCheckHooks=[])).push(m,W)),Q&&(u.viewHooks??(u.viewHooks=[])).push(-m,Q),re&&((u.viewHooks??(u.viewHooks=[])).push(m,re),(u.viewCheckHooks??(u.viewCheckHooks=[])).push(m,re)),null!=he&&(u.destroyHooks??(u.destroyHooks=[])).push(m,he)}}function Id(u,h,m){Da(u,h,3,m)}function cc(u,h,m,x){(3&u[Ti])===m&&Da(u,h,m,x)}function Al(u,h){let m=u[Ti];(3&m)===h&&(m&=2047,m+=1,u[Ti]=m)}function Da(u,h,m,x){const A=x??-1,N=h.length-1;let W=0;for(let Q=void 0!==x?65535&u[sa]:0;Q<N;Q++)if("number"==typeof h[Q+1]){if(W=h[Q],null!=x&&W>=x)break}else h[Q]<0&&(u[sa]+=65536),(W<A||-1==A)&&(vf(u,m,h,Q),u[sa]=(4294901760&u[sa])+Q+2),Q++}function vf(u,h,m,x){const T=m[x]<0,A=m[x+1],W=u[T?-m[x]:m[x]];if(T){if(u[Ti]>>11<u[sa]>>16&&(3&u[Ti])===h){u[Ti]+=2048,Ko(4,W,A);try{A.call(W)}finally{Ko(5,W,A)}}}else{Ko(4,W,A);try{A.call(W)}finally{Ko(5,W,A)}}}const ua=-1;class zu{constructor(h,m,x){this.factory=h,this.resolving=!1,this.canSeeViewProviders=m,this.injectImpl=x}}function hn(u,h,m){let x=0;for(;x<m.length;){const T=m[x];if("number"==typeof T){if(0!==T)break;x++;const A=m[x++],N=m[x++],W=m[x++];u.setAttribute(h,N,W,A)}else{const A=T,N=m[++x];Md(A)?u.setProperty(h,A,N):u.setAttribute(h,A,N),x++}}return x}function or(u){return 3===u||4===u||6===u}function Md(u){return 64===u.charCodeAt(0)}function Aa(u,h){if(null!==h&&0!==h.length)if(null===u||0===u.length)u=h.slice();else{let m=-1;for(let x=0;x<h.length;x++){const T=h[x];"number"==typeof T?m=T:0===m||Yc(u,m,T,null,-1===m||2===m?h[++x]:null)}}return u}function Yc(u,h,m,x,T){let A=0,N=u.length;if(-1===h)N=-1;else for(;A<u.length;){const W=u[A++];if("number"==typeof W){if(W===h){N=-1;break}if(W>h){N=A-1;break}}}for(;A<u.length;){const W=u[A];if("number"==typeof W)break;if(W===m){if(null===x)return void(null!==T&&(u[A+1]=T));if(x===u[A+1])return void(u[A+2]=T)}A++,null!==x&&A++,null!==T&&A++}-1!==N&&(u.splice(N,0,h),A=N+1),u.splice(A++,0,m),null!==x&&u.splice(A++,0,x),null!==T&&u.splice(A++,0,T)}function tl(u){return u!==ua}function Dd(u){return 32767&u}function Kc(u,h){let m=function ph(u){return u>>16}(u),x=h;for(;m>0;)x=x[co],m--;return x}let Xc=!0;function Pa(u){const h=Xc;return Xc=u,h}const qr=255,Rl=5;let mh=0;const ks={};function Fl(u,h){const m=Od(u,h);if(-1!==m)return m;const x=h[Mn];x.firstCreatePass&&(u.injectorIndex=h.length,Qc(x.data,u),Qc(h,null),Qc(x.blueprint,null));const T=Oa(u,h),A=u.injectorIndex;if(tl(T)){const N=Dd(T),W=Kc(T,h),Q=W[Mn].data;for(let re=0;re<8;re++)h[A+re]=W[N+re]|Q[N+re]}return h[A+8]=T,A}function Qc(u,h){u.push(0,0,0,0,0,0,0,0,h)}function Od(u,h){return-1===u.injectorIndex||u.parent&&u.parent.injectorIndex===u.injectorIndex||null===h[u.injectorIndex+8]?-1:u.injectorIndex}function Oa(u,h){if(u.parent&&-1!==u.parent.injectorIndex)return u.parent.injectorIndex;let m=0,x=null,T=h;for(;null!==T;){if(x=Ef(T),null===x)return ua;if(m++,T=T[co],-1!==x.injectorIndex)return x.injectorIndex|m<<16}return ua}function Bu(u,h,m){!function Pd(u,h,m){let x;"string"==typeof m?x=m.charCodeAt(0)||0:m.hasOwnProperty(jt)&&(x=m[jt]),null==x&&(x=m[jt]=mh++);const T=x&qr;h.data[u+(T>>Rl)]|=1<<T}(u,h,m)}function kd(u,h,m){if(m&In.Optional||void 0!==u)return u;un()}function gh(u,h,m,x){if(m&In.Optional&&void 0===x&&(x=null),!(m&(In.Self|In.Host))){const T=u[Bo],A=vo(void 0);try{return T?T.get(h,x,m&In.Optional):$r(h,x,m&In.Optional)}finally{vo(A)}}return kd(x,0,m)}function _h(u,h,m,x=In.Default,T){if(null!==u){if(1024&h[Ti]){const N=function Cf(u,h,m,x,T){let A=u,N=h;for(;null!==A&&null!==N&&1024&N[Ti]&&!(256&N[Ti]);){const W=yh(A,N,m,x|In.Self,ks);if(W!==ks)return W;let Q=A.parent;if(!Q){const re=N[Fc];if(re){const he=re.get(m,ks,x);if(he!==ks)return he}Q=Ef(N),N=N[co]}A=Q}return T}(u,h,m,x,ks);if(N!==ks)return N}const A=yh(u,h,m,x,ks);if(A!==ks)return A}return gh(h,m,x,T)}function yh(u,h,m,x,T){const A=function bf(u){if("string"==typeof u)return u.charCodeAt(0)||0;const h=u.hasOwnProperty(jt)?u[jt]:void 0;return"number"==typeof h?h>=0?h&qr:vh:h}(m);if("function"==typeof A){if(!Ap(h,u,x))return x&In.Host?kd(T,0,x):gh(h,m,x,T);try{const N=A(x);if(null!=N||x&In.Optional)return N;un()}finally{_f()}}else if("number"==typeof A){let N=null,W=Od(u,h),Q=ua,re=x&In.Host?h[ds][ur]:null;for((-1===W||x&In.SkipSelf)&&(Q=-1===W?Oa(u,h):h[W+8],Q!==ua&&Rd(x,!1)?(N=h[Mn],W=Dd(Q),h=Kc(Q,h)):W=-1);-1!==W;){const he=h[Mn];if(xf(A,W,he.data)){const Se=uc(W,h,m,N,x,re);if(Se!==ks)return Se}Q=h[W+8],Q!==ua&&Rd(x,h[Mn].data[W+8]===re)&&xf(A,W,h)?(N=he,W=Dd(Q),h=Kc(Q,h)):W=-1}}return T}function uc(u,h,m,x,T,A){const N=h[Mn],W=N.data[u+8],he=Vu(W,N,m,null==x?Nc(W)&&Xc:x!=N&&0!=(3&W.type),T&In.Host&&A===W);return null!==he?da(h,N,he,W):ks}function Vu(u,h,m,x,T){const A=u.providerIndexes,N=h.data,W=1048575&A,Q=u.directiveStart,he=A>>20,We=T?W+he:u.directiveEnd;for(let dt=x?W:W+he;dt<We;dt++){const Rt=N[dt];if(dt<Q&&m===Rt||dt>=Q&&Rt.type===m)return dt}if(T){const dt=N[Q];if(dt&&zr(dt)&&dt.type===m)return Q}return null}function da(u,h,m,x){let T=u[m];const A=h.data;if(function Sd(u){return u instanceof zu}(T)){const N=T;N.resolving&&function Xt(u,h){const m=h?`. Dependency path: ${h.join(" > ")} > ${u}`:"";throw new vt(-200,`Circular dependency in DI detected for ${u}${m}`)}(function Jt(u){return"function"==typeof u?u.name||u.toString():"object"==typeof u&&null!=u&&"function"==typeof u.type?u.type.name||u.type.toString():Ft(u)}(A[m]));const W=Pa(N.canSeeViewProviders);N.resolving=!0;const Q=N.injectImpl?vo(N.injectImpl):null;Ap(u,x,In.Default);try{T=u[m]=N.factory(void 0,A,u,x),h.firstCreatePass&&m>=x.directiveStart&&function qi(u,h,m){const{ngOnChanges:x,ngOnInit:T,ngDoCheck:A}=h.type.prototype;if(x){const N=Bc(h);(m.preOrderHooks??(m.preOrderHooks=[])).push(u,N),(m.preOrderCheckHooks??(m.preOrderCheckHooks=[])).push(u,N)}T&&(m.preOrderHooks??(m.preOrderHooks=[])).push(0-u,T),A&&((m.preOrderHooks??(m.preOrderHooks=[])).push(u,A),(m.preOrderCheckHooks??(m.preOrderCheckHooks=[])).push(u,A))}(m,A[m],h)}finally{null!==Q&&vo(Q),Pa(W),N.resolving=!1,_f()}}return T}function xf(u,h,m){return!!(m[h+(u>>Rl)]&1<<u)}function Rd(u,h){return!(u&In.Self||u&In.Host&&h)}class Jc{constructor(h,m){this._tNode=h,this._lView=m}get(h,m,x){return _h(this._tNode,this._lView,h,Zn(x),m)}}function vh(){return new Jc(Po(),qt())}function Co(u){return $(()=>{const h=u.prototype.constructor,m=h[it]||wf(h),x=Object.prototype;let T=Object.getPrototypeOf(u.prototype).constructor;for(;T&&T!==x;){const A=T[it]||wf(T);if(A&&A!==m)return A;T=Object.getPrototypeOf(T)}return A=>new A})}function wf(u){return pn(u)?()=>{const h=wf(Ke(u));return h&&h()}:ic(u)}function Ef(u){const h=u[Mn],m=h.type;return 2===m?h.declTNode:1===m?u[ur]:null}function eu(u){return function Rp(u,h){if("class"===h)return u.classes;if("style"===h)return u.styles;const m=u.attrs;if(m){const x=m.length;let T=0;for(;T<x;){const A=m[T];if(or(A))break;if(0===A)T+=2;else if("number"==typeof A)for(T++;T<x&&"string"==typeof m[T];)T++;else{if(A===h)return m[T+1];T+=2}}}return null}(Po(),u)}const Uu="__parameters__";function mn(u,h,m){return $(()=>{const x=function ju(u){return function(...m){if(u){const x=u(...m);for(const T in x)this[T]=x[T]}}}(h);function T(...A){if(this instanceof T)return x.apply(this,A),this;const N=new T(...A);return W.annotation=N,W;function W(Q,re,he){const Se=Q.hasOwnProperty(Uu)?Q[Uu]:Object.defineProperty(Q,Uu,{value:[]})[Uu];for(;Se.length<=he;)Se.push(null);return(Se[he]=Se[he]||[]).push(N),Q}}return m&&(T.prototype=Object.create(m.prototype)),T.prototype.ngMetadataName=u,T.annotationCls=T,T})}class xr{constructor(h,m){this._desc=h,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof m?this.__NG_ELEMENT_ID__=m:void 0!==m&&(this.\u0275prov=vn({token:this,providedIn:m.providedIn||"root",factory:m.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function tu(u,h){u.forEach(m=>Array.isArray(m)?tu(m,h):h(m))}function Np(u,h,m){h>=u.length?u.push(m):u.splice(h,0,m)}function nu(u,h){return h>=u.length-1?u.pop():u.splice(h,1)[0]}function Hu(u,h){const m=[];for(let x=0;x<u;x++)m.push(h);return m}function Mi(u,h,m){let x=c(u,h);return x>=0?u[1|x]=m:(x=~x,function Fd(u,h,m,x){let T=u.length;if(T==h)u.push(m,x);else if(1===T)u.push(x,u[0]),u[0]=m;else{for(T--,u.push(u[T-1],u[T]);T>h;)u[T]=u[T-2],T--;u[h]=m,u[h+1]=x}}(u,x,h,m)),x}function v(u,h){const m=c(u,h);if(m>=0)return u[1|m]}function c(u,h){return function C(u,h,m){let x=0,T=u.length>>m;for(;T!==x;){const A=x+(T-x>>1),N=u[A<<m];if(h===N)return A<<m;N>h?T=A:x=A+1}return~(T<<m)}(u,h,1)}const de=ki(mn("Inject",u=>({token:u})),-1),ge=ki(mn("Optional"),8),ye=ki(mn("SkipSelf"),4);var Li=(()=>((Li=Li||{})[Li.Important=1]="Important",Li[Li.DashCase=2]="DashCase",Li))();const Wr=new Map;let Ks=0;const Vp="__ngContext__";function fs(u,h){Yo(h)?(u[Vp]=h[aa],function Ll(u){Wr.set(u[aa],u)}(h)):u[Vp]=h}let Zu;function j(u,h){return Zu(u,h)}function R(u){const h=u[Nt];return Ji(h)?h[Nt]:h}function _e(u){return $t(u[ji])}function lt(u){return $t(u[ri])}function $t(u){for(;null!==u&&!Ji(u);)u=u[ri];return u}function Tn(u,h,m,x,T){if(null!=x){let A,N=!1;Ji(x)?A=x:Yo(x)&&(N=!0,x=x[As]);const W=to(x);0===u&&null!==m?null==T?ex(h,m,W):Oh(h,m,W,T||null,!0):1===u&&null!==m?Oh(h,m,W,T||null,!0):2===u?function Gp(u,h,m){const x=kh(u,h);x&&function Qn(u,h,m,x){u.removeChild(h,m,x)}(u,x,h,m)}(h,W,N):3===u&&h.destroyNode(W),null!=A&&function sl(u,h,m,x,T){const A=m[El];A!==to(m)&&Tn(h,u,x,A,T);for(let W=Cr;W<m.length;W++){const Q=m[W];Hp(Q[Mn],Q,u,h,x,A)}}(h,u,A,m,T)}}function ga(u,h,m){return u.createElement(h,m)}function mc(u,h){const m=u[xo],x=m.indexOf(h),T=h[Nt];512&h[Ti]&&(h[Ti]&=-513,Gc(T,-1)),m.splice(x,1)}function Dh(u,h){if(u.length<=Cr)return;const m=Cr+h,x=u[m];if(x){const T=x[Us];null!==T&&T!==u&&mc(T,x),h>0&&(u[m-1][ri]=x[ri]);const A=nu(u,Cr+h);!function rl(u,h){Hp(u,h,h[bi],2,null,null),h[As]=null,h[ur]=null}(x[Mn],x);const N=A[bo];null!==N&&N.detachView(A[Mn]),x[Nt]=null,x[ri]=null,x[Ti]&=-65}return x}function Ah(u,h){if(!(128&h[Ti])){const m=h[bi];m.destroyNode&&Hp(u,h,m,3,null,null),function La(u){let h=u[ji];if(!h)return Sf(u[Mn],u);for(;h;){let m=null;if(Yo(h))m=h[ji];else{const x=h[Cr];x&&(m=x)}if(!m){for(;h&&!h[ri]&&h!==u;)Yo(h)&&Sf(h[Mn],h),h=h[Nt];null===h&&(h=u),Yo(h)&&Sf(h[Mn],h),m=h&&h[ri]}h=m}}(h)}}function Sf(u,h){if(!(128&h[Ti])){h[Ti]&=-65,h[Ti]|=128,function jp(u,h){let m;if(null!=u&&null!=(m=u.destroyHooks))for(let x=0;x<m.length;x+=2){const T=h[m[x]];if(!(T instanceof zu)){const A=m[x+1];if(Array.isArray(A))for(let N=0;N<A.length;N+=2){const W=T[A[N]],Q=A[N+1];Ko(4,W,Q);try{Q.call(W)}finally{Ko(5,W,Q)}}else{Ko(4,T,A);try{A.call(T)}finally{Ko(5,T,A)}}}}}(u,h),function Yu(u,h){const m=u.cleanup,x=h[Ps];let T=-1;if(null!==m)for(let A=0;A<m.length-1;A+=2)if("string"==typeof m[A]){const N=m[A+3];N>=0?x[T=N]():x[T=-N].unsubscribe(),A+=2}else{const N=x[T=m[A+1]];m[A].call(N)}if(null!==x){for(let A=T+1;A<x.length;A++)(0,x[A])();h[Ps]=null}}(u,h),1===h[Mn].type&&h[bi].destroy();const m=h[Us];if(null!==m&&Ji(h[Nt])){m!==h[Nt]&&mc(m,h);const x=h[bo];null!==x&&x.detachView(u)}!function fo(u){Wr.delete(u[aa])}(h)}}function Ph(u,h,m){return function Na(u,h,m){let x=h;for(;null!==x&&40&x.type;)x=(h=x).parent;if(null===x)return m[As];{const{componentOffset:T}=x;if(T>-1){const{encapsulation:A}=u.data[x.directiveStart+T];if(A===Y.None||A===Y.Emulated)return null}return uo(x,m)}}(u,h.parent,m)}function Oh(u,h,m,x,T){u.insertBefore(h,m,x,T)}function ex(u,h,m){u.appendChild(h,m)}function Zr(u,h,m,x,T){null!==x?Oh(u,h,m,x,T):ex(u,h,m)}function kh(u,h){return u.parentNode(h)}function M_(u,h,m){return _c(u,h,m)}let Xm,Ku,mo,al,_c=function Rh(u,h,m){return 40&u.type?uo(u,m):null};function Fh(u,h,m,x){const T=Ph(u,x,h),A=h[bi],W=M_(x.parent||h[ur],x,h);if(null!=T)if(Array.isArray(m))for(let Q=0;Q<m.length;Q++)Zr(A,T,m[Q],W,!1);else Zr(A,T,m,W,!1);void 0!==Xm&&Xm(A,x,h,m,T)}function yc(u,h){if(null!==h){const m=h.type;if(3&m)return uo(h,u);if(4&m)return $p(-1,u[h.index]);if(8&m){const x=h.child;if(null!==x)return yc(u,x);{const T=u[h.index];return Ji(T)?$p(-1,T):to(T)}}if(32&m)return j(h,u)()||to(u[h.index]);{const x=Nd(u,h);return null!==x?Array.isArray(x)?x[0]:yc(R(u[ds]),x):yc(u,h.next)}}return null}function Nd(u,h){return null!==h?u[ds][ur].projection[h.projection]:null}function $p(u,h){const m=Cr+u+1;if(m<h.length){const x=h[m],T=x[Mn].firstChild;if(null!==T)return yc(x,T)}return h[El]}function D_(u,h,m,x,T,A,N){for(;null!=m;){const W=x[m.index],Q=m.type;if(N&&0===h&&(W&&fs(to(W),x),m.flags|=2),32!=(32&m.flags))if(8&Q)D_(u,h,m.child,x,T,A,!1),Tn(h,u,T,W,A);else if(32&Q){const re=j(m,x);let he;for(;he=re();)Tn(h,u,T,he,A);Tn(h,u,T,W,A)}else 16&Q?Mf(u,h,x,m,T,A):Tn(h,u,T,W,A);m=N?m.projectionNext:m.next}}function Hp(u,h,m,x,T,A){D_(m,x,u.firstChild,h,T,A,!1)}function Mf(u,h,m,x,T,A){const N=m[ds],Q=N[ur].projection[x.projection];if(Array.isArray(Q))for(let re=0;re<Q.length;re++)Tn(h,u,T,Q[re],A);else D_(u,h,Q,N[Nt],T,A,!0)}function Df(u,h,m){""===m?u.removeAttribute(h,"class"):u.setAttribute(h,"class",m)}function qp(u,h,m){const{mergedAttrs:x,classes:T,styles:A}=m;null!==x&&hn(u,h,x),null!==T&&Df(u,h,T),null!==A&&function Ba(u,h,m){u.setAttribute(h,"style",m)}(u,h,A)}function Hs(u){return function Af(){if(void 0===Ku&&(Ku=null,pi.trustedTypes))try{Ku=pi.trustedTypes.createPolicy("angular",{createHTML:u=>u,createScript:u=>u,createScriptURL:u=>u})}catch{}return Ku}()?.createHTML(u)||u}function tx(u){mo=u}function Pv(u){return function P_(){if(void 0===al&&(al=null,pi.trustedTypes))try{al=pi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:u=>u,createScript:u=>u,createScriptURL:u=>u})}catch{}return al}()?.createScriptURL(u)||u}class zl{constructor(h){this.changingThisBreaksApplicationSecurity=h}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Dn})`}}class nx extends zl{getTypeName(){return"HTML"}}class ix extends zl{getTypeName(){return"Style"}}class Ov extends zl{getTypeName(){return"Script"}}class O_ extends zl{getTypeName(){return"URL"}}class kv extends zl{getTypeName(){return"ResourceURL"}}function Xs(u){return u instanceof zl?u.changingThisBreaksApplicationSecurity:u}function vc(u,h){const m=function Rv(u){return u instanceof zl&&u.getTypeName()||null}(u);if(null!=m&&m!==h){if("ResourceURL"===m&&"URL"===h)return!0;throw new Error(`Required a safe ${h}, got a ${m} (see ${Dn})`)}return m===h}function Zp(u){return new nx(u)}function Fv(u){return new ix(u)}function Nh(u){return new Ov(u)}function k_(u){return new O_(u)}function ya(u){return new kv(u)}class zh{constructor(h){this.inertDocumentHelper=h}getInertBodyElement(h){h="<body><remove></remove>"+h;try{const m=(new window.DOMParser).parseFromString(Hs(h),"text/html").body;return null===m?this.inertDocumentHelper.getInertBodyElement(h):(m.removeChild(m.firstChild),m)}catch{return null}}}class Pf{constructor(h){this.defaultDoc=h,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(h){const m=this.inertDocument.createElement("template");return m.innerHTML=Hs(h),m}}const cl=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Yp(u){return(u=String(u)).match(cl)?u:"unsafe:"+u}function bc(u){const h={};for(const m of u.split(","))h[m]=!0;return h}function Xu(...u){const h={};for(const m of u)for(const x in m)m.hasOwnProperty(x)&&(h[x]=!0);return h}const rx=bc("area,br,col,hr,img,wbr"),R_=bc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Vl=bc("rp,rt"),F_=Xu(rx,Xu(R_,bc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Xu(Vl,bc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Xu(Vl,R_)),Kp=bc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Qu=Xu(Kp,bc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),bc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Jm=bc("script,style,template");class L_{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(h){let m=h.firstChild,x=!0;for(;m;)if(m.nodeType===Node.ELEMENT_NODE?x=this.startElement(m):m.nodeType===Node.TEXT_NODE?this.chars(m.nodeValue):this.sanitizedSomething=!0,x&&m.firstChild)m=m.firstChild;else for(;m;){m.nodeType===Node.ELEMENT_NODE&&this.endElement(m);let T=this.checkClobberedElement(m,m.nextSibling);if(T){m=T;break}m=this.checkClobberedElement(m,m.parentNode)}return this.buf.join("")}startElement(h){const m=h.nodeName.toLowerCase();if(!F_.hasOwnProperty(m))return this.sanitizedSomething=!0,!Jm.hasOwnProperty(m);this.buf.push("<"),this.buf.push(m);const x=h.attributes;for(let T=0;T<x.length;T++){const A=x.item(T),N=A.name,W=N.toLowerCase();if(!Qu.hasOwnProperty(W)){this.sanitizedSomething=!0;continue}let Q=A.value;Kp[W]&&(Q=Yp(Q)),this.buf.push(" ",N,'="',Lv(Q),'"')}return this.buf.push(">"),!0}endElement(h){const m=h.nodeName.toLowerCase();F_.hasOwnProperty(m)&&!rx.hasOwnProperty(m)&&(this.buf.push("</"),this.buf.push(m),this.buf.push(">"))}chars(h){this.buf.push(Lv(h))}checkClobberedElement(h,m){if(m&&(h.compareDocumentPosition(m)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${h.outerHTML}`);return m}}const eg=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Qp=/([^\#-~ |!])/g;function Lv(u){return u.replace(/&/g,"&amp;").replace(eg,function(h){return"&#"+(1024*(h.charCodeAt(0)-55296)+(h.charCodeAt(1)-56320)+65536)+";"}).replace(Qp,function(h){return"&#"+h.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let N_;function Jp(u,h){let m=null;try{N_=N_||function ll(u){const h=new Pf(u);return function Bl(){try{return!!(new window.DOMParser).parseFromString(Hs(""),"text/html")}catch{return!1}}()?new zh(h):h}(u);let x=h?String(h):"";m=N_.getInertBodyElement(x);let T=5,A=x;do{if(0===T)throw new Error("Failed to sanitize html because the input is unstable");T--,x=A,A=m.innerHTML,m=N_.getInertBodyElement(x)}while(x!==A);return Hs((new L_).sanitizeChildren(Nv(m)||m))}finally{if(m){const x=Nv(m)||m;for(;x.firstChild;)x.removeChild(x.firstChild)}}}function Nv(u){return"content"in u&&function tg(u){return u.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===u.nodeName}(u)?u.content:null}var Qo=(()=>((Qo=Qo||{})[Qo.NONE=0]="NONE",Qo[Qo.HTML=1]="HTML",Qo[Qo.STYLE=2]="STYLE",Qo[Qo.SCRIPT=3]="SCRIPT",Qo[Qo.URL=4]="URL",Qo[Qo.RESOURCE_URL=5]="RESOURCE_URL",Qo))();function zd(u){const h=em();return h?h.sanitize(Qo.URL,u)||"":vc(u,"URL")?Xs(u):Yp(Ft(u))}function ul(u){const h=em();if(h)return Pv(h.sanitize(Qo.RESOURCE_URL,u)||"");if(vc(u,"ResourceURL"))return Pv(Xs(u));throw new vt(904,!1)}function Ul(u,h,m){return function ed(u,h){return"src"===h&&("embed"===u||"frame"===u||"iframe"===u||"media"===u||"script"===u)||"href"===h&&("base"===u||"link"===u)?ul:zd}(h,m)(u)}function em(){const u=qt();return u&&u[Vo]}const Eo=new xr("ENVIRONMENT_INITIALIZER"),Rf=new xr("INJECTOR",-1),Ff=new xr("INJECTOR_DEF_TYPES");class z_{get(h,m=Sr){if(m===Sr){const x=new Error(`NullInjectorError: No provider for ${yt(h)}!`);throw x.name="NullInjectorError",x}return m}}function Lf(...u){return{\u0275providers:ax(0,u),\u0275fromNgModule:!0}}function ax(u,...h){const m=[],x=new Set;let T;return tu(h,A=>{const N=A;V_(N,m,[],x)&&(T||(T=[]),T.push(N))}),void 0!==T&&B_(T,m),m}function B_(u,h){for(let m=0;m<u.length;m++){const{providers:T}=u[m];au(T,A=>{h.push(A)})}}function V_(u,h,m,x){if(!(u=Ke(u)))return!1;let T=null,A=so(u);const N=!A&&Zi(u);if(A||N){if(N&&!N.standalone)return!1;T=u}else{const Q=u.ngModule;if(A=so(Q),!A)return!1;T=Q}const W=x.has(T);if(N){if(W)return!1;if(x.add(T),N.dependencies){const Q="function"==typeof N.dependencies?N.dependencies():N.dependencies;for(const re of Q)V_(re,h,m,x)}}else{if(!A)return!1;{if(null!=A.imports&&!W){let re;x.add(T);try{tu(A.imports,he=>{V_(he,h,m,x)&&(re||(re=[]),re.push(he))})}finally{}void 0!==re&&B_(re,h)}if(!W){const re=ic(T)||(()=>new T);h.push({provide:T,useFactory:re,deps:fe},{provide:Ff,useValue:T,multi:!0},{provide:Eo,useValue:()=>cn(T),multi:!0})}const Q=A.providers;null==Q||W||au(Q,he=>{h.push(he)})}}return T!==u&&void 0!==u.providers}function au(u,h){for(let m of u)tn(m)&&(m=m.\u0275providers),Array.isArray(m)?au(m,h):h(m)}const Nf=ft({provide:String,useValue:ft});function ig(u){return null!==u&&"object"==typeof u&&Nf in u}function lu(u){return"function"==typeof u}const U_=new xr("Set Injector scope."),j_={},zv={};let Bv;function im(){return void 0===Bv&&(Bv=new z_),Bv}class Vh{}class Vv extends Vh{get destroyed(){return this._destroyed}constructor(h,m,x,T){super(),this.parent=m,this.source=x,this.scopes=T,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,jv(h,N=>this.processProvider(N)),this.records.set(Rf,cu(void 0,this)),T.has("environment")&&this.records.set(Vh,cu(void 0,this));const A=this.records.get(U_);null!=A&&"string"==typeof A.value&&this.scopes.add(A.value),this.injectorDefTypes=new Set(this.get(Ff.multi,fe,In.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const h of this._ngOnDestroyHooks)h.ngOnDestroy();for(const h of this._onDestroyHooks)h()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(h){this._onDestroyHooks.push(h)}runInContext(h){this.assertNotDestroyed();const m=lo(this),x=vo(void 0);try{return h()}finally{lo(m),vo(x)}}get(h,m=Sr,x=In.Default){this.assertNotDestroyed(),x=Zn(x);const T=lo(this),A=vo(void 0);try{if(!(x&In.SkipSelf)){let W=this.records.get(h);if(void 0===W){const Q=function G_(u){return"function"==typeof u||"object"==typeof u&&u instanceof xr}(h)&&dr(h);W=Q&&this.injectableDefInScope(Q)?cu(Bd(h),j_):null,this.records.set(h,W)}if(null!=W)return this.hydrate(h,W)}return(x&In.Self?im():this.parent).get(h,m=x&In.Optional&&m===Sr?null:m)}catch(N){if("NullInjectorError"===N.name){if((N[Do]=N[Do]||[]).unshift(yt(h)),T)throw N;return function ze(u,h,m,x){const T=u[Do];throw h[Vs]&&T.unshift(h[Vs]),u.message=function ne(u,h,m,x=null){u=u&&"\n"===u.charAt(0)&&u.charAt(1)==wi?u.slice(2):u;let T=yt(h);if(Array.isArray(h))T=h.map(yt).join(" -> ");else if("object"==typeof h){let A=[];for(let N in h)if(h.hasOwnProperty(N)){let W=h[N];A.push(N+":"+("string"==typeof W?JSON.stringify(W):yt(W)))}T=`{${A.join(", ")}}`}return`${m}${x?"("+x+")":""}[${T}]: ${u.replace(ys,"\n  ")}`}("\n"+u.message,T,m,x),u[ao]=T,u[Do]=null,u}(N,h,"R3InjectorError",this.source)}throw N}finally{vo(A),lo(T)}}resolveInjectorInitializers(){const h=lo(this),m=vo(void 0);try{const x=this.get(Eo.multi,fe,In.Self);for(const T of x)T()}finally{lo(h),vo(m)}}toString(){const h=[],m=this.records;for(const x of m.keys())h.push(yt(x));return`R3Injector[${h.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new vt(205,!1)}processProvider(h){let m=lu(h=Ke(h))?h:Ke(h&&h.provide);const x=function cx(u){return ig(u)?cu(void 0,u.useValue):cu(zf(u),j_)}(h);if(lu(h)||!0!==h.multi)this.records.get(m);else{let T=this.records.get(m);T||(T=cu(void 0,j_,!0),T.factory=()=>ei(T.multi),this.records.set(m,T)),m=h,T.multi.push(h)}this.records.set(m,x)}hydrate(h,m){return m.value===j_&&(m.value=zv,m.value=m.factory()),"object"==typeof m.value&&m.value&&function $_(u){return null!==u&&"object"==typeof u&&"function"==typeof u.ngOnDestroy}(m.value)&&this._ngOnDestroyHooks.add(m.value),m.value}injectableDefInScope(h){if(!h.providedIn)return!1;const m=Ke(h.providedIn);return"string"==typeof m?"any"===m||this.scopes.has(m):this.injectorDefTypes.has(m)}}function Bd(u){const h=dr(u),m=null!==h?h.factory:ic(u);if(null!==m)return m;if(u instanceof xr)throw new vt(204,!1);if(u instanceof Function)return function lx(u){const h=u.length;if(h>0)throw Hu(h,"?"),new vt(204,!1);const m=function oo(u){const h=u&&(u[Ds]||u[Ir]);return h?(function Ms(u){if(u.hasOwnProperty("name"))return u.name;(""+u).match(/^function\s*([^\s(]+)/)}(u),h):null}(u);return null!==m?()=>m.factory(u):()=>new u}(u);throw new vt(204,!1)}function zf(u,h,m){let x;if(lu(u)){const T=Ke(u);return ic(T)||Bd(T)}if(ig(u))x=()=>Ke(u.useValue);else if(function tm(u){return!(!u||!u.useFactory)}(u))x=()=>u.useFactory(...ei(u.deps||[]));else if(function rg(u){return!(!u||!u.useExisting)}(u))x=()=>cn(Ke(u.useExisting));else{const T=Ke(u&&(u.useClass||u.provide));if(!function Uv(u){return!!u.deps}(u))return ic(T)||Bd(T);x=()=>new T(...ei(u.deps))}return x}function cu(u,h,m=!1){return{factory:u,value:h,multi:m?[]:void 0}}function jv(u,h){for(const m of u)Array.isArray(m)?jv(m,h):m&&tn(m)?jv(m.\u0275providers,h):h(m)}class ux{}class dx{}class $v{resolveComponentFactory(h){throw function hx(u){const h=Error(`No component factory found for ${yt(u)}. Did you add it to @NgModule.entryComponents?`);return h.ngComponent=u,h}(h)}}let Vd=(()=>{class u{}return u.NULL=new $v,u})();function sg(){return Ud(Po(),qt())}function Ud(u,h){return new Js(uo(u,h))}let Js=(()=>{class u{constructor(m){this.nativeElement=m}}return u.__NG_ELEMENT_ID__=sg,u})();function Ua(u){return u instanceof Js?u.nativeElement:u}class fx{}let Gv=(()=>{class u{}return u.__NG_ELEMENT_ID__=()=>function N1(){const u=qt(),m=di(Po().index,u);return(Yo(m)?m:u)[bi]}(),u})(),z1=(()=>{class u{}return u.\u0275prov=vn({token:u,providedIn:"root",factory:()=>null}),u})();class px{constructor(h){this.full=h,this.major=h.split(".")[0],this.minor=h.split(".")[1],this.patch=h.split(".").slice(2).join(".")}}const Uh=new px("15.2.6"),rm={},H_="ngOriginalError";function Vf(u){return u[H_]}class ag{constructor(){this._console=console}handleError(h){const m=this._findOriginalError(h);this._console.error("ERROR",h),m&&this._console.error("ORIGINAL ERROR",m)}_findOriginalError(h){let m=h&&Vf(h);for(;m&&Vf(m);)m=Vf(m);return m||null}}function Hv(u){return u.ownerDocument.defaultView}function ja(u){return u instanceof Function?u():u}function jf(u,h,m){let x=u.length;for(;;){const T=u.indexOf(h,m);if(-1===T)return T;if(0===T||u.charCodeAt(T-1)<=32){const A=h.length;if(T+A===x||u.charCodeAt(T+A)<=32)return T}m=T+1}}const cg="ng-template";function Zv(u,h,m){let x=0,T=!0;for(;x<u.length;){let A=u[x++];if("string"==typeof A&&T){const N=u[x++];if(m&&"class"===A&&-1!==jf(N.toLowerCase(),h,0))return!0}else{if(1===A){for(;x<u.length&&"string"==typeof(A=u[x++]);)if(A.toLowerCase()===h)return!0;return!1}"number"==typeof A&&(T=!1)}}return!1}function uu(u){return 4===u.type&&u.value!==cg}function ug(u,h,m){return h===(4!==u.type||m?u.value:cg)}function Yv(u,h,m){let x=4;const T=u.attrs||[],A=function q_(u){for(let h=0;h<u.length;h++)if(or(u[h]))return h;return u.length}(T);let N=!1;for(let W=0;W<h.length;W++){const Q=h[W];if("number"!=typeof Q){if(!N)if(4&x){if(x=2|1&x,""!==Q&&!ug(u,Q,m)||""===Q&&1===h.length){if(xc(x))return!1;N=!0}}else{const re=8&x?Q:h[++W];if(8&x&&null!==u.attrs){if(!Zv(u.attrs,re,m)){if(xc(x))return!1;N=!0}continue}const Se=dg(8&x?"class":Q,T,uu(u),m);if(-1===Se){if(xc(x))return!1;N=!0;continue}if(""!==re){let We;We=Se>A?"":T[Se+1].toLowerCase();const dt=8&x?We:null;if(dt&&-1!==jf(dt,re,0)||2&x&&re!==We){if(xc(x))return!1;N=!0}}}}else{if(!N&&!xc(x)&&!xc(Q))return!1;if(N&&xc(Q))continue;N=!1,x=Q|1&x}}return xc(x)||N}function xc(u){return 0==(1&u)}function dg(u,h,m,x){if(null===h)return-1;let T=0;if(x||!m){let A=!1;for(;T<h.length;){const N=h[T];if(N===u)return T;if(3===N||6===N)A=!0;else{if(1===N||2===N){let W=h[++T];for(;"string"==typeof W;)W=h[++T];continue}if(4===N)break;if(0===N){T+=4;continue}}T+=A?1:2}return-1}return function G1(u,h){let m=u.indexOf(4);if(m>-1)for(m++;m<u.length;){const x=u[m];if("number"==typeof x)return-1;if(x===h)return m;m++}return-1}(h,u)}function jd(u,h,m=!1){for(let x=0;x<h.length;x++)if(Yv(u,h[x],m))return!0;return!1}function Kv(u,h){e:for(let m=0;m<h.length;m++){const x=h[m];if(u.length===x.length){for(let T=0;T<u.length;T++)if(u[T]!==x[T])continue e;return!0}}return!1}function W_(u,h){return u?":not("+h.trim()+")":h}function Z_(u){let h=u[0],m=1,x=2,T="",A=!1;for(;m<u.length;){let N=u[m];if("string"==typeof N)if(2&x){const W=u[++m];T+="["+N+(W.length>0?'="'+W+'"':"")+"]"}else 8&x?T+="."+N:4&x&&(T+=" "+N);else""!==T&&!xc(N)&&(h+=W_(A,T),T=""),x=N,A=A||!xc(x);m++}return""!==T&&(h+=W_(A,T)),h}const Bi={};function vx(u){K_($i(),qt(),bs()+u,!1)}function K_(u,h,m,x){if(!x)if(3==(3&h[Ti])){const A=u.preOrderCheckHooks;null!==A&&Id(h,A,m)}else{const A=u.preOrderHooks;null!==A&&cc(h,A,0,m)}Os(m)}function Q_(u,h=null,m=null,x){const T=Z1(u,h,m,x);return T.resolveInjectorInitializers(),T}function Z1(u,h=null,m=null,x,T=new Set){const A=[m||fe,Lf(u)];return x=x||("object"==typeof u?void 0:yt(u)),new Vv(A,h||im(),x||null,T)}let sm=(()=>{class u{static create(m,x){if(Array.isArray(m))return Q_({name:""},x,m,"");{const T=m.name??"";return Q_({name:T},m.parent,m.providers,T)}}}return u.THROW_IF_NOT_FOUND=Sr,u.NULL=new z_,u.\u0275prov=vn({token:u,providedIn:"any",factory:()=>cn(Rf)}),u.__NG_ELEMENT_ID__=-1,u})();function dm(u,h=In.Default){const m=qt();return null===m?cn(u,h):_h(Po(),m,Ke(u),h)}function Dx(){throw new Error("invalid")}function Ax(u,h){const m=u.contentQueries;if(null!==m)for(let x=0;x<m.length;x+=2){const A=m[x+1];if(-1!==A){const N=u.data[A];Dp(m[x]),N.contentQueries(2,h[A],A)}}}function ny(u,h,m,x,T,A,N,W,Q,re,he){const Se=h.blueprint.slice();return Se[As]=T,Se[Ti]=76|x,(null!==he||u&&1024&u[Ti])&&(Se[Ti]|=1024),sh(Se),Se[Nt]=Se[co]=u,Se[Gn]=m,Se[Cl]=N||u&&u[Cl],Se[bi]=W||u&&u[bi],Se[Vo]=Q||u&&u[Vo]||null,Se[Bo]=re||u&&u[Bo]||null,Se[ur]=A,Se[aa]=function ma(){return Ks++}(),Se[Fc]=he,Se[ds]=2==h.type?u[ds]:Se,Se}function wc(u,h,m,x,T){let A=u.data[h];if(null===A)A=function mg(u,h,m,x,T){const A=Xa(),N=Hc(),Q=u.data[h]=function _g(u,h,m,x,T,A){return{type:m,index:x,insertBeforeIndex:null,injectorIndex:h?h.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:T,attrs:A,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:h,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,N?A:A&&A.parent,m,h,x,T);return null===u.firstChild&&(u.firstChild=Q),null!==A&&(N?null==A.child&&null!==Q.parent&&(A.child=Q):null===A.next&&(A.next=Q,Q.prev=A)),Q}(u,h,m,x,T),function dh(){return Ii.lFrame.inI18n}()&&(A.flags|=32);else if(64&A.type){A.type=m,A.value=x,A.attrs=T;const N=function Ml(){const u=Ii.lFrame,h=u.currentTNode;return u.isParent?h:h.parent}();A.injectorIndex=null===N?-1:N.injectorIndex}return Qa(A,!0),A}function gg(u,h,m,x){if(0===m)return-1;const T=h.length;for(let A=0;A<m;A++)h.push(x),u.blueprint.push(x),u.data.push(null);return T}function t0(u,h,m){mf(h);try{const x=u.viewQuery;null!==x&&Vx(1,x,m);const T=u.template;null!==T&&n0(u,h,T,1,m),u.firstCreatePass&&(u.firstCreatePass=!1),u.staticContentQueries&&Ax(u,h),u.staticViewQueries&&Vx(2,u.viewQuery,m);const A=u.components;null!==A&&function eC(u,h){for(let m=0;m<h.length;m++)l0(u,h[m])}(h,A)}catch(x){throw u.firstCreatePass&&(u.incompleteFirstPass=!0,u.firstCreatePass=!1),x}finally{h[Ti]&=-5,yf()}}function iy(u,h,m,x){const T=h[Ti];if(128!=(128&T)){mf(h);try{sh(h),function Ip(u){return Ii.lFrame.bindingIndex=u}(u.bindingStartIndex),null!==m&&n0(u,h,m,2,x);const N=3==(3&T);if(N){const re=u.preOrderCheckHooks;null!==re&&Id(h,re,null)}else{const re=u.preOrderHooks;null!==re&&cc(h,re,0,null),Al(h,0)}if(function Bx(u){for(let h=_e(u);null!==h;h=lt(h)){if(!h[Jr])continue;const m=h[xo];for(let x=0;x<m.length;x++){const T=m[x];512&T[Ti]||Gc(T[Nt],1),T[Ti]|=512}}}(h),function zx(u){for(let h=_e(u);null!==h;h=lt(h))for(let m=Cr;m<h.length;m++){const x=h[m],T=x[Mn];sc(x)&&iy(T,x,T.template,x[Gn])}}(h),null!==u.contentQueries&&Ax(u,h),N){const re=u.contentCheckHooks;null!==re&&Id(h,re)}else{const re=u.contentHooks;null!==re&&cc(h,re,1),Al(h,1)}!function J1(u,h){const m=u.hostBindingOpCodes;if(null!==m)try{for(let x=0;x<m.length;x++){const T=m[x];if(T<0)Os(~T);else{const A=T,N=m[++x],W=m[++x];ac(N,A),W(2,h[A])}}}finally{Os(-1)}}(u,h);const W=u.components;null!==W&&function pg(u,h){for(let m=0;m<h.length;m++)yg(u,h[m])}(h,W);const Q=u.viewQuery;if(null!==Q&&Vx(2,Q,x),N){const re=u.viewCheckHooks;null!==re&&Id(h,re)}else{const re=u.viewHooks;null!==re&&cc(h,re,2),Al(h,2)}!0===u.firstUpdatePass&&(u.firstUpdatePass=!1),h[Ti]&=-41,512&h[Ti]&&(h[Ti]&=-513,Gc(h[Nt],-1))}finally{yf()}}}function n0(u,h,m,x,T){const A=bs(),N=2&x;try{Os(-1),N&&h.length>yi&&K_(u,h,yi,!1),Ko(N?2:0,T),m(x,T)}finally{Os(A),Ko(N?3:1,T)}}function ry(u,h,m){if(Lc(h)){const T=h.directiveEnd;for(let A=h.directiveStart;A<T;A++){const N=u.data[A];N.contentQueries&&N.contentQueries(1,m[A],A)}}}function id(u,h,m){Ep()&&(function qf(u,h,m,x){const T=m.directiveStart,A=m.directiveEnd;Nc(m)&&function Nx(u,h,m){const x=uo(h,u),T=Fs(m),A=u[Cl],N=$d(u,ny(u,T,null,m.onPush?32:16,x,h,A,A.createRenderer(x,m),null,null,null));u[h.index]=N}(h,m,u.data[T+m.componentOffset]),u.firstCreatePass||Fl(m,h),fs(x,h);const N=m.initialInputs;for(let W=T;W<A;W++){const Q=u.data[W],re=da(h,u,W,m);fs(re,h),null!==N&&Wf(0,W-T,re,Q,0,N),zr(Q)&&(di(m.index,h)[Gn]=da(h,u,W,m))}}(u,h,m,uo(m,h)),64==(64&m.flags)&&ay(u,h,m))}function Cc(u,h,m=uo){const x=h.localNames;if(null!==x){let T=h.index+1;for(let A=0;A<x.length;A+=2){const N=x[A+1],W=-1===N?m(h,u):u[N];u[T++]=W}}}function Fs(u){const h=u.tView;return null===h||h.incompleteFirstPass?u.tView=jl(1,null,u.template,u.decls,u.vars,u.directiveDefs,u.pipeDefs,u.viewQuery,u.schemas,u.consts):h}function jl(u,h,m,x,T,A,N,W,Q,re){const he=yi+x,Se=he+T,We=function r0(u,h){const m=[];for(let x=0;x<h;x++)m.push(x<u?null:Bi);return m}(he,Se),dt="function"==typeof re?re():re;return We[Mn]={type:u,blueprint:We,template:m,queries:null,viewQuery:W,declTNode:h,data:We.slice().fill(null,he),bindingStartIndex:he,expandoStartIndex:Se,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof A?A():A,pipeRegistry:"function"==typeof N?N():N,firstChild:null,schemas:Q,consts:dt,incompleteFirstPass:!1}}function Hf(u,h,m,x){const T=vg(h);null===m?T.push(x):(T.push(m),u.firstCreatePass&&hy(u).push(x,T.length-1))}function Px(u,h,m,x){for(let T in u)if(u.hasOwnProperty(T)){m=null===m?{}:m;const A=u[T];null===x?$l(m,h,T,A):x.hasOwnProperty(T)&&$l(m,h,x[T],A)}return m}function $l(u,h,m,x){u.hasOwnProperty(m)?u[m].push(h,x):u[m]=[h,x]}function ko(u,h,m,x,T,A,N,W){const Q=uo(h,m);let he,re=h.inputs;!W&&null!=re&&(he=re[x])?(xg(u,m,he,x,T),Nc(h)&&o0(m,h.index)):3&h.type&&(x=function ba(u){return"class"===u?"className":"for"===u?"htmlFor":"formaction"===u?"formAction":"innerHtml"===u?"innerHTML":"readonly"===u?"readOnly":"tabindex"===u?"tabIndex":u}(x),T=null!=N?N(T,h.value||"",x):T,A.setProperty(Q,x,T))}function o0(u,h){const m=di(h,u);16&m[Ti]||(m[Ti]|=32)}function hm(u,h,m,x){if(Ep()){const T=null===x?null:{"":-1},A=function ly(u,h){const m=u.directiveRegistry;let x=null,T=null;if(m)for(let A=0;A<m.length;A++){const N=m[A];if(jd(h,N.selectors,!1))if(x||(x=[]),zr(N))if(null!==N.findHostDirectiveDefs){const W=[];T=T||new Map,N.findHostDirectiveDefs(N,W,T),x.unshift(...W,N),cy(u,h,W.length)}else x.unshift(N),cy(u,h,0);else T=T||new Map,N.findHostDirectiveDefs?.(N,x,T),x.push(N)}return null===x?null:[x,T]}(u,m);let N,W;null===A?N=W=null:[N,W]=A,null!==N&&sy(u,h,m,N,T,W),T&&function Rx(u,h,m){if(h){const x=u.localNames=[];for(let T=0;T<h.length;T+=2){const A=m[h[T+1]];if(null==A)throw new vt(-301,!1);x.push(h[T],A)}}}(m,x,T)}m.mergedAttrs=Aa(m.mergedAttrs,m.attrs)}function sy(u,h,m,x,T,A){for(let re=0;re<x.length;re++)Bu(Fl(m,h),u,x[re].type);!function Lx(u,h,m){u.flags|=1,u.directiveStart=h,u.directiveEnd=h+m,u.providerIndexes=h}(m,u.data.length,x.length);for(let re=0;re<x.length;re++){const he=x[re];he.providersResolver&&he.providersResolver(he)}let N=!1,W=!1,Q=gg(u,h,x.length,null);for(let re=0;re<x.length;re++){const he=x[re];m.mergedAttrs=Aa(m.mergedAttrs,he.hostAttrs),tC(u,m,h,Q,he),Fx(Q,he,T),null!==he.contentQueries&&(m.flags|=4),(null!==he.hostBindings||null!==he.hostAttrs||0!==he.hostVars)&&(m.flags|=64);const Se=he.type.prototype;!N&&(Se.ngOnChanges||Se.ngOnInit||Se.ngDoCheck)&&((u.preOrderHooks??(u.preOrderHooks=[])).push(m.index),N=!0),!W&&(Se.ngOnChanges||Se.ngDoCheck)&&((u.preOrderCheckHooks??(u.preOrderCheckHooks=[])).push(m.index),W=!0),Q++}!function Ox(u,h,m){const T=h.directiveEnd,A=u.data,N=h.attrs,W=[];let Q=null,re=null;for(let he=h.directiveStart;he<T;he++){const Se=A[he],We=m?m.get(Se):null,Rt=We?We.outputs:null;Q=Px(Se.inputs,he,Q,We?We.inputs:null),re=Px(Se.outputs,he,re,Rt);const _n=null===Q||null===N||uu(h)?null:uy(Q,he,N);W.push(_n)}null!==Q&&(Q.hasOwnProperty("class")&&(h.flags|=8),Q.hasOwnProperty("style")&&(h.flags|=16)),h.initialInputs=W,h.inputs=Q,h.outputs=re}(u,m,A)}function ay(u,h,m){const x=m.directiveStart,T=m.directiveEnd,A=m.index,N=function Mp(){return Ii.lFrame.currentDirectiveIndex}();try{Os(A);for(let W=x;W<T;W++){const Q=u.data[W],re=h[W];Ma(W),(null!==Q.hostBindings||0!==Q.hostVars||null!==Q.hostAttrs)&&kx(Q,re)}}finally{Os(-1),Ma(N)}}function kx(u,h){null!==u.hostBindings&&u.hostBindings(1,h)}function cy(u,h,m){h.componentOffset=m,(u.components??(u.components=[])).push(h.index)}function Fx(u,h,m){if(m){if(h.exportAs)for(let x=0;x<h.exportAs.length;x++)m[h.exportAs[x]]=u;zr(h)&&(m[""]=u)}}function tC(u,h,m,x,T){u.data[x]=T;const A=T.factory||(T.factory=ic(T.type)),N=new zu(A,zr(T),dm);u.blueprint[x]=N,m[x]=N,function s0(u,h,m,x,T){const A=T.hostBindings;if(A){let N=u.hostBindingOpCodes;null===N&&(N=u.hostBindingOpCodes=[]);const W=~h.index;(function rd(u){let h=u.length;for(;h>0;){const m=u[--h];if("number"==typeof m&&m<0)return m}return 0})(N)!=W&&N.push(W),N.push(m,x,A)}}(u,h,x,gg(u,m,T.hostVars,Bi),T)}function hu(u,h,m,x,T,A){const N=uo(u,h);!function $h(u,h,m,x,T,A,N){if(null==A)u.removeAttribute(h,T,m);else{const W=null==N?Ft(A):N(A,x||"",T);u.setAttribute(h,T,W,m)}}(h[bi],N,A,u.value,m,x,T)}function Wf(u,h,m,x,T,A){const N=A[h];if(null!==N){const W=x.setInput;for(let Q=0;Q<N.length;){const re=N[Q++],he=N[Q++],Se=N[Q++];null!==W?x.setInput(m,Se,re,he):m[he]=Se}}}function uy(u,h,m){let x=null,T=0;for(;T<m.length;){const A=m[T];if(0!==A)if(5!==A){if("number"==typeof A)break;if(u.hasOwnProperty(A)){null===x&&(x=[]);const N=u[A];for(let W=0;W<N.length;W+=2)if(N[W]===h){x.push(A,N[W+1],m[T+1]);break}}T+=2}else T+=2;else T+=4}return x}function a0(u,h,m,x){return[u,!0,!1,h,null,0,x,m,null,null]}function yg(u,h){const m=di(h,u);if(sc(m)){const x=m[Mn];48&m[Ti]?iy(x,m,x.template,m[Gn]):m[_i]>0&&Gh(m)}}function Gh(u){for(let x=_e(u);null!==x;x=lt(x))for(let T=Cr;T<x.length;T++){const A=x[T];if(sc(A))if(512&A[Ti]){const N=A[Mn];iy(N,A,N.template,A[Gn])}else A[_i]>0&&Gh(A)}const m=u[Mn].components;if(null!==m)for(let x=0;x<m.length;x++){const T=di(m[x],u);sc(T)&&T[_i]>0&&Gh(T)}}function l0(u,h){const m=di(h,u),x=m[Mn];(function dl(u,h){for(let m=h.length;m<u.blueprint.length;m++)h.push(u.blueprint[m])})(x,m),t0(x,m,m[Gn])}function $d(u,h){return u[ji]?u[_d][ri]=h:u[ji]=h,u[_d]=h,h}function Jo(u){for(;u;){u[Ti]|=32;const h=R(u);if(Eu(u)&&!h)return u;u=h}return null}function hl(u,h,m,x=!0){const T=h[Cl];T.begin&&T.begin();try{iy(u,h,u.template,m)}catch(N){throw x&&fm(h,N),N}finally{T.end&&T.end()}}function Vx(u,h,m){Dp(0),h(u,m)}function vg(u){return u[Ps]||(u[Ps]=[])}function hy(u){return u.cleanup||(u.cleanup=[])}function fm(u,h){const m=u[Bo],x=m?m.get(ag,null):null;x&&x.handleError(h)}function xg(u,h,m,x,T){for(let A=0;A<m.length;){const N=m[A++],W=m[A++],Q=h[N],re=u.data[N];null!==re.setInput?re.setInput(Q,T,x,W):Q[W]=T}}function fy(u,h,m){let x=m?u.styles:null,T=m?u.classes:null,A=0;if(null!==h)for(let N=0;N<h.length;N++){const W=h[N];"number"==typeof W?A=W:1==A?T=It(T,W):2==A&&(x=It(x,W+": "+h[++N]+";"))}m?u.styles=x:u.stylesWithoutHost=x,m?u.classes=T:u.classesWithoutHost=T}function py(u,h,m,x,T=!1){for(;null!==m;){const A=h[m.index];if(null!==A&&x.push(to(A)),Ji(A))for(let W=Cr;W<A.length;W++){const Q=A[W],re=Q[Mn].firstChild;null!==re&&py(Q[Mn],Q,re,x)}const N=m.type;if(8&N)py(u,h,m.child,x);else if(32&N){const W=j(m,h);let Q;for(;Q=W();)x.push(Q)}else if(16&N){const W=Nd(h,m);if(Array.isArray(W))x.push(...W);else{const Q=R(h[ds]);py(Q[Mn],Q,W,x,!0)}}m=T?m.projectionNext:m.next}return x}class Tc{get rootNodes(){const h=this._lView,m=h[Mn];return py(m,h,m.firstChild,[])}constructor(h,m){this._lView=h,this._cdRefInjectingView=m,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Gn]}set context(h){this._lView[Gn]=h}get destroyed(){return 128==(128&this._lView[Ti])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const h=this._lView[Nt];if(Ji(h)){const m=h[nc],x=m?m.indexOf(this):-1;x>-1&&(Dh(h,x),nu(m,x))}this._attachedToViewContainer=!1}Ah(this._lView[Mn],this._lView)}onDestroy(h){Hf(this._lView[Mn],this._lView,null,h)}markForCheck(){Jo(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ti]&=-65}reattach(){this._lView[Ti]|=64}detectChanges(){hl(this._lView[Mn],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new vt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function pc(u,h){Hp(u,h,h[bi],2,null,null)}(this._lView[Mn],this._lView)}attachToAppRef(h){if(this._attachedToViewContainer)throw new vt(902,!1);this._appRef=h}}class nC extends Tc{constructor(h){super(h),this._view=h}detectChanges(){const h=this._view;hl(h[Mn],h,h[Gn],!1)}checkNoChanges(){}get context(){return null}}class Ux extends Vd{constructor(h){super(),this.ngModule=h}resolveComponentFactory(h){const m=Zi(h);return new wg(m,this.ngModule)}}function jx(u){const h=[];for(let m in u)u.hasOwnProperty(m)&&h.push({propName:u[m],templateName:m});return h}class YT{constructor(h,m){this.injector=h,this.parentInjector=m}get(h,m,x){x=Zn(x);const T=this.injector.get(h,rm,x);return T!==rm||m===rm?T:this.parentInjector.get(h,m,x)}}class wg extends dx{get inputs(){return jx(this.componentDef.inputs)}get outputs(){return jx(this.componentDef.outputs)}constructor(h,m){super(),this.componentDef=h,this.ngModule=m,this.componentType=h.type,this.selector=function H1(u){return u.map(Z_).join(",")}(h.selectors),this.ngContentSelectors=h.ngContentSelectors?h.ngContentSelectors:[],this.isBoundToModule=!!m}create(h,m,x,T){let A=(T=T||this.ngModule)instanceof Vh?T:T?.injector;A&&null!==this.componentDef.getStandaloneInjector&&(A=this.componentDef.getStandaloneInjector(A)||A);const N=A?new YT(h,A):h,W=N.get(fx,null);if(null===W)throw new vt(407,!1);const Q=N.get(z1,null),re=W.createRenderer(null,this.componentDef),he=this.componentDef.selectors[0][0]||"div",Se=x?function oy(u,h,m){return u.selectRootElement(h,m===Y.ShadowDom)}(re,x,this.componentDef.encapsulation):ga(re,he,function iC(u){const h=u.toLowerCase();return"svg"===h?Au:"math"===h?"math":null}(he)),We=this.componentDef.onPush?288:272,dt=jl(0,null,null,1,0,null,null,null,null,null),Rt=ny(null,dt,null,We,null,null,W,re,Q,N,null);let _n,Rn;mf(Rt);try{const Un=this.componentDef;let ci,rn=null;Un.findHostDirectiveDefs?(ci=[],rn=new Map,Un.findHostDirectiveDefs(Un,ci,rn),ci.push(Un)):ci=[Un];const Ui=function Cg(u,h){const m=u[Mn],x=yi;return u[x]=h,wc(m,x,2,"#host",null)}(Rt,Se),Ho=function $x(u,h,m,x,T,A,N,W){const Q=T[Mn];!function my(u,h,m,x){for(const T of u)h.mergedAttrs=Aa(h.mergedAttrs,T.hostAttrs);null!==h.mergedAttrs&&(fy(h,h.mergedAttrs,!0),null!==m&&qp(x,m,h))}(x,u,h,N);const re=A.createRenderer(h,m),he=ny(T,Fs(m),null,m.onPush?32:16,T[u.index],u,A,re,W||null,null,null);return Q.firstCreatePass&&cy(Q,u,x.length-1),$d(T,he),T[u.index]=he}(Ui,Se,Un,ci,Rt,W,re);Rn=Ou(dt,yi),Se&&function Gd(u,h,m,x){if(x)hn(u,m,["ng-version",Uh.full]);else{const{attrs:T,classes:A}=function Y_(u){const h=[],m=[];let x=1,T=2;for(;x<u.length;){let A=u[x];if("string"==typeof A)2===T?""!==A&&h.push(A,u[++x]):8===T&&m.push(A);else{if(!xc(T))break;T=A}x++}return{attrs:h,classes:m}}(h.selectors[0]);T&&hn(u,m,T),A&&A.length>0&&Df(u,m,A.join(" "))}}(re,Un,Se,x),void 0!==m&&function Yf(u,h,m){const x=u.projection=[];for(let T=0;T<h.length;T++){const A=m[T];x.push(null!=A?Array.from(A):null)}}(Rn,this.ngContentSelectors,m),_n=function Zf(u,h,m,x,T,A){const N=Po(),W=T[Mn],Q=uo(N,T);sy(W,T,N,m,null,x);for(let he=0;he<m.length;he++)fs(da(T,W,N.directiveStart+he,N),T);ay(W,T,N),Q&&fs(Q,T);const re=da(T,W,N.directiveStart+N.componentOffset,N);if(u[Gn]=T[Gn]=re,null!==A)for(const he of A)he(re,h);return ry(W,N,u),re}(Ho,Un,ci,rn,Rt,[Hh]),t0(dt,Rt,null)}finally{yf()}return new c0(this.componentType,_n,Ud(Rn,Rt),Rt,Rn)}}class c0 extends ux{constructor(h,m,x,T,A){super(),this.location=x,this._rootLView=T,this._tNode=A,this.instance=m,this.hostView=this.changeDetectorRef=new nC(T),this.componentType=h}setInput(h,m){const x=this._tNode.inputs;let T;if(null!==x&&(T=x[h])){const A=this._rootLView;xg(A[Mn],A,T,h,m),o0(A,this._tNode.index)}}get injector(){return new Jc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(h){this.hostView.onDestroy(h)}}function Hh(){const u=Po();Nu(qt()[Mn],u)}function pm(u){let h=function Eg(u){return Object.getPrototypeOf(u.prototype).constructor}(u.type),m=!0;const x=[u];for(;h;){let T;if(zr(u))T=h.\u0275cmp||h.\u0275dir;else{if(h.\u0275cmp)throw new vt(903,!1);T=h.\u0275dir}if(T){if(m){x.push(T);const N=u;N.inputs=u0(u.inputs),N.declaredInputs=u0(u.declaredInputs),N.outputs=u0(u.outputs);const W=T.hostBindings;W&&Hx(u,W);const Q=T.viewQuery,re=T.contentQueries;if(Q&&gy(u,Q),re&&Gx(u,re),on(u.inputs,T.inputs),on(u.declaredInputs,T.declaredInputs),on(u.outputs,T.outputs),zr(T)&&T.data.animation){const he=u.data;he.animation=(he.animation||[]).concat(T.data.animation)}}const A=T.features;if(A)for(let N=0;N<A.length;N++){const W=A[N];W&&W.ngInherit&&W(u),W===pm&&(m=!1)}}h=Object.getPrototypeOf(h)}!function mm(u){let h=0,m=null;for(let x=u.length-1;x>=0;x--){const T=u[x];T.hostVars=h+=T.hostVars,T.hostAttrs=Aa(T.hostAttrs,m=Aa(m,T.hostAttrs))}}(x)}function u0(u){return u===se?{}:u===fe?[]:u}function gy(u,h){const m=u.viewQuery;u.viewQuery=m?(x,T)=>{h(x,T),m(x,T)}:h}function Gx(u,h){const m=u.contentQueries;u.contentQueries=m?(x,T,A)=>{h(x,T,A),m(x,T,A)}:h}function Hx(u,h){const m=u.hostBindings;u.hostBindings=m?(x,T)=>{h(x,T),m(x,T)}:h}function qh(u){return!!Ig(u)&&(Array.isArray(u)||!(u instanceof Map)&&Symbol.iterator in u)}function Ig(u){return null!==u&&("function"==typeof u||"object"==typeof u)}function xa(u,h,m){return u[h]=m}function Ro(u,h,m){return!Object.is(u[h],m)&&(u[h]=m,!0)}function gm(u,h,m,x){const T=qt();return Ro(T,Dl(),h)&&($i(),hu(pr(),T,u,h,m,x)),gm}function fu(u,h,m,x){return Ro(u,Dl(),m)?h+Ft(m)+x:Bi}function lC(u,h,m,x,T,A,N,W){const Q=qt(),re=$i(),he=u+yi,Se=re.firstCreatePass?function p0(u,h,m,x,T,A,N,W,Q){const re=h.consts,he=wc(h,u,4,N||null,ca(re,W));hm(h,m,he,ca(re,Q)),Nu(h,he);const Se=he.tView=jl(2,he,x,T,A,h.directiveRegistry,h.pipeRegistry,null,h.schemas,re);return null!==h.queries&&(h.queries.template(h,he),Se.queries=h.queries.embeddedTView(he)),he}(he,re,Q,h,m,x,T,A,N):re.data[he];Qa(Se,!1);const We=Q[bi].createComment("");Fh(re,Q,We,Se),fs(We,Q),$d(Q,Q[he]=a0(We,Q,We,Se)),js(Se)&&id(re,Q,Se),null!=N&&Cc(Q,Se,W)}function m0(u){return la(function qc(){return Ii.lFrame.contextLView}(),yi+u)}function ad(u,h,m){const x=qt();return Ro(x,Dl(),h)&&ko($i(),pr(),x,u,h,x[bi],m,!1),ad}function xy(u,h,m,x,T){const N=T?"class":"style";xg(u,m,h.inputs[N],N,x)}function bm(u,h,m,x){const T=qt(),A=$i(),N=yi+u,W=T[bi],Q=A.firstCreatePass?function g0(u,h,m,x,T,A){const N=h.consts,Q=wc(h,u,2,x,ca(N,T));return hm(h,m,Q,ca(N,A)),null!==Q.attrs&&fy(Q,Q.attrs,!1),null!==Q.mergedAttrs&&fy(Q,Q.mergedAttrs,!0),null!==h.queries&&h.queries.elementStart(h,Q),Q}(N,A,T,h,m,x):A.data[N],re=T[N]=ga(W,h,function Op(){return Ii.lFrame.currentNamespace}()),he=js(Q);return Qa(Q,!0),qp(W,re,Q),32!=(32&Q.flags)&&Fh(A,T,re,Q),0===function Cd(){return Ii.lFrame.elementDepthCount}()&&fs(re,T),function lh(){Ii.lFrame.elementDepthCount++}(),he&&(id(A,T,Q),ry(A,Q,T)),null!==x&&Cc(T,Q),bm}function Wh(){let u=Po();Hc()?uh():(u=u.parent,Qa(u,!1));const h=u;!function ku(){Ii.lFrame.elementDepthCount--}();const m=$i();return m.firstCreatePass&&(Nu(m,u),Lc(u)&&m.queries.elementEnd(u)),null!=h.classesWithoutHost&&function Ol(u){return 0!=(8&u.flags)}(h)&&xy(m,h,qt(),h.classesWithoutHost,!0),null!=h.stylesWithoutHost&&function el(u){return 0!=(16&u.flags)}(h)&&xy(m,h,qt(),h.stylesWithoutHost,!1),Wh}function kg(u,h,m,x){return bm(u,h,m,x),Wh(),kg}function Rg(u,h,m){const x=qt(),T=$i(),A=u+yi,N=T.firstCreatePass?function cC(u,h,m,x,T){const A=h.consts,N=ca(A,x),W=wc(h,u,8,"ng-container",N);return null!==N&&fy(W,N,!0),hm(h,m,W,ca(A,T)),null!==h.queries&&h.queries.elementStart(h,W),W}(A,T,x,h,m):T.data[A];Qa(N,!0);const W=x[A]=x[bi].createComment("");return Fh(T,x,W,N),fs(W,x),js(N)&&(id(T,x,N),ry(T,N,x)),null!=m&&Cc(x,N),Rg}function wy(){let u=Po();const h=$i();return Hc()?uh():(u=u.parent,Qa(u,!1)),h.firstCreatePass&&(Nu(h,u),Lc(u)&&h.queries.elementEnd(u)),wy}function Cy(u,h,m){return Rg(u,h,m),wy(),Cy}function _0(){return qt()}function ep(u){return!!u&&"function"==typeof u.then}function y0(u){return!!u&&"function"==typeof u.subscribe}const Zx=y0;function Fg(u,h,m,x){const T=qt(),A=$i(),N=Po();return function fl(u,h,m,x,T,A,N){const W=js(x),re=u.firstCreatePass&&hy(u),he=h[Gn],Se=vg(h);let We=!0;if(3&x.type||N){const _n=uo(x,h),Rn=N?N(_n):_n,Un=Se.length,ci=N?Ui=>N(to(Ui[x.index])):x.index;let rn=null;if(!N&&W&&(rn=function Yx(u,h,m,x){const T=u.cleanup;if(null!=T)for(let A=0;A<T.length-1;A+=2){const N=T[A];if(N===m&&T[A+1]===x){const W=h[Ps],Q=T[A+2];return W.length>Q?W[Q]:null}"string"==typeof N&&(A+=2)}return null}(u,h,T,x.index)),null!==rn)(rn.__ngLastListenerFn__||rn).__ngNextListenerFn__=A,rn.__ngLastListenerFn__=A,We=!1;else{A=pl(x,h,he,A,!1);const Ui=m.listen(Rn,T,A);Se.push(A,Ui),re&&re.push(T,ci,Un,Un+1)}}else A=pl(x,h,he,A,!1);const dt=x.outputs;let Rt;if(We&&null!==dt&&(Rt=dt[T])){const _n=Rt.length;if(_n)for(let Rn=0;Rn<_n;Rn+=2){const Ho=h[Rt[Rn]][Rt[Rn+1]].subscribe(A),No=Se.length;Se.push(A,Ho),re&&re.push(T,x.index,No,-(No+1))}}}(A,T,T[bi],N,u,h,x),Fg}function pu(u,h,m,x){try{return Ko(6,h,m),!1!==m(x)}catch(T){return fm(u,T),!1}finally{Ko(7,h,m)}}function pl(u,h,m,x,T){return function A(N){if(N===Function)return x;Jo(u.componentOffset>-1?di(u.index,h):h);let Q=pu(h,m,x,N),re=A.__ngNextListenerFn__;for(;re;)Q=pu(h,m,re,N)&&Q,re=re.__ngNextListenerFn__;return T&&!1===Q&&(N.preventDefault(),N.returnValue=!1),Q}}function mu(u=1){return function I_(u){return(Ii.lFrame.contextLView=function qm(u,h){for(;u>0;)h=h[co],u--;return h}(u,Ii.lFrame.contextLView))[Gn]}(u)}function ld(u,h){let m=null;const x=function yx(u){const h=u.attrs;if(null!=h){const m=h.indexOf(5);if(!(1&m))return h[m+1]}return null}(u);for(let T=0;T<h.length;T++){const A=h[T];if("*"!==A){if(null===x?jd(u,A,!0):Kv(x,A))return T}else m=T}return m}function Lg(u){const h=qt()[ds][ur];if(!h.projection){const x=h.projection=Hu(u?u.length:1,null),T=x.slice();let A=h.child;for(;null!==A;){const N=u?ld(A,u):0;null!==N&&(T[N]?T[N].projectionNext=A:x[N]=A,T[N]=A),A=A.next}}}function Ng(u,h=0,m){const x=qt(),T=$i(),A=wc(T,yi+u,16,null,m||null);null===A.projection&&(A.projection=h),uh(),32!=(32&A.flags)&&function A_(u,h,m){Mf(h[bi],0,h,m,Ph(u,m,h),M_(m.parent||h[ur],m,h))}(T,x,A)}function zg(u,h,m){return Ty(u,"",h,"",m),zg}function Ty(u,h,m,x,T){const A=qt(),N=fu(A,h,m,x);return N!==Bi&&ko($i(),pr(),A,u,N,A[bi],T,!1),Ty}function Vg(u,h){return u<<17|h<<2}function ml(u){return u>>17&32767}function Ay(u){return 2|u}function Hl(u){return(131068&u)>>2}function gu(u,h){return-131069&u|h<<2}function ql(u){return 1|u}function Ug(u,h,m,x,T){const A=u[m+1],N=null===h;let W=x?ml(A):Hl(A),Q=!1;for(;0!==W&&(!1===Q||N);){const he=u[W+1];E0(u[W],h)&&(Q=!0,u[W+1]=x?ql(he):Ay(he)),W=x?ml(he):Hl(he)}Q&&(u[m+1]=x?Ay(A):ql(A))}function E0(u,h){return null===u||null==h||(Array.isArray(u)?u[1]:u)===h||!(!Array.isArray(u)||"string"!=typeof h)&&c(u,h)>=0}const $o={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function xm(u){return u.substring($o.key,$o.keyEnd)}function Jx(u,h){const m=$o.textEnd;return m===h?-1:(h=$o.keyEnd=function uC(u,h,m){for(;h<m&&u.charCodeAt(h)>32;)h++;return h}(u,$o.key=h,m),ip(u,h,m))}function ip(u,h,m){for(;h<m&&u.charCodeAt(h)<=32;)h++;return h}function y(u,h,m){return U(u,h,m,!1),y}function w(u,h){return U(u,h,null,!0),w}function F(u,h){for(let m=function T0(u){return function M0(u){$o.key=0,$o.keyEnd=0,$o.value=0,$o.valueEnd=0,$o.textEnd=u.length}(u),Jx(u,ip(u,0,$o.textEnd))}(h);m>=0;m=Jx(h,m))Mi(u,xm(h),!0)}function U(u,h,m,x){const T=qt(),A=$i(),N=Ja(2);A.firstUpdatePass&&te(A,u,N,x),h!==Bi&&Ro(T,N,h)&&st(A,A.data[bs()],T,T[bi],u,T[N+1]=function Gt(u,h){return null==u||""===u||("string"==typeof h?u+=h:"object"==typeof u&&(u=yt(Xs(u)))),u}(h,m),x,N)}function Z(u,h){return h>=u.expandoStartIndex}function te(u,h,m,x){const T=u.data;if(null===T[m+1]){const A=T[bs()],N=Z(u,m);ht(A,x)&&null===h&&!N&&(h=!1),h=function ie(u,h,m,x){const T=function hh(u){const h=Ii.lFrame.currentDirectiveIndex;return-1===h?null:u[h]}(u);let A=x?h.residualClasses:h.residualStyles;if(null===T)0===(x?h.classBindings:h.styleBindings)&&(m=we(m=xe(null,u,h,m,x),h.attrs,x),A=null);else{const N=h.directiveStylingLast;if(-1===N||u[N]!==T)if(m=xe(T,u,h,m,x),null===A){let Q=function K(u,h,m){const x=m?h.classBindings:h.styleBindings;if(0!==Hl(x))return u[ml(x)]}(u,h,x);void 0!==Q&&Array.isArray(Q)&&(Q=xe(null,u,h,Q[1],x),Q=we(Q,h.attrs,x),function pe(u,h,m,x){u[ml(m?h.classBindings:h.styleBindings)]=x}(u,h,x,Q))}else A=function Ee(u,h,m){let x;const T=h.directiveEnd;for(let A=1+h.directiveStylingLast;A<T;A++)x=we(x,u[A].hostAttrs,m);return we(x,h.attrs,m)}(u,h,x)}return void 0!==A&&(x?h.residualClasses=A:h.residualStyles=A),m}(T,A,h,x),function _u(u,h,m,x,T,A){let N=A?h.classBindings:h.styleBindings,W=ml(N),Q=Hl(N);u[x]=m;let he,re=!1;if(Array.isArray(m)?(he=m[1],(null===he||c(m,he)>0)&&(re=!0)):he=m,T)if(0!==Q){const We=ml(u[W+1]);u[x+1]=Vg(We,W),0!==We&&(u[We+1]=gu(u[We+1],x)),u[W+1]=function Dy(u,h){return 131071&u|h<<17}(u[W+1],x)}else u[x+1]=Vg(W,0),0!==W&&(u[W+1]=gu(u[W+1],x)),W=x;else u[x+1]=Vg(Q,0),0===W?W=x:u[Q+1]=gu(u[Q+1],x),Q=x;re&&(u[x+1]=Ay(u[x+1])),Ug(u,he,x,!0),Ug(u,he,x,!1),function np(u,h,m,x,T){const A=T?u.residualClasses:u.residualStyles;null!=A&&"string"==typeof h&&c(A,h)>=0&&(m[x+1]=ql(m[x+1]))}(h,he,u,x,A),N=Vg(W,Q),A?h.classBindings=N:h.styleBindings=N}(T,A,h,m,N,x)}}function xe(u,h,m,x,T){let A=null;const N=m.directiveEnd;let W=m.directiveStylingLast;for(-1===W?W=m.directiveStart:W++;W<N&&(A=h[W],x=we(x,A.hostAttrs,T),A!==u);)W++;return null!==u&&(m.directiveStylingLast=W),x}function we(u,h,m){const x=m?1:2;let T=-1;if(null!==h)for(let A=0;A<h.length;A++){const N=h[A];"number"==typeof N?T=N:T===x&&(Array.isArray(u)||(u=void 0===u?[]:["",u]),Mi(u,N,!!m||h[++A]))}return void 0===u?null:u}function st(u,h,m,x,T,A,N,W){if(!(3&h.type))return;const Q=u.data,re=Q[W+1],he=function w0(u){return 1==(1&u)}(re)?rt(Q,h,m,T,Hl(re),N):void 0;bt(he)||(bt(A)||function My(u){return 2==(2&u)}(re)&&(A=rt(Q,null,m,T,W,N)),function Lh(u,h,m,x,T){if(h)T?u.addClass(m,x):u.removeClass(m,x);else{let A=-1===x.indexOf("-")?void 0:Li.DashCase;null==T?u.removeStyle(m,x,A):("string"==typeof T&&T.endsWith("!important")&&(T=T.slice(0,-10),A|=Li.Important),u.setStyle(m,x,T,A))}}(x,N,Sl(bs(),m),T,A))}function rt(u,h,m,x,T,A){const N=null===h;let W;for(;T>0;){const Q=u[T],re=Array.isArray(Q),he=re?Q[1]:Q,Se=null===he;let We=m[T+1];We===Bi&&(We=Se?fe:void 0);let dt=Se?v(We,x):he===x?We:void 0;if(re&&!bt(dt)&&(dt=v(Q,x)),bt(dt)&&(W=dt,N))return W;const Rt=u[T+1];T=N?ml(Rt):Hl(Rt)}if(null!==h){let Q=A?h.residualClasses:h.residualStyles;null!=Q&&(W=v(Q,x))}return W}function bt(u){return void 0!==u}function ht(u,h){return 0!=(u.flags&(h?8:16))}function Tt(u,h=""){const m=qt(),x=$i(),T=u+yi,A=x.firstCreatePass?wc(x,T,1,h,null):x.data[T],N=m[T]=function ii(u,h){return u.createText(h)}(m[bi],h);Fh(x,m,N,A),Qa(A,!1)}function xt(u){return kt("",u,""),xt}function kt(u,h,m){const x=qt(),T=fu(x,u,h,m);return T!==Bi&&function Ec(u,h,m){const x=Sl(h,u);!function zi(u,h,m){u.setValue(h,m)}(u[bi],x,m)}(x,bs(),T),kt}function Di(u,h,m){!function z(u,h,m,x){const T=$i(),A=Ja(2);T.firstUpdatePass&&te(T,null,A,x);const N=qt();if(m!==Bi&&Ro(N,A,m)){const W=T.data[bs()];if(ht(W,x)&&!Z(T,A)){let Q=x?W.classesWithoutHost:W.stylesWithoutHost;null!==Q&&(m=It(Q,m||"")),xy(T,W,N,m,x)}else!function ke(u,h,m,x,T,A,N,W){T===Bi&&(T=fe);let Q=0,re=0,he=0<T.length?T[0]:null,Se=0<A.length?A[0]:null;for(;null!==he||null!==Se;){const We=Q<T.length?T[Q+1]:void 0,dt=re<A.length?A[re+1]:void 0;let _n,Rt=null;he===Se?(Q+=2,re+=2,We!==dt&&(Rt=Se,_n=dt)):null===Se||null!==he&&he<Se?(Q+=2,Rt=he):(re+=2,Rt=Se,_n=dt),null!==Rt&&st(u,h,m,x,Rt,_n,N,W),he=Q<T.length?T[Q]:null,Se=re<A.length?A[re]:null}}(T,W,N,N[bi],N[A+1],N[A+1]=function Ce(u,h,m){if(null==m||""===m)return fe;const x=[],T=Xs(m);if(Array.isArray(T))for(let A=0;A<T.length;A++)u(x,T[A],!0);else if("object"==typeof T)for(const A in T)T.hasOwnProperty(A)&&u(x,A,T[A]);else"string"==typeof T&&h(x,T);return x}(u,h,m),x,A)}}(Mi,F,fu(qt(),u,h,m),!0)}function yu(u,h,m){const x=qt();return Ro(x,Dl(),h)&&ko($i(),pr(),x,u,h,x[bi],m,!0),yu}const Wl=void 0;var D0=["en",[["a","p"],["AM","PM"],Wl],[["AM","PM"],Wl,Wl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Wl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Wl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Wl,"{1} 'at' {0}",Wl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function wm(u){const m=Math.floor(Math.abs(u)),x=u.toString().replace(/^[^.]*\.?/,"").length;return 1===m&&0===x?1:5}];let Zh={};function rp(u){const h=function A0(u){return u.toLowerCase().replace(/_/g,"-")}(u);let m=jg(h);if(m)return m;const x=h.split("-")[0];if(m=jg(x),m)return m;if("en"===x)return D0;throw new vt(701,!1)}function Zl(u){return rp(u)[mi.PluralCase]}function jg(u){return u in Zh||(Zh[u]=pi.ng&&pi.ng.common&&pi.ng.common.locales&&pi.ng.common.locales[u]),Zh[u]}var mi=(()=>((mi=mi||{})[mi.LocaleId=0]="LocaleId",mi[mi.DayPeriodsFormat=1]="DayPeriodsFormat",mi[mi.DayPeriodsStandalone=2]="DayPeriodsStandalone",mi[mi.DaysFormat=3]="DaysFormat",mi[mi.DaysStandalone=4]="DaysStandalone",mi[mi.MonthsFormat=5]="MonthsFormat",mi[mi.MonthsStandalone=6]="MonthsStandalone",mi[mi.Eras=7]="Eras",mi[mi.FirstDayOfWeek=8]="FirstDayOfWeek",mi[mi.WeekendRange=9]="WeekendRange",mi[mi.DateFormat=10]="DateFormat",mi[mi.TimeFormat=11]="TimeFormat",mi[mi.DateTimeFormat=12]="DateTimeFormat",mi[mi.NumberSymbols=13]="NumberSymbols",mi[mi.NumberFormats=14]="NumberFormats",mi[mi.CurrencyCode=15]="CurrencyCode",mi[mi.CurrencySymbol=16]="CurrencySymbol",mi[mi.CurrencyName=17]="CurrencyName",mi[mi.Currencies=18]="Currencies",mi[mi.Directionality=19]="Directionality",mi[mi.PluralCase=20]="PluralCase",mi[mi.ExtraData=21]="ExtraData",mi))();const Yh="en-US";let So=Yh;function TC(u,h,m,x,T){if(u=Ke(u),Array.isArray(u))for(let A=0;A<u.length;A++)TC(u[A],h,m,x,T);else{const A=$i(),N=qt();let W=lu(u)?u:Ke(u.provide),Q=zf(u);const re=Po(),he=1048575&re.providerIndexes,Se=re.directiveStart,We=re.providerIndexes>>20;if(lu(u)||!u.multi){const dt=new zu(Q,T,dm),Rt=fw(W,h,T?he:he+We,Se);-1===Rt?(Bu(Fl(re,N),A,W),Wg(A,u,h.length),h.push(W),re.directiveStart++,re.directiveEnd++,T&&(re.providerIndexes+=1048576),m.push(dt),N.push(dt)):(m[Rt]=dt,N[Rt]=dt)}else{const dt=fw(W,h,he+We,Se),Rt=fw(W,h,he,he+We),Rn=Rt>=0&&m[Rt];if(T&&!Rn||!T&&!(dt>=0&&m[dt])){Bu(Fl(re,N),A,W);const Un=function dA(u,h,m,x,T){const A=new zu(u,m,dm);return A.multi=[],A.index=h,A.componentProviders=0,lp(A,T,x&&!m),A}(T?_I:gI,m.length,T,x,Q);!T&&Rn&&(m[Rt].providerFactory=Un),Wg(A,u,h.length,0),h.push(W),re.directiveStart++,re.directiveEnd++,T&&(re.providerIndexes+=1048576),m.push(Un),N.push(Un)}else Wg(A,u,dt>-1?dt:Rt,lp(m[T?Rt:dt],Q,!T&&x));!T&&x&&Rn&&m[Rt].componentProviders++}}}function Wg(u,h,m,x){const T=lu(h),A=function nm(u){return!!u.useClass}(h);if(T||A){const Q=(A?Ke(h.useClass):h).prototype.ngOnDestroy;if(Q){const re=u.destroyHooks||(u.destroyHooks=[]);if(!T&&h.multi){const he=re.indexOf(m);-1===he?re.push(m,[x,Q]):re[he+1].push(x,Q)}else re.push(m,Q)}}}function lp(u,h,m){return m&&u.componentProviders++,u.multi.push(h)-1}function fw(u,h,m,x){for(let T=m;T<x;T++)if(h[T]===u)return T;return-1}function gI(u,h,m,x){return Cm(this.multi,[])}function _I(u,h,m,x){const T=this.multi;let A;if(this.providerFactory){const N=this.providerFactory.componentProviders,W=da(m,m[Mn],this.providerFactory.index,x);A=W.slice(0,N),Cm(T,A);for(let Q=N;Q<W.length;Q++)A.push(W[Q])}else A=[],Cm(T,A);return A}function Cm(u,h){for(let m=0;m<u.length;m++)h.push((0,u[m])());return h}function yI(u,h=[]){return m=>{m.providersResolver=(x,T)=>function uA(u,h,m){const x=$i();if(x.firstCreatePass){const T=zr(u);TC(m,x.data,x.blueprint,T,!0),TC(h,x.data,x.blueprint,T,!1)}}(x,T?T(u):u,h)}}class Zg{}class vI{}function bI(u,h){return new pw(u,h??null)}class pw extends Zg{constructor(h,m){super(),this._parent=m,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Ux(this);const x=cr(h);this._bootstrapComponents=ja(x.bootstrap),this._r3Injector=Z1(h,m,[{provide:Zg,useValue:this},{provide:Vd,useValue:this.componentFactoryResolver}],yt(h),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(h)}get injector(){return this._r3Injector}destroy(){const h=this._r3Injector;!h.destroyed&&h.destroy(),this.destroyCbs.forEach(m=>m()),this.destroyCbs=null}onDestroy(h){this.destroyCbs.push(h)}}class G0 extends vI{constructor(h){super(),this.moduleType=h}create(h){return new pw(this.moduleType,h)}}class xI extends Zg{constructor(h,m,x){super(),this.componentFactoryResolver=new Ux(this),this.instance=null;const T=new Vv([...h,{provide:Zg,useValue:this},{provide:Vd,useValue:this.componentFactoryResolver}],m||im(),x,new Set(["environment"]));this.injector=T,T.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(h){this.injector.onDestroy(h)}}function mw(u,h,m=null){return new xI(u,h,m).injector}let IC=(()=>{class u{constructor(m){this._injector=m,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(m){if(!m.standalone)return null;if(!this.cachedInjectors.has(m.id)){const x=ax(0,m.type),T=x.length>0?mw([x],this._injector,`Standalone[${m.type.name}]`):null;this.cachedInjectors.set(m.id,T)}return this.cachedInjectors.get(m.id)}ngOnDestroy(){try{for(const m of this.cachedInjectors.values())null!==m&&m.destroy()}finally{this.cachedInjectors.clear()}}}return u.\u0275prov=vn({token:u,providedIn:"environment",factory:()=>new u(cn(Vh))}),u})();function wI(u){u.getStandaloneInjector=h=>h.get(IC).getOrCreateStandaloneInjector(u)}function AC(u,h,m){const x=Xo()+u,T=qt();return T[x]===Bi?xa(T,x,m?h.call(m):h()):function Mg(u,h){return u[h]}(T,x)}function Y0(u,h,m,x){return function kC(u,h,m,x,T,A){const N=h+m;return Ro(u,N,T)?xa(u,N+1,A?x.call(A,T):x(T)):Em(u,N+1)}(qt(),Xo(),u,h,m,x)}function Em(u,h){const m=u[h];return m===Bi?void 0:m}function X0(u,h,m,x,T,A,N){const W=h+m;return function Xf(u,h,m,x){const T=Ro(u,h,m);return Ro(u,h+1,x)||T}(u,W,T,A)?xa(u,W+2,N?x.call(N,T,A):x(T,A)):Em(u,W+2)}function FC(u,h){const m=$i();let x;const T=u+yi;m.firstCreatePass?(x=function kI(u,h){if(h)for(let m=h.length-1;m>=0;m--){const x=h[m];if(u===x.name)return x}}(h,m.pipeRegistry),m.data[T]=x,x.onDestroy&&(m.destroyHooks??(m.destroyHooks=[])).push(T,x.onDestroy)):x=m.data[T];const A=x.factory||(x.factory=ic(x.type)),N=vo(dm);try{const W=Pa(!1),Q=A();return Pa(W),function Wx(u,h,m,x){m>=u.data.length&&(u.data[m]=null,u.blueprint[m]=null),h[m]=x}(m,qt(),T,Q),Q}finally{vo(N)}}function NC(u,h,m,x){const T=u+yi,A=qt(),N=la(A,T);return function Kd(u,h){return u[Mn].data[h].pure}(A,T)?X0(A,Xo(),h,N.transform,m,x,N):N.transform(m,x)}function _w(u){return h=>{setTimeout(u,void 0,h)}}const Xd=class NI extends d.x{constructor(h=!1){super(),this.__isAsync=h}emit(h){super.next(h)}subscribe(h,m,x){let T=h,A=m||(()=>null),N=x;if(h&&"object"==typeof h){const Q=h;T=Q.next?.bind(Q),A=Q.error?.bind(Q),N=Q.complete?.bind(Q)}this.__isAsync&&(A=_w(A),T&&(T=_w(T)),N&&(N=_w(N)));const W=super.subscribe({next:T,error:A,complete:N});return h instanceof Ne.w0&&h.add(W),W}};function zI(){return this._results[Symbol.iterator]()}class Yg{get changes(){return this._changes||(this._changes=new Xd)}constructor(h=!1){this._emitDistinctChangesOnly=h,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const m=Yg.prototype;m[Symbol.iterator]||(m[Symbol.iterator]=zI)}get(h){return this._results[h]}map(h){return this._results.map(h)}filter(h){return this._results.filter(h)}find(h){return this._results.find(h)}reduce(h,m){return this._results.reduce(h,m)}forEach(h){this._results.forEach(h)}some(h){return this._results.some(h)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(h,m){const x=this;x.dirty=!1;const T=function pa(u){return u.flat(Number.POSITIVE_INFINITY)}(h);(this._changesDetected=!function Eh(u,h,m){if(u.length!==h.length)return!1;for(let x=0;x<u.length;x++){let T=u[x],A=h[x];if(m&&(T=m(T),A=m(A)),A!==T)return!1}return!0}(x._results,T,m))&&(x._results=T,x.length=T.length,x.last=T[this.length-1],x.first=T[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Ha=(()=>{class u{}return u.__NG_ELEMENT_ID__=Vy,u})();const BI=Ha,VI=class extends BI{constructor(h,m,x){super(),this._declarationLView=h,this._declarationTContainer=m,this.elementRef=x}createEmbeddedView(h,m){const x=this._declarationTContainer.tView,T=ny(this._declarationLView,x,h,16,null,x.declTNode,null,null,null,null,m||null);T[Us]=this._declarationLView[this._declarationTContainer.index];const N=this._declarationLView[bo];return null!==N&&(T[bo]=N.createEmbeddedView(x)),t0(x,T,h),new Tc(T)}};function Vy(){return yw(Po(),qt())}function yw(u,h){return 4&u.type?new VI(h,u,Ud(u,h)):null}let vw=(()=>{class u{}return u.__NG_ELEMENT_ID__=zC,u})();function zC(){return Q0(Po(),qt())}const mA=vw,UI=class extends mA{constructor(h,m,x){super(),this._lContainer=h,this._hostTNode=m,this._hostLView=x}get element(){return Ud(this._hostTNode,this._hostLView)}get injector(){return new Jc(this._hostTNode,this._hostLView)}get parentInjector(){const h=Oa(this._hostTNode,this._hostLView);if(tl(h)){const m=Kc(h,this._hostLView),x=Dd(h);return new Jc(m[Mn].data[x+8],m)}return new Jc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(h){const m=BC(this._lContainer);return null!==m&&m[h]||null}get length(){return this._lContainer.length-Cr}createEmbeddedView(h,m,x){let T,A;"number"==typeof x?T=x:null!=x&&(T=x.index,A=x.injector);const N=h.createEmbeddedView(m||{},A);return this.insert(N,T),N}createComponent(h,m,x,T,A){const N=h&&!function fa(u){return"function"==typeof u}(h);let W;if(N)W=m;else{const Se=m||{};W=Se.index,x=Se.injector,T=Se.projectableNodes,A=Se.environmentInjector||Se.ngModuleRef}const Q=N?h:new wg(Zi(h)),re=x||this.parentInjector;if(!A&&null==Q.ngModule){const We=(N?re:this.parentInjector).get(Vh,null);We&&(A=We)}const he=Q.create(re,T,void 0,A);return this.insert(he.hostView,W),he}insert(h,m){const x=h._lView,T=x[Mn];if(function $m(u){return Ji(u[Nt])}(x)){const he=this.indexOf(h);if(-1!==he)this.detach(he);else{const Se=x[Nt],We=new UI(Se,Se[ur],Se[Nt]);We.detach(We.indexOf(h))}}const A=this._adjustIndex(m),N=this._lContainer;!function ru(u,h,m,x){const T=Cr+x,A=m.length;x>0&&(m[T-1][ri]=h),x<A-Cr?(h[ri]=m[T],Np(m,Cr+x,h)):(m.push(h),h[ri]=null),h[Nt]=m;const N=h[Us];null!==N&&m!==N&&function ou(u,h){const m=u[xo];h[ds]!==h[Nt][Nt][ds]&&(u[Jr]=!0),null===m?u[xo]=[h]:m.push(h)}(N,h);const W=h[bo];null!==W&&W.insertView(u),h[Ti]|=64}(T,x,N,A);const W=$p(A,N),Q=x[bi],re=kh(Q,N[El]);return null!==re&&function ol(u,h,m,x,T,A){x[As]=T,x[ur]=h,Hp(u,x,m,1,T,A)}(T,N[ur],Q,x,re,W),h.attachToViewContainerRef(),Np(VC(N),A,h),h}move(h,m){return this.insert(h,m)}indexOf(h){const m=BC(this._lContainer);return null!==m?m.indexOf(h):-1}remove(h){const m=this._adjustIndex(h,-1),x=Dh(this._lContainer,m);x&&(nu(VC(this._lContainer),m),Ah(x[Mn],x))}detach(h){const m=this._adjustIndex(h,-1),x=Dh(this._lContainer,m);return x&&null!=nu(VC(this._lContainer),m)?new Tc(x):null}_adjustIndex(h,m=0){return h??this.length+m}};function BC(u){return u[nc]}function VC(u){return u[nc]||(u[nc]=[])}function Q0(u,h){let m;const x=h[u.index];if(Ji(x))m=x;else{let T;if(8&u.type)T=to(x);else{const A=h[bi];T=A.createComment("");const N=uo(u,h);Oh(A,kh(A,N),T,function za(u,h){return u.nextSibling(h)}(A,N),!1)}h[u.index]=m=a0(x,h,T,u),$d(h,m)}return new UI(m,u,h)}class UC{constructor(h){this.queryList=h,this.matches=null}clone(){return new UC(this.queryList)}setDirty(){this.queryList.setDirty()}}class bw{constructor(h=[]){this.queries=h}createEmbeddedView(h){const m=h.queries;if(null!==m){const x=null!==h.contentQueries?h.contentQueries[0]:m.length,T=[];for(let A=0;A<x;A++){const N=m.getByIndex(A);T.push(this.queries[N.indexInDeclarationView].clone())}return new bw(T)}return null}insertView(h){this.dirtyQueriesWithMatches(h)}detachView(h){this.dirtyQueriesWithMatches(h)}dirtyQueriesWithMatches(h){for(let m=0;m<this.queries.length;m++)null!==GI(h,m).matches&&this.queries[m].setDirty()}}class ta{constructor(h,m,x=null){this.predicate=h,this.flags=m,this.read=x}}class Tm{constructor(h=[]){this.queries=h}elementStart(h,m){for(let x=0;x<this.queries.length;x++)this.queries[x].elementStart(h,m)}elementEnd(h){for(let m=0;m<this.queries.length;m++)this.queries[m].elementEnd(h)}embeddedTView(h){let m=null;for(let x=0;x<this.length;x++){const T=null!==m?m.length:0,A=this.getByIndex(x).embeddedTView(h,T);A&&(A.indexInDeclarationView=x,null!==m?m.push(A):m=[A])}return null!==m?new Tm(m):null}template(h,m){for(let x=0;x<this.queries.length;x++)this.queries[x].template(h,m)}getByIndex(h){return this.queries[h]}get length(){return this.queries.length}track(h){this.queries.push(h)}}class Kh{constructor(h,m=-1){this.metadata=h,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=m}elementStart(h,m){this.isApplyingToNode(m)&&this.matchTNode(h,m)}elementEnd(h){this._declarationNodeIndex===h.index&&(this._appliesToNextNode=!1)}template(h,m){this.elementStart(h,m)}embeddedTView(h,m){return this.isApplyingToNode(h)?(this.crossesNgTemplate=!0,this.addMatch(-h.index,m),new Kh(this.metadata)):null}isApplyingToNode(h){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const m=this._declarationNodeIndex;let x=h.parent;for(;null!==x&&8&x.type&&x.index!==m;)x=x.parent;return m===(null!==x?x.index:-1)}return this._appliesToNextNode}matchTNode(h,m){const x=this.metadata.predicate;if(Array.isArray(x))for(let T=0;T<x.length;T++){const A=x[T];this.matchTNodeWithReadOption(h,m,jC(m,A)),this.matchTNodeWithReadOption(h,m,Vu(m,h,A,!1,!1))}else x===Ha?4&m.type&&this.matchTNodeWithReadOption(h,m,-1):this.matchTNodeWithReadOption(h,m,Vu(m,h,x,!1,!1))}matchTNodeWithReadOption(h,m,x){if(null!==x){const T=this.metadata.read;if(null!==T)if(T===Js||T===vw||T===Ha&&4&m.type)this.addMatch(m.index,-2);else{const A=Vu(m,h,T,!1,!1);null!==A&&this.addMatch(m.index,A)}else this.addMatch(m.index,x)}}addMatch(h,m){null===this.matches?this.matches=[h,m]:this.matches.push(h,m)}}function jC(u,h){const m=u.localNames;if(null!==m)for(let x=0;x<m.length;x+=2)if(m[x]===h)return m[x+1];return null}function sn(u,h,m,x){return-1===m?function gA(u,h){return 11&u.type?Ud(u,h):4&u.type?yw(u,h):null}(h,u):-2===m?function Ns(u,h,m){return m===Js?Ud(h,u):m===Ha?yw(h,u):m===vw?Q0(h,u):void 0}(u,h,x):da(u,u[Mn],m,h)}function Qd(u,h,m,x){const T=h[bo].queries[x];if(null===T.matches){const A=u.data,N=m.matches,W=[];for(let Q=0;Q<N.length;Q+=2){const re=N[Q];W.push(re<0?null:sn(h,A[re],N[Q+1],m.metadata.read))}T.matches=W}return T.matches}function J0(u,h,m,x){const T=u.queries.getByIndex(m),A=T.matches;if(null!==A){const N=Qd(u,h,T,m);for(let W=0;W<A.length;W+=2){const Q=A[W];if(Q>0)x.push(N[W/2]);else{const re=A[W+1],he=h[-Q];for(let Se=Cr;Se<he.length;Se++){const We=he[Se];We[Us]===We[Nt]&&J0(We[Mn],We,re,x)}if(null!==he[xo]){const Se=he[xo];for(let We=0;We<Se.length;We++){const dt=Se[We];J0(dt[Mn],dt,re,x)}}}}}return x}function Hn(u){const h=qt(),m=$i(),x=Fu();Dp(x+1);const T=GI(m,x);if(u.dirty&&function $c(u){return 4==(4&u[Ti])}(h)===(2==(2&T.metadata.flags))){if(null===T.matches)u.reset([]);else{const A=T.crossesNgTemplate?J0(m,h,x,[]):Qd(m,h,T,x);u.reset(A,Ua),u.notifyOnChanges()}return!0}return!1}function si(u,h,m){const x=$i();x.firstCreatePass&&(Ws(x,new ta(u,h,m),-1),2==(2&h)&&(x.staticViewQueries=!0)),Zt(x,qt(),h)}function jI(u,h,m,x){const T=$i();if(T.firstCreatePass){const A=Po();Ws(T,new ta(h,m,x),A.index),function $I(u,h){const m=u.contentQueries||(u.contentQueries=[]);h!==(m.length?m[m.length-1]:-1)&&m.push(u.queries.length-1,h)}(T,u),2==(2&m)&&(T.staticContentQueries=!0)}Zt(T,qt(),m)}function kn(){return function Et(u,h){return u[bo].queries[h].queryList}(qt(),Fu())}function Zt(u,h,m){const x=new Yg(4==(4&m));Hf(u,h,x,x.destroy),null===h[bo]&&(h[bo]=new bw),h[bo].queries.push(new UC(x))}function Ws(u,h,m){null===u.queries&&(u.queries=new Tm),u.queries.track(new Kh(h,m))}function GI(u,h){return u.queries.getByIndex(h)}function HI(u,h){return yw(u,h)}function xw(u){return!!cr(u)}function Tw(...u){}const tS=new xr("Application Initializer");let Iw=(()=>{class u{constructor(m){this.appInits=m,this.resolve=Tw,this.reject=Tw,this.initialized=!1,this.done=!1,this.donePromise=new Promise((x,T)=>{this.resolve=x,this.reject=T})}runInitializers(){if(this.initialized)return;const m=[],x=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let T=0;T<this.appInits.length;T++){const A=this.appInits[T]();if(ep(A))m.push(A);else if(Zx(A)){const N=new Promise((W,Q)=>{A.subscribe({complete:W,error:Q})});m.push(N)}}Promise.all(m).then(()=>{x()}).catch(T=>{this.reject(T)}),0===m.length&&x(),this.initialized=!0}}return u.\u0275fac=function(m){return new(m||u)(cn(tS,8))},u.\u0275prov=vn({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();const nS=new xr("AppId",{providedIn:"root",factory:function iS(){return`${qC()}${qC()}${qC()}`}});function qC(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const rS=new xr("Platform Initializer"),EA=new xr("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),oS=new xr("AnimationModuleType");let TA=(()=>{class u{log(m){console.log(m)}warn(m){console.warn(m)}}return u.\u0275fac=function(m){return new(m||u)},u.\u0275prov=vn({token:u,factory:u.\u0275fac,providedIn:"platform"}),u})();const ob=new xr("LocaleId",{providedIn:"root",factory:()=>Sn(ob,In.Optional|In.SkipSelf)||function sS(){return typeof $localize<"u"&&$localize.locale||Yh}()}),IA=new xr("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Jg{constructor(h,m){this.ngModuleFactory=h,this.componentFactories=m}}let lS=(()=>{class u{compileModuleSync(m){return new G0(m)}compileModuleAsync(m){return Promise.resolve(this.compileModuleSync(m))}compileModuleAndAllComponentsSync(m){const x=this.compileModuleSync(m),A=ja(cr(m).declarations).reduce((N,W)=>{const Q=Zi(W);return Q&&N.push(new wg(Q)),N},[]);return new Jg(x,A)}compileModuleAndAllComponentsAsync(m){return Promise.resolve(this.compileModuleAndAllComponentsSync(m))}clearCache(){}clearCacheFor(m){}getModuleId(m){}}return u.\u0275fac=function(m){return new(m||u)},u.\u0275prov=vn({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();const MA=(()=>Promise.resolve(0))();function YC(u){typeof Zone>"u"?MA.then(()=>{u&&u.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",u)}class ia{constructor({enableLongStackTrace:h=!1,shouldCoalesceEventChangeDetection:m=!1,shouldCoalesceRunChangeDetection:x=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Xd(!1),this.onMicrotaskEmpty=new Xd(!1),this.onStable=new Xd(!1),this.onError=new Xd(!1),typeof Zone>"u")throw new vt(908,!1);Zone.assertZonePatched();const T=this;T._nesting=0,T._outer=T._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(T._inner=T._inner.fork(new Zone.TaskTrackingZoneSpec)),h&&Zone.longStackTraceZoneSpec&&(T._inner=T._inner.fork(Zone.longStackTraceZoneSpec)),T.shouldCoalesceEventChangeDetection=!x&&m,T.shouldCoalesceRunChangeDetection=x,T.lastRequestAnimationFrameId=-1,T.nativeRequestAnimationFrame=function na(){let u=pi.requestAnimationFrame,h=pi.cancelAnimationFrame;if(typeof Zone<"u"&&u&&h){const m=u[Zone.__symbol__("OriginalDelegate")];m&&(u=m);const x=h[Zone.__symbol__("OriginalDelegate")];x&&(h=x)}return{nativeRequestAnimationFrame:u,nativeCancelAnimationFrame:h}}().nativeRequestAnimationFrame,function cS(u){const h=()=>{!function KC(u){u.isCheckStableRunning||-1!==u.lastRequestAnimationFrameId||(u.lastRequestAnimationFrameId=u.nativeRequestAnimationFrame.call(pi,()=>{u.fakeTopEventTask||(u.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{u.lastRequestAnimationFrameId=-1,e_(u),u.isCheckStableRunning=!0,fp(u),u.isCheckStableRunning=!1},void 0,()=>{},()=>{})),u.fakeTopEventTask.invoke()}),e_(u))}(u)};u._inner=u._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(m,x,T,A,N,W)=>{try{return uS(u),m.invokeTask(T,A,N,W)}finally{(u.shouldCoalesceEventChangeDetection&&"eventTask"===A.type||u.shouldCoalesceRunChangeDetection)&&h(),pp(u)}},onInvoke:(m,x,T,A,N,W,Q)=>{try{return uS(u),m.invoke(T,A,N,W,Q)}finally{u.shouldCoalesceRunChangeDetection&&h(),pp(u)}},onHasTask:(m,x,T,A)=>{m.hasTask(T,A),x===T&&("microTask"==A.change?(u._hasPendingMicrotasks=A.microTask,e_(u),fp(u)):"macroTask"==A.change&&(u.hasPendingMacrotasks=A.macroTask))},onHandleError:(m,x,T,A)=>(m.handleError(T,A),u.runOutsideAngular(()=>u.onError.emit(A)),!1)})}(T)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ia.isInAngularZone())throw new vt(909,!1)}static assertNotInAngularZone(){if(ia.isInAngularZone())throw new vt(909,!1)}run(h,m,x){return this._inner.run(h,m,x)}runTask(h,m,x,T){const A=this._inner,N=A.scheduleEventTask("NgZoneEvent: "+T,h,Is,Tw,Tw);try{return A.runTask(N,m,x)}finally{A.cancelTask(N)}}runGuarded(h,m,x){return this._inner.runGuarded(h,m,x)}runOutsideAngular(h){return this._outer.run(h)}}const Is={};function fp(u){if(0==u._nesting&&!u.hasPendingMicrotasks&&!u.isStable)try{u._nesting++,u.onMicrotaskEmpty.emit(null)}finally{if(u._nesting--,!u.hasPendingMicrotasks)try{u.runOutsideAngular(()=>u.onStable.emit(null))}finally{u.isStable=!0}}}function e_(u){u.hasPendingMicrotasks=!!(u._hasPendingMicrotasks||(u.shouldCoalesceEventChangeDetection||u.shouldCoalesceRunChangeDetection)&&-1!==u.lastRequestAnimationFrameId)}function uS(u){u._nesting++,u.isStable&&(u.isStable=!1,u.onUnstable.emit(null))}function pp(u){u._nesting--,fp(u)}class Im{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Xd,this.onMicrotaskEmpty=new Xd,this.onStable=new Xd,this.onError=new Xd}run(h,m,x){return h.apply(m,x)}runGuarded(h,m,x){return h.apply(m,x)}runOutsideAngular(h){return h()}runTask(h,m,x,T){return h.apply(m,x)}}const ab=new xr(""),Sm=new xr("");let Sw,Xh=(()=>{class u{constructor(m,x,T){this._ngZone=m,this.registry=x,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Sw||(function Mm(u){Sw=u}(T),T.addToWindow(x)),this._watchAngularEvents(),m.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ia.assertNotInAngularZone(),YC(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())YC(()=>{for(;0!==this._callbacks.length;){let m=this._callbacks.pop();clearTimeout(m.timeoutId),m.doneCb(this._didWork)}this._didWork=!1});else{let m=this.getPendingTasks();this._callbacks=this._callbacks.filter(x=>!x.updateCb||!x.updateCb(m)||(clearTimeout(x.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(m=>({source:m.source,creationLocation:m.creationLocation,data:m.data})):[]}addCallback(m,x,T){let A=-1;x&&x>0&&(A=setTimeout(()=>{this._callbacks=this._callbacks.filter(N=>N.timeoutId!==A),m(this._didWork,this.getPendingTasks())},x)),this._callbacks.push({doneCb:m,timeoutId:A,updateCb:T})}whenStable(m,x,T){if(T&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(m,x,T),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(m){this.registry.registerApplication(m,this)}unregisterApplication(m){this.registry.unregisterApplication(m)}findProviders(m,x,T){return[]}}return u.\u0275fac=function(m){return new(m||u)(cn(ia),cn(Wy),cn(Sm))},u.\u0275prov=vn({token:u,factory:u.\u0275fac}),u})(),Wy=(()=>{class u{constructor(){this._applications=new Map}registerApplication(m,x){this._applications.set(m,x)}unregisterApplication(m){this._applications.delete(m)}unregisterAllApplications(){this._applications.clear()}getTestability(m){return this._applications.get(m)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(m,x=!0){return Sw?.findTestabilityInTree(this,m,x)??null}}return u.\u0275fac=function(m){return new(m||u)},u.\u0275prov=vn({token:u,factory:u.\u0275fac,providedIn:"platform"}),u})();const Dc=!1;let Qh=null;const Dm=new xr("AllowMultipleToken"),lb=new xr("PlatformDestroyListeners"),Zy=new xr("appBootstrapListener");class cb{constructor(h,m){this.name=h,this.token=m}}function XC(u,h,m=[]){const x=`Platform: ${h}`,T=new xr(x);return(A=[])=>{let N=Jh();if(!N||N.injector.get(Dm,!1)){const W=[...m,...A,{provide:T,useValue:!0}];u?u(W):function hS(u){if(Qh&&!Qh.get(Dm,!1))throw new vt(400,!1);Qh=u;const h=u.get(JC);(function fS(u){const h=u.get(rS,null);h&&h.forEach(m=>m())})(u)}(function QC(u=[],h){return sm.create({name:h,providers:[{provide:U_,useValue:"platform"},{provide:lb,useValue:new Set([()=>Qh=null])},...u]})}(W,x))}return function Ta(u){const h=Jh();if(!h)throw new vt(401,!1);return h}()}}function Jh(){return Qh?.get(JC)??null}let JC=(()=>{class u{constructor(m){this._injector=m,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(m,x){const T=function t_(u,h){let m;return m="noop"===u?new Im:("zone.js"===u?void 0:u)||new ia(h),m}(x?.ngZone,function eE(u){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!u||!u.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!u||!u.ngZoneRunCoalescing)||!1}}(x)),A=[{provide:ia,useValue:T}];return T.run(()=>{const N=sm.create({providers:A,parent:this.injector,name:m.moduleType.name}),W=m.create(N),Q=W.injector.get(ag,null);if(!Q)throw new vt(402,!1);return T.runOutsideAngular(()=>{const re=T.onError.subscribe({next:he=>{Q.handleError(he)}});W.onDestroy(()=>{Vr(this._modules,W),re.unsubscribe()})}),function pS(u,h,m){try{const x=m();return ep(x)?x.catch(T=>{throw h.runOutsideAngular(()=>u.handleError(T)),T}):x}catch(x){throw h.runOutsideAngular(()=>u.handleError(x)),x}}(Q,T,()=>{const re=W.injector.get(Iw);return re.runInitializers(),re.donePromise.then(()=>(function Ca(u){wn(u,"Expected localeId to be defined"),"string"==typeof u&&(So=u.toLowerCase().replace(/_/g,"-"))}(W.injector.get(ob,Yh)||Yh),this._moduleDoBootstrap(W),W))})})}bootstrapModule(m,x=[]){const T=tE({},x);return function dS(u,h,m){const x=new G0(m);return Promise.resolve(x)}(0,0,m).then(A=>this.bootstrapModuleFactory(A,T))}_moduleDoBootstrap(m){const x=m.injector.get(gr);if(m._bootstrapComponents.length>0)m._bootstrapComponents.forEach(T=>x.bootstrap(T));else{if(!m.instance.ngDoBootstrap)throw new vt(-403,!1);m.instance.ngDoBootstrap(x)}this._modules.push(m)}onDestroy(m){this._destroyListeners.push(m)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new vt(404,!1);this._modules.slice().forEach(x=>x.destroy()),this._destroyListeners.forEach(x=>x());const m=this._injector.get(lb,null);m&&(m.forEach(x=>x()),m.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return u.\u0275fac=function(m){return new(m||u)(cn(sm))},u.\u0275prov=vn({token:u,factory:u.\u0275fac,providedIn:"platform"}),u})();function tE(u,h){return Array.isArray(h)?h.reduce(tE,u):{...u,...h}}let gr=(()=>{class u{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(m,x,T){this._zone=m,this._injector=x,this._exceptionHandler=T,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const A=new Me.y(W=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{W.next(this._stable),W.complete()})}),N=new Me.y(W=>{let Q;this._zone.runOutsideAngular(()=>{Q=this._zone.onStable.subscribe(()=>{ia.assertNotInAngularZone(),YC(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,W.next(!0))})})});const re=this._zone.onUnstable.subscribe(()=>{ia.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{W.next(!1)}))});return()=>{Q.unsubscribe(),re.unsubscribe()}});this.isStable=(0,_.T)(A,N.pipe((0,$e.B)()))}bootstrap(m,x){const T=m instanceof dx;if(!this._injector.get(Iw).done){!T&&Ao(m);throw new vt(405,Dc)}let N;N=T?m:this._injector.get(Vd).resolveComponentFactory(m),this.componentTypes.push(N.componentType);const W=function Mw(u){return u.isBoundToModule}(N)?void 0:this._injector.get(Zg),re=N.create(sm.NULL,[],x||N.selector,W),he=re.location.nativeElement,Se=re.injector.get(ab,null);return Se?.registerApplication(he),re.onDestroy(()=>{this.detachView(re.hostView),Vr(this.components,re),Se?.unregisterApplication(he)}),this._loadComponent(re),re}tick(){if(this._runningTick)throw new vt(101,!1);try{this._runningTick=!0;for(let m of this._views)m.detectChanges()}catch(m){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(m))}finally{this._runningTick=!1}}attachView(m){const x=m;this._views.push(x),x.attachToAppRef(this)}detachView(m){const x=m;Vr(this._views,x),x.detachFromAppRef()}_loadComponent(m){this.attachView(m.hostView),this.tick(),this.components.push(m);const x=this._injector.get(Zy,[]);x.push(...this._bootstrapListeners),x.forEach(T=>T(m))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(m=>m()),this._views.slice().forEach(m=>m.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(m){return this._destroyListeners.push(m),()=>Vr(this._destroyListeners,m)}destroy(){if(this._destroyed)throw new vt(406,!1);const m=this._injector;m.destroy&&!m.destroyed&&m.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return u.\u0275fac=function(m){return new(m||u)(cn(ia),cn(Vh),cn(ag))},u.\u0275prov=vn({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();function Vr(u,h){const m=u.indexOf(h);m>-1&&u.splice(m,1)}function iE(){return!1}let gS=(()=>{class u{}return u.__NG_ELEMENT_ID__=RA,u})();function RA(u){return function FA(u,h,m){if(Nc(u)&&!m){const x=di(u.index,h);return new Tc(x,x)}return 47&u.type?new Tc(h[ds],h):null}(Po(),qt(),16==(16&u))}class gl{constructor(){}supports(h){return qh(h)}create(h){return new kw(h)}}const aE=(u,h)=>h;class kw{constructor(h){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=h||aE}forEachItem(h){let m;for(m=this._itHead;null!==m;m=m._next)h(m)}forEachOperation(h){let m=this._itHead,x=this._removalsHead,T=0,A=null;for(;m||x;){const N=!x||m&&m.currentIndex<Xy(x,T,A)?m:x,W=Xy(N,T,A),Q=N.currentIndex;if(N===x)T--,x=x._nextRemoved;else if(m=m._next,null==N.previousIndex)T++;else{A||(A=[]);const re=W-T,he=Q-T;if(re!=he){for(let We=0;We<re;We++){const dt=We<A.length?A[We]:A[We]=0,Rt=dt+We;he<=Rt&&Rt<re&&(A[We]=dt+1)}A[N.previousIndex]=he-re}}W!==Q&&h(N,W,Q)}}forEachPreviousItem(h){let m;for(m=this._previousItHead;null!==m;m=m._nextPrevious)h(m)}forEachAddedItem(h){let m;for(m=this._additionsHead;null!==m;m=m._nextAdded)h(m)}forEachMovedItem(h){let m;for(m=this._movesHead;null!==m;m=m._nextMoved)h(m)}forEachRemovedItem(h){let m;for(m=this._removalsHead;null!==m;m=m._nextRemoved)h(m)}forEachIdentityChange(h){let m;for(m=this._identityChangesHead;null!==m;m=m._nextIdentityChange)h(m)}diff(h){if(null==h&&(h=[]),!qh(h))throw new vt(900,!1);return this.check(h)?this:null}onDestroy(){}check(h){this._reset();let T,A,N,m=this._itHead,x=!1;if(Array.isArray(h)){this.length=h.length;for(let W=0;W<this.length;W++)A=h[W],N=this._trackByFn(W,A),null!==m&&Object.is(m.trackById,N)?(x&&(m=this._verifyReinsertion(m,A,N,W)),Object.is(m.item,A)||this._addIdentityChange(m,A)):(m=this._mismatch(m,A,N,W),x=!0),m=m._next}else T=0,function d0(u,h){if(Array.isArray(u))for(let m=0;m<u.length;m++)h(u[m]);else{const m=u[Symbol.iterator]();let x;for(;!(x=m.next()).done;)h(x.value)}}(h,W=>{N=this._trackByFn(T,W),null!==m&&Object.is(m.trackById,N)?(x&&(m=this._verifyReinsertion(m,W,N,T)),Object.is(m.item,W)||this._addIdentityChange(m,W)):(m=this._mismatch(m,W,N,T),x=!0),m=m._next,T++}),this.length=T;return this._truncate(m),this.collection=h,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let h;for(h=this._previousItHead=this._itHead;null!==h;h=h._next)h._nextPrevious=h._next;for(h=this._additionsHead;null!==h;h=h._nextAdded)h.previousIndex=h.currentIndex;for(this._additionsHead=this._additionsTail=null,h=this._movesHead;null!==h;h=h._nextMoved)h.previousIndex=h.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(h,m,x,T){let A;return null===h?A=this._itTail:(A=h._prev,this._remove(h)),null!==(h=null===this._unlinkedRecords?null:this._unlinkedRecords.get(x,null))?(Object.is(h.item,m)||this._addIdentityChange(h,m),this._reinsertAfter(h,A,T)):null!==(h=null===this._linkedRecords?null:this._linkedRecords.get(x,T))?(Object.is(h.item,m)||this._addIdentityChange(h,m),this._moveAfter(h,A,T)):h=this._addAfter(new hb(m,x),A,T),h}_verifyReinsertion(h,m,x,T){let A=null===this._unlinkedRecords?null:this._unlinkedRecords.get(x,null);return null!==A?h=this._reinsertAfter(A,h._prev,T):h.currentIndex!=T&&(h.currentIndex=T,this._addToMoves(h,T)),h}_truncate(h){for(;null!==h;){const m=h._next;this._addToRemovals(this._unlink(h)),h=m}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(h,m,x){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(h);const T=h._prevRemoved,A=h._nextRemoved;return null===T?this._removalsHead=A:T._nextRemoved=A,null===A?this._removalsTail=T:A._prevRemoved=T,this._insertAfter(h,m,x),this._addToMoves(h,x),h}_moveAfter(h,m,x){return this._unlink(h),this._insertAfter(h,m,x),this._addToMoves(h,x),h}_addAfter(h,m,x){return this._insertAfter(h,m,x),this._additionsTail=null===this._additionsTail?this._additionsHead=h:this._additionsTail._nextAdded=h,h}_insertAfter(h,m,x){const T=null===m?this._itHead:m._next;return h._next=T,h._prev=m,null===T?this._itTail=h:T._prev=h,null===m?this._itHead=h:m._next=h,null===this._linkedRecords&&(this._linkedRecords=new Rw),this._linkedRecords.put(h),h.currentIndex=x,h}_remove(h){return this._addToRemovals(this._unlink(h))}_unlink(h){null!==this._linkedRecords&&this._linkedRecords.remove(h);const m=h._prev,x=h._next;return null===m?this._itHead=x:m._next=x,null===x?this._itTail=m:x._prev=m,h}_addToMoves(h,m){return h.previousIndex===m||(this._movesTail=null===this._movesTail?this._movesHead=h:this._movesTail._nextMoved=h),h}_addToRemovals(h){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Rw),this._unlinkedRecords.put(h),h.currentIndex=null,h._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=h,h._prevRemoved=null):(h._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=h),h}_addIdentityChange(h,m){return h.item=m,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=h:this._identityChangesTail._nextIdentityChange=h,h}}class hb{constructor(h,m){this.item=h,this.trackById=m,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class vS{constructor(){this._head=null,this._tail=null}add(h){null===this._head?(this._head=this._tail=h,h._nextDup=null,h._prevDup=null):(this._tail._nextDup=h,h._prevDup=this._tail,h._nextDup=null,this._tail=h)}get(h,m){let x;for(x=this._head;null!==x;x=x._nextDup)if((null===m||m<=x.currentIndex)&&Object.is(x.trackById,h))return x;return null}remove(h){const m=h._prevDup,x=h._nextDup;return null===m?this._head=x:m._nextDup=x,null===x?this._tail=m:x._prevDup=m,null===this._head}}class Rw{constructor(){this.map=new Map}put(h){const m=h.trackById;let x=this.map.get(m);x||(x=new vS,this.map.set(m,x)),x.add(h)}get(h,m){const T=this.map.get(h);return T?T.get(h,m):null}remove(h){const m=h.trackById;return this.map.get(m).remove(h)&&this.map.delete(m),h}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Xy(u,h,m){const x=u.previousIndex;if(null===x)return x;let T=0;return m&&x<m.length&&(T=m[x]),x+h+T}class lE{constructor(){}supports(h){return h instanceof Map||Ig(h)}create(){return new bS}}class bS{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(h){let m;for(m=this._mapHead;null!==m;m=m._next)h(m)}forEachPreviousItem(h){let m;for(m=this._previousMapHead;null!==m;m=m._nextPrevious)h(m)}forEachChangedItem(h){let m;for(m=this._changesHead;null!==m;m=m._nextChanged)h(m)}forEachAddedItem(h){let m;for(m=this._additionsHead;null!==m;m=m._nextAdded)h(m)}forEachRemovedItem(h){let m;for(m=this._removalsHead;null!==m;m=m._nextRemoved)h(m)}diff(h){if(h){if(!(h instanceof Map||Ig(h)))throw new vt(900,!1)}else h=new Map;return this.check(h)?this:null}onDestroy(){}check(h){this._reset();let m=this._mapHead;if(this._appendAfter=null,this._forEach(h,(x,T)=>{if(m&&m.key===T)this._maybeAddToChanges(m,x),this._appendAfter=m,m=m._next;else{const A=this._getOrCreateRecordForKey(T,x);m=this._insertBeforeOrAppend(m,A)}}),m){m._prev&&(m._prev._next=null),this._removalsHead=m;for(let x=m;null!==x;x=x._nextRemoved)x===this._mapHead&&(this._mapHead=null),this._records.delete(x.key),x._nextRemoved=x._next,x.previousValue=x.currentValue,x.currentValue=null,x._prev=null,x._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(h,m){if(h){const x=h._prev;return m._next=h,m._prev=x,h._prev=m,x&&(x._next=m),h===this._mapHead&&(this._mapHead=m),this._appendAfter=h,h}return this._appendAfter?(this._appendAfter._next=m,m._prev=this._appendAfter):this._mapHead=m,this._appendAfter=m,null}_getOrCreateRecordForKey(h,m){if(this._records.has(h)){const T=this._records.get(h);this._maybeAddToChanges(T,m);const A=T._prev,N=T._next;return A&&(A._next=N),N&&(N._prev=A),T._next=null,T._prev=null,T}const x=new BA(h);return this._records.set(h,x),x.currentValue=m,this._addToAdditions(x),x}_reset(){if(this.isDirty){let h;for(this._previousMapHead=this._mapHead,h=this._previousMapHead;null!==h;h=h._next)h._nextPrevious=h._next;for(h=this._changesHead;null!==h;h=h._nextChanged)h.previousValue=h.currentValue;for(h=this._additionsHead;null!=h;h=h._nextAdded)h.previousValue=h.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(h,m){Object.is(m,h.currentValue)||(h.previousValue=h.currentValue,h.currentValue=m,this._addToChanges(h))}_addToAdditions(h){null===this._additionsHead?this._additionsHead=this._additionsTail=h:(this._additionsTail._nextAdded=h,this._additionsTail=h)}_addToChanges(h){null===this._changesHead?this._changesHead=this._changesTail=h:(this._changesTail._nextChanged=h,this._changesTail=h)}_forEach(h,m){h instanceof Map?h.forEach(m):Object.keys(h).forEach(x=>m(h[x],x))}}class BA{constructor(h){this.key=h,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function gp(){return new cE([new gl])}let cE=(()=>{class u{constructor(m){this.factories=m}static create(m,x){if(null!=x){const T=x.factories.slice();m=m.concat(T)}return new u(m)}static extend(m){return{provide:u,useFactory:x=>u.create(m,x||gp()),deps:[[u,new ye,new ge]]}}find(m){const x=this.factories.find(T=>T.supports(m));if(null!=x)return x;throw new vt(901,!1)}}return u.\u0275prov=vn({token:u,providedIn:"root",factory:gp}),u})();function uE(){return new r_([new lE])}let r_=(()=>{class u{constructor(m){this.factories=m}static create(m,x){if(x){const T=x.factories.slice();m=m.concat(T)}return new u(m)}static extend(m){return{provide:u,useFactory:x=>u.create(m,x||uE()),deps:[[u,new ye,new ge]]}}find(m){const x=this.factories.find(T=>T.supports(m));if(x)return x;throw new vt(901,!1)}}return u.\u0275prov=vn({token:u,providedIn:"root",factory:uE}),u})();const UA=XC(null,"core",[]);let jA=(()=>{class u{constructor(m){}}return u.\u0275fac=function(m){return new(m||u)(cn(gr))},u.\u0275mod=Ci({type:u}),u.\u0275inj=Pi({}),u})();function ir(u){return"boolean"==typeof u?u:null!=u&&"false"!==u}},3942:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{Z:()=>bn});var d=Ae(2090),Ne=Ae(4859),Me=Ae(9681),_=Ae(1877);class $e{constructor(vt,Ye){this._delegate=vt,this.firebase=Ye,(0,Me._addComponent)(vt,new Ne.wA("app-compat",()=>this,"PUBLIC")),this.container=vt.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(vt){this._delegate.automaticDataCollectionEnabled=vt}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(vt=>{this._delegate.checkDestroyed(),vt()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,Me.deleteApp)(this._delegate)))}_getService(vt,Ye=Me._DEFAULT_ENTRY_NAME){var Ft;this._delegate.checkDestroyed();const Jt=this._delegate.container.getProvider(vt);return!Jt.isInitialized()&&"EXPLICIT"===(null===(Ft=Jt.getComponent())||void 0===Ft?void 0:Ft.instantiationMode)&&Jt.initialize(),Jt.getImmediate({identifier:Ye})}_removeServiceInstance(vt,Ye=Me._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(vt).clearInstance(Ye)}_addComponent(vt){(0,Me._addComponent)(this._delegate,vt)}_addOrOverwriteComponent(vt){(0,Me._addOrOverwriteComponent)(this._delegate,vt)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const on=new d.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),Ve=function It(){const Dn=function yt(Dn){const vt={},Ye={__esModule:!0,initializeApp:function Xt(tt,pt={}){const zt=Me.initializeApp(tt,pt);if((0,d.r3)(vt,zt.name))return vt[zt.name];const Bt=new Dn(zt,Ye);return vt[zt.name]=Bt,Bt},app:Jt,registerVersion:Me.registerVersion,setLogLevel:Me.setLogLevel,onLog:Me.onLog,apps:null,SDK_VERSION:Me.SDK_VERSION,INTERNAL:{registerComponent:function Pt(tt){const pt=tt.name,zt=pt.replace("-compat","");if(Me._registerComponent(tt)&&"PUBLIC"===tt.type){const Bt=(an=Jt())=>{if("function"!=typeof an[zt])throw on.create("invalid-app-argument",{appName:pt});return an[zt]()};void 0!==tt.serviceProps&&(0,d.ZB)(Bt,tt.serviceProps),Ye[zt]=Bt,Dn.prototype[zt]=function(...an){return this._getService.bind(this,pt).apply(this,tt.multipleInstances?an:[])}}return"PUBLIC"===tt.type?Ye[zt]:null},removeApp:function Ft(tt){delete vt[tt]},useAsService:function un(tt,pt){return"serverAuth"===pt?null:pt},modularAPIs:Me}};function Jt(tt){if(!(0,d.r3)(vt,tt=tt||Me._DEFAULT_ENTRY_NAME))throw on.create("no-app",{appName:tt});return vt[tt]}return Ye.default=Ye,Object.defineProperty(Ye,"apps",{get:function Ct(){return Object.keys(vt).map(tt=>vt[tt])}}),Jt.App=Dn,Ye}($e);return Dn.INTERNAL=Object.assign(Object.assign({},Dn.INTERNAL),{createFirebaseNamespace:It,extendNamespace:function vt(Ye){(0,d.ZB)(Dn,Ye)},createSubscribe:d.ne,ErrorFactory:d.LL,deepExtend:d.ZB}),Dn}(),je=new _.Yd("@firebase/app-compat");if((0,d.jU)()&&void 0!==self.firebase){je.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Dn=self.firebase.SDK_VERSION;Dn&&Dn.indexOf("LITE")>=0&&je.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const bn=Ve;!function tn(Dn){(0,Me.registerVersion)("@firebase/app-compat","0.2.7",Dn)}()},9681:(ui,Kt,Ae)=>{"use strict";Ae.r(Kt),Ae.d(Kt,{FirebaseError:()=>_.ZR,SDK_VERSION:()=>oo,_DEFAULT_ENTRY_NAME:()=>nn,_addComponent:()=>rr,_addOrOverwriteComponent:()=>qn,_apps:()=>wn,_clearComponents:()=>Pi,_components:()=>Cn,_getProvider:()=>vn,_registerComponent:()=>zn,_removeServiceInstance:()=>Qi,deleteApp:()=>_s,getApp:()=>so,getApps:()=>Ds,initializeApp:()=>Ms,onLog:()=>In,registerVersion:()=>jr,setLogLevel:()=>zo});var d=Ae(5861),Ne=Ae(4859),Me=Ae(1877),_=Ae(2090),$e=Ae(8766);class ft{constructor(Vt){this.container=Vt}getPlatformInfoString(){return this.container.getProviders().map(Sn=>{if(function on(cn){return"VERSION"===cn.getComponent()?.type}(Sn)){const Zn=Sn.getImmediate();return`${Zn.library}/${Zn.version}`}return null}).filter(Sn=>Sn).join(" ")}}const yt="@firebase/app",Ve=new Me.Yd("@firebase/app"),nn="[DEFAULT]",en={[yt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},wn=new Map,Cn=new Map;function rr(cn,Vt){try{cn.container.addComponent(Vt)}catch(Sn){Ve.debug(`Component ${Vt.name} failed to register with FirebaseApp ${cn.name}`,Sn)}}function qn(cn,Vt){cn.container.addOrOverwriteComponent(Vt)}function zn(cn){const Vt=cn.name;if(Cn.has(Vt))return Ve.debug(`There were multiple attempts to register component ${Vt}.`),!1;Cn.set(Vt,cn);for(const Sn of wn.values())rr(Sn,cn);return!0}function vn(cn,Vt){const Sn=cn.container.getProvider("heartbeat").getImmediate({optional:!0});return Sn&&Sn.triggerHeartbeat(),cn.container.getProvider(Vt)}function Qi(cn,Vt,Sn=nn){vn(cn,Vt).clearInstance(Sn)}function Pi(){Cn.clear()}const Vn=new _.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class kr{constructor(Vt,Sn,Zn){this._isDeleted=!1,this._options=Object.assign({},Vt),this._config=Object.assign({},Sn),this._name=Sn.name,this._automaticDataCollectionEnabled=Sn.automaticDataCollectionEnabled,this._container=Zn,this.container.addComponent(new Ne.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Vt){this.checkDestroyed(),this._automaticDataCollectionEnabled=Vt}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Vt){this._isDeleted=Vt}checkDestroyed(){if(this.isDeleted)throw Vn.create("app-deleted",{appName:this._name})}}const oo="9.19.1";function Ms(cn,Vt={}){let Sn=cn;"object"!=typeof Vt&&(Vt={name:Vt});const Zn=Object.assign({name:nn,automaticDataCollectionEnabled:!1},Vt),ei=Zn.name;if("string"!=typeof ei||!ei)throw Vn.create("bad-app-name",{appName:String(ei)});if(Sn||(Sn=(0,_.aH)()),!Sn)throw Vn.create("no-options");const ki=wn.get(ei);if(ki){if((0,_.vZ)(Sn,ki.options)&&(0,_.vZ)(Zn,ki.config))return ki;throw Vn.create("duplicate-app",{appName:ei})}const Qr=new Ne.H0(ei);for(const ne of Cn.values())Qr.addComponent(ne);const ze=new kr(Sn,Zn,Qr);return wn.set(ei,ze),ze}function so(cn=nn){const Vt=wn.get(cn);if(!Vt&&cn===nn)return Ms();if(!Vt)throw Vn.create("no-app",{appName:cn});return Vt}function Ds(){return Array.from(wn.values())}function _s(cn){return Ir.apply(this,arguments)}function Ir(){return(Ir=(0,d.Z)(function*(cn){const Vt=cn.name;wn.has(Vt)&&(wn.delete(Vt),yield Promise.all(cn.container.getProviders().map(Sn=>Sn.delete())),cn.isDeleted=!0)})).apply(this,arguments)}function jr(cn,Vt,Sn){var Zn;let ei=null!==(Zn=en[cn])&&void 0!==Zn?Zn:cn;Sn&&(ei+=`-${Sn}`);const ki=ei.match(/\s|\//),Qr=Vt.match(/\s|\//);if(ki||Qr){const ze=[`Unable to register library "${ei}" with version "${Vt}":`];return ki&&ze.push(`library name "${ei}" contains illegal characters (whitespace or "/")`),ki&&Qr&&ze.push("and"),Qr&&ze.push(`version name "${Vt}" contains illegal characters (whitespace or "/")`),void Ve.warn(ze.join(" "))}zn(new Ne.wA(`${ei}-version`,()=>({library:ei,version:Vt}),"VERSION"))}function In(cn,Vt){if(null!==cn&&"function"!=typeof cn)throw Vn.create("invalid-log-argument");(0,Me.Am)(cn,Vt)}function zo(cn){(0,Me.Ub)(cn)}const ls="firebase-heartbeat-database",vo=1,$r="firebase-heartbeat-store";let cs=null;function pi(){return cs||(cs=(0,$e.X3)(ls,vo,{upgrade:(cn,Vt)=>{0===Vt&&cn.createObjectStore($r)}}).catch(cn=>{throw Vn.create("idb-open",{originalErrorMessage:cn.message})})),cs}function Kn(){return(Kn=(0,d.Z)(function*(cn){try{return(yield pi()).transaction($r).objectStore($r).get(Xr(cn))}catch(Vt){if(Vt instanceof _.ZR)Ve.warn(Vt.message);else{const Sn=Vn.create("idb-get",{originalErrorMessage:Vt?.message});Ve.warn(Sn.message)}}})).apply(this,arguments)}function Nr(cn,Vt){return Sr.apply(this,arguments)}function Sr(){return(Sr=(0,d.Z)(function*(cn,Vt){try{const Zn=(yield pi()).transaction($r,"readwrite");return yield Zn.objectStore($r).put(Vt,Xr(cn)),Zn.done}catch(Sn){if(Sn instanceof _.ZR)Ve.warn(Sn.message);else{const Zn=Vn.create("idb-set",{originalErrorMessage:Sn?.message});Ve.warn(Zn.message)}}})).apply(this,arguments)}function Xr(cn){return`${cn.name}!${cn.options.appId}`}class ys{constructor(Vt){this.container=Vt,this._heartbeatsCache=null;const Sn=this.container.getProvider("app").getImmediate();this._storage=new Ei(Sn),this._heartbeatsCachePromise=this._storage.read().then(Zn=>(this._heartbeatsCache=Zn,Zn))}triggerHeartbeat(){var Vt=this;return(0,d.Z)(function*(){const Zn=Vt.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),ei=wi();if(null===Vt._heartbeatsCache&&(Vt._heartbeatsCache=yield Vt._heartbeatsCachePromise),Vt._heartbeatsCache.lastSentHeartbeatDate!==ei&&!Vt._heartbeatsCache.heartbeats.some(ki=>ki.date===ei))return Vt._heartbeatsCache.heartbeats.push({date:ei,agent:Zn}),Vt._heartbeatsCache.heartbeats=Vt._heartbeatsCache.heartbeats.filter(ki=>{const Qr=new Date(ki.date).valueOf();return Date.now()-Qr<=2592e6}),Vt._storage.overwrite(Vt._heartbeatsCache)})()}getHeartbeatsHeader(){var Vt=this;return(0,d.Z)(function*(){if(null===Vt._heartbeatsCache&&(yield Vt._heartbeatsCachePromise),null===Vt._heartbeatsCache||0===Vt._heartbeatsCache.heartbeats.length)return"";const Sn=wi(),{heartbeatsToSend:Zn,unsentEntries:ei}=function Vs(cn,Vt=1024){const Sn=[];let Zn=cn.slice();for(const ei of cn){const ki=Sn.find(Qr=>Qr.agent===ei.agent);if(ki){if(ki.dates.push(ei.date),lo(Sn)>Vt){ki.dates.pop();break}}else if(Sn.push({agent:ei.agent,dates:[ei.date]}),lo(Sn)>Vt){Sn.pop();break}Zn=Zn.slice(1)}return{heartbeatsToSend:Sn,unsentEntries:Zn}}(Vt._heartbeatsCache.heartbeats),ki=(0,_.L)(JSON.stringify({version:2,heartbeats:Zn}));return Vt._heartbeatsCache.lastSentHeartbeatDate=Sn,ei.length>0?(Vt._heartbeatsCache.heartbeats=ei,yield Vt._storage.overwrite(Vt._heartbeatsCache)):(Vt._heartbeatsCache.heartbeats=[],Vt._storage.overwrite(Vt._heartbeatsCache)),ki})()}}function wi(){return(new Date).toISOString().substring(0,10)}class Ei{constructor(Vt){this.app=Vt,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,d.Z)(function*(){return!!(0,_.hl)()&&(0,_.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Vt=this;return(0,d.Z)(function*(){return(yield Vt._canUseIndexedDBPromise)&&(yield function jn(cn){return Kn.apply(this,arguments)}(Vt.app))||{heartbeats:[]}})()}overwrite(Vt){var Sn=this;return(0,d.Z)(function*(){var Zn;if(yield Sn._canUseIndexedDBPromise){const ki=yield Sn.read();return Nr(Sn.app,{lastSentHeartbeatDate:null!==(Zn=Vt.lastSentHeartbeatDate)&&void 0!==Zn?Zn:ki.lastSentHeartbeatDate,heartbeats:Vt.heartbeats})}})()}add(Vt){var Sn=this;return(0,d.Z)(function*(){var Zn;if(yield Sn._canUseIndexedDBPromise){const ki=yield Sn.read();return Nr(Sn.app,{lastSentHeartbeatDate:null!==(Zn=Vt.lastSentHeartbeatDate)&&void 0!==Zn?Zn:ki.lastSentHeartbeatDate,heartbeats:[...ki.heartbeats,...Vt.heartbeats]})}})()}}function lo(cn){return(0,_.L)(JSON.stringify({version:2,heartbeats:cn})).length}!function Hr(cn){zn(new Ne.wA("platform-logger",Vt=>new ft(Vt),"PRIVATE")),zn(new Ne.wA("heartbeat",Vt=>new ys(Vt),"PRIVATE")),jr(yt,"0.9.7",cn),jr(yt,"0.9.7","esm2017"),jr("fire-js","")}("")},4859:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{H0:()=>yt,wA:()=>Me});var d=Ae(5861),Ne=Ae(2090);class Me{constructor(Ve,je,Ke){this.name=Ve,this.instanceFactory=je,this.type=Ke,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(Ve){return this.instantiationMode=Ve,this}setMultipleInstances(Ve){return this.multipleInstances=Ve,this}setServiceProps(Ve){return this.serviceProps=Ve,this}setInstanceCreatedCallback(Ve){return this.onInstanceCreated=Ve,this}}const _="[DEFAULT]";class $e{constructor(Ve,je){this.name=Ve,this.container=je,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(Ve){const je=this.normalizeInstanceIdentifier(Ve);if(!this.instancesDeferred.has(je)){const Ke=new Ne.BH;if(this.instancesDeferred.set(je,Ke),this.isInitialized(je)||this.shouldAutoInitialize())try{const pn=this.getOrInitializeService({instanceIdentifier:je});pn&&Ke.resolve(pn)}catch{}}return this.instancesDeferred.get(je).promise}getImmediate(Ve){var je;const Ke=this.normalizeInstanceIdentifier(Ve?.identifier),pn=null!==(je=Ve?.optional)&&void 0!==je&&je;if(!this.isInitialized(Ke)&&!this.shouldAutoInitialize()){if(pn)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Ke})}catch(tn){if(pn)return null;throw tn}}getComponent(){return this.component}setComponent(Ve){if(Ve.name!==this.name)throw Error(`Mismatching Component ${Ve.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=Ve,this.shouldAutoInitialize()){if(function on(It){return"EAGER"===It.instantiationMode}(Ve))try{this.getOrInitializeService({instanceIdentifier:_})}catch{}for(const[je,Ke]of this.instancesDeferred.entries()){const pn=this.normalizeInstanceIdentifier(je);try{const tn=this.getOrInitializeService({instanceIdentifier:pn});Ke.resolve(tn)}catch{}}}}clearInstance(Ve=_){this.instancesDeferred.delete(Ve),this.instancesOptions.delete(Ve),this.instances.delete(Ve)}delete(){var Ve=this;return(0,d.Z)(function*(){const je=Array.from(Ve.instances.values());yield Promise.all([...je.filter(Ke=>"INTERNAL"in Ke).map(Ke=>Ke.INTERNAL.delete()),...je.filter(Ke=>"_delete"in Ke).map(Ke=>Ke._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(Ve=_){return this.instances.has(Ve)}getOptions(Ve=_){return this.instancesOptions.get(Ve)||{}}initialize(Ve={}){const{options:je={}}=Ve,Ke=this.normalizeInstanceIdentifier(Ve.instanceIdentifier);if(this.isInitialized(Ke))throw Error(`${this.name}(${Ke}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const pn=this.getOrInitializeService({instanceIdentifier:Ke,options:je});for(const[tn,bn]of this.instancesDeferred.entries())Ke===this.normalizeInstanceIdentifier(tn)&&bn.resolve(pn);return pn}onInit(Ve,je){var Ke;const pn=this.normalizeInstanceIdentifier(je),tn=null!==(Ke=this.onInitCallbacks.get(pn))&&void 0!==Ke?Ke:new Set;tn.add(Ve),this.onInitCallbacks.set(pn,tn);const bn=this.instances.get(pn);return bn&&Ve(bn,pn),()=>{tn.delete(Ve)}}invokeOnInitCallbacks(Ve,je){const Ke=this.onInitCallbacks.get(je);if(Ke)for(const pn of Ke)try{pn(Ve,je)}catch{}}getOrInitializeService({instanceIdentifier:Ve,options:je={}}){let Ke=this.instances.get(Ve);if(!Ke&&this.component&&(Ke=this.component.instanceFactory(this.container,{instanceIdentifier:(It=Ve,It===_?void 0:It),options:je}),this.instances.set(Ve,Ke),this.instancesOptions.set(Ve,je),this.invokeOnInitCallbacks(Ke,Ve),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,Ve,Ke)}catch{}var It;return Ke||null}normalizeInstanceIdentifier(Ve=_){return this.component?this.component.multipleInstances?Ve:_:Ve}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class yt{constructor(Ve){this.name=Ve,this.providers=new Map}addComponent(Ve){const je=this.getProvider(Ve.name);if(je.isComponentSet())throw new Error(`Component ${Ve.name} has already been registered with ${this.name}`);je.setComponent(Ve)}addOrOverwriteComponent(Ve){this.getProvider(Ve.name).isComponentSet()&&this.providers.delete(Ve.name),this.addComponent(Ve)}getProvider(Ve){if(this.providers.has(Ve))return this.providers.get(Ve);const je=new $e(Ve,this);return this.providers.set(Ve,je),je}getProviders(){return Array.from(this.providers.values())}}},1877:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{Am:()=>It,Ub:()=>yt,Yd:()=>on,in:()=>Ne});const d=[];var Ne=(()=>{return(Ve=Ne||(Ne={}))[Ve.DEBUG=0]="DEBUG",Ve[Ve.VERBOSE=1]="VERBOSE",Ve[Ve.INFO=2]="INFO",Ve[Ve.WARN=3]="WARN",Ve[Ve.ERROR=4]="ERROR",Ve[Ve.SILENT=5]="SILENT",Ne;var Ve})();const Me={debug:Ne.DEBUG,verbose:Ne.VERBOSE,info:Ne.INFO,warn:Ne.WARN,error:Ne.ERROR,silent:Ne.SILENT},_=Ne.INFO,$e={[Ne.DEBUG]:"log",[Ne.VERBOSE]:"log",[Ne.INFO]:"info",[Ne.WARN]:"warn",[Ne.ERROR]:"error"},ft=(Ve,je,...Ke)=>{if(je<Ve.logLevel)return;const pn=(new Date).toISOString(),tn=$e[je];if(!tn)throw new Error(`Attempted to log a message with an invalid logType (value: ${je})`);console[tn](`[${pn}]  ${Ve.name}:`,...Ke)};class on{constructor(je){this.name=je,this._logLevel=_,this._logHandler=ft,this._userLogHandler=null,d.push(this)}get logLevel(){return this._logLevel}set logLevel(je){if(!(je in Ne))throw new TypeError(`Invalid value "${je}" assigned to \`logLevel\``);this._logLevel=je}setLogLevel(je){this._logLevel="string"==typeof je?Me[je]:je}get logHandler(){return this._logHandler}set logHandler(je){if("function"!=typeof je)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=je}get userLogHandler(){return this._userLogHandler}set userLogHandler(je){this._userLogHandler=je}debug(...je){this._userLogHandler&&this._userLogHandler(this,Ne.DEBUG,...je),this._logHandler(this,Ne.DEBUG,...je)}log(...je){this._userLogHandler&&this._userLogHandler(this,Ne.VERBOSE,...je),this._logHandler(this,Ne.VERBOSE,...je)}info(...je){this._userLogHandler&&this._userLogHandler(this,Ne.INFO,...je),this._logHandler(this,Ne.INFO,...je)}warn(...je){this._userLogHandler&&this._userLogHandler(this,Ne.WARN,...je),this._logHandler(this,Ne.WARN,...je)}error(...je){this._userLogHandler&&this._userLogHandler(this,Ne.ERROR,...je),this._logHandler(this,Ne.ERROR,...je)}}function yt(Ve){d.forEach(je=>{je.setLogLevel(Ve)})}function It(Ve,je){for(const Ke of d){let pn=null;je&&je.level&&(pn=Me[je.level]),Ke.userLogHandler=null===Ve?null:(tn,bn,...Dn)=>{const vt=Dn.map(Ye=>{if(null==Ye)return null;if("string"==typeof Ye)return Ye;if("number"==typeof Ye||"boolean"==typeof Ye)return Ye.toString();if(Ye instanceof Error)return Ye.message;try{return JSON.stringify(Ye)}catch{return null}}).filter(Ye=>Ye).join(" ");bn>=(pn??tn.logLevel)&&Ve({level:Ne[bn].toLowerCase(),message:vt,args:Dn,type:tn.name})}}}},9260:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{Z:()=>d.Z});var d=Ae(3942);d.Z.registerVersion("firebase","9.19.1","app-compat")},9568:(ui,Kt,Ae)=>{"use strict";Ae.r(Kt);var d=Ae(5861),Ne=Ae(3942),Me=Ae(3432),_=Ae(2090),on=(Ae(9681),Ae(1877),Ae(4859));function yt(){return window}const It=2e3;function je(){return je=(0,d.Z)(function*($,H,Y){var se;const{BuildInfo:fe}=yt();(0,Me.ar)(H.sessionId,"AuthEvent did not contain a session ID");const Oe=yield function Ye($){return Ft.apply(this,arguments)}(H.sessionId),Be={};return(0,Me.as)()?Be.ibi=fe.packageName:(0,Me.at)()?Be.apn=fe.packageName:(0,Me.au)($,"operation-not-supported-in-this-environment"),fe.displayName&&(Be.appDisplayName=fe.displayName),Be.sessionId=Oe,(0,Me.av)($,Y,H.type,void 0,null!==(se=H.eventId)&&void 0!==se?se:void 0,Be)}),je.apply(this,arguments)}function pn(){return(pn=(0,d.Z)(function*($){const{BuildInfo:H}=yt(),Y={};(0,Me.as)()?Y.iosBundleId=H.packageName:(0,Me.at)()?Y.androidPackageName=H.packageName:(0,Me.au)($,"operation-not-supported-in-this-environment"),yield(0,Me.aw)($,Y)})).apply(this,arguments)}function Dn(){return(Dn=(0,d.Z)(function*($,H,Y){const{cordova:se}=yt();let fe=()=>{};try{yield new Promise((Oe,Be)=>{let Pe=null;function He(){var _t;Oe();const En=null===(_t=se.plugins.browsertab)||void 0===_t?void 0:_t.close;"function"==typeof En&&En(),"function"==typeof Y?.close&&Y.close()}function it(){Pe||(Pe=window.setTimeout(()=>{Be((0,Me.ay)($,"redirect-cancelled-by-user"))},It))}function jt(){"visible"===document?.visibilityState&&it()}H.addPassiveListener(He),document.addEventListener("resume",it,!1),(0,Me.at)()&&document.addEventListener("visibilitychange",jt,!1),fe=()=>{H.removePassiveListener(He),document.removeEventListener("resume",it,!1),document.removeEventListener("visibilitychange",jt,!1),Pe&&window.clearTimeout(Pe)}})}finally{fe()}})).apply(this,arguments)}function Ft(){return(Ft=(0,d.Z)(function*($){const H=function Jt($){if((0,Me.ar)(/[0-9a-zA-Z]+/.test($),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode($);const H=new ArrayBuffer($.length),Y=new Uint8Array(H);for(let se=0;se<$.length;se++)Y[se]=$.charCodeAt(se);return Y}($),Y=yield crypto.subtle.digest("SHA-256",H);return Array.from(new Uint8Array(Y)).map(fe=>fe.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}const Xt=20;class Ct extends Me.aA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(H=>{this.resolveInialized=H})}addPassiveListener(H){this.passiveListeners.add(H)}removePassiveListener(H){this.passiveListeners.delete(H)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(H){return this.resolveInialized(),this.passiveListeners.forEach(Y=>Y(H)),super.onEvent(H)}initialized(){var H=this;return(0,d.Z)(function*(){yield H.initPromise})()}}function tt($){return pt.apply(this,arguments)}function pt(){return(pt=(0,d.Z)(function*($){const H=yield an()._get(oi($));return H&&(yield an()._remove(oi($))),H})).apply(this,arguments)}function Bt(){const $=[],H="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let Y=0;Y<Xt;Y++){const se=Math.floor(Math.random()*H.length);$.push(H.charAt(se))}return $.join("")}function an(){return(0,Me.aB)(Me.b)}function oi($){return(0,Me.aC)("authEvent",$.config.apiKey,$.name)}function gt($){if(!$?.includes("?"))return{};const[H,...Y]=$.split("?");return(0,_.zd)(Y.join("?"))}const nn=class Ht{constructor(){this._redirectPersistence=Me.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Me.aD,this._overrideRedirectResult=Me.aE}_initialize(H){var Y=this;return(0,d.Z)(function*(){const se=H._key();let fe=Y.eventManagers.get(se);return fe||(fe=new Ct(H),Y.eventManagers.set(se,fe),Y.attachCallbackListeners(H,fe)),fe})()}_openPopup(H){(0,Me.au)(H,"operation-not-supported-in-this-environment")}_openRedirect(H,Y,se,fe){var Oe=this;return(0,d.Z)(function*(){!function vt($){var H,Y,se,fe,Oe,Be,Pe,He,it,jt;const _t=yt();(0,Me.az)("function"==typeof(null===(H=_t?.universalLinks)||void 0===H?void 0:H.subscribe),$,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,Me.az)(typeof(null===(Y=_t?.BuildInfo)||void 0===Y?void 0:Y.packageName)<"u",$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,Me.az)("function"==typeof(null===(Oe=null===(fe=null===(se=_t?.cordova)||void 0===se?void 0:se.plugins)||void 0===fe?void 0:fe.browsertab)||void 0===Oe?void 0:Oe.openUrl),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,Me.az)("function"==typeof(null===(He=null===(Pe=null===(Be=_t?.cordova)||void 0===Be?void 0:Be.plugins)||void 0===Pe?void 0:Pe.browsertab)||void 0===He?void 0:He.isAvailable),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,Me.az)("function"==typeof(null===(jt=null===(it=_t?.cordova)||void 0===it?void 0:it.InAppBrowser)||void 0===jt?void 0:jt.open),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(H);const Be=yield Oe._initialize(H);yield Be.initialized(),Be.resetRedirect(),(0,Me.aF)(),yield Oe._originValidation(H);const Pe=function Pt($,H,Y=null){return{type:H,eventId:Y,urlResponse:null,sessionId:Bt(),postBody:null,tenantId:$.tenantId,error:(0,Me.ay)($,"no-auth-event")}}(H,se,fe);yield function un($,H){return an()._set(oi($),H)}(H,Pe);const He=yield function Ve($,H,Y){return je.apply(this,arguments)}(H,Pe,Y),it=yield function tn($){const{cordova:H}=yt();return new Promise(Y=>{H.plugins.browsertab.isAvailable(se=>{let fe=null;se?H.plugins.browsertab.openUrl($):fe=H.InAppBrowser.open($,(0,Me.ax)()?"_blank":"_system","location=yes"),Y(fe)})})}(He);return function bn($,H,Y){return Dn.apply(this,arguments)}(H,Be,it)})()}_isIframeWebStorageSupported(H,Y){throw new Error("Method not implemented.")}_originValidation(H){const Y=H._key();return this.originValidationPromises[Y]||(this.originValidationPromises[Y]=function Ke($){return pn.apply(this,arguments)}(H)),this.originValidationPromises[Y]}attachCallbackListeners(H,Y){const{universalLinks:se,handleOpenURL:fe,BuildInfo:Oe}=yt(),Be=setTimeout((0,d.Z)(function*(){yield tt(H),Y.onEvent(en())}),500),Pe=function(){var jt=(0,d.Z)(function*(_t){clearTimeout(Be);const En=yield tt(H);let Ln=null;En&&_t?.url&&(Ln=function zt($,H){var Y,se;const fe=function mt($){const H=gt($),Y=H.link?decodeURIComponent(H.link):void 0,se=gt(Y).link,fe=H.deep_link_id?decodeURIComponent(H.deep_link_id):void 0;return gt(fe).link||fe||se||Y||$}(H);if(fe.includes("/__/auth/callback")){const Oe=gt(fe),Be=Oe.firebaseError?function On($){try{return JSON.parse($)}catch{return null}}(decodeURIComponent(Oe.firebaseError)):null,Pe=null===(se=null===(Y=Be?.code)||void 0===Y?void 0:Y.split("auth/"))||void 0===se?void 0:se[1],He=Pe?(0,Me.ay)(Pe):null;return He?{type:$.type,eventId:$.eventId,tenantId:$.tenantId,error:He,urlResponse:null,sessionId:null,postBody:null}:{type:$.type,eventId:$.eventId,tenantId:$.tenantId,sessionId:$.sessionId,urlResponse:fe,postBody:null}}return null}(En,_t.url)),Y.onEvent(Ln||en())});return function(En){return jt.apply(this,arguments)}}();typeof se<"u"&&"function"==typeof se.subscribe&&se.subscribe(null,Pe);const He=fe,it=`${Oe.packageName.toLowerCase()}://`;yt().handleOpenURL=function(){var jt=(0,d.Z)(function*(_t){if(_t.toLowerCase().startsWith(it)&&Pe({url:_t}),"function"==typeof He)try{He(_t)}catch(En){console.error(En)}});return function(_t){return jt.apply(this,arguments)}}()}};function en(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,Me.ay)("no-auth-event")}}const qn=1e3;function zn(){var $;return(null===($=self?.location)||void 0===$?void 0:$.protocol)||null}function Qi($=(0,_.z$)()){return!("file:"!==zn()&&"ionic:"!==zn()&&"capacitor:"!==zn()||!$.toLowerCase().match(/iphone|ipad|ipod|android/))}function oo(){try{const $=self.localStorage,H=Me.aK();if($)return $.setItem(H,"1"),$.removeItem(H),!function kr($=(0,_.z$)()){return function dr(){return(0,_.w1)()&&11===document?.documentMode}()||function Vn($=(0,_.z$)()){return/Edge\/\d+/.test($)}($)}()||(0,_.hl)()}catch{return Ms()&&(0,_.hl)()}return!1}function Ms(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function so(){return(function vn(){return"http:"===zn()||"https:"===zn()}()||(0,_.ru)()||Qi())&&!function Pi(){return(0,_.b$)()||(0,_.UG)()}()&&oo()&&!Ms()}function Ds(){return Qi()&&typeof document<"u"}function Ir(){return(Ir=(0,d.Z)(function*(){return!!Ds()&&new Promise($=>{const H=setTimeout(()=>{$(!1)},qn);document.addEventListener("deviceready",()=>{clearTimeout(H),$(!0)})})})).apply(this,arguments)}const In={LOCAL:"local",NONE:"none",SESSION:"session"},zo=Me.az,ls="persistence";function $r($){return cs.apply(this,arguments)}function cs(){return(cs=(0,d.Z)(function*($){yield $._initializationPromise;const H=jn(),Y=Me.aC(ls,$.config.apiKey,$.name);H&&H.setItem(Y,$._getPersistence())})).apply(this,arguments)}function jn(){var $;try{return(null===($=function jr(){return typeof window<"u"?window:null}())||void 0===$?void 0:$.sessionStorage)||null}catch{return null}}const Kn=Me.az;class Nr{constructor(){this.browserResolver=Me.aB(Me.k),this.cordovaResolver=Me.aB(nn),this.underlyingResolver=null,this._redirectPersistence=Me.a,this._completeRedirectFn=Me.aD,this._overrideRedirectResult=Me.aE}_initialize(H){var Y=this;return(0,d.Z)(function*(){return yield Y.selectUnderlyingResolver(),Y.assertedUnderlyingResolver._initialize(H)})()}_openPopup(H,Y,se,fe){var Oe=this;return(0,d.Z)(function*(){return yield Oe.selectUnderlyingResolver(),Oe.assertedUnderlyingResolver._openPopup(H,Y,se,fe)})()}_openRedirect(H,Y,se,fe){var Oe=this;return(0,d.Z)(function*(){return yield Oe.selectUnderlyingResolver(),Oe.assertedUnderlyingResolver._openRedirect(H,Y,se,fe)})()}_isIframeWebStorageSupported(H,Y){this.assertedUnderlyingResolver._isIframeWebStorageSupported(H,Y)}_originValidation(H){return this.assertedUnderlyingResolver._originValidation(H)}get _shouldInitProactively(){return Ds()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Kn(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var H=this;return(0,d.Z)(function*(){if(H.underlyingResolver)return;const Y=yield function _s(){return Ir.apply(this,arguments)}();H.underlyingResolver=Y?H.cordovaResolver:H.browserResolver})()}}function Sr($){return $.unwrap()}function Do($){return ys($)}function ys($){const{_tokenResponse:H}=$ instanceof _.ZR?$.customData:$;if(!H)return null;if(!($ instanceof _.ZR)&&"temporaryProof"in H&&"phoneNumber"in H)return Me.P.credentialFromResult($);const Y=H.providerId;if(!Y||Y===Me.p.PASSWORD)return null;let se;switch(Y){case Me.p.GOOGLE:se=Me.U;break;case Me.p.FACEBOOK:se=Me.Q;break;case Me.p.GITHUB:se=Me.V;break;case Me.p.TWITTER:se=Me.Y;break;default:const{oauthIdToken:fe,oauthAccessToken:Oe,oauthTokenSecret:Be,pendingToken:Pe,nonce:He}=H;return Oe||Be||fe||Pe?Pe?Y.startsWith("saml.")?Me.aN._create(Y,Pe):Me.K._fromParams({providerId:Y,signInMethod:Y,pendingToken:Pe,idToken:fe,accessToken:Oe}):new Me.W(Y).credential({idToken:fe,accessToken:Oe,rawNonce:He}):null}return $ instanceof _.ZR?se.credentialFromError($):se.credentialFromResult($)}function wi($,H){return H.catch(Y=>{throw Y instanceof _.ZR&&function ao($,H){var Y;const se=null===(Y=H.customData)||void 0===Y?void 0:Y._tokenResponse;if("auth/multi-factor-auth-required"===H?.code)H.resolver=new lo($,Me.ap($,H));else if(se){const fe=ys(H),Oe=H;fe&&(Oe.credential=fe,Oe.tenantId=se.tenantId||void 0,Oe.email=se.email||void 0,Oe.phoneNumber=se.phoneNumber||void 0)}}($,Y),Y}).then(Y=>{const fe=Y.user;return{operationType:Y.operationType,credential:Do(Y),additionalUserInfo:Me.an(Y),user:Hr.getOrCreate(fe)}})}function Vs($,H){return Ei.apply(this,arguments)}function Ei(){return(Ei=(0,d.Z)(function*($,H){const Y=yield H;return{verificationId:Y.verificationId,confirm:se=>wi($,Y.confirm(se))}})).apply(this,arguments)}class lo{constructor(H,Y){this.resolver=Y,this.auth=function Xr($){return $.wrapped()}(H)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(H){return wi(Sr(this.auth),this.resolver.resolveSignIn(H))}}class Hr{constructor(H){this._delegate=H,this.multiFactor=Me.aq(H)}static getOrCreate(H){return Hr.USER_MAP.has(H)||Hr.USER_MAP.set(H,new Hr(H)),Hr.USER_MAP.get(H)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(H){return this._delegate.getIdTokenResult(H)}getIdToken(H){return this._delegate.getIdToken(H)}linkAndRetrieveDataWithCredential(H){return this.linkWithCredential(H)}linkWithCredential(H){var Y=this;return(0,d.Z)(function*(){return wi(Y.auth,Me.$(Y._delegate,H))})()}linkWithPhoneNumber(H,Y){var se=this;return(0,d.Z)(function*(){return Vs(se.auth,Me.l(se._delegate,H,Y))})()}linkWithPopup(H){var Y=this;return(0,d.Z)(function*(){return wi(Y.auth,Me.d(Y._delegate,H,Nr))})()}linkWithRedirect(H){var Y=this;return(0,d.Z)(function*(){return yield $r(Me.aG(Y.auth)),Me.g(Y._delegate,H,Nr)})()}reauthenticateAndRetrieveDataWithCredential(H){return this.reauthenticateWithCredential(H)}reauthenticateWithCredential(H){var Y=this;return(0,d.Z)(function*(){return wi(Y.auth,Me.a0(Y._delegate,H))})()}reauthenticateWithPhoneNumber(H,Y){return Vs(this.auth,Me.r(this._delegate,H,Y))}reauthenticateWithPopup(H){return wi(this.auth,Me.e(this._delegate,H,Nr))}reauthenticateWithRedirect(H){var Y=this;return(0,d.Z)(function*(){return yield $r(Me.aG(Y.auth)),Me.h(Y._delegate,H,Nr)})()}sendEmailVerification(H){return Me.ad(this._delegate,H)}unlink(H){var Y=this;return(0,d.Z)(function*(){return yield Me.am(Y._delegate,H),Y})()}updateEmail(H){return Me.ai(this._delegate,H)}updatePassword(H){return Me.aj(this._delegate,H)}updatePhoneNumber(H){return Me.u(this._delegate,H)}updateProfile(H){return Me.ah(this._delegate,H)}verifyBeforeUpdateEmail(H,Y){return Me.ae(this._delegate,H,Y)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Hr.USER_MAP=new WeakMap;const cn=Me.az;let Vt=(()=>{class ${constructor(Y,se){if(this.app=Y,se.isInitialized())return this._delegate=se.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:fe}=Y.options;cn(fe,"invalid-api-key",{appName:Y.name}),cn(fe,"invalid-api-key",{appName:Y.name});const Oe=typeof window<"u"?Nr:void 0;this._delegate=se.initialize({options:{persistence:Zn(fe,Y.name),popupRedirectResolver:Oe}}),this._delegate._updateErrorMap(Me.C),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Hr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(Y){this._delegate.languageCode=Y}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(Y){this._delegate.tenantId=Y}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(Y,se){Me.H(this._delegate,Y,se)}applyActionCode(Y){return Me.a4(this._delegate,Y)}checkActionCode(Y){return Me.a5(this._delegate,Y)}confirmPasswordReset(Y,se){return Me.a3(this._delegate,Y,se)}createUserWithEmailAndPassword(Y,se){var fe=this;return(0,d.Z)(function*(){return wi(fe._delegate,Me.a7(fe._delegate,Y,se))})()}fetchProvidersForEmail(Y){return this.fetchSignInMethodsForEmail(Y)}fetchSignInMethodsForEmail(Y){return Me.ac(this._delegate,Y)}isSignInWithEmailLink(Y){return Me.aa(this._delegate,Y)}getRedirectResult(){var Y=this;return(0,d.Z)(function*(){cn(so(),Y._delegate,"operation-not-supported-in-this-environment");const se=yield Me.j(Y._delegate,Nr);return se?wi(Y._delegate,Promise.resolve(se)):{credential:null,user:null}})()}addFrameworkForLogging(Y){!function wn($,H){(0,Me.aG)($)._logFramework(H)}(this._delegate,Y)}onAuthStateChanged(Y,se,fe){const{next:Oe,error:Be,complete:Pe}=Sn(Y,se,fe);return this._delegate.onAuthStateChanged(Oe,Be,Pe)}onIdTokenChanged(Y,se,fe){const{next:Oe,error:Be,complete:Pe}=Sn(Y,se,fe);return this._delegate.onIdTokenChanged(Oe,Be,Pe)}sendSignInLinkToEmail(Y,se){return Me.a9(this._delegate,Y,se)}sendPasswordResetEmail(Y,se){return Me.a2(this._delegate,Y,se||void 0)}setPersistence(Y){var se=this;return(0,d.Z)(function*(){let fe;switch(function vo($,H){zo(Object.values(In).includes(H),$,"invalid-persistence-type"),(0,_.b$)()?zo(H!==In.SESSION,$,"unsupported-persistence-type"):(0,_.UG)()?zo(H===In.NONE,$,"unsupported-persistence-type"):Ms()?zo(H===In.NONE||H===In.LOCAL&&(0,_.hl)(),$,"unsupported-persistence-type"):zo(H===In.NONE||oo(),$,"unsupported-persistence-type")}(se._delegate,Y),Y){case In.SESSION:fe=Me.a;break;case In.LOCAL:fe=(yield Me.aB(Me.i)._isAvailable())?Me.i:Me.b;break;case In.NONE:fe=Me.M;break;default:return Me.au("argument-error",{appName:se._delegate.name})}return se._delegate.setPersistence(fe)})()}signInAndRetrieveDataWithCredential(Y){return this.signInWithCredential(Y)}signInAnonymously(){return wi(this._delegate,Me.Z(this._delegate))}signInWithCredential(Y){return wi(this._delegate,Me._(this._delegate,Y))}signInWithCustomToken(Y){return wi(this._delegate,Me.a1(this._delegate,Y))}signInWithEmailAndPassword(Y,se){return wi(this._delegate,Me.a8(this._delegate,Y,se))}signInWithEmailLink(Y,se){return wi(this._delegate,Me.ab(this._delegate,Y,se))}signInWithPhoneNumber(Y,se){return Vs(this._delegate,Me.s(this._delegate,Y,se))}signInWithPopup(Y){var se=this;return(0,d.Z)(function*(){return cn(so(),se._delegate,"operation-not-supported-in-this-environment"),wi(se._delegate,Me.c(se._delegate,Y,Nr))})()}signInWithRedirect(Y){var se=this;return(0,d.Z)(function*(){return cn(so(),se._delegate,"operation-not-supported-in-this-environment"),yield $r(se._delegate),Me.f(se._delegate,Y,Nr)})()}updateCurrentUser(Y){return this._delegate.updateCurrentUser(Y)}verifyPasswordResetCode(Y){return Me.a6(this._delegate,Y)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return $.Persistence=In,$})();function Sn($,H,Y){let se=$;"function"!=typeof $&&({next:se,error:H,complete:Y}=$);const fe=se;return{next:Be=>fe(Be&&Hr.getOrCreate(Be)),error:H,complete:Y}}function Zn($,H){const Y=function pi($,H){const Y=jn();if(!Y)return[];const se=Me.aC(ls,$,H);switch(Y.getItem(se)){case In.NONE:return[Me.M];case In.LOCAL:return[Me.i,Me.a];case In.SESSION:return[Me.a];default:return[]}}($,H);if(typeof self<"u"&&!Y.includes(Me.i)&&Y.push(Me.i),typeof window<"u")for(const se of[Me.b,Me.a])Y.includes(se)||Y.push(se);return Y.includes(Me.M)||Y.push(Me.M),Y}class ei{constructor(){this.providerId="phone",this._delegate=new Me.P(Sr(Ne.Z.auth()))}static credential(H,Y){return Me.P.credential(H,Y)}verifyPhoneNumber(H,Y){return this._delegate.verifyPhoneNumber(H,Y)}unwrap(){return this._delegate}}ei.PHONE_SIGN_IN_METHOD=Me.P.PHONE_SIGN_IN_METHOD,ei.PROVIDER_ID=Me.P.PROVIDER_ID;const ki=Me.az;class Qr{constructor(H,Y,se=Ne.Z.app()){var fe;ki(null===(fe=se.options)||void 0===fe?void 0:fe.apiKey,"invalid-api-key",{appName:se.name}),this._delegate=new Me.R(H,Y,se.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function ne($){$.INTERNAL.registerComponent(new on.wA("auth-compat",H=>{const Y=H.getProvider("app-compat").getImmediate(),se=H.getProvider("auth");return new Vt(Y,se)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Me.A.EMAIL_SIGNIN,PASSWORD_RESET:Me.A.PASSWORD_RESET,RECOVER_EMAIL:Me.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Me.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Me.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Me.A.VERIFY_EMAIL}},EmailAuthProvider:Me.N,FacebookAuthProvider:Me.Q,GithubAuthProvider:Me.V,GoogleAuthProvider:Me.U,OAuthProvider:Me.W,SAMLAuthProvider:Me.X,PhoneAuthProvider:ei,PhoneMultiFactorGenerator:Me.m,RecaptchaVerifier:Qr,TwitterAuthProvider:Me.Y,Auth:Vt,AuthCredential:Me.I,Error:_.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),$.registerVersion("@firebase/auth-compat","0.3.7")}(Ne.Z)},8766:(ui,Kt,Ae)=>{"use strict";Ae.d(Kt,{Lj:()=>Xt,X3:()=>Jt});var d=Ae(5861);const Ne=(pt,zt)=>zt.some(Bt=>pt instanceof Bt);let Me,_;const on=new WeakMap,yt=new WeakMap,It=new WeakMap,Ve=new WeakMap,je=new WeakMap;let tn={get(pt,zt,Bt){if(pt instanceof IDBTransaction){if("done"===zt)return yt.get(pt);if("objectStoreNames"===zt)return pt.objectStoreNames||It.get(pt);if("store"===zt)return Bt.objectStoreNames[1]?void 0:Bt.objectStore(Bt.objectStoreNames[0])}return Ye(pt[zt])},set:(pt,zt,Bt)=>(pt[zt]=Bt,!0),has:(pt,zt)=>pt instanceof IDBTransaction&&("done"===zt||"store"===zt)||zt in pt};function vt(pt){return"function"==typeof pt?function Dn(pt){return pt!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ft(){return _||(_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(pt)?function(...zt){return pt.apply(Ft(this),zt),Ye(on.get(this))}:function(...zt){return Ye(pt.apply(Ft(this),zt))}:function(zt,...Bt){const an=pt.call(Ft(this),zt,...Bt);return It.set(an,zt.sort?zt.sort():[zt]),Ye(an)}}(pt):(pt instanceof IDBTransaction&&function pn(pt){if(yt.has(pt))return;const zt=new Promise((Bt,an)=>{const oi=()=>{pt.removeEventListener("complete",On),pt.removeEventListener("error",mt),pt.removeEventListener("abort",mt)},On=()=>{Bt(),oi()},mt=()=>{an(pt.error||new DOMException("AbortError","AbortError")),oi()};pt.addEventListener("complete",On),pt.addEventListener("error",mt),pt.addEventListener("abort",mt)});yt.set(pt,zt)}(pt),Ne(pt,function $e(){return Me||(Me=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(pt,tn):pt)}function Ye(pt){if(pt instanceof IDBRequest)return function Ke(pt){const zt=new Promise((Bt,an)=>{const oi=()=>{pt.removeEventListener("success",On),pt.removeEventListener("error",mt)},On=()=>{Bt(Ye(pt.result)),oi()},mt=()=>{an(pt.error),oi()};pt.addEventListener("success",On),pt.addEventListener("error",mt)});return zt.then(Bt=>{Bt instanceof IDBCursor&&on.set(Bt,pt)}).catch(()=>{}),je.set(zt,pt),zt}(pt);if(Ve.has(pt))return Ve.get(pt);const zt=vt(pt);return zt!==pt&&(Ve.set(pt,zt),je.set(zt,pt)),zt}const Ft=pt=>je.get(pt);function Jt(pt,zt,{blocked:Bt,upgrade:an,blocking:oi,terminated:On}={}){const mt=indexedDB.open(pt,zt),gt=Ye(mt);return an&&mt.addEventListener("upgradeneeded",Dt=>{an(Ye(mt.result),Dt.oldVersion,Dt.newVersion,Ye(mt.transaction))}),Bt&&mt.addEventListener("blocked",()=>Bt()),gt.then(Dt=>{On&&Dt.addEventListener("close",()=>On()),oi&&Dt.addEventListener("versionchange",()=>oi())}).catch(()=>{}),gt}function Xt(pt,{blocked:zt}={}){const Bt=indexedDB.deleteDatabase(pt);return zt&&Bt.addEventListener("blocked",()=>zt()),Ye(Bt).then(()=>{})}const Ct=["get","getKey","getAll","getAllKeys","count"],Pt=["put","add","delete","clear"],un=new Map;function tt(pt,zt){if(!(pt instanceof IDBDatabase)||zt in pt||"string"!=typeof zt)return;if(un.get(zt))return un.get(zt);const Bt=zt.replace(/FromIndex$/,""),an=zt!==Bt,oi=Pt.includes(Bt);if(!(Bt in(an?IDBIndex:IDBObjectStore).prototype)||!oi&&!Ct.includes(Bt))return;const On=function(){var mt=(0,d.Z)(function*(gt,...Dt){const Ht=this.transaction(gt,oi?"readwrite":"readonly");let nn=Ht.store;return an&&(nn=nn.index(Dt.shift())),(yield Promise.all([nn[Bt](...Dt),oi&&Ht.done]))[0]});return function(Dt){return mt.apply(this,arguments)}}();return un.set(zt,On),On}!function bn(pt){tn=pt(tn)}(pt=>({...pt,get:(zt,Bt,an)=>tt(zt,Bt)||pt.get(zt,Bt,an),has:(zt,Bt)=>!!tt(zt,Bt)||pt.has(zt,Bt)}))},5861:(ui,Kt,Ae)=>{"use strict";function d(Me,_,$e,ft,on,yt,It){try{var Ve=Me[yt](It),je=Ve.value}catch(Ke){return void $e(Ke)}Ve.done?_(je):Promise.resolve(je).then(ft,on)}function Ne(Me){return function(){var _=this,$e=arguments;return new Promise(function(ft,on){var yt=Me.apply(_,$e);function It(je){d(yt,ft,on,It,Ve,"next",je)}function Ve(je){d(yt,ft,on,It,Ve,"throw",je)}It(void 0)})}}Ae.d(Kt,{Z:()=>Ne})}},ui=>{ui(ui.s=3682)}]);