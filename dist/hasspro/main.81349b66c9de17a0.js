(self.webpackChunkhasspro=self.webpackChunkhasspro||[]).push([[179],{2011:(ui,Kt,De)=>{"use strict";De.d(Kt,{Dh:()=>on,GT:()=>$e,cc:()=>pn,on:()=>It,pX:()=>_,xv:()=>yt});var u=De(4650),Ne=De(9260);ui=De.hmd(ui);const Se=["ngOnDestroy"],_=(vt,Ye,kt,Jt={})=>new Proxy(vt,{get:(Xt,xt)=>kt.runOutsideAngular(()=>{var Pt;if(vt[xt])return!(null===(Pt=Jt?.spy)||void 0===Pt)&&Pt.get&&Jt.spy.get(xt,vt[xt]),vt[xt];if(Se.indexOf(xt)>-1)return()=>{};const un=Ye.toPromise().then(nt=>{const pt=nt&&nt[xt];return"function"==typeof pt?pt.bind(nt):pt&&pt.then?pt.then(Nt=>kt.run(()=>Nt)):kt.run(()=>pt)});return new Proxy(()=>{},{get:(nt,pt)=>un[pt],apply:(nt,pt,Nt)=>un.then(zt=>{var an;const si=zt&&zt(...Nt);return!(null===(an=Jt?.spy)||void 0===an)&&an.apply&&Jt.spy.apply(xt,Nt,si),si})})})}),$e=(vt,Ye)=>{Ye.forEach(kt=>{Object.getOwnPropertyNames(kt.prototype||kt).forEach(Jt=>{Object.defineProperty(vt.prototype,Jt,Object.getOwnPropertyDescriptor(kt.prototype||kt,Jt))})})};class ft{constructor(Ye){return Ye}}const on=new u.OlP("angularfire2.app.options"),yt=new u.OlP("angularfire2.app.name");function It(vt,Ye,kt){const Xt="object"==typeof kt&&kt||{};Xt.name=Xt.name||"string"==typeof kt&&kt||"[DEFAULT]";const Pt=Ne.Z.apps.filter(un=>un&&un.name===Xt.name)[0]||Ye.runOutsideAngular(()=>Ne.Z.initializeApp(vt,Xt));try{JSON.stringify(vt)!==JSON.stringify(Pt.options)&&Ve("error",`${Pt.name} Firebase App already initialized with different options${ui.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new ft(Pt)}const Ve=(vt,...Ye)=>{(0,u.X6Q)()&&typeof console<"u"&&console[vt](...Ye)};function pn(vt,Ye,kt,Jt,Xt){const[,xt,Pt]=globalThis.\u0275AngularfireInstanceCache.find(un=>un[0]===vt)||[];if(xt)return function nn(vt,Ye){try{return vt.toString()===Ye.toString()}catch{return vt===Ye}}(Xt,Pt)||(An("error",`${Ye} was already initialized on the ${kt} Firebase App with different settings.${bn?" You may need to reload as Firebase is not HMR aware.":""}`),An("warn",{is:Xt,was:Pt})),xt;{const un=Jt();return globalThis.\u0275AngularfireInstanceCache.push([vt,un,Xt]),un}}const bn=!!ui.hot,An=(vt,...Ye)=>{(0,u.X6Q)()&&typeof console<"u"&&console[vt](...Ye)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},3432:(ui,Kt,De)=>{"use strict";De.d(Kt,{$:()=>wu,A:()=>je,C:()=>nn,H:()=>hr,I:()=>ko,K:()=>yi,M:()=>eo,N:()=>gu,P:()=>Of,Q:()=>_f,R:()=>ha,U:()=>Qm,V:()=>Dp,W:()=>vl,X:()=>Za,Y:()=>vu,Z:()=>vf,_:()=>Fc,a:()=>Il,a0:()=>io,a1:()=>Nc,a2:()=>Jm,a3:()=>oh,a4:()=>Ii,a5:()=>sh,a6:()=>ah,a7:()=>Pp,a8:()=>To,a9:()=>qt,aA:()=>at,aB:()=>an,aC:()=>ze,aD:()=>it,aE:()=>re,aF:()=>ee,aG:()=>mi,aK:()=>Sl,aN:()=>_u,aa:()=>Op,ab:()=>gd,ac:()=>Ya,ad:()=>ch,ae:()=>T_,ah:()=>kp,ai:()=>Ka,aj:()=>uh,am:()=>Xl,an:()=>wf,ap:()=>_d,aq:()=>El,ar:()=>Nt,as:()=>He,at:()=>ke,au:()=>Jt,av:()=>ma,aw:()=>Xe,ax:()=>rt,ay:()=>Xt,az:()=>nt,b:()=>Tl,c:()=>og,d:()=>v,e:()=>Hp,f:()=>de,g:()=>Me,h:()=>ue,i:()=>mh,j:()=>Ue,k:()=>sc,l:()=>ig,m:()=>qp,o:()=>Vu,p:()=>yt,r:()=>rg,s:()=>Lu,u:()=>wh,w:()=>Ef});var u=De(5861),Ne=De(2090),Se=De(9681),_=De(1877),$e=De(655),ft=De(4859);const yt={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},je={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const nn=function Ke(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},bn=function pn(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},An=new Ne.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ye=new _.Yd("@firebase/auth");function kt(j,...P){Ye.logLevel<=_.in.ERROR&&Ye.error(`Auth (${Se.SDK_VERSION}): ${j}`,...P)}function Jt(j,...P){throw un(j,...P)}function Xt(j,...P){return un(j,...P)}function xt(j,P,R){const q=Object.assign(Object.assign({},bn()),{[P]:R});return new Ne.LL("auth","Firebase",q).create(P,{appName:j.name})}function Pt(j,P,R){if(!(P instanceof R))throw R.name!==P.constructor.name&&Jt(j,"argument-error"),xt(j,"argument-error",`Type of ${P.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function un(j,...P){if("string"!=typeof j){const R=P[0],q=[...P.slice(1)];return q[0]&&(q[0].appName=j.name),j._errorFactory.create(R,...q)}return An.create(j,...P)}function nt(j,P,...R){if(!j)throw un(P,...R)}function pt(j){const P="INTERNAL ASSERTION FAILED: "+j;throw kt(P),new Error(P)}function Nt(j,P){j||pt(P)}const zt=new Map;function an(j){Nt(j instanceof Function,"Expected a class definition");let P=zt.get(j);return P?(Nt(P instanceof j,"Instance stored in cache mismatched with class"),P):(P=new j,zt.set(j,P),P)}function mt(){var j;return typeof self<"u"&&(null===(j=self.location)||void 0===j?void 0:j.href)||""}function gt(){return"http:"===Dt()||"https:"===Dt()}function Dt(){var j;return typeof self<"u"&&(null===(j=self.location)||void 0===j?void 0:j.protocol)||null}class en{constructor(P,R){this.shortDelay=P,this.longDelay=R,Nt(R>P,"Short delay should be less than long delay!"),this.isMobile=(0,Ne.uI)()||(0,Ne.b$)()}get(){return function Ht(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(gt()||(0,Ne.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function wn(j,P){Nt(j.emulator,"Emulator should always be set here");const{url:R}=j.emulator;return P?`${R}${P.startsWith("/")?P.slice(1):P}`:R}class Cn{static initialize(P,R,q){this.fetchImpl=P,R&&(this.headersImpl=R),q&&(this.responseImpl=q)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void pt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void pt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void pt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ir={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},qn=new en(3e4,6e4);function Bn(j,P){return j.tenantId&&!P.tenantId?Object.assign(Object.assign({},P),{tenantId:j.tenantId}):P}function vn(j,P,R,q){return Xi.apply(this,arguments)}function Xi(){return(Xi=(0,u.Z)(function*(j,P,R,q,ce={}){return Ai(j,ce,(0,u.Z)(function*(){let ye={},ct={};q&&("GET"===P?ct=q:ye={body:JSON.stringify(q)});const Gt=(0,Ne.xO)(Object.assign({key:j.config.apiKey},ct)).slice(1),Tn=yield j._getAdditionalHeaders();return Tn["Content-Type"]="application/json",j.languageCode&&(Tn["X-Firebase-Locale"]=j.languageCode),Cn.fetch()(lo(j,j.config.apiHost,R,Gt),Object.assign({method:P,headers:Tn,referrerPolicy:"no-referrer"},ye))}))})).apply(this,arguments)}function Ai(j,P,R){return dr.apply(this,arguments)}function dr(){return(dr=(0,u.Z)(function*(j,P,R){j._canInitEmulator=!1;const q=Object.assign(Object.assign({},ir),P);try{const ce=new Is(j),ye=yield Promise.race([R(),ce.promise]);ce.clearNetworkTimeout();const ct=yield ye.json();if("needConfirmation"in ct)throw co(j,"account-exists-with-different-credential",ct);if(ye.ok&&!("errorMessage"in ct))return ct;{const Gt=ye.ok?ct.errorMessage:ct.error.message,[Tn,ri]=Gt.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===Tn)throw co(j,"credential-already-in-use",ct);if("EMAIL_EXISTS"===Tn)throw co(j,"email-already-in-use",ct);if("USER_DISABLED"===Tn)throw co(j,"user-disabled",ct);const zi=q[Tn]||Tn.toLowerCase().replace(/[_\s]+/g,"-");if(ri)throw xt(j,zi,ri);Jt(j,zi)}}catch(ce){if(ce instanceof Ne.ZR)throw ce;Jt(j,"network-request-failed",{message:String(ce)})}})).apply(this,arguments)}function Un(j,P,R,q){return kr.apply(this,arguments)}function kr(){return(kr=(0,u.Z)(function*(j,P,R,q,ce={}){const ye=yield vn(j,P,R,q,ce);return"mfaPendingCredential"in ye&&Jt(j,"multi-factor-auth-required",{_serverResponse:ye}),ye})).apply(this,arguments)}function lo(j,P,R,q){const ce=`${P}${R}?${q}`;return j.config.emulator?wn(j.config,ce):`${j.config.apiScheme}://${ce}`}class Is{constructor(P){this.auth=P,this.timer=null,this.promise=new Promise((R,q)=>{this.timer=setTimeout(()=>q(Xt(this.auth,"network-request-failed")),qn.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function co(j,P,R){const q={appName:j.name};R.email&&(q.email=R.email),R.phoneNumber&&(q.phoneNumber=R.phoneNumber);const ce=Xt(j,P,q);return ce.customData._tokenResponse=R,ce}function gs(){return(gs=(0,u.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:delete",P)})).apply(this,arguments)}function $r(){return($r=(0,u.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:update",P)})).apply(this,arguments)}function Uo(){return(Uo=(0,u.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:lookup",P)})).apply(this,arguments)}function ss(j){if(j)try{const P=new Date(Number(j));if(!isNaN(P.getTime()))return P.toUTCString()}catch{}}function as(){return(as=(0,u.Z)(function*(j,P=!1){const R=(0,Ne.m9)(j),q=yield R.getIdToken(P),ce=jn(q);nt(ce&&ce.exp&&ce.auth_time&&ce.iat,R.auth,"internal-error");const ye="object"==typeof ce.firebase?ce.firebase:void 0,ct=ye?.sign_in_provider;return{claims:ce,token:q,authTime:ss(hi(ce.auth_time)),issuedAtTime:ss(hi(ce.iat)),expirationTime:ss(hi(ce.exp)),signInProvider:ct||null,signInSecondFactor:ye?.sign_in_second_factor||null}})).apply(this,arguments)}function hi(j){return 1e3*Number(j)}function jn(j){const[P,R,q]=j.split(".");if(void 0===P||void 0===R||void 0===q)return kt("JWT malformed, contained fewer than 3 sections"),null;try{const ce=(0,Ne.tV)(R);return ce?JSON.parse(ce):(kt("Failed to decode base64 JWT payload"),null)}catch(ce){return kt("Caught error parsing JWT payload as JSON",ce?.toString()),null}}function zr(j,P){return Mr.apply(this,arguments)}function Mr(){return(Mr=(0,u.Z)(function*(j,P,R=!1){if(R)return P;try{return yield P}catch(q){throw q instanceof Ne.ZR&&function Jr({code:j}){return"auth/user-disabled"===j||"auth/user-token-expired"===j}(q)&&j.auth.currentUser===j&&(yield j.auth.signOut()),q}})).apply(this,arguments)}class Oo{constructor(P){this.user=P,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(P){var R;if(P){const q=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),q}{this.errorBackoff=3e4;const ce=(null!==(R=this.user.stsTokenManager.expirationTime)&&void 0!==R?R:0)-Date.now()-3e5;return Math.max(0,ce)}}schedule(P=!1){var R=this;if(!this.isRunning)return;const q=this.getInterval(P);this.timerId=setTimeout((0,u.Z)(function*(){yield R.iteration()}),q)}iteration(){var P=this;return(0,u.Z)(function*(){try{yield P.user.getIdToken(!0)}catch(R){return void("auth/network-request-failed"===R?.code&&P.schedule(!0))}P.schedule()})()}}class uo{constructor(P,R){this.createdAt=P,this.lastLoginAt=R,this._initializeTime()}_initializeTime(){this.lastSignInTime=ss(this.lastLoginAt),this.creationTime=ss(this.createdAt)}_copy(P){this.createdAt=P.createdAt,this.lastLoginAt=P.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function _s(j){return wi.apply(this,arguments)}function wi(){return wi=(0,u.Z)(function*(j){var P;const R=j.auth,q=yield j.getIdToken(),ce=yield zr(j,function In(j,P){return Uo.apply(this,arguments)}(R,{idToken:q}));nt(ce?.users.length,R,"internal-error");const ye=ce.users[0];j._notifyReloadListener(ye);const ct=null!==(P=ye.providerUserInfo)&&void 0!==P&&P.length?function qr(j){return j.map(P=>{var{providerId:R}=P,q=(0,$e._T)(P,["providerId"]);return{providerId:R,uid:q.rawId||"",displayName:q.displayName||null,email:q.email||null,phoneNumber:q.phoneNumber||null,photoURL:q.photoUrl||null}})}(ye.providerUserInfo):[],Gt=function ho(j,P){return[...j.filter(q=>!P.some(ce=>ce.providerId===q.providerId)),...P]}(j.providerData,ct),zi=!!j.isAnonymous&&!(j.email&&ye.passwordHash||Gt?.length),_o={uid:ye.localId,displayName:ye.displayName||null,photoURL:ye.photoUrl||null,email:ye.email||null,emailVerified:ye.emailVerified||!1,phoneNumber:ye.phoneNumber||null,tenantId:ye.tenantId||null,providerData:Gt,metadata:new uo(ye.createdAt,ye.lastLoginAt),isAnonymous:zi};Object.assign(j,_o)}),wi.apply(this,arguments)}function Ei(){return(Ei=(0,u.Z)(function*(j){const P=(0,Ne.m9)(j);yield _s(P),yield P.auth._persistUserIfCurrent(P),P.auth._notifyListenersIfCurrent(P)})).apply(this,arguments)}function Bt(){return(Bt=(0,u.Z)(function*(j,P){const R=yield Ai(j,{},(0,u.Z)(function*(){const q=(0,Ne.xO)({grant_type:"refresh_token",refresh_token:P}).slice(1),{tokenApiHost:ce,apiKey:ye}=j.config,ct=lo(j,ce,"/v1/token",`key=${ye}`),Gt=yield j._getAdditionalHeaders();return Gt["Content-Type"]="application/x-www-form-urlencoded",Cn.fetch()(ct,{method:"POST",headers:Gt,body:q})}));return{accessToken:R.access_token,expiresIn:R.expires_in,refreshToken:R.refresh_token}})).apply(this,arguments)}class Sn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(P){nt(P.idToken,"internal-error"),nt(typeof P.idToken<"u","internal-error"),nt(typeof P.refreshToken<"u","internal-error");const R="expiresIn"in P&&typeof P.expiresIn<"u"?Number(P.expiresIn):function Xn(j){const P=jn(j);return nt(P,"internal-error"),nt(typeof P.exp<"u","internal-error"),nt(typeof P.iat<"u","internal-error"),Number(P.exp)-Number(P.iat)}(P.idToken);this.updateTokensAndExpiration(P.idToken,P.refreshToken,R)}getToken(P,R=!1){var q=this;return(0,u.Z)(function*(){return nt(!q.accessToken||q.refreshToken,P,"user-token-expired"),R||!q.accessToken||q.isExpired?q.refreshToken?(yield q.refresh(P,q.refreshToken),q.accessToken):null:q.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(P,R){var q=this;return(0,u.Z)(function*(){const{accessToken:ce,refreshToken:ye,expiresIn:ct}=yield function cn(j,P){return Bt.apply(this,arguments)}(P,R);q.updateTokensAndExpiration(ce,ye,Number(ct))})()}updateTokensAndExpiration(P,R,q){this.refreshToken=R||null,this.accessToken=P||null,this.expirationTime=Date.now()+1e3*q}static fromJSON(P,R){const{refreshToken:q,accessToken:ce,expirationTime:ye}=R,ct=new Sn;return q&&(nt("string"==typeof q,"internal-error",{appName:P}),ct.refreshToken=q),ce&&(nt("string"==typeof ce,"internal-error",{appName:P}),ct.accessToken=ce),ye&&(nt("number"==typeof ye,"internal-error",{appName:P}),ct.expirationTime=ye),ct}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(P){this.accessToken=P.accessToken,this.refreshToken=P.refreshToken,this.expirationTime=P.expirationTime}_clone(){return Object.assign(new Sn,this.toJSON())}_performRefresh(){return pt("not implemented")}}function Zn(j,P){nt("string"==typeof j||typeof j>"u","internal-error",{appName:P})}class ti{constructor(P){var{uid:R,auth:q,stsTokenManager:ce}=P,ye=(0,$e._T)(P,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Oo(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=R,this.auth=q,this.stsTokenManager=ce,this.accessToken=ce.accessToken,this.displayName=ye.displayName||null,this.email=ye.email||null,this.emailVerified=ye.emailVerified||!1,this.phoneNumber=ye.phoneNumber||null,this.photoURL=ye.photoURL||null,this.isAnonymous=ye.isAnonymous||!1,this.tenantId=ye.tenantId||null,this.providerData=ye.providerData?[...ye.providerData]:[],this.metadata=new uo(ye.createdAt||void 0,ye.lastLoginAt||void 0)}getIdToken(P){var R=this;return(0,u.Z)(function*(){const q=yield zr(R,R.stsTokenManager.getToken(R.auth,P));return nt(q,R.auth,"internal-error"),R.accessToken!==q&&(R.accessToken=q,yield R.auth._persistUserIfCurrent(R),R.auth._notifyListenersIfCurrent(R)),q})()}getIdTokenResult(P){return function Gr(j){return as.apply(this,arguments)}(this,P)}reload(){return function Bs(j){return Ei.apply(this,arguments)}(this)}_assign(P){this!==P&&(nt(this.uid===P.uid,this.auth,"internal-error"),this.displayName=P.displayName,this.photoURL=P.photoURL,this.email=P.email,this.emailVerified=P.emailVerified,this.phoneNumber=P.phoneNumber,this.isAnonymous=P.isAnonymous,this.tenantId=P.tenantId,this.providerData=P.providerData.map(R=>Object.assign({},R)),this.metadata._copy(P.metadata),this.stsTokenManager._assign(P.stsTokenManager))}_clone(P){const R=new ti(Object.assign(Object.assign({},this),{auth:P,stsTokenManager:this.stsTokenManager._clone()}));return R.metadata._copy(this.metadata),R}_onReload(P){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=P,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(P){this.reloadListener?this.reloadListener(P):this.reloadUserInfo=P}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(P,R=!1){var q=this;return(0,u.Z)(function*(){let ce=!1;P.idToken&&P.idToken!==q.stsTokenManager.accessToken&&(q.stsTokenManager.updateFromServerResponse(P),ce=!0),R&&(yield _s(q)),yield q.auth._persistUserIfCurrent(q),ce&&q.auth._notifyListenersIfCurrent(q)})()}delete(){var P=this;return(0,u.Z)(function*(){const R=yield P.getIdToken();return yield zr(P,function Ss(j,P){return gs.apply(this,arguments)}(P.auth,{idToken:R})),P.stsTokenManager.clearRefreshToken(),P.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(P=>Object.assign({},P)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(P,R){var q,ce,ye,ct,Gt,Tn,ri,zi;const _o=null!==(q=R.displayName)&&void 0!==q?q:void 0,ga=null!==(ce=R.email)&&void 0!==ce?ce:void 0,tl=null!==(ye=R.phoneNumber)&&void 0!==ye?ye:void 0,nl=null!==(ct=R.photoURL)&&void 0!==ct?ct:void 0,lc=null!==(Gt=R.tenantId)&&void 0!==Gt?Gt:void 0,Ra=null!==(Tn=R._redirectEventId)&&void 0!==Tn?Tn:void 0,Jc=null!==(ri=R.createdAt)&&void 0!==ri?ri:void 0,eu=null!==(zi=R.lastLoginAt)&&void 0!==zi?zi:void 0,{uid:cc,emailVerified:Mh,isAnonymous:Dh,providerData:Rf,stsTokenManager:Uu}=R;nt(cc&&Uu,P,"internal-error");const Yp=Sn.fromJSON(this.name,Uu);nt("string"==typeof cc,P,"internal-error"),Zn(_o,P.name),Zn(ga,P.name),nt("boolean"==typeof Mh,P,"internal-error"),nt("boolean"==typeof Dh,P,"internal-error"),Zn(tl,P.name),Zn(nl,P.name),Zn(lc,P.name),Zn(Ra,P.name),Zn(Jc,P.name),Zn(eu,P.name);const Ah=new ti({uid:cc,auth:P,email:ga,emailVerified:Mh,displayName:_o,isAnonymous:Dh,photoURL:nl,phoneNumber:tl,tenantId:lc,stsTokenManager:Yp,createdAt:Jc,lastLoginAt:eu});return Rf&&Array.isArray(Rf)&&(Ah.providerData=Rf.map(Fa=>Object.assign({},Fa))),Ra&&(Ah._redirectEventId=Ra),Ah}static _fromIdTokenResponse(P,R,q=!1){return(0,u.Z)(function*(){const ce=new Sn;ce.updateFromServerResponse(R);const ye=new ti({uid:R.localId,auth:P,stsTokenManager:ce,isAnonymous:q});return yield _s(ye),ye})()}}const eo=(()=>{class j{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,u.Z)(function*(){return!0})()}_set(R,q){var ce=this;return(0,u.Z)(function*(){ce.storage[R]=q})()}_get(R){var q=this;return(0,u.Z)(function*(){const ce=q.storage[R];return void 0===ce?null:ce})()}_remove(R){var q=this;return(0,u.Z)(function*(){delete q.storage[R]})()}_addListener(R,q){}_removeListener(R,q){}}return j.type="NONE",j})();function ze(j,P,R){return`firebase:${j}:${P}:${R}`}class ne{constructor(P,R,q){this.persistence=P,this.auth=R,this.userKey=q;const{config:ce,name:ye}=this.auth;this.fullUserKey=ze(this.userKey,ce.apiKey,ye),this.fullPersistenceKey=ze("persistence",ce.apiKey,ye),this.boundEventHandler=R._onStorageEvent.bind(R),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(P){return this.persistence._set(this.fullUserKey,P.toJSON())}getCurrentUser(){var P=this;return(0,u.Z)(function*(){const R=yield P.persistence._get(P.fullUserKey);return R?ti._fromJSON(P.auth,R):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(P){var R=this;return(0,u.Z)(function*(){if(R.persistence===P)return;const q=yield R.getCurrentUser();return yield R.removeCurrentUser(),R.persistence=P,q?R.setCurrentUser(q):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(P,R,q="authUser"){return(0,u.Z)(function*(){if(!R.length)return new ne(an(eo),P,q);const ce=(yield Promise.all(R.map(function(){var ri=(0,u.Z)(function*(zi){if(yield zi._isAvailable())return zi});return function(zi){return ri.apply(this,arguments)}}()))).filter(ri=>ri);let ye=ce[0]||an(eo);const ct=ze(q,P.config.apiKey,P.name);let Gt=null;for(const ri of R)try{const zi=yield ri._get(ct);if(zi){const _o=ti._fromJSON(P,zi);ri!==ye&&(Gt=_o),ye=ri;break}}catch{}const Tn=ce.filter(ri=>ri._shouldAllowMigration);return ye._shouldAllowMigration&&Tn.length?(ye=Tn[0],Gt&&(yield ye._set(ct,Gt.toJSON())),yield Promise.all(R.map(function(){var ri=(0,u.Z)(function*(zi){if(zi!==ye)try{yield zi._remove(ct)}catch{}});return function(zi){return ri.apply(this,arguments)}}())),new ne(ye,P,q)):new ne(ye,P,q)})()}}function $(j){const P=j.toLowerCase();if(P.includes("opera/")||P.includes("opr/")||P.includes("opios/"))return"Opera";if(pe(P))return"IEMobile";if(P.includes("msie")||P.includes("trident/"))return"IE";if(P.includes("edge/"))return"Edge";if(H(P))return"Firefox";if(P.includes("silk/"))return"Silk";if(Be(P))return"Blackberry";if(Pe(P))return"Webos";if(Y(P))return"Safari";if((P.includes("chrome/")||ae(P))&&!P.includes("edge/"))return"Chrome";if(ke(P))return"Android";{const q=j.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===q?.length)return q[1]}return"Other"}function H(j=(0,Ne.z$)()){return/firefox\//i.test(j)}function Y(j=(0,Ne.z$)()){const P=j.toLowerCase();return P.includes("safari/")&&!P.includes("chrome/")&&!P.includes("crios/")&&!P.includes("android")}function ae(j=(0,Ne.z$)()){return/crios\//i.test(j)}function pe(j=(0,Ne.z$)()){return/iemobile/i.test(j)}function ke(j=(0,Ne.z$)()){return/android/i.test(j)}function Be(j=(0,Ne.z$)()){return/blackberry/i.test(j)}function Pe(j=(0,Ne.z$)()){return/webos/i.test(j)}function He(j=(0,Ne.z$)()){return/iphone|ipad|ipod/i.test(j)||/macintosh/i.test(j)&&/mobile/i.test(j)}function rt(j=(0,Ne.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(j)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(j)}function En(j=(0,Ne.z$)()){return He(j)||ke(j)||Pe(j)||Be(j)||/windows phone/i.test(j)||pe(j)}function Ln(j,P=[]){let R;switch(j){case"Browser":R=$((0,Ne.z$)());break;case"Worker":R=`${$((0,Ne.z$)())}-${j}`;break;default:R=j}const q=P.length?P.join(","):"FirebaseCore-web";return`${R}/JsCore/${Se.SDK_VERSION}/${q}`}class ii{constructor(P){this.auth=P,this.queue=[]}pushCallback(P,R){const q=ye=>new Promise((ct,Gt)=>{try{ct(P(ye))}catch(Tn){Gt(Tn)}});q.onAbort=R,this.queue.push(q);const ce=this.queue.length-1;return()=>{this.queue[ce]=()=>Promise.resolve()}}runMiddleware(P){var R=this;return(0,u.Z)(function*(){if(R.auth.currentUser===P)return;const q=[];try{for(const ce of R.queue)yield ce(P),ce.onAbort&&q.push(ce.onAbort)}catch(ce){q.reverse();for(const ye of q)try{ye()}catch{}throw R.auth._errorFactory.create("login-blocked",{originalMessage:ce?.message})}})()}}class Ci{constructor(P,R,q){this.app=P,this.heartbeatServiceProvider=R,this.config=q,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $n(this),this.idTokenSubscription=new $n(this),this.beforeStateQueue=new ii(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=An,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=P.name,this.clientVersion=q.sdkClientVersion}_initializeWithPersistence(P,R){var q=this;return R&&(this._popupRedirectResolver=an(R)),this._initializationPromise=this.queue((0,u.Z)(function*(){var ce,ye;if(!q._deleted&&(q.persistenceManager=yield ne.create(q,P),!q._deleted)){if(null!==(ce=q._popupRedirectResolver)&&void 0!==ce&&ce._shouldInitProactively)try{yield q._popupRedirectResolver._initialize(q)}catch{}yield q.initializeCurrentUser(R),q.lastNotifiedUid=(null===(ye=q.currentUser)||void 0===ye?void 0:ye.uid)||null,!q._deleted&&(q._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var P=this;return(0,u.Z)(function*(){if(P._deleted)return;const R=yield P.assertedPersistence.getCurrentUser();if(P.currentUser||R){if(P.currentUser&&R&&P.currentUser.uid===R.uid)return P._currentUser._assign(R),void(yield P.currentUser.getIdToken());yield P._updateCurrentUser(R,!0)}})()}initializeCurrentUser(P){var R=this;return(0,u.Z)(function*(){var q;const ce=yield R.assertedPersistence.getCurrentUser();let ye=ce,ct=!1;if(P&&R.config.authDomain){yield R.getOrInitRedirectPersistenceManager();const Gt=null===(q=R.redirectUser)||void 0===q?void 0:q._redirectEventId,Tn=ye?._redirectEventId,ri=yield R.tryRedirectSignIn(P);(!Gt||Gt===Tn)&&ri?.user&&(ye=ri.user,ct=!0)}if(!ye)return R.directlySetCurrentUser(null);if(!ye._redirectEventId){if(ct)try{yield R.beforeStateQueue.runMiddleware(ye)}catch(Gt){ye=ce,R._popupRedirectResolver._overrideRedirectResult(R,()=>Promise.reject(Gt))}return ye?R.reloadAndSetCurrentUserOrClear(ye):R.directlySetCurrentUser(null)}return nt(R._popupRedirectResolver,R,"argument-error"),yield R.getOrInitRedirectPersistenceManager(),R.redirectUser&&R.redirectUser._redirectEventId===ye._redirectEventId?R.directlySetCurrentUser(ye):R.reloadAndSetCurrentUserOrClear(ye)})()}tryRedirectSignIn(P){var R=this;return(0,u.Z)(function*(){let q=null;try{q=yield R._popupRedirectResolver._completeRedirectFn(R,P,!0)}catch{yield R._setRedirectUser(null)}return q})()}reloadAndSetCurrentUserOrClear(P){var R=this;return(0,u.Z)(function*(){try{yield _s(P)}catch(q){if("auth/network-request-failed"!==q?.code)return R.directlySetCurrentUser(null)}return R.directlySetCurrentUser(P)})()}useDeviceLanguage(){this.languageCode=function rn(){if(typeof navigator>"u")return null;const j=navigator;return j.languages&&j.languages[0]||j.language||null}()}_delete(){var P=this;return(0,u.Z)(function*(){P._deleted=!0})()}updateCurrentUser(P){var R=this;return(0,u.Z)(function*(){const q=P?(0,Ne.m9)(P):null;return q&&nt(q.auth.config.apiKey===R.config.apiKey,R,"invalid-user-token"),R._updateCurrentUser(q&&q._clone(R))})()}_updateCurrentUser(P,R=!1){var q=this;return(0,u.Z)(function*(){if(!q._deleted)return P&&nt(q.tenantId===P.tenantId,q,"tenant-id-mismatch"),R||(yield q.beforeStateQueue.runMiddleware(P)),q.queue((0,u.Z)(function*(){yield q.directlySetCurrentUser(P),q.notifyAuthListeners()}))})()}signOut(){var P=this;return(0,u.Z)(function*(){return yield P.beforeStateQueue.runMiddleware(null),(P.redirectPersistenceManager||P._popupRedirectResolver)&&(yield P._setRedirectUser(null)),P._updateCurrentUser(null,!0)})()}setPersistence(P){var R=this;return this.queue((0,u.Z)(function*(){yield R.assertedPersistence.setPersistence(an(P))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(P){this._errorFactory=new Ne.LL("auth","Firebase",P())}onAuthStateChanged(P,R,q){return this.registerStateListener(this.authStateSubscription,P,R,q)}beforeAuthStateChanged(P,R){return this.beforeStateQueue.pushCallback(P,R)}onIdTokenChanged(P,R,q){return this.registerStateListener(this.idTokenSubscription,P,R,q)}toJSON(){var P;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(P=this._currentUser)||void 0===P?void 0:P.toJSON()}}_setRedirectUser(P,R){var q=this;return(0,u.Z)(function*(){const ce=yield q.getOrInitRedirectPersistenceManager(R);return null===P?ce.removeCurrentUser():ce.setCurrentUser(P)})()}getOrInitRedirectPersistenceManager(P){var R=this;return(0,u.Z)(function*(){if(!R.redirectPersistenceManager){const q=P&&an(P)||R._popupRedirectResolver;nt(q,R,"argument-error"),R.redirectPersistenceManager=yield ne.create(R,[an(q._redirectPersistence)],"redirectUser"),R.redirectUser=yield R.redirectPersistenceManager.getCurrentUser()}return R.redirectPersistenceManager})()}_redirectUserForId(P){var R=this;return(0,u.Z)(function*(){var q,ce;return R._isInitialized&&(yield R.queue((0,u.Z)(function*(){}))),(null===(q=R._currentUser)||void 0===q?void 0:q._redirectEventId)===P?R._currentUser:(null===(ce=R.redirectUser)||void 0===ce?void 0:ce._redirectEventId)===P?R.redirectUser:null})()}_persistUserIfCurrent(P){var R=this;return(0,u.Z)(function*(){if(P===R.currentUser)return R.queue((0,u.Z)(function*(){return R.directlySetCurrentUser(P)}))})()}_notifyListenersIfCurrent(P){P===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var P,R;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const q=null!==(R=null===(P=this.currentUser)||void 0===P?void 0:P.uid)&&void 0!==R?R:null;this.lastNotifiedUid!==q&&(this.lastNotifiedUid=q,this.authStateSubscription.next(this.currentUser))}registerStateListener(P,R,q,ce){if(this._deleted)return()=>{};const ye="function"==typeof R?R:R.next.bind(R),ct=this._isInitialized?Promise.resolve():this._initializationPromise;return nt(ct,this,"internal-error"),ct.then(()=>ye(this.currentUser)),"function"==typeof R?P.addObserver(R,q,ce):P.addObserver(R)}directlySetCurrentUser(P){var R=this;return(0,u.Z)(function*(){R.currentUser&&R.currentUser!==P&&R._currentUser._stopProactiveRefresh(),P&&R.isProactiveRefreshEnabled&&P._startProactiveRefresh(),R.currentUser=P,P?yield R.assertedPersistence.setCurrentUser(P):yield R.assertedPersistence.removeCurrentUser()})()}queue(P){return this.operations=this.operations.then(P,P),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(P){!P||this.frameworks.includes(P)||(this.frameworks.push(P),this.frameworks.sort(),this.clientVersion=Ln(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var P=this;return(0,u.Z)(function*(){var R;const q={"X-Client-Version":P.clientVersion};P.app.options.appId&&(q["X-Firebase-gmpid"]=P.app.options.appId);const ce=yield null===(R=P.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===R?void 0:R.getHeartbeatsHeader();return ce&&(q["X-Firebase-Client"]=ce),q})()}}function mi(j){return(0,Ne.m9)(j)}class $n{constructor(P){this.auth=P,this.observer=null,this.addObserver=(0,Ne.ne)(R=>this.observer=R)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function hr(j,P,R){const q=mi(j);nt(q._canInitEmulator,q,"emulator-config-failed"),nt(/^https?:\/\//.test(P),q,"invalid-emulator-scheme");const ce=!!R?.disableWarnings,ye=fr(P),{host:ct,port:Gt}=function Zi(j){const P=fr(j),R=/(\/\/)?([^?#/]+)/.exec(j.substr(P.length));if(!R)return{host:"",port:null};const q=R[2].split("@").pop()||"",ce=/^(\[[^\]]+\])(:|$)/.exec(q);if(ce){const ye=ce[1];return{host:ye,port:Rr(q.substr(ye.length+1))}}{const[ye,ct]=q.split(":");return{host:ye,port:Rr(ct)}}}(P);q.config.emulator={url:`${ye}//${ct}${null===Gt?"":`:${Gt}`}/`},q.settings.appVerificationDisabledForTesting=!0,q.emulatorConfig=Object.freeze({host:ct,port:Gt,protocol:ye.replace(":",""),options:Object.freeze({disableWarnings:ce})}),ce||function dt(){function j(){const P=document.createElement("p"),R=P.style;P.innerText="Running in emulator mode. Do not use with production credentials.",R.position="fixed",R.width="100%",R.backgroundColor="#ffffff",R.border=".1em solid #000000",R.color="#b50000",R.bottom="0px",R.left="0px",R.margin="0px",R.zIndex="10000",R.textAlign="center",P.classList.add("firebase-emulator-warning"),document.body.appendChild(P)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",j):j())}()}function fr(j){const P=j.indexOf(":");return P<0?"":j.substr(0,P+1)}function Rr(j){if(!j)return null;const P=Number(j);return isNaN(P)?null:P}class ko{constructor(P,R){this.providerId=P,this.signInMethod=R}toJSON(){return pt("not implemented")}_getIdTokenResponse(P){return pt("not implemented")}_linkToIdToken(P,R){return pt("not implemented")}_getReauthenticationResolver(P){return pt("not implemented")}}function ur(j,P){return qa.apply(this,arguments)}function qa(){return(qa=(0,u.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:resetPassword",Bn(j,P))})).apply(this,arguments)}function rh(j,P){return ls.apply(this,arguments)}function ls(){return(ls=(0,u.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:update",P)})).apply(this,arguments)}function Mn(){return(Mn=(0,u.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:update",Bn(j,P))})).apply(this,arguments)}function Ft(){return(Ft=(0,u.Z)(function*(j,P){return Un(j,"POST","/v1/accounts:signInWithPassword",Bn(j,P))})).apply(this,arguments)}function oi(j,P){return gi.apply(this,arguments)}function gi(){return(gi=(0,u.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:sendOobCode",Bn(j,P))})).apply(this,arguments)}function Ds(){return(Ds=(0,u.Z)(function*(j,P){return oi(j,P)})).apply(this,arguments)}function Ro(){return(Ro=(0,u.Z)(function*(j,P){return oi(j,P)})).apply(this,arguments)}function bi(){return(bi=(0,u.Z)(function*(j,P){return oi(j,P)})).apply(this,arguments)}function Ui(){return(Ui=(0,u.Z)(function*(j,P){return oi(j,P)})).apply(this,arguments)}function fo(){return(fo=(0,u.Z)(function*(j,P){return Un(j,"POST","/v1/accounts:signInWithEmailLink",Bn(j,P))})).apply(this,arguments)}function Vs(){return(Vs=(0,u.Z)(function*(j,P){return Un(j,"POST","/v1/accounts:signInWithEmailLink",Bn(j,P))})).apply(this,arguments)}class sa extends ko{constructor(P,R,q,ce=null){super("password",q),this._email=P,this._password=R,this._tenantId=ce}static _fromEmailAndPassword(P,R){return new sa(P,R,"password")}static _fromEmailAndCode(P,R,q=null){return new sa(P,R,"emailLink",q)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(P){const R="string"==typeof P?JSON.parse(P):P;if(R?.email&&R?.password){if("password"===R.signInMethod)return this._fromEmailAndPassword(R.email,R.password);if("emailLink"===R.signInMethod)return this._fromEmailAndCode(R.email,R.password,R.tenantId)}return null}_getIdTokenResponse(P){var R=this;return(0,u.Z)(function*(){switch(R.signInMethod){case"password":return function Ti(j,P){return Ft.apply(this,arguments)}(P,{returnSecureToken:!0,email:R._email,password:R._password});case"emailLink":return function cd(j,P){return fo.apply(this,arguments)}(P,{email:R._email,oobCode:R._password});default:Jt(P,"internal-error")}})()}_linkToIdToken(P,R){var q=this;return(0,u.Z)(function*(){switch(q.signInMethod){case"password":return rh(P,{idToken:R,returnSecureToken:!0,email:q._email,password:q._password});case"emailLink":return function cs(j,P){return Vs.apply(this,arguments)}(P,{idToken:R,email:q._email,oobCode:q._password});default:Jt(P,"internal-error")}})()}_getReauthenticationResolver(P){return this._getIdTokenResponse(P)}}function Co(j,P){return aa.apply(this,arguments)}function aa(){return(aa=(0,u.Z)(function*(j,P){return Un(j,"POST","/v1/accounts:signInWithIdp",Bn(j,P))})).apply(this,arguments)}class yi extends ko{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(P){const R=new yi(P.providerId,P.signInMethod);return P.idToken||P.accessToken?(P.idToken&&(R.idToken=P.idToken),P.accessToken&&(R.accessToken=P.accessToken),P.nonce&&!P.pendingToken&&(R.nonce=P.nonce),P.pendingToken&&(R.pendingToken=P.pendingToken)):P.oauthToken&&P.oauthTokenSecret?(R.accessToken=P.oauthToken,R.secret=P.oauthTokenSecret):Jt("argument-error"),R}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(P){const R="string"==typeof P?JSON.parse(P):P,{providerId:q,signInMethod:ce}=R,ye=(0,$e._T)(R,["providerId","signInMethod"]);if(!q||!ce)return null;const ct=new yi(q,ce);return ct.idToken=ye.idToken||void 0,ct.accessToken=ye.accessToken||void 0,ct.secret=ye.secret,ct.nonce=ye.nonce,ct.pendingToken=ye.pendingToken||null,ct}_getIdTokenResponse(P){return Co(P,this.buildRequest())}_linkToIdToken(P,R){const q=this.buildRequest();return q.idToken=R,Co(P,q)}_getReauthenticationResolver(P){const R=this.buildRequest();return R.autoCreate=!1,Co(P,R)}buildRequest(){const P={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)P.pendingToken=this.pendingToken;else{const R={};this.idToken&&(R.id_token=this.idToken),this.accessToken&&(R.access_token=this.accessToken),this.secret&&(R.oauth_token_secret=this.secret),R.providerId=this.providerId,this.nonce&&!this.pendingToken&&(R.nonce=this.nonce),P.postBody=(0,Ne.xO)(R)}return P}}function Ko(){return(Ko=(0,u.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:sendVerificationCode",Bn(j,P))})).apply(this,arguments)}function yl(){return(yl=(0,u.Z)(function*(j,P){return Un(j,"POST","/v1/accounts:signInWithPhoneNumber",Bn(j,P))})).apply(this,arguments)}function Eo(){return(Eo=(0,u.Z)(function*(j,P){const R=yield Un(j,"POST","/v1/accounts:signInWithPhoneNumber",Bn(j,P));if(R.temporaryProof)throw co(j,"account-exists-with-different-credential",R);return R})).apply(this,arguments)}const Er={USER_NOT_FOUND:"user-not-found"};function Xo(){return(Xo=(0,u.Z)(function*(j,P){return Un(j,"POST","/v1/accounts:signInWithPhoneNumber",Bn(j,Object.assign(Object.assign({},P),{operation:"REAUTH"})),Er)})).apply(this,arguments)}class Ji extends ko{constructor(P){super("phone","phone"),this.params=P}static _fromVerification(P,R){return new Ji({verificationId:P,verificationCode:R})}static _fromTokenResponse(P,R){return new Ji({phoneNumber:P,temporaryProof:R})}_getIdTokenResponse(P){return function to(j,P){return yl.apply(this,arguments)}(P,this._makeVerificationRequest())}_linkToIdToken(P,R){return function Kl(j,P){return Eo.apply(this,arguments)}(P,Object.assign({idToken:R},this._makeVerificationRequest()))}_getReauthenticationResolver(P){return function Xm(j,P){return Xo.apply(this,arguments)}(P,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:P,phoneNumber:R,verificationId:q,verificationCode:ce}=this.params;return P&&R?{temporaryProof:P,phoneNumber:R}:{sessionInfo:q,code:ce}}toJSON(){const P={providerId:this.providerId};return this.params.phoneNumber&&(P.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(P.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(P.verificationCode=this.params.verificationCode),this.params.verificationId&&(P.verificationId=this.params.verificationId),P}static fromJSON(P){"string"==typeof P&&(P=JSON.parse(P));const{verificationId:R,verificationCode:q,phoneNumber:ce,temporaryProof:ye}=P;return q||R||ce||ye?new Ji({verificationId:R,verificationCode:q,phoneNumber:ce,temporaryProof:ye}):null}}class Us{constructor(P){var R,q,ce,ye,ct,Gt;const Tn=(0,Ne.zd)((0,Ne.pd)(P)),ri=null!==(R=Tn.apiKey)&&void 0!==R?R:null,zi=null!==(q=Tn.oobCode)&&void 0!==q?q:null,_o=function Pc(j){switch(j){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(ce=Tn.mode)&&void 0!==ce?ce:null);nt(ri&&zi&&_o,"argument-error"),this.apiKey=ri,this.operation=_o,this.code=zi,this.continueUrl=null!==(ye=Tn.continueUrl)&&void 0!==ye?ye:null,this.languageCode=null!==(ct=Tn.languageCode)&&void 0!==ct?ct:null,this.tenantId=null!==(Gt=Tn.tenantId)&&void 0!==Gt?Gt:null}static parseLink(P){const R=function Oc(j){const P=(0,Ne.zd)((0,Ne.pd)(j)).link,R=P?(0,Ne.zd)((0,Ne.pd)(P)).deep_link_id:null,q=(0,Ne.zd)((0,Ne.pd)(j)).deep_link_id;return(q?(0,Ne.zd)((0,Ne.pd)(q)).link:null)||q||R||P||j}(P);try{return new Us(R)}catch{return null}}}let gu=(()=>{class j{constructor(){this.providerId=j.PROVIDER_ID}static credential(R,q){return sa._fromEmailAndPassword(R,q)}static credentialWithLink(R,q){const ce=Us.parseLink(q);return nt(ce,"argument-error"),sa._fromEmailAndCode(R,ce.code,ce.tenantId)}}return j.PROVIDER_ID="password",j.EMAIL_PASSWORD_SIGN_IN_METHOD="password",j.EMAIL_LINK_SIGN_IN_METHOD="emailLink",j})();class Zs{constructor(P){this.providerId=P,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(P){this.defaultLanguageCode=P}setCustomParameters(P){return this.customParameters=P,this}getCustomParameters(){return this.customParameters}}class js extends Zs{constructor(){super(...arguments),this.scopes=[]}addScope(P){return this.scopes.includes(P)||this.scopes.push(P),this}getScopes(){return[...this.scopes]}}class vl extends js{static credentialFromJSON(P){const R="string"==typeof P?JSON.parse(P):P;return nt("providerId"in R&&"signInMethod"in R,"argument-error"),yi._fromParams(R)}credential(P){return this._credential(Object.assign(Object.assign({},P),{nonce:P.rawNonce}))}_credential(P){return nt(P.idToken||P.accessToken,"argument-error"),yi._fromParams(Object.assign(Object.assign({},P),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(P){return vl.oauthCredentialFromTaggedObject(P)}static credentialFromError(P){return vl.oauthCredentialFromTaggedObject(P.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:P}){if(!P)return null;const{oauthIdToken:R,oauthAccessToken:q,oauthTokenSecret:ce,pendingToken:ye,nonce:ct,providerId:Gt}=P;if(!q&&!ce&&!R&&!ye||!Gt)return null;try{return new vl(Gt)._credential({idToken:R,accessToken:q,nonce:ct,pendingToken:ye})}catch{return null}}}let _f=(()=>{class j extends js{constructor(){super("facebook.com")}static credential(R){return yi._fromParams({providerId:j.PROVIDER_ID,signInMethod:j.FACEBOOK_SIGN_IN_METHOD,accessToken:R})}static credentialFromResult(R){return j.credentialFromTaggedObject(R)}static credentialFromError(R){return j.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R||!("oauthAccessToken"in R)||!R.oauthAccessToken)return null;try{return j.credential(R.oauthAccessToken)}catch{return null}}}return j.FACEBOOK_SIGN_IN_METHOD="facebook.com",j.PROVIDER_ID="facebook.com",j})(),Qm=(()=>{class j extends js{constructor(){super("google.com"),this.addScope("profile")}static credential(R,q){return yi._fromParams({providerId:j.PROVIDER_ID,signInMethod:j.GOOGLE_SIGN_IN_METHOD,idToken:R,accessToken:q})}static credentialFromResult(R){return j.credentialFromTaggedObject(R)}static credentialFromError(R){return j.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R)return null;const{oauthIdToken:q,oauthAccessToken:ce}=R;if(!q&&!ce)return null;try{return j.credential(q,ce)}catch{return null}}}return j.GOOGLE_SIGN_IN_METHOD="google.com",j.PROVIDER_ID="google.com",j})(),Dp=(()=>{class j extends js{constructor(){super("github.com")}static credential(R){return yi._fromParams({providerId:j.PROVIDER_ID,signInMethod:j.GITHUB_SIGN_IN_METHOD,accessToken:R})}static credentialFromResult(R){return j.credentialFromTaggedObject(R)}static credentialFromError(R){return j.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R||!("oauthAccessToken"in R)||!R.oauthAccessToken)return null;try{return j.credential(R.oauthAccessToken)}catch{return null}}}return j.GITHUB_SIGN_IN_METHOD="github.com",j.PROVIDER_ID="github.com",j})();class _u extends ko{constructor(P,R){super(P,P),this.pendingToken=R}_getIdTokenResponse(P){return Co(P,this.buildRequest())}_linkToIdToken(P,R){const q=this.buildRequest();return q.idToken=R,Co(P,q)}_getReauthenticationResolver(P){const R=this.buildRequest();return R.autoCreate=!1,Co(P,R)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(P){const R="string"==typeof P?JSON.parse(P):P,{providerId:q,signInMethod:ce,pendingToken:ye}=R;return q&&ce&&ye&&q===ce?new _u(q,ye):null}static _create(P,R){return new _u(P,R)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Za extends Zs{constructor(P){nt(P.startsWith("saml."),"argument-error"),super(P)}static credentialFromResult(P){return Za.samlCredentialFromTaggedObject(P)}static credentialFromError(P){return Za.samlCredentialFromTaggedObject(P.customData||{})}static credentialFromJSON(P){const R=_u.fromJSON(P);return nt(R,"argument-error"),R}static samlCredentialFromTaggedObject({_tokenResponse:P}){if(!P)return null;const{pendingToken:R,providerId:q}=P;if(!R||!q)return null;try{return _u._create(q,R)}catch{return null}}}let vu=(()=>{class j extends js{constructor(){super("twitter.com")}static credential(R,q){return yi._fromParams({providerId:j.PROVIDER_ID,signInMethod:j.TWITTER_SIGN_IN_METHOD,oauthToken:R,oauthTokenSecret:q})}static credentialFromResult(R){return j.credentialFromTaggedObject(R)}static credentialFromError(R){return j.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R)return null;const{oauthAccessToken:q,oauthTokenSecret:ce}=R;if(!q||!ce)return null;try{return j.credential(q,ce)}catch{return null}}}return j.TWITTER_SIGN_IN_METHOD="twitter.com",j.PROVIDER_ID="twitter.com",j})();function yf(j,P){return ys.apply(this,arguments)}function ys(){return(ys=(0,u.Z)(function*(j,P){return Un(j,"POST","/v1/accounts:signUp",Bn(j,P))})).apply(this,arguments)}class no{constructor(P){this.user=P.user,this.providerId=P.providerId,this._tokenResponse=P._tokenResponse,this.operationType=P.operationType}static _fromIdTokenResponse(P,R,q,ce=!1){return(0,u.Z)(function*(){const ye=yield ti._fromIdTokenResponse(P,q,ce),ct=dd(q);return new no({user:ye,providerId:ct,_tokenResponse:q,operationType:R})})()}static _forOperation(P,R,q){return(0,u.Z)(function*(){yield P._updateTokensIfNecessary(q,!0);const ce=dd(q);return new no({user:P,providerId:ce,_tokenResponse:q,operationType:R})})()}}function dd(j){return j.providerId?j.providerId:"phoneNumber"in j?"phone":null}function vf(j){return hd.apply(this,arguments)}function hd(){return(hd=(0,u.Z)(function*(j){var P;const R=mi(j);if(yield R._initializationPromise,null!==(P=R.currentUser)&&void 0!==P&&P.isAnonymous)return new no({user:R.currentUser,providerId:null,operationType:"signIn"});const q=yield yf(R,{returnSecureToken:!0}),ce=yield no._fromIdTokenResponse(R,"signIn",q,!0);return yield R._updateCurrentUser(ce.user),ce})).apply(this,arguments)}class bu extends Ne.ZR{constructor(P,R,q,ce){var ye;super(R.code,R.message),this.operationType=q,this.user=ce,Object.setPrototypeOf(this,bu.prototype),this.customData={appName:P.name,tenantId:null!==(ye=P.tenantId)&&void 0!==ye?ye:void 0,_serverResponse:R.customData._serverResponse,operationType:q}}static _fromErrorAndOperation(P,R,q,ce){return new bu(P,R,q,ce)}}function bf(j,P,R,q){return("reauthenticate"===P?R._getReauthenticationResolver(j):R._getIdTokenResponse(j)).catch(ye=>{throw"auth/multi-factor-auth-required"===ye.code?bu._fromErrorAndOperation(j,ye,P,q):ye})}function Ap(j){return new Set(j.map(({providerId:P})=>P).filter(P=>!!P))}function Xl(j,P){return kc.apply(this,arguments)}function kc(){return kc=(0,u.Z)(function*(j,P){const R=(0,Ne.m9)(j);yield Ql(!0,R,P);const{providerUserInfo:q}=yield function Sr(j,P){return $r.apply(this,arguments)}(R.auth,{idToken:yield R.getIdToken(),deleteProvider:[P]}),ce=Ap(q||[]);return R.providerData=R.providerData.filter(ye=>ce.has(ye.providerId)),ce.has("phone")||(R.phoneNumber=null),yield R.auth._persistUserIfCurrent(R),R}),kc.apply(this,arguments)}function xu(j,P){return Rc.apply(this,arguments)}function Rc(){return(Rc=(0,u.Z)(function*(j,P,R=!1){const q=yield zr(j,P._linkToIdToken(j.auth,yield j.getIdToken()),R);return no._forOperation(j,"link",q)})).apply(this,arguments)}function Ql(j,P,R){return fd.apply(this,arguments)}function fd(){return(fd=(0,u.Z)(function*(j,P,R){yield _s(P);const ce=!1===j?"provider-already-linked":"no-such-provider";nt(Ap(P.providerData).has(R)===j,P.auth,ce)})).apply(this,arguments)}function Jl(j,P){return Wi.apply(this,arguments)}function Wi(){return(Wi=(0,u.Z)(function*(j,P,R=!1){const{auth:q}=j,ce="reauthenticate";try{const ye=yield zr(j,bf(q,ce,P,j),R);nt(ye.idToken,q,"internal-error");const ct=jn(ye.idToken);nt(ct,q,"internal-error");const{sub:Gt}=ct;return nt(j.uid===Gt,q,"user-mismatch"),no._forOperation(j,ce,ye)}catch(ye){throw"auth/user-not-found"===ye?.code&&Jt(q,"user-mismatch"),ye}})).apply(this,arguments)}function pd(j,P){return bl.apply(this,arguments)}function bl(){return(bl=(0,u.Z)(function*(j,P,R=!1){const q="signIn",ce=yield bf(j,q,P),ye=yield no._fromIdTokenResponse(j,q,ce);return R||(yield j._updateCurrentUser(ye.user)),ye})).apply(this,arguments)}function Fc(j,P){return Qo.apply(this,arguments)}function Qo(){return(Qo=(0,u.Z)(function*(j,P){return pd(mi(j),P)})).apply(this,arguments)}function wu(j,P){return Lc.apply(this,arguments)}function Lc(){return(Lc=(0,u.Z)(function*(j,P){const R=(0,Ne.m9)(j);return yield Ql(!1,R,P.providerId),xu(R,P)})).apply(this,arguments)}function io(j,P){return Cu.apply(this,arguments)}function Cu(){return(Cu=(0,u.Z)(function*(j,P){return Jl((0,Ne.m9)(j),P)})).apply(this,arguments)}function po(){return(po=(0,u.Z)(function*(j,P){return Un(j,"POST","/v1/accounts:signInWithCustomToken",Bn(j,P))})).apply(this,arguments)}function Nc(j,P){return Eu.apply(this,arguments)}function Eu(){return Eu=(0,u.Z)(function*(j,P){const R=mi(j),q=yield function xl(j,P){return po.apply(this,arguments)}(R,{token:P,returnSecureToken:!0}),ce=yield no._fromIdTokenResponse(R,"signIn",q);return yield R._updateCurrentUser(ce.user),ce}),Eu.apply(this,arguments)}class la{constructor(P,R){this.factorId=P,this.uid=R.mfaEnrollmentId,this.enrollmentTime=new Date(R.enrolledAt).toUTCString(),this.displayName=R.displayName}static _fromServerResponse(P,R){return"phoneInfo"in R?di._fromServerResponse(P,R):"totpInfo"in R?zc._fromServerResponse(P,R):Jt(P,"internal-error")}}class di extends la{constructor(P){super("phone",P),this.phoneNumber=P.phoneInfo}static _fromServerResponse(P,R){return new di(R)}}class zc extends la{constructor(P){super("totp",P)}static _fromServerResponse(P,R){return new zc(R)}}function ec(j,P,R){var q;nt((null===(q=R.url)||void 0===q?void 0:q.length)>0,j,"invalid-continue-uri"),nt(typeof R.dynamicLinkDomain>"u"||R.dynamicLinkDomain.length>0,j,"invalid-dynamic-link-domain"),P.continueUrl=R.url,P.dynamicLinkDomain=R.dynamicLinkDomain,P.canHandleCodeInApp=R.handleCodeInApp,R.iOS&&(nt(R.iOS.bundleId.length>0,j,"missing-ios-bundle-id"),P.iOSBundleId=R.iOS.bundleId),R.android&&(nt(R.android.packageName.length>0,j,"missing-android-pkg-name"),P.androidInstallApp=R.android.installApp,P.androidMinimumVersionCode=R.android.minimumVersion,P.androidPackageName=R.android.packageName)}function Jm(j,P,R){return ca.apply(this,arguments)}function ca(){return ca=(0,u.Z)(function*(j,P,R){const q=(0,Ne.m9)(j),ce={requestType:"PASSWORD_RESET",email:P};R&&ec(q,ce,R),yield function Gn(j,P){return Ro.apply(this,arguments)}(q,ce)}),ca.apply(this,arguments)}function oh(j,P,R){return Bc.apply(this,arguments)}function Bc(){return(Bc=(0,u.Z)(function*(j,P,R){yield ur((0,Ne.m9)(j),{oobCode:P,newPassword:R})})).apply(this,arguments)}function Ii(j,P){return xf.apply(this,arguments)}function xf(){return xf=(0,u.Z)(function*(j,P){yield function Ms(j,P){return Mn.apply(this,arguments)}((0,Ne.m9)(j),{oobCode:P})}),xf.apply(this,arguments)}function sh(j,P){return md.apply(this,arguments)}function md(){return(md=(0,u.Z)(function*(j,P){const R=(0,Ne.m9)(j),q=yield ur(R,{oobCode:P}),ce=q.requestType;switch(nt(ce,R,"internal-error"),ce){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":nt(q.newEmail,R,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":nt(q.mfaInfo,R,"internal-error");default:nt(q.email,R,"internal-error")}let ye=null;return q.mfaInfo&&(ye=la._fromServerResponse(mi(R),q.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===q.requestType?q.newEmail:q.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===q.requestType?q.email:q.newEmail)||null,multiFactorInfo:ye},operation:ce}})).apply(this,arguments)}function ah(j,P){return Tu.apply(this,arguments)}function Tu(){return(Tu=(0,u.Z)(function*(j,P){const{data:R}=yield sh((0,Ne.m9)(j),P);return R.email})).apply(this,arguments)}function Pp(j,P,R){return lh.apply(this,arguments)}function lh(){return(lh=(0,u.Z)(function*(j,P,R){const q=mi(j),ce=yield yf(q,{returnSecureToken:!0,email:P,password:R}),ye=yield no._fromIdTokenResponse(q,"signIn",ce);return yield q._updateCurrentUser(ye.user),ye})).apply(this,arguments)}function To(j,P,R){return Fc((0,Ne.m9)(j),gu.credential(P,R))}function qt(j,P,R){return ji.apply(this,arguments)}function ji(){return ji=(0,u.Z)(function*(j,P,R){const q=(0,Ne.m9)(j),ce={requestType:"EMAIL_SIGNIN",email:P};nt(R.handleCodeInApp,q,"argument-error"),R&&ec(q,ce,R),yield function _l(j,P){return bi.apply(this,arguments)}(q,ce)}),ji.apply(this,arguments)}function Op(j,P){return"EMAIL_SIGNIN"===Us.parseLink(P)?.operation}function gd(j,P,R){return Fo.apply(this,arguments)}function Fo(){return(Fo=(0,u.Z)(function*(j,P,R){const q=(0,Ne.m9)(j),ce=gu.credentialWithLink(P,R||mt());return nt(ce._tenantId===(q.tenantId||null),q,"tenant-id-mismatch"),Fc(q,ce)})).apply(this,arguments)}function wl(){return(wl=(0,u.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:createAuthUri",Bn(j,P))})).apply(this,arguments)}function Ya(j,P){return Vc.apply(this,arguments)}function Vc(){return Vc=(0,u.Z)(function*(j,P){const q={identifier:P,continueUri:gt()?mt():"http://localhost"},{signinMethods:ce}=yield function Wa(j,P){return wl.apply(this,arguments)}((0,Ne.m9)(j),q);return ce||[]}),Vc.apply(this,arguments)}function ch(j,P){return Uc.apply(this,arguments)}function Uc(){return Uc=(0,u.Z)(function*(j,P){const R=(0,Ne.m9)(j),ce={requestType:"VERIFY_EMAIL",idToken:yield j.getIdToken()};P&&ec(R.auth,ce,P);const{email:ye}=yield function Qi(j,P){return Ds.apply(this,arguments)}(R.auth,ce);ye!==j.email&&(yield j.reload())}),Uc.apply(this,arguments)}function T_(j,P,R){return Iu.apply(this,arguments)}function Iu(){return Iu=(0,u.Z)(function*(j,P,R){const q=(0,Ne.m9)(j),ye={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield j.getIdToken(),newEmail:P};R&&ec(q.auth,ye,R);const{email:ct}=yield function jo(j,P){return Ui.apply(this,arguments)}(q.auth,ye);ct!==j.email&&(yield j.reload())}),Iu.apply(this,arguments)}function $o(){return($o=(0,u.Z)(function*(j,P){return vn(j,"POST","/v1/accounts:update",P)})).apply(this,arguments)}function kp(j,P){return Cl.apply(this,arguments)}function Cl(){return Cl=(0,u.Z)(function*(j,{displayName:P,photoURL:R}){if(void 0===P&&void 0===R)return;const q=(0,Ne.m9)(j),ye={idToken:yield q.getIdToken(),displayName:P,photoUrl:R,returnSecureToken:!0},ct=yield zr(q,function Jo(j,P){return $o.apply(this,arguments)}(q.auth,ye));q.displayName=ct.displayName||null,q.photoURL=ct.photoUrl||null;const Gt=q.providerData.find(({providerId:Tn})=>"password"===Tn);Gt&&(Gt.displayName=q.displayName,Gt.photoURL=q.photoURL),yield q._updateTokensIfNecessary(ct)}),Cl.apply(this,arguments)}function Ka(j,P){return Rp((0,Ne.m9)(j),P,null)}function uh(j,P){return Rp((0,Ne.m9)(j),null,P)}function Rp(j,P,R){return tc.apply(this,arguments)}function tc(){return(tc=(0,u.Z)(function*(j,P,R){const{auth:q}=j,ye={idToken:yield j.getIdToken(),returnSecureToken:!0};P&&(ye.email=P),R&&(ye.password=R);const ct=yield zr(j,rh(q,ye));yield j._updateTokensIfNecessary(ct,!0)})).apply(this,arguments)}class Ia{constructor(P,R,q={}){this.isNewUser=P,this.providerId=R,this.profile=q}}class dh extends Ia{constructor(P,R,q,ce){super(P,R,q),this.username=ce}}class Su extends Ia{constructor(P,R){super(P,"facebook.com",R)}}class Lp extends dh{constructor(P,R){super(P,"github.com",R,"string"==typeof R?.login?R?.login:null)}}class eg extends Ia{constructor(P,R){super(P,"google.com",R)}}class Np extends dh{constructor(P,R,q){super(P,"twitter.com",R,q)}}function wf(j){const{user:P,_tokenResponse:R}=j;return P.isAnonymous&&!R?{providerId:null,isNewUser:!1,profile:null}:function Fp(j){var P,R;if(!j)return null;const{providerId:q}=j,ce=j.rawUserInfo?JSON.parse(j.rawUserInfo):{},ye=j.isNewUser||"identitytoolkit#SignupNewUserResponse"===j.kind;if(!q&&j?.idToken){const ct=null===(R=null===(P=jn(j.idToken))||void 0===P?void 0:P.firebase)||void 0===R?void 0:R.sign_in_provider;if(ct)return new Ia(ye,"anonymous"!==ct&&"custom"!==ct?ct:null)}if(!q)return null;switch(q){case"facebook.com":return new Su(ye,ce);case"github.com":return new Lp(ye,ce);case"google.com":return new eg(ye,ce);case"twitter.com":return new Np(ye,ce,j.screenName||null);case"custom":case"anonymous":return new Ia(ye,null);default:return new Ia(ye,q,ce)}}(R)}function Ef(j,P,R,q){return(0,Ne.m9)(j).onAuthStateChanged(P,R,q)}class pr{constructor(P,R,q){this.type=P,this.credential=R,this.auth=q}static _fromIdtoken(P,R){return new pr("enroll",P,R)}static _fromMfaPendingCredential(P){return new pr("signin",P)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(P){var R,q;if(P?.multiFactorSession){if(null!==(R=P.multiFactorSession)&&void 0!==R&&R.pendingCredential)return pr._fromMfaPendingCredential(P.multiFactorSession.pendingCredential);if(null!==(q=P.multiFactorSession)&&void 0!==q&&q.idToken)return pr._fromIdtoken(P.multiFactorSession.idToken)}return null}}class jc{constructor(P,R,q){this.session=P,this.hints=R,this.signInResolver=q}static _fromError(P,R){const q=mi(P),ce=R.customData._serverResponse,ye=(ce.mfaInfo||[]).map(Gt=>la._fromServerResponse(q,Gt));nt(ce.mfaPendingCredential,q,"internal-error");const ct=pr._fromMfaPendingCredential(ce.mfaPendingCredential);return new jc(ct,ye,function(){var Gt=(0,u.Z)(function*(Tn){const ri=yield Tn._process(q,ct);delete ce.mfaInfo,delete ce.mfaPendingCredential;const zi=Object.assign(Object.assign({},ce),{idToken:ri.idToken,refreshToken:ri.refreshToken});switch(R.operationType){case"signIn":const _o=yield no._fromIdTokenResponse(q,R.operationType,zi);return yield q._updateCurrentUser(_o.user),_o;case"reauthenticate":return nt(R.user,q,"internal-error"),no._forOperation(R.user,R.operationType,zi);default:Jt(q,"internal-error")}});return function(Tn){return Gt.apply(this,arguments)}}())}resolveSignIn(P){var R=this;return(0,u.Z)(function*(){return R.signInResolver(P)})()}}function _d(j,P){var R;const q=(0,Ne.m9)(j),ce=P;return nt(P.customData.operationType,q,"argument-error"),nt(null===(R=ce.customData._serverResponse)||void 0===R?void 0:R.mfaPendingCredential,q,"argument-error"),jc._fromError(q,ce)}class yd{constructor(P){this.user=P,this.enrolledFactors=[],P._onReload(R=>{R.mfaInfo&&(this.enrolledFactors=R.mfaInfo.map(q=>la._fromServerResponse(P.auth,q)))})}static _fromUser(P){return new yd(P)}getSession(){var P=this;return(0,u.Z)(function*(){return pr._fromIdtoken(yield P.user.getIdToken(),P.user.auth)})()}enroll(P,R){var q=this;return(0,u.Z)(function*(){const ce=P,ye=yield q.getSession(),ct=yield zr(q.user,ce._process(q.user.auth,ye,R));return yield q.user._updateTokensIfNecessary(ct),q.user.reload()})()}unenroll(P){var R=this;return(0,u.Z)(function*(){const q="string"==typeof P?P:P.uid,ce=yield R.user.getIdToken();try{const ye=yield zr(R.user,function Du(j,P){return vn(j,"POST","/v2/accounts/mfaEnrollment:withdraw",Bn(j,P))}(R.user.auth,{idToken:ce,mfaEnrollmentId:q}));R.enrolledFactors=R.enrolledFactors.filter(({uid:ct})=>ct!==q),yield R.user._updateTokensIfNecessary(ye),yield R.user.reload()}catch(ye){throw ye}})()}}const ic=new WeakMap;function El(j){const P=(0,Ne.m9)(j);return ic.has(P)||ic.set(P,yd._fromUser(P)),ic.get(P)}const Sa="__sak";class If{constructor(P,R){this.storageRetriever=P,this.type=R}_isAvailable(){try{return this.storage?(this.storage.setItem(Sa,"1"),this.storage.removeItem(Sa),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(P,R){return this.storage.setItem(P,JSON.stringify(R)),Promise.resolve()}_get(P){const R=this.storage.getItem(P);return Promise.resolve(R?JSON.parse(R):null)}_remove(P){return this.storage.removeItem(P),Promise.resolve()}get storage(){return this.storageRetriever()}}const Tl=(()=>{class j extends If{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(R,q)=>this.onStorageEvent(R,q),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function ua(){const j=(0,Ne.z$)();return Y(j)||He(j)}()&&function Nn(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=En(),this._shouldAllowMigration=!0}forAllChangedKeys(R){for(const q of Object.keys(this.listeners)){const ce=this.storage.getItem(q),ye=this.localCache[q];ce!==ye&&R(q,ye,ce)}}onStorageEvent(R,q=!1){if(!R.key)return void this.forAllChangedKeys((Gt,Tn,ri)=>{this.notifyListeners(Gt,ri)});const ce=R.key;if(q?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const Gt=this.storage.getItem(ce);if(R.newValue!==Gt)null!==R.newValue?this.storage.setItem(ce,R.newValue):this.storage.removeItem(ce);else if(this.localCache[ce]===R.newValue&&!q)return}const ye=()=>{const Gt=this.storage.getItem(ce);!q&&this.localCache[ce]===Gt||this.notifyListeners(ce,Gt)},ct=this.storage.getItem(ce);!function _t(){return(0,Ne.w1)()&&10===document.documentMode}()||ct===R.newValue||R.newValue===R.oldValue?ye():setTimeout(ye,10)}notifyListeners(R,q){this.localCache[R]=q;const ce=this.listeners[R];if(ce)for(const ye of Array.from(ce))ye(q&&JSON.parse(q))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((R,q,ce)=>{this.onStorageEvent(new StorageEvent("storage",{key:R,oldValue:q,newValue:ce}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(R,q){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[R]||(this.listeners[R]=new Set,this.localCache[R]=this.storage.getItem(R)),this.listeners[R].add(q)}_removeListener(R,q){this.listeners[R]&&(this.listeners[R].delete(q),0===this.listeners[R].size&&delete this.listeners[R]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(R,q){var ce=()=>super._set,ye=this;return(0,u.Z)(function*(){yield ce().call(ye,R,q),ye.localCache[R]=JSON.stringify(q)})()}_get(R){var q=()=>super._get,ce=this;return(0,u.Z)(function*(){const ye=yield q().call(ce,R);return ce.localCache[R]=JSON.stringify(ye),ye})()}_remove(R){var q=()=>super._remove,ce=this;return(0,u.Z)(function*(){yield q().call(ce,R),delete ce.localCache[R]})()}}return j.type="LOCAL",j})(),Il=(()=>{class j extends If{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(R,q){}_removeListener(R,q){}}return j.type="SESSION",j})();let $c=(()=>{class j{constructor(R){this.eventTarget=R,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(R){const q=this.receivers.find(ye=>ye.isListeningto(R));if(q)return q;const ce=new j(R);return this.receivers.push(ce),ce}isListeningto(R){return this.eventTarget===R}handleEvent(R){var q=this;return(0,u.Z)(function*(){const ce=R,{eventId:ye,eventType:ct,data:Gt}=ce.data,Tn=q.handlersMap[ct];if(!Tn?.size)return;ce.ports[0].postMessage({status:"ack",eventId:ye,eventType:ct});const ri=Array.from(Tn).map(function(){var _o=(0,u.Z)(function*(ga){return ga(ce.origin,Gt)});return function(ga){return _o.apply(this,arguments)}}()),zi=yield function Xa(j){return Promise.all(j.map(function(){var P=(0,u.Z)(function*(R){try{return{fulfilled:!0,value:yield R}}catch(q){return{fulfilled:!1,reason:q}}});return function(R){return P.apply(this,arguments)}}()))}(ri);ce.ports[0].postMessage({status:"done",eventId:ye,eventType:ct,response:zi})})()}_subscribe(R,q){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[R]||(this.handlersMap[R]=new Set),this.handlersMap[R].add(q)}_unsubscribe(R,q){this.handlersMap[R]&&q&&this.handlersMap[R].delete(q),(!q||0===this.handlersMap[R].size)&&delete this.handlersMap[R],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return j.receivers=[],j})();function Sl(j="",P=10){let R="";for(let q=0;q<P;q++)R+=Math.floor(10*Math.random());return j+R}class fn{constructor(P){this.target=P,this.handlers=new Set}removeMessageHandler(P){P.messageChannel&&(P.messageChannel.port1.removeEventListener("message",P.onMessage),P.messageChannel.port1.close()),this.handlers.delete(P)}_send(P,R,q=50){var ce=this;return(0,u.Z)(function*(){const ye=typeof MessageChannel<"u"?new MessageChannel:null;if(!ye)throw new Error("connection_unavailable");let ct,Gt;return new Promise((Tn,ri)=>{const zi=Sl("",20);ye.port1.start();const _o=setTimeout(()=>{ri(new Error("unsupported_event"))},q);Gt={messageChannel:ye,onMessage(ga){const tl=ga;if(tl.data.eventId===zi)switch(tl.data.status){case"ack":clearTimeout(_o),ct=setTimeout(()=>{ri(new Error("timeout"))},3e3);break;case"done":clearTimeout(ct),Tn(tl.data.response);break;default:clearTimeout(_o),clearTimeout(ct),ri(new Error("invalid_response"))}}},ce.handlers.add(Gt),ye.port1.addEventListener("message",Gt.onMessage),ce.target.postMessage({eventType:P,eventId:zi,data:R},[ye.port2])}).finally(()=>{Gt&&ce.removeMessageHandler(Gt)})})()}}function rr(){return window}function Ma(){return typeof rr().WorkerGlobalScope<"u"&&"function"==typeof rr().importScripts}function Qa(){return(Qa=(0,u.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Hc="firebaseLocalStorageDb",qc=1,Da="firebaseLocalStorage",wd="fbase_key";class Zr{constructor(P){this.request=P}toPromise(){return new Promise((P,R)=>{this.request.addEventListener("success",()=>{P(this.request.result)}),this.request.addEventListener("error",()=>{R(this.request.error)})})}}function Ml(j,P){return j.transaction([Da],P?"readwrite":"readonly").objectStore(Da)}function Ps(){const j=indexedDB.open(Hc,qc);return new Promise((P,R)=>{j.addEventListener("error",()=>{R(j.error)}),j.addEventListener("upgradeneeded",()=>{const q=j.result;try{q.createObjectStore(Da,{keyPath:wd})}catch(ce){R(ce)}}),j.addEventListener("success",(0,u.Z)(function*(){const q=j.result;q.objectStoreNames.contains(Da)?P(q):(q.close(),yield function ph(){const j=indexedDB.deleteDatabase(Hc);return new Zr(j).toPromise()}(),P(yield Ps()))}))})}function Cd(j,P,R){return Dl.apply(this,arguments)}function Dl(){return(Dl=(0,u.Z)(function*(j,P,R){const q=Ml(j,!0).put({[wd]:P,value:R});return new Zr(q).toPromise()})).apply(this,arguments)}function Ed(){return(Ed=(0,u.Z)(function*(j,P){const R=Ml(j,!1).get(P),q=yield new Zr(R).toPromise();return void 0===q?null:q.value})).apply(this,arguments)}function Aa(j,P){const R=Ml(j,!0).delete(P);return new Zr(R).toPromise()}const mh=(()=>{class j{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var R=this;return(0,u.Z)(function*(){return R.db||(R.db=yield Ps()),R.db})()}_withRetries(R){var q=this;return(0,u.Z)(function*(){let ce=0;for(;;)try{const ye=yield q._openDb();return yield R(ye)}catch(ye){if(ce++>3)throw ye;q.db&&(q.db.close(),q.db=void 0)}})()}initializeServiceWorkerMessaging(){var R=this;return(0,u.Z)(function*(){return Ma()?R.initializeReceiver():R.initializeSender()})()}initializeReceiver(){var R=this;return(0,u.Z)(function*(){R.receiver=$c._getInstance(function fh(){return Ma()?self:null}()),R.receiver._subscribe("keyChanged",function(){var q=(0,u.Z)(function*(ce,ye){return{keyProcessed:(yield R._poll()).includes(ye.key)}});return function(ce,ye){return q.apply(this,arguments)}}()),R.receiver._subscribe("ping",function(){var q=(0,u.Z)(function*(ce,ye){return["keyChanged"]});return function(ce,ye){return q.apply(this,arguments)}}())})()}initializeSender(){var R=this;return(0,u.Z)(function*(){var q,ce;if(R.activeServiceWorker=yield function Gc(){return Qa.apply(this,arguments)}(),!R.activeServiceWorker)return;R.sender=new fn(R.activeServiceWorker);const ye=yield R.sender._send("ping",{},800);ye&&null!==(q=ye[0])&&void 0!==q&&q.fulfilled&&null!==(ce=ye[0])&&void 0!==ce&&ce.value.includes("keyChanged")&&(R.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(R){var q=this;return(0,u.Z)(function*(){if(q.sender&&q.activeServiceWorker&&function xd(){var j;return(null===(j=navigator?.serviceWorker)||void 0===j?void 0:j.controller)||null}()===q.activeServiceWorker)try{yield q.sender._send("keyChanged",{key:R},q.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,u.Z)(function*(){try{if(!indexedDB)return!1;const R=yield Ps();return yield Cd(R,Sa,"1"),yield Aa(R,Sa),!0}catch{}return!1})()}_withPendingWrite(R){var q=this;return(0,u.Z)(function*(){q.pendingWrites++;try{yield R()}finally{q.pendingWrites--}})()}_set(R,q){var ce=this;return(0,u.Z)(function*(){return ce._withPendingWrite((0,u.Z)(function*(){return yield ce._withRetries(ye=>Cd(ye,R,q)),ce.localCache[R]=q,ce.notifyServiceWorker(R)}))})()}_get(R){var q=this;return(0,u.Z)(function*(){const ce=yield q._withRetries(ye=>function Zc(j,P){return Ed.apply(this,arguments)}(ye,R));return q.localCache[R]=ce,ce})()}_remove(R){var q=this;return(0,u.Z)(function*(){return q._withPendingWrite((0,u.Z)(function*(){return yield q._withRetries(ce=>Aa(ce,R)),delete q.localCache[R],q.notifyServiceWorker(R)}))})()}_poll(){var R=this;return(0,u.Z)(function*(){const q=yield R._withRetries(ct=>{const Gt=Ml(ct,!1).getAll();return new Zr(Gt).toPromise()});if(!q)return[];if(0!==R.pendingWrites)return[];const ce=[],ye=new Set;for(const{fbase_key:ct,value:Gt}of q)ye.add(ct),JSON.stringify(R.localCache[ct])!==JSON.stringify(Gt)&&(R.notifyListeners(ct,Gt),ce.push(ct));for(const ct of Object.keys(R.localCache))R.localCache[ct]&&!ye.has(ct)&&(R.notifyListeners(ct,null),ce.push(ct));return ce})()}notifyListeners(R,q){this.localCache[R]=q;const ce=this.listeners[R];if(ce)for(const ye of Array.from(ce))ye(q)}startPolling(){var R=this;this.stopPolling(),this.pollTimer=setInterval((0,u.Z)(function*(){return R._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(R,q){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[R]||(this.listeners[R]=new Set,this._get(R)),this.listeners[R].add(q)}_removeListener(R,q){this.listeners[R]&&(this.listeners[R].delete(q),0===this.listeners[R].size&&delete this.listeners[R]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return j.type="LOCAL",j})();function da(){return(da=(0,u.Z)(function*(j){return(yield vn(j,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Mf(j){return new Promise((P,R)=>{const q=document.createElement("script");q.setAttribute("src",j),q.onload=P,q.onerror=ce=>{const ye=Xt("internal-error");ye.customData=ce,R(ye)},q.type="text/javascript",q.charset="UTF-8",function Sf(){var j,P;return null!==(P=null===(j=document.getElementsByTagName("head"))||void 0===j?void 0:j[0])&&void 0!==P?P:document}().appendChild(q)})}function Id(j){return`__${j}${Math.floor(1e6*Math.random())}`}const Io=1e12;class Df{constructor(P){this.auth=P,this.counter=Io,this._widgets=new Map}render(P,R){const q=this.counter;return this._widgets.set(q,new Af(P,this.auth.name,R||{})),this.counter++,q}reset(P){var R;const q=P||Io;null===(R=this._widgets.get(q))||void 0===R||R.delete(),this._widgets.delete(q)}getResponse(P){var R;return(null===(R=this._widgets.get(P||Io))||void 0===R?void 0:R.getResponse())||""}execute(P){var R=this;return(0,u.Z)(function*(){var q;return null===(q=R._widgets.get(P||Io))||void 0===q||q.execute(),""})()}}class Af{constructor(P,R,q){this.params=q,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const ce="string"==typeof P?document.getElementById(P):P;nt(ce,"argument-error",{appName:R}),this.container=ce,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Pf(j){const P=[],R="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let q=0;q<j;q++)P.push(R.charAt(Math.floor(Math.random()*R.length)));return P.join("")}(50);const{callback:P,"expired-callback":R}=this.params;if(P)try{P(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,R)try{R()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Yc=Id("rcb"),Os=new en(3e4,6e4);class Pa{constructor(){var P;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(P=rr().grecaptcha)||void 0===P||!P.render)}load(P,R=""){return nt(function Ja(j){return j.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(j)}(R),P,"argument-error"),this.shouldResolveImmediately(R)?Promise.resolve(rr().grecaptcha):new Promise((q,ce)=>{const ye=rr().setTimeout(()=>{ce(Xt(P,"network-request-failed"))},Os.get());rr()[Yc]=()=>{rr().clearTimeout(ye),delete rr()[Yc];const Gt=rr().grecaptcha;if(!Gt)return void ce(Xt(P,"internal-error"));const Tn=Gt.render;Gt.render=(ri,zi)=>{const _o=Tn(ri,zi);return this.counter++,_o},this.hostLanguage=R,q(Gt)},Mf(`https://www.google.com/recaptcha/api.js??${(0,Ne.xO)({onload:Yc,render:"explicit",hl:R})}`).catch(()=>{clearTimeout(ye),ce(Xt(P,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(P){var R;return!(null===(R=rr().grecaptcha)||void 0===R||!R.render)&&(P===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Ru{load(P){return(0,u.Z)(function*(){return new Df(P)})()}clearedOneInstance(){}}const gn="recaptcha",jp={theme:"light",type:"image"};class ha{constructor(P,R=Object.assign({},jp),q){this.parameters=R,this.type=gn,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=mi(q),this.isInvisible="invisible"===this.parameters.size,nt(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const ce="string"==typeof P?document.getElementById(P):P;nt(ce,this.auth,"argument-error"),this.container=ce,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Ru:new Pa,this.validateStartingState()}verify(){var P=this;return(0,u.Z)(function*(){P.assertNotDestroyed();const R=yield P.render(),q=P.getAssertedRecaptcha();return q.getResponse(R)||new Promise(ye=>{const ct=Gt=>{Gt&&(P.tokenChangeListeners.delete(ct),ye(Gt))};P.tokenChangeListeners.add(ct),P.isInvisible&&q.execute(R)})})()}render(){try{this.assertNotDestroyed()}catch(P){return Promise.reject(P)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(P=>{throw this.renderPromise=null,P})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(P=>{this.container.removeChild(P)})}validateStartingState(){nt(!this.parameters.sitekey,this.auth,"argument-error"),nt(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),nt(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(P){return R=>{if(this.tokenChangeListeners.forEach(q=>q(R)),"function"==typeof P)P(R);else if("string"==typeof P){const q=rr()[P];"function"==typeof q&&q(R)}}}assertNotDestroyed(){nt(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var P=this;return(0,u.Z)(function*(){if(yield P.init(),!P.widgetId){let R=P.container;if(!P.isInvisible){const q=document.createElement("div");R.appendChild(q),R=q}P.widgetId=P.getAssertedRecaptcha().render(R,P.parameters)}return P.widgetId})()}init(){var P=this;return(0,u.Z)(function*(){nt(gt()&&!Ma(),P.auth,"internal-error"),yield function xr(){let j=null;return new Promise(P=>{"complete"!==document.readyState?(j=()=>P(),window.addEventListener("load",j)):P()}).catch(P=>{throw j&&window.removeEventListener("load",j),P})}(),P.recaptcha=yield P._recaptchaLoader.load(P.auth,P.auth.languageCode||void 0);const R=yield function Ou(j){return da.apply(this,arguments)}(P.auth);nt(R,P.auth,"internal-error"),P.parameters.sitekey=R})()}getAssertedRecaptcha(){return nt(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Fu{constructor(P,R){this.verificationId=P,this.onConfirmation=R}confirm(P){const R=Ji._fromVerification(this.verificationId,P);return this.onConfirmation(R)}}function Lu(j,P,R){return vh.apply(this,arguments)}function vh(){return(vh=(0,u.Z)(function*(j,P,R){const q=mi(j),ce=yield Oa(q,P,(0,Ne.m9)(R));return new Fu(ce,ye=>Fc(q,ye))})).apply(this,arguments)}function ig(j,P,R){return $p.apply(this,arguments)}function $p(){return($p=(0,u.Z)(function*(j,P,R){const q=(0,Ne.m9)(j);yield Ql(!1,q,"phone");const ce=yield Oa(q.auth,P,(0,Ne.m9)(R));return new Fu(ce,ye=>wu(q,ye))})).apply(this,arguments)}function rg(j,P,R){return bh.apply(this,arguments)}function bh(){return(bh=(0,u.Z)(function*(j,P,R){const q=(0,Ne.m9)(j),ce=yield Oa(q.auth,P,(0,Ne.m9)(R));return new Fu(ce,ye=>io(q,ye))})).apply(this,arguments)}function Oa(j,P,R){return xh.apply(this,arguments)}function xh(){return xh=(0,u.Z)(function*(j,P,R){var q;const ce=yield R.verify();try{let ye;if(nt("string"==typeof ce,j,"argument-error"),nt(R.type===gn,j,"argument-error"),ye="string"==typeof P?{phoneNumber:P}:P,"session"in ye){const ct=ye.session;if("phoneNumber"in ye)return nt("enroll"===ct.type,j,"internal-error"),(yield function Mu(j,P){return vn(j,"POST","/v2/accounts/mfaEnrollment:start",Bn(j,P))}(j,{idToken:ct.credential,phoneEnrollmentInfo:{phoneNumber:ye.phoneNumber,recaptchaToken:ce}})).phoneSessionInfo.sessionInfo;{nt("signin"===ct.type,j,"internal-error");const Gt=(null===(q=ye.multiFactorHint)||void 0===q?void 0:q.uid)||ye.multiFactorUid;return nt(Gt,j,"missing-multi-factor-info"),(yield function gh(j,P){return vn(j,"POST","/v2/accounts/mfaSignIn:start",Bn(j,P))}(j,{mfaPendingCredential:ct.credential,mfaEnrollmentId:Gt,phoneSignInInfo:{recaptchaToken:ce}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:ct}=yield function Mp(j,P){return Ko.apply(this,arguments)}(j,{phoneNumber:ye.phoneNumber,recaptchaToken:ce});return ct}}finally{R._reset()}}),xh.apply(this,arguments)}function wh(j,P){return ro.apply(this,arguments)}function ro(){return(ro=(0,u.Z)(function*(j,P){yield xu((0,Ne.m9)(j),P)})).apply(this,arguments)}let Of=(()=>{class j{constructor(R){this.providerId=j.PROVIDER_ID,this.auth=mi(R)}verifyPhoneNumber(R,q){return Oa(this.auth,R,(0,Ne.m9)(q))}static credential(R,q){return Ji._fromVerification(R,q)}static credentialFromResult(R){return j.credentialFromTaggedObject(R)}static credentialFromError(R){return j.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R)return null;const{phoneNumber:q,temporaryProof:ce}=R;return q&&ce?Ji._fromTokenResponse(q,ce):null}}return j.PROVIDER_ID="phone",j.PHONE_SIGN_IN_METHOD="phone",j})();function fa(j,P){return P?an(P):(nt(j._popupRedirectResolver,j,"argument-error"),j._popupRedirectResolver)}class Ch extends ko{constructor(P){super("custom","custom"),this.params=P}_getIdTokenResponse(P){return Co(P,this._buildIdpRequest())}_linkToIdToken(P,R){return Co(P,this._buildIdpRequest(R))}_getReauthenticationResolver(P){return Co(P,this._buildIdpRequest())}_buildIdpRequest(P){const R={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return P&&(R.idToken=P),R}}function pa(j){return pd(j.auth,new Ch(j),j.bypassAuthState)}function Kc(j){const{auth:P,user:R}=j;return nt(R,P,"internal-error"),Jl(R,new Ch(j),j.bypassAuthState)}function Gp(j){return Xc.apply(this,arguments)}function Xc(){return(Xc=(0,u.Z)(function*(j){const{auth:P,user:R}=j;return nt(R,P,"internal-error"),xu(R,new Ch(j),j.bypassAuthState)})).apply(this,arguments)}class Nu{constructor(P,R,q,ce,ye=!1){this.auth=P,this.resolver=q,this.user=ce,this.bypassAuthState=ye,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(R)?R:[R]}execute(){var P=this;return new Promise(function(){var R=(0,u.Z)(function*(q,ce){P.pendingPromise={resolve:q,reject:ce};try{P.eventManager=yield P.resolver._initialize(P.auth),yield P.onExecution(),P.eventManager.registerConsumer(P)}catch(ye){P.reject(ye)}});return function(q,ce){return R.apply(this,arguments)}}())}onAuthEvent(P){var R=this;return(0,u.Z)(function*(){const{urlResponse:q,sessionId:ce,postBody:ye,tenantId:ct,error:Gt,type:Tn}=P;if(Gt)return void R.reject(Gt);const ri={auth:R.auth,requestUri:q,sessionId:ce,tenantId:ct||void 0,postBody:ye||void 0,user:R.user,bypassAuthState:R.bypassAuthState};try{R.resolve(yield R.getIdpTask(Tn)(ri))}catch(zi){R.reject(zi)}})()}onError(P){this.reject(P)}getIdpTask(P){switch(P){case"signInViaPopup":case"signInViaRedirect":return pa;case"linkViaPopup":case"linkViaRedirect":return Gp;case"reauthViaPopup":case"reauthViaRedirect":return Kc;default:Jt(this.auth,"internal-error")}}resolve(P){Nt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(P),this.unregisterAndCleanUp()}reject(P){Nt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(P),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Eh=new en(2e3,1e4);function og(j,P,R){return Sd.apply(this,arguments)}function Sd(){return(Sd=(0,u.Z)(function*(j,P,R){const q=mi(j);Pt(j,P,Zs);const ce=fa(q,R);return new g(q,"signInViaPopup",P,ce).executeNotNull()})).apply(this,arguments)}function Hp(j,P,R){return Mi.apply(this,arguments)}function Mi(){return(Mi=(0,u.Z)(function*(j,P,R){const q=(0,Ne.m9)(j);Pt(q.auth,P,Zs);const ce=fa(q.auth,R);return new g(q.auth,"reauthViaPopup",P,ce,q).executeNotNull()})).apply(this,arguments)}function v(j,P,R){return c.apply(this,arguments)}function c(){return(c=(0,u.Z)(function*(j,P,R){const q=(0,Ne.m9)(j);Pt(q.auth,P,Zs);const ce=fa(q.auth,R);return new g(q.auth,"linkViaPopup",P,ce,q).executeNotNull()})).apply(this,arguments)}let g=(()=>{class j extends Nu{constructor(R,q,ce,ye,ct){super(R,q,ye,ct),this.provider=ce,this.authWindow=null,this.pollId=null,j.currentPopupAction&&j.currentPopupAction.cancel(),j.currentPopupAction=this}executeNotNull(){var R=this;return(0,u.Z)(function*(){const q=yield R.execute();return nt(q,R.auth,"internal-error"),q})()}onExecution(){var R=this;return(0,u.Z)(function*(){Nt(1===R.filter.length,"Popup operations only handle one event");const q=Sl();R.authWindow=yield R.resolver._openPopup(R.auth,R.provider,R.filter[0],q),R.authWindow.associatedEvent=q,R.resolver._originValidation(R.auth).catch(ce=>{R.reject(ce)}),R.resolver._isIframeWebStorageSupported(R.auth,ce=>{ce||R.reject(Xt(R.auth,"web-storage-unsupported"))}),R.pollUserCancellation()})()}get eventId(){var R;return(null===(R=this.authWindow)||void 0===R?void 0:R.associatedEvent)||null}cancel(){this.reject(Xt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,j.currentPopupAction=null}pollUserCancellation(){const R=()=>{var q,ce;this.pollId=null!==(ce=null===(q=this.authWindow)||void 0===q?void 0:q.window)&&void 0!==ce&&ce.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Xt(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(R,Eh.get())};R()}}return j.currentPopupAction=null,j})();const C="pendingRedirect",S=new Map;class D extends Nu{constructor(P,R,q=!1){super(P,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],R,void 0,q),this.eventId=null}execute(){var P=()=>super.execute,R=this;return(0,u.Z)(function*(){let q=S.get(R.auth._key());if(!q){try{const ye=(yield function L(j,P){return z.apply(this,arguments)}(R.resolver,R.auth))?yield P().call(R):null;q=()=>Promise.resolve(ye)}catch(ce){q=()=>Promise.reject(ce)}S.set(R.auth._key(),q)}return R.bypassAuthState||S.set(R.auth._key(),()=>Promise.resolve(null)),q()})()}onAuthEvent(P){var R=()=>super.onAuthEvent,q=this;return(0,u.Z)(function*(){if("signInViaRedirect"===P.type)return R().call(q,P);if("unknown"!==P.type){if(P.eventId){const ce=yield q.auth._redirectUserForId(P.eventId);if(ce)return q.user=ce,R().call(q,P);q.resolve(null)}}else q.resolve(null)})()}onExecution(){return(0,u.Z)(function*(){})()}cleanUp(){}}function z(){return(z=(0,u.Z)(function*(j,P){const R=_e(P),q=fe(j);if(!(yield q._isAvailable()))return!1;const ce="true"===(yield q._get(R));return yield q._remove(R),ce})).apply(this,arguments)}function G(j,P){return J.apply(this,arguments)}function J(){return(J=(0,u.Z)(function*(j,P){return fe(j)._set(_e(P),"true")})).apply(this,arguments)}function ee(){S.clear()}function re(j,P){S.set(j._key(),P)}function fe(j){return an(j._redirectPersistence)}function _e(j){return ze(C,j.config.apiKey,j.name)}function de(j,P,R){return function ve(j,P,R){return xe.apply(this,arguments)}(j,P,R)}function xe(){return(xe=(0,u.Z)(function*(j,P,R){const q=mi(j);Pt(j,P,Zs),yield q._initializationPromise;const ce=fa(q,R);return yield G(ce,q),ce._openRedirect(q,P,"signInViaRedirect")})).apply(this,arguments)}function ue(j,P,R){return function Ce(j,P,R){return be.apply(this,arguments)}(j,P,R)}function be(){return(be=(0,u.Z)(function*(j,P,R){const q=(0,Ne.m9)(j);Pt(q.auth,P,Zs),yield q.auth._initializationPromise;const ce=fa(q.auth,R);yield G(ce,q.auth);const ye=yield Ut(q);return ce._openRedirect(q.auth,P,"reauthViaRedirect",ye)})).apply(this,arguments)}function Me(j,P,R){return function Le(j,P,R){return Fe.apply(this,arguments)}(j,P,R)}function Fe(){return(Fe=(0,u.Z)(function*(j,P,R){const q=(0,Ne.m9)(j);Pt(q.auth,P,Zs),yield q.auth._initializationPromise;const ce=fa(q.auth,R);yield Ql(!1,q,P.providerId),yield G(ce,q.auth);const ye=yield Ut(q);return ce._openRedirect(q.auth,P,"linkViaRedirect",ye)})).apply(this,arguments)}function Ue(j,P){return We.apply(this,arguments)}function We(){return(We=(0,u.Z)(function*(j,P){return yield mi(j)._initializationPromise,it(j,P,!1)})).apply(this,arguments)}function it(j,P){return st.apply(this,arguments)}function st(){return(st=(0,u.Z)(function*(j,P,R=!1){const q=mi(j),ce=fa(q,P),ct=yield new D(q,ce,R).execute();return ct&&!R&&(delete ct.user._redirectEventId,yield q._persistUserIfCurrent(ct.user),yield q._setRedirectUser(null,P)),ct})).apply(this,arguments)}function Ut(j){return Qe.apply(this,arguments)}function Qe(){return(Qe=(0,u.Z)(function*(j){const P=Sl(`${j.uid}:::`);return j._redirectEventId=P,yield j.auth._setRedirectUser(j),yield j.auth._persistUserIfCurrent(j),P})).apply(this,arguments)}class at{constructor(P){this.auth=P,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(P){this.consumers.add(P),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,P)&&(this.sendToConsumer(this.queuedRedirectEvent,P),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(P){this.consumers.delete(P)}onEvent(P){if(this.hasEventBeenHandled(P))return!1;let R=!1;return this.consumers.forEach(q=>{this.isEventForConsumer(P,q)&&(R=!0,this.sendToConsumer(P,q),this.saveEventToCache(P))}),this.hasHandledPotentialRedirect||!function qe(j){switch(j.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return et(j);default:return!1}}(P)||(this.hasHandledPotentialRedirect=!0,R||(this.queuedRedirectEvent=P,R=!0)),R}sendToConsumer(P,R){var q;if(P.error&&!et(P)){const ce=(null===(q=P.error.code)||void 0===q?void 0:q.split("auth/")[1])||"internal-error";R.onError(Xt(this.auth,ce))}else R.onAuthEvent(P)}isEventForConsumer(P,R){const q=null===R.eventId||!!P.eventId&&P.eventId===R.eventId;return R.filter.includes(P.type)&&q}hasEventBeenHandled(P){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ot(P))}saveEventToCache(P){this.cachedEventUids.add(Ot(P)),this.lastProcessedEventTime=Date.now()}}function Ot(j){return[j.type,j.eventId,j.sessionId,j.tenantId].filter(P=>P).join("-")}function et({type:j,error:P}){return"unknown"===j&&"auth/no-auth-event"===P?.code}function Xe(j){return Mt.apply(this,arguments)}function Mt(){return(Mt=(0,u.Z)(function*(j,P={}){return vn(j,"GET","/v1/projects",P)})).apply(this,arguments)}const Rt=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dn=/^https?/;function _n(){return(_n=(0,u.Z)(function*(j){if(j.config.emulator)return;const{authorizedDomains:P}=yield Xe(j);for(const R of P)try{if(Yt(R))return}catch{}Jt(j,"unauthorized-domain")})).apply(this,arguments)}function Yt(j){const P=mt(),{protocol:R,hostname:q}=new URL(P);if(j.startsWith("chrome-extension://")){const ct=new URL(j);return""===ct.hostname&&""===q?"chrome-extension:"===R&&j.replace("chrome-extension://","")===P.replace("chrome-extension://",""):"chrome-extension:"===R&&ct.hostname===q}if(!dn.test(R))return!1;if(Rt.test(j))return q===j;const ce=j.replace(/\./g,"\\.");return new RegExp("^(.+\\."+ce+"|"+ce+")$","i").test(q)}const yn=new en(3e4,6e4);function xi(){const j=rr().___jsl;if(j?.H)for(const P of Object.keys(j.H))if(j.H[P].r=j.H[P].r||[],j.H[P].L=j.H[P].L||[],j.H[P].r=[...j.H[P].L],j.CP)for(let R=0;R<j.CP.length;R++)j.CP[R]=null}let er=null;const or=new en(5e3,15e3),vi="__/auth/iframe",Dr="emulator/auth/iframe",Ws={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$s=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ka(j){const P=j.config;nt(P.authDomain,j,"auth-domain-config-required");const R=P.emulator?wn(P,Dr):`https://${j.config.authDomain}/${vi}`,q={apiKey:P.apiKey,appName:j.name,v:Se.SDK_VERSION},ce=$s.get(j.config.apiHost);ce&&(q.eid=ce);const ye=j._getFrameworks();return ye.length&&(q.fw=ye.join(",")),`${R}?${(0,Ne.xO)(q).slice(1)}`}function sr(){return sr=(0,u.Z)(function*(j){const P=yield function Ri(j){return er=er||function Vn(j){return new Promise((P,R)=>{var q,ce,ye;function ct(){xi(),gapi.load("gapi.iframes",{callback:()=>{P(gapi.iframes.getContext())},ontimeout:()=>{xi(),R(Xt(j,"network-request-failed"))},timeout:yn.get()})}if(null!==(ce=null===(q=rr().gapi)||void 0===q?void 0:q.iframes)&&void 0!==ce&&ce.Iframe)P(gapi.iframes.getContext());else{if(null===(ye=rr().gapi)||void 0===ye||!ye.load){const Gt=Id("iframefcb");return rr()[Gt]=()=>{gapi.load?ct():R(Xt(j,"network-request-failed"))},Mf(`https://apis.google.com/js/api.js?onload=${Gt}`).catch(Tn=>R(Tn))}ct()}}).catch(P=>{throw er=null,P})}(j),er}(j),R=rr().gapi;return nt(R,j,"internal-error"),P.open({where:document.body,url:ka(j),messageHandlersFilter:R.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ws,dontclear:!0},q=>new Promise(function(){var ce=(0,u.Z)(function*(ye,ct){yield q.restyle({setHideOnLeave:!1});const Gt=Xt(j,"network-request-failed"),Tn=rr().setTimeout(()=>{ct(Gt)},or.get());function ri(){rr().clearTimeout(Tn),ye(q)}q.ping(ri).then(ri,()=>{ct(Gt)})});return function(ye,ct){return ce.apply(this,arguments)}}()))}),sr.apply(this,arguments)}const Yi={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Fr=500,Qn=600,Fi="_blank",bs="http://localhost";class mo{constructor(P){this.window=P,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const Wr="__/auth/handler",Ys="emulator/auth/handler";function ma(j,P,R,q,ce,ye){nt(j.config.authDomain,j,"auth-domain-config-required"),nt(j.config.apiKey,j,"invalid-api-key");const ct={apiKey:j.config.apiKey,appName:j.name,authType:R,redirectUrl:q,v:Se.SDK_VERSION,eventId:ce};if(P instanceof Zs){P.setDefaultLanguage(j.languageCode),ct.providerId=P.providerId||"",(0,Ne.xb)(P.getCustomParameters())||(ct.customParameters=JSON.stringify(P.getCustomParameters()));for(const[Tn,ri]of Object.entries(ye||{}))ct[Tn]=ri}if(P instanceof js){const Tn=P.getScopes().filter(ri=>""!==ri);Tn.length>0&&(ct.scopes=Tn.join(","))}j.tenantId&&(ct.tid=j.tenantId);const Gt=ct;for(const Tn of Object.keys(Gt))void 0===Gt[Tn]&&delete Gt[Tn];return`${function Al({config:j}){return j.emulator?wn(j,Ys):`https://${j.authDomain}/${Wr}`}(j)}?${(0,Ne.xO)(Gt).slice(1)}`}const el="webStorageSupport",sc=class go{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Il,this._completeRedirectFn=it,this._overrideRedirectResult=re}_openPopup(P,R,q,ce){var ye=this;return(0,u.Z)(function*(){var ct;Nt(null===(ct=ye.eventManagers[P._key()])||void 0===ct?void 0:ct.manager,"_initialize() not called before _openPopup()");const Gt=ma(P,R,q,mt(),ce);return function oc(j,P,R,q=Fr,ce=Qn){const ye=Math.max((window.screen.availHeight-ce)/2,0).toString(),ct=Math.max((window.screen.availWidth-q)/2,0).toString();let Gt="";const Tn=Object.assign(Object.assign({},Yi),{width:q.toString(),height:ce.toString(),top:ye,left:ct}),ri=(0,Ne.z$)().toLowerCase();R&&(Gt=ae(ri)?Fi:R),H(ri)&&(P=P||bs,Tn.scrollbars="yes");const zi=Object.entries(Tn).reduce((ga,[tl,nl])=>`${ga}${tl}=${nl},`,"");if(function $t(j=(0,Ne.z$)()){var P;return He(j)&&!(null===(P=window.navigator)||void 0===P||!P.standalone)}(ri)&&"_self"!==Gt)return function Qc(j,P){const R=document.createElement("a");R.href=j,R.target=P;const q=document.createEvent("MouseEvent");q.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),R.dispatchEvent(q)}(P||"",Gt),new mo(null);const _o=window.open(P||"",Gt,zi);nt(_o,j,"popup-blocked");try{_o.focus()}catch{}return new mo(_o)}(P,Gt,Sl())})()}_openRedirect(P,R,q,ce){var ye=this;return(0,u.Z)(function*(){return yield ye._originValidation(P),function bd(j){rr().location.href=j}(ma(P,R,q,mt(),ce)),new Promise(()=>{})})()}_initialize(P){const R=P._key();if(this.eventManagers[R]){const{manager:ce,promise:ye}=this.eventManagers[R];return ce?Promise.resolve(ce):(Nt(ye,"If manager is not set, promise should be"),ye)}const q=this.initAndGetManager(P);return this.eventManagers[R]={promise:q},q.catch(()=>{delete this.eventManagers[R]}),q}initAndGetManager(P){var R=this;return(0,u.Z)(function*(){const q=yield function Tr(j){return sr.apply(this,arguments)}(P),ce=new at(P);return q.register("authEvent",ye=>(nt(ye?.authEvent,P,"invalid-auth-event"),{status:ce.onEvent(ye.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),R.eventManagers[P._key()]={manager:ce},R.iframes[P._key()]=q,ce})()}_isIframeWebStorageSupported(P,R){this.iframes[P._key()].send(el,{type:el},ce=>{var ye;const ct=null===(ye=ce?.[0])||void 0===ye?void 0:ye[el];void 0!==ct&&R(!!ct),Jt(P,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(P){const R=P._key();return this.originValidationPromises[R]||(this.originValidationPromises[R]=function Wn(j){return _n.apply(this,arguments)}(P)),this.originValidationPromises[R]}get _shouldInitProactively(){return En()||Y()||He()}};class us{constructor(P){this.factorId=P}_process(P,R,q){switch(R.type){case"enroll":return this._finalizeEnroll(P,R.credential,q);case"signin":return this._finalizeSignIn(P,R.credential);default:return pt("unexpected MultiFactorSessionType")}}}class Th extends us{constructor(P){super("phone"),this.credential=P}static _fromCredential(P){return new Th(P)}_finalizeEnroll(P,R,q){return function nc(j,P){return vn(j,"POST","/v2/accounts/mfaEnrollment:finalize",Bn(j,P))}(P,{idToken:R,displayName:q,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(P,R){return function _h(j,P){return vn(j,"POST","/v2/accounts/mfaSignIn:finalize",Bn(j,P))}(P,{mfaPendingCredential:R,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let qp=(()=>{class j{constructor(){}static assertion(R){return Th._fromCredential(R)}}return j.FACTOR_ID="phone",j})();var kf="@firebase/auth";class Sh{constructor(P){this.auth=P,this.internalListeners=new Map}getUid(){var P;return this.assertAuthConfigured(),(null===(P=this.auth.currentUser)||void 0===P?void 0:P.uid)||null}getToken(P){var R=this;return(0,u.Z)(function*(){return R.assertAuthConfigured(),yield R.auth._initializationPromise,R.auth.currentUser?{accessToken:yield R.auth.currentUser.getIdToken(P)}:null})()}addAuthTokenListener(P){if(this.assertAuthConfigured(),this.internalListeners.has(P))return;const R=this.auth.onIdTokenChanged(q=>{P(q?.stsTokenManager.accessToken||null)});this.internalListeners.set(P,R),this.updateProactiveRefresh()}removeAuthTokenListener(P){this.assertAuthConfigured();const R=this.internalListeners.get(P);R&&(this.internalListeners.delete(P),R(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const S_=(0,Ne.Pz)("authIdTokenMaxAge")||300;let ac=null;const sg=j=>function(){var P=(0,u.Z)(function*(R){const q=R&&(yield R.getIdTokenResult()),ce=q&&((new Date).getTime()-Date.parse(q.issuedAtTime))/1e3;if(ce&&ce>S_)return;const ye=q?.token;ac!==ye&&(ac=ye,yield fetch(j,{method:ye?"POST":"DELETE",headers:ye?{Authorization:`Bearer ${ye}`}:{}}))});return function(R){return P.apply(this,arguments)}}();function Vu(j=(0,Se.getApp)()){const P=(0,Se._getProvider)(j,"auth");if(P.isInitialized())return P.getImmediate();const R=function si(j,P){const R=(0,Se._getProvider)(j,"auth");if(R.isInitialized()){const ce=R.getImmediate(),ye=R.getOptions();if((0,Ne.vZ)(ye,P??{}))return ce;Jt(ce,"already-initialized")}return R.initialize({options:P})}(j,{popupRedirectResolver:sc,persistence:[mh,Tl,Il]}),q=(0,Ne.Pz)("authTokenSyncURL");if(q){const ye=sg(q);(function Cf(j,P,R){(0,Ne.m9)(j).beforeAuthStateChanged(P,R)})(R,ye,()=>ye(R.currentUser)),function tg(j,P,R,q){(0,Ne.m9)(j).onIdTokenChanged(P,R,q)}(R,ct=>ye(ct))}const ce=(0,Ne.q4)("auth");return ce&&hr(R,`http://${ce}`),R}!function qi(j){(0,Se._registerComponent)(new ft.wA("auth",(P,{options:R})=>{const q=P.getProvider("app").getImmediate(),ce=P.getProvider("heartbeat"),{apiKey:ye,authDomain:ct}=q.options;return((Gt,Tn)=>{nt(ye&&!ye.includes(":"),"invalid-api-key",{appName:Gt.name}),nt(!ct?.includes(":"),"argument-error",{appName:Gt.name});const ri={apiKey:ye,authDomain:ct,clientPlatform:j,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ln(j)},zi=new Ci(Gt,Tn,ri);return function On(j,P){const R=P?.persistence||[],q=(Array.isArray(R)?R:[R]).map(an);P?.errorMap&&j._updateErrorMap(P.errorMap),j._initializeWithPersistence(q,P?.popupRedirectResolver)}(zi,R),zi})(q,ce)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((P,R,q)=>{P.getProvider("auth-internal").initialize()})),(0,Se._registerComponent)(new ft.wA("auth-internal",P=>{const R=mi(P.getProvider("auth").getImmediate());return new Sh(R)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,Se.registerVersion)(kf,"0.22.0",function Bu(j){switch(j){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(j)),(0,Se.registerVersion)(kf,"0.22.0","esm2017")}("Browser")},2090:(ui,Kt,De)=>{"use strict";De.d(Kt,{$s:()=>Zn,BH:()=>Pt,DV:()=>Ss,G6:()=>Ht,GJ:()=>Is,L:()=>It,LL:()=>qn,P0:()=>Jt,Pz:()=>xt,Sg:()=>un,UG:()=>Nt,UI:()=>Sr,US:()=>ft,Wl:()=>Ai,Yr:()=>Dt,ZB:()=>Ke,ZR:()=>ir,aH:()=>Xt,b$:()=>si,cI:()=>Xi,dS:()=>Bs,eu:()=>en,g5:()=>Se,gK:()=>Oo,gQ:()=>as,h$:()=>yt,hl:()=>rn,hu:()=>Ne,jU:()=>zt,m9:()=>eo,ne:()=>hi,p$:()=>je,pd:()=>Gr,q4:()=>kt,r3:()=>co,ru:()=>an,tV:()=>Ve,uI:()=>pt,ug:()=>Ei,vZ:()=>$r,w1:()=>mt,w9:()=>lo,xO:()=>ss,xb:()=>gs,z$:()=>nt,zI:()=>wn,zd:()=>wo});const u={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Ne=function(ze,ne){if(!ze)throw Se(ne)},Se=function(ze){return new Error("Firebase Database ("+u.SDK_VERSION+") INTERNAL ASSERT FAILED: "+ze)},_=function(ze){const ne=[];let $=0;for(let H=0;H<ze.length;H++){let Y=ze.charCodeAt(H);Y<128?ne[$++]=Y:Y<2048?(ne[$++]=Y>>6|192,ne[$++]=63&Y|128):55296==(64512&Y)&&H+1<ze.length&&56320==(64512&ze.charCodeAt(H+1))?(Y=65536+((1023&Y)<<10)+(1023&ze.charCodeAt(++H)),ne[$++]=Y>>18|240,ne[$++]=Y>>12&63|128,ne[$++]=Y>>6&63|128,ne[$++]=63&Y|128):(ne[$++]=Y>>12|224,ne[$++]=Y>>6&63|128,ne[$++]=63&Y|128)}return ne},ft={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(ze,ne){if(!Array.isArray(ze))throw Error("encodeByteArray takes an array as a parameter");this.init_();const $=ne?this.byteToCharMapWebSafe_:this.byteToCharMap_,H=[];for(let Y=0;Y<ze.length;Y+=3){const ae=ze[Y],pe=Y+1<ze.length,ke=pe?ze[Y+1]:0,Be=Y+2<ze.length,Pe=Be?ze[Y+2]:0;let $t=(15&ke)<<2|Pe>>6,_t=63&Pe;Be||(_t=64,pe||($t=64)),H.push($[ae>>2],$[(3&ae)<<4|ke>>4],$[$t],$[_t])}return H.join("")},encodeString(ze,ne){return this.HAS_NATIVE_SUPPORT&&!ne?btoa(ze):this.encodeByteArray(_(ze),ne)},decodeString(ze,ne){return this.HAS_NATIVE_SUPPORT&&!ne?atob(ze):function(ze){const ne=[];let $=0,H=0;for(;$<ze.length;){const Y=ze[$++];if(Y<128)ne[H++]=String.fromCharCode(Y);else if(Y>191&&Y<224){const ae=ze[$++];ne[H++]=String.fromCharCode((31&Y)<<6|63&ae)}else if(Y>239&&Y<365){const Be=((7&Y)<<18|(63&ze[$++])<<12|(63&ze[$++])<<6|63&ze[$++])-65536;ne[H++]=String.fromCharCode(55296+(Be>>10)),ne[H++]=String.fromCharCode(56320+(1023&Be))}else{const ae=ze[$++],pe=ze[$++];ne[H++]=String.fromCharCode((15&Y)<<12|(63&ae)<<6|63&pe)}}return ne.join("")}(this.decodeStringToByteArray(ze,ne))},decodeStringToByteArray(ze,ne){this.init_();const $=ne?this.charToByteMapWebSafe_:this.charToByteMap_,H=[];for(let Y=0;Y<ze.length;){const ae=$[ze.charAt(Y++)],ke=Y<ze.length?$[ze.charAt(Y)]:0;++Y;const Pe=Y<ze.length?$[ze.charAt(Y)]:64;++Y;const rt=Y<ze.length?$[ze.charAt(Y)]:64;if(++Y,null==ae||null==ke||null==Pe||null==rt)throw new on;H.push(ae<<2|ke>>4),64!==Pe&&(H.push(ke<<4&240|Pe>>2),64!==rt&&H.push(Pe<<6&192|rt))}return H},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let ze=0;ze<this.ENCODED_VALS.length;ze++)this.byteToCharMap_[ze]=this.ENCODED_VALS.charAt(ze),this.charToByteMap_[this.byteToCharMap_[ze]]=ze,this.byteToCharMapWebSafe_[ze]=this.ENCODED_VALS_WEBSAFE.charAt(ze),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[ze]]=ze,ze>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(ze)]=ze,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(ze)]=ze)}}};class on extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yt=function(ze){const ne=_(ze);return ft.encodeByteArray(ne,!0)},It=function(ze){return yt(ze).replace(/\./g,"")},Ve=function(ze){try{return ft.decodeString(ze,!0)}catch(ne){console.error("base64Decode failed: ",ne)}return null};function je(ze){return Ke(void 0,ze)}function Ke(ze,ne){if(!(ne instanceof Object))return ne;switch(ne.constructor){case Date:return new Date(ne.getTime());case Object:void 0===ze&&(ze={});break;case Array:ze=[];break;default:return ne}for(const $ in ne)!ne.hasOwnProperty($)||!pn($)||(ze[$]=Ke(ze[$],ne[$]));return ze}function pn(ze){return"__proto__"!==ze}const Ye=()=>{try{return function nn(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const ze=process.env.__FIREBASE_DEFAULTS__;return ze?JSON.parse(ze):void 0})()||(()=>{if(typeof document>"u")return;let ze;try{ze=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const ne=ze&&Ve(ze[1]);return ne&&JSON.parse(ne)})()}catch(ze){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${ze}`)}},kt=ze=>{var ne,$;return null===($=null===(ne=Ye())||void 0===ne?void 0:ne.emulatorHosts)||void 0===$?void 0:$[ze]},Jt=ze=>{const ne=kt(ze);if(!ne)return;const $=ne.lastIndexOf(":");if($<=0||$+1===ne.length)throw new Error(`Invalid host ${ne} with no separate hostname and port!`);const H=parseInt(ne.substring($+1),10);return"["===ne[0]?[ne.substring(1,$-1),H]:[ne.substring(0,$),H]},Xt=()=>{var ze;return null===(ze=Ye())||void 0===ze?void 0:ze.config},xt=ze=>{var ne;return null===(ne=Ye())||void 0===ne?void 0:ne[`_${ze}`]};class Pt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((ne,$)=>{this.resolve=ne,this.reject=$})}wrapCallback(ne){return($,H)=>{$?this.reject($):this.resolve(H),"function"==typeof ne&&(this.promise.catch(()=>{}),1===ne.length?ne($):ne($,H))}}}function un(ze,ne){if(ze.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const H=ne||"demo-project",Y=ze.iat||0,ae=ze.sub||ze.user_id;if(!ae)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const pe=Object.assign({iss:`https://securetoken.google.com/${H}`,aud:H,iat:Y,exp:Y+3600,auth_time:Y,sub:ae,user_id:ae,firebase:{sign_in_provider:"custom",identities:{}}},ze);return[It(JSON.stringify({alg:"none",type:"JWT"})),It(JSON.stringify(pe)),""].join(".")}function nt(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function pt(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(nt())}function Nt(){var ze;const ne=null===(ze=Ye())||void 0===ze?void 0:ze.forceEnvironment;if("node"===ne)return!0;if("browser"===ne)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function zt(){return"object"==typeof self&&self.self===self}function an(){const ze="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof ze&&void 0!==ze.id}function si(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function mt(){const ze=nt();return ze.indexOf("MSIE ")>=0||ze.indexOf("Trident/")>=0}function Dt(){return!0===u.NODE_CLIENT||!0===u.NODE_ADMIN}function Ht(){return!Nt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function rn(){try{return"object"==typeof indexedDB}catch{return!1}}function en(){return new Promise((ze,ne)=>{try{let $=!0;const H="validate-browser-context-for-indexeddb-analytics-module",Y=self.indexedDB.open(H);Y.onsuccess=()=>{Y.result.close(),$||self.indexedDB.deleteDatabase(H),ze(!0)},Y.onupgradeneeded=()=>{$=!1},Y.onerror=()=>{var ae;ne((null===(ae=Y.error)||void 0===ae?void 0:ae.message)||"")}}catch($){ne($)}})}function wn(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class ir extends Error{constructor(ne,$,H){super($),this.code=ne,this.customData=H,this.name="FirebaseError",Object.setPrototypeOf(this,ir.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qn.prototype.create)}}class qn{constructor(ne,$,H){this.service=ne,this.serviceName=$,this.errors=H}create(ne,...$){const H=$[0]||{},Y=`${this.service}/${ne}`,ae=this.errors[ne],pe=ae?function Bn(ze,ne){return ze.replace(vn,($,H)=>{const Y=ne[H];return null!=Y?String(Y):`<${H}?>`})}(ae,H):"Error";return new ir(Y,`${this.serviceName}: ${pe} (${Y}).`,H)}}const vn=/\{\$([^}]+)}/g;function Xi(ze){return JSON.parse(ze)}function Ai(ze){return JSON.stringify(ze)}const dr=function(ze){let ne={},$={},H={},Y="";try{const ae=ze.split(".");ne=Xi(Ve(ae[0])||""),$=Xi(Ve(ae[1])||""),Y=ae[2],H=$.d||{},delete $.d}catch{}return{header:ne,claims:$,data:H,signature:Y}},lo=function(ze){const $=dr(ze).claims;return!!$&&"object"==typeof $&&$.hasOwnProperty("iat")},Is=function(ze){const ne=dr(ze).claims;return"object"==typeof ne&&!0===ne.admin};function co(ze,ne){return Object.prototype.hasOwnProperty.call(ze,ne)}function Ss(ze,ne){if(Object.prototype.hasOwnProperty.call(ze,ne))return ze[ne]}function gs(ze){for(const ne in ze)if(Object.prototype.hasOwnProperty.call(ze,ne))return!1;return!0}function Sr(ze,ne,$){const H={};for(const Y in ze)Object.prototype.hasOwnProperty.call(ze,Y)&&(H[Y]=ne.call($,ze[Y],Y,ze));return H}function $r(ze,ne){if(ze===ne)return!0;const $=Object.keys(ze),H=Object.keys(ne);for(const Y of $){if(!H.includes(Y))return!1;const ae=ze[Y],pe=ne[Y];if(In(ae)&&In(pe)){if(!$r(ae,pe))return!1}else if(ae!==pe)return!1}for(const Y of H)if(!$.includes(Y))return!1;return!0}function In(ze){return null!==ze&&"object"==typeof ze}function ss(ze){const ne=[];for(const[$,H]of Object.entries(ze))Array.isArray(H)?H.forEach(Y=>{ne.push(encodeURIComponent($)+"="+encodeURIComponent(Y))}):ne.push(encodeURIComponent($)+"="+encodeURIComponent(H));return ne.length?"&"+ne.join("&"):""}function wo(ze){const ne={};return ze.replace(/^\?/,"").split("&").forEach(H=>{if(H){const[Y,ae]=H.split("=");ne[decodeURIComponent(Y)]=decodeURIComponent(ae)}}),ne}function Gr(ze){const ne=ze.indexOf("?");if(!ne)return"";const $=ze.indexOf("#",ne);return ze.substring(ne,$>0?$:void 0)}class as{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let ne=1;ne<this.blockSize;++ne)this.pad_[ne]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(ne,$){$||($=0);const H=this.W_;if("string"==typeof ne)for(let rt=0;rt<16;rt++)H[rt]=ne.charCodeAt($)<<24|ne.charCodeAt($+1)<<16|ne.charCodeAt($+2)<<8|ne.charCodeAt($+3),$+=4;else for(let rt=0;rt<16;rt++)H[rt]=ne[$]<<24|ne[$+1]<<16|ne[$+2]<<8|ne[$+3],$+=4;for(let rt=16;rt<80;rt++){const $t=H[rt-3]^H[rt-8]^H[rt-14]^H[rt-16];H[rt]=4294967295&($t<<1|$t>>>31)}let Pe,He,Y=this.chain_[0],ae=this.chain_[1],pe=this.chain_[2],ke=this.chain_[3],Be=this.chain_[4];for(let rt=0;rt<80;rt++){rt<40?rt<20?(Pe=ke^ae&(pe^ke),He=1518500249):(Pe=ae^pe^ke,He=1859775393):rt<60?(Pe=ae&pe|ke&(ae|pe),He=2400959708):(Pe=ae^pe^ke,He=3395469782);const $t=(Y<<5|Y>>>27)+Pe+Be+He+H[rt]&4294967295;Be=ke,ke=pe,pe=4294967295&(ae<<30|ae>>>2),ae=Y,Y=$t}this.chain_[0]=this.chain_[0]+Y&4294967295,this.chain_[1]=this.chain_[1]+ae&4294967295,this.chain_[2]=this.chain_[2]+pe&4294967295,this.chain_[3]=this.chain_[3]+ke&4294967295,this.chain_[4]=this.chain_[4]+Be&4294967295}update(ne,$){if(null==ne)return;void 0===$&&($=ne.length);const H=$-this.blockSize;let Y=0;const ae=this.buf_;let pe=this.inbuf_;for(;Y<$;){if(0===pe)for(;Y<=H;)this.compress_(ne,Y),Y+=this.blockSize;if("string"==typeof ne){for(;Y<$;)if(ae[pe]=ne.charCodeAt(Y),++pe,++Y,pe===this.blockSize){this.compress_(ae),pe=0;break}}else for(;Y<$;)if(ae[pe]=ne[Y],++pe,++Y,pe===this.blockSize){this.compress_(ae),pe=0;break}}this.inbuf_=pe,this.total_+=$}digest(){const ne=[];let $=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let Y=this.blockSize-1;Y>=56;Y--)this.buf_[Y]=255&$,$/=256;this.compress_(this.buf_);let H=0;for(let Y=0;Y<5;Y++)for(let ae=24;ae>=0;ae-=8)ne[H]=this.chain_[Y]>>ae&255,++H;return ne}}function hi(ze,ne){const $=new jn(ze,ne);return $.subscribe.bind($)}class jn{constructor(ne,$){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=$,this.task.then(()=>{ne(this)}).catch(H=>{this.error(H)})}next(ne){this.forEachObserver($=>{$.next(ne)})}error(ne){this.forEachObserver($=>{$.error(ne)}),this.close(ne)}complete(){this.forEachObserver(ne=>{ne.complete()}),this.close()}subscribe(ne,$,H){let Y;if(void 0===ne&&void 0===$&&void 0===H)throw new Error("Missing Observer.");Y=function zr(ze,ne){if("object"!=typeof ze||null===ze)return!1;for(const $ of ne)if($ in ze&&"function"==typeof ze[$])return!0;return!1}(ne,["next","error","complete"])?ne:{next:ne,error:$,complete:H},void 0===Y.next&&(Y.next=Mr),void 0===Y.error&&(Y.error=Mr),void 0===Y.complete&&(Y.complete=Mr);const ae=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?Y.error(this.finalError):Y.complete()}catch{}}),this.observers.push(Y),ae}unsubscribeOne(ne){void 0===this.observers||void 0===this.observers[ne]||(delete this.observers[ne],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(ne){if(!this.finalized)for(let $=0;$<this.observers.length;$++)this.sendOne($,ne)}sendOne(ne,$){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[ne])try{$(this.observers[ne])}catch(H){typeof console<"u"&&console.error&&console.error(H)}})}close(ne){this.finalized||(this.finalized=!0,void 0!==ne&&(this.finalError=ne),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Mr(){}function Oo(ze,ne){return`${ze} failed: ${ne} argument `}const Bs=function(ze){const ne=[];let $=0;for(let H=0;H<ze.length;H++){let Y=ze.charCodeAt(H);if(Y>=55296&&Y<=56319){const ae=Y-55296;H++,Ne(H<ze.length,"Surrogate pair missing trail surrogate."),Y=65536+(ae<<10)+(ze.charCodeAt(H)-56320)}Y<128?ne[$++]=Y:Y<2048?(ne[$++]=Y>>6|192,ne[$++]=63&Y|128):Y<65536?(ne[$++]=Y>>12|224,ne[$++]=Y>>6&63|128,ne[$++]=63&Y|128):(ne[$++]=Y>>18|240,ne[$++]=Y>>12&63|128,ne[$++]=Y>>6&63|128,ne[$++]=63&Y|128)}return ne},Ei=function(ze){let ne=0;for(let $=0;$<ze.length;$++){const H=ze.charCodeAt($);H<128?ne++:H<2048?ne+=2:H>=55296&&H<=56319?(ne+=4,$++):ne+=3}return ne},qr=1e3,cn=2,Bt=144e5,Sn=.5;function Zn(ze,ne=qr,$=cn){const H=ne*Math.pow($,ze),Y=Math.round(Sn*H*(Math.random()-.5)*2);return Math.min(Bt,H+Y)}function eo(ze){return ze&&ze._delegate?ze._delegate:ze}},6696:(ui,Kt,De)=>{"use strict";var u=De(4650);let Ne=null;function Se(){return Ne}class $e{}const ft=new u.OlP("DocumentToken");let on=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:function(){return function yt(){return(0,u.LFG)(Ve)}()},providedIn:"platform"}),n})();const It=new u.OlP("Location Initialized");let Ve=(()=>{class n extends on{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Se().getBaseHref(this._doc)}onPopState(t){const i=Se().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Se().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){je()?this._history.pushState(t,i,r):this._location.hash=r}replaceState(t,i,r){je()?this._history.replaceState(t,i,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(ft))},n.\u0275prov=u.Yz7({token:n,factory:function(){return function Ke(){return new Ve((0,u.LFG)(ft))}()},providedIn:"platform"}),n})();function je(){return!!window.history.pushState}function pn(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function nn(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function bn(n){return n&&"?"!==n[0]?"?"+n:n}let An=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:function(){return(0,u.f3M)(Ye)},providedIn:"root"}),n})();const vt=new u.OlP("appBaseHref");let Ye=(()=>{class n extends An{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??(0,u.f3M)(ft).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return pn(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+bn(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const f=this.prepareExternalUrl(r+bn(s));this._platformLocation.pushState(t,i,f)}replaceState(t,i,r,s){const f=this.prepareExternalUrl(r+bn(s));this._platformLocation.replaceState(t,i,f)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(on),u.LFG(vt,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),kt=(()=>{class n extends An{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=pn(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let f=this.prepareExternalUrl(r+bn(s));0==f.length&&(f=this._platformLocation.pathname),this._platformLocation.pushState(t,i,f)}replaceState(t,i,r,s){let f=this.prepareExternalUrl(r+bn(s));0==f.length&&(f=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,f)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(on),u.LFG(vt,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})(),Jt=(()=>{class n{constructor(t){this._subject=new u.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function un(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(nn(Pt(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+bn(i))}normalize(t){return n.stripTrailingSlash(function xt(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,Pt(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+bn(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+bn(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=bn,n.joinWithSlash=pn,n.stripTrailingSlash=nn,n.\u0275fac=function(t){return new(t||n)(u.LFG(An))},n.\u0275prov=u.Yz7({token:n,factory:function(){return function Xt(){return new Jt((0,u.LFG)(An))}()},providedIn:"root"}),n})();function Pt(n){return n.replace(/\/index.html$/,"")}var zt=(()=>((zt=zt||{})[zt.Format=0]="Format",zt[zt.Standalone=1]="Standalone",zt))(),an=(()=>((an=an||{})[an.Narrow=0]="Narrow",an[an.Abbreviated=1]="Abbreviated",an[an.Wide=2]="Wide",an[an.Short=3]="Short",an))(),si=(()=>((si=si||{})[si.Short=0]="Short",si[si.Medium=1]="Medium",si[si.Long=2]="Long",si[si.Full=3]="Full",si))(),On=(()=>((On=On||{})[On.Decimal=0]="Decimal",On[On.Group=1]="Group",On[On.List=2]="List",On[On.PercentSign=3]="PercentSign",On[On.PlusSign=4]="PlusSign",On[On.MinusSign=5]="MinusSign",On[On.Exponential=6]="Exponential",On[On.SuperscriptingExponent=7]="SuperscriptingExponent",On[On.PerMille=8]="PerMille",On[On.Infinity=9]="Infinity",On[On.NaN=10]="NaN",On[On.TimeSeparator=11]="TimeSeparator",On[On.CurrencyDecimal=12]="CurrencyDecimal",On[On.CurrencyGroup=13]="CurrencyGroup",On))();function ir(n,e){return Sr((0,u.cg1)(n)[u.wAp.DateFormat],e)}function qn(n,e){return Sr((0,u.cg1)(n)[u.wAp.TimeFormat],e)}function Bn(n,e){return Sr((0,u.cg1)(n)[u.wAp.DateTimeFormat],e)}function vn(n,e){const t=(0,u.cg1)(n),i=t[u.wAp.NumberSymbols][e];if(typeof i>"u"){if(e===On.CurrencyDecimal)return t[u.wAp.NumberSymbols][On.Decimal];if(e===On.CurrencyGroup)return t[u.wAp.NumberSymbols][On.Group]}return i}function Is(n){if(!n[u.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[u.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Sr(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function $r(n){const[e,t]=n.split(":");return{hours:+e,minutes:+t}}const wo=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Gr={},as=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var hi=(()=>((hi=hi||{})[hi.Short=0]="Short",hi[hi.ShortGMT=1]="ShortGMT",hi[hi.Long=2]="Long",hi[hi.Extended=3]="Extended",hi))(),jn=(()=>((jn=jn||{})[jn.FullYear=0]="FullYear",jn[jn.Month=1]="Month",jn[jn.Date=2]="Date",jn[jn.Hours=3]="Hours",jn[jn.Minutes=4]="Minutes",jn[jn.Seconds=5]="Seconds",jn[jn.FractionalSeconds=6]="FractionalSeconds",jn[jn.Day=7]="Day",jn))(),Xn=(()=>((Xn=Xn||{})[Xn.DayPeriods=0]="DayPeriods",Xn[Xn.Days=1]="Days",Xn[Xn.Months=2]="Months",Xn[Xn.Eras=3]="Eras",Xn))();function zr(n,e,t,i){let r=function Y(n){if(pe(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[r,s=1,f=1]=n.split("-").map(b=>+b);return Mr(r,s-1,f)}const t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(wo))return function ae(n){const e=new Date(0);let t=0,i=0;const r=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));const f=Number(n[4]||0)-t,b=Number(n[5]||0)-i,I=Number(n[6]||0),O=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return s.call(e,f,b,I,O),e}(i)}const e=new Date(n);if(!pe(e))throw new Error(`Unable to convert "${n}" into a date`);return e}(n);e=Jr(t,e)||e;let b,f=[];for(;e;){if(b=as.exec(e),!b){f.push(e);break}{f=f.concat(b.slice(1));const B=f.pop();if(!B)break;e=B}}let I=r.getTimezoneOffset();i&&(I=ne(i,I),r=function H(n,e,t){const i=t?-1:1,r=n.getTimezoneOffset();return function $(n,e){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+e),n}(n,i*(ne(e,r)-r))}(r,i,!0));let O="";return f.forEach(B=>{const K=function ze(n){if(eo[n])return eo[n];let e;switch(n){case"G":case"GG":case"GGG":e=Ei(Xn.Eras,an.Abbreviated);break;case"GGGG":e=Ei(Xn.Eras,an.Wide);break;case"GGGGG":e=Ei(Xn.Eras,an.Narrow);break;case"y":e=wi(jn.FullYear,1,0,!1,!0);break;case"yy":e=wi(jn.FullYear,2,0,!0,!0);break;case"yyy":e=wi(jn.FullYear,3,0,!1,!0);break;case"yyyy":e=wi(jn.FullYear,4,0,!1,!0);break;case"Y":e=Oi(1);break;case"YY":e=Oi(2,!0);break;case"YYY":e=Oi(3);break;case"YYYY":e=Oi(4);break;case"M":case"L":e=wi(jn.Month,1,1);break;case"MM":case"LL":e=wi(jn.Month,2,1);break;case"MMM":e=Ei(Xn.Months,an.Abbreviated);break;case"MMMM":e=Ei(Xn.Months,an.Wide);break;case"MMMMM":e=Ei(Xn.Months,an.Narrow);break;case"LLL":e=Ei(Xn.Months,an.Abbreviated,zt.Standalone);break;case"LLLL":e=Ei(Xn.Months,an.Wide,zt.Standalone);break;case"LLLLL":e=Ei(Xn.Months,an.Narrow,zt.Standalone);break;case"w":e=ti(1);break;case"ww":e=ti(2);break;case"W":e=ti(1,!0);break;case"d":e=wi(jn.Date,1);break;case"dd":e=wi(jn.Date,2);break;case"c":case"cc":e=wi(jn.Day,1);break;case"ccc":e=Ei(Xn.Days,an.Abbreviated,zt.Standalone);break;case"cccc":e=Ei(Xn.Days,an.Wide,zt.Standalone);break;case"ccccc":e=Ei(Xn.Days,an.Narrow,zt.Standalone);break;case"cccccc":e=Ei(Xn.Days,an.Short,zt.Standalone);break;case"E":case"EE":case"EEE":e=Ei(Xn.Days,an.Abbreviated);break;case"EEEE":e=Ei(Xn.Days,an.Wide);break;case"EEEEE":e=Ei(Xn.Days,an.Narrow);break;case"EEEEEE":e=Ei(Xn.Days,an.Short);break;case"a":case"aa":case"aaa":e=Ei(Xn.DayPeriods,an.Abbreviated);break;case"aaaa":e=Ei(Xn.DayPeriods,an.Wide);break;case"aaaaa":e=Ei(Xn.DayPeriods,an.Narrow);break;case"b":case"bb":case"bbb":e=Ei(Xn.DayPeriods,an.Abbreviated,zt.Standalone,!0);break;case"bbbb":e=Ei(Xn.DayPeriods,an.Wide,zt.Standalone,!0);break;case"bbbbb":e=Ei(Xn.DayPeriods,an.Narrow,zt.Standalone,!0);break;case"B":case"BB":case"BBB":e=Ei(Xn.DayPeriods,an.Abbreviated,zt.Format,!0);break;case"BBBB":e=Ei(Xn.DayPeriods,an.Wide,zt.Format,!0);break;case"BBBBB":e=Ei(Xn.DayPeriods,an.Narrow,zt.Format,!0);break;case"h":e=wi(jn.Hours,1,-12);break;case"hh":e=wi(jn.Hours,2,-12);break;case"H":e=wi(jn.Hours,1);break;case"HH":e=wi(jn.Hours,2);break;case"m":e=wi(jn.Minutes,1);break;case"mm":e=wi(jn.Minutes,2);break;case"s":e=wi(jn.Seconds,1);break;case"ss":e=wi(jn.Seconds,2);break;case"S":e=wi(jn.FractionalSeconds,1);break;case"SS":e=wi(jn.FractionalSeconds,2);break;case"SSS":e=wi(jn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=qr(hi.Short);break;case"ZZZZZ":e=qr(hi.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=qr(hi.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=qr(hi.Long);break;default:return null}return eo[n]=e,e}(B);O+=K?K(r,t,I):"''"===B?"'":B.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),O}function Mr(n,e,t){const i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function Jr(n,e){const t=function gt(n){return(0,u.cg1)(n)[u.wAp.LocaleId]}(n);if(Gr[t]=Gr[t]||{},Gr[t][e])return Gr[t][e];let i="";switch(e){case"shortDate":i=ir(n,si.Short);break;case"mediumDate":i=ir(n,si.Medium);break;case"longDate":i=ir(n,si.Long);break;case"fullDate":i=ir(n,si.Full);break;case"shortTime":i=qn(n,si.Short);break;case"mediumTime":i=qn(n,si.Medium);break;case"longTime":i=qn(n,si.Long);break;case"fullTime":i=qn(n,si.Full);break;case"short":const r=Jr(n,"shortTime"),s=Jr(n,"shortDate");i=Oo(Bn(n,si.Short),[r,s]);break;case"medium":const f=Jr(n,"mediumTime"),b=Jr(n,"mediumDate");i=Oo(Bn(n,si.Medium),[f,b]);break;case"long":const I=Jr(n,"longTime"),O=Jr(n,"longDate");i=Oo(Bn(n,si.Long),[I,O]);break;case"full":const B=Jr(n,"fullTime"),K=Jr(n,"fullDate");i=Oo(Bn(n,si.Full),[B,K])}return i&&(Gr[t][e]=i),i}function Oo(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return null!=e&&i in e?e[i]:t})),n}function uo(n,e,t="-",i,r){let s="";(n<0||r&&n<=0)&&(r?n=1-n:(n=-n,s=t));let f=String(n);for(;f.length<e;)f="0"+f;return i&&(f=f.slice(f.length-e)),s+f}function wi(n,e,t=0,i=!1,r=!1){return function(s,f){let b=function Bs(n,e){switch(n){case jn.FullYear:return e.getFullYear();case jn.Month:return e.getMonth();case jn.Date:return e.getDate();case jn.Hours:return e.getHours();case jn.Minutes:return e.getMinutes();case jn.Seconds:return e.getSeconds();case jn.FractionalSeconds:return e.getMilliseconds();case jn.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,s);if((t>0||b>-t)&&(b+=t),n===jn.Hours)0===b&&-12===t&&(b=12);else if(n===jn.FractionalSeconds)return function _s(n,e){return uo(n,3).substring(0,e)}(b,e);const I=vn(f,On.MinusSign);return uo(b,e,I,i,r)}}function Ei(n,e,t=zt.Format,i=!1){return function(r,s){return function ho(n,e,t,i,r,s){switch(t){case Xn.Months:return function rn(n,e,t){const i=(0,u.cg1)(n),s=Sr([i[u.wAp.MonthsFormat],i[u.wAp.MonthsStandalone]],e);return Sr(s,t)}(e,r,i)[n.getMonth()];case Xn.Days:return function Ht(n,e,t){const i=(0,u.cg1)(n),s=Sr([i[u.wAp.DaysFormat],i[u.wAp.DaysStandalone]],e);return Sr(s,t)}(e,r,i)[n.getDay()];case Xn.DayPeriods:const f=n.getHours(),b=n.getMinutes();if(s){const O=function co(n){const e=(0,u.cg1)(n);return Is(e),(e[u.wAp.ExtraData][2]||[]).map(i=>"string"==typeof i?$r(i):[$r(i[0]),$r(i[1])])}(e),B=function Ss(n,e,t){const i=(0,u.cg1)(n);Is(i);const s=Sr([i[u.wAp.ExtraData][0],i[u.wAp.ExtraData][1]],e)||[];return Sr(s,t)||[]}(e,r,i),K=O.findIndex(le=>{if(Array.isArray(le)){const[ge,Te]=le,Ge=f>=ge.hours&&b>=ge.minutes,Je=f<Te.hours||f===Te.hours&&b<Te.minutes;if(ge.hours<Te.hours){if(Ge&&Je)return!0}else if(Ge||Je)return!0}else if(le.hours===f&&le.minutes===b)return!0;return!1});if(-1!==K)return B[K]}return function Dt(n,e,t){const i=(0,u.cg1)(n),s=Sr([i[u.wAp.DayPeriodsFormat],i[u.wAp.DayPeriodsStandalone]],e);return Sr(s,t)}(e,r,i)[f<12?0:1];case Xn.Eras:return function en(n,e){return Sr((0,u.cg1)(n)[u.wAp.Eras],e)}(e,i)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(r,s,n,e,t,i)}}function qr(n){return function(e,t,i){const r=-1*i,s=vn(t,On.MinusSign),f=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case hi.Short:return(r>=0?"+":"")+uo(f,2,s)+uo(Math.abs(r%60),2,s);case hi.ShortGMT:return"GMT"+(r>=0?"+":"")+uo(f,1,s);case hi.Long:return"GMT"+(r>=0?"+":"")+uo(f,2,s)+":"+uo(Math.abs(r%60),2,s);case hi.Extended:return 0===i?"Z":(r>=0?"+":"")+uo(f,2,s)+":"+uo(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}const cn=0,Bt=4;function Zn(n){return Mr(n.getFullYear(),n.getMonth(),n.getDate()+(Bt-n.getDay()))}function ti(n,e=!1){return function(t,i){let r;if(e){const s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,f=t.getDate();r=1+Math.floor((f+s)/7)}else{const s=Zn(t),f=function Sn(n){const e=Mr(n,cn,1).getDay();return Mr(n,0,1+(e<=Bt?Bt:Bt+7)-e)}(s.getFullYear()),b=s.getTime()-f.getTime();r=1+Math.round(b/6048e5)}return uo(r,n,vn(i,On.MinusSign))}}function Oi(n,e=!1){return function(t,i){return uo(Zn(t).getFullYear(),n,vn(i,On.MinusSign),e)}}const eo={};function ne(n,e){n=n.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function pe(n){return n instanceof Date&&!isNaN(n.valueOf())}const ls=/\s+/,Ms=[];let Mn=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this.initialClasses=Ms,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(ls):Ms}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(ls):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,Boolean(t[i]));this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(ls).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.ZZ4),u.Y36(u.aQg),u.Y36(u.SBq),u.Y36(u.Qsj))},n.\u0275dir=u.lG2({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class gi{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Qi=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,f)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new gi(r.item,this._ngForOf,-1,-1),null===f?void 0:f);else if(null==f)i.remove(null===s?void 0:s);else if(null!==s){const b=i.get(s);i.move(b,f),Ds(b,r)}});for(let r=0,s=i.length;r<s;r++){const b=i.get(r).context;b.index=r,b.count=s,b.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{Ds(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.s_b),u.Y36(u.Rgc),u.Y36(u.ZZ4))},n.\u0275dir=u.lG2({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function Ds(n,e){n.context.$implicit=e.item}let Ro=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new _l,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){bi("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){bi("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.s_b),u.Y36(u.Rgc))},n.\u0275dir=u.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class _l{constructor(){this.$implicit=null,this.ngIf=null}}function bi(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,u.AaK)(e)}'.`)}class jo{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let Ui=(()=>{class n{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews.push(t)}_matchCase(t){const i=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(t){if(this._defaultViews.length>0&&t!==this._defaultUsed){this._defaultUsed=t;for(const i of this._defaultViews)i.enforceState(t)}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=u.lG2({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),n})(),cd=(()=>{class n{constructor(t,i,r){this.ngSwitch=r,r._addCase(),this._view=new jo(t,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.s_b),u.Y36(u.Rgc),u.Y36(Ui,9))},n.\u0275dir=u.lG2({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),n})(),fo=(()=>{class n{constructor(t,i,r){r._addDefault(new jo(t,i))}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.s_b),u.Y36(u.Rgc),u.Y36(Ui,9))},n.\u0275dir=u.lG2({type:n,selectors:[["","ngSwitchDefault",""]],standalone:!0}),n})(),aa=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(t){if(t.ngTemplateOutlet||t.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:s,ngTemplateOutletInjector:f}=this;this._viewRef=i.createEmbeddedView(r,s,f?{injector:f}:void 0)}else this._viewRef=null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.s_b))},n.\u0275dir=u.lG2({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[u.TTD]}),n})();const Pc=new u.OlP("DATE_PIPE_DEFAULT_TIMEZONE"),Oc=new u.OlP("DATE_PIPE_DEFAULT_OPTIONS");let Us=(()=>{class n{constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,s){if(null==t||""===t||t!=t)return null;try{return zr(t,i??this.defaultOptions?.dateFormat??"mediumDate",s||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(f){throw function yi(n,e){return new u.vHH(2100,!1)}()}}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.soG,16),u.Y36(Pc,24),u.Y36(Oc,24))},n.\u0275pipe=u.Yjl({name:"date",type:n,pure:!0,standalone:!0}),n})(),ys=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({}),n})();const no="browser",dd="server";function bf(n){return n===dd}let xu=(()=>{class n{}return n.\u0275prov=(0,u.Yz7)({token:n,providedIn:"root",factory:()=>new Rc((0,u.LFG)(ft),window)}),n})();class Rc{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function fd(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const f=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(f)return f}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Ql(this.window.history)||Ql(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Ql(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class ic extends $e{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class El extends ic{static makeCurrent(){!function _(n){Ne||(Ne=n)}(new El)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function If(){return Sa=Sa||document.querySelector("base"),Sa?Sa.getAttribute("href"):null}();return null==t?null:function Au(n){ua=ua||document.createElement("a"),ua.setAttribute("href",n);const e=ua.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Sa=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function rh(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let ua,Sa=null;const vd=new u.OlP("TRANSITION_ID"),Tl=[{provide:u.ip1,useFactory:function hh(n,e,t){return()=>{t.get(u.CZH).donePromise.then(()=>{const i=Se(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[vd,ft,u.zs3],multi:!0}];let Il=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();const Xa=new u.OlP("EventManagerPlugins");let $c=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const f=r[s];if(f.supports(t))return this._eventNameToPlugin.set(t,f),f}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Xa),u.LFG(u.R0b))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();class Sl{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Se().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let fn=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,i){const r=this.usageCount;let s=r.get(t)??0;return s+=i,s>0?r.set(t,s):r.delete(t),s}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})(),rr=(()=>{class n extends fn{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.forEach(s=>s.remove()),i.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,i){const r=this.doc.createElement("style");r.textContent=i,t.appendChild(r);const s=this.styleRef.get(i);s?s.push(r):this.styleRef.set(i,[r])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(ft))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();const bd={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Ma=/%COMP%/g,qc=new u.OlP("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function Zr(n,e){return e.flat(100).map(t=>t.replace(Ma,n))}function Ml(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let ph=(()=>{class n{constructor(t,i,r,s){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new Ps(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;const r=this.getOrCreateRenderer(t,i);return r instanceof Pu?r.applyToHost(t):r instanceof Aa&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const f=this.eventManager,b=this.sharedStylesHost,I=this.removeStylesOnCompDestory;switch(i.encapsulation){case u.ifc.Emulated:s=new Pu(f,b,i,this.appId,I);break;case u.ifc.ShadowDom:return new Ed(f,b,t,i);default:s=new Aa(f,b,i,I)}s.onDestroy=()=>r.delete(i.id),r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(u.LFG($c),u.LFG(rr),u.LFG(u.AFp),u.LFG(qc))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();class Ps{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(bd[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(Zc(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(Zc(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=bd[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=bd[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(u.JOm.DashCase|u.JOm.Important)?e.style.setProperty(t,i,r&u.JOm.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&u.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Ml(i)):this.eventManager.addEventListener(e,t,Ml(i))}}function Zc(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Ed extends Ps{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Zr(r.id,r.styles);for(const f of s){const b=document.createElement("style");b.textContent=f,this.shadowRoot.appendChild(b)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Aa extends Ps{constructor(e,t,i,r,s=i.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=Zr(s,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class Pu extends Aa{constructor(e,t,i,r,s){const f=r+"-"+i.id;super(e,t,i,s,f),this.contentAttr=function Da(n){return"_ngcontent-%COMP%".replace(Ma,n)}(f),this.hostAttr=function wd(n){return"_nghost-%COMP%".replace(Ma,n)}(f)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let Up=(()=>{class n extends Sl{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(ft))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();const Td=["alt","control","meta","shift"],mh={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},gh={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let _h=(()=>{class n extends Sl{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),f=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Se().onAndCancel(t,s.domEventName,f))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let f="",b=i.indexOf("code");if(b>-1&&(i.splice(b,1),f="code."),Td.forEach(O=>{const B=i.indexOf(O);B>-1&&(i.splice(B,1),f+=O+".")}),f+=s,0!=i.length||0===s.length)return null;const I={};return I.domEventName=r,I.fullKey=f,I}static matchEventFullKeyCode(t,i){let r=mh[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),Td.forEach(f=>{f!==r&&(0,gh[f])(t)&&(s+=f+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(ft))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();const Df=(0,u.eFA)(u._c5,"browser",[{provide:u.Lbi,useValue:no},{provide:u.g9A,useValue:function Id(){El.makeCurrent()},multi:!0},{provide:ft,useFactory:function yh(){return(0,u.RDi)(document),document},deps:[]}]),Af=new u.OlP(""),Pf=[{provide:u.rWj,useClass:class Vp{addToWindow(e){u.dqk.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},u.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),u.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),u.dqk.frameworkStabilizers||(u.dqk.frameworkStabilizers=[]),u.dqk.frameworkStabilizers.push(i=>{const r=u.dqk.getAllAngularTestabilities();let s=r.length,f=!1;const b=function(I){f=f||I,s--,0==s&&i(f)};r.forEach(function(I){I.whenStable(b)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Se().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:u.lri,useClass:u.dDg,deps:[u.R0b,u.eoX,u.rWj]},{provide:u.dDg,useClass:u.dDg,deps:[u.R0b,u.eoX,u.rWj]}],Yc=[{provide:u.zSh,useValue:"root"},{provide:u.qLn,useFactory:function Wc(){return new u.qLn},deps:[]},{provide:Xa,useClass:Up,multi:!0,deps:[ft,u.R0b,u.Lbi]},{provide:Xa,useClass:_h,multi:!0,deps:[ft]},{provide:ph,useClass:ph,deps:[$c,rr,u.AFp,qc]},{provide:u.FYo,useExisting:ph},{provide:fn,useExisting:rr},{provide:rr,useClass:rr,deps:[ft]},{provide:$c,useClass:$c,deps:[Xa,u.R0b]},{provide:class Wi{},useClass:Il,deps:[]},[]];let Os=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:u.AFp,useValue:t.appId},{provide:vd,useExisting:u.AFp},Tl]}}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Af,12))},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[...Yc,...Pf],imports:[ys,u.hGG]}),n})(),gn=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(ft))},n.\u0275prov=u.Yz7({token:n,factory:function(t){let i=null;return i=t?new t:function Ru(){return new gn((0,u.LFG)(ft))}(),i},providedIn:"root"}),n})();typeof window<"u"&&window;let Eh=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:function(t){let i=null;return i=t?new(t||n):u.LFG(Sd),i},providedIn:"root"}),n})(),Sd=(()=>{class n extends Eh{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case u.q3G.NONE:return i;case u.q3G.HTML:return(0,u.qzn)(i,"HTML")?(0,u.z3N)(i):(0,u.EiD)(this._doc,String(i)).toString();case u.q3G.STYLE:return(0,u.qzn)(i,"Style")?(0,u.z3N)(i):i;case u.q3G.SCRIPT:if((0,u.qzn)(i,"Script"))return(0,u.z3N)(i);throw new Error("unsafe value used in a script context");case u.q3G.URL:return(0,u.qzn)(i,"URL")?(0,u.z3N)(i):(0,u.mCW)(String(i));case u.q3G.RESOURCE_URL:if((0,u.qzn)(i,"ResourceURL"))return(0,u.z3N)(i);throw new Error(`unsafe value used in a resource URL context (see ${u.JZr})`);default:throw new Error(`Unexpected SecurityContext ${t} (see ${u.JZr})`)}}bypassSecurityTrustHtml(t){return(0,u.JVY)(t)}bypassSecurityTrustStyle(t){return(0,u.L6k)(t)}bypassSecurityTrustScript(t){return(0,u.eBb)(t)}bypassSecurityTrustUrl(t){return(0,u.LAX)(t)}bypassSecurityTrustResourceUrl(t){return(0,u.pB0)(t)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(ft))},n.\u0275prov=u.Yz7({token:n,factory:function(t){let i=null;return i=t?new t:function og(n){return new Sd(n.get(ft))}(u.LFG(u.zs3)),i},providedIn:"root"}),n})();var Mi=De(8996),v=De(3269);function c(...n){const e=(0,v.yG)(n);return(0,Mi.D)(n,e)}var g=De(7579);class C extends g.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const D=(0,De(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var L=De(9751);const{isArray:z}=Array,{getPrototypeOf:G,prototype:J,keys:ee}=Object;function re(n){if(1===n.length){const e=n[0];if(z(e))return{args:e,keys:null};if(function fe(n){return n&&"object"==typeof n&&G(n)===J}(e)){const t=ee(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}var _e=De(4671),de=De(4004);const{isArray:ve}=Array;function ue(n){return(0,de.U)(e=>function xe(n,e){return ve(e)?n(...e):n(e)}(n,e))}function Ce(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}var be=De(5403),Me=De(9672);function Le(...n){const e=(0,v.yG)(n),t=(0,v.jO)(n),{args:i,keys:r}=re(n);if(0===i.length)return(0,Mi.D)([],e);const s=new L.y(function Fe(n,e,t=_e.y){return i=>{Ue(e,()=>{const{length:r}=n,s=new Array(r);let f=r,b=r;for(let I=0;I<r;I++)Ue(e,()=>{const O=(0,Mi.D)(n[I],e);let B=!1;O.subscribe((0,be.x)(i,K=>{s[I]=K,B||(B=!0,b--),b||i.next(t(s.slice()))},()=>{--f||i.complete()}))},i)},i)}}(i,e,r?f=>Ce(r,f):_e.y));return t?s.pipe(ue(t)):s}function Ue(n,e,t){n?(0,Me.f)(t,n,e):e()}var We=De(8189);function st(...n){return function it(){return(0,We.J)(1)}()((0,Mi.D)(n,(0,v.yG)(n)))}var Ut=De(8421);function Qe(n){return new L.y(e=>{(0,Ut.Xf)(n()).subscribe(e)})}var St=De(9635),at=De(576);function Ot(n,e){const t=(0,at.m)(n)?n:()=>n,i=r=>r.error(t());return new L.y(e?r=>e.schedule(i,0,r):i)}var et=De(515),qe=De(727),Xe=De(4482);function Mt(){return(0,Xe.e)((n,e)=>{let t=null;n._refCount++;const i=(0,be.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class Rt extends L.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,Xe.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new qe.w0;const t=this.getSubject();e.add(this.source.subscribe((0,be.x)(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=qe.w0.EMPTY)}return e}refCount(){return Mt()(this)}}function dn(n,e){return(0,Xe.e)((t,i)=>{let r=null,s=0,f=!1;const b=()=>f&&!r&&i.complete();t.subscribe((0,be.x)(i,I=>{r?.unsubscribe();let O=0;const B=s++;(0,Ut.Xf)(n(I,B)).subscribe(r=(0,be.x)(i,K=>i.next(e?e(I,K,B,O++):K),()=>{r=null,b()}))},()=>{f=!0,b()}))})}function Wn(n){return n<=0?()=>et.E:(0,Xe.e)((e,t)=>{let i=0;e.subscribe((0,be.x)(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function _n(...n){const e=(0,v.yG)(n);return(0,Xe.e)((t,i)=>{(e?st(n,t,e):st(n,t)).subscribe(i)})}function Yt(n,e){return(0,Xe.e)((t,i)=>{let r=0;t.subscribe((0,be.x)(i,s=>n.call(e,s,r++)&&i.next(s)))})}var yn=De(5577);function xi(n){return(0,Xe.e)((e,t)=>{let i=!1;e.subscribe((0,be.x)(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function Vn(n=er){return(0,Xe.e)((e,t)=>{let i=!1;e.subscribe((0,be.x)(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function er(){return new D}function Ri(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Yt((r,s)=>n(r,s,i)):_e.y,Wn(1),t?xi(e):Vn(()=>new D))}function or(n,e){return(0,at.m)(e)?(0,yn.z)(n,e,1):(0,yn.z)(n,1)}function vi(n,e,t){const i=(0,at.m)(n)||e||t?{next:n,error:e,complete:t}:n;return i?(0,Xe.e)((r,s)=>{var f;null===(f=i.subscribe)||void 0===f||f.call(i);let b=!0;r.subscribe((0,be.x)(s,I=>{var O;null===(O=i.next)||void 0===O||O.call(i,I),s.next(I)},()=>{var I;b=!1,null===(I=i.complete)||void 0===I||I.call(i),s.complete()},I=>{var O;b=!1,null===(O=i.error)||void 0===O||O.call(i,I),s.error(I)},()=>{var I,O;b&&(null===(I=i.unsubscribe)||void 0===I||I.call(i)),null===(O=i.finalize)||void 0===O||O.call(i)}))}):_e.y}function Dr(n){return(0,Xe.e)((e,t)=>{let s,i=null,r=!1;i=e.subscribe((0,be.x)(t,void 0,void 0,f=>{s=(0,Ut.Xf)(n(f,Dr(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function $s(n,e){return(0,Xe.e)(function Ws(n,e,t,i,r){return(s,f)=>{let b=t,I=e,O=0;s.subscribe((0,be.x)(f,B=>{const K=O++;I=b?n(I,B,K):(b=!0,B),i&&f.next(I)},r&&(()=>{b&&f.next(I),f.complete()})))}}(n,e,arguments.length>=2,!0))}function ka(n){return n<=0?()=>et.E:(0,Xe.e)((e,t)=>{let i=[];e.subscribe((0,be.x)(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Tr(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Yt((r,s)=>n(r,s,i)):_e.y,ka(1),t?xi(e):Vn(()=>new D))}function sr(n,e=!1){return(0,Xe.e)((t,i)=>{let r=0;t.subscribe((0,be.x)(i,s=>{const f=n(s,r++);(f||e)&&i.next(s),!f&&i.complete()}))})}function Fr(n){return(0,Xe.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const Qn="primary",Fi=Symbol("RouteTitle");class bs{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function mo(n){return new bs(n)}function oc(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const f=i[s],b=n[s];if(f.startsWith(":"))r[f.substring(1)]=b;else if(f!==b.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Wr(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!Ys(n[r],e[r]))return!1;return!0}function Ys(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function ma(n){return Array.prototype.concat.apply([],n)}function Al(n){return n.length>0?n[n.length-1]:null}function go(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function sc(n){return(0,u.CqO)(n)?n:(0,u.QGY)(n)?(0,Mi.D)(Promise.resolve(n)):c(n)}const us=!1,Th={exact:function zu(n,e,t){if(!ac(n.segments,e.segments)||!Sh(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!zu(n.children[i],e.children[i],t))return!1;return!0},subset:kf},qp={exact:function ds(n,e){return Wr(n,e)},subset:function Ih(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Ys(n[t],e[t]))},ignored:()=>!0};function Zp(n,e,t){return Th[t.paths](n.root,e.root,t.matrixParams)&&qp[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function kf(n,e,t){return Wp(n,e,e.segments,t)}function Wp(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!ac(r,t)||e.hasChildren()||!Sh(r,t,i))}if(n.segments.length===t.length){if(!ac(n.segments,t)||!Sh(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!kf(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(ac(n.segments,r)&&Sh(n.segments,r,i)&&n.children[Qn])&&Wp(n.children[Qn],e,s,i)}}function Sh(n,e,t){return e.every((i,r)=>qp[t](n[r].parameters,i.parameters))}class Bu{constructor(e=new qi([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=mo(this.queryParams)),this._queryParamMap}toString(){return P.serialize(this)}}class qi{constructor(e,t){this.segments=e,this.children=t,this.parent=null,go(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return R(this)}}class Pl{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=mo(this.parameters)),this._parameterMap}toString(){return zi(this)}}function ac(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let Vu=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:function(){return new j},providedIn:"root"}),n})();class j{parse(e){const t=new cc(e);return new Bu(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${q(e.root,!0)}`,i=function ga(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${ye(t)}=${ye(r)}`).join("&"):`${ye(t)}=${ye(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function ct(n){return encodeURI(n)}(e.fragment)}`:""}`}}const P=new j;function R(n){return n.segments.map(e=>zi(e)).join("/")}function q(n,e){if(!n.hasChildren())return R(n);if(e){const t=n.children[Qn]?q(n.children[Qn],!1):"",i=[];return go(n.children,(r,s)=>{s!==Qn&&i.push(`${s}:${q(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function sg(n,e){let t=[];return go(n.children,(i,r)=>{r===Qn&&(t=t.concat(e(i,r)))}),go(n.children,(i,r)=>{r!==Qn&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===Qn?[q(n.children[Qn],!1)]:[`${r}:${q(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Qn]?`${R(n)}/${t[0]}`:`${R(n)}/(${t.join("//")})`}}function ce(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ye(n){return ce(n).replace(/%3B/gi,";")}function Gt(n){return ce(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Tn(n){return decodeURIComponent(n)}function ri(n){return Tn(n.replace(/\+/g,"%20"))}function zi(n){return`${Gt(n.path)}${function _o(n){return Object.keys(n).map(e=>`;${Gt(e)}=${Gt(n[e])}`).join("")}(n.parameters)}`}const tl=/^[^\/()?;=#]+/;function nl(n){const e=n.match(tl);return e?e[0]:""}const lc=/^[^=?&#]+/,Jc=/^[^&#]+/;class cc{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new qi([],{}):new qi([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Qn]=new qi(e,t)),i}parseSegment(){const e=nl(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new u.vHH(4009,us);return this.capture(e),new Pl(Tn(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=nl(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=nl(this.remaining);r&&(i=r,this.capture(i))}e[Tn(t)]=Tn(i)}parseQueryParam(e){const t=function Ra(n){const e=n.match(lc);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const f=function eu(n){const e=n.match(Jc);return e?e[0]:""}(this.remaining);f&&(i=f,this.capture(i))}const r=ri(t),s=ri(i);if(e.hasOwnProperty(r)){let f=e[r];Array.isArray(f)||(f=[f],e[r]=f),f.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=nl(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new u.vHH(4010,us);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Qn);const f=this.parseChildren();t[s]=1===Object.keys(f).length?f[Qn]:new qi([],f),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new u.vHH(4011,us)}}function Mh(n){return n.segments.length>0?new qi([],{[Qn]:n}):n}function Dh(n){const e={};for(const i of Object.keys(n.children)){const s=Dh(n.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function Rf(n){if(1===n.numberOfChildren&&n.children[Qn]){const e=n.children[Qn];return new qi(n.segments.concat(e.segments),e.children)}return n}(new qi(n.segments,e))}function Uu(n){return n instanceof Bu}const Yp=!1;function Kb(n,e,t,i,r){if(0===t.length)return uc(e.root,e.root,e.root,i,r);const s=function M_(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new La(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,f)=>{if("object"==typeof s&&null!=s){if(s.outlets){const b={};return go(s.outlets,(I,O)=>{b[O]="string"==typeof I?I.split("/"):I}),[...r,{outlets:b}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===f?(s.split("/").forEach((b,I)=>{0==I&&"."===b||(0==I&&""===b?t=!0:".."===b?e++:""!=b&&r.push(b))}),r):[...r,s]},[]);return new La(t,e,i)}(t);return s.toRoot()?uc(e.root,e.root,new qi([],{}),i,r):function f(I){const O=function ag(n,e,t,i){if(n.isAbsolute)return new kh(e.root,!0,0);if(-1===i)return new kh(t,t===e.root,0);return function Md(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new u.vHH(4005,Yp&&"Invalid number of '../'");r=i.segments.length}return new kh(i,!1,r-s)}(t,i+(Yr(n.commands[0])?0:1),n.numberOfDoubleDots)}(s,e,n.snapshot?._urlSegment,I),B=O.processChildren?Dd(O.segmentGroup,O.index,s.commands):hc(O.segmentGroup,O.index,s.commands);return uc(e.root,O.segmentGroup,B,i,r)}(n.snapshot?._lastPathIndex)}function Yr(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Jn(n){return"object"==typeof n&&null!=n&&n.outlets}function uc(n,e,t,i,r){let f,s={};i&&go(i,(I,O)=>{s[O]=Array.isArray(I)?I.map(B=>`${B}`):`${I}`}),f=n===e?t:Oh(n,e,t);const b=Mh(Dh(f));return new Bu(b,s,r)}function Oh(n,e,t){const i={};return go(n.children,(r,s)=>{i[s]=r===e?t:Oh(r,e,t)}),new qi(n.segments,i)}class La{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Yr(i[0]))throw new u.vHH(4003,Yp&&"Root segment cannot have matrix parameters");const r=i.find(Jn);if(r&&r!==Al(i))throw new u.vHH(4004,Yp&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class kh{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function hc(n,e,t){if(n||(n=new qi([],{})),0===n.segments.length&&n.hasChildren())return Dd(n,e,t);const i=function Kp(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const f=n.segments[r],b=t[i];if(Jn(b))break;const I=`${b}`,O=i<t.length-1?t[i+1]:null;if(r>0&&void 0===I)break;if(I&&O&&"object"==typeof O&&void 0===O.outlets){if(!A_(I,O,f))return s;i+=2}else{if(!A_(I,{},f))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new qi(n.segments.slice(0,i.pathIndex),{});return s.children[Qn]=new qi(n.segments.slice(i.pathIndex),n.children),Dd(s,0,r)}return i.match&&0===r.length?new qi(n.segments,{}):i.match&&!n.hasChildren()?Xp(n,e,t):i.match?Dd(n,0,r):Xp(n,e,t)}function Dd(n,e,t){if(0===t.length)return new qi(n.segments,{});{const i=function Rh(n){return Jn(n[0])?n[0].outlets:{[Qn]:n}}(t),r={};if(!i[Qn]&&n.children[Qn]&&1===n.numberOfChildren&&0===n.children[Qn].segments.length){const s=Dd(n.children[Qn],e,t);return new qi(n.segments,s.children)}return go(i,(s,f)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[f]=hc(n.children[f],e,s))}),go(n.children,(s,f)=>{void 0===i[f]&&(r[f]=s)}),new qi(n.segments,r)}}function Xp(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Jn(s)){const I=D_(s.outlets);return new qi(i,I)}if(0===r&&Yr(t[0])){i.push(new Pl(n.segments[e].path,Qp(t[0]))),r++;continue}const f=Jn(s)?s.outlets[Qn]:`${s}`,b=r<t.length-1?t[r+1]:null;f&&b&&Yr(b)?(i.push(new Pl(f,Qp(b))),r+=2):(i.push(new Pl(f,{})),r++)}return new qi(i,{})}function D_(n){const e={};return go(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=Xp(new qi([],{}),0,t))}),e}function Qp(n){const e={};return go(n,(t,i)=>e[i]=`${t}`),e}function A_(n,e,t){return n==t.path&&Wr(e,t.parameters)}const Ff="imperative";class il{constructor(e,t){this.id=e,this.url=t}}class Fh extends il{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Na extends il{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Lf extends il{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Jp extends il{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class ju extends il{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Nf extends il{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Gs extends il{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class lg extends il{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class _a extends il{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class tu extends il{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Pv{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class yo{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Xb{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class em{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class rl{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class P_{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ov{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let Ol=(()=>{class n{createUrlTree(t,i,r,s,f,b){return Kb(t||i.root,r,s,f,b)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})(),Jb=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:function(e){return Ol.\u0275fac(e)},providedIn:"root"}),n})();class Fv{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=O_(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=O_(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Lv(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Lv(e,this._root).map(t=>t.value)}}function O_(n,e){if(n===e.value)return e;for(const t of e.children){const i=O_(n,t);if(i)return i}return null}function Lv(n,e){if(n===e.value)return[e];for(const t of e.children){const i=Lv(n,t);if(i.length)return i.unshift(e),i}return[]}class Ks{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function fc(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class Nv extends Fv{constructor(e,t){super(e),this.snapshot=t,zf(this,e)}toString(){return this.snapshot.toString()}}function tm(n,e){const t=function zv(n,e){const f=new ol([],{},{},"",{},Qn,e,null,n.root,-1,{});return new Nh("",new Ks(f,[]))}(n,e),i=new C([new Pl("",{})]),r=new C({}),s=new C({}),f=new C({}),b=new C(""),I=new Lh(i,r,f,b,s,Qn,e,t.root);return I.snapshot=t.root,new Nv(new Ks(I,[]),t)}class Lh{constructor(e,t,i,r,s,f,b,I){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=f,this.component=b,this.title=this.data?.pipe((0,de.U)(O=>O[Fi]))??c(void 0),this._futureSnapshot=I}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,de.U)(e=>mo(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,de.U)(e=>mo(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function k_(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function ya(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class ol{get title(){return this.data?.[Fi]}constructor(e,t,i,r,s,f,b,I,O,B,K){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=f,this.component=b,this.routeConfig=I,this._urlSegment=O,this._lastPathIndex=B,this._resolve=K}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=mo(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=mo(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Nh extends Fv{constructor(e,t){super(t),this.url=e,zf(this,t)}toString(){return kl(this._root)}}function zf(n,e){e.value._routerState=n,e.children.forEach(t=>zf(n,t))}function kl(n){const e=n.children.length>0?` { ${n.children.map(kl).join(", ")} } `:"";return`${n.value}${e}`}function sl(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Wr(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),Wr(e.params,t.params)||n.params.next(t.params),function Qc(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Wr(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),Wr(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function nm(n,e){const t=Wr(n.params,e.params)&&function S_(n,e){return ac(n,e)&&n.every((t,i)=>Wr(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||nm(n.parent,e.parent))}function $u(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function ex(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return $u(n,i,r);return $u(n,i)})}(n,e,t);return new Ks(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const f=s.route;return f.value._futureSnapshot=e.value,f.children=e.children.map(b=>$u(n,b)),f}}const i=function R_(n){return new Lh(new C(n.url),new C(n.params),new C(n.queryParams),new C(n.fragment),new C(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>$u(n,s));return new Ks(i,r)}}const Rl="ngNavigationCancelingError";function Bf(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=Uu(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=tx(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function tx(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[Rl]=!0,i.cancellationCode=e,t&&(i.url=t),i}function nx(n){return F_(n)&&Uu(n.url)}function F_(n){return n&&n[Rl]}class im{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new rm,this.attachRef=null}}let rm=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new im,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const zh=!1;let Gu=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Qn,this.activateEvents=new u.vpe,this.deactivateEvents=new u.vpe,this.attachEvents=new u.vpe,this.detachEvents=new u.vpe,this.parentContexts=(0,u.f3M)(rm),this.location=(0,u.f3M)(u.s_b),this.changeDetector=(0,u.f3M)(u.sBO),this.environmentInjector=(0,u.f3M)(u.lqb)}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new u.vHH(4012,zh);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new u.vHH(4012,zh);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new u.vHH(4012,zh);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new u.vHH(4013,zh);this._activatedRoute=t;const r=this.location,f=t.snapshot.component,b=this.parentContexts.getOrCreateContext(this.name).children,I=new cg(t,b,r.injector);if(i&&function L_(n){return!!n.resolveComponentFactory}(i)){const O=i.resolveComponentFactory(f);this.activated=r.createComponent(O,r.length,I)}else this.activated=r.createComponent(f,{index:r.length,injector:I,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=u.lG2({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[u.TTD]}),n})();class cg{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Lh?this.route:e===rm?this.childContexts:this.parent.get(e,t)}}let ug=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["ng-component"]],standalone:!0,features:[u.jDz],decls:1,vars:0,template:function(t,i){1&t&&u._UZ(0,"router-outlet")},dependencies:[Gu],encapsulation:2}),n})();function om(n,e){return n.providers&&!n._injector&&(n._injector=(0,u.MMx)(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Ad(n){const e=n.children&&n.children.map(Ad),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Qn&&(t.component=ug),t}function al(n){return n.outlet||Qn}function tr(n,e){const t=n.filter(i=>al(i)===e);return t.push(...n.filter(i=>al(i)!==e)),t}function Vf(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class qu{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),sl(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=fc(t);e.children.forEach(s=>{const f=s.value.outlet;this.deactivateRoutes(s,r[f],i),delete r[f]}),go(r,(s,f)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const f=i.getContext(r.outlet);f&&this.deactivateChildRoutes(e,t,f.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=fc(e);for(const f of Object.keys(s))this.deactivateRouteAndItsChildren(s[f],r);if(i&&i.outlet){const f=i.outlet.detach(),b=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:f,route:e,contexts:b})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=fc(e);for(const f of Object.keys(s))this.deactivateRouteAndItsChildren(s[f],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=fc(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new P_(s.value.snapshot))}),e.children.length&&this.forwardEvent(new em(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(sl(r),r===s)if(r.component){const f=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,f.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const f=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const b=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),f.children.onOutletReAttached(b.contexts),f.attachRef=b.componentRef,f.route=b.route.value,f.outlet&&f.outlet.attach(b.componentRef,b.route.value),sl(b.route.value),this.activateChildRoutes(e,null,f.children)}else{const b=Vf(r.snapshot),I=b?.get(u._Vd)??null;f.attachRef=null,f.route=r,f.resolver=I,f.injector=b,f.outlet&&f.outlet.activateWith(r,f.injector),this.activateChildRoutes(e,null,f.children)}}else this.activateChildRoutes(e,null,i)}}class Fl{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class za{constructor(e,t){this.component=e,this.route=t}}function Xs(n,e,t){const i=n._root;return Uf(i,e?e._root:null,t,[i.value])}function So(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||(0,u.Z0I)(n)?e.get(n):n:i}function Uf(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=fc(e);return n.children.forEach(f=>{(function jf(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,f=e?e.value:null,b=t?t.getContext(n.value.outlet):null;if(f&&s.routeConfig===f.routeConfig){const I=function z_(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!ac(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ac(n.url,e.url)||!Wr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!nm(n,e)||!Wr(n.queryParams,e.queryParams);default:return!nm(n,e)}}(f,s,s.routeConfig.runGuardsAndResolvers);I?r.canActivateChecks.push(new Fl(i)):(s.data=f.data,s._resolvedData=f._resolvedData),Uf(n,e,s.component?b?b.children:null:t,i,r),I&&b&&b.outlet&&b.outlet.isActivated&&r.canDeactivateChecks.push(new za(b.outlet.component,f))}else f&&hg(e,b,r),r.canActivateChecks.push(new Fl(i)),Uf(n,null,s.component?b?b.children:null:t,i,r)})(f,s[f.value.outlet],t,i.concat([f.value]),r),delete s[f.value.outlet]}),go(s,(f,b)=>hg(f,t.getContext(b),r)),r}function hg(n,e,t){const i=fc(n),r=n.value;go(i,(s,f)=>{hg(s,r.component?e?e.children.getContext(f):null:e,t)}),t.canDeactivateChecks.push(new za(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function $f(n){return"function"==typeof n}function lm(n){return n instanceof D||"EmptyError"===n?.name}const iu=Symbol("INITIAL_VALUE");function cm(){return dn(n=>Le(n.map(e=>e.pipe(Wn(1),_n(iu)))).pipe((0,de.U)(e=>{for(const t of e)if(!0!==t){if(t===iu)return iu;if(!1===t||t instanceof Bu)return t}return!0}),Yt(e=>e!==iu),Wn(1)))}function sx(n){return(0,St.z)(vi(e=>{if(Uu(e))throw Bf(0,e)}),(0,de.U)(e=>!0===e))}const ru={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Gv(n,e,t,i,r){const s=$_(n,e,t);return s.matched?function Hf(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?c(r.map(f=>{const b=So(f,n);return sc(function Gf(n){return n&&$f(n.canMatch)}(b)?b.canMatch(e,t):n.runInContext(()=>b(e,t)))})).pipe(cm(),sx()):c(!0)}(i=om(e,i),e,t).pipe((0,de.U)(f=>!0===f?s:{...ru})):c(s)}function $_(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...ru}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||oc)(t,n,e);if(!r)return{...ru};const s={};go(r.posParams,(b,I)=>{s[I]=b.path});const f=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:f,positionalParamSegments:r.posParams??{}}}function G_(n,e,t,i){if(t.length>0&&function lx(n,e,t){return t.some(i=>mg(n,e,i)&&al(i)!==Qn)}(n,t,i)){const s=new qi(e,function ax(n,e,t,i){const r={};r[Qn]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&al(s)!==Qn){const f=new qi([],{});f._sourceSegment=n,f._segmentIndexShift=e.length,r[al(s)]=f}return r}(n,e,i,new qi(t,n.children)));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function cx(n,e,t){return t.some(i=>mg(n,e,i))}(n,t,i)){const s=new qi(n.segments,function Hv(n,e,t,i,r){const s={};for(const f of i)if(mg(n,t,f)&&!r[al(f)]){const b=new qi([],{});b._sourceSegment=n,b._segmentIndexShift=e.length,s[al(f)]=b}return{...r,...s}}(n,e,t,i,n.children));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const r=new qi(n.segments,n.children);return r._sourceSegment=n,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:t}}function mg(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function B1(n,e,t,i){return!!(al(n)===i||i!==Qn&&mg(e,t,n))&&("**"===n.path||$_(e,n,t).matched)}function qv(n,e,t){return 0===e.length&&!n.children[t]}const Od=!1;class gg{constructor(e){this.segmentGroup=e||null}}class kd{constructor(e){this.urlTree=e}}function Qs(n){return Ot(new gg(n))}function Ba(n){return Ot(new kd(n))}class U1{constructor(e,t,i,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=G_(this.urlTree.root,[],[],this.config).segmentGroup,t=new qi(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Qn).pipe((0,de.U)(s=>this.createUrlTree(Dh(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Dr(s=>{if(s instanceof kd)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof gg?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Qn).pipe((0,de.U)(r=>this.createUrlTree(Dh(r),e.queryParams,e.fragment))).pipe(Dr(r=>{throw r instanceof gg?this.noMatchError(r):r}))}noMatchError(e){return new u.vHH(4002,Od)}createUrlTree(e,t,i){const r=Mh(e);return new Bu(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe((0,de.U)(s=>new qi([],s))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return(0,Mi.D)(r).pipe(or(s=>{const f=i.children[s],b=tr(t,s);return this.expandSegmentGroup(e,b,f,s).pipe((0,de.U)(I=>({segment:I,outlet:s})))}),$s((s,f)=>(s[f.outlet]=f.segment,s),{}),Tr())}expandSegment(e,t,i,r,s,f){return(0,Mi.D)(i).pipe(or(b=>this.expandSegmentAgainstRoute(e,t,i,b,r,s,f).pipe(Dr(O=>{if(O instanceof gg)return c(null);throw O}))),Ri(b=>!!b),Dr((b,I)=>{if(lm(b))return qv(t,r,s)?c(new qi([],{})):Qs(t);throw b}))}expandSegmentAgainstRoute(e,t,i,r,s,f,b){return B1(r,t,s,f)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,f):b&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,f):Qs(t):Qs(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,f){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,f):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,f)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?Ba(s):this.lineralizeSegments(i,s).pipe((0,yn.z)(f=>{const b=new qi(f,{});return this.expandSegment(e,b,t,f,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,f){const{matched:b,consumedSegments:I,remainingSegments:O,positionalParamSegments:B}=$_(t,r,s);if(!b)return Qs(t);const K=this.applyRedirectCommands(I,r.redirectTo,B);return r.redirectTo.startsWith("/")?Ba(K):this.lineralizeSegments(r,K).pipe((0,yn.z)(le=>this.expandSegment(e,t,i,le.concat(O),f,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){return"**"===i.path?(e=om(i,e),i.loadChildren?(i._loadedRoutes?c({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(e,i)).pipe((0,de.U)(b=>(i._loadedRoutes=b.routes,i._loadedInjector=b.injector,new qi(r,{})))):c(new qi(r,{}))):Gv(t,i,r,e).pipe(dn(({matched:f,consumedSegments:b,remainingSegments:I})=>f?this.getChildConfig(e=i._injector??e,i,r).pipe((0,yn.z)(B=>{const K=B.injector??e,le=B.routes,{segmentGroup:ge,slicedSegments:Te}=G_(t,b,I,le),Ge=new qi(ge.segments,ge.children);if(0===Te.length&&Ge.hasChildren())return this.expandChildren(K,le,Ge).pipe((0,de.U)(zn=>new qi(b,zn)));if(0===le.length&&0===Te.length)return c(new qi(b,{}));const Je=al(i)===s;return this.expandSegment(K,Ge,le,Te,Je?Qn:s,!0).pipe((0,de.U)(xn=>new qi(b.concat(xn.segments),xn.children)))})):Qs(t)))}getChildConfig(e,t,i){return t.children?c({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?c({routes:t._loadedRoutes,injector:t._loadedInjector}):function ox(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?c(!0):c(r.map(f=>{const b=So(f,n);return sc(function B_(n){return n&&$f(n.canLoad)}(b)?b.canLoad(e,t):n.runInContext(()=>b(e,t)))})).pipe(cm(),sx())}(e,t,i).pipe((0,yn.z)(r=>r?this.configLoader.loadChildren(e,t).pipe(vi(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function Zv(n){return Ot(tx(Od,3))}())):c({routes:[],injector:e})}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return c(i);if(r.numberOfChildren>1||!r.children[Qn])return e.redirectTo,Ot(new u.vHH(4e3,Od));r=r.children[Qn]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Bu(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return go(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const b=r.substring(1);i[s]=t[b]}else i[s]=r}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let f={};return go(t.children,(b,I)=>{f[I]=this.createSegmentGroup(e,b,i,r)}),new qi(s,f)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new u.vHH(4001,Od);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}class dm{}class Zf{constructor(e,t,i,r,s,f,b){this.injector=e,this.rootComponentType=t,this.config=i,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=f,this.urlSerializer=b}recognize(){const e=G_(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Qn).pipe((0,de.U)(t=>{if(null===t)return null;const i=new ol([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Qn,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Ks(i,t),s=new Nh(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,i=k_(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r)}processChildren(e,t,i){return(0,Mi.D)(Object.keys(i.children)).pipe(or(r=>{const s=i.children[r],f=tr(t,r);return this.processSegmentGroup(e,f,s,r)}),$s((r,s)=>r&&s?(r.push(...s),r):null),sr(r=>null!==r),xi(null),Tr(),(0,de.U)(r=>{if(null===r)return null;const s=hx(r);return function _g(n){n.sort((e,t)=>e.value.outlet===Qn?-1:t.value.outlet===Qn?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,i,r,s){return(0,Mi.D)(t).pipe(or(f=>this.processSegmentAgainstRoute(f._injector??e,f,i,r,s)),Ri(f=>!!f),Dr(f=>{if(lm(f))return qv(i,r,s)?c([]):c(null);throw f}))}processSegmentAgainstRoute(e,t,i,r,s){if(t.redirectTo||!B1(t,i,r,s))return c(null);let f;if("**"===t.path){const b=r.length>0?Al(r).parameters:{},I=fx(i)+r.length;f=c({snapshot:new ol(r,b,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Wf(t),al(t),t.component??t._loadedComponent??null,t,Wv(i),I,Va(t)),consumedSegments:[],remainingSegments:[]})}else f=Gv(i,t,r,e).pipe((0,de.U)(({matched:b,consumedSegments:I,remainingSegments:O,parameters:B})=>{if(!b)return null;const K=fx(i)+I.length;return{snapshot:new ol(I,B,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Wf(t),al(t),t.component??t._loadedComponent??null,t,Wv(i),K,Va(t)),consumedSegments:I,remainingSegments:O}}));return f.pipe(dn(b=>{if(null===b)return c(null);const{snapshot:I,consumedSegments:O,remainingSegments:B}=b;e=t._injector??e;const K=t._loadedInjector??e,le=function j1(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:ge,slicedSegments:Te}=G_(i,O,B,le.filter(Je=>void 0===Je.redirectTo));if(0===Te.length&&ge.hasChildren())return this.processChildren(K,le,ge).pipe((0,de.U)(Je=>null===Je?null:[new Ks(I,Je)]));if(0===le.length&&0===Te.length)return c([new Ks(I,[])]);const Ge=al(t)===s;return this.processSegment(K,le,ge,Te,Ge?Qn:s).pipe((0,de.U)(Je=>null===Je?null:[new Ks(I,Je)]))}))}}function $1(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function hx(n){const e=[],t=new Set;for(const i of n){if(!$1(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=hx(i.children);e.push(new Ks(i.value,r))}return e.filter(i=>!t.has(i))}function Wv(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function fx(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function Wf(n){return n.data||{}}function Va(n){return n.resolve||{}}function Yf(n){return"string"==typeof n.title||null===n.title}function vg(n){return dn(e=>{const t=n(e);return t?(0,Mi.D)(t).pipe((0,de.U)(()=>e)):c(e)})}const ou=new u.OlP("ROUTES");let bg=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,u.f3M)(u.Sil)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return c(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=sc(t.loadComponent()).pipe((0,de.U)(mc),vi(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Fr(()=>{this.componentLoaders.delete(t)})),r=new Rt(i,()=>new g.x).pipe(Mt());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return c({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe((0,de.U)(b=>{this.onLoadEndListener&&this.onLoadEndListener(i);let I,O,B=!1;Array.isArray(b)?O=b:(I=b.create(t).injector,O=ma(I.get(ou,[],u.XFs.Self|u.XFs.Optional)));return{routes:O.map(Ad),injector:I}}),Fr(()=>{this.childrenLoaders.delete(i)})),f=new Rt(s,()=>new g.x).pipe(Mt());return this.childrenLoaders.set(i,f),f}loadModuleFactoryOrRoutes(t){return sc(t()).pipe((0,de.U)(mc),(0,yn.z)(i=>i instanceof u.YKP||Array.isArray(i)?c(i):(0,Mi.D)(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function mc(n){return function Qv(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let Rd=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new g.x,this.configLoader=(0,u.f3M)(bg),this.environmentInjector=(0,u.f3M)(u.lqb),this.urlSerializer=(0,u.f3M)(Vu),this.rootContexts=(0,u.f3M)(rm),this.navigationId=0,this.afterPreactivation=()=>c(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new yo(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Pv(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t){return this.transitions=new C({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Ff,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Yt(i=>0!==i.id),(0,de.U)(i=>({...i,extractedUrl:t.urlHandlingStrategy.extract(i.rawUrl)})),dn(i=>{let r=!1,s=!1;return c(i).pipe(vi(f=>{this.currentNavigation={id:f.id,initialUrl:f.rawUrl,extractedUrl:f.extractedUrl,trigger:f.source,extras:f.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),dn(f=>{const b=t.browserUrlTree.toString(),I=!t.navigated||f.extractedUrl.toString()!==b||b!==t.currentUrlTree.toString();if(!I&&"reload"!==(f.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const B="";return this.events.next(new Jp(f.id,t.serializeUrl(i.rawUrl),B,0)),t.rawUrlTree=f.rawUrl,f.resolve(null),et.E}if(t.urlHandlingStrategy.shouldProcessUrl(f.rawUrl))return mx(f.source)&&(t.browserUrlTree=f.extractedUrl),c(f).pipe(dn(B=>{const K=this.transitions?.getValue();return this.events.next(new Fh(B.id,this.urlSerializer.serialize(B.extractedUrl),B.source,B.restoredState)),K!==this.transitions?.getValue()?et.E:Promise.resolve(B)}),function dx(n,e,t,i){return dn(r=>function V1(n,e,t,i,r){return new U1(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe((0,de.U)(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),vi(B=>{this.currentNavigation={...this.currentNavigation,finalUrl:B.urlAfterRedirects},i.urlAfterRedirects=B.urlAfterRedirects}),function H1(n,e,t,i,r){return(0,yn.z)(s=>function qf(n,e,t,i,r,s,f="emptyOnly"){return new Zf(n,e,t,i,r,f,s).recognize().pipe(dn(b=>null===b?function H_(n){return new L.y(e=>e.error(n))}(new dm):c(b)))}(n,e,t,s.urlAfterRedirects,i.serialize(s.urlAfterRedirects),i,r).pipe((0,de.U)(f=>({...s,targetSnapshot:f}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),vi(B=>{if(i.targetSnapshot=B.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!B.extras.skipLocationChange){const le=t.urlHandlingStrategy.merge(B.urlAfterRedirects,B.rawUrl);t.setBrowserUrl(le,B)}t.browserUrlTree=B.urlAfterRedirects}const K=new Nf(B.id,this.urlSerializer.serialize(B.extractedUrl),this.urlSerializer.serialize(B.urlAfterRedirects),B.targetSnapshot);this.events.next(K)}));if(I&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:B,extractedUrl:K,source:le,restoredState:ge,extras:Te}=f,Ge=new Fh(B,this.urlSerializer.serialize(K),le,ge);this.events.next(Ge);const Je=tm(K,this.rootComponentType).snapshot;return c(i={...f,targetSnapshot:Je,urlAfterRedirects:K,extras:{...Te,skipLocationChange:!1,replaceUrl:!1}})}{const B="";return this.events.next(new Jp(f.id,t.serializeUrl(i.extractedUrl),B,1)),t.rawUrlTree=f.rawUrl,f.resolve(null),et.E}}),vi(f=>{const b=new Gs(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(b)}),(0,de.U)(f=>i={...f,guards:Xs(f.targetSnapshot,f.currentSnapshot,this.rootContexts)}),function U_(n,e){return(0,yn.z)(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:f}}=t;return 0===f.length&&0===s.length?c({...t,guardsResult:!0}):function j_(n,e,t,i){return(0,Mi.D)(n).pipe((0,yn.z)(r=>function Pd(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?c(s.map(b=>{const I=Vf(e)??r,O=So(b,I);return sc(function nu(n){return n&&$f(n.canDeactivate)}(O)?O.canDeactivate(n,e,t,i):I.runInContext(()=>O(n,e,t,i))).pipe(Ri())})).pipe(cm()):c(!0)}(r.component,r.route,t,e,i)),Ri(r=>!0!==r,!0))}(f,i,r,n).pipe((0,yn.z)(b=>b&&function rx(n){return"boolean"==typeof n}(b)?function Uv(n,e,t,i){return(0,Mi.D)(e).pipe(or(r=>st(function um(n,e){return null!==n&&e&&e(new Xb(n)),c(!0)}(r.route.parent,i),function jv(n,e){return null!==n&&e&&e(new rl(n)),c(!0)}(r.route,i),function $v(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(f=>function am(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(f)).filter(f=>null!==f).map(f=>Qe(()=>c(f.guards.map(I=>{const O=Vf(f.node)??t,B=So(I,O);return sc(function $T(n){return n&&$f(n.canActivateChild)}(B)?B.canActivateChild(i,n):O.runInContext(()=>B(i,n))).pipe(Ri())})).pipe(cm())));return c(s).pipe(cm())}(n,r.path,t),function Bh(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return c(!0);const r=i.map(s=>Qe(()=>{const f=Vf(e)??t,b=So(s,f);return sc(function V_(n){return n&&$f(n.canActivate)}(b)?b.canActivate(e,n):f.runInContext(()=>b(e,n))).pipe(Ri())}));return c(r).pipe(cm())}(n,r.route,t))),Ri(r=>!0!==r,!0))}(i,s,n,e):c(b)),(0,de.U)(b=>({...t,guardsResult:b})))})}(this.environmentInjector,f=>this.events.next(f)),vi(f=>{if(i.guardsResult=f.guardsResult,Uu(f.guardsResult))throw Bf(0,f.guardsResult);const b=new lg(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot,!!f.guardsResult);this.events.next(b)}),Yt(f=>!!f.guardsResult||(t.restoreHistory(f),this.cancelNavigationTransition(f,"",3),!1)),vg(f=>{if(f.guards.canActivateChecks.length)return c(f).pipe(vi(b=>{const I=new _a(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot);this.events.next(I)}),dn(b=>{let I=!1;return c(b).pipe(function Go(n,e){return(0,yn.z)(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return c(t);let s=0;return(0,Mi.D)(r).pipe(or(f=>function Yv(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!Yf(r)&&(s[Fi]=r.title),function q1(n,e,t,i){const r=function yg(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return c({});const s={};return(0,Mi.D)(r).pipe((0,yn.z)(f=>function Kv(n,e,t,i){const r=Vf(e)??i,s=So(n,r);return sc(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[f],e,t,i).pipe(Ri(),vi(b=>{s[f]=b}))),ka(1),function Yi(n){return(0,de.U)(()=>n)}(s),Dr(f=>lm(f)?et.E:Ot(f)))}(s,n,e,i).pipe((0,de.U)(f=>(n._resolvedData=f,n.data=k_(n,t).resolve,r&&Yf(r)&&(n.data[Fi]=r.title),null)))}(f.route,i,n,e)),vi(()=>s++),ka(1),(0,yn.z)(f=>s===r.length?c(t):et.E))})}(t.paramsInheritanceStrategy,this.environmentInjector),vi({next:()=>I=!0,complete:()=>{I||(t.restoreHistory(b),this.cancelNavigationTransition(b,"",2))}}))}),vi(b=>{const I=new tu(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot);this.events.next(I)}))}),vg(f=>{const b=I=>{const O=[];I.routeConfig?.loadComponent&&!I.routeConfig._loadedComponent&&O.push(this.configLoader.loadComponent(I.routeConfig).pipe(vi(B=>{I.component=B}),(0,de.U)(()=>{})));for(const B of I.children)O.push(...b(B));return O};return Le(b(f.targetSnapshot.root)).pipe(xi(),Wn(1))}),vg(()=>this.afterPreactivation()),(0,de.U)(f=>{const b=function pc(n,e,t){const i=$u(n,e._root,t?t._root:void 0);return new Nv(i,e)}(t.routeReuseStrategy,f.targetSnapshot,f.currentRouterState);return i={...f,targetRouterState:b}}),vi(f=>{t.currentUrlTree=f.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(f.urlAfterRedirects,f.rawUrl),t.routerState=f.targetRouterState,"deferred"===t.urlUpdateStrategy&&(f.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,f),t.browserUrlTree=f.urlAfterRedirects)}),((n,e,t)=>(0,de.U)(i=>(new qu(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,t.routeReuseStrategy,f=>this.events.next(f)),Wn(1),vi({next:f=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new Na(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(f.targetRouterState.snapshot),f.resolve(!0)},complete:()=>{r=!0}}),Fr(()=>{r||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),Dr(f=>{if(s=!0,F_(f)){nx(f)||(t.navigated=!0,t.restoreHistory(i,!0));const b=new Lf(i.id,this.urlSerializer.serialize(i.extractedUrl),f.message,f.cancellationCode);if(this.events.next(b),nx(f)){const I=t.urlHandlingStrategy.merge(f.url,t.rawUrlTree),O={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||mx(i.source)};t.scheduleNavigation(I,Ff,null,O,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{t.restoreHistory(i,!0);const b=new ju(i.id,this.urlSerializer.serialize(i.extractedUrl),f,i.targetSnapshot??void 0);this.events.next(b);try{i.resolve(t.errorHandler(f))}catch(I){i.reject(I)}}return et.E}))}))}cancelNavigationTransition(t,i,r){const s=new Lf(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function mx(n){return n!==Ff}let q_=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Qn);return i}getResolvedTitleForRoute(t){return t.data[Fi]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:function(){return(0,u.f3M)(Z1)},providedIn:"root"}),n})(),Z1=(()=>{class n extends q_{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(gn))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Jv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:function(){return(0,u.f3M)(W_)},providedIn:"root"}),n})();class Z_{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let W_=(()=>{class n extends Z_{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Y_=new u.OlP("",{providedIn:"root",factory:()=>({})});let Bi=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:function(){return(0,u.f3M)(gx)},providedIn:"root"}),n})(),gx=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function _x(n){throw n}function X_(n,e,t){return e.parse("/")}const Y1={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},e0={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Lo=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,u.f3M)(u.c2e),this.isNgZoneEnabled=!1,this.options=(0,u.f3M)(Y_,{optional:!0})||{},this.errorHandler=this.options.errorHandler||_x,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||X_,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,u.f3M)(Bi),this.routeReuseStrategy=(0,u.f3M)(Jv),this.urlCreationStrategy=(0,u.f3M)(Jb),this.titleStrategy=(0,u.f3M)(q_),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=ma((0,u.f3M)(ou,{optional:!0})??[]),this.navigationTransitions=(0,u.f3M)(Rd),this.urlSerializer=(0,u.f3M)(Vu),this.location=(0,u.f3M)(Jt),this.isNgZoneEnabled=(0,u.f3M)(u.R0b)instanceof u.R0b&&u.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Bu,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=tm(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Ff,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},f=r?.navigationId?r:null;if(r){const I={...r};delete I.navigationId,delete I.\u0275routerPageId,0!==Object.keys(I).length&&(s.state=I)}const b=this.parseUrl(t);this.scheduleNavigation(b,i,f,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(Ad),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:f,queryParamsHandling:b,preserveFragment:I}=i,O=I?this.currentUrlTree.fragment:f;let B=null;switch(b){case"merge":B={...this.currentUrlTree.queryParams,...s};break;case"preserve":B=this.currentUrlTree.queryParams;break;default:B=s||null}return null!==B&&(B=this.removeEmptyProps(B)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,t,B,O??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Uu(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,Ff,null,i)}navigate(t,i={skipLocationChange:!1}){return function yx(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new u.vHH(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...Y1}:!1===i?{...e0}:i,Uu(t))return Zp(this.currentUrlTree,t,r);const s=this.parseUrl(t);return Zp(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,f){if(this.disposed)return Promise.resolve(!1);let b,I,O,B;return f?(b=f.resolve,I=f.reject,O=f.promise):O=new Promise((K,le)=>{b=K,I=le}),B="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:B,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:b,reject:I,promise:O,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),O.catch(K=>Promise.reject(K))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t),s={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===r?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===r&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Kf=(()=>{class n{constructor(t,i,r,s,f,b){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=s,this.el=f,this.locationStrategy=b,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new g.x;const I=f.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===I||"area"===I,this.isAnchorElement?this.subscription=t.events.subscribe(O=>{O instanceof Na&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=(0,u.D6c)(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=(0,u.D6c)(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=(0,u.D6c)(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,i,r,s,f){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||i||r||s||f||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:(0,u.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,i){const r=this.renderer,s=this.el.nativeElement;null!==i?r.setAttribute(s,t,i):r.removeAttribute(s,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(Lo),u.Y36(Lh),u.$8M("tabindex"),u.Y36(u.Qsj),u.Y36(u.SBq),u.Y36(An))},n.\u0275dir=u.lG2({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,i){1&t&&u.NdJ("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&t&&u.uIk("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[u.TTD]}),n})(),vx=(()=>{class n{get isActive(){return this._isActive}constructor(t,i,r,s,f){this.router=t,this.element=i,this.renderer=r,this.cdr=s,this.link=f,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new u.vpe,this.routerEventsSubscription=t.events.subscribe(b=>{b instanceof Na&&this.update()})}ngAfterContentInit(){c(this.links.changes,c(null)).pipe((0,We.J)()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const t=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=(0,Mi.D)(t).pipe((0,We.J)()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(t){const i=Array.isArray(t)?t:t.split(" ");this.classes=i.filter(r=>!!r)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||Promise.resolve().then(()=>{const t=this.hasActiveLinks();this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.classes.forEach(i=>{t?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),t&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(t))})}isLinkActive(t){const i=function K1(n){return!!n.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>!!r.urlTree&&t.isActive(r.urlTree,i)}hasActiveLinks(){const t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(Lo),u.Y36(u.SBq),u.Y36(u.Qsj),u.Y36(u.sBO),u.Y36(Kf,8))},n.\u0275dir=u.lG2({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(t,i,r){if(1&t&&u.Suo(r,Kf,5),2&t){let s;u.iGM(s=u.CRH())&&(i.links=s)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[u.TTD]}),n})();class Q_{}let Q1=(()=>{class n{constructor(t,i,r,s,f){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=f}setUpPreloading(){this.subscription=this.router.events.pipe(Yt(t=>t instanceof Na),or(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=(0,u.MMx)(s.providers,t,`Route: ${s.path}`));const f=s._injector??t,b=s._loadedInjector??f;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(f,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(b,s.children??s._loadedRoutes))}return(0,Mi.D)(r).pipe((0,We.J)())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):c(null);const s=r.pipe((0,yn.z)(f=>null===f?c(void 0):(i._loadedRoutes=f.routes,i._loadedInjector=f.injector,this.processRoutes(f.injector??t,f.routes))));if(i.loadComponent&&!i._loadedComponent){const f=this.loader.loadComponent(i);return(0,Mi.D)([s,f]).pipe((0,We.J)())}return s})}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Lo),u.LFG(u.Sil),u.LFG(u.lqb),u.LFG(Q_),u.LFG(bg))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Xf=new u.OlP("");let Qf=(()=>{class n{constructor(t,i,r,s,f={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=f,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},f.scrollPositionRestoration=f.scrollPositionRestoration||"disabled",f.anchorScrolling=f.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Fh?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Na&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Ov&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Ov(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){u.$Z()},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();var va=(()=>((va=va||{})[va.COMPLETE=0]="COMPLETE",va[va.FAILED=1]="FAILED",va[va.REDIRECTING=2]="REDIRECTING",va))();const wg=!1;function Zu(n,e){return{\u0275kind:n,\u0275providers:e}}const pm=new u.OlP("",{providedIn:"root",factory:()=>!1});function J_(){const n=(0,u.f3M)(u.zs3);return e=>{const t=n.get(u.z2F);if(e!==t.components[0])return;const i=n.get(Lo),r=n.get(mm);1===n.get(ey)&&i.initialNavigation(),n.get(wx,null,u.XFs.Optional)?.setUpPreloading(),n.get(Xf,null,u.XFs.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const mm=new u.OlP(wg?"bootstrap done indicator":"",{factory:()=>new g.x}),ey=new u.OlP(wg?"initial navigation":"",{providedIn:"root",factory:()=>1});function eC(){let n=[];return n=wg?[{provide:u.Xts,multi:!0,useFactory:()=>{const e=(0,u.f3M)(Lo);return()=>e.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function kv(n){if(!("type"in n))return`Unknown Router Event: ${n.constructor.name}`;switch(n.type){case 14:return`ActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state}, shouldActivate: ${n.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 2:return`NavigationCancel(id: ${n.id}, url: '${n.url}')`;case 16:return`NavigationSkipped(id: ${n.id}, url: '${n.url}')`;case 1:return`NavigationEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${n.id}, url: '${n.url}', error: ${n.error})`;case 0:return`NavigationStart(id: ${n.id}, url: '${n.url}')`;case 6:return`ResolveEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 5:return`ResolveStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 10:return`RouteConfigLoadEnd(path: ${n.route.path})`;case 9:return`RouteConfigLoadStart(path: ${n.route.path})`;case 4:return`RoutesRecognized(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 15:return`Scroll(anchor: '${n.anchor}', position: '${n.position?`${n.position[0]}, ${n.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],Zu(1,n)}const wx=new u.OlP(wg?"router preloader":"");function Cx(n){return Zu(0,[{provide:wx,useExisting:Q1},{provide:Q_,useExisting:n}])}const Wu=!1,Uh=new u.OlP(Wu?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),tC=[Jt,{provide:Vu,useClass:j},Lo,rm,{provide:Lh,useFactory:function fm(n){return n.routerState.root},deps:[Lo]},bg,Wu?{provide:pm,useValue:!0}:[]];function ty(){return new u.PXZ("Router",Lo)}let Tx=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[tC,Wu&&i?.enableTracing?eC().\u0275providers:[],{provide:ou,multi:!0,useValue:t},{provide:Uh,useFactory:nC,deps:[[Lo,new u.FiY,new u.tp0]]},{provide:Y_,useValue:i||{}},i?.useHash?{provide:An,useClass:kt}:{provide:An,useClass:Ye},{provide:Xf,useFactory:()=>{const n=(0,u.f3M)(xu),e=(0,u.f3M)(u.R0b),t=(0,u.f3M)(Y_),i=(0,u.f3M)(Rd),r=(0,u.f3M)(Vu);return t.scrollOffset&&n.setOffset(t.scrollOffset),new Qf(r,i,n,e,t)}},i?.preloadingStrategy?Cx(i.preloadingStrategy).\u0275providers:[],{provide:u.PXZ,multi:!0,useFactory:ty},i?.initialNavigation?Sx(i):[],[{provide:Eg,useFactory:J_},{provide:u.tb,multi:!0,useExisting:Eg}]]}}static forChild(t){return{ngModule:n,providers:[{provide:ou,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Uh,8))},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[ug]}),n})();function nC(n){if(Wu&&n)throw new u.vHH(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Sx(n){return["disabled"===n.initialNavigation?Zu(3,[{provide:u.ip1,multi:!0,useFactory:()=>{const e=(0,u.f3M)(Lo);return()=>{e.setUpLocationChangeListener()}}},{provide:ey,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Zu(2,[{provide:ey,useValue:0},{provide:u.ip1,multi:!0,deps:[u.zs3],useFactory:e=>{const t=e.get(It,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(Lo),s=e.get(mm);(function GT(n,e){n.events.pipe(Yt(t=>t instanceof Na||t instanceof Lf||t instanceof ju||t instanceof Jp),(0,de.U)(t=>t instanceof Na||t instanceof Jp?va.COMPLETE:t instanceof Lf&&(0===t.code||1===t.code)?va.REDIRECTING:va.FAILED),Yt(t=>t!==va.REDIRECTING),Wn(1)).subscribe(()=>{e()})})(r,()=>{i(!0)}),e.get(Rd).afterPreactivation=()=>(i(!0),s.closed?c(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const Eg=new u.OlP(Wu?"Router Initializer":"");var gc=De(9898);const Tg_mapboxToken="pk.eyJ1Ijoic2VyZ2lvZ2RldiIsImEiOiJja3J2eW9zcGIwYmR2MnVxamJ3MGk0djRiIn0.R1ANSOBYyCstt-QxZcI5pg";function Ig(n,e){if(1&n&&(u.TgZ(0,"div"),u._uU(1),u.qZA()),2&n){const t=e.$implicit;u.xp6(1),u.hij(" ",t," ")}}function o0(n,e){if(1&n&&(u.TgZ(0,"div",23)(1,"div"),u._UZ(2,"img",24),u.qZA(),u.TgZ(3,"div")(4,"h2"),u._uU(5),u.qZA(),u.YNc(6,Ig,2,1,"div",25),u.qZA()()),2&n){const t=e.$implicit,i=u.oxw();u.xp6(2),u.Q6J("src",i.iconPath+t.icon,u.LSH),u.xp6(3),u.Oqu(t.title),u.xp6(1),u.Q6J("ngForOf",t.vMensajes)}}function iy(n,e){if(1&n&&(u.TgZ(0,"div",26)(1,"div",27),u._UZ(2,"img",24),u.qZA(),u.TgZ(3,"div",28),u._uU(4),u.qZA()()),2&n){const t=e.$implicit,i=u.oxw();u.xp6(2),u.Q6J("src",i.iconPath+t.icon,u.LSH),u.xp6(2),u.hij(" ",t.text," ")}}let Mx=(()=>{class n{constructor(){this.tituloMensajes="Hosteler\xeda, nuestra raz\xf3n de ser",this.vMensajes=[{text:"Nos dedicamos a mejorar el servicio de locales dedicados al sector hostelero.",icon:"icon-upgrade.png"},{text:"Ayudamos aplantear objetivos ambiciosos, viables y establecer estrategias adecuadas exigiendo rigor en su cumplimiento.",icon:"icon-target.png"},{text:"Ofrecemos informaci\xf3n sobre las diferentes funciones y tramitaciones que pueden llevar a cabo.",icon:"icon-information.png"},{text:"Te acompa\xf1amos en el montaje de tu restaurante. Un negocio de hosteler\xeda debe ser comercialmente posible y econ\xf3micamente viable.",icon:"icon-steps.png"},{text:"Analizamos la competencia, los fallos y puntos d\xe9biles observables, y finalmente elaboraremos las soluciones m\xe1s efectivas ajustadas a las necesidades de cada empresa.",icon:"icon-statistics.png"},{text:"Te contamos todo aquello que me hubiera gustado que me contaran antes de montar mi primer negocio de hosteler\xeda.",icon:"icon-talk.png"}],this.vCards=[{title:"Mejora y Montaje de Negocios de Hosteler\xeda",icon:"icon-upgrade.png",vMensajes:["Acompa\xf1amos en el montaje de tu restaurante, asegurando su viabilidad comercial y econ\xf3mica.","Planteamos objetivos ambiciosos y estrategias efectivas, garantizando su riguroso cumplimiento.","Analizamos la competencia y elaboramos soluciones personalizadas para optimizar tu negocio."]},{title:"Gesti\xf3n y Control Financiero",icon:"icon-statistics.png",vMensajes:["Ense\xf1amos claves de gesti\xf3n para tener control de gastos e ingresos en tu restaurante.","Aplicamos nuevos mecanismos de trabajo para mejorar la eficiencia de tu establecimiento.","Proporcionamos profesionales especializados en el sector para diferentes servicios.","Garantizamos un servicio riguroso y adaptado a tus necesidades particulares."]},{title:"Asesoramiento y Experiencia en Hosteler\xeda",icon:"icon-information.png",vMensajes:["Brindamos informaci\xf3n valiosa basada en nuestra propia experiencia en negocios de hosteler\xeda.","Te ofrecemos un trato personalizado y presencial para entender tus necesidades.","Facilitamos profesionales del sector altamente capacitados y flexibles a tus requisitos.","Garantizamos un servicio proactivo y comprometido con el \xe9xito de tu empresa."]}],this.iconPath="../../../assets/icons/",this.vDondeEncontrarnos=[{text:"Ronda del Carmen, 13. C\xe1ceres (CP: 10002)",icon:"icon-map.png"},{text:"640 90 36 70",icon:"icon-phone.png"},{text:"contacto@hasspro.es",icon:"icon-email.png"},{text:"Hasspro_es",icon:"icon-instagram.png"},{text:"Hasspro \xc1vila",icon:"icon-facebook.png"},{text:"hasspro.es",icon:"icon-website.png"}],this.center=[-6.3757,39.4684],this.zoom=16,this.container="mapa-container"}ngOnInit(){window.scroll({top:0,left:0})}ngAfterViewInit(){gc.accessToken=Tg_mapboxToken;var t=new gc.Map({container:"mapa-container",style:"mapbox://styles/mapbox/streets-v11",center:this.center,zoom:this.zoom,scrollZoom:!1});t.scrollZoom.disable(),t.boxZoom.disable(),t.dragRotate.disable(),t.dragPan.disable(),t.keyboard.disable(),t.doubleClickZoom.disable(),t.touchZoomRotate.disable(),(new gc.Marker).setLngLat(this.center).addTo(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-home"]],decls:40,vars:3,consts:[[1,"home-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"messages-container"],[1,"title","animate__animated","animate__fadeIn","animate__delay-1s"],[1,"mensajes-container","animate__animated","animate__fadeIn","animate__delay-1s"],["class","item-card",4,"ngFor","ngForOf"],[1,"encuentra-tu-servicio"],[1,"distincion-negocio"],[1,"img-container"],[1,"button-service","animate__animated","animate__fadeIn","animate__delay-1s"],["routerLink","/servicios"],[1,"direccion-container"],[1,"nos-conocemos-container","animate__animated","animate__fadeIn","animate__delay-1s"],[1,"title"],[1,"subtitle"],[1,"contact-list"],["class","item-contacto",4,"ngFor","ngForOf"],[1,"map-container"],["id","mapa-container"],[1,"item-card"],[3,"src"],[4,"ngFor","ngForOf"],[1,"item-contacto"],[1,"icon"],[1,"text"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),u._UZ(4,"img",4),u.qZA(),u.TgZ(5,"h1",5),u._uU(6,"ASISTENTE PROFESIONAL DE HOSTELER\xcdA"),u.qZA()()(),u.TgZ(7,"div",6)(8,"div",7)(9,"h1"),u._uU(10),u.qZA()(),u.TgZ(11,"div",8),u.YNc(12,o0,7,3,"div",9),u.qZA(),u.TgZ(13,"div",10)(14,"div",11)(15,"h2"),u._uU(16,"Distinci\xf3n de su Negocio"),u.qZA(),u.TgZ(17,"div",12),u._UZ(18,"img",4),u.qZA(),u.TgZ(19,"p"),u._uU(20,"En los establecimientos en los que trabajemos ofrecemos una distinci\xf3n de "),u.TgZ(21,"b"),u._uU(22,"Hasspro"),u.qZA(),u._uU(23,", para asegurar la calidad del servicio a los potenciales clientes. \xbfQuieres saber m\xe1s? Pues "),u.TgZ(24,"b"),u._uU(25,"pulsa aqu\xed abajo"),u.qZA(),u._uU(26," y..."),u.qZA()(),u.TgZ(27,"div",13)(28,"button",14),u._uU(29,"Encuentra tu servicio"),u.qZA()()()(),u.TgZ(30,"div",15)(31,"div",16)(32,"div",17),u._uU(33," \xbfNos conocemos? "),u.qZA(),u.TgZ(34,"div",18),u._uU(35," Queremos escucharte y compartir nuestra experiencia contigo. Puedes encontrarnos en todos estos sitios: "),u.qZA(),u.TgZ(36,"div",19),u.YNc(37,iy,5,2,"div",20),u.qZA()(),u.TgZ(38,"div",21),u._UZ(39,"div",22),u.qZA()()()),2&t&&(u.xp6(10),u.Oqu(i.tituloMensajes),u.xp6(2),u.Q6J("ngForOf",i.vCards),u.xp6(25),u.Q6J("ngForOf",i.vDondeEncontrarnos))},dependencies:[Qi,Kf],styles:[".home-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box;text-align:center}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;width:100%;padding:80px 0}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;color:var(--principal-color);text-shadow:1px 1px 5px var(--principal-color-40);border-bottom:1px solid var(--principal-color);padding:8px 20px;margin-bottom:60px;text-align:center}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .mensajes-container[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:center;flex-direction:column;flex-wrap:wrap;gap:20px;max-width:1400px;width:100%;background-image:url(retrato-cuerpo-entero-hombre-alegre-confiado.e50dc7fc1d5e87bd.jpg);background-repeat:no-repeat;background-position:right;background-size:contain}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .mensajes-container[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:row;gap:30px;width:800px;margin-left:30px;box-shadow:2px 2px 10px var(--principal-color-40);padding:20px 20px 40px;border-radius:5px}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .mensajes-container[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{text-align:center;width:60px}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .mensajes-container[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child   img[_ngcontent-%COMP%]{padding-top:20px;width:100%;height:auto}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .mensajes-container[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child   div[_ngcontent-%COMP%]{line-height:24px;color:var(--principal-color-bold)}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .encuentra-tu-servicio[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:30px;margin-top:80px}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .encuentra-tu-servicio[_ngcontent-%COMP%]   .distincion-negocio[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2.2rem;font-weight:700;color:var(--principal-color);text-shadow:1px 1px 5px var(--principal-color-40);border-bottom:1px solid var(--principal-color);padding:8px 20px;margin-bottom:60px;text-align:center}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .encuentra-tu-servicio[_ngcontent-%COMP%]   .distincion-negocio[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2rem;max-width:800px;text-align:center;line-height:24px;color:var(--principal-color)}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .encuentra-tu-servicio[_ngcontent-%COMP%]   .distincion-negocio[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:var(--principal-color-bold)}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .encuentra-tu-servicio[_ngcontent-%COMP%]   .distincion-negocio[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]{text-align:center}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .encuentra-tu-servicio[_ngcontent-%COMP%]   .distincion-negocio[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .encuentra-tu-servicio[_ngcontent-%COMP%]   .button-service[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 30px;color:var(--principal-color);background-color:var(--principal-color-light);border:1px solid var(--principal-color);font-size:24px;border-radius:5px;cursor:pointer;transition:.2s}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .encuentra-tu-servicio[_ngcontent-%COMP%]   .button-service[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:transparent;color:var(--principal-color);border:1px solid var(--principal-color);transition:.2s}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;width:100%;background-color:var(--principal-color);color:var(--white-color)}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;padding:100px 40px;width:calc(50% - 80px);box-sizing:border-box}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:2.2rem;font-weight:700;text-shadow:1px 1px 5px var(--principal-color-light-40);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;text-align:center}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1.2rem;max-width:600px;font-weight:700;text-align:start;padding:8px 20px}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:20px}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .item-contacto[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;flex-direction:row;gap:20px}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .item-contacto[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:30px;height:auto}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .item-contacto[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:1rem;font-weight:700}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:50%;height:710px;box-sizing:border-box}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   #mapa-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column}@media screen and (max-width: 1092px){.mensajes-container[_ngcontent-%COMP%]{background-image:none!important;align-items:center!important}.mensajes-container[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]{width:calc(100% - 20px);margin:10px}}@media screen and (min-width: 600px) and (max-width: 959px){.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;width:calc(100% - 16px);padding:8px 20px;text-align:center}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .mensajes-container[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px;max-width:800px;flex-direction:column;align-items:center;width:calc(100% - 60px)}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .encuentra-tu-servicio[_ngcontent-%COMP%]{width:calc(100% - 20px);margin-left:10px;margin-right:10px}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]{flex-direction:column}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%], .home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:100%}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]{padding:60px 20px}}@media screen and (max-width: 599px){.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.home-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px;text-align:center}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .mensajes-container[_ngcontent-%COMP%]   .item-card[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px;max-width:800px;flex-direction:column;align-items:center;width:calc(100% - 60px)}.home-container[_ngcontent-%COMP%]   .messages-container[_ngcontent-%COMP%]   .encuentra-tu-servicio[_ngcontent-%COMP%]{width:calc(100% - 20px);margin-left:10px;margin-right:10px}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]{flex-direction:column}.home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%], .home-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:100%}}"]}),n})();function ry(...n){const e=(0,v.jO)(n),{args:t,keys:i}=re(n),r=new L.y(s=>{const{length:f}=t;if(!f)return void s.complete();const b=new Array(f);let I=f,O=f;for(let B=0;B<f;B++){let K=!1;(0,Ut.Xf)(t[B]).subscribe((0,be.x)(s,le=>{K||(K=!0,O--),b[B]=le},()=>I--,void 0,()=>{(!I||!K)&&(O||s.next(i?Ce(i,b):b),s.complete())}))}});return e?r.pipe(ue(e)):r}let Sg=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.Qsj),u.Y36(u.SBq))},n.\u0275dir=u.lG2({type:n}),n})(),Fd=(()=>{class n extends Sg{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275dir=u.lG2({type:n,features:[u.qOj]}),n})();const Kr=new u.OlP("NgValueAccessor"),sy={provide:Kr,useExisting:(0,u.Gpc)(()=>ym),multi:!0},rC=new u.OlP("CompositionEventMode");let ym=(()=>{class n extends Sg{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Jf(){const n=Se()?Se().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.Qsj),u.Y36(u.SBq),u.Y36(rC,8))},n.\u0275dir=u.lG2({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,i){1&t&&u.NdJ("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[u._Bn([sy]),u.qOj]}),n})();const vm=!1;function jh(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function Dx(n){return null!=n&&"number"==typeof n.length}const Ar=new u.OlP("NgValidators"),Yu=new u.OlP("NgAsyncValidators"),Ax=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class ar{static min(e){return function bm(n){return e=>{if(jh(e.value)||jh(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}(e)}static max(e){return function ay(n){return e=>{if(jh(e.value)||jh(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}(e)}static required(e){return function s0(n){return jh(n.value)?{required:!0}:null}(e)}static requiredTrue(e){return function Ku(n){return!0===n.value?null:{required:!0}}(e)}static email(e){return function ep(n){return jh(n.value)||Ax.test(n.value)?null:{email:!0}}(e)}static minLength(e){return function ly(n){return e=>jh(e.value)||!Dx(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static maxLength(e){return function Px(n){return e=>Dx(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static pattern(e){return function Ox(n){if(!n)return xm;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(jh(i.value))return null;const r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}(e)}static nullValidator(e){return null}static compose(e){return tp(e)}static composeAsync(e){return a0(e)}}function xm(n){return null}function kx(n){return null!=n}function Rx(n){const e=(0,u.QGY)(n)?(0,Mi.D)(n):n;if(vm&&!(0,u.CqO)(e)){let t="Expected async validator to return Promise or Observable.";throw"object"==typeof n&&(t+=" Are you using a synchronous validator where an async validator is expected?"),new u.vHH(-1101,t)}return e}function Fx(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function Lx(n,e){return e.map(t=>t(n))}function su(n){return n.map(e=>function oC(n){return!n.validate}(e)?e:t=>e.validate(t))}function tp(n){if(!n)return null;const e=n.filter(kx);return 0==e.length?null:function(t){return Fx(Lx(t,e))}}function $h(n){return null!=n?tp(su(n)):null}function a0(n){if(!n)return null;const e=n.filter(kx);return 0==e.length?null:function(t){return ry(Lx(t,e).map(Rx)).pipe((0,de.U)(Fx))}}function cy(n){return null!=n?a0(su(n)):null}function Nx(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function zx(n){return n._rawValidators}function uy(n){return n._rawAsyncValidators}function np(n){return n?Array.isArray(n)?n:[n]:[]}function Mg(n,e){return Array.isArray(n)?n.includes(e):n===e}function ll(n,e){const t=np(e);return np(n).forEach(r=>{Mg(t,r)||t.push(r)}),t}function Ld(n,e){return np(e).filter(t=>!Mg(n,t))}class Nd{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=$h(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=cy(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class xs extends Nd{get formDirective(){return null}get path(){return null}}class au extends Nd{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class dy{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let hy=(()=>{class n extends dy{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(au,2))},n.\u0275dir=u.lG2({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,i){2&t&&u.ekj("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[u.qOj]}),n})(),Dg=(()=>{class n extends dy{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(xs,10))},n.\u0275dir=u.lG2({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,i){2&t&&u.ekj("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[u.qOj]}),n})();function $x(n,e){return n?`with name: '${e}'`:`at index: ${e}`}const kg=!1,Qu="VALID",Rg="INVALID",zd="PENDING",ip="DISABLED";function Hh(n){return(my(n)?n.validators:n)||null}function Fg(n,e){return(my(e)?e.asyncValidators:n)||null}function my(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function qx(n,e,t){const i=n.controls;if(!(e?Object.keys(i):i).length)throw new u.vHH(1e3,kg?function Og(n){return`\n    There are no form controls registered with this ${n?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(e):"");if(!i[t])throw new u.vHH(1001,kg?function Gx(n,e){return`Cannot find form control ${$x(n,e)}`}(e,t):"")}function Zx(n,e,t){n._forEachChild((i,r)=>{if(void 0===t[r])throw new u.vHH(1002,kg?function Hx(n,e){return`Must supply a value for form control ${$x(n,e)}`}(e,r):"")})}class Bd{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Qu}get invalid(){return this.status===Rg}get pending(){return this.status==zd}get disabled(){return this.status===ip}get enabled(){return this.status!==ip}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(ll(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(ll(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Ld(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Ld(e,this._rawAsyncValidators))}hasValidator(e){return Mg(this._rawValidators,e)}hasAsyncValidator(e){return Mg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=zd,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=ip,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Qu,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Qu||this.status===zd)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ip:Qu}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=zd,this._hasOwnPendingAsyncValidator=!0;const t=Rx(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new u.vpe,this.statusChanges=new u.vpe}_calculateStatus(){return this._allControlsDisabled()?ip:this.errors?Rg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(zd)?zd:this._anyControlsHaveStatus(Rg)?Rg:Qu}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){my(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function py(n){return Array.isArray(n)?$h(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function lC(n){return Array.isArray(n)?cy(n):n||null}(this._rawAsyncValidators)}}class rp extends Bd{constructor(e,t,i){super(Hh(t),Fg(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){Zx(this,!0,e),Object.keys(e).forEach(i=>{qx(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(i=>{const r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,s)=>{i=t(i,r,s)}),i}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class l0 extends rp{}const Cm=new u.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>Ll}),Ll="always";function Vd(n,e,t=Ll){_y(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function Lg(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&qh(n,e)})}(n,e),function Zh(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function Ho(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&qh(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function c0(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function op(n,e,t=!0){const i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),ks(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Em(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function _y(n,e){const t=zx(n);null!==e.validator?n.setValidators(Nx(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=uy(n);null!==e.asyncValidator?n.setAsyncValidators(Nx(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();Em(e._rawValidators,r),Em(e._rawAsyncValidators,r)}function ks(n,e){let t=!1;if(null!==n){if(null!==e.validator){const r=zx(n);if(Array.isArray(r)&&r.length>0){const s=r.filter(f=>f!==e.validator);s.length!==r.length&&(t=!0,n.setValidators(s))}}if(null!==e.asyncValidator){const r=uy(n);if(Array.isArray(r)&&r.length>0){const s=r.filter(f=>f!==e.asyncValidator);s.length!==r.length&&(t=!0,n.setAsyncValidators(s))}}}const i=()=>{};return Em(e._rawValidators,i),Em(e._rawAsyncValidators,i),t}function qh(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function Js(n,e){_y(n,e)}function Yh(n,e){n._syncPendingControls(),e.forEach(t=>{const i=t.control;"submit"===i.updateOn&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}const Qx={provide:xs,useExisting:(0,u.Gpc)(()=>zg)},ap=(()=>Promise.resolve())();let zg=(()=>{class n extends xs{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new u.vpe,this.form=new rp({},$h(t),cy(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){ap.then(()=>{const i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),Vd(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){ap.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){ap.then(()=>{const i=this._findContainer(t.path),r=new rp({});Js(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){ap.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){ap.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,Yh(this.form,this._directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(Ar,10),u.Y36(Yu,10),u.Y36(Cm,8))},n.\u0275dir=u.lG2({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,i){1&t&&u.NdJ("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[u._Bn([Qx]),u.qOj]}),n})();function yy(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function u0(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const Im=class extends Bd{constructor(e=null,t,i){super(Hh(t),Fg(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),my(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=u0(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){yy(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){yy(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){u0(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};let f0=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=u.lG2({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),Xh=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({}),n})();const Ty=new u.OlP("NgModelWithFormControlWarning"),Hd={provide:xs,useExisting:(0,u.Gpc)(()=>ba)};let ba=(()=>{class n extends xs{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new u.vpe,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(ks(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const i=this.form.get(t.path);return Vd(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){op(t.control||null,t,!1),function Kx(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this.submitted=!0,Yh(this.form,this.directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const i=t.control,r=this.form.get(t.path);i!==r&&(op(i||null,t),(n=>n instanceof Im)(r)&&(Vd(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const i=this.form.get(t.path);Js(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const i=this.form.get(t.path);i&&function sp(n,e){return ks(n,e)}(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){_y(this.form,this),this._oldForm&&ks(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(Ar,10),u.Y36(Yu,10),u.Y36(Cm,8))},n.\u0275dir=u.lG2({type:n,selectors:[["","formGroup",""]],hostBindings:function(t,i){1&t&&u.NdJ("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[u._Bn([Hd]),u.qOj,u.TTD]}),n})();const Iy={provide:au,useExisting:(0,u.Gpc)(()=>Gg)};let Gg=(()=>{class n extends au{set isDisabled(t){}constructor(t,i,r,s,f){super(),this._ngModelWarningConfig=f,this._added=!1,this.update=new u.vpe,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function $d(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===ym?t=s:function Tm(n){return Object.getPrototypeOf(n.constructor)===Fd}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){this._added||this._setUpControl(),function lu(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return function gy(n,e){return[...e.path,n]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(t){return new(t||n)(u.Y36(xs,13),u.Y36(Ar,10),u.Y36(Yu,10),u.Y36(Kr,10),u.Y36(Ty,8))},n.\u0275dir=u.lG2({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[u._Bn([Iy]),u.qOj,u.TTD]}),n})(),o=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[Xh]}),n})();class l extends Bd{constructor(e,t,i){super(Hh(t),Fg(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){Zx(this,!1,e),e.forEach((i,r)=>{qx(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>!!i._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function w(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let E=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const t=new n;return t.useNonNullable=!0,t}group(t,i=null){const r=this._reduceControls(t);let s={};return w(i)?s=i:null!==i&&(s.validators=i.validator,s.asyncValidators=i.asyncValidator),new rp(r,s)}record(t,i=null){const r=this._reduceControls(t);return new l0(r,i)}control(t,i,r){let s={};return this.useNonNullable?(w(i)?s=i:(s.validators=i,s.asyncValidators=r),new Im(t,{...s,nonNullable:!0})):new Im(t,i,r)}array(t,i,r){const s=t.map(f=>this._createControl(f));return new l(s,i,r)}_reduceControls(t){const i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){return t instanceof Im||t instanceof Bd?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),U=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Cm,useValue:t.callSetDisabledState??Ll}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[o]}),n})(),W=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Ty,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Cm,useValue:t.callSetDisabledState??Ll}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[o]}),n})();var me,V=De(5861),Q=De(9681),ie=De(4859),se=De(1877),te=De(2090),we=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Oe={},Ae=Ae||{},Ee=we||self;function Re(){}function lt(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function tt(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var jt="closure_uid_"+(1e9*Math.random()>>>0),ht=0;function Tt(n,e,t){return n.call.apply(n.bind,arguments)}function At(n,e,t){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),n.apply(e,r)}}return function(){return n.apply(e,arguments)}}function Et(n,e,t){return(Et=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Tt:At).apply(null,arguments)}function Vt(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function ot(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(i,r,s){for(var f=Array(arguments.length-2),b=2;b<arguments.length;b++)f[b-2]=arguments[b];return e.prototype[r].apply(i,f)}}function tn(){this.s=this.s,this.o=this.o}tn.prototype.s=!1,tn.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function wt(n){Object.prototype.hasOwnProperty.call(n,jt)&&n[jt]||(n[jt]=++ht)}(this)},tn.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const mn=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function Dn(n){const e=n.length;if(0<e){const t=Array(e);for(let i=0;i<e;i++)t[i]=n[i];return t}return[]}function ln(n,e){for(let t=1;t<arguments.length;t++){const i=arguments[t];if(lt(i)){const r=n.length||0,s=i.length||0;n.length=r+s;for(let f=0;f<s;f++)n[r+f]=i[f]}else n.push(i)}}function kn(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}kn.prototype.h=function(){this.defaultPrevented=!0};var Li=function(){if(!Ee.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{Ee.addEventListener("test",Re,e),Ee.removeEventListener("test",Re,e)}catch{}return n}();function Di(n){return/^[\s\xa0]*$/.test(n)}var Pi=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function ni(n,e){return n<e?-1:n>e?1:0}function mr(){var n=Ee.navigator;return n&&(n=n.userAgent)?n:""}function ei(n){return-1!=mr().indexOf(n)}function ki(n){return ki[" "](n),n}ki[" "]=Re;var Mo,n,Vr=ei("Opera"),_r=ei("Trident")||ei("MSIE"),Lr=ei("Edge"),Nr=Lr||_r,vo=ei("Gecko")&&!(-1!=mr().toLowerCase().indexOf("webkit")&&!ei("Edge"))&&!(ei("Trident")||ei("MSIE"))&&!ei("Edge"),Rs=-1!=mr().toLowerCase().indexOf("webkit")&&!ei("Edge");function yr(){var n=Ee.document;return n?n.documentMode:void 0}e:{var Do="",nr=(n=mr(),vo?/rv:([^\);]+)(\)|;)/.exec(n):Lr?/Edge\/([\d\.]+)/.exec(n):_r?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Rs?/WebKit\/(\S+)/.exec(n):Vr?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(nr&&(Do=nr?nr[1]:""),_r){var Ur=yr();if(null!=Ur&&Ur>parseFloat(Do)){Mo=String(Ur);break e}}Mo=Do}var ts={};var ws=Ee.document&&_r&&(yr()||parseInt(Mo,10))||void 0;function zo(n,e){if(kn.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(vo){e:{try{ki(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:ea[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&zo.X.h.call(this)}}ot(zo,kn);var ea={2:"touch",3:"pen",4:"mouse"};zo.prototype.h=function(){zo.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Bo="closure_listenable_"+(1e6*Math.random()|0),cu=0;function up(n,e,t,i,r){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!i,this.ha=r,this.key=++cu,this.ba=this.ea=!1}function cl(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function dp(n,e,t){for(const i in n)e.call(t,n[i],i,n)}function I0(n){const e={};for(const t in n)e[t]=n[t];return e}const Jh="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ow(n,e){let t,i;for(let r=1;r<arguments.length;r++){for(t in i=arguments[r],i)n[t]=i[t];for(let s=0;s<Jh.length;s++)t=Jh[s],Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}}function ef(n){this.src=n,this.g={},this.h=0}function Ay(n,e){var t=e.type;if(t in n.g){var s,i=n.g[t],r=mn(i,e);(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(cl(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Bl(n,e,t,i){for(var r=0;r<n.length;++r){var s=n[r];if(!s.ba&&s.listener==e&&s.capture==!!t&&s.ha==i)return r}return-1}ef.prototype.add=function(n,e,t,i,r){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var f=Bl(n,e,i,r);return-1<f?(e=n[f],t||(e.ea=!1)):((e=new up(e,this.src,s,!!i,r)).ea=t,n.push(e)),e};var Zg="closure_lm_"+(1e6*Math.random()|0),tf={};function fi(n,e,t,i,r){if(i&&i.once)return Oy(n,e,t,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)fi(n,e[s],t,i,r);return null}return t=ed(t),n&&n[Bo]?n.N(e,t,tt(i)?!!i.capture:!!i,r):Py(n,e,t,!1,i,r)}function Py(n,e,t,i,r,s){if(!e)throw Error("Invalid event type");var f=tt(r)?!!r.capture:!!r,b=bo(n);if(b||(n[Zg]=b=new ef(n)),(t=b.add(e,t,i,f,s)).proxy)return t;if(i=function nf(){const e=rf;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=i,i.src=n,i.listener=t,n.addEventListener)Li||(r=f),void 0===r&&(r=!1),n.addEventListener(e.toString(),i,r);else if(n.attachEvent)n.attachEvent(Hs(e.toString()),i);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(i)}return t}function Oy(n,e,t,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Oy(n,e[s],t,i,r);return null}return t=ed(t),n&&n[Bo]?n.O(e,t,tt(i)?!!i.capture:!!i,r):Py(n,e,t,!0,i,r)}function hp(n,e,t,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)hp(n,e[s],t,i,r);else i=tt(i)?!!i.capture:!!i,t=ed(t),n&&n[Bo]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Bl(s=n.g[e],t,i,r))&&(cl(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=bo(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Bl(e,t,i,r)),(t=-1<n?e[n]:null)&&xa(t))}function xa(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[Bo])Ay(e.i,n);else{var t=n.type,i=n.proxy;e.removeEventListener?e.removeEventListener(t,i,n.capture):e.detachEvent?e.detachEvent(Hs(t),i):e.addListener&&e.removeListener&&e.removeListener(i),(t=bo(e))?(Ay(t,n),0==t.h&&(t.src=null,e[Zg]=null)):cl(n)}}}function Hs(n){return n in tf?tf[n]:tf[n]="on"+n}function rf(n,e){if(n.ba)n=!0;else{e=new zo(e,this);var t=n.listener,i=n.ha||n.src;n.ea&&xa(n),n=t.call(i,e)}return n}function bo(n){return(n=n[Zg])instanceof ef?n:null}var S0="__closure_events_fn_"+(1e9*Math.random()>>>0);function ed(n){return"function"==typeof n?n:(n[S0]||(n[S0]=function(e){return n.handleEvent(e)}),n[S0])}function ta(){tn.call(this),this.i=new ef(this),this.P=this,this.I=null}function $a(n,e){var t,i=n.I;if(i)for(t=[];i;i=i.I)t.push(i);if(n=n.P,i=e.type||e,"string"==typeof e)e=new kn(e,n);else if(e instanceof kn)e.target=e.target||n;else{var r=e;ow(e=new kn(i,n),r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var f=e.g=t[s];r=M0(f,i,!0,e)&&r}if(r=M0(f=e.g=n,i,!0,e)&&r,r=M0(f,i,!1,e)&&r,t)for(s=0;s<t.length;s++)r=M0(f=e.g=t[s],i,!1,e)&&r}function M0(n,e,t,i){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var f=e[s];if(f&&!f.ba&&f.capture==t){var b=f.listener,I=f.ha||f.src;f.ea&&Ay(n.i,f),r=!1!==b.call(I,i)&&r}}return r&&!i.defaultPrevented}ot(ta,tn),ta.prototype[Bo]=!0,ta.prototype.removeEventListener=function(n,e,t,i){hp(this,n,e,t,i)},ta.prototype.M=function(){if(ta.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],i=0;i<t.length;i++)cl(t[i]);delete n.g[e],n.h--}}this.I=null},ta.prototype.N=function(n,e,t,i){return this.i.add(String(n),e,!1,t,i)},ta.prototype.O=function(n,e,t,i){return this.i.add(String(n),e,!0,t,i)};var sw=Ee.JSON.stringify;function YT(){var n=D0;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var pC,XT=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new XD,n=>n.reset());class XD{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function QD(n){Ee.setTimeout(()=>{throw n},0)}function ky(n,e){pC||function JD(){var n=Ee.Promise.resolve(void 0);pC=function(){n.then(QT)}}(),mC||(pC(),mC=!0),D0.add(n,e)}var mC=!1,D0=new class KT{constructor(){this.h=this.g=null}add(e,t){const i=XT.get();i.set(e,t),this.h?this.h.next=i:this.g=i,this.h=i}};function QT(){for(var n;n=YT();){try{n.h.call(n.g)}catch(t){QD(t)}var e=XT;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}mC=!1}function A0(n,e){ta.call(this),this.h=n||1,this.g=e||Ee,this.j=Et(this.lb,this),this.l=Date.now()}function aw(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function gC(n,e,t){if("function"==typeof n)t&&(n=Et(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Et(n.handleEvent,n)}return 2147483647<Number(e)?-1:Ee.setTimeout(n,e||0)}function Ry(n){n.g=gC(()=>{n.g=null,n.i&&(n.i=!1,Ry(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}ot(A0,ta),(me=A0.prototype).ca=!1,me.R=null,me.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),$a(this,"tick"),this.ca&&(aw(this),this.start()))}},me.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},me.M=function(){A0.X.M.call(this),aw(this),delete this.g};class P0 extends tn{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Ry(this)}M(){super.M(),this.g&&(Ee.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function O0(n){tn.call(this),this.h=n,this.g={}}ot(O0,tn);var JT=[];function eI(n,e,t,i){Array.isArray(t)||(t&&(JT[0]=t.toString()),t=JT);for(var r=0;r<t.length;r++){var s=fi(e,t[r],i||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function _C(n){dp(n.g,function(e,t){this.g.hasOwnProperty(t)&&xa(e)},n),n.g={}}function k0(){this.g=!0}function Wg(n,e,t,i){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function nA(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var i=t[n];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var f=1;f<r.length;f++)r[f]=""}}}return sw(t)}catch{return e}}(n,t)+(i?" "+i:"")})}O0.prototype.M=function(){O0.X.M.call(this),_C(this)},O0.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},k0.prototype.Aa=function(){this.g=!1},k0.prototype.info=function(){};var Fy={},iA=null;function yC(){return iA=iA||new ta}function rA(n){kn.call(this,Fy.Pa,n)}function Ly(n){const e=yC();$a(e,new rA(e))}function R0(n,e){kn.call(this,Fy.STAT_EVENT,n),this.stat=e}function Vl(n){const e=yC();$a(e,new R0(e,n))}function nI(n,e){kn.call(this,Fy.Qa,n),this.size=e}function Ny(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Ee.setTimeout(function(){n()},e)}Fy.Pa="serverreachability",ot(rA,kn),Fy.STAT_EVENT="statevent",ot(R0,kn),Fy.Qa="timingevent",ot(nI,kn);var Pm={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},iI={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function vC(){}function oI(){}vC.prototype.h=null;var xC,lw={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function bC(){kn.call(this,"d")}function cw(){kn.call(this,"c")}function uw(){}function fp(n,e,t,i){this.l=n,this.j=e,this.m=t,this.U=i||1,this.S=new O0(this),this.O=aI,this.T=new A0(n=Nr?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new sI}function sI(){this.i=null,this.g="",this.h=!1}ot(bC,kn),ot(cw,kn),ot(uw,vC),uw.prototype.g=function(){return new XMLHttpRequest},uw.prototype.i=function(){return{}},xC=new uw;var aI=45e3,wC={},F0={};function CC(n,e,t){n.K=1,n.v=z0(pp(e)),n.s=t,n.P=!0,EC(n,null)}function EC(n,e){n.F=Date.now(),zy(n),n.A=pp(n.v);var t=n.A,i=n.U;Array.isArray(i)||(i=[String(i)]),mw(t.i,"t",i),n.C=0,t=n.l.H,n.h=new sI,n.g=OI(n.l,t?e:null,!n.s),0<n.N&&(n.L=new P0(Et(n.La,n,n.g),n.N)),eI(n.S,n.g,"readystatechange",n.ib),e=n.H?I0(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),Ly(),function tI(n,e,t,i,r,s){n.info(function(){if(n.g)if(s)for(var f="",b=s.split("&"),I=0;I<b.length;I++){var O=b[I].split("=");if(1<O.length){var B=O[0];O=O[1];var K=B.split("_");f=2<=K.length&&"type"==K[1]?f+(B+"=")+O+"&":f+(B+"=redacted&")}}else f=null;else f=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+t+"\n"+f})}(n.j,n.u,n.A,n.m,n.U,n.s)}function lI(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function dw(n,e,t){let r,i=!0;for(;!n.I&&n.C<t.length;){if(r=oA(n,t),r==F0){4==e&&(n.o=4,Vl(14),i=!1),Wg(n.j,n.m,null,"[Incomplete Response]");break}if(r==wC){n.o=4,Vl(15),Wg(n.j,n.m,t,"[Invalid Chunk]"),i=!1;break}Wg(n.j,n.m,r,null),N0(n,r)}lI(n)&&r!=F0&&r!=wC&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Vl(16),i=!1),n.i=n.i&&i,i?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),bw(e),e.K=!0,Vl(11))):(Wg(n.j,n.m,t,"[Invalid Chunked Response]"),Yg(n),L0(n))}function oA(n,e){var t=n.C,i=e.indexOf("\n",t);return-1==i?F0:(t=Number(e.substring(t,i)),isNaN(t)?wC:(i+=1)+t>e.length?F0:(e=e.substr(i,t),n.C=i+t,e))}function zy(n){n.V=Date.now()+n.O,TC(n,n.O)}function TC(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Ny(Et(n.gb,n),e)}function hw(n){n.B&&(Ee.clearTimeout(n.B),n.B=null)}function L0(n){0==n.l.G||n.I||PI(n.l,n)}function Yg(n){hw(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,aw(n.T),_C(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function N0(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||U0(t.h,n)))if(!n.J&&U0(t.h,n)&&3==t.G){try{var i=t.Fa.g.parse(e)}catch{i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;xw(t),H0(t)}zC(t),Vl(18)}}else t.Ba=r[1],0<t.Ba-t.T&&37500>r[2]&&t.L&&0==t.A&&!t.v&&(t.v=Ny(Et(t.cb,t),6e3));if(1>=DC(t.h)&&t.ja){try{t.ja()}catch{}t.ja=void 0}}else Qg(t,11)}else if((n.J||t.g==n)&&xw(t),!Di(e))for(r=t.Fa.g.parse(e),e=0;e<r.length;e++){let O=r[e];if(t.T=O[0],O=O[1],2==t.G)if("c"==O[0]){t.I=O[1],t.ka=O[2];const B=O[3];null!=B&&(t.ma=B,t.j.info("VER="+t.ma));const K=O[4];null!=K&&(t.Ca=K,t.j.info("SVER="+t.Ca));const le=O[5];null!=le&&"number"==typeof le&&0<le&&(t.J=i=1.5*le,t.j.info("backChannelRequestTimeoutMs_="+i)),i=t;const ge=n.g;if(ge){const Te=ge.g?ge.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Te){var s=i.h;s.g||-1==Te.indexOf("spdy")&&-1==Te.indexOf("quic")&&-1==Te.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(AC(s,s.h),s.h=null))}if(i.D){const Ge=ge.g?ge.g.getResponseHeader("X-HTTP-Session-Id"):null;Ge&&(i.za=Ge,qo(i.F,i.D,Ge))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var f=n;if((i=t).sa=Wd(i,i.H?i.ka:null,i.V),f.J){gw(i.h,f);var b=f,I=i.J;I&&b.setTimeout(I),b.B&&(hw(b),zy(b)),i.g=f}else pA(i);0<t.i.length&&q0(t)}else"stop"!=O[0]&&"close"!=O[0]||Qg(t,7);else 3==t.G&&("stop"==O[0]||"close"==O[0]?"stop"==O[0]?Qg(t,7):Xg(t):"noop"!=O[0]&&t.l&&t.l.wa(O),t.A=0)}Ly()}catch{}}function uI(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(lt(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function cI(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(lt(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const i in n)e[t++]=i;return e}}}(n),i=function sA(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(lt(n)){for(var e=[],t=n.length,i=0;i<t;i++)e.push(n[i]);return e}for(i in e=[],t=0,n)e[t++]=n[i];return e}(n),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],t&&t[s],n)}(me=fp.prototype).setTimeout=function(n){this.O=n},me.ib=function(n){n=n.target;const e=this.L;e&&3==mp(n)?e.l():this.La(n)},me.La=function(n){try{if(n==this.g)e:{const B=mp(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>B)&&(3!=B||Nr||this.g&&(this.h.h||this.g.fa()||TI(this.g)))){this.I||4!=B||7==e||Ly(),hw(this);var t=this.g.aa();this.Y=t;t:if(lI(this)){var i=TI(this.g);n="";var r=i.length,s=4==mp(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Yg(this),L0(this);var f="";break t}this.h.i=new Ee.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,n+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=n,this.C=0,f=this.h.g}else f=this.g.fa();if(this.i=200==t,function eA(n,e,t,i,r,s,f){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+t+"\n"+s+" "+f})}(this.j,this.u,this.A,this.m,this.U,B,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var b,I=this.g;if((b=I.g?I.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Di(b)){var O=b;break t}}O=null}if(!(t=O)){this.i=!1,this.o=3,Vl(12),Yg(this),L0(this);break e}Wg(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,N0(this,t)}this.P?(dw(this,B,f),Nr&&this.i&&3==B&&(eI(this.S,this.T,"tick",this.hb),this.T.start())):(Wg(this.j,this.m,f,null),N0(this,f)),4==B&&Yg(this),this.i&&!this.I&&(4==B?PI(this.l,this):(this.i=!1,zy(this)))}else 400==t&&0<f.indexOf("Unknown SID")?(this.o=3,Vl(12)):(this.o=0,Vl(13)),Yg(this),L0(this)}}}catch{}},me.hb=function(){if(this.g){var n=mp(this.g),e=this.g.fa();this.C<e.length&&(hw(this),dw(this,n,e),this.i&&4!=n&&zy(this))}},me.cancel=function(){this.I=!0,Yg(this)},me.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function tA(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Ly(),Vl(17)),Yg(this),this.o=2,L0(this)):TC(this,this.V-n)};var dI=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Kg(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Kg){this.h=void 0!==e?e:n.h,fw(this,n.j),this.s=n.s,this.g=n.g,pw(this,n.m),this.l=n.l,e=n.i;var t=new By;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),hI(this,t),this.o=n.o}else n&&(t=String(n).match(dI))?(this.h=!!e,fw(this,t[1]||"",!0),this.s=B0(t[2]||""),this.g=B0(t[3]||"",!0),pw(this,t[4]),this.l=B0(t[5]||"",!0),hI(this,t[6]||"",!0),this.o=B0(t[7]||"")):(this.h=!!e,this.i=new By(null,this.h))}function pp(n){return new Kg(n)}function fw(n,e,t){n.j=t?B0(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function pw(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function hI(n,e,t){e instanceof By?(n.i=e,function _I(n,e){e&&!n.j&&(sf(n),n.i=null,n.g.forEach(function(t,i){var r=i.toLowerCase();i!=r&&(mI(this,i),mw(this,r,t))},n)),n.j=e}(n.i,n.h)):(t||(e=V0(e,IC)),n.i=new By(e,n.h))}function qo(n,e,t){n.i.set(e,t)}function z0(n){return qo(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function B0(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function V0(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,fI),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function fI(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Kg.prototype.toString=function(){var n=[],e=this.j;e&&n.push(V0(e,pI,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(V0(e,pI,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(V0(t,"/"==t.charAt(0)?cA:lA,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",V0(t,SC)),n.join("")};var pI=/[#\/\?@]/g,lA=/[#\?:]/g,cA=/[#\?]/g,IC=/[#\?@]/g,SC=/#/g;function By(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function sf(n){n.g||(n.g=new Map,n.h=0,n.i&&function aA(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var i=n[t].indexOf("="),r=null;if(0<=i){var s=n[t].substring(0,i);r=n[t].substring(i+1)}else s=n[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function mI(n,e){sf(n),e=Vy(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function gI(n,e){return sf(n),e=Vy(n,e),n.g.has(e)}function mw(n,e,t){mI(n,e),0<t.length&&(n.i=null,n.g.set(Vy(n,e),Dn(t)),n.h+=t.length)}function Vy(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function MC(n){this.l=n||uA,n=Ee.PerformanceNavigationTiming?0<(n=Ee.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Ee.g&&Ee.g.Ga&&Ee.g.Ga()&&Ee.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(me=By.prototype).add=function(n,e){sf(this),this.i=null,n=Vy(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},me.forEach=function(n,e){sf(this),this.g.forEach(function(t,i){t.forEach(function(r){n.call(e,r,i,this)},this)},this)},me.oa=function(){sf(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let i=0;i<e.length;i++){const r=n[i];for(let s=0;s<r.length;s++)t.push(e[i])}return t},me.W=function(n){sf(this);let e=[];if("string"==typeof n)gI(this,n)&&(e=e.concat(this.g.get(Vy(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},me.set=function(n,e){return sf(this),this.i=null,gI(this,n=Vy(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},me.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},me.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var i=e[t];const s=encodeURIComponent(String(i)),f=this.W(i);for(i=0;i<f.length;i++){var r=s;""!==f[i]&&(r+="="+encodeURIComponent(String(f[i]))),n.push(r)}}return this.i=n.join("&")};var uA=10;function dA(n){return!!n.h||!!n.g&&n.g.size>=n.j}function DC(n){return n.h?1:n.g?n.g.size:0}function U0(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function AC(n,e){n.g?n.g.add(e):n.h=e}function gw(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function yI(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return Dn(n.i)}function _w(){}function PC(){this.g=new _w}function vI(n,e,t){const i=t||"";try{uI(n,function(r,s){let f=r;tt(r)&&(f=sw(r)),e.push(i+s+"="+encodeURIComponent(f))})}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function j0(n,e,t,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch{}}function jy(n){this.l=n.ac||null,this.j=n.jb||!1}function yw(n,e){ta.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=OC,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}MC.prototype.cancel=function(){if(this.i=yI(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},_w.prototype.stringify=function(n){return Ee.JSON.stringify(n,void 0)},_w.prototype.parse=function(n){return Ee.JSON.parse(n,void 0)},ot(jy,vC),jy.prototype.g=function(){return new yw(this.l,this.j)},jy.prototype.i=function(n){return function(){return n}}({}),ot(yw,ta);var OC=0;function xI(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function $0(n){n.readyState=4,n.l=null,n.j=null,n.A=null,$y(n)}function $y(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(me=yw.prototype).open=function(n,e){if(this.readyState!=OC)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,$y(this)},me.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||Ee).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},me.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,$0(this)),this.readyState=OC},me.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,$y(this)),this.g&&(this.readyState=3,$y(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof Ee.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;xI(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},me.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?$0(this):$y(this),3==this.readyState&&xI(this)}},me.Va=function(n){this.g&&(this.response=this.responseText=n,$0(this))},me.Ua=function(n){this.g&&(this.response=n,$0(this))},me.ga=function(){this.g&&$0(this)},me.setRequestHeader=function(n,e){this.v.append(n,e)},me.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},me.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(yw.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var OL=Ee.JSON.parse;function hs(n){ta.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=wI,this.K=this.L=!1}ot(hs,ta);var wI="",hA=/^https?$/i,kL=["POST","PUT"];function CI(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,kC(n),vw(n)}function kC(n){n.D||(n.D=!0,$a(n,"complete"),$a(n,"error"))}function RC(n){if(n.h&&typeof Ae<"u"&&(!n.C[1]||4!=mp(n)||2!=n.aa()))if(n.v&&4==mp(n))gC(n.Ha,0,n);else if($a(n,"readystatechange"),4==mp(n)){n.h=!1;try{const b=n.aa();e:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var i;if(i=0===b){var r=String(n.H).match(dI)[1]||null;if(!r&&Ee.self&&Ee.self.location){var s=Ee.self.location.protocol;r=s.substr(0,s.length-1)}i=!hA.test(r?r.toLowerCase():"")}t=i}if(t)$a(n,"complete"),$a(n,"success");else{n.m=6;try{var f=2<mp(n)?n.g.statusText:""}catch{f=""}n.j=f+" ["+n.aa()+"]",kC(n)}}finally{vw(n)}}}function vw(n,e){if(n.g){EI(n);const t=n.g,i=n.C[0]?Re:null;n.g=null,n.C=null,e||$a(n,"ready");try{t.onreadystatechange=i}catch{}}}function EI(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(Ee.clearTimeout(n.A),n.A=null)}function mp(n){return n.g?n.g.readyState:0}function TI(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case wI:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function II(n){let e="";return dp(n,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function FC(n,e,t){e:{for(i in t){var i=!1;break e}i=!0}i||(t=II(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):qo(n,e,t))}function G0(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function SI(n){this.Ca=0,this.i=[],this.j=new k0,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=G0("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=G0("baseRetryDelayMs",5e3,n),this.bb=G0("retryDelaySeedMs",1e4,n),this.$a=G0("forwardChannelMaxRetries",2,n),this.ta=G0("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new MC(n&&n.concurrentRequestLimit),this.Fa=new PC,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Xg(n){if(LC(n),3==n.G){var e=n.U++,t=pp(n.F);qo(t,"SID",n.I),qo(t,"RID",e),qo(t,"TYPE","terminate"),Gy(n,t),(e=new fp(n,n.j,e,void 0)).K=2,e.v=z0(pp(t)),t=!1,Ee.navigator&&Ee.navigator.sendBeacon&&(t=Ee.navigator.sendBeacon(e.v.toString(),"")),!t&&Ee.Image&&((new Image).src=e.v,t=!0),t||(e.g=OI(e.l,null),e.g.da(e.v)),e.F=Date.now(),zy(e)}ww(n)}function H0(n){n.g&&(bw(n),n.g.cancel(),n.g=null)}function LC(n){H0(n),n.u&&(Ee.clearTimeout(n.u),n.u=null),xw(n),n.h.cancel(),n.m&&("number"==typeof n.m&&Ee.clearTimeout(n.m),n.m=null)}function q0(n){dA(n.h)||n.m||(n.m=!0,ky(n.Ja,n),n.C=0)}function NC(n,e){var t;t=e?e.m:n.U++;const i=pp(n.F);qo(i,"SID",n.I),qo(i,"RID",t),qo(i,"AID",n.T),Gy(n,i),n.o&&n.s&&FC(i,n.o,n.s),t=new fp(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=DI(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),AC(n.h,t),CC(t,i,e)}function Gy(n,e){n.ia&&dp(n.ia,function(t,i){qo(e,i,t)}),n.l&&uI({},function(t,i){qo(e,i,t)})}function DI(n,e,t){t=Math.min(n.i.length,t);var i=n.l?Et(n.l.Ra,n.l,n):null;e:{var r=n.i;let s=-1;for(;;){const f=["count="+t];-1==s?0<t?(s=r[0].h,f.push("ofs="+s)):s=0:f.push("ofs="+s);let b=!0;for(let I=0;I<t;I++){let O=r[I].h;const B=r[I].g;if(O-=s,0>O)s=Math.max(0,r[I].h-100),b=!1;else try{vI(B,f,"req"+O+"_")}catch{i&&i(B)}}if(b){i=f.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,i}function pA(n){n.g||n.u||(n.Z=1,ky(n.Ia,n),n.A=0)}function zC(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Ny(Et(n.Ia,n),Hy(n,n.A)),n.A++,0))}function bw(n){null!=n.B&&(Ee.clearTimeout(n.B),n.B=null)}function AI(n){n.g=new fp(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=pp(n.sa);qo(e,"RID","rpc"),qo(e,"SID",n.I),qo(e,"CI",n.L?"0":"1"),qo(e,"AID",n.T),qo(e,"TYPE","xmlhttp"),Gy(n,e),n.o&&n.s&&FC(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=z0(pp(e)),t.s=null,t.P=!0,EC(t,n)}function xw(n){null!=n.v&&(Ee.clearTimeout(n.v),n.v=null)}function PI(n,e){var t=null;if(n.g==e){xw(n),bw(n),n.g=null;var i=2}else{if(!U0(n.h,e))return;t=e.D,gw(n.h,e),i=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==i){t=e.s?e.s.length:0,e=Date.now()-e.F;var r=n.C;$a(i=yC(),new nI(i,t)),q0(n)}else pA(n);else if(3==(r=e.o)||0==r&&0<n.pa||!(1==i&&function MI(n,e){return!(DC(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=Ny(Et(n.Ja,n,e),Hy(n,n.C)),n.C++,0)))}(n,e)||2==i&&zC(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),r){case 1:Qg(n,5);break;case 4:Qg(n,10);break;case 3:Qg(n,6);break;default:Qg(n,2)}}function Hy(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function Qg(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var i=Et(n.kb,n);t||(t=new Kg("//www.google.com/images/cleardot.gif"),Ee.location&&"http"==Ee.location.protocol||fw(t,"https"),z0(t)),function bI(n,e){const t=new k0;if(Ee.Image){const i=new Image;i.onload=Vt(j0,t,i,"TestLoadImage: loaded",!0,e),i.onerror=Vt(j0,t,i,"TestLoadImage: error",!1,e),i.onabort=Vt(j0,t,i,"TestLoadImage: abort",!1,e),i.ontimeout=Vt(j0,t,i,"TestLoadImage: timeout",!1,e),Ee.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else e(!1)}(t.toString(),i)}else Vl(2);n.G=0,n.l&&n.l.va(e),ww(n),LC(n)}function ww(n){if(n.G=0,n.la=[],n.l){const e=yI(n.h);(0!=e.length||0!=n.i.length)&&(ln(n.la,e),ln(n.la,n.i),n.h.i.length=0,Dn(n.i),n.i.length=0),n.l.ua()}}function Wd(n,e,t){var i=t instanceof Kg?pp(t):new Kg(t,void 0);if(""!=i.g)e&&(i.g=e+"."+i.g),pw(i,i.m);else{var r=Ee.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new Kg(null,void 0);i&&fw(s,i),e&&(s.g=e),r&&pw(s,r),t&&(s.l=t),i=s}return e=n.za,(t=n.D)&&e&&qo(i,t,e),qo(i,"VER",n.ma),Gy(n,i),i}function OI(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new hs(t&&n.Da&&!n.ra?new jy({jb:!0}):n.ra)).Ka(n.H),e}function Z0(){}function Om(){if(_r&&!(10<=Number(ws)))throw Error("Environmental error: no available transport.")}function uu(n,e){ta.call(this),this.g=new SI(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!Di(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Di(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new gp(this)}function kI(n){bC.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function RI(){cw.call(this),this.status=1}function gp(n){this.g=n}(me=hs.prototype).Ka=function(n){this.L=n},me.da=function(n,e,t,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():xC.g(),this.C=function rI(n){return n.h||(n.h=n.i())}(this.u?this.u:xC),this.g.onreadystatechange=Et(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(s){return void CI(this,s)}if(n=t||"",t=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)t.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const s of i.keys())t.set(s,i.get(s))}i=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),r=Ee.FormData&&n instanceof Ee.FormData,!(0<=mn(kL,e))||i||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,f]of t)this.g.setRequestHeader(s,f);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{EI(this),0<this.B&&((this.K=function fA(n){return _r&&function wr(){return function Ir(n){var e=ts;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=Pi(String(Mo)).split("."),t=Pi("9").split("."),i=Math.max(e.length,t.length);for(let f=0;0==n&&f<i;f++){var r=e[f]||"",s=t[f]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==r[0].length&&0==s[0].length)break;n=ni(0==r[1].length?0:parseInt(r[1],10),0==s[1].length?0:parseInt(s[1],10))||ni(0==r[2].length,0==s[2].length)||ni(r[2],s[2]),r=r[3],s=s[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Et(this.qa,this)):this.A=gC(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){CI(this,s)}},me.qa=function(){typeof Ae<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,$a(this,"timeout"),this.abort(8))},me.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,$a(this,"complete"),$a(this,"abort"),vw(this))},me.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),vw(this,!0)),hs.X.M.call(this)},me.Ha=function(){this.s||(this.F||this.v||this.l?RC(this):this.fb())},me.fb=function(){RC(this)},me.aa=function(){try{return 2<mp(this)?this.g.status:-1}catch{return-1}},me.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},me.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),OL(e)}},me.Ea=function(){return this.m},me.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(me=SI.prototype).ma=8,me.G=1,me.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const r=new fp(this,this.j,n,void 0);let s=this.s;if(this.S&&(s?(s=I0(s),ow(s,this.S)):s=this.S),null!==this.o||this.N||(r.H=s,s=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var i=this.i[t];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=DI(this,r,e),qo(t=pp(this.F),"RID",n),qo(t,"CVER",22),this.D&&qo(t,"X-HTTP-Session-Id",this.D),Gy(this,t),s&&(this.N?e="headers="+encodeURIComponent(String(II(s)))+"&"+e:this.o&&FC(t,this.o,s)),AC(this.h,r),this.Ya&&qo(t,"TYPE","init"),this.O?(qo(t,"$req",e),qo(t,"SID","null"),r.Z=!0,CC(r,t,null)):CC(r,t,e),this.G=2}}else 3==this.G&&(n?NC(this,n):0==this.i.length||dA(this.h)||NC(this))},me.Ia=function(){if(this.u=null,AI(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Ny(Et(this.eb,this),n)}},me.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Vl(10),H0(this),AI(this))},me.cb=function(){null!=this.v&&(this.v=null,H0(this),zC(this),Vl(19))},me.kb=function(n){n?(this.j.info("Successfully pinged google.com"),Vl(2)):(this.j.info("Failed to ping google.com"),Vl(1))},(me=Z0.prototype).xa=function(){},me.wa=function(){},me.va=function(){},me.ua=function(){},me.Ra=function(){},Om.prototype.g=function(n,e){return new uu(n,e)},ot(uu,ta),uu.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;Vl(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=Wd(n,null,n.V),q0(n)},uu.prototype.close=function(){Xg(this.g)},uu.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=sw(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.ab++,n)),3==e.G&&q0(e)},uu.prototype.M=function(){this.g.l=null,delete this.j,Xg(this.g),delete this.g,uu.X.M.call(this)},ot(kI,bC),ot(RI,cw),ot(gp,Z0),gp.prototype.xa=function(){$a(this.g,"a")},gp.prototype.wa=function(n){$a(this.g,new kI(n))},gp.prototype.va=function(n){$a(this.g,new RI)},gp.prototype.ua=function(){$a(this.g,"b")},Om.prototype.createWebChannel=Om.prototype.g,uu.prototype.send=uu.prototype.u,uu.prototype.open=uu.prototype.m,uu.prototype.close=uu.prototype.close,Pm.NO_ERROR=0,Pm.TIMEOUT=8,Pm.HTTP_ERROR=6,iI.COMPLETE="complete",oI.EventType=lw,lw.OPEN="a",lw.CLOSE="b",lw.ERROR="c",lw.MESSAGE="d",ta.prototype.listen=ta.prototype.N,hs.prototype.listenOnce=hs.prototype.O,hs.prototype.getLastError=hs.prototype.Oa,hs.prototype.getLastErrorCode=hs.prototype.Ea,hs.prototype.getStatus=hs.prototype.aa,hs.prototype.getResponseJson=hs.prototype.Sa,hs.prototype.getResponseText=hs.prototype.fa,hs.prototype.send=hs.prototype.da,hs.prototype.setWithCredentials=hs.prototype.Ka;var Cw=Oe.createWebChannelTransport=function(){return new Om},mA=Oe.getStatEventTarget=function(){return yC()},BC=Oe.ErrorCode=Pm,FI=Oe.EventType=iI,LI=Oe.Event=Fy,Ew=Oe.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},NI=Oe.FetchXmlHttpFactory=jy,qy=Oe.WebChannel=oI,VC=Oe.XhrIo=hs;const UC="@firebase/firestore";class qs{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}qs.UNAUTHENTICATED=new qs(null),qs.GOOGLE_CREDENTIALS=new qs("google-credentials-uid"),qs.FIRST_PARTY=new qs("first-party-uid"),qs.MOCK_USER=new qs("mock-user");let km="9.19.0";const Rm=new se.Yd("@firebase/firestore");function jC(){return Rm.logLevel}function sn(n,...e){if(Rm.logLevel<=se.in.DEBUG){const t=e.map(Tw);Rm.debug(`Firestore (${km}): ${n}`,...t)}}function Cs(n,...e){if(Rm.logLevel<=se.in.ERROR){const t=e.map(Tw);Rm.error(`Firestore (${km}): ${n}`,...t)}}function td(n,...e){if(Rm.logLevel<=se.in.WARN){const t=e.map(Tw);Rm.warn(`Firestore (${km}): ${n}`,...t)}}function Tw(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Hn(n="Unexpected state"){const e=`FIRESTORE (${km}) INTERNAL ASSERTION FAILED: `+n;throw Cs(e),new Error(e)}function ai(n,e){n||Hn()}function Rn(n,e){return n}const Ct={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Wt extends te.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class na{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class $C{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class BI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(qs.UNAUTHENTICATED))}shutdown(){}}class Ul{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Zy{constructor(e){this.t=e,this.currentUser=qs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var i=this;let r=this.i;const s=O=>this.i!==r?(r=this.i,t(O)):Promise.resolve();let f=new na;this.o=()=>{this.i++,this.currentUser=this.u(),f.resolve(),f=new na,e.enqueueRetryable(()=>s(this.currentUser))};const b=()=>{const O=f;e.enqueueRetryable((0,V.Z)(function*(){yield O.promise,yield s(i.currentUser)}))},I=O=>{sn("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=O,this.auth.addAuthTokenListener(this.o),b()};this.t.onInit(O=>I(O)),setTimeout(()=>{if(!this.auth){const O=this.t.getImmediate({optional:!0});O?I(O):(sn("FirebaseAuthCredentialsProvider","Auth not yet detected"),f.resolve(),f=new na)}},0),b()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(sn("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ai("string"==typeof i.accessToken),new $C(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ai(null===e||"string"==typeof e),new qs(e)}}class _A{constructor(e,t,i){this.h=e,this.l=t,this.m=i,this.type="FirstParty",this.user=qs.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class yA{constructor(e,t,i){this.h=e,this.l=t,this.m=i}getToken(){return Promise.resolve(new _A(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(qs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class vA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class RL{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const i=s=>{null!=s.error&&sn("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const f=s.token!==this.T;return this.T=s.token,sn("FirebaseAppCheckTokenProvider",`Received ${f?"new":"existing"} token.`),f?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{sn("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?r(s):sn("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ai("string"==typeof t.token),this.T=t.token,new vA(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function GC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Wy{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const r=GC(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}}function $i(n,e){return n<e?-1:n>e?1:0}function Fm(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}function VI(n){return n+"\0"}class Vo{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Wt(Ct.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Wt(Ct.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Wt(Ct.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Wt(Ct.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Vo.fromMillis(Date.now())}static fromDate(e){return Vo.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Vo(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?$i(this.nanoseconds,e.nanoseconds):$i(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class pi{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pi(e)}static min(){return new pi(new Vo(0,0))}static max(){return new pi(new Vo(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class W0{constructor(e,t,i){void 0===t?t=0:t>e.length&&Hn(),void 0===i?i=e.length-t:i>e.length-t&&Hn(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return 0===W0.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof W0?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=e.get(r),f=t.get(r);if(s<f)return-1;if(s>f)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Pr extends W0{construct(e,t,i){return new Pr(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Wt(Ct.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new Pr(t)}static emptyPath(){return new Pr([])}}const HC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fs extends W0{construct(e,t,i){return new fs(e,t,i)}static isValidIdentifier(e){return HC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fs.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new fs(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(0===i.length)throw new Wt(Ct.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let f=!1;for(;r<e.length;){const b=e[r];if("\\"===b){if(r+1===e.length)throw new Wt(Ct.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const I=e[r+1];if("\\"!==I&&"."!==I&&"`"!==I)throw new Wt(Ct.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=I,r+=2}else"`"===b?(f=!f,r++):"."!==b||f?(i+=b,r++):(s(),r++)}if(s(),f)throw new Wt(Ct.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fs(t)}static emptyPath(){return new fs([])}}class Pn{constructor(e){this.path=e}static fromPath(e){return new Pn(Pr.fromString(e))}static fromName(e){return new Pn(Pr.fromString(e).popFirst(5))}static empty(){return new Pn(Pr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Pr.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Pr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Pn(new Pr(e.slice()))}}class Jg{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Y0(n){return n.fields.find(e=>2===e.kind)}function Yy(n){return n.fields.filter(e=>2!==e.kind)}Jg.UNKNOWN_ID=-1;class Iw{constructor(e,t){this.fieldPath=e,this.kind=t}}class af{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new af(0,jl.min())}}function $I(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=pi.fromTimestamp(1e9===i?new Vo(t+1,0):new Vo(t,i));return new jl(r,Pn.empty(),e)}function qC(n){return new jl(n.readTime,n.key,-1)}class jl{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new jl(pi.min(),Pn.empty(),-1)}static max(){return new jl(pi.max(),Pn.empty(),-1)}}function GI(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=Pn.comparator(n.documentKey,e.documentKey),0!==t?t:$i(n.largestBatchId,e.largestBatchId))}const HI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Lm(n){return ZC.apply(this,arguments)}function ZC(){return ZC=(0,V.Z)(function*(n){if(n.code!==Ct.FAILED_PRECONDITION||n.message!==HI)throw n;sn("LocalStore","Unexpectedly lost primary lease")}),ZC.apply(this,arguments)}class bt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Hn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new bt((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof bt?t:bt.resolve(t)}catch(t){return bt.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):bt.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):bt.reject(t)}static resolve(e){return new bt((t,i)=>{t(e)})}static reject(e){return new bt((t,i)=>{i(e)})}static waitFor(e){return new bt((t,i)=>{let r=0,s=0,f=!1;e.forEach(b=>{++r,b.next(()=>{++s,f&&s===r&&t()},I=>i(I))}),f=!0,s===r&&t()})}static or(e){let t=bt.resolve(!1);for(const i of e)t=t.next(r=>r?bt.resolve(r):i());return t}static forEach(e,t){const i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new bt((i,r)=>{const s=e.length,f=new Array(s);let b=0;for(let I=0;I<s;I++){const O=I;t(e[O]).next(B=>{f[O]=B,++b,b===s&&i(f)},B=>r(B))}})}static doWhile(e,t){return new bt((i,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):i()};s()})}}class K0{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.R=new na,this.transaction.oncomplete=()=>{this.R.resolve()},this.transaction.onabort=()=>{t.error?this.R.reject(new Ky(e,t.error)):this.R.resolve()},this.transaction.onerror=i=>{const r=YC(i.target.error);this.R.reject(new Ky(e,r))}}static open(e,t,i,r){try{return new K0(t,e.transaction(r,i))}catch(s){throw new Ky(t,s)}}get v(){return this.R.promise}abort(e){e&&this.R.reject(e),this.aborted||(sn("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new CA(t)}}class nd{constructor(e,t,i){this.name=e,this.version=t,this.V=i,12.2===nd.S((0,te.z$)())&&Cs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return sn("SimpleDb","Removing database:",e),e_(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,te.hl)())return!1;if(nd.C())return!0;const e=(0,te.z$)(),t=nd.S(e),i=0<t&&t<10,r=nd.N(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.k)}static O(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}static N(e){const t=e.match(/Android ([\d.]+)/i),i=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(i)}$(e){var t=this;return(0,V.Z)(function*(){return t.db||(sn("SimpleDb","Opening database:",t.name),t.db=yield new Promise((i,r)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=f=>{i(f.target.result)},s.onblocked=()=>{r(new Ky(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=f=>{const b=f.target.error;r("VersionError"===b.name?new Wt(Ct.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===b.name?new Wt(Ct.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+b):new Ky(e,b))},s.onupgradeneeded=f=>{sn("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',f.oldVersion),t.V.M(f.target.result,s.transaction,f.oldVersion,t.version).next(()=>{sn("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.F&&(t.db.onversionchange=i=>t.F(i)),t.db})()}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,r){var s=this;return(0,V.Z)(function*(){const f="readonly"===t;let b=0;for(;;){++b;try{s.db=yield s.$(e);const I=K0.open(s.db,e,f?"readonly":"readwrite",i),O=r(I).next(B=>(I.P(),B)).catch(B=>(I.abort(B),bt.reject(B))).toPromise();return O.catch(()=>{}),yield I.v,O}catch(I){const O=I,B="FirebaseError"!==O.name&&b<3;if(sn("SimpleDb","Transaction failed with error:",O.message,"Retrying:",B),s.close(),!B)return Promise.reject(O)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class wA{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return e_(this.L.delete())}}class Ky extends Wt{constructor(e,t){super(Ct.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function _p(n){return"IndexedDbTransactionError"===n.name}class CA{constructor(e){this.store=e}put(e,t){let i;return void 0!==t?(sn("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(sn("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),e_(i)}add(e){return sn("SimpleDb","ADD",this.store.name,e,e),e_(this.store.add(e))}get(e){return e_(this.store.get(e)).next(t=>(void 0===t&&(t=null),sn("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return sn("SimpleDb","DELETE",this.store.name,e),e_(this.store.delete(e))}count(){return sn("SimpleDb","COUNT",this.store.name),e_(this.store.count())}j(e,t){const i=this.options(e,t);if(i.index||"function"!=typeof this.store.getAll){const r=this.cursor(i),s=[];return this.W(r,(f,b)=>{s.push(b)}).next(()=>s)}{const r=this.store.getAll(i.range);return new bt((s,f)=>{r.onerror=b=>{f(b.target.error)},r.onsuccess=b=>{s(b.target.result)}})}}H(e,t){const i=this.store.getAll(e,null===t?void 0:t);return new bt((r,s)=>{i.onerror=f=>{s(f.target.error)},i.onsuccess=f=>{r(f.target.result)}})}J(e,t){sn("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,t);i.Y=!1;const r=this.cursor(i);return this.W(r,(s,f,b)=>b.delete())}Z(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.W(r,t)}X(e){const t=this.cursor({});return new bt((i,r)=>{t.onerror=s=>{const f=YC(s.target.error);r(f)},t.onsuccess=s=>{const f=s.target.result;f?e(f.primaryKey,f.value).next(b=>{b?f.continue():i()}):i()}})}W(e,t){const i=[];return new bt((r,s)=>{e.onerror=f=>{s(f.target.error)},e.onsuccess=f=>{const b=f.target.result;if(!b)return void r();const I=new wA(b),O=t(b.primaryKey,b.value,I);if(O instanceof bt){const B=O.catch(K=>(I.done(),bt.reject(K)));i.push(B)}I.isDone?r():null===I.K?b.continue():b.continue(I.K)}}).next(()=>bt.waitFor(i))}options(e,t){let i;return void 0!==e&&("string"==typeof e?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.Y?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function e_(n){return new bt((e,t)=>{n.onsuccess=i=>{e(i.target.result)},n.onerror=i=>{const r=YC(i.target.error);t(r)}})}let WC=!1;function YC(n){const e=nd.S((0,te.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Wt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return WC||(WC=!0,setTimeout(()=>{throw i},0)),i}}return n}class qI{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){var t=this;sn("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,V.Z)(function*(){t.task=null;try{sn("IndexBackiller",`Documents written: ${yield t.tt.nt()}`)}catch(i){_p(i)?sn("IndexBackiller","Ignoring IndexedDB error during index backfill: ",i):yield Lm(i)}yield t.et(6e4)}))}}class ZI{constructor(e,t){this.localStore=e,this.persistence=t}nt(e=50){var t=this;return(0,V.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",i=>t.st(i,e))})()}st(e,t){const i=new Set;let r=t,s=!0;return bt.doWhile(()=>!0===s&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(f=>{if(null!==f&&!i.has(f))return sn("IndexBackiller",`Processing collection: ${f}`),this.it(e,f,r).next(b=>{r-=b,i.add(f)});s=!1})).next(()=>t-r)}it(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(s=>{const f=s.changes;return this.localStore.indexManager.updateIndexEntries(e,f).next(()=>this.rt(r,s)).next(b=>(sn("IndexBackiller",`Updating offset: ${b}`),this.localStore.indexManager.updateCollectionGroup(e,t,b))).next(()=>f.size)}))}rt(e,t){let i=e;return t.changes.forEach((r,s)=>{const f=qC(s);GI(f,i)>0&&(i=f)}),new jl(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}let wc=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>i.writeSequenceNumber(r))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return n.ct=-1,n})();function Xy(n){return null==n}function X0(n){return 0===n&&1/n==-1/0}function WI(n){return"number"==typeof n&&Number.isInteger(n)&&!X0(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Cc(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=EA(e)),e=YI(n.get(t),e);return EA(e)}function YI(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function EA(n){return n+"\x01\x01"}function yp(n){const e=n.length;if(ai(e>=2),2===e)return ai("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Pr.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const f=n.indexOf("\x01",s);switch((f<0||f>t)&&Hn(),n.charAt(f+1)){case"\x01":const b=n.substring(s,f);let I;0===r.length?I=b:(r+=b,I=r,r=""),i.push(I);break;case"\x10":r+=n.substring(s,f),r+="\0";break;case"\x11":r+=n.substring(s,f+1);break;default:Hn()}s=f+2}return new Pr(i)}const TA=["userId","batchId"];function KC(n,e){return[n,Cc(e)]}function IA(n,e,t){return[n,Cc(e),t]}const FL={},LL=["prefixPath","collectionGroup","readTime","documentId"],NL=["prefixPath","collectionGroup","documentId"],Sw=["collectionGroup","readTime","prefixPath","documentId"],zL=["canonicalId","targetId"],KI=["targetId","path"],Mw=["path","targetId"],XI=["collectionId","parent"],QI=["indexId","uid"],BL=["uid","sequenceNumber"],XC=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],JI=["indexId","uid","orderedDocumentKey"],SA=["userId","collectionPath","documentId"],VL=["userId","collectionPath","largestBatchId"],MA=["userId","collectionGroup","largestBatchId"],eS=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],DA=[...eS,"documentOverlays"],Q0=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],tS=Q0,UL=[...tS,"indexConfiguration","indexState","indexEntries"];class nS extends xA{constructor(e,t){super(),this.at=e,this.currentSequenceNumber=t}}function Ga(n,e){const t=Rn(n);return nd.O(t.at,e)}function iS(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function t_(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function rS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Ls{constructor(e,t){this.comparator=e,this.root=t||wa.EMPTY}insert(e,t){return new Ls(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,wa.BLACK,null,null))}remove(e){return new Ls(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wa.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(0===i)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(0===r)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Dw(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Dw(this.root,e,this.comparator,!1)}getReverseIterator(){return new Dw(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Dw(this.root,e,this.comparator,!0)}}class Dw{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class wa{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??wa.RED,this.left=r??wa.EMPTY,this.right=s??wa.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new wa(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return wa.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return wa.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,wa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,wa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Hn();const e=this.left.check();if(e!==this.right.check())throw Hn();return e+(this.isRed()?0:1)}}wa.EMPTY=null,wa.RED=!0,wa.BLACK=!1,wa.EMPTY=new class{constructor(){this.size=0}get key(){throw Hn()}get value(){throw Hn()}get color(){throw Hn()}get left(){throw Hn()}get right(){throw Hn()}copy(n,e,t,i,r){return this}insert(n,e,t){return new wa(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class so{constructor(e){this.comparator=e,this.data=new Ls(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new AA(this.data.getIterator())}getIteratorFrom(e){return new AA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof so)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(0!==this.comparator(r,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new so(this.comparator);return t.data=e,t}}class AA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ul(n){return n.hasNext()?n.getNext():void 0}class Ec{constructor(e){this.fields=e,e.sort(fs.comparator)}static empty(){return new Ec([])}unionWith(e){let t=new so(fs.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Ec(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fm(this.fields,e.fields,(t,i)=>t.isEqual(i))}}class QC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ca{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new QC("Invalid base64 string: "+r):r}}(e);return new Ca(t)}static fromUint8Array(e){const t=function(i){let r="";for(let s=0;s<i.length;++s)r+=String.fromCharCode(i[s]);return r}(e);return new Ca(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $i(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ca.EMPTY_BYTE_STRING=new Ca("");const id=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Nm(n){if(ai(!!n),"string"==typeof n){let e=0;const t=id.exec(n);if(ai(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ns(n.seconds),nanos:ns(n.nanos)}}function ns(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function n_(n){return"string"==typeof n?Ca.fromBase64String(n):Ca.fromUint8Array(n)}function JC(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Aw(n){const e=n.mapValue.fields.__previous_value__;return JC(e)?Aw(e):e}function Qy(n){const e=Nm(n.mapValue.fields.__local_write_time__.timestampValue);return new Vo(e.seconds,e.nanos)}class oS{constructor(e,t,i,r,s,f,b,I){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=f,this.autoDetectLongPolling=b,this.useFetchStreams=I}}class zm{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new zm("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof zm&&e.projectId===this.projectId&&e.database===this.database}}const vp={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},J0={nullValue:"NULL_VALUE"};function i_(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?JC(n)?4:aS(n)?9007199254740991:10:Hn()}function Yd(n,e){if(n===e)return!0;const t=i_(n);if(t!==i_(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Qy(n).isEqual(Qy(e));case 3:return function(i,r){if("string"==typeof i.timestampValue&&"string"==typeof r.timestampValue&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const s=Nm(i.timestampValue),f=Nm(r.timestampValue);return s.seconds===f.seconds&&s.nanos===f.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return r=e,n_(n.bytesValue).isEqual(n_(r.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,r){return ns(i.geoPointValue.latitude)===ns(r.geoPointValue.latitude)&&ns(i.geoPointValue.longitude)===ns(r.geoPointValue.longitude)}(n,e);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return ns(i.integerValue)===ns(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const s=ns(i.doubleValue),f=ns(r.doubleValue);return s===f?X0(s)===X0(f):isNaN(s)&&isNaN(f)}return!1}(n,e);case 9:return Fm(n.arrayValue.values||[],e.arrayValue.values||[],Yd);case 10:return function(i,r){const s=i.mapValue.fields||{},f=r.mapValue.fields||{};if(iS(s)!==iS(f))return!1;for(const b in s)if(s.hasOwnProperty(b)&&(void 0===f[b]||!Yd(s[b],f[b])))return!1;return!0}(n,e);default:return Hn()}var r}function eb(n,e){return void 0!==(n.values||[]).find(t=>Yd(t,e))}function lf(n,e){if(n===e)return 0;const t=i_(n),i=i_(e);if(t!==i)return $i(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return $i(n.booleanValue,e.booleanValue);case 2:return function(r,s){const f=ns(r.integerValue||r.doubleValue),b=ns(s.integerValue||s.doubleValue);return f<b?-1:f>b?1:f===b?0:isNaN(f)?isNaN(b)?0:-1:1}(n,e);case 3:return cf(n.timestampValue,e.timestampValue);case 4:return cf(Qy(n),Qy(e));case 5:return $i(n.stringValue,e.stringValue);case 6:return function(r,s){const f=n_(r),b=n_(s);return f.compareTo(b)}(n.bytesValue,e.bytesValue);case 7:return function(r,s){const f=r.split("/"),b=s.split("/");for(let I=0;I<f.length&&I<b.length;I++){const O=$i(f[I],b[I]);if(0!==O)return O}return $i(f.length,b.length)}(n.referenceValue,e.referenceValue);case 8:return function(r,s){const f=$i(ns(r.latitude),ns(s.latitude));return 0!==f?f:$i(ns(r.longitude),ns(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(r,s){const f=r.values||[],b=s.values||[];for(let I=0;I<f.length&&I<b.length;++I){const O=lf(f[I],b[I]);if(O)return O}return $i(f.length,b.length)}(n.arrayValue,e.arrayValue);case 10:return function(r,s){if(r===vp.mapValue&&s===vp.mapValue)return 0;if(r===vp.mapValue)return 1;if(s===vp.mapValue)return-1;const f=r.fields||{},b=Object.keys(f),I=s.fields||{},O=Object.keys(I);b.sort(),O.sort();for(let B=0;B<b.length&&B<O.length;++B){const K=$i(b[B],O[B]);if(0!==K)return K;const le=lf(f[b[B]],I[O[B]]);if(0!==le)return le}return $i(b.length,O.length)}(n.mapValue,e.mapValue);default:throw Hn()}}function cf(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return $i(n,e);const t=Nm(n),i=Nm(e),r=$i(t.seconds,i.seconds);return 0!==r?r:$i(t.nanos,i.nanos)}function du(n){return Pw(n)}function Pw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(i){const r=Nm(i);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?n_(n.bytesValue).toBase64():"referenceValue"in n?Pn.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(i){let r="[",s=!0;for(const f of i.values||[])s?s=!1:r+=",",r+=Pw(f);return r+"]"}(n.arrayValue):"mapValue"in n?function(i){const r=Object.keys(i.fields||{}).sort();let s="{",f=!0;for(const b of r)f?f=!1:s+=",",s+=`${b}:${Pw(i.fields[b])}`;return s+"}"}(n.mapValue):Hn();var e}function bp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Ow(n){return!!n&&"integerValue"in n}function tb(n){return!!n&&"arrayValue"in n}function OA(n){return!!n&&"nullValue"in n}function sS(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function kw(n){return!!n&&"mapValue"in n}function nb(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return t_(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=nb(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=nb(n.arrayValue.values[t]);return e}return Object.assign({},n)}function aS(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function lS(n){return"nullValue"in n?J0:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?bp(zm.empty(),Pn.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Hn()}function jL(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?bp(zm.empty(),Pn.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?vp:Hn()}function eE(n,e){const t=lf(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function cS(n,e){const t=lf(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class ia{constructor(e){this.value=e}static empty(){return new ia({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!kw(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=nb(t)}setAll(e){let t=fs.emptyPath(),i={},r=[];e.forEach((f,b)=>{if(!t.isImmediateParentOf(b)){const I=this.getFieldsMap(t);this.applyChanges(I,i,r),i={},r=[],t=b.popLast()}f?i[b.lastSegment()]=nb(f):r.push(b.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());kw(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Yd(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];kw(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){t_(t,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new ia(nb(this.value))}}function kA(n){const e=[];return t_(n.fields,(t,i)=>{const r=new fs([t]);if(kw(i)){const s=kA(i.mapValue).fields;if(0===s.length)e.push(r);else for(const f of s)e.push(r.child(f))}else e.push(r)}),new Ec(e)}class Ao{constructor(e,t,i,r,s,f,b){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=f,this.documentState=b}static newInvalidDocument(e){return new Ao(e,0,pi.min(),pi.min(),pi.min(),ia.empty(),0)}static newFoundDocument(e,t,i,r){return new Ao(e,1,t,pi.min(),i,r,0)}static newNoDocument(e,t){return new Ao(e,2,t,pi.min(),pi.min(),ia.empty(),0)}static newUnknownDocument(e,t){return new Ao(e,3,t,pi.min(),pi.min(),ia.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(pi.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ia.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ia.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pi.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ao&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ao(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class xp{constructor(e,t){this.position=e,this.inclusive=t}}function tE(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],f=n.position[r];if(i=s.field.isKeyField()?Pn.comparator(Pn.fromName(f.referenceValue),t.key):lf(f,t.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function nE(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Yd(n.position[t],e.position[t]))return!1;return!0}class r_{constructor(e,t="asc"){this.field=e,this.dir=t}}function uS(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class ib{}class gr extends ib{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,i):new FA(e,t,i):"array-contains"===t?new HL(e,i):"in"===t?new NA(e,i):"not-in"===t?new zA(e,i):"array-contains-any"===t?new Rw(e,i):new gr(e,t,i)}static createKeyFieldInFilter(e,t,i){return"in"===t?new $L(e,i):new GL(e,i)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(lf(t,this.value)):null!==t&&i_(this.value)===i_(t)&&this.matchesComparison(lf(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Hn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Xr extends ib{constructor(e,t){super(),this.filters=e,this.op=t,this.ht=null}static create(e,t){return new Xr(e,t)}matches(e){return Jy(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.lt(t=>t.isInequality());return null!==e?e.field:null}lt(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Jy(n){return"and"===n.op}function iE(n){return"or"===n.op}function dS(n){return RA(n)&&Jy(n)}function RA(n){for(const e of n.filters)if(e instanceof Xr)return!1;return!0}function hS(n){if(n instanceof gr)return n.field.canonicalString()+n.op.toString()+du(n.value);if(dS(n))return n.filters.map(e=>hS(e)).join(",");{const e=n.filters.map(t=>hS(t)).join(",");return`${n.op}(${e})`}}function rE(n,e){return n instanceof gr?(t=n,(i=e)instanceof gr&&t.op===i.op&&t.field.isEqual(i.field)&&Yd(t.value,i.value)):n instanceof Xr?function(t,i){return i instanceof Xr&&t.op===i.op&&t.filters.length===i.filters.length&&t.filters.reduce((r,s,f)=>r&&rE(s,i.filters[f]),!0)}(n,e):void Hn();var t,i}function fS(n,e){const t=n.filters.concat(e);return Xr.create(t,n.op)}function pS(n){return n instanceof gr?`${(e=n).field.canonicalString()} ${e.op} ${du(e.value)}`:n instanceof Xr?function(e){return e.op.toString()+" {"+e.getFilters().map(pS).join(" ,")+"}"}(n):"Filter";var e}class FA extends gr{constructor(e,t,i){super(e,t,i),this.key=Pn.fromName(i.referenceValue)}matches(e){const t=Pn.comparator(e.key,this.key);return this.matchesComparison(t)}}class $L extends gr{constructor(e,t){super(e,"in",t),this.keys=LA(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class GL extends gr{constructor(e,t){super(e,"not-in",t),this.keys=LA(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function LA(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(i=>Pn.fromName(i.referenceValue))}class HL extends gr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return tb(t)&&eb(t.arrayValue,this.value)}}class NA extends gr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&eb(this.value.arrayValue,t)}}class zA extends gr{constructor(e,t){super(e,"not-in",t)}matches(e){if(eb(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!eb(this.value.arrayValue,t)}}class Rw extends gr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!tb(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>eb(this.value.arrayValue,i))}}class BA{constructor(e,t=null,i=[],r=[],s=null,f=null,b=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=f,this.endAt=b,this.ft=null}}function oE(n,e=null,t=[],i=[],r=null,s=null,f=null){return new BA(n,e,t,i,r,s,f)}function Bm(n){const e=Rn(n);if(null===e.ft){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>hS(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>{return(r=i).field.canonicalString()+r.dir;var r}).join(","),Xy(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>du(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>du(i)).join(",")),e.ft=t}return e.ft}function Kd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!uS(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!rE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!nE(n.startAt,e.startAt)&&nE(n.endAt,e.endAt)}function rb(n){return Pn.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function ev(n,e){return n.filters.filter(t=>t instanceof gr&&t.field.isEqual(e))}function Fw(n,e,t){let i=J0,r=!0;for(const s of ev(n,e)){let f=J0,b=!0;switch(s.op){case"<":case"<=":f=lS(s.value);break;case"==":case"in":case">=":f=s.value;break;case">":f=s.value,b=!1;break;case"!=":case"not-in":f=J0}eE({value:i,inclusive:r},{value:f,inclusive:b})<0&&(i=f,r=b)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const f=t.position[s];eE({value:i,inclusive:r},{value:f,inclusive:t.inclusive})<0&&(i=f,r=t.inclusive);break}return{value:i,inclusive:r}}function mS(n,e,t){let i=vp,r=!0;for(const s of ev(n,e)){let f=vp,b=!0;switch(s.op){case">=":case">":f=jL(s.value),b=!1;break;case"==":case"in":case"<=":f=s.value;break;case"<":f=s.value,b=!1;break;case"!=":case"not-in":f=vp}cS({value:i,inclusive:r},{value:f,inclusive:b})>0&&(i=f,r=b)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const f=t.position[s];cS({value:i,inclusive:r},{value:f,inclusive:t.inclusive})>0&&(i=f,r=t.inclusive);break}return{value:i,inclusive:r}}class Xd{constructor(e,t=null,i=[],r=[],s=null,f="F",b=null,I=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=f,this.startAt=b,this.endAt=I,this.dt=null,this.wt=null}}function Lw(n,e,t,i,r,s,f,b){return new Xd(n,e,t,i,r,s,f,b)}function wp(n){return new Xd(n)}function VA(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function gS(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function sE(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function _S(n){return null!==n.collectionGroup}function Vm(n){const e=Rn(n);if(null===e.dt){e.dt=[];const t=sE(e),i=gS(e);if(null!==t&&null===i)t.isKeyField()||e.dt.push(new r_(t)),e.dt.push(new r_(fs.keyField(),"asc"));else{let r=!1;for(const s of e.explicitOrderBy)e.dt.push(s),s.field.isKeyField()&&(r=!0);if(!r){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new r_(fs.keyField(),s))}}}return e.dt}function $l(n){const e=Rn(n);if(!e.wt)if("F"===e.limitType)e.wt=oE(e.path,e.collectionGroup,Vm(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of Vm(e))t.push(new r_(s.field,"desc"===s.dir?"asc":"desc"));const i=e.endAt?new xp(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new xp(e.startAt.position,e.startAt.inclusive):null;e.wt=oE(e.path,e.collectionGroup,t,e.filters,e.limit,i,r)}return e.wt}function aE(n,e){e.getFirstInequalityField(),sE(n);const t=n.filters.concat([e]);return new Xd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Nw(n,e,t){return new Xd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ob(n,e){return Kd($l(n),$l(e))&&n.limitType===e.limitType}function lE(n){return`${Bm($l(n))}|lt:${n.limitType}`}function zw(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(i=>pS(i)).join(", ")}]`),Xy(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(i=>{return`${(r=i).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>du(i)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>du(i)).join(",")),`Target(${t})`}($l(n))}; limitType=${n.limitType})`}function tv(n,e){return e.isFoundDocument()&&function(t,i){const r=i.key.path;return null!==t.collectionGroup?i.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(r):Pn.isDocumentKey(t.path)?t.path.isEqual(r):t.path.isImmediateParentOf(r)}(n,e)&&function(t,i){for(const r of Vm(t))if(!r.field.isKeyField()&&null===i.data.field(r.field))return!1;return!0}(n,e)&&function(t,i){for(const r of t.filters)if(!r.matches(i))return!1;return!0}(n,e)&&(i=e,!((t=n).startAt&&!function(r,s,f){const b=tE(r,s,f);return r.inclusive?b<=0:b<0}(t.startAt,Vm(t),i)||t.endAt&&!function(r,s,f){const b=tE(r,s,f);return r.inclusive?b>=0:b>0}(t.endAt,Vm(t),i)));var t,i}function yS(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function vS(n){return(e,t)=>{let i=!1;for(const r of Vm(n)){const s=bS(r,e,t);if(0!==s)return s;i=i||r.field.isKeyField()}return 0}}function bS(n,e,t){const i=n.field.isKeyField()?Pn.comparator(e.key,t.key):function(r,s,f){const b=s.data.field(r),I=f.data.field(r);return null!==b&&null!==I?lf(b,I):Hn()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Hn()}}class uf{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0!==i)for(const[r,s]of i)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(void 0===r)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0===i)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return 1===i.length?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){t_(this.inner,(t,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return rS(this.inner)}size(){return this.innerSize}}const qL=new Ls(Pn.comparator);function Gl(){return qL}const Bw=new Ls(Pn.comparator);function sb(...n){let e=Bw;for(const t of n)e=e.insert(t.key,t);return e}function xS(n){let e=Bw;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Cp(){return ab()}function UA(){return ab()}function ab(){return new uf(n=>n.toString(),(n,e)=>n.isEqual(e))}const jA=new Ls(Pn.comparator),$A=new so(Pn.comparator);function lr(...n){let e=$A;for(const t of n)e=e.add(t);return e}const ZL=new so($i);function cE(){return ZL}function GA(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:X0(e)?"-0":e}}function wS(n){return{integerValue:""+n}}function HA(n,e){return WI(e)?wS(e):GA(n,e)}class uE{constructor(){this._=void 0}}function WL(n,e,t){return n instanceof lb?function(i,r){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&(s.fields.__previous_value__=r),{mapValue:s}}(t,e):n instanceof d?h(n,e):n instanceof m?x(n,e):function(i,r){const s=qA(i,r),f=A(s)+A(i._t);return Ow(s)&&Ow(i._t)?wS(f):GA(i.serializer,f)}(n,e)}function YL(n,e,t){return n instanceof d?h(n,e):n instanceof m?x(n,e):t}function qA(n,e){return n instanceof T?Ow(t=e)||(i=t)&&"doubleValue"in i?e:{integerValue:0}:null;var i,t}class lb extends uE{}class d extends uE{constructor(e){super(),this.elements=e}}function h(n,e){const t=N(e);for(const i of n.elements)t.some(r=>Yd(r,i))||t.push(i);return{arrayValue:{values:t}}}class m extends uE{constructor(e){super(),this.elements=e}}function x(n,e){let t=N(e);for(const i of n.elements)t=t.filter(r=>!Yd(r,i));return{arrayValue:{values:t}}}class T extends uE{constructor(e,t){super(),this.serializer=e,this._t=t}}function A(n){return ns(n.integerValue||n.doubleValue)}function N(n){return tb(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Z{constructor(e,t){this.field=e,this.transform=t}}class oe{constructor(e,t){this.version=e,this.transformResults=t}}class he{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new he}static exists(e){return new he(void 0,e)}static updateTime(e){return new he(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ie(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Ze{}function ut(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new cb(n.key,he.none()):new _i(n.key,n.data,he.none());{const t=n.data,i=ia.empty();let r=new so(fs.comparator);for(let s of e.fields)if(!r.has(s)){let f=t.field(s);null===f&&s.length>1&&(s=s.popLast(),f=t.field(s)),null===f?i.delete(s):i.set(s,f),r=r.add(s)}return new Zt(n.key,i,new Ec(r.toArray()),he.none())}}function Lt(n,e,t){n instanceof _i?function(i,r,s){const f=i.value.clone(),b=Zo(i.fieldTransforms,r,s.transformResults);f.setAll(b),r.convertToFoundDocument(s.version,f).setHasCommittedMutations()}(n,e,t):n instanceof Zt?function(i,r,s){if(!Ie(i.precondition,r))return void r.convertToUnknownDocument(s.version);const f=Zo(i.fieldTransforms,r,s.transformResults),b=r.data;b.setAll(Vi(i)),b.setAll(f),r.convertToFoundDocument(s.version,b).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function hn(n,e,t,i){return n instanceof _i?function(r,s,f,b){if(!Ie(r.precondition,s))return f;const I=r.value.clone(),O=Es(r.fieldTransforms,b,s);return I.setAll(O),s.convertToFoundDocument(s.version,I).setHasLocalMutations(),null}(n,e,t,i):n instanceof Zt?function(r,s,f,b){if(!Ie(r.precondition,s))return f;const I=Es(r.fieldTransforms,b,s),O=s.data;return O.setAll(Vi(r)),O.setAll(I),s.convertToFoundDocument(s.version,O).setHasLocalMutations(),null===f?null:f.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(B=>B.field))}(n,e,t,i):(f=t,Ie(n.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):f);var s,f}function Fn(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=qA(i.transform,r||null);null!=s&&(null===t&&(t=ia.empty()),t.set(i.field,s))}return t||null}function Kn(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===i||t&&i&&Fm(t,i,(r,s)=>function X(n,e){return n.field.isEqual(e.field)&&(i=e.transform,(t=n.transform)instanceof d&&i instanceof d||t instanceof m&&i instanceof m?Fm(t.elements,i.elements,Yd):t instanceof T&&i instanceof T?Yd(t._t,i._t):t instanceof lb&&i instanceof lb);var t,i}(r,s))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,i}class _i extends Ze{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Zt extends Ze{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Vi(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function Zo(n,e,t){const i=new Map;ai(n.length===t.length);for(let r=0;r<t.length;r++){const s=n[r],f=s.transform,b=e.data.field(s.field);i.set(s.field,YL(f,b,t[r]))}return i}function Es(n,e,t){const i=new Map;for(const r of n){const s=r.transform,f=t.data.field(r.field);i.set(r.field,WL(s,f,e))}return i}class cb extends Ze{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ZA extends Ze{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class WA{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&Lt(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=hn(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=hn(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=UA();return this.mutations.forEach(r=>{const s=e.get(r.key),f=s.overlayedDocument;let b=this.applyToLocalView(f,s.mutatedFields);b=t.has(r.key)?null:b;const I=ut(f,b);null!==I&&i.set(r.key,I),f.isValidDocument()||f.convertToNoDocument(pi.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),lr())}isEqual(e){return this.batchId===e.batchId&&Fm(this.mutations,e.mutations,(t,i)=>Kn(t,i))&&Fm(this.baseMutations,e.baseMutations,(t,i)=>Kn(t,i))}}class YA{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){ai(e.mutations.length===i.length);let r=jA;const s=e.mutations;for(let f=0;f<s.length;f++)r=r.insert(s[f].key,i[f].version);return new YA(e,t,i,r)}}class KA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class K5{constructor(e){this.count=e}}var Ea,jr;function KL(n){switch(n){default:return Hn();case Ct.CANCELLED:case Ct.UNKNOWN:case Ct.DEADLINE_EXCEEDED:case Ct.RESOURCE_EXHAUSTED:case Ct.INTERNAL:case Ct.UNAVAILABLE:case Ct.UNAUTHENTICATED:return!1;case Ct.INVALID_ARGUMENT:case Ct.NOT_FOUND:case Ct.ALREADY_EXISTS:case Ct.PERMISSION_DENIED:case Ct.FAILED_PRECONDITION:case Ct.ABORTED:case Ct.OUT_OF_RANGE:case Ct.UNIMPLEMENTED:case Ct.DATA_LOSS:return!0}}function XL(n){if(void 0===n)return Cs("GRPC error has no .code"),Ct.UNKNOWN;switch(n){case Ea.OK:return Ct.OK;case Ea.CANCELLED:return Ct.CANCELLED;case Ea.UNKNOWN:return Ct.UNKNOWN;case Ea.DEADLINE_EXCEEDED:return Ct.DEADLINE_EXCEEDED;case Ea.RESOURCE_EXHAUSTED:return Ct.RESOURCE_EXHAUSTED;case Ea.INTERNAL:return Ct.INTERNAL;case Ea.UNAVAILABLE:return Ct.UNAVAILABLE;case Ea.UNAUTHENTICATED:return Ct.UNAUTHENTICATED;case Ea.INVALID_ARGUMENT:return Ct.INVALID_ARGUMENT;case Ea.NOT_FOUND:return Ct.NOT_FOUND;case Ea.ALREADY_EXISTS:return Ct.ALREADY_EXISTS;case Ea.PERMISSION_DENIED:return Ct.PERMISSION_DENIED;case Ea.FAILED_PRECONDITION:return Ct.FAILED_PRECONDITION;case Ea.ABORTED:return Ct.ABORTED;case Ea.OUT_OF_RANGE:return Ct.OUT_OF_RANGE;case Ea.UNIMPLEMENTED:return Ct.UNIMPLEMENTED;case Ea.DATA_LOSS:return Ct.DATA_LOSS;default:return Hn()}}(jr=Ea||(Ea={}))[jr.OK=0]="OK",jr[jr.CANCELLED=1]="CANCELLED",jr[jr.UNKNOWN=2]="UNKNOWN",jr[jr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",jr[jr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",jr[jr.NOT_FOUND=5]="NOT_FOUND",jr[jr.ALREADY_EXISTS=6]="ALREADY_EXISTS",jr[jr.PERMISSION_DENIED=7]="PERMISSION_DENIED",jr[jr.UNAUTHENTICATED=16]="UNAUTHENTICATED",jr[jr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",jr[jr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",jr[jr.ABORTED=10]="ABORTED",jr[jr.OUT_OF_RANGE=11]="OUT_OF_RANGE",jr[jr.UNIMPLEMENTED=12]="UNIMPLEMENTED",jr[jr.INTERNAL=13]="INTERNAL",jr[jr.UNAVAILABLE=14]="UNAVAILABLE",jr[jr.DATA_LOSS=15]="DATA_LOSS";class QA{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return CS}static getOrCreateInstance(){return null===CS&&(CS=new QA),CS}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let CS=null;class dE{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,hE.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new dE(pi.min(),r,cE(),Gl(),lr())}}class hE{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new hE(i,t,lr(),lr(),lr())}}class ES{constructor(e,t,i,r){this.It=e,this.removedTargetIds=t,this.key=i,this.Tt=r}}class QL{constructor(e,t){this.targetId=e,this.Et=t}}class JL{constructor(e,t,i=Ca.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class eN{constructor(){this.At=0,this.Rt=nN(),this.vt=Ca.EMPTY_BYTE_STRING,this.bt=!1,this.Pt=!0}get current(){return this.bt}get resumeToken(){return this.vt}get Vt(){return 0!==this.At}get St(){return this.Pt}Dt(e){e.approximateByteSize()>0&&(this.Pt=!0,this.vt=e)}Ct(){let e=lr(),t=lr(),i=lr();return this.Rt.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Hn()}}),new hE(this.vt,this.bt,e,t,i)}xt(){this.Pt=!1,this.Rt=nN()}Nt(e,t){this.Pt=!0,this.Rt=this.Rt.insert(e,t)}kt(e){this.Pt=!0,this.Rt=this.Rt.remove(e)}Ot(){this.At+=1}$t(){this.At-=1}Mt(){this.Pt=!0,this.bt=!0}}class X5{constructor(e){this.Ft=e,this.Bt=new Map,this.Lt=Gl(),this.qt=tN(),this.Ut=new so($i)}Kt(e){for(const t of e.It)e.Tt&&e.Tt.isFoundDocument()?this.Gt(t,e.Tt):this.Qt(t,e.key,e.Tt);for(const t of e.removedTargetIds)this.Qt(t,e.key,e.Tt)}zt(e){this.forEachTarget(e,t=>{const i=this.jt(t);switch(e.state){case 0:this.Wt(t)&&i.Dt(e.resumeToken);break;case 1:i.$t(),i.Vt||i.xt(),i.Dt(e.resumeToken);break;case 2:i.$t(),i.Vt||this.removeTarget(t);break;case 3:this.Wt(t)&&(i.Mt(),i.Dt(e.resumeToken));break;case 4:this.Wt(t)&&(this.Ht(t),i.Dt(e.resumeToken));break;default:Hn()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Bt.forEach((i,r)=>{this.Wt(r)&&t(r)})}Jt(e){var t;const i=e.targetId,r=e.Et.count,s=this.Yt(i);if(s){const f=s.target;if(rb(f))if(0===r){const b=new Pn(f.path);this.Qt(i,b,Ao.newNoDocument(b,pi.min()))}else ai(1===r);else{const b=this.Zt(i);b!==r&&(this.Ht(i),this.Ut=this.Ut.add(i),null===(t=QA.instance)||void 0===t||t.notifyOnExistenceFilterMismatch({localCacheCount:b,existenceFilterCount:e.Et.count}))}}}Xt(e){const t=new Map;this.Bt.forEach((s,f)=>{const b=this.Yt(f);if(b){if(s.current&&rb(b.target)){const I=new Pn(b.target.path);null!==this.Lt.get(I)||this.te(f,I)||this.Qt(f,I,Ao.newNoDocument(I,e))}s.St&&(t.set(f,s.Ct()),s.xt())}});let i=lr();this.qt.forEach((s,f)=>{let b=!0;f.forEachWhile(I=>{const O=this.Yt(I);return!O||2===O.purpose||(b=!1,!1)}),b&&(i=i.add(s))}),this.Lt.forEach((s,f)=>f.setReadTime(e));const r=new dE(e,t,this.Ut,this.Lt,i);return this.Lt=Gl(),this.qt=tN(),this.Ut=new so($i),r}Gt(e,t){if(!this.Wt(e))return;const i=this.te(e,t.key)?2:0;this.jt(e).Nt(t.key,i),this.Lt=this.Lt.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ee(t.key).add(e))}Qt(e,t,i){if(!this.Wt(e))return;const r=this.jt(e);this.te(e,t)?r.Nt(t,1):r.kt(t),this.qt=this.qt.insert(t,this.ee(t).delete(e)),i&&(this.Lt=this.Lt.insert(t,i))}removeTarget(e){this.Bt.delete(e)}Zt(e){const t=this.jt(e).Ct();return this.Ft.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ot(e){this.jt(e).Ot()}jt(e){let t=this.Bt.get(e);return t||(t=new eN,this.Bt.set(e,t)),t}ee(e){let t=this.qt.get(e);return t||(t=new so($i),this.qt=this.qt.insert(e,t)),t}Wt(e){const t=null!==this.Yt(e);return t||sn("WatchChangeAggregator","Detected inactive target",e),t}Yt(e){const t=this.Bt.get(e);return t&&t.Vt?null:this.Ft.ne(e)}Ht(e){this.Bt.set(e,new eN),this.Ft.getRemoteKeysForTarget(e).forEach(t=>{this.Qt(e,t,null)})}te(e,t){return this.Ft.getRemoteKeysForTarget(e).has(t)}}function tN(){return new Ls(Pn.comparator)}function nN(){return new Ls(Pn.comparator)}const Q5={asc:"ASCENDING",desc:"DESCENDING"},J5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},e6={and:"AND",or:"OR"};class t6{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Vw(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function iN(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function n6(n,e){return Vw(n,e.toTimestamp())}function ra(n){return ai(!!n),pi.fromTimestamp(function(e){const t=Nm(e);return new Vo(t.seconds,t.nanos)}(n))}function JA(n,e){return(t=n,new Pr(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function rN(n){const e=Pr.fromString(n);return ai(fN(e)),e}function fE(n,e){return JA(n.databaseId,e.path)}function Um(n,e){const t=rN(e);if(t.get(1)!==n.databaseId.projectId)throw new Wt(Ct.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Wt(Ct.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Pn(sN(t))}function eP(n,e){return JA(n.databaseId,e)}function oN(n){const e=rN(n);return 4===e.length?Pr.emptyPath():sN(e)}function pE(n){return new Pr(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function sN(n){return ai(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function aN(n,e,t){return{name:fE(n,e),fields:t.value.mapValue.fields}}function lN(n,e,t){const i=Um(n,e.name),r=ra(e.updateTime),s=e.createTime?ra(e.createTime):pi.min(),f=new ia({mapValue:{fields:e.fields}}),b=Ao.newFoundDocument(i,r,s,f);return t&&b.setHasCommittedMutations(),t?b.setHasCommittedMutations():b}function mE(n,e){let t;if(e instanceof _i)t={update:aN(n,e.key,e.value)};else if(e instanceof cb)t={delete:fE(n,e.key)};else if(e instanceof Zt)t={update:aN(n,e.key,e.data),updateMask:u6(e.fieldMask)};else{if(!(e instanceof ZA))return Hn();t={verify:fE(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(r,s){const f=s.transform;if(f instanceof lb)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof d)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof m)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof T)return{fieldPath:s.field.canonicalString(),increment:f._t};throw Hn()}(0,i))),e.precondition.isNone||(t.currentDocument=void 0!==(r=e.precondition).updateTime?{updateTime:n6(n,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:Hn()),t;var r}function tP(n,e){const t=e.currentDocument?void 0!==(r=e.currentDocument).updateTime?he.updateTime(ra(r.updateTime)):void 0!==r.exists?he.exists(r.exists):he.none():he.none(),i=e.updateTransforms?e.updateTransforms.map(r=>function(s,f){let b=null;"setToServerValue"in f?(ai("REQUEST_TIME"===f.setToServerValue),b=new lb):"appendMissingElements"in f?b=new d(f.appendMissingElements.values||[]):"removeAllFromArray"in f?b=new m(f.removeAllFromArray.values||[]):"increment"in f?b=new T(s,f.increment):Hn();const I=fs.fromServerFormat(f.fieldPath);return new Z(I,b)}(n,r)):[];var r;if(e.update){const r=Um(n,e.update.name),s=new ia({mapValue:{fields:e.update.fields}});if(e.updateMask){const f=new Ec((e.updateMask.fieldPaths||[]).map(O=>fs.fromServerFormat(O)));return new Zt(r,s,f,t,i)}return new _i(r,s,t,i)}if(e.delete){const r=Um(n,e.delete);return new cb(r,t)}if(e.verify){const r=Um(n,e.verify);return new ZA(r,t)}return Hn()}function cN(n,e){return{documents:[eP(n,e.path)]}}function nP(n,e){const t={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(t.parent=eP(n,i),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=eP(n,i.popLast()),t.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(I){if(0!==I.length)return hN(Xr.create(I,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const s=function(I){if(0!==I.length)return I.map(O=>{return{field:nv((B=O).field),direction:a6(B.dir)};var B})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const f=(O=e.limit,n.useProto3Json||Xy(O)?O:{value:O});var O,b,I;return null!==f&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt={before:(b=e.startAt).inclusive,values:b.position}),e.endAt&&(t.structuredQuery.endAt={before:!(I=e.endAt).inclusive,values:I.position}),t}function uN(n){let e=oN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){ai(1===i);const B=t.from[0];B.allDescendants?r=B.collectionId:e=e.child(B.collectionId)}let s=[];t.where&&(s=function(B){const K=dN(B);return K instanceof Xr&&dS(K)?K.getFilters():[K]}(t.where));let f=[];t.orderBy&&(f=t.orderBy.map(B=>{return new r_(Uw((K=B).field),function(le){switch(le){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(K.direction));var K}));let b=null;t.limit&&(b=function(B){let K;return K="object"==typeof B?B.value:B,Xy(K)?null:K}(t.limit));let I=null;var B;t.startAt&&(I=new xp((B=t.startAt).values||[],!!B.before));let O=null;return t.endAt&&(O=function(B){return new xp(B.values||[],!B.before)}(t.endAt)),Lw(e,r,f,s,b,"F",I,O)}function dN(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Uw(e.unaryFilter.field);return gr.create(t,"==",{doubleValue:NaN});case"IS_NULL":const i=Uw(e.unaryFilter.field);return gr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Uw(e.unaryFilter.field);return gr.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Uw(e.unaryFilter.field);return gr.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Hn()}}(n):void 0!==n.fieldFilter?gr.create(Uw((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Hn()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return Xr.create(e.compositeFilter.filters.map(t=>dN(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Hn()}}(e.compositeFilter.op))}(n):Hn();var e}function a6(n){return Q5[n]}function l6(n){return J5[n]}function c6(n){return e6[n]}function nv(n){return{fieldPath:n.canonicalString()}}function Uw(n){return fs.fromServerFormat(n.fieldPath)}function hN(n){return n instanceof gr?function(e){if("=="===e.op){if(sS(e.value))return{unaryFilter:{field:nv(e.field),op:"IS_NAN"}};if(OA(e.value))return{unaryFilter:{field:nv(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(sS(e.value))return{unaryFilter:{field:nv(e.field),op:"IS_NOT_NAN"}};if(OA(e.value))return{unaryFilter:{field:nv(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:nv(e.field),op:l6(e.op),value:e.value}}}(n):n instanceof Xr?function(e){const t=e.getFilters().map(i=>hN(i));return 1===t.length?t[0]:{compositeFilter:{op:c6(e.op),filters:t}}}(n):Hn()}function u6(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function fN(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class iv{constructor(e,t,i,r,s=pi.min(),f=pi.min(),b=Ca.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=f,this.resumeToken=b}withSequenceNumber(e){return new iv(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new iv(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new iv(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class pN{constructor(e){this.se=e}}function mN(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:TS(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document={name:fE(r=n.se,(s=e).key),fields:s.data.value.mapValue.fields,updateTime:Vw(r,s.version.toTimestamp()),createTime:Vw(r,s.createTime.toTimestamp())};else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:ub(e.version)};else{if(!e.isUnknownDocument())return Hn();i.unknownDocument={path:t.path.toArray(),version:ub(e.version)}}var r,s;return i}function TS(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ub(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function db(n){const e=new Vo(n.seconds,n.nanoseconds);return pi.fromTimestamp(e)}function hb(n,e){const t=(e.baseMutations||[]).map(s=>tP(n.se,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const i=e.mutations.map(s=>tP(n.se,s)),r=Vo.fromMillis(e.localWriteTimeMs);return new WA(e.batchId,r,t,i)}function gE(n){const e=db(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?db(n.lastLimboFreeSnapshotVersion):pi.min();let i;var r;return void 0!==n.query.documents?(ai(1===(r=n.query).documents.length),i=$l(wp(oN(r.documents[0])))):i=$l(uN(n.query)),new iv(i,n.targetId,0,n.lastListenSequenceNumber,e,t,Ca.fromBase64String(n.resumeToken))}function gN(n,e){const t=ub(e.snapshotVersion),i=ub(e.lastLimboFreeSnapshotVersion);let r;r=rb(e.target)?cN(n.se,e.target):nP(n.se,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Bm(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function iP(n){const e=uN({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Nw(e,e.limit,"L"):e}function rP(n,e){return new KA(e.largestBatchId,tP(n.se,e.overlayMutation))}function _N(n,e){const t=e.path.lastSegment();return[n,Cc(e.path.popLast()),t]}function yN(n,e,t,i){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:ub(i.readTime),documentKey:Cc(i.documentKey.path),largestBatchId:i.largestBatchId}}class h6{getBundleMetadata(e,t){return vN(e).get(t).next(i=>{if(i)return{id:(r=i).bundleId,createTime:db(r.createTime),version:r.version};var r})}saveBundleMetadata(e,t){return vN(e).put({bundleId:(i=t).id,createTime:ub(ra(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return bN(e).get(t).next(i=>{if(i)return{name:(r=i).name,query:iP(r.bundledQuery),readTime:db(r.readTime)};var r})}saveNamedQuery(e,t){return bN(e).put({name:(i=t).name,readTime:ub(ra(i.readTime)),bundledQuery:i.bundledQuery});var i}}function vN(n){return Ga(n,"bundles")}function bN(n){return Ga(n,"namedQueries")}class IS{constructor(e,t){this.serializer=e,this.userId=t}static ie(e,t){return new IS(e,t.uid||"")}getOverlay(e,t){return _E(e).get(_N(this.userId,t)).next(i=>i?rP(this.serializer,i):null)}getOverlays(e,t){const i=Cp();return bt.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){const r=[];return i.forEach((s,f)=>{const b=new KA(t,f);r.push(this.re(e,b))}),bt.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach(f=>r.add(Cc(f.getCollectionPath())));const s=[];return r.forEach(f=>{const b=IDBKeyRange.bound([this.userId,f,i],[this.userId,f,i+1],!1,!0);s.push(_E(e).J("collectionPathOverlayIndex",b))}),bt.waitFor(s)}getOverlaysForCollection(e,t,i){const r=Cp(),s=Cc(t),f=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return _E(e).j("collectionPathOverlayIndex",f).next(b=>{for(const I of b){const O=rP(this.serializer,I);r.set(O.getKey(),O)}return r})}getOverlaysForCollectionGroup(e,t,i,r){const s=Cp();let f;const b=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return _E(e).Z({index:"collectionGroupOverlayIndex",range:b},(I,O,B)=>{const K=rP(this.serializer,O);s.size()<r||K.largestBatchId===f?(s.set(K.getKey(),K),f=K.largestBatchId):B.done()}).next(()=>s)}re(e,t){return _E(e).put(function(i,r,s){const[f,b,I]=_N(r,s.mutation.key);return{userId:r,collectionPath:b,documentId:I,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:mE(i.se,s.mutation)}}(this.serializer,this.userId,t))}}function _E(n){return Ga(n,"documentOverlays")}class fb{constructor(){}oe(e,t){this.ue(e,t),t.ce()}ue(e,t){if("nullValue"in e)this.ae(t,5);else if("booleanValue"in e)this.ae(t,10),t.he(e.booleanValue?1:0);else if("integerValue"in e)this.ae(t,15),t.he(ns(e.integerValue));else if("doubleValue"in e){const i=ns(e.doubleValue);isNaN(i)?this.ae(t,13):(this.ae(t,15),X0(i)?t.he(0):t.he(i))}else if("timestampValue"in e){const i=e.timestampValue;this.ae(t,20),"string"==typeof i?t.le(i):(t.le(`${i.seconds||""}`),t.he(i.nanos||0))}else if("stringValue"in e)this.fe(e.stringValue,t),this.de(t);else if("bytesValue"in e)this.ae(t,30),t.we(n_(e.bytesValue)),this.de(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.ae(t,45),t.he(i.latitude||0),t.he(i.longitude||0)}else"mapValue"in e?aS(e)?this.ae(t,Number.MAX_SAFE_INTEGER):(this.me(e.mapValue,t),this.de(t)):"arrayValue"in e?(this.ge(e.arrayValue,t),this.de(t)):Hn()}fe(e,t){this.ae(t,25),this.ye(e,t)}ye(e,t){t.le(e)}me(e,t){const i=e.fields||{};this.ae(t,55);for(const r of Object.keys(i))this.fe(r,t),this.ue(i[r],t)}ge(e,t){const i=e.values||[];this.ae(t,50);for(const r of i)this.ue(r,t)}_e(e,t){this.ae(t,37),Pn.fromName(e).path.forEach(i=>{this.ae(t,60),this.ye(i,t)})}ae(e,t){e.he(t)}de(e){e.he(2)}}function f6(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function xN(n){const e=64-function(t){let i=0;for(let r=0;r<8;++r){const s=f6(255&t[r]);if(i+=s,8!==s)break}return i}(n);return Math.ceil(e/8)}fb.pe=new fb;class p6{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ie(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Te(i.value),i=t.next();this.Ee()}Ae(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Re(i.value),i=t.next();this.ve()}be(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Te(i);else if(i<2048)this.Te(960|i>>>6),this.Te(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.Te(480|i>>>12),this.Te(128|63&i>>>6),this.Te(128|63&i);else{const r=t.codePointAt(0);this.Te(240|r>>>18),this.Te(128|63&r>>>12),this.Te(128|63&r>>>6),this.Te(128|63&r)}}this.Ee()}Pe(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Re(i);else if(i<2048)this.Re(960|i>>>6),this.Re(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.Re(480|i>>>12),this.Re(128|63&i>>>6),this.Re(128|63&i);else{const r=t.codePointAt(0);this.Re(240|r>>>18),this.Re(128|63&r>>>12),this.Re(128|63&r>>>6),this.Re(128|63&r)}}this.ve()}Ve(e){const t=this.Se(e),i=xN(t);this.De(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Ce(e){const t=this.Se(e),i=xN(t);this.De(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}xe(){this.Ne(255),this.Ne(255)}ke(){this.Oe(255),this.Oe(255)}reset(){this.position=0}seed(e){this.De(e.length),this.buffer.set(e,this.position),this.position+=e.length}$e(){return this.buffer.slice(0,this.position)}Se(e){const t=function(r){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,r,!1),new Uint8Array(s.buffer)}(e),i=0!=(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Te(e){const t=255&e;0===t?(this.Ne(0),this.Ne(255)):255===t?(this.Ne(255),this.Ne(0)):this.Ne(t)}Re(e){const t=255&e;0===t?(this.Oe(0),this.Oe(255)):255===t?(this.Oe(255),this.Oe(0)):this.Oe(e)}Ee(){this.Ne(0),this.Ne(1)}ve(){this.Oe(0),this.Oe(1)}Ne(e){this.De(1),this.buffer[this.position++]=e}Oe(e){this.De(1),this.buffer[this.position++]=~e}De(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class m6{constructor(e){this.Me=e}we(e){this.Me.Ie(e)}le(e){this.Me.be(e)}he(e){this.Me.Ve(e)}ce(){this.Me.xe()}}class g6{constructor(e){this.Me=e}we(e){this.Me.Ae(e)}le(e){this.Me.Pe(e)}he(e){this.Me.Ce(e)}ce(){this.Me.ke()}}class yE{constructor(){this.Me=new p6,this.Fe=new m6(this.Me),this.Be=new g6(this.Me)}seed(e){this.Me.seed(e)}Le(e){return 0===e?this.Fe:this.Be}$e(){return this.Me.$e()}reset(){this.Me.reset()}}class pb{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}qe(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new pb(this.indexId,this.documentKey,this.arrayValue,i)}}function rv(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=wN(n.arrayValue,e.arrayValue),0!==t?t:(t=wN(n.directionalValue,e.directionalValue),0!==t?t:Pn.comparator(n.documentKey,e.documentKey)))}function wN(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(0!==i)return i}return n.length-e.length}class _6{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.Ke=[];for(const t of e.filters){const i=t;i.isInequality()?this.Ge=i:this.Ke.push(i)}}Qe(e){ai(e.collectionGroup===this.collectionId);const t=Y0(e);if(void 0!==t&&!this.ze(t))return!1;const i=Yy(e);let r=0,s=0;for(;r<i.length&&this.ze(i[r]);++r);if(r===i.length)return!0;if(void 0!==this.Ge){const f=i[r];if(!this.je(this.Ge,f)||!this.We(this.Ue[s++],f))return!1;++r}for(;r<i.length;++r)if(s>=this.Ue.length||!this.We(this.Ue[s++],i[r]))return!1;return!0}ze(e){for(const t of this.Ke)if(this.je(t,e))return!0;return!1}je(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}We(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function CN(n){var e,t;if(ai(n instanceof gr||n instanceof Xr),n instanceof gr){if(n instanceof NA){const r=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>gr.create(n.field,"==",s)))||[];return Xr.create(r,"or")}return n}const i=n.filters.map(r=>CN(r));return Xr.create(i,n.op)}function y6(n){if(0===n.getFilters().length)return[];const e=aP(CN(n));return ai(EN(e)),oP(e)||sP(e)?[e]:e.getFilters()}function oP(n){return n instanceof gr}function sP(n){return n instanceof Xr&&dS(n)}function EN(n){return oP(n)||sP(n)||function(e){if(e instanceof Xr&&iE(e)){for(const t of e.getFilters())if(!oP(t)&&!sP(t))return!1;return!0}return!1}(n)}function aP(n){if(ai(n instanceof gr||n instanceof Xr),n instanceof gr)return n;if(1===n.filters.length)return aP(n.filters[0]);const e=n.filters.map(i=>aP(i));let t=Xr.create(e,n.op);return t=SS(t),EN(t)?t:(ai(t instanceof Xr),ai(Jy(t)),ai(t.filters.length>1),t.filters.reduce((i,r)=>lP(i,r)))}function lP(n,e){let t;return ai(n instanceof gr||n instanceof Xr),ai(e instanceof gr||e instanceof Xr),t=n instanceof gr?e instanceof gr?Xr.create([n,e],"and"):TN(n,e):e instanceof gr?TN(e,n):function(i,r){if(ai(i.filters.length>0&&r.filters.length>0),Jy(i)&&Jy(r))return fS(i,r.getFilters());const s=iE(i)?i:r,f=iE(i)?r:i,b=s.filters.map(I=>lP(I,f));return Xr.create(b,"or")}(n,e),SS(t)}function TN(n,e){if(Jy(e))return fS(e,n.getFilters());{const t=e.filters.map(i=>lP(n,i));return Xr.create(t,"or")}}function SS(n){if(ai(n instanceof gr||n instanceof Xr),n instanceof gr)return n;const e=n.getFilters();if(1===e.length)return SS(e[0]);if(RA(n))return n;const t=e.map(r=>SS(r)),i=[];return t.forEach(r=>{r instanceof gr?i.push(r):r instanceof Xr&&(r.op===n.op?i.push(...r.filters):i.push(r))}),1===i.length?i[0]:Xr.create(i,n.op)}class v6{constructor(){this.He=new cP}addToCollectionParentIndex(e,t){return this.He.add(t),bt.resolve()}getCollectionParents(e,t){return bt.resolve(this.He.getEntries(t))}addFieldIndex(e,t){return bt.resolve()}deleteFieldIndex(e,t){return bt.resolve()}getDocumentsMatchingTarget(e,t){return bt.resolve(null)}getIndexType(e,t){return bt.resolve(0)}getFieldIndexes(e,t){return bt.resolve([])}getNextCollectionGroupToUpdate(e){return bt.resolve(null)}getMinOffset(e,t){return bt.resolve(jl.min())}getMinOffsetFromCollectionGroup(e,t){return bt.resolve(jl.min())}updateCollectionGroup(e,t,i){return bt.resolve()}updateIndexEntries(e,t){return bt.resolve()}}class cP{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new so(Pr.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new so(Pr.comparator)).toArray()}}const MS=new Uint8Array(0);class b6{constructor(e,t){this.user=e,this.databaseId=t,this.Je=new cP,this.Ye=new uf(i=>Bm(i),(i,r)=>Kd(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Je.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.Je.add(t)});const s={collectionId:i,parent:Cc(r)};return IN(e).put(s)}return bt.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[VI(t),""],!1,!0);return IN(e).j(r).next(s=>{for(const f of s){if(f.collectionId!==t)break;i.push(yp(f.parent))}return i})}addFieldIndex(e,t){const i=DS(e),r={indexId:(f=t).indexId,collectionGroup:f.collectionGroup,fields:f.fields.map(b=>[b.fieldPath.canonicalString(),b.kind])};var f;delete r.indexId;const s=i.add(r);if(t.indexState){const f=bE(e);return s.next(b=>{f.put(yN(b,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const i=DS(e),r=bE(e),s=vE(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const i=vE(e);let r=!0;const s=new Map;return bt.forEach(this.Ze(t),f=>this.Xe(e,f).next(b=>{r&&(r=!!b),s.set(f,b)})).next(()=>{if(r){let f=lr();const b=[];return bt.forEach(s,(I,O)=>{var B;sn("IndexedDbIndexManager",`Using index ${B=I,`id=${B.indexId}|cg=${B.collectionGroup}|f=${B.fields.map(zn=>`${zn.fieldPath}:${zn.kind}`).join(",")}`} to execute ${Bm(t)}`);const K=function(zn,li){const Gi=Y0(li);if(void 0===Gi)return null;for(const Ki of ev(zn,Gi.fieldPath))switch(Ki.op){case"array-contains-any":return Ki.value.arrayValue.values||[];case"array-contains":return[Ki.value]}return null}(O,I),le=function(zn,li){const Gi=new Map;for(const Ki of Yy(li))for(const ao of ev(zn,Ki.fieldPath))switch(ao.op){case"==":case"in":Gi.set(Ki.fieldPath.canonicalString(),ao.value);break;case"not-in":case"!=":return Gi.set(Ki.fieldPath.canonicalString(),ao.value),Array.from(Gi.values())}return null}(O,I),ge=function(zn,li){const Gi=[];let Ki=!0;for(const ao of Yy(li)){const ml=0===ao.kind?Fw(zn,ao.fieldPath,zn.startAt):mS(zn,ao.fieldPath,zn.startAt);Gi.push(ml.value),Ki&&(Ki=ml.inclusive)}return new xp(Gi,Ki)}(O,I),Te=function(zn,li){const Gi=[];let Ki=!0;for(const ao of Yy(li)){const ml=0===ao.kind?mS(zn,ao.fieldPath,zn.endAt):Fw(zn,ao.fieldPath,zn.endAt);Gi.push(ml.value),Ki&&(Ki=ml.inclusive)}return new xp(Gi,Ki)}(O,I),Ge=this.tn(I,O,ge),Je=this.tn(I,O,Te),Qt=this.en(I,O,le),xn=this.nn(I.indexId,K,Ge,ge.inclusive,Je,Te.inclusive,Qt);return bt.forEach(xn,zn=>i.H(zn,t.limit).next(li=>{li.forEach(Gi=>{const Ki=Pn.fromSegments(Gi.documentKey);f.has(Ki)||(f=f.add(Ki),b.push(Ki))})}))}).next(()=>b)}return bt.resolve(null)})}Ze(e){let t=this.Ye.get(e);return t||(t=0===e.filters.length?[e]:y6(Xr.create(e.filters,"and")).map(i=>oE(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.Ye.set(e,t),t)}nn(e,t,i,r,s,f,b){const I=(null!=t?t.length:1)*Math.max(i.length,s.length),O=I/(null!=t?t.length:1),B=[];for(let K=0;K<I;++K){const le=t?this.sn(t[K/O]):MS,ge=this.rn(e,le,i[K%O],r),Te=this.on(e,le,s[K%O],f),Ge=b.map(Je=>this.rn(e,le,Je,!0));B.push(...this.createRange(ge,Te,Ge))}return B}rn(e,t,i,r){const s=new pb(e,Pn.empty(),t,i);return r?s:s.qe()}on(e,t,i,r){const s=new pb(e,Pn.empty(),t,i);return r?s.qe():s}Xe(e,t){const i=new _6(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let f=null;for(const b of s)i.Qe(b)&&(!f||b.fields.length>f.fields.length)&&(f=b);return f})}getIndexType(e,t){let i=2;const r=this.Ze(t);return bt.forEach(r,s=>this.Xe(e,s).next(f=>{f?0!==i&&f.fields.length<function(b){let I=new so(fs.comparator),O=!1;for(const B of b.filters)for(const K of B.getFlattenedFilters())K.field.isKeyField()||("array-contains"===K.op||"array-contains-any"===K.op?O=!0:I=I.add(K.field));for(const B of b.orderBy)B.field.isKeyField()||(I=I.add(B.field));return I.size+(O?1:0)}(s)&&(i=1):i=0})).next(()=>null!==t.limit&&r.length>1&&2===i?1:i)}un(e,t){const i=new yE;for(const r of Yy(e)){const s=t.data.field(r.fieldPath);if(null==s)return null;const f=i.Le(r.kind);fb.pe.oe(s,f)}return i.$e()}sn(e){const t=new yE;return fb.pe.oe(e,t.Le(0)),t.$e()}cn(e,t){const i=new yE;return fb.pe.oe(bp(this.databaseId,t),i.Le(function(r){const s=Yy(r);return 0===s.length?0:s[s.length-1].kind}(e))),i.$e()}en(e,t,i){if(null===i)return[];let r=[];r.push(new yE);let s=0;for(const f of Yy(e)){const b=i[s++];for(const I of r)if(this.an(t,f.fieldPath)&&tb(b))r=this.hn(r,f,b);else{const O=I.Le(f.kind);fb.pe.oe(b,O)}}return this.ln(r)}tn(e,t,i){return this.en(e,t,i.position)}ln(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].$e();return t}hn(e,t,i){const r=[...e],s=[];for(const f of i.arrayValue.values||[])for(const b of r){const I=new yE;I.seed(b.$e()),fb.pe.oe(f,I.Le(t.kind)),s.push(I)}return s}an(e,t){return!!e.filters.find(i=>i instanceof gr&&i.field.isEqual(t)&&("in"===i.op||"not-in"===i.op))}getFieldIndexes(e,t){const i=DS(e),r=bE(e);return(t?i.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.j()).next(s=>{const f=[];return bt.forEach(s,b=>r.get([b.indexId,this.uid]).next(I=>{f.push(function(O,B){const K=B?new af(B.sequenceNumber,new jl(db(B.readTime),new Pn(yp(B.documentKey)),B.largestBatchId)):af.empty(),le=O.fields.map(([ge,Te])=>new Iw(fs.fromServerFormat(ge),Te));return new Jg(O.indexId,O.collectionGroup,le,K)}(b,I))})).next(()=>f)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==s?s:$i(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){const r=DS(e),s=bE(e);return this.fn(e).next(f=>r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(b=>bt.forEach(b,I=>s.put(yN(I.indexId,this.user,f,i)))))}updateIndexEntries(e,t){const i=new Map;return bt.forEach(t,(r,s)=>{const f=i.get(r.collectionGroup);return(f?bt.resolve(f):this.getFieldIndexes(e,r.collectionGroup)).next(b=>(i.set(r.collectionGroup,b),bt.forEach(b,I=>this.dn(e,r,I).next(O=>{const B=this.wn(s,I);return O.isEqual(B)?bt.resolve():this._n(e,s,I,O,B)}))))})}mn(e,t,i,r){return vE(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.cn(i,t.key),documentKey:t.key.path.toArray()})}gn(e,t,i,r){return vE(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.cn(i,t.key),t.key.path.toArray()])}dn(e,t,i){const r=vE(e);let s=new so(rv);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.cn(i,t)])},(f,b)=>{s=s.add(new pb(i.indexId,t,b.arrayValue,b.directionalValue))}).next(()=>s)}wn(e,t){let i=new so(rv);const r=this.un(t,e);if(null==r)return i;const s=Y0(t);if(null!=s){const f=e.data.field(s.fieldPath);if(tb(f))for(const b of f.arrayValue.values||[])i=i.add(new pb(t.indexId,e.key,this.sn(b),r))}else i=i.add(new pb(t.indexId,e.key,MS,r));return i}_n(e,t,i,r,s){sn("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const f=[];return function(b,I,O,B,K){const le=b.getIterator(),ge=I.getIterator();let Te=ul(le),Ge=ul(ge);for(;Te||Ge;){let Je=!1,Qt=!1;if(Te&&Ge){const xn=O(Te,Ge);xn<0?Qt=!0:xn>0&&(Je=!0)}else null!=Te?Qt=!0:Je=!0;Je?(B(Ge),Ge=ul(ge)):Qt?(K(Te),Te=ul(le)):(Te=ul(le),Ge=ul(ge))}}(r,s,rv,b=>{f.push(this.mn(e,t,i,b))},b=>{f.push(this.gn(e,t,i,b))}),bt.waitFor(f)}fn(e){let t=1;return bE(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((f,b)=>rv(f,b)).filter((f,b,I)=>!b||0!==rv(f,I[b-1]));const r=[];r.push(e);for(const f of i){const b=rv(f,e),I=rv(f,t);if(0===b)r[0]=e.qe();else if(b>0&&I<0)r.push(f),r.push(f.qe());else if(I>0)break}r.push(t);const s=[];for(let f=0;f<r.length;f+=2){if(this.yn(r[f],r[f+1]))return[];s.push(IDBKeyRange.bound([r[f].indexId,this.uid,r[f].arrayValue,r[f].directionalValue,MS,[]],[r[f+1].indexId,this.uid,r[f+1].arrayValue,r[f+1].directionalValue,MS,[]]))}return s}yn(e,t){return rv(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(SN)}getMinOffset(e,t){return bt.mapArray(this.Ze(t),i=>this.Xe(e,i).next(r=>r||Hn())).next(SN)}}function IN(n){return Ga(n,"collectionParents")}function vE(n){return Ga(n,"indexEntries")}function DS(n){return Ga(n,"indexConfiguration")}function bE(n){return Ga(n,"indexState")}function SN(n){ai(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;GI(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new jl(e.readTime,e.documentKey,t)}const MN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class rd{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new rd(e,rd.DEFAULT_COLLECTION_PERCENTILE,rd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function DN(n,e,t){const i=n.store("mutations"),r=n.store("documentMutations"),s=[],f=IDBKeyRange.only(t.batchId);let b=0;const I=i.Z({range:f},(B,K,le)=>(b++,le.delete()));s.push(I.next(()=>{ai(1===b)}));const O=[];for(const B of t.mutations){const K=IA(e,B.key.path,t.batchId);s.push(r.delete(K)),O.push(B.key)}return bt.waitFor(s).next(()=>O)}function AS(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Hn();e=n.noDocument}return JSON.stringify(e).length}rd.DEFAULT_COLLECTION_PERCENTILE=10,rd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,rd.DEFAULT=new rd(41943040,rd.DEFAULT_COLLECTION_PERCENTILE,rd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),rd.DISABLED=new rd(-1,0,0);class PS{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.pn={}}static ie(e,t,i,r){ai(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new PS(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ov(e).Z({index:"userMutationsIndex",range:i},(r,s,f)=>{t=!1,f.done()}).next(()=>t)}addMutationBatch(e,t,i,r){const s=jw(e),f=ov(e);return f.add({}).next(b=>{ai("number"==typeof b);const I=new WA(b,t,i,r),O=function(le,ge,Te){const Ge=Te.baseMutations.map(Qt=>mE(le.se,Qt)),Je=Te.mutations.map(Qt=>mE(le.se,Qt));return{userId:ge,batchId:Te.batchId,localWriteTimeMs:Te.localWriteTime.toMillis(),baseMutations:Ge,mutations:Je}}(this.serializer,this.userId,I),B=[];let K=new so((le,ge)=>$i(le.canonicalString(),ge.canonicalString()));for(const le of r){const ge=IA(this.userId,le.key.path,b);K=K.add(le.key.path.popLast()),B.push(f.put(O)),B.push(s.put(ge,FL))}return K.forEach(le=>{B.push(this.indexManager.addToCollectionParentIndex(e,le))}),e.addOnCommittedListener(()=>{this.pn[b]=I.keys()}),bt.waitFor(B).next(()=>I)})}lookupMutationBatch(e,t){return ov(e).get(t).next(i=>i?(ai(i.userId===this.userId),hb(this.serializer,i)):null)}In(e,t){return this.pn[t]?bt.resolve(this.pn[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){const r=i.keys();return this.pn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return ov(e).Z({index:"userMutationsIndex",range:r},(f,b,I)=>{b.userId===this.userId&&(ai(b.batchId>=i),s=hb(this.serializer,b)),I.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return ov(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(r,s,f)=>{i=s.batchId,f.done()}).next(()=>i)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ov(e).j("userMutationsIndex",t).next(i=>i.map(r=>hb(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=KC(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return jw(e).Z({range:r},(f,b,I)=>{const[O,B,K]=f,le=yp(B);if(O===this.userId&&t.path.isEqual(le))return ov(e).get(K).next(ge=>{if(!ge)throw Hn();ai(ge.userId===this.userId),s.push(hb(this.serializer,ge))});I.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new so($i);const r=[];return t.forEach(s=>{const f=KC(this.userId,s.path),b=IDBKeyRange.lowerBound(f),I=jw(e).Z({range:b},(O,B,K)=>{const[le,ge,Te]=O,Ge=yp(ge);le===this.userId&&s.path.isEqual(Ge)?i=i.add(Te):K.done()});r.push(I)}),bt.waitFor(r).next(()=>this.Tn(e,i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=KC(this.userId,i),f=IDBKeyRange.lowerBound(s);let b=new so($i);return jw(e).Z({range:f},(I,O,B)=>{const[K,le,ge]=I,Te=yp(le);K===this.userId&&i.isPrefixOf(Te)?Te.length===r&&(b=b.add(ge)):B.done()}).next(()=>this.Tn(e,b))}Tn(e,t){const i=[],r=[];return t.forEach(s=>{r.push(ov(e).get(s).next(f=>{if(null===f)throw Hn();ai(f.userId===this.userId),i.push(hb(this.serializer,f))}))}),bt.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return DN(e.at,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.En(t.batchId)}),bt.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}En(e){delete this.pn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return bt.resolve();const i=IDBKeyRange.lowerBound([this.userId]),r=[];return jw(e).Z({range:i},(s,f,b)=>{if(s[0]===this.userId){const I=yp(s[1]);r.push(I)}else b.done()}).next(()=>{ai(0===r.length)})})}containsKey(e,t){return AN(e,this.userId,t)}An(e){return PN(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function AN(n,e,t){const i=KC(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let f=!1;return jw(n).Z({range:s,Y:!0},(b,I,O)=>{const[B,K,le]=b;B===e&&K===r&&(f=!0),O.done()}).next(()=>f)}function ov(n){return Ga(n,"mutations")}function jw(n){return Ga(n,"documentMutations")}function PN(n){return Ga(n,"mutationQueues")}class mb{constructor(e){this.Rn=e}next(){return this.Rn+=2,this.Rn}static vn(){return new mb(0)}static bn(){return new mb(-1)}}class x6{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Pn(e).next(t=>{const i=new mb(t.highestTargetId);return t.highestTargetId=i.next(),this.Vn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Pn(e).next(t=>pi.fromTimestamp(new Vo(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Pn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.Pn(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Vn(e,r)))}addTargetData(e,t){return this.Sn(e,t).next(()=>this.Pn(e).next(i=>(i.targetCount+=1,this.Dn(t,i),this.Vn(e,i))))}updateTargetData(e,t){return this.Sn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>$w(e).delete(t.targetId)).next(()=>this.Pn(e)).next(i=>(ai(i.targetCount>0),i.targetCount-=1,this.Vn(e,i)))}removeTargets(e,t,i){let r=0;const s=[];return $w(e).Z((f,b)=>{const I=gE(b);I.sequenceNumber<=t&&null===i.get(I.targetId)&&(r++,s.push(this.removeTargetData(e,I)))}).next(()=>bt.waitFor(s)).next(()=>r)}forEachTarget(e,t){return $w(e).Z((i,r)=>{const s=gE(r);t(s)})}Pn(e){return ON(e).get("targetGlobalKey").next(t=>(ai(null!==t),t))}Vn(e,t){return ON(e).put("targetGlobalKey",t)}Sn(e,t){return $w(e).put(gN(this.serializer,t))}Dn(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.Pn(e).next(t=>t.targetCount)}getTargetData(e,t){const i=Bm(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return $w(e).Z({range:r,index:"queryTargetsIndex"},(f,b,I)=>{const O=gE(b);Kd(t,O.target)&&(s=O,I.done())}).next(()=>s)}addMatchingKeys(e,t,i){const r=[],s=sv(e);return t.forEach(f=>{const b=Cc(f.path);r.push(s.put({targetId:i,path:b})),r.push(this.referenceDelegate.addReference(e,i,f))}),bt.waitFor(r)}removeMatchingKeys(e,t,i){const r=sv(e);return bt.forEach(t,s=>{const f=Cc(s.path);return bt.waitFor([r.delete([i,f]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,t){const i=sv(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=sv(e);let s=lr();return r.Z({range:i,Y:!0},(f,b,I)=>{const O=yp(f[1]),B=new Pn(O);s=s.add(B)}).next(()=>s)}containsKey(e,t){const i=Cc(t.path),r=IDBKeyRange.bound([i],[VI(i)],!1,!0);let s=0;return sv(e).Z({index:"documentTargetsIndex",Y:!0,range:r},([f,b],I,O)=>{0!==f&&(s++,O.done())}).next(()=>s>0)}ne(e,t){return $w(e).get(t).next(i=>i?gE(i):null)}}function $w(n){return Ga(n,"targets")}function ON(n){return Ga(n,"targetGlobal")}function sv(n){return Ga(n,"targetDocuments")}function kN([n,e],[t,i]){const r=$i(n,t);return 0===r?$i(e,i):r}class w6{constructor(e){this.Cn=e,this.buffer=new so(kN),this.xn=0}Nn(){return++this.xn}kn(e){const t=[e,this.Nn()];if(this.buffer.size<this.Cn)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();kN(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class C6{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.On=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.$n(6e4)}stop(){this.On&&(this.On.cancel(),this.On=null)}get started(){return null!==this.On}$n(e){var t=this;sn("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.On=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,V.Z)(function*(){t.On=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(i){_p(i)?sn("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",i):yield Lm(i)}yield t.$n(3e5)}))}}class E6{constructor(e,t){this.Mn=e,this.params=t}calculateTargetCount(e,t){return this.Mn.Fn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(0===t)return bt.resolve(wc.ct);const i=new w6(t);return this.Mn.forEachTarget(e,r=>i.kn(r.sequenceNumber)).next(()=>this.Mn.Bn(e,r=>i.kn(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Mn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Mn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(sn("LruGarbageCollector","Garbage collection skipped; disabled"),bt.resolve(MN)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(sn("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),MN):this.Ln(e,t))}getCacheSize(e){return this.Mn.getCacheSize(e)}Ln(e,t){let i,r,s,f,b,I,O;const B=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(K=>(K>this.params.maximumSequenceNumbersToCollect?(sn("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${K}`),r=this.params.maximumSequenceNumbersToCollect):r=K,f=Date.now(),this.nthSequenceNumber(e,r))).next(K=>(i=K,b=Date.now(),this.removeTargets(e,i,t))).next(K=>(s=K,I=Date.now(),this.removeOrphanedDocuments(e,i))).next(K=>(O=Date.now(),jC()<=se.in.DEBUG&&sn("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${f-B}ms\n\tDetermined least recently used ${r} in `+(b-f)+`ms\n\tRemoved ${s} targets in `+(I-b)+`ms\n\tRemoved ${K} documents in `+(O-I)+`ms\nTotal Duration: ${O-B}ms`),bt.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:K})))}}class T6{constructor(e,t){this.db=e,this.garbageCollector=new E6(this,t)}Fn(e){const t=this.qn(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}qn(e){let t=0;return this.Bn(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Bn(e,t){return this.Un(e,(i,r)=>t(r))}addReference(e,t,i){return OS(e,i)}removeReference(e,t,i){return OS(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return OS(e,t)}Kn(e,t){return function(i,r){let s=!1;return PN(i).X(f=>AN(i,f,r).next(b=>(b&&(s=!0),bt.resolve(!b)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Un(e,(f,b)=>{if(b<=t){const I=this.Kn(e,f).next(O=>{if(!O)return s++,i.getEntry(e,f).next(()=>(i.removeEntry(f,pi.min()),sv(e).delete([0,Cc(f.path)])))});r.push(I)}}).next(()=>bt.waitFor(r)).next(()=>i.apply(e)).next(()=>s)}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return OS(e,t)}Un(e,t){const i=sv(e);let r,s=wc.ct;return i.Z({index:"documentTargetsIndex"},([f,b],{path:I,sequenceNumber:O})=>{0===f?(s!==wc.ct&&t(new Pn(yp(r)),s),s=O,r=I):s=wc.ct}).next(()=>{s!==wc.ct&&t(new Pn(yp(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function OS(n,e){return sv(n).put((i=n.currentSequenceNumber,{targetId:0,path:Cc(e.path),sequenceNumber:i}));var i}class RN{constructor(){this.changes=new uf(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ao.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return void 0!==i?bt.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class I6{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return gb(e).put(i)}removeEntry(e,t,i){return gb(e).delete(function(r,s){const f=r.path.toArray();return[f.slice(0,f.length-2),f[f.length-2],TS(s),f[f.length-1]]}(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.Gn(e,i)))}getEntry(e,t){let i=Ao.newInvalidDocument(t);return gb(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(xE(t))},(r,s)=>{i=this.Qn(t,s)}).next(()=>i)}zn(e,t){let i={size:0,document:Ao.newInvalidDocument(t)};return gb(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(xE(t))},(r,s)=>{i={document:this.Qn(t,s),size:AS(s)}}).next(()=>i)}getEntries(e,t){let i=Gl();return this.jn(e,t,(r,s)=>{const f=this.Qn(r,s);i=i.insert(r,f)}).next(()=>i)}Wn(e,t){let i=Gl(),r=new Ls(Pn.comparator);return this.jn(e,t,(s,f)=>{const b=this.Qn(s,f);i=i.insert(s,b),r=r.insert(s,AS(f))}).next(()=>({documents:i,Hn:r}))}jn(e,t,i){if(t.isEmpty())return bt.resolve();let r=new so(zN);t.forEach(I=>r=r.add(I));const s=IDBKeyRange.bound(xE(r.first()),xE(r.last())),f=r.getIterator();let b=f.getNext();return gb(e).Z({index:"documentKeyIndex",range:s},(I,O,B)=>{const K=Pn.fromSegments([...O.prefixPath,O.collectionGroup,O.documentId]);for(;b&&zN(b,K)<0;)i(b,null),b=f.getNext();b&&b.isEqual(K)&&(i(b,O),b=f.hasNext()?f.getNext():null),b?B.G(xE(b)):B.done()}).next(()=>{for(;b;)i(b,null),b=f.hasNext()?f.getNext():null})}getDocumentsMatchingQuery(e,t,i,r){const s=t.path,f=[s.popLast().toArray(),s.lastSegment(),TS(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],b=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return gb(e).j(IDBKeyRange.bound(f,b,!0)).next(I=>{let O=Gl();for(const B of I){const K=this.Qn(Pn.fromSegments(B.prefixPath.concat(B.collectionGroup,B.documentId)),B);K.isFoundDocument()&&(tv(t,K)||r.has(K.key))&&(O=O.insert(K.key,K))}return O})}getAllFromCollectionGroup(e,t,i,r){let s=Gl();const f=NN(t,i),b=NN(t,jl.max());return gb(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(f,b,!0)},(I,O,B)=>{const K=this.Qn(Pn.fromSegments(O.prefixPath.concat(O.collectionGroup,O.documentId)),O);s=s.insert(K.key,K),s.size===r&&B.done()}).next(()=>s)}newChangeBuffer(e){return new S6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return LN(e).get("remoteDocumentGlobalKey").next(t=>(ai(!!t),t))}Gn(e,t){return LN(e).put("remoteDocumentGlobalKey",t)}Qn(e,t){if(t){const i=function d6(n,e){let t;if(e.document)t=lN(n.se,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Pn.fromSegments(e.noDocument.path),r=db(e.noDocument.readTime);t=Ao.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Hn();{const i=Pn.fromSegments(e.unknownDocument.path),r=db(e.unknownDocument.version);t=Ao.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime(function(i){const r=new Vo(i[0],i[1]);return pi.fromTimestamp(r)}(e.readTime)),t}(this.serializer,t);if(!i.isNoDocument()||!i.version.isEqual(pi.min()))return i}return Ao.newInvalidDocument(e)}}function FN(n){return new I6(n)}class S6 extends RN{constructor(e,t){super(),this.Jn=e,this.trackRemovals=t,this.Yn=new uf(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){const t=[];let i=0,r=new so((s,f)=>$i(s.canonicalString(),f.canonicalString()));return this.changes.forEach((s,f)=>{const b=this.Yn.get(s);if(t.push(this.Jn.removeEntry(e,s,b.readTime)),f.isValidDocument()){const I=mN(this.Jn.serializer,f);r=r.add(s.path.popLast());const O=AS(I);i+=O-b.size,t.push(this.Jn.addEntry(e,s,I))}else if(i-=b.size,this.trackRemovals){const I=mN(this.Jn.serializer,f.convertToNoDocument(pi.min()));t.push(this.Jn.addEntry(e,s,I))}}),r.forEach(s=>{t.push(this.Jn.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.Jn.updateMetadata(e,i)),bt.waitFor(t)}getFromCache(e,t){return this.Jn.zn(e,t).next(i=>(this.Yn.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.Jn.Wn(e,t).next(({documents:i,Hn:r})=>(r.forEach((s,f)=>{this.Yn.set(s,{size:f,readTime:i.get(s).readTime})}),i))}}function LN(n){return Ga(n,"remoteDocumentGlobal")}function gb(n){return Ga(n,"remoteDocumentsV14")}function xE(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function NN(n,e){const t=e.documentKey.path.toArray();return[n,TS(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function zN(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=$i(t[s],i[s]),r)return r;return r=$i(t.length,i.length),r||(r=$i(t[t.length-2],i[i.length-2]),r||$i(t[t.length-1],i[i.length-1]))}class M6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class BN{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(null!==i&&hn(i.mutation,r,Ec.empty(),Vo.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,lr()).next(()=>i))}getLocalViewOfDocuments(e,t,i=lr()){const r=Cp();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let f=sb();return s.forEach((b,I)=>{f=f.insert(b,I.overlayedDocument)}),f}))}getOverlayedDocuments(e,t){const i=Cp();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,lr()))}populateOverlays(e,t,i){const r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((f,b)=>{t.set(f,b)})})}computeViews(e,t,i,r){let s=Gl();const f=ab(),b=ab();return t.forEach((I,O)=>{const B=i.get(O.key);r.has(O.key)&&(void 0===B||B.mutation instanceof Zt)?s=s.insert(O.key,O):void 0!==B?(f.set(O.key,B.mutation.getFieldMask()),hn(B.mutation,O,B.mutation.getFieldMask(),Vo.now())):f.set(O.key,Ec.empty())}),this.recalculateAndSaveOverlays(e,s).next(I=>(I.forEach((O,B)=>f.set(O,B)),t.forEach((O,B)=>{var K;return b.set(O,new M6(B,null!==(K=f.get(O))&&void 0!==K?K:null))}),b))}recalculateAndSaveOverlays(e,t){const i=ab();let r=new Ls((f,b)=>f-b),s=lr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(f=>{for(const b of f)b.keys().forEach(I=>{const O=t.get(I);if(null===O)return;let B=i.get(I)||Ec.empty();B=b.applyToLocalView(O,B),i.set(I,B);const K=(r.get(b.batchId)||lr()).add(I);r=r.insert(b.batchId,K)})}).next(()=>{const f=[],b=r.getReverseIterator();for(;b.hasNext();){const I=b.getNext(),O=I.key,B=I.value,K=UA();B.forEach(le=>{if(!s.has(le)){const ge=ut(t.get(le),i.get(le));null!==ge&&K.set(le,ge),s=s.add(le)}}),f.push(this.documentOverlayCache.saveOverlays(e,O,K))}return bt.waitFor(f)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i){return Pn.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):_S(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i):this.getDocumentsMatchingCollectionQuery(e,t,i);var r}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{const f=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):bt.resolve(Cp());let b=-1,I=s;return f.next(O=>bt.forEach(O,(B,K)=>(b<K.largestBatchId&&(b=K.largestBatchId),s.get(B)?bt.resolve():this.remoteDocumentCache.getEntry(e,B).next(le=>{I=I.insert(B,le)}))).next(()=>this.populateOverlays(e,O,s)).next(()=>this.computeViews(e,I,O,lr())).next(B=>({batchId:b,changes:xS(B)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Pn(t)).next(i=>{let r=sb();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i){const r=t.collectionGroup;let s=sb();return this.indexManager.getCollectionParents(e,r).next(f=>bt.forEach(f,b=>{const I=(O=t,B=b.child(r),new Xd(B,null,O.explicitOrderBy.slice(),O.filters.slice(),O.limit,O.limitType,O.startAt,O.endAt));var O,B;return this.getDocumentsMatchingCollectionQuery(e,I,i).next(O=>{O.forEach((B,K)=>{s=s.insert(B,K)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,r))).next(s=>{r.forEach((b,I)=>{const O=I.getKey();null===s.get(O)&&(s=s.insert(O,Ao.newInvalidDocument(O)))});let f=sb();return s.forEach((b,I)=>{const O=r.get(b);void 0!==O&&hn(O.mutation,I,Ec.empty(),Vo.now()),tv(t,I)&&(f=f.insert(b,I))}),f})}}class D6{constructor(e){this.serializer=e,this.Zn=new Map,this.Xn=new Map}getBundleMetadata(e,t){return bt.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var i;return this.Zn.set(t.id,{id:(i=t).id,version:i.version,createTime:ra(i.createTime)}),bt.resolve()}getNamedQuery(e,t){return bt.resolve(this.Xn.get(t))}saveNamedQuery(e,t){return this.Xn.set(t.name,{name:(i=t).name,query:iP(i.bundledQuery),readTime:ra(i.readTime)}),bt.resolve();var i}}class A6{constructor(){this.overlays=new Ls(Pn.comparator),this.ts=new Map}getOverlay(e,t){return bt.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Cp();return bt.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.re(e,t,s)}),bt.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.ts.get(i);return void 0!==r&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.ts.delete(i)),bt.resolve()}getOverlaysForCollection(e,t,i){const r=Cp(),s=t.length+1,f=new Pn(t.child("")),b=this.overlays.getIteratorFrom(f);for(;b.hasNext();){const I=b.getNext().value,O=I.getKey();if(!t.isPrefixOf(O.path))break;O.path.length===s&&I.largestBatchId>i&&r.set(I.getKey(),I)}return bt.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new Ls((O,B)=>O-B);const f=this.overlays.getIterator();for(;f.hasNext();){const O=f.getNext().value;if(O.getKey().getCollectionGroup()===t&&O.largestBatchId>i){let B=s.get(O.largestBatchId);null===B&&(B=Cp(),s=s.insert(O.largestBatchId,B)),B.set(O.getKey(),O)}}const b=Cp(),I=s.getIterator();for(;I.hasNext()&&(I.getNext().value.forEach((O,B)=>b.set(O,B)),!(b.size()>=r)););return bt.resolve(b)}re(e,t,i){const r=this.overlays.get(i.key);if(null!==r){const f=this.ts.get(r.largestBatchId).delete(i.key);this.ts.set(r.largestBatchId,f)}this.overlays=this.overlays.insert(i.key,new KA(t,i));let s=this.ts.get(t);void 0===s&&(s=lr(),this.ts.set(t,s)),this.ts.set(t,s.add(i.key))}}class uP{constructor(){this.es=new so(dl.ns),this.ss=new so(dl.rs)}isEmpty(){return this.es.isEmpty()}addReference(e,t){const i=new dl(e,t);this.es=this.es.add(i),this.ss=this.ss.add(i)}os(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.us(new dl(e,t))}cs(e,t){e.forEach(i=>this.removeReference(i,t))}hs(e){const t=new Pn(new Pr([])),i=new dl(t,e),r=new dl(t,e+1),s=[];return this.ss.forEachInRange([i,r],f=>{this.us(f),s.push(f.key)}),s}ls(){this.es.forEach(e=>this.us(e))}us(e){this.es=this.es.delete(e),this.ss=this.ss.delete(e)}fs(e){const t=new Pn(new Pr([])),i=new dl(t,e),r=new dl(t,e+1);let s=lr();return this.ss.forEachInRange([i,r],f=>{s=s.add(f.key)}),s}containsKey(e){const t=new dl(e,0),i=this.es.firstAfterOrEqual(t);return null!==i&&e.isEqual(i.key)}}class dl{constructor(e,t){this.key=e,this.ds=t}static ns(e,t){return Pn.comparator(e.key,t.key)||$i(e.ds,t.ds)}static rs(e,t){return $i(e.ds,t.ds)||Pn.comparator(e.key,t.key)}}class P6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this._s=new so(dl.ns)}checkEmpty(e){return bt.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,i,r){const s=this.ws;this.ws++;const f=new WA(s,t,i,r);this.mutationQueue.push(f);for(const b of r)this._s=this._s.add(new dl(b.key,s)),this.indexManager.addToCollectionParentIndex(e,b.key.path.popLast());return bt.resolve(f)}lookupMutationBatch(e,t){return bt.resolve(this.gs(t))}getNextMutationBatchAfterBatchId(e,t){const r=this.ys(t+1),s=r<0?0:r;return bt.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return bt.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return bt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new dl(t,0),r=new dl(t,Number.POSITIVE_INFINITY),s=[];return this._s.forEachInRange([i,r],f=>{const b=this.gs(f.ds);s.push(b)}),bt.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new so($i);return t.forEach(r=>{const s=new dl(r,0),f=new dl(r,Number.POSITIVE_INFINITY);this._s.forEachInRange([s,f],b=>{i=i.add(b.ds)})}),bt.resolve(this.ps(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;Pn.isDocumentKey(s)||(s=s.child(""));const f=new dl(new Pn(s),0);let b=new so($i);return this._s.forEachWhile(I=>{const O=I.key.path;return!!i.isPrefixOf(O)&&(O.length===r&&(b=b.add(I.ds)),!0)},f),bt.resolve(this.ps(b))}ps(e){const t=[];return e.forEach(i=>{const r=this.gs(i);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){ai(0===this.Is(t.batchId,"removed")),this.mutationQueue.shift();let i=this._s;return bt.forEach(t.mutations,r=>{const s=new dl(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this._s=i})}En(e){}containsKey(e,t){const i=new dl(t,0),r=this._s.firstAfterOrEqual(i);return bt.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return bt.resolve()}Is(e,t){return this.ys(e)}ys(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}gs(e){const t=this.ys(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class O6{constructor(e){this.Ts=e,this.docs=new Ls(Pn.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,f=this.Ts(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:f}),this.size+=f-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return bt.resolve(i?i.document.mutableCopy():Ao.newInvalidDocument(t))}getEntries(e,t){let i=Gl();return t.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Ao.newInvalidDocument(r))}),bt.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=Gl();const f=t.path,b=new Pn(f.child("")),I=this.docs.getIteratorFrom(b);for(;I.hasNext();){const{key:O,value:{document:B}}=I.getNext();if(!f.isPrefixOf(O.path))break;O.path.length>f.length+1||GI(qC(B),i)<=0||(r.has(B.key)||tv(t,B))&&(s=s.insert(B.key,B.mutableCopy()))}return bt.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Hn()}Es(e,t){return bt.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new k6(this)}getSize(e){return bt.resolve(this.size)}}class k6 extends RN{constructor(e){super(),this.Jn=e}applyChanges(e){const t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Jn.addEntry(e,r)):this.Jn.removeEntry(i)}),bt.waitFor(t)}getFromCache(e,t){return this.Jn.getEntry(e,t)}getAllFromCache(e,t){return this.Jn.getEntries(e,t)}}class R6{constructor(e){this.persistence=e,this.As=new uf(t=>Bm(t),Kd),this.lastRemoteSnapshotVersion=pi.min(),this.highestTargetId=0,this.Rs=0,this.vs=new uP,this.targetCount=0,this.bs=mb.vn()}forEachTarget(e,t){return this.As.forEach((i,r)=>t(r)),bt.resolve()}getLastRemoteSnapshotVersion(e){return bt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return bt.resolve(this.Rs)}allocateTargetId(e){return this.highestTargetId=this.bs.next(),bt.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Rs&&(this.Rs=t),bt.resolve()}Sn(e){this.As.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.bs=new mb(t),this.highestTargetId=t),e.sequenceNumber>this.Rs&&(this.Rs=e.sequenceNumber)}addTargetData(e,t){return this.Sn(t),this.targetCount+=1,bt.resolve()}updateTargetData(e,t){return this.Sn(t),bt.resolve()}removeTargetData(e,t){return this.As.delete(t.target),this.vs.hs(t.targetId),this.targetCount-=1,bt.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.As.forEach((f,b)=>{b.sequenceNumber<=t&&null===i.get(b.targetId)&&(this.As.delete(f),s.push(this.removeMatchingKeysForTargetId(e,b.targetId)),r++)}),bt.waitFor(s).next(()=>r)}getTargetCount(e){return bt.resolve(this.targetCount)}getTargetData(e,t){const i=this.As.get(t)||null;return bt.resolve(i)}addMatchingKeys(e,t,i){return this.vs.os(t,i),bt.resolve()}removeMatchingKeys(e,t,i){this.vs.cs(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(f=>{s.push(r.markPotentiallyOrphaned(e,f))}),bt.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.vs.hs(t),bt.resolve()}getMatchingKeysForTargetId(e,t){const i=this.vs.fs(t);return bt.resolve(i)}containsKey(e,t){return bt.resolve(this.vs.containsKey(t))}}class VN{constructor(e,t){this.Ps={},this.overlays={},this.Vs=new wc(0),this.Ss=!1,this.Ss=!0,this.referenceDelegate=e(this),this.Ds=new R6(this),this.indexManager=new v6,this.remoteDocumentCache=new O6(i=>this.referenceDelegate.Cs(i)),this.serializer=new pN(t),this.xs=new D6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ss=!1,Promise.resolve()}get started(){return this.Ss}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new A6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Ps[e.toKey()];return i||(i=new P6(t,this.referenceDelegate),this.Ps[e.toKey()]=i),i}getTargetCache(){return this.Ds}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.xs}runTransaction(e,t,i){sn("MemoryPersistence","Starting transaction:",e);const r=new F6(this.Vs.next());return this.referenceDelegate.Ns(),i(r).next(s=>this.referenceDelegate.ks(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Os(e,t){return bt.or(Object.values(this.Ps).map(i=>()=>i.containsKey(e,t)))}}class F6 extends xA{constructor(e){super(),this.currentSequenceNumber=e}}class kS{constructor(e){this.persistence=e,this.$s=new uP,this.Ms=null}static Fs(e){return new kS(e)}get Bs(){if(this.Ms)return this.Ms;throw Hn()}addReference(e,t,i){return this.$s.addReference(i,t),this.Bs.delete(i.toString()),bt.resolve()}removeReference(e,t,i){return this.$s.removeReference(i,t),this.Bs.add(i.toString()),bt.resolve()}markPotentiallyOrphaned(e,t){return this.Bs.add(t.toString()),bt.resolve()}removeTarget(e,t){this.$s.hs(t.targetId).forEach(r=>this.Bs.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Bs.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}Ns(){this.Ms=new Set}ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return bt.forEach(this.Bs,i=>{const r=Pn.fromPath(i);return this.Ls(e,r).next(s=>{s||t.removeEntry(r,pi.min())})}).next(()=>(this.Ms=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ls(e,t).next(i=>{i?this.Bs.delete(t.toString()):this.Bs.add(t.toString())})}Cs(e){return 0}Ls(e,t){return bt.or([()=>bt.resolve(this.$s.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Os(e,t)])}}class L6{constructor(e){this.serializer=e}M(e,t,i,r){const s=new K0("createOrUpgrade",t);var b;i<1&&r>=1&&(e.createObjectStore("owner"),(b=e).createObjectStore("mutationQueues",{keyPath:"userId"}),b.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",TA,{unique:!0}),b.createObjectStore("documentMutations"),UN(e),function(b){b.createObjectStore("remoteDocuments")}(e));let f=bt.resolve();return i<3&&r>=3&&(0!==i&&(function(b){b.deleteObjectStore("targetDocuments"),b.deleteObjectStore("targets"),b.deleteObjectStore("targetGlobal")}(e),UN(e)),f=f.next(()=>function(b){const I=b.store("targetGlobal"),O={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:pi.min().toTimestamp(),targetCount:0};return I.put("targetGlobalKey",O)}(s))),i<4&&r>=4&&(0!==i&&(f=f.next(()=>function(b,I){return I.store("mutations").j().next(O=>{b.deleteObjectStore("mutations"),b.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",TA,{unique:!0});const B=I.store("mutations"),K=O.map(le=>B.put(le));return bt.waitFor(K)})}(e,s))),f=f.next(()=>{!function(b){b.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),i<5&&r>=5&&(f=f.next(()=>this.qs(s))),i<6&&r>=6&&(f=f.next(()=>(function(b){b.createObjectStore("remoteDocumentGlobal")}(e),this.Us(s)))),i<7&&r>=7&&(f=f.next(()=>this.Ks(s))),i<8&&r>=8&&(f=f.next(()=>this.Gs(e,s))),i<9&&r>=9&&(f=f.next(()=>{!function(b){b.objectStoreNames.contains("remoteDocumentChanges")&&b.deleteObjectStore("remoteDocumentChanges")}(e)})),i<10&&r>=10&&(f=f.next(()=>this.Qs(s))),i<11&&r>=11&&(f=f.next(()=>{(function(b){b.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(b){b.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),i<12&&r>=12&&(f=f.next(()=>{!function(b){const I=b.createObjectStore("documentOverlays",{keyPath:SA});I.createIndex("collectionPathOverlayIndex",VL,{unique:!1}),I.createIndex("collectionGroupOverlayIndex",MA,{unique:!1})}(e)})),i<13&&r>=13&&(f=f.next(()=>function(b){const I=b.createObjectStore("remoteDocumentsV14",{keyPath:LL});I.createIndex("documentKeyIndex",NL),I.createIndex("collectionGroupIndex",Sw)}(e)).next(()=>this.zs(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(f=f.next(()=>this.js(e,s))),i<15&&r>=15&&(f=f.next(()=>function(b){b.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),b.createObjectStore("indexState",{keyPath:QI}).createIndex("sequenceNumberIndex",BL,{unique:!1}),b.createObjectStore("indexEntries",{keyPath:XC}).createIndex("documentKeyIndex",JI,{unique:!1})}(e))),f}Us(e){let t=0;return e.store("remoteDocuments").Z((i,r)=>{t+=AS(r)}).next(()=>{const i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}qs(e){const t=e.store("mutationQueues"),i=e.store("mutations");return t.j().next(r=>bt.forEach(r,s=>{const f=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.j("userMutationsIndex",f).next(b=>bt.forEach(b,I=>{ai(I.userId===s.userId);const O=hb(this.serializer,I);return DN(e,s.userId,O).next(()=>{})}))}))}Ks(e){const t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return i.Z((f,b)=>{const I=new Pr(f),O=[0,Cc(I)];s.push(t.get(O).next(B=>B?bt.resolve():t.put({targetId:0,path:Cc(I),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>bt.waitFor(s))})}Gs(e,t){e.createObjectStore("collectionParents",{keyPath:XI});const i=t.store("collectionParents"),r=new cP,s=f=>{if(r.add(f)){const b=f.lastSegment(),I=f.popLast();return i.put({collectionId:b,parent:Cc(I)})}};return t.store("remoteDocuments").Z({Y:!0},(f,b)=>{const I=new Pr(f);return s(I.popLast())}).next(()=>t.store("documentMutations").Z({Y:!0},([f,b,I],O)=>{const B=yp(b);return s(B.popLast())}))}Qs(e){const t=e.store("targets");return t.Z((i,r)=>{const s=gE(r),f=gN(this.serializer,s);return t.put(f)})}zs(e,t){const i=t.store("remoteDocuments"),r=[];return i.Z((s,f)=>{const b=t.store("remoteDocumentsV14"),I=(O=f,O.document?new Pn(Pr.fromString(O.document.name).popFirst(5)):O.noDocument?Pn.fromSegments(O.noDocument.path):O.unknownDocument?Pn.fromSegments(O.unknownDocument.path):Hn()).path.toArray();var O;const B={prefixPath:I.slice(0,I.length-2),collectionGroup:I[I.length-2],documentId:I[I.length-1],readTime:f.readTime||[0,0],unknownDocument:f.unknownDocument,noDocument:f.noDocument,document:f.document,hasCommittedMutations:!!f.hasCommittedMutations};r.push(b.put(B))}).next(()=>bt.waitFor(r))}js(e,t){const i=t.store("mutations"),r=FN(this.serializer),s=new VN(kS.Fs,this.serializer.se);return i.j().next(f=>{const b=new Map;return f.forEach(I=>{var O;let B=null!==(O=b.get(I.userId))&&void 0!==O?O:lr();hb(this.serializer,I).keys().forEach(K=>B=B.add(K)),b.set(I.userId,B)}),bt.forEach(b,(I,O)=>{const B=new qs(O),K=IS.ie(this.serializer,B),le=s.getIndexManager(B),ge=PS.ie(B,this.serializer,le,s.referenceDelegate);return new BN(r,ge,K,le).recalculateAndSaveOverlaysForDocumentKeys(new nS(t,wc.ct),I).next()})})}}function UN(n){n.createObjectStore("targetDocuments",{keyPath:KI}).createIndex("documentTargetsIndex",Mw,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",zL,{unique:!0}),n.createObjectStore("targetGlobal")}const dP="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class hP{constructor(e,t,i,r,s,f,b,I,O,B,K=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Ws=s,this.window=f,this.document=b,this.Hs=O,this.Js=B,this.Ys=K,this.Vs=null,this.Ss=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.Xs=null,this.ti=null,this.ei=Number.NEGATIVE_INFINITY,this.ni=le=>Promise.resolve(),!hP.D())throw new Wt(Ct.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new T6(this,r),this.si=t+"main",this.serializer=new pN(I),this.ii=new nd(this.si,this.Ys,new L6(this.serializer)),this.Ds=new x6(this.referenceDelegate,this.serializer),this.remoteDocumentCache=FN(this.serializer),this.xs=new h6,this.window&&this.window.localStorage?this.ri=this.window.localStorage:(this.ri=null,!1===B&&Cs("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.oi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Wt(Ct.FAILED_PRECONDITION,dP);return this.ui(),this.ci(),this.ai(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ds.getHighestSequenceNumber(e))}).then(e=>{this.Vs=new wc(e,this.Hs)}).then(()=>{this.Ss=!0}).catch(e=>(this.ii&&this.ii.close(),Promise.reject(e)))}hi(e){var t=this;return this.ni=function(){var i=(0,V.Z)(function*(r){if(t.started)return e(r)});return function(r){return i.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ii.B(function(){var t=(0,V.Z)(function*(i){null===i.newVersion&&(yield e())});return function(i){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Ws.enqueueAndForget((0,V.Z)(function*(){t.started&&(yield t.oi())})))}oi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>RS(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.li(e).next(t=>{t||(this.isPrimary=!1,this.Ws.enqueueRetryable(()=>this.ni(!1)))})}).next(()=>this.fi(e)).next(t=>this.isPrimary&&!t?this.di(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(_p(e))return sn("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return sn("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ws.enqueueRetryable(()=>this.ni(e)),this.isPrimary=e})}li(e){return wE(e).get("owner").next(t=>bt.resolve(this._i(t)))}mi(e){return RS(e).delete(this.clientId)}gi(){var e=this;return(0,V.Z)(function*(){if(e.isPrimary&&!e.yi(e.ei,18e5)){e.ei=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",i=>{const r=Ga(i,"clientMetadata");return r.j().next(s=>{const f=e.pi(s,18e5),b=s.filter(I=>-1===f.indexOf(I));return bt.forEach(b,I=>r.delete(I.clientId)).next(()=>b)})}).catch(()=>[]);if(e.ri)for(const i of t)e.ri.removeItem(e.Ii(i.clientId))}})()}ai(){this.ti=this.Ws.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.oi().then(()=>this.gi()).then(()=>this.ai()))}_i(e){return!!e&&e.ownerId===this.clientId}fi(e){return this.Js?bt.resolve(!0):wE(e).get("owner").next(t=>{if(null!==t&&this.yi(t.leaseTimestampMs,5e3)&&!this.Ti(t.ownerId)){if(this._i(t)&&this.networkEnabled)return!0;if(!this._i(t)){if(!t.allowTabSynchronization)throw new Wt(Ct.FAILED_PRECONDITION,dP);return!1}}return!(!this.networkEnabled||!this.inForeground)||RS(e).j().next(i=>void 0===this.pi(i,5e3).find(r=>!(this.clientId===r.clientId||!(!this.networkEnabled&&r.networkEnabled||!this.inForeground&&r.inForeground&&this.networkEnabled===r.networkEnabled))))}).next(t=>(this.isPrimary!==t&&sn("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,V.Z)(function*(){e.Ss=!1,e.Ei(),e.ti&&(e.ti.cancel(),e.ti=null),e.Ai(),e.Ri(),yield e.ii.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const i=new nS(t,wc.ct);return e.di(i).next(()=>e.mi(i))}),e.ii.close(),e.vi()})()}pi(e,t){return e.filter(i=>this.yi(i.updateTimeMs,t)&&!this.Ti(i.clientId))}bi(){return this.runTransaction("getActiveClients","readonly",e=>RS(e).j().next(t=>this.pi(t,18e5).map(i=>i.clientId)))}get started(){return this.Ss}getMutationQueue(e,t){return PS.ie(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ds}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new b6(e,this.serializer.se.databaseId)}getDocumentOverlayCache(e){return IS.ie(this.serializer,e)}getBundleCache(){return this.xs}runTransaction(e,t,i){sn("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",s=15===(f=this.Ys)?UL:14===f?tS:13===f?Q0:12===f?DA:11===f?eS:void Hn();var f;let b;return this.ii.runTransaction(e,r,s,I=>(b=new nS(I,this.Vs?this.Vs.next():wc.ct),"readwrite-primary"===t?this.li(b).next(O=>!!O||this.fi(b)).next(O=>{if(!O)throw Cs(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ws.enqueueRetryable(()=>this.ni(!1)),new Wt(Ct.FAILED_PRECONDITION,HI);return i(b)}).next(O=>this.wi(b).next(()=>O)):this.Pi(b).next(()=>i(b)))).then(I=>(b.raiseOnCommittedEvent(),I))}Pi(e){return wE(e).get("owner").next(t=>{if(null!==t&&this.yi(t.leaseTimestampMs,5e3)&&!this.Ti(t.ownerId)&&!this._i(t)&&!(this.Js||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Wt(Ct.FAILED_PRECONDITION,dP)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return wE(e).put("owner",t)}static D(){return nd.D()}di(e){const t=wE(e);return t.get("owner").next(i=>this._i(i)?(sn("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):bt.resolve())}yi(e,t){const i=Date.now();return!(e<i-t||e>i&&(Cs(`Detected an update time that is in the future: ${e} > ${i}`),1))}ui(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Xs=()=>{this.Ws.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.oi()))},this.document.addEventListener("visibilitychange",this.Xs),this.inForeground="visible"===this.document.visibilityState)}Ai(){this.Xs&&(this.document.removeEventListener("visibilitychange",this.Xs),this.Xs=null)}ci(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=()=>{this.Ei();const t=/(?:Version|Mobile)\/1[456]/;(0,te.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ws.enterRestrictedMode(!0),this.Ws.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}Ri(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ti(e){var t;try{const i=null!==(null===(t=this.ri)||void 0===t?void 0:t.getItem(this.Ii(e)));return sn("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Cs("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Ei(){if(this.ri)try{this.ri.setItem(this.Ii(this.clientId),String(Date.now()))}catch(e){Cs("Failed to set zombie client id.",e)}}vi(){if(this.ri)try{this.ri.removeItem(this.Ii(this.clientId))}catch{}}Ii(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function wE(n){return Ga(n,"owner")}function RS(n){return Ga(n,"clientMetadata")}function fP(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class pP{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Vi=i,this.Si=r}static Di(e,t){let i=lr(),r=lr();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new pP(e,t.fromCache,i,r)}}class jN{constructor(){this.Ci=!1}initialize(e,t){this.xi=e,this.indexManager=t,this.Ci=!0}getDocumentsMatchingQuery(e,t,i,r){return this.Ni(e,t).next(s=>s||this.ki(e,t,r,i)).next(s=>s||this.Oi(e,t))}Ni(e,t){if(VA(t))return bt.resolve(null);let i=$l(t);return this.indexManager.getIndexType(e,i).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Nw(t,null,"F"),i=$l(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const f=lr(...s);return this.xi.getDocuments(e,f).next(b=>this.indexManager.getMinOffset(e,i).next(I=>{const O=this.$i(t,b);return this.Mi(t,O,f,I.readTime)?this.Ni(e,Nw(t,null,"F")):this.Fi(e,O,t,I)}))})))}ki(e,t,i,r){return VA(t)||r.isEqual(pi.min())?this.Oi(e,t):this.xi.getDocuments(e,i).next(s=>{const f=this.$i(t,s);return this.Mi(t,f,i,r)?this.Oi(e,t):(jC()<=se.in.DEBUG&&sn("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),zw(t)),this.Fi(e,f,t,$I(r,-1)))})}$i(e,t){let i=new so(vS(e));return t.forEach((r,s)=>{tv(e,s)&&(i=i.add(s))}),i}Mi(e,t,i,r){if(null===e.limit)return!1;if(i.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Oi(e,t){return jC()<=se.in.DEBUG&&sn("QueryEngine","Using full collection scan to execute query:",zw(t)),this.xi.getDocumentsMatchingQuery(e,t,jl.min())}Fi(e,t,i,r){return this.xi.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(f=>{s=s.insert(f.key,f)}),s))}}class N6{constructor(e,t,i,r){this.persistence=e,this.Bi=t,this.serializer=r,this.Li=new Ls($i),this.qi=new uf(s=>Bm(s),Kd),this.Ui=new Map,this.Ki=e.getRemoteDocumentCache(),this.Ds=e.getTargetCache(),this.xs=e.getBundleCache(),this.Gi(i)}Gi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new BN(this.Ki,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ki.setIndexManager(this.indexManager),this.Bi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Li))}}function $N(n,e,t,i){return new N6(n,e,t,i)}function GN(n,e){return mP.apply(this,arguments)}function mP(){return mP=(0,V.Z)(function*(n,e){const t=Rn(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.Gi(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{const f=[],b=[];let I=lr();for(const O of r){f.push(O.batchId);for(const B of O.mutations)I=I.add(B.key)}for(const O of s){b.push(O.batchId);for(const B of O.mutations)I=I.add(B.key)}return t.localDocuments.getDocuments(i,I).next(O=>({Qi:O,removedBatchIds:f,addedBatchIds:b}))})})}),mP.apply(this,arguments)}function HN(n){const e=Rn(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ds.getLastRemoteSnapshotVersion(t))}function qN(n,e,t){let i=lr(),r=lr();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let f=Gl();return t.forEach((b,I)=>{const O=s.get(b);I.isFoundDocument()!==O.isFoundDocument()&&(r=r.add(b)),I.isNoDocument()&&I.version.isEqual(pi.min())?(e.removeEntry(b,I.readTime),f=f.insert(b,I)):!O.isValidDocument()||I.version.compareTo(O.version)>0||0===I.version.compareTo(O.version)&&O.hasPendingWrites?(e.addEntry(I),f=f.insert(b,I)):sn("LocalStore","Ignoring outdated watch update for ",b,". Current version:",O.version," Watch version:",I.version)}),{zi:f,ji:r}})}function V6(n,e){const t=Rn(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Gw(n,e){const t=Rn(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Ds.getTargetData(i,e).next(s=>s?(r=s,bt.resolve(r)):t.Ds.allocateTargetId(i).next(f=>(r=new iv(e,f,0,i.currentSequenceNumber),t.Ds.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=t.Li.get(i.targetId);return(null===r||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Li=t.Li.insert(i.targetId,i),t.qi.set(e,i.targetId)),i})}function Hw(n,e,t){return gP.apply(this,arguments)}function gP(){return gP=(0,V.Z)(function*(n,e,t){const i=Rn(n),r=i.Li.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,f=>i.persistence.referenceDelegate.removeTarget(f,r)))}catch(f){if(!_p(f))throw f;sn("LocalStore",`Failed to update sequence numbers for target ${e}: ${f}`)}i.Li=i.Li.remove(e),i.qi.delete(r.target)}),gP.apply(this,arguments)}function FS(n,e,t){const i=Rn(n);let r=pi.min(),s=lr();return i.persistence.runTransaction("Execute query","readonly",f=>function(b,I,O){const B=Rn(b),K=B.qi.get(O);return void 0!==K?bt.resolve(B.Li.get(K)):B.Ds.getTargetData(I,O)}(i,f,$l(e)).next(b=>{if(b)return r=b.lastLimboFreeSnapshotVersion,i.Ds.getMatchingKeysForTargetId(f,b.targetId).next(I=>{s=I})}).next(()=>i.Bi.getDocumentsMatchingQuery(f,e,t?r:pi.min(),t?s:lr())).next(b=>(YN(i,yS(e),b),{documents:b,Wi:s})))}function ZN(n,e){const t=Rn(n),i=Rn(t.Ds),r=t.Li.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>i.ne(s,e).next(f=>f?f.target:null))}function WN(n,e){const t=Rn(n),i=t.Ui.get(e)||pi.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.Ki.getAllFromCollectionGroup(r,e,$I(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(YN(t,e,r),r))}function YN(n,e,t){let i=n.Ui.get(e)||pi.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.Ui.set(e,i)}function _P(){return _P=(0,V.Z)(function*(n,e,t,i){const r=Rn(n);let s=lr(),f=Gl();for(const O of t){const B=e.Hi(O.metadata.name);O.document&&(s=s.add(B));const K=e.Ji(O);K.setReadTime(e.Yi(O.metadata.readTime)),f=f.insert(B,K)}const b=r.Ki.newChangeBuffer({trackRemovals:!0}),I=yield Gw(r,(O=i,$l(wp(Pr.fromString(`__bundle__/docs/${O}`)))));var O;return r.persistence.runTransaction("Apply bundle documents","readwrite",O=>qN(O,b,f).next(B=>(b.apply(O),B)).next(B=>r.Ds.removeMatchingKeysForTargetId(O,I.targetId).next(()=>r.Ds.addMatchingKeys(O,s,I.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(O,B.zi,B.ji)).next(()=>B.zi)))}),_P.apply(this,arguments)}function j6(n,e){return yP.apply(this,arguments)}function yP(){return yP=(0,V.Z)(function*(n,e,t=lr()){const i=yield Gw(n,$l(iP(e.bundledQuery))),r=Rn(n);return r.persistence.runTransaction("Save named query","readwrite",s=>{const f=ra(e.readTime);if(i.snapshotVersion.compareTo(f)>=0)return r.xs.saveNamedQuery(s,e);const b=i.withResumeToken(Ca.EMPTY_BYTE_STRING,f);return r.Li=r.Li.insert(b.targetId,b),r.Ds.updateTargetData(s,b).next(()=>r.Ds.removeMatchingKeysForTargetId(s,i.targetId)).next(()=>r.Ds.addMatchingKeys(s,t,i.targetId)).next(()=>r.xs.saveNamedQuery(s,e))})}),yP.apply(this,arguments)}function KN(n,e){return`firestore_clients_${n}_${e}`}function XN(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function vP(n,e){return`firestore_targets_${n}_${e}`}class LS{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static Zi(e,t,i){const r=JSON.parse(i);let s,f="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return f&&r.error&&(f="string"==typeof r.error.message&&"string"==typeof r.error.code,f&&(s=new Wt(r.error.code,r.error.message))),f?new LS(e,t,r.state,s):(Cs("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}Xi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class CE{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Zi(e,t){const i=JSON.parse(t);let r,s="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return s&&i.error&&(s="string"==typeof i.error.message&&"string"==typeof i.error.code,s&&(r=new Wt(i.error.code,i.error.message))),s?new CE(e,i.state,r):(Cs("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Xi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class NS{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Zi(e,t){const i=JSON.parse(t);let r="object"==typeof i&&i.activeTargetIds instanceof Array,s=cE();for(let f=0;r&&f<i.activeTargetIds.length;++f)r=WI(i.activeTargetIds[f]),s=s.add(i.activeTargetIds[f]);return r?new NS(e,s):(Cs("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class bP{constructor(e,t){this.clientId=e,this.onlineState=t}static Zi(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new bP(t.clientId,t.onlineState):(Cs("SharedClientState",`Failed to parse online state: ${e}`),null)}}class xP{constructor(){this.activeTargetIds=cE()}tr(e){this.activeTargetIds=this.activeTargetIds.add(e)}er(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Xi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class wP{constructor(e,t,i,r,s){this.window=e,this.Ws=t,this.persistenceKey=i,this.nr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.sr=this.ir.bind(this),this.rr=new Ls($i),this.started=!1,this.ur=[];const f=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.cr=KN(this.persistenceKey,this.nr),this.ar=`firestore_sequence_number_${this.persistenceKey}`,this.rr=this.rr.insert(this.nr,new xP),this.hr=new RegExp(`^firestore_clients_${f}_([^_]*)$`),this.lr=new RegExp(`^firestore_mutations_${f}_(\\d+)(?:_(.*))?$`),this.dr=new RegExp(`^firestore_targets_${f}_(\\d+)$`),this.wr=`firestore_online_state_${this.persistenceKey}`,this._r=function(b){return`firestore_bundle_loaded_v2_${b}`}(this.persistenceKey),this.window.addEventListener("storage",this.sr)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,V.Z)(function*(){const t=yield e.syncEngine.bi();for(const r of t){if(r===e.nr)continue;const s=e.getItem(KN(e.persistenceKey,r));if(s){const f=NS.Zi(r,s);f&&(e.rr=e.rr.insert(f.clientId,f))}}e.mr();const i=e.storage.getItem(e.wr);if(i){const r=e.gr(i);r&&e.yr(r)}for(const r of e.ur)e.ir(r);e.ur=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ar,JSON.stringify(e))}getAllActiveQueryTargets(){return this.pr(this.rr)}isActiveQueryTarget(e){let t=!1;return this.rr.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ir(e,"pending")}updateMutationState(e,t,i){this.Ir(e,t,i),this.Tr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(vP(this.persistenceKey,e));if(i){const r=CE.Zi(e,i);r&&(t=r.state)}}return this.Er.tr(e),this.mr(),t}removeLocalQueryTarget(e){this.Er.er(e),this.mr()}isLocalQueryTarget(e){return this.Er.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(vP(this.persistenceKey,e))}updateQueryState(e,t,i){this.Ar(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.Tr(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Rr(e)}notifyBundleLoaded(e){this.vr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.sr),this.removeItem(this.cr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return sn("SharedClientState","READ",e,t),t}setItem(e,t){sn("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){sn("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ir(e){var t=this;const i=e;if(i.storageArea===this.storage){if(sn("SharedClientState","EVENT",i.key,i.newValue),i.key===this.cr)return void Cs("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ws.enqueueRetryable((0,V.Z)(function*(){if(t.started){if(null!==i.key)if(t.hr.test(i.key)){if(null==i.newValue){const r=t.br(i.key);return t.Pr(r,null)}{const r=t.Vr(i.key,i.newValue);if(r)return t.Pr(r.clientId,r)}}else if(t.lr.test(i.key)){if(null!==i.newValue){const r=t.Sr(i.key,i.newValue);if(r)return t.Dr(r)}}else if(t.dr.test(i.key)){if(null!==i.newValue){const r=t.Cr(i.key,i.newValue);if(r)return t.Nr(r)}}else if(i.key===t.wr){if(null!==i.newValue){const r=t.gr(i.newValue);if(r)return t.yr(r)}}else if(i.key===t.ar){const r=function(s){let f=wc.ct;if(null!=s)try{const b=JSON.parse(s);ai("number"==typeof b),f=b}catch(b){Cs("SharedClientState","Failed to read sequence number from WebStorage",b)}return f}(i.newValue);r!==wc.ct&&t.sequenceNumberHandler(r)}else if(i.key===t._r){const r=t.kr(i.newValue);yield Promise.all(r.map(s=>t.syncEngine.Or(s)))}}else t.ur.push(i)}))}}get Er(){return this.rr.get(this.nr)}mr(){this.setItem(this.cr,this.Er.Xi())}Ir(e,t,i){const r=new LS(this.currentUser,e,t,i),s=XN(this.persistenceKey,this.currentUser,e);this.setItem(s,r.Xi())}Tr(e){const t=XN(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Rr(e){this.storage.setItem(this.wr,JSON.stringify({clientId:this.nr,onlineState:e}))}Ar(e,t,i){const r=vP(this.persistenceKey,e),s=new CE(e,t,i);this.setItem(r,s.Xi())}vr(e){const t=JSON.stringify(Array.from(e));this.setItem(this._r,t)}br(e){const t=this.hr.exec(e);return t?t[1]:null}Vr(e,t){const i=this.br(e);return NS.Zi(i,t)}Sr(e,t){const i=this.lr.exec(e),r=Number(i[1]);return LS.Zi(new qs(void 0!==i[2]?i[2]:null),r,t)}Cr(e,t){const i=this.dr.exec(e),r=Number(i[1]);return CE.Zi(r,t)}gr(e){return bP.Zi(e)}kr(e){return JSON.parse(e)}Dr(e){var t=this;return(0,V.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.$r(e.batchId,e.state,e.error);sn("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Nr(e){return this.syncEngine.Mr(e.targetId,e.state,e.error)}Pr(e,t){const i=t?this.rr.insert(e,t):this.rr.remove(e),r=this.pr(this.rr),s=this.pr(i),f=[],b=[];return s.forEach(I=>{r.has(I)||f.push(I)}),r.forEach(I=>{s.has(I)||b.push(I)}),this.syncEngine.Fr(f,b).then(()=>{this.rr=i})}yr(e){this.rr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}pr(e){let t=cE();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class QN{constructor(){this.Br=new xP,this.Lr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.Br.tr(e),this.Lr[e]||"not-current"}updateQueryState(e,t,i){this.Lr[e]=t}removeLocalQueryTarget(e){this.Br.er(e)}isLocalQueryTarget(e){return this.Br.activeTargetIds.has(e)}clearQueryState(e){delete this.Lr[e]}getAllActiveQueryTargets(){return this.Br.activeTargetIds}isActiveQueryTarget(e){return this.Br.activeTargetIds.has(e)}start(){return this.Br=new xP,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class $6{qr(e){}shutdown(){}}class JN{constructor(){this.Ur=()=>this.Kr(),this.Gr=()=>this.Qr(),this.zr=[],this.jr()}qr(e){this.zr.push(e)}shutdown(){window.removeEventListener("online",this.Ur),window.removeEventListener("offline",this.Gr)}jr(){window.addEventListener("online",this.Ur),window.addEventListener("offline",this.Gr)}Kr(){sn("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.zr)e(0)}Qr(){sn("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.zr)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let zS=null;function CP(){return null===zS?zS=268435456+Math.round(2147483648*Math.random()):zS++,"0x"+zS.toString(16)}const G6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class H6{constructor(e){this.Wr=e.Wr,this.Hr=e.Hr}Jr(e){this.Yr=e}Zr(e){this.Xr=e}onMessage(e){this.eo=e}close(){this.Hr()}send(e){this.Wr(e)}no(){this.Yr()}so(e){this.Xr(e)}io(e){this.eo(e)}}const Tc="WebChannelConnection";class q6 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.ro=(e.ssl?"https":"http")+"://"+e.host,this.oo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get uo(){return!1}co(e,t,i,r,s){const f=CP(),b=this.ao(e,t);sn("RestConnection",`Sending RPC '${e}' ${f}:`,b,i);const I={};return this.ho(I,r,s),this.lo(e,b,I,i).then(O=>(sn("RestConnection",`Received RPC '${e}' ${f}: `,O),O),O=>{throw td("RestConnection",`RPC '${e}' ${f} failed with error: `,O,"url: ",b,"request:",i),O})}fo(e,t,i,r,s,f){return this.co(e,t,i,r,s)}ho(e,t,i){e["X-Goog-Api-Client"]="gl-js/ fire/"+km,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),i&&i.headers.forEach((r,s)=>e[s]=r)}ao(e,t){return`${this.ro}/v1/${t}:${G6[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}lo(e,t,i,r){const s=CP();return new Promise((f,b)=>{const I=new VC;I.setWithCredentials(!0),I.listenOnce(FI.COMPLETE,()=>{try{switch(I.getLastErrorCode()){case BC.NO_ERROR:const B=I.getResponseJson();sn(Tc,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(B)),f(B);break;case BC.TIMEOUT:sn(Tc,`RPC '${e}' ${s} timed out`),b(new Wt(Ct.DEADLINE_EXCEEDED,"Request time out"));break;case BC.HTTP_ERROR:const K=I.getStatus();if(sn(Tc,`RPC '${e}' ${s} failed with status:`,K,"response text:",I.getResponseText()),K>0){let le=I.getResponseJson();Array.isArray(le)&&(le=le[0]);const ge=le?.error;if(ge&&ge.status&&ge.message){const Te=function(Ge){const Je=Ge.toLowerCase().replace(/_/g,"-");return Object.values(Ct).indexOf(Je)>=0?Je:Ct.UNKNOWN}(ge.status);b(new Wt(Te,ge.message))}else b(new Wt(Ct.UNKNOWN,"Server responded with status "+I.getStatus()))}else b(new Wt(Ct.UNAVAILABLE,"Connection failed."));break;default:Hn()}}finally{sn(Tc,`RPC '${e}' ${s} completed.`)}});const O=JSON.stringify(r);sn(Tc,`RPC '${e}' ${s} sending request:`,r),I.send(t,"POST",O,i,15)})}wo(e,t,i){const r=CP(),s=[this.ro,"/","google.firestore.v1.Firestore","/",e,"/channel"],f=Cw(),b=mA(),I={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(I.xmlHttpFactory=new NI({})),this.ho(I.initMessageHeaders,t,i),I.encodeInitMessageHeaders=!0;const O=s.join("");sn(Tc,`Creating RPC '${e}' stream ${r}: ${O}`,I);const B=f.createWebChannel(O,I);let K=!1,le=!1;const ge=new H6({Wr:Ge=>{le?sn(Tc,`Not sending because RPC '${e}' stream ${r} is closed:`,Ge):(K||(sn(Tc,`Opening RPC '${e}' stream ${r} transport.`),B.open(),K=!0),sn(Tc,`RPC '${e}' stream ${r} sending:`,Ge),B.send(Ge))},Hr:()=>B.close()}),Te=(Ge,Je,Qt)=>{Ge.listen(Je,xn=>{try{Qt(xn)}catch(zn){setTimeout(()=>{throw zn},0)}})};return Te(B,qy.EventType.OPEN,()=>{le||sn(Tc,`RPC '${e}' stream ${r} transport opened.`)}),Te(B,qy.EventType.CLOSE,()=>{le||(le=!0,sn(Tc,`RPC '${e}' stream ${r} transport closed`),ge.so())}),Te(B,qy.EventType.ERROR,Ge=>{le||(le=!0,td(Tc,`RPC '${e}' stream ${r} transport errored:`,Ge),ge.so(new Wt(Ct.UNAVAILABLE,"The operation could not be completed")))}),Te(B,qy.EventType.MESSAGE,Ge=>{var Je;if(!le){const Qt=Ge.data[0];ai(!!Qt);const zn=Qt.error||(null===(Je=Qt[0])||void 0===Je?void 0:Je.error);if(zn){sn(Tc,`RPC '${e}' stream ${r} received error:`,zn);const li=zn.status;let Gi=function(ao){const ml=Ea[ao];if(void 0!==ml)return XL(ml)}(li),Ki=zn.message;void 0===Gi&&(Gi=Ct.INTERNAL,Ki="Unknown error status: "+li+" with message "+zn.message),le=!0,ge.so(new Wt(Gi,Ki)),B.close()}else sn(Tc,`RPC '${e}' stream ${r} received:`,Qt),ge.io(Qt)}}),Te(b,LI.STAT_EVENT,Ge=>{Ge.stat===Ew.PROXY?sn(Tc,`RPC '${e}' stream ${r} detected buffering proxy`):Ge.stat===Ew.NOPROXY&&sn(Tc,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{ge.no()},0),ge}}function ez(){return typeof window<"u"?window:null}function BS(){return typeof document<"u"?document:null}function EE(n){return new t6(n,!0)}class EP{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Ws=e,this.timerId=t,this._o=i,this.mo=r,this.yo=s,this.po=0,this.Io=null,this.To=Date.now(),this.reset()}reset(){this.po=0}Eo(){this.po=this.yo}Ao(e){this.cancel();const t=Math.floor(this.po+this.Ro()),i=Math.max(0,Date.now()-this.To),r=Math.max(0,t-i);r>0&&sn("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.po} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.Io=this.Ws.enqueueAfterDelay(this.timerId,r,()=>(this.To=Date.now(),e())),this.po*=this.mo,this.po<this._o&&(this.po=this._o),this.po>this.yo&&(this.po=this.yo)}vo(){null!==this.Io&&(this.Io.skipDelay(),this.Io=null)}cancel(){null!==this.Io&&(this.Io.cancel(),this.Io=null)}Ro(){return(Math.random()-.5)*this.po}}class tz{constructor(e,t,i,r,s,f,b,I){this.Ws=e,this.bo=i,this.Po=r,this.connection=s,this.authCredentialsProvider=f,this.appCheckCredentialsProvider=b,this.listener=I,this.state=0,this.Vo=0,this.So=null,this.Do=null,this.stream=null,this.Co=new EP(e,t)}xo(){return 1===this.state||5===this.state||this.No()}No(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.ko()}stop(){var e=this;return(0,V.Z)(function*(){e.xo()&&(yield e.close(0))})()}Oo(){this.state=0,this.Co.reset()}$o(){this.No()&&null===this.So&&(this.So=this.Ws.enqueueAfterDelay(this.bo,6e4,()=>this.Mo()))}Fo(e){this.Bo(),this.stream.send(e)}Mo(){var e=this;return(0,V.Z)(function*(){if(e.No())return e.close(0)})()}Bo(){this.So&&(this.So.cancel(),this.So=null)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}close(e,t){var i=this;return(0,V.Z)(function*(){i.Bo(),i.Lo(),i.Co.cancel(),i.Vo++,4!==e?i.Co.reset():t&&t.code===Ct.RESOURCE_EXHAUSTED?(Cs(t.toString()),Cs("Using maximum backoff delay to prevent overloading the backend."),i.Co.Eo()):t&&t.code===Ct.UNAUTHENTICATED&&3!==i.state&&(i.authCredentialsProvider.invalidateToken(),i.appCheckCredentialsProvider.invalidateToken()),null!==i.stream&&(i.qo(),i.stream.close(),i.stream=null),i.state=e,yield i.listener.Zr(t)})()}qo(){}auth(){this.state=1;const e=this.Uo(this.Vo),t=this.Vo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Vo===t&&this.Ko(i,r)},i=>{e(()=>{const r=new Wt(Ct.UNKNOWN,"Fetching auth token failed: "+i.message);return this.Go(r)})})}Ko(e,t){const i=this.Uo(this.Vo);this.stream=this.Qo(e,t),this.stream.Jr(()=>{i(()=>(this.state=2,this.Do=this.Ws.enqueueAfterDelay(this.Po,1e4,()=>(this.No()&&(this.state=3),Promise.resolve())),this.listener.Jr()))}),this.stream.Zr(r=>{i(()=>this.Go(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}ko(){var e=this;this.state=5,this.Co.Ao((0,V.Z)(function*(){e.state=0,e.start()}))}Go(e){return sn("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Uo(e){return t=>{this.Ws.enqueueAndForget(()=>this.Vo===e?t():(sn("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Z6 extends tz{constructor(e,t,i,r,s,f){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,f),this.serializer=s}Qo(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.Co.reset();const t=function r6(n,e){let t;if("targetChange"in e){const i="NO_CHANGE"===(I=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===I?1:"REMOVE"===I?2:"CURRENT"===I?3:"RESET"===I?4:Hn(),r=e.targetChange.targetIds||[],s=function(I,O){return I.useProto3Json?(ai(void 0===O||"string"==typeof O),Ca.fromBase64String(O||"")):(ai(void 0===O||O instanceof Uint8Array),Ca.fromUint8Array(O||new Uint8Array))}(n,e.targetChange.resumeToken),f=e.targetChange.cause,b=f&&function(I){const O=void 0===I.code?Ct.UNKNOWN:XL(I.code);return new Wt(O,I.message||"")}(f);t=new JL(i,r,s,b||null)}else if("documentChange"in e){const i=e.documentChange,r=Um(n,i.document.name),s=ra(i.document.updateTime),f=i.document.createTime?ra(i.document.createTime):pi.min(),b=new ia({mapValue:{fields:i.document.fields}}),I=Ao.newFoundDocument(r,s,f,b);t=new ES(i.targetIds||[],i.removedTargetIds||[],I.key,I)}else if("documentDelete"in e){const i=e.documentDelete,r=Um(n,i.document),s=i.readTime?ra(i.readTime):pi.min(),f=Ao.newNoDocument(r,s);t=new ES([],i.removedTargetIds||[],f.key,f)}else if("documentRemove"in e){const i=e.documentRemove,r=Um(n,i.document);t=new ES([],i.removedTargetIds||[],r,null)}else{if(!("filter"in e))return Hn();{const i=e.filter,s=new K5(i.count||0);t=new QL(i.targetId,s)}}var I;return t}(this.serializer,e),i=function(r){if(!("targetChange"in r))return pi.min();const s=r.targetChange;return s.targetIds&&s.targetIds.length?pi.min():s.readTime?ra(s.readTime):pi.min()}(e);return this.listener.zo(t,i)}jo(e){const t={};t.database=pE(this.serializer),t.addTarget=function(r,s){let f;const b=s.target;return f=rb(b)?{documents:cN(r,b)}:{query:nP(r,b)},f.targetId=s.targetId,s.resumeToken.approximateByteSize()>0?f.resumeToken=iN(r,s.resumeToken):s.snapshotVersion.compareTo(pi.min())>0&&(f.readTime=Vw(r,s.snapshotVersion.toTimestamp())),f}(this.serializer,e);const i=function s6(n,e){const t=function(i,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Hn()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);i&&(t.labels=i),this.Fo(t)}Wo(e){const t={};t.database=pE(this.serializer),t.removeTarget=e,this.Fo(t)}}class W6 extends tz{constructor(e,t,i,r,s,f){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,f),this.serializer=s,this.Ho=!1}get Jo(){return this.Ho}start(){this.Ho=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Ho&&this.Yo([])}Qo(e,t){return this.connection.wo("Write",e,t)}onMessage(e){if(ai(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Ho){this.Co.reset();const t=function o6(n,e){return n&&n.length>0?(ai(void 0!==e),n.map(t=>function(i,r){let s=ra(i.updateTime?i.updateTime:r);return s.isEqual(pi.min())&&(s=ra(r)),new oe(s,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),i=ra(e.commitTime);return this.listener.Zo(i,t)}return ai(!e.writeResults||0===e.writeResults.length),this.Ho=!0,this.listener.Xo()}tu(){const e={};e.database=pE(this.serializer),this.Fo(e)}Yo(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>mE(this.serializer,i))};this.Fo(t)}}class Y6 extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.eu=!1}nu(){if(this.eu)throw new Wt(Ct.FAILED_PRECONDITION,"The client has already been terminated.")}co(e,t,i){return this.nu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.co(e,t,i,r,s)).catch(r=>{throw"FirebaseError"===r.name?(r.code===Ct.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Wt(Ct.UNKNOWN,r.toString())})}fo(e,t,i,r){return this.nu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,f])=>this.connection.fo(e,t,i,s,f,r)).catch(s=>{throw"FirebaseError"===s.name?(s.code===Ct.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Wt(Ct.UNKNOWN,s.toString())})}terminate(){this.eu=!0}}class X6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.su=0,this.iu=null,this.ru=!0}ou(){0===this.su&&(this.uu("Unknown"),this.iu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.iu=null,this.cu("Backend didn't respond within 10 seconds."),this.uu("Offline"),Promise.resolve())))}au(e){"Online"===this.state?this.uu("Unknown"):(this.su++,this.su>=1&&(this.hu(),this.cu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.uu("Offline")))}set(e){this.hu(),this.su=0,"Online"===e&&(this.ru=!1),this.uu(e)}uu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}cu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ru?(Cs(t),this.ru=!1):sn("OnlineStateTracker",t)}hu(){null!==this.iu&&(this.iu.cancel(),this.iu=null)}}class Q6{constructor(e,t,i,r,s){var f=this;this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.lu=[],this.fu=new Map,this.du=new Set,this.wu=[],this._u=s,this._u.qr(b=>{i.enqueueAndForget((0,V.Z)(function*(){var I;o_(f)&&(sn("RemoteStore","Restarting streams for network reachability change."),yield(I=(0,V.Z)(function*(O){const B=Rn(O);B.du.add(4),yield qw(B),B.mu.set("Unknown"),B.du.delete(4),yield TE(B)}),function(O){return I.apply(this,arguments)})(f))}))}),this.mu=new X6(i,r)}}function TE(n){return IP.apply(this,arguments)}function IP(){return IP=(0,V.Z)(function*(n){if(o_(n))for(const e of n.wu)yield e(!0)}),IP.apply(this,arguments)}function qw(n){return SP.apply(this,arguments)}function SP(){return SP=(0,V.Z)(function*(n){for(const e of n.wu)yield e(!1)}),SP.apply(this,arguments)}function VS(n,e){const t=Rn(n);t.fu.has(e.targetId)||(t.fu.set(e.targetId,e),AP(t)?DP(t):Ww(t).No()&&MP(t,e))}function IE(n,e){const t=Rn(n),i=Ww(t);t.fu.delete(e),i.No()&&nz(t,e),0===t.fu.size&&(i.No()?i.$o():o_(t)&&t.mu.set("Unknown"))}function MP(n,e){n.gu.Ot(e.targetId),Ww(n).jo(e)}function nz(n,e){n.gu.Ot(e),Ww(n).Wo(e)}function DP(n){n.gu=new X5({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ne:e=>n.fu.get(e)||null}),Ww(n).start(),n.mu.ou()}function AP(n){return o_(n)&&!Ww(n).xo()&&n.fu.size>0}function o_(n){return 0===Rn(n).du.size}function iz(n){n.gu=void 0}function J6(n){return PP.apply(this,arguments)}function PP(){return PP=(0,V.Z)(function*(n){n.fu.forEach((e,t)=>{MP(n,e)})}),PP.apply(this,arguments)}function e$(n,e){return OP.apply(this,arguments)}function OP(){return OP=(0,V.Z)(function*(n,e){iz(n),AP(n)?(n.mu.au(e),DP(n)):n.mu.set("Unknown")}),OP.apply(this,arguments)}function t$(n,e,t){return kP.apply(this,arguments)}function kP(){return kP=(0,V.Z)(function*(n,e,t){if(n.mu.set("Online"),e instanceof JL&&2===e.state&&e.cause)try{yield(i=(0,V.Z)(function*(r,s){const f=s.cause;for(const b of s.targetIds)r.fu.has(b)&&(yield r.remoteSyncer.rejectListen(b,f),r.fu.delete(b),r.gu.removeTarget(b))}),function(r,s){return i.apply(this,arguments)})(n,e)}catch(i){sn("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield US(n,i)}else if(e instanceof ES?n.gu.Kt(e):e instanceof QL?n.gu.Jt(e):n.gu.zt(e),!t.isEqual(pi.min()))try{const i=yield HN(n.localStore);t.compareTo(i)>=0&&(yield function(r,s){const f=r.gu.Xt(s);return f.targetChanges.forEach((b,I)=>{if(b.resumeToken.approximateByteSize()>0){const O=r.fu.get(I);O&&r.fu.set(I,O.withResumeToken(b.resumeToken,s))}}),f.targetMismatches.forEach(b=>{const I=r.fu.get(b);if(!I)return;r.fu.set(b,I.withResumeToken(Ca.EMPTY_BYTE_STRING,I.snapshotVersion)),nz(r,b);const O=new iv(I.target,b,1,I.sequenceNumber);MP(r,O)}),r.remoteSyncer.applyRemoteEvent(f)}(n,t))}catch(i){sn("RemoteStore","Failed to raise snapshot:",i),yield US(n,i)}var i}),kP.apply(this,arguments)}function US(n,e,t){return RP.apply(this,arguments)}function RP(){return RP=(0,V.Z)(function*(n,e,t){if(!_p(e))throw e;n.du.add(1),yield qw(n),n.mu.set("Offline"),t||(t=()=>HN(n.localStore)),n.asyncQueue.enqueueRetryable((0,V.Z)(function*(){sn("RemoteStore","Retrying IndexedDB access"),yield t(),n.du.delete(1),yield TE(n)}))}),RP.apply(this,arguments)}function rz(n,e){return e().catch(t=>US(n,t,e))}function Zw(n){return FP.apply(this,arguments)}function FP(){return FP=(0,V.Z)(function*(n){const e=Rn(n),t=av(e);let i=e.lu.length>0?e.lu[e.lu.length-1].batchId:-1;for(;n$(e);)try{const r=yield V6(e.localStore,i);if(null===r){0===e.lu.length&&t.$o();break}i=r.batchId,i$(e,r)}catch(r){yield US(e,r)}oz(e)&&sz(e)}),FP.apply(this,arguments)}function n$(n){return o_(n)&&n.lu.length<10}function i$(n,e){n.lu.push(e);const t=av(n);t.No()&&t.Jo&&t.Yo(e.mutations)}function oz(n){return o_(n)&&!av(n).xo()&&n.lu.length>0}function sz(n){av(n).start()}function r$(n){return LP.apply(this,arguments)}function LP(){return LP=(0,V.Z)(function*(n){av(n).tu()}),LP.apply(this,arguments)}function o$(n){return NP.apply(this,arguments)}function NP(){return NP=(0,V.Z)(function*(n){const e=av(n);for(const t of n.lu)e.Yo(t.mutations)}),NP.apply(this,arguments)}function s$(n,e,t){return zP.apply(this,arguments)}function zP(){return zP=(0,V.Z)(function*(n,e,t){const i=n.lu.shift(),r=YA.from(i,e,t);yield rz(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield Zw(n)}),zP.apply(this,arguments)}function a$(n,e){return BP.apply(this,arguments)}function BP(){return BP=(0,V.Z)(function*(n,e){var t;e&&av(n).Jo&&(yield(t=(0,V.Z)(function*(i,r){if(KL(s=r.code)&&s!==Ct.ABORTED){const f=i.lu.shift();av(i).Oo(),yield rz(i,()=>i.remoteSyncer.rejectFailedWrite(f.batchId,r)),yield Zw(i)}var s}),function(i,r){return t.apply(this,arguments)})(n,e)),oz(n)&&sz(n)}),BP.apply(this,arguments)}function az(n,e){return VP.apply(this,arguments)}function VP(){return VP=(0,V.Z)(function*(n,e){const t=Rn(n);t.asyncQueue.verifyOperationInProgress(),sn("RemoteStore","RemoteStore received new credentials");const i=o_(t);t.du.add(3),yield qw(t),i&&t.mu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.du.delete(3),yield TE(t)}),VP.apply(this,arguments)}function UP(n,e){return jP.apply(this,arguments)}function jP(){return jP=(0,V.Z)(function*(n,e){const t=Rn(n);e?(t.du.delete(2),yield TE(t)):e||(t.du.add(2),yield qw(t),t.mu.set("Unknown"))}),jP.apply(this,arguments)}function Ww(n){return n.yu||(n.yu=function(e,t,i){const r=Rn(e);return r.nu(),new Z6(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{Jr:J6.bind(null,n),Zr:e$.bind(null,n),zo:t$.bind(null,n)}),n.wu.push(function(){var e=(0,V.Z)(function*(t){t?(n.yu.Oo(),AP(n)?DP(n):n.mu.set("Unknown")):(yield n.yu.stop(),iz(n))});return function(t){return e.apply(this,arguments)}}())),n.yu}function av(n){return n.pu||(n.pu=function(e,t,i){const r=Rn(e);return r.nu(),new W6(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{Jr:r$.bind(null,n),Zr:a$.bind(null,n),Xo:o$.bind(null,n),Zo:s$.bind(null,n)}),n.wu.push(function(){var e=(0,V.Z)(function*(t){t?(n.pu.Oo(),yield Zw(n)):(yield n.pu.stop(),n.lu.length>0&&(sn("RemoteStore",`Stopping write stream with ${n.lu.length} pending writes`),n.lu=[]))});return function(t){return e.apply(this,arguments)}}())),n.pu}class $P{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new na,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(f=>{})}static createAndSchedule(e,t,i,r,s){const f=Date.now()+i,b=new $P(e,t,f,r,s);return b.start(i),b}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Wt(Ct.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Yw(n,e){if(Cs("AsyncQueue",`${e}: ${n}`),_p(n))return new Wt(Ct.UNAVAILABLE,`${e}: ${n}`);throw n}class Kw{constructor(e){this.comparator=e?(t,i)=>e(t,i)||Pn.comparator(t.key,i.key):(t,i)=>Pn.comparator(t.key,i.key),this.keyedMap=sb(),this.sortedSet=new Ls(this.comparator)}static emptySet(e){return new Kw(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Kw)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const i=new Kw;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class lz{constructor(){this.Iu=new Ls(Pn.comparator)}track(e){const t=e.doc.key,i=this.Iu.get(t);i?0!==e.type&&3===i.type?this.Iu=this.Iu.insert(t,e):3===e.type&&1!==i.type?this.Iu=this.Iu.insert(t,{type:i.type,doc:e.doc}):2===e.type&&2===i.type?this.Iu=this.Iu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===i.type?this.Iu=this.Iu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===i.type?this.Iu=this.Iu.remove(t):1===e.type&&2===i.type?this.Iu=this.Iu.insert(t,{type:1,doc:i.doc}):0===e.type&&1===i.type?this.Iu=this.Iu.insert(t,{type:2,doc:e.doc}):Hn():this.Iu=this.Iu.insert(t,e)}Tu(){const e=[];return this.Iu.inorderTraversal((t,i)=>{e.push(i)}),e}}class Xw{constructor(e,t,i,r,s,f,b,I,O){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=f,this.syncStateChanged=b,this.excludesMetadataChanges=I,this.hasCachedResults=O}static fromInitialDocuments(e,t,i,r,s){const f=[];return t.forEach(b=>{f.push({type:0,doc:b})}),new Xw(e,t,Kw.emptySet(t),f,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ob(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}class l${constructor(){this.Eu=void 0,this.listeners=[]}}class c${constructor(){this.queries=new uf(e=>lE(e),ob),this.onlineState="Unknown",this.Au=new Set}}function GP(n,e){return HP.apply(this,arguments)}function HP(){return HP=(0,V.Z)(function*(n,e){const t=Rn(n),i=e.query;let r=!1,s=t.queries.get(i);if(s||(r=!0,s=new l$),r)try{s.Eu=yield t.onListen(i)}catch(f){const b=Yw(f,`Initialization of query '${zw(e.query)}' failed`);return void e.onError(b)}t.queries.set(i,s),s.listeners.push(e),e.Ru(t.onlineState),s.Eu&&e.vu(s.Eu)&&WP(t)}),HP.apply(this,arguments)}function qP(n,e){return ZP.apply(this,arguments)}function ZP(){return ZP=(0,V.Z)(function*(n,e){const t=Rn(n),i=e.query;let r=!1;const s=t.queries.get(i);if(s){const f=s.listeners.indexOf(e);f>=0&&(s.listeners.splice(f,1),r=0===s.listeners.length)}if(r)return t.queries.delete(i),t.onUnlisten(i)}),ZP.apply(this,arguments)}function u$(n,e){const t=Rn(n);let i=!1;for(const r of e){const f=t.queries.get(r.query);if(f){for(const b of f.listeners)b.vu(r)&&(i=!0);f.Eu=r}}i&&WP(t)}function d$(n,e,t){const i=Rn(n),r=i.queries.get(e);if(r)for(const s of r.listeners)s.onError(t);i.queries.delete(e)}function WP(n){n.Au.forEach(e=>{e.next()})}class YP{constructor(e,t,i){this.query=e,this.bu=t,this.Pu=!1,this.Vu=null,this.onlineState="Unknown",this.options=i||{}}vu(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)3!==r.type&&i.push(r);e=new Xw(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Pu?this.Su(e)&&(this.bu.next(e),t=!0):this.Du(e,this.onlineState)&&(this.Cu(e),t=!0),this.Vu=e,t}onError(e){this.bu.error(e)}Ru(e){this.onlineState=e;let t=!1;return this.Vu&&!this.Pu&&this.Du(this.Vu,e)&&(this.Cu(this.Vu),t=!0),t}Du(e,t){return!e.fromCache||(!this.options.xu||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Su(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Vu&&this.Vu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Cu(e){e=Xw.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Pu=!0,this.bu.next(e)}}class h${constructor(e,t){this.Nu=e,this.byteLength=t}ku(){return"metadata"in this.Nu}}class cz{constructor(e){this.serializer=e}Hi(e){return Um(this.serializer,e)}Ji(e){return e.metadata.exists?lN(this.serializer,e.document,!1):Ao.newNoDocument(this.Hi(e.metadata.name),this.Yi(e.metadata.readTime))}Yi(e){return ra(e)}}class f${constructor(e,t,i){this.Ou=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=uz(e)}$u(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Nu.namedQuery)this.queries.push(e.Nu.namedQuery);else if(e.Nu.documentMetadata){this.documents.push({metadata:e.Nu.documentMetadata}),e.Nu.documentMetadata.exists||++t;const i=Pr.fromString(e.Nu.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.Nu.document&&(this.documents[this.documents.length-1].document=e.Nu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Mu(e){const t=new Map,i=new cz(this.serializer);for(const r of e)if(r.metadata.queries){const s=i.Hi(r.metadata.name);for(const f of r.metadata.queries){const b=(t.get(f)||lr()).add(s);t.set(f,b)}}return t}complete(){var e=this;return(0,V.Z)(function*(){const t=yield function U6(n,e,t,i){return _P.apply(this,arguments)}(e.localStore,new cz(e.serializer),e.documents,e.Ou.id),i=e.Mu(e.documents);for(const r of e.queries)yield j6(e.localStore,r,i.get(r.name));return e.progress.taskState="Success",{progress:e.progress,Fu:e.collectionGroups,Bu:t}})()}}function uz(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class dz{constructor(e){this.key=e}}class hz{constructor(e){this.key=e}}class fz{constructor(e,t){this.query=e,this.Lu=t,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Uu=lr(),this.mutatedKeys=lr(),this.Ku=vS(e),this.Gu=new Kw(this.Ku)}get Qu(){return this.Lu}zu(e,t){const i=t?t.ju:new lz,r=t?t.Gu:this.Gu;let s=t?t.mutatedKeys:this.mutatedKeys,f=r,b=!1;const I="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,O="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((B,K)=>{const le=r.get(B),ge=tv(this.query,K)?K:null,Te=!!le&&this.mutatedKeys.has(le.key),Ge=!!ge&&(ge.hasLocalMutations||this.mutatedKeys.has(ge.key)&&ge.hasCommittedMutations);let Je=!1;le&&ge?le.data.isEqual(ge.data)?Te!==Ge&&(i.track({type:3,doc:ge}),Je=!0):this.Wu(le,ge)||(i.track({type:2,doc:ge}),Je=!0,(I&&this.Ku(ge,I)>0||O&&this.Ku(ge,O)<0)&&(b=!0)):!le&&ge?(i.track({type:0,doc:ge}),Je=!0):le&&!ge&&(i.track({type:1,doc:le}),Je=!0,(I||O)&&(b=!0)),Je&&(ge?(f=f.add(ge),s=Ge?s.add(B):s.delete(B)):(f=f.delete(B),s=s.delete(B)))}),null!==this.query.limit)for(;f.size>this.query.limit;){const B="F"===this.query.limitType?f.last():f.first();f=f.delete(B.key),s=s.delete(B.key),i.track({type:1,doc:B})}return{Gu:f,ju:i,Mi:b,mutatedKeys:s}}Wu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i){const r=this.Gu;this.Gu=e.Gu,this.mutatedKeys=e.mutatedKeys;const s=e.ju.Tu();s.sort((O,B)=>function(K,le){const ge=Te=>{switch(Te){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Hn()}};return ge(K)-ge(le)}(O.type,B.type)||this.Ku(O.doc,B.doc)),this.Hu(i);const f=t?this.Ju():[],b=0===this.Uu.size&&this.current?1:0,I=b!==this.qu;return this.qu=b,0!==s.length||I?{snapshot:new Xw(this.query,e.Gu,r,s,e.mutatedKeys,0===b,I,!1,!!i&&i.resumeToken.approximateByteSize()>0),Yu:f}:{Yu:f}}Ru(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Gu:this.Gu,ju:new lz,mutatedKeys:this.mutatedKeys,Mi:!1},!1)):{Yu:[]}}Zu(e){return!this.Lu.has(e)&&!!this.Gu.has(e)&&!this.Gu.get(e).hasLocalMutations}Hu(e){e&&(e.addedDocuments.forEach(t=>this.Lu=this.Lu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Lu=this.Lu.delete(t)),this.current=e.current)}Ju(){if(!this.current)return[];const e=this.Uu;this.Uu=lr(),this.Gu.forEach(i=>{this.Zu(i.key)&&(this.Uu=this.Uu.add(i.key))});const t=[];return e.forEach(i=>{this.Uu.has(i)||t.push(new hz(i))}),this.Uu.forEach(i=>{e.has(i)||t.push(new dz(i))}),t}Xu(e){this.Lu=e.Wi,this.Uu=lr();const t=this.zu(e.documents);return this.applyChanges(t,!0)}tc(){return Xw.fromInitialDocuments(this.query,this.Gu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class p${constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class m${constructor(e){this.key=e,this.ec=!1}}class g${constructor(e,t,i,r,s,f){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=f,this.nc={},this.sc=new uf(b=>lE(b),ob),this.ic=new Map,this.rc=new Set,this.oc=new Ls(Pn.comparator),this.uc=new Map,this.cc=new uP,this.ac={},this.hc=new Map,this.lc=mb.bn(),this.onlineState="Unknown",this.fc=void 0}get isPrimaryClient(){return!0===this.fc}}function _$(n,e){return KP.apply(this,arguments)}function KP(){return KP=(0,V.Z)(function*(n,e){const t=vO(n);let i,r;const s=t.sc.get(e);if(s)i=s.targetId,t.sharedClientState.addLocalQueryTarget(i),r=s.view.tc();else{const f=yield Gw(t.localStore,$l(e));t.isPrimaryClient&&VS(t.remoteStore,f);const b=t.sharedClientState.addLocalQueryTarget(f.targetId);i=f.targetId,r=yield XP(t,e,i,"current"===b,f.resumeToken)}return r}),KP.apply(this,arguments)}function XP(n,e,t,i,r){return QP.apply(this,arguments)}function QP(){return QP=(0,V.Z)(function*(n,e,t,i,r){n.dc=(K,le,ge)=>{return(Te=(0,V.Z)(function*(Ge,Je,Qt,xn){let zn=Je.view.zu(Qt);zn.Mi&&(zn=yield FS(Ge.localStore,Je.query,!1).then(({documents:Ki})=>Je.view.zu(Ki,zn)));const li=xn&&xn.targetChanges.get(Je.targetId),Gi=Je.view.applyChanges(zn,Ge.isPrimaryClient,li);return lO(Ge,Je.targetId,Gi.Yu),Gi.snapshot}),function(Ge,Je,Qt,xn){return Te.apply(this,arguments)})(n,K,le,ge);var Te};const s=yield FS(n.localStore,e,!0),f=new fz(e,s.Wi),b=f.zu(s.documents),I=hE.createSynthesizedTargetChangeForCurrentChange(t,i&&"Offline"!==n.onlineState,r),O=f.applyChanges(b,n.isPrimaryClient,I);lO(n,t,O.Yu);const B=new p$(e,t,f);return n.sc.set(e,B),n.ic.has(t)?n.ic.get(t).push(e):n.ic.set(t,[e]),O.snapshot}),QP.apply(this,arguments)}function y$(n,e){return JP.apply(this,arguments)}function JP(){return JP=(0,V.Z)(function*(n,e){const t=Rn(n),i=t.sc.get(e),r=t.ic.get(i.targetId);if(r.length>1)return t.ic.set(i.targetId,r.filter(s=>!ob(s,e))),void t.sc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(i.targetId),t.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Hw(t.localStore,i.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(i.targetId),IE(t.remoteStore,i.targetId),Qw(t,i.targetId)}).catch(Lm))):(Qw(t,i.targetId),yield Hw(t.localStore,i.targetId,!0))}),JP.apply(this,arguments)}function eO(){return eO=(0,V.Z)(function*(n,e,t){const i=bO(n);try{const r=yield function(s,f){const b=Rn(s),I=Vo.now(),O=f.reduce((le,ge)=>le.add(ge.key),lr());let B,K;return b.persistence.runTransaction("Locally write mutations","readwrite",le=>{let ge=Gl(),Te=lr();return b.Ki.getEntries(le,O).next(Ge=>{ge=Ge,ge.forEach((Je,Qt)=>{Qt.isValidDocument()||(Te=Te.add(Je))})}).next(()=>b.localDocuments.getOverlayedDocuments(le,ge)).next(Ge=>{B=Ge;const Je=[];for(const Qt of f){const xn=Fn(Qt,B.get(Qt.key).overlayedDocument);null!=xn&&Je.push(new Zt(Qt.key,xn,kA(xn.value.mapValue),he.exists(!0)))}return b.mutationQueue.addMutationBatch(le,I,Je,f)}).next(Ge=>{K=Ge;const Je=Ge.applyToLocalDocumentSet(B,Te);return b.documentOverlayCache.saveOverlays(le,Ge.batchId,Je)})}).then(()=>({batchId:K.batchId,changes:xS(B)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(s,f,b){let I=s.ac[s.currentUser.toKey()];I||(I=new Ls($i)),I=I.insert(f,b),s.ac[s.currentUser.toKey()]=I}(i,r.batchId,t),yield s_(i,r.changes),yield Zw(i.remoteStore)}catch(r){const s=Yw(r,"Failed to persist write");t.reject(s)}}),eO.apply(this,arguments)}function pz(n,e){return tO.apply(this,arguments)}function tO(){return tO=(0,V.Z)(function*(n,e){const t=Rn(n);try{const i=yield function B6(n,e){const t=Rn(n),i=e.snapshotVersion;let r=t.Li;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const f=t.Ki.newChangeBuffer({trackRemovals:!0});r=t.Li;const b=[];e.targetChanges.forEach((B,K)=>{const le=r.get(K);if(!le)return;b.push(t.Ds.removeMatchingKeys(s,B.removedDocuments,K).next(()=>t.Ds.addMatchingKeys(s,B.addedDocuments,K)));let ge=le.withSequenceNumber(s.currentSequenceNumber);var Te,Ge,Je;e.targetMismatches.has(K)?ge=ge.withResumeToken(Ca.EMPTY_BYTE_STRING,pi.min()).withLastLimboFreeSnapshotVersion(pi.min()):B.resumeToken.approximateByteSize()>0&&(ge=ge.withResumeToken(B.resumeToken,i)),r=r.insert(K,ge),Ge=ge,Je=B,(0===(Te=le).resumeToken.approximateByteSize()||Ge.snapshotVersion.toMicroseconds()-Te.snapshotVersion.toMicroseconds()>=3e8||Je.addedDocuments.size+Je.modifiedDocuments.size+Je.removedDocuments.size>0)&&b.push(t.Ds.updateTargetData(s,ge))});let I=Gl(),O=lr();if(e.documentUpdates.forEach(B=>{e.resolvedLimboDocuments.has(B)&&b.push(t.persistence.referenceDelegate.updateLimboDocument(s,B))}),b.push(qN(s,f,e.documentUpdates).next(B=>{I=B.zi,O=B.ji})),!i.isEqual(pi.min())){const B=t.Ds.getLastRemoteSnapshotVersion(s).next(K=>t.Ds.setTargetsMetadata(s,s.currentSequenceNumber,i));b.push(B)}return bt.waitFor(b).next(()=>f.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,I,O)).next(()=>I)}).then(s=>(t.Li=r,s))}(t.localStore,e);e.targetChanges.forEach((r,s)=>{const f=t.uc.get(s);f&&(ai(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?f.ec=!0:r.modifiedDocuments.size>0?ai(f.ec):r.removedDocuments.size>0&&(ai(f.ec),f.ec=!1))}),yield s_(t,i,e)}catch(i){yield Lm(i)}}),tO.apply(this,arguments)}function mz(n,e,t){const i=Rn(n);if(i.isPrimaryClient&&0===t||!i.isPrimaryClient&&1===t){const r=[];i.sc.forEach((s,f)=>{const b=f.view.Ru(e);b.snapshot&&r.push(b.snapshot)}),function(s,f){const b=Rn(s);b.onlineState=f;let I=!1;b.queries.forEach((O,B)=>{for(const K of B.listeners)K.Ru(f)&&(I=!0)}),I&&WP(b)}(i.eventManager,e),r.length&&i.nc.zo(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function b$(n,e,t){return nO.apply(this,arguments)}function nO(){return nO=(0,V.Z)(function*(n,e,t){const i=Rn(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.uc.get(e),s=r&&r.key;if(s){let f=new Ls(Pn.comparator);f=f.insert(s,Ao.newNoDocument(s,pi.min()));const b=lr().add(s),I=new dE(pi.min(),new Map,new so($i),f,b);yield pz(i,I),i.oc=i.oc.remove(s),i.uc.delete(e),cO(i)}else yield Hw(i.localStore,e,!1).then(()=>Qw(i,e,t)).catch(Lm)}),nO.apply(this,arguments)}function x$(n,e){return iO.apply(this,arguments)}function iO(){return iO=(0,V.Z)(function*(n,e){const t=Rn(n),i=e.batch.batchId;try{const r=yield function z6(n,e){const t=Rn(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=t.Ki.newChangeBuffer({trackRemovals:!0});return function(f,b,I,O){const B=I.batch,K=B.keys();let le=bt.resolve();return K.forEach(ge=>{le=le.next(()=>O.getEntry(b,ge)).next(Te=>{const Ge=I.docVersions.get(ge);ai(null!==Ge),Te.version.compareTo(Ge)<0&&(B.applyToRemoteDocument(Te,I),Te.isValidDocument()&&(Te.setReadTime(I.commitVersion),O.addEntry(Te)))})}),le.next(()=>f.mutationQueue.removeMutationBatch(b,B))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(f){let b=lr();for(let I=0;I<f.mutationResults.length;++I)f.mutationResults[I].transformResults.length>0&&(b=b.add(f.batch.mutations[I].key));return b}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}(t.localStore,e);aO(t,i,null),sO(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield s_(t,r)}catch(r){yield Lm(r)}}),iO.apply(this,arguments)}function w$(n,e,t){return rO.apply(this,arguments)}function rO(){return rO=(0,V.Z)(function*(n,e,t){const i=Rn(n);try{const r=yield function(s,f){const b=Rn(s);return b.persistence.runTransaction("Reject batch","readwrite-primary",I=>{let O;return b.mutationQueue.lookupMutationBatch(I,f).next(B=>(ai(null!==B),O=B.keys(),b.mutationQueue.removeMutationBatch(I,B))).next(()=>b.mutationQueue.performConsistencyCheck(I)).next(()=>b.documentOverlayCache.removeOverlaysForBatchId(I,O,f)).next(()=>b.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(I,O)).next(()=>b.localDocuments.getDocuments(I,O))})}(i.localStore,e);aO(i,e,t),sO(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield s_(i,r)}catch(r){yield Lm(r)}}),rO.apply(this,arguments)}function oO(){return oO=(0,V.Z)(function*(n,e){const t=Rn(n);o_(t.remoteStore)||sn("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=yield function(s){const f=Rn(s);return f.persistence.runTransaction("Get highest unacknowledged batch id","readonly",b=>f.mutationQueue.getHighestUnacknowledgedBatchId(b))}(t.localStore);if(-1===i)return void e.resolve();const r=t.hc.get(i)||[];r.push(e),t.hc.set(i,r)}catch(i){const r=Yw(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}),oO.apply(this,arguments)}function sO(n,e){(n.hc.get(e)||[]).forEach(t=>{t.resolve()}),n.hc.delete(e)}function aO(n,e,t){const i=Rn(n);let r=i.ac[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.ac[i.currentUser.toKey()]=r}}function Qw(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.ic.get(e))n.sc.delete(i),t&&n.nc.wc(i,t);n.ic.delete(e),n.isPrimaryClient&&n.cc.hs(e).forEach(i=>{n.cc.containsKey(i)||gz(n,i)})}function gz(n,e){n.rc.delete(e.path.canonicalString());const t=n.oc.get(e);null!==t&&(IE(n.remoteStore,t),n.oc=n.oc.remove(e),n.uc.delete(t),cO(n))}function lO(n,e,t){for(const i of t)i instanceof dz?(n.cc.addReference(i.key,e),E$(n,i)):i instanceof hz?(sn("SyncEngine","Document no longer in limbo: "+i.key),n.cc.removeReference(i.key,e),n.cc.containsKey(i.key)||gz(n,i.key)):Hn()}function E$(n,e){const t=e.key,i=t.path.canonicalString();n.oc.get(t)||n.rc.has(i)||(sn("SyncEngine","New document in limbo: "+t),n.rc.add(i),cO(n))}function cO(n){for(;n.rc.size>0&&n.oc.size<n.maxConcurrentLimboResolutions;){const e=n.rc.values().next().value;n.rc.delete(e);const t=new Pn(Pr.fromString(e)),i=n.lc.next();n.uc.set(i,new m$(t)),n.oc=n.oc.insert(t,i),VS(n.remoteStore,new iv($l(wp(t.path)),i,2,wc.ct))}}function s_(n,e,t){return uO.apply(this,arguments)}function uO(){return uO=(0,V.Z)(function*(n,e,t){const i=Rn(n),r=[],s=[],f=[];var b;i.sc.isEmpty()||(i.sc.forEach((b,I)=>{f.push(i.dc(I,e,t).then(O=>{if((O||t)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(I.targetId,O?.fromCache?"not-current":"current"),O){r.push(O);const B=pP.Di(I.targetId,O);s.push(B)}}))}),yield Promise.all(f),i.nc.zo(r),yield(b=(0,V.Z)(function*(I,O){const B=Rn(I);try{yield B.persistence.runTransaction("notifyLocalViewChanges","readwrite",K=>bt.forEach(O,le=>bt.forEach(le.Vi,ge=>B.persistence.referenceDelegate.addReference(K,le.targetId,ge)).next(()=>bt.forEach(le.Si,ge=>B.persistence.referenceDelegate.removeReference(K,le.targetId,ge)))))}catch(K){if(!_p(K))throw K;sn("LocalStore","Failed to update sequence numbers: "+K)}for(const K of O){const le=K.targetId;if(!K.fromCache){const ge=B.Li.get(le),Ge=ge.withLastLimboFreeSnapshotVersion(ge.snapshotVersion);B.Li=B.Li.insert(le,Ge)}}}),function(I,O){return b.apply(this,arguments)})(i.localStore,s))}),uO.apply(this,arguments)}function T$(n,e){return dO.apply(this,arguments)}function dO(){return dO=(0,V.Z)(function*(n,e){const t=Rn(n);if(!t.currentUser.isEqual(e)){sn("SyncEngine","User change. New user:",e.toKey());const i=yield GN(t.localStore,e);t.currentUser=e,(r=t).hc.forEach(f=>{f.forEach(b=>{b.reject(new Wt(Ct.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.hc.clear(),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield s_(t,i.Qi)}var r}),dO.apply(this,arguments)}function I$(n,e){const t=Rn(n),i=t.uc.get(e);if(i&&i.ec)return lr().add(i.key);{let r=lr();const s=t.ic.get(e);if(!s)return r;for(const f of s){const b=t.sc.get(f);r=r.unionWith(b.view.Qu)}return r}}function S$(n,e){return hO.apply(this,arguments)}function hO(){return hO=(0,V.Z)(function*(n,e){const t=Rn(n),i=yield FS(t.localStore,e.query,!0),r=e.view.Xu(i);return t.isPrimaryClient&&lO(t,e.targetId,r.Yu),r}),hO.apply(this,arguments)}function M$(n,e){return fO.apply(this,arguments)}function fO(){return fO=(0,V.Z)(function*(n,e){const t=Rn(n);return WN(t.localStore,e).then(i=>s_(t,i))}),fO.apply(this,arguments)}function D$(n,e,t,i){return pO.apply(this,arguments)}function pO(){return pO=(0,V.Z)(function*(n,e,t,i){const r=Rn(n),s=yield function(f,b){const I=Rn(f),O=Rn(I.mutationQueue);return I.persistence.runTransaction("Lookup mutation documents","readonly",B=>O.In(B,b).next(K=>K?I.localDocuments.getDocuments(B,K):bt.resolve(null)))}(r.localStore,e);var b;null!==s?("pending"===t?yield Zw(r.remoteStore):"acknowledged"===t||"rejected"===t?(aO(r,e,i||null),sO(r,e),b=e,Rn(Rn(r.localStore).mutationQueue).En(b)):Hn(),yield s_(r,s)):sn("SyncEngine","Cannot apply mutation batch with id: "+e)}),pO.apply(this,arguments)}function mO(){return mO=(0,V.Z)(function*(n,e){const t=Rn(n);if(vO(t),bO(t),!0===e&&!0!==t.fc){const i=t.sharedClientState.getAllActiveQueryTargets(),r=yield _z(t,i.toArray());t.fc=!0,yield UP(t.remoteStore,!0);for(const s of r)VS(t.remoteStore,s)}else if(!1===e&&!1!==t.fc){const i=[];let r=Promise.resolve();t.ic.forEach((s,f)=>{t.sharedClientState.isLocalQueryTarget(f)?i.push(f):r=r.then(()=>(Qw(t,f),Hw(t.localStore,f,!0))),IE(t.remoteStore,f)}),yield r,yield _z(t,i),function(s){const f=Rn(s);f.uc.forEach((b,I)=>{IE(f.remoteStore,I)}),f.cc.ls(),f.uc=new Map,f.oc=new Ls(Pn.comparator)}(t),t.fc=!1,yield UP(t.remoteStore,!1)}}),mO.apply(this,arguments)}function _z(n,e,t){return gO.apply(this,arguments)}function gO(){return gO=(0,V.Z)(function*(n,e,t){const i=Rn(n),r=[],s=[];for(const f of e){let b;const I=i.ic.get(f);if(I&&0!==I.length){b=yield Gw(i.localStore,$l(I[0]));for(const O of I){const B=i.sc.get(O),K=yield S$(i,B);K.snapshot&&s.push(K.snapshot)}}else{const O=yield ZN(i.localStore,f);b=yield Gw(i.localStore,O),yield XP(i,yz(O),f,!1,b.resumeToken)}r.push(b)}return i.nc.zo(s),r}),gO.apply(this,arguments)}function yz(n){return Lw(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function P$(n){const e=Rn(n);return Rn(Rn(e.localStore).persistence).bi()}function O$(n,e,t,i){return _O.apply(this,arguments)}function _O(){return _O=(0,V.Z)(function*(n,e,t,i){const r=Rn(n);if(r.fc)return void sn("SyncEngine","Ignoring unexpected query state notification.");const s=r.ic.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const f=yield WN(r.localStore,yS(s[0])),b=dE.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,Ca.EMPTY_BYTE_STRING);yield s_(r,f,b);break}case"rejected":yield Hw(r.localStore,e,!0),Qw(r,e,i);break;default:Hn()}}),_O.apply(this,arguments)}function k$(n,e,t){return yO.apply(this,arguments)}function yO(){return yO=(0,V.Z)(function*(n,e,t){const i=vO(n);if(i.fc){for(const r of e){if(i.ic.has(r)){sn("SyncEngine","Adding an already active target "+r);continue}const s=yield ZN(i.localStore,r),f=yield Gw(i.localStore,s);yield XP(i,yz(s),f.targetId,!1,f.resumeToken),VS(i.remoteStore,f)}for(const r of t)i.ic.has(r)&&(yield Hw(i.localStore,r,!1).then(()=>{IE(i.remoteStore,r),Qw(i,r)}).catch(Lm))}}),yO.apply(this,arguments)}function vO(n){const e=Rn(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=pz.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=I$.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=b$.bind(null,e),e.nc.zo=u$.bind(null,e.eventManager),e.nc.wc=d$.bind(null,e.eventManager),e}function bO(n){const e=Rn(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=x$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=w$.bind(null,e),e}class jS{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,V.Z)(function*(){t.serializer=EE(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return $N(this.persistence,new jN,e.initialUser,this.serializer)}createPersistence(e){return new VN(kS.Fs,this.serializer)}createSharedClientState(e){return new QN}terminate(){var e=this;return(0,V.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class xO extends jS{constructor(e,t,i){super(),this.mc=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,i=this;return(0,V.Z)(function*(){yield t().call(i,e),yield i.mc.initialize(i,e),yield bO(i.mc.syncEngine),yield Zw(i.mc.remoteStore),yield i.persistence.hi(()=>(i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(),i.indexBackfillerScheduler&&!i.indexBackfillerScheduler.started&&i.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return $N(this.persistence,new jN,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new C6(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const i=new ZI(t,this.persistence);return new qI(e.asyncQueue,i)}createPersistence(e){const t=fP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=void 0!==this.cacheSizeBytes?rd.withCacheSize(this.cacheSizeBytes):rd.DEFAULT;return new hP(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,ez(),BS(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new QN}}class vz extends xO{constructor(e,t){super(e,t,!1),this.mc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,i=this;return(0,V.Z)(function*(){yield t().call(i,e);const r=i.mc.syncEngine;i.sharedClientState instanceof wP&&(i.sharedClientState.syncEngine={$r:D$.bind(null,r),Mr:O$.bind(null,r),Fr:k$.bind(null,r),bi:P$.bind(null,r),Or:M$.bind(null,r)},yield i.sharedClientState.start()),yield i.persistence.hi(function(){var s=(0,V.Z)(function*(f){yield function A$(n,e){return mO.apply(this,arguments)}(i.mc.syncEngine,f),i.gcScheduler&&(f&&!i.gcScheduler.started?i.gcScheduler.start():f||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(f&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():f||i.indexBackfillerScheduler.stop())});return function(f){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=ez();if(!wP.D(t))throw new Wt(Ct.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=fP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new wP(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Jw{initialize(e,t){var i=this;return(0,V.Z)(function*(){i.localStore||(i.localStore=e.localStore,i.sharedClientState=e.sharedClientState,i.datastore=i.createDatastore(t),i.remoteStore=i.createRemoteStore(t),i.eventManager=i.createEventManager(t),i.syncEngine=i.createSyncEngine(t,!e.synchronizeTabs),i.sharedClientState.onlineStateHandler=r=>mz(i.syncEngine,r,1),i.remoteStore.remoteSyncer.handleCredentialChange=T$.bind(null,i.syncEngine),yield UP(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(e){return new c$}createDatastore(e){const t=EE(e.databaseInfo.databaseId),i=new q6(e.databaseInfo);return new Y6(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return t=this.localStore,i=this.datastore,r=e.asyncQueue,s=b=>mz(this.syncEngine,b,0),f=JN.D()?new JN:new $6,new Q6(t,i,r,s,f);var t,i,r,s,f}createSyncEngine(e,t){return function(i,r,s,f,b,I,O){const B=new g$(i,r,s,f,b,I);return O&&(B.fc=!0),B}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,V.Z)(function*(t){const i=Rn(t);sn("RemoteStore","RemoteStore shutting down."),i.du.add(5),yield qw(i),i._u.shutdown(),i.mu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function bz(n,e=10240){let t=0;return{read:()=>(0,V.Z)(function*(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})(),cancel:()=>(0,V.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class $S{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.gc(this.observer.next,e)}error(e){this.observer.error?this.gc(this.observer.error,e):Cs("Uncaught Error in snapshot listener:",e.toString())}yc(){this.muted=!0}gc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class F${constructor(e,t){this.Ic=e,this.serializer=t,this.metadata=new na,this.buffer=new Uint8Array,this.Tc=new TextDecoder("utf-8"),this.Ec().then(i=>{i&&i.ku()?this.metadata.resolve(i.Nu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(i?.Nu)}`))},i=>this.metadata.reject(i))}close(){return this.Ic.cancel()}getMetadata(){var e=this;return(0,V.Z)(function*(){return e.metadata.promise})()}_c(){var e=this;return(0,V.Z)(function*(){return yield e.getMetadata(),e.Ec()})()}Ec(){var e=this;return(0,V.Z)(function*(){const t=yield e.Ac();if(null===t)return null;const i=e.Tc.decode(t),r=Number(i);isNaN(r)&&e.Rc(`length string (${i}) is not valid number`);const s=yield e.vc(r);return new h$(JSON.parse(s),t.length+r)})()}bc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Ac(){var e=this;return(0,V.Z)(function*(){for(;e.bc()<0&&!(yield e.Pc()););if(0===e.buffer.length)return null;const t=e.bc();t<0&&e.Rc("Reached the end of bundle when a length string is expected.");const i=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),i})()}vc(e){var t=this;return(0,V.Z)(function*(){for(;t.buffer.length<e;)(yield t.Pc())&&t.Rc("Reached the end of bundle when more is expected.");const i=t.Tc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),i})()}Rc(e){throw this.Ic.cancel(),new Error(`Invalid bundle format: ${e}`)}Pc(){var e=this;return(0,V.Z)(function*(){const t=yield e.Ic.read();if(!t.done){const i=new Uint8Array(e.buffer.length+t.value.length);i.set(e.buffer),i.set(t.value,e.buffer.length),e.buffer=i}return t.done})()}}class L${constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,V.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Wt(Ct.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const i=yield(r=(0,V.Z)(function*(s,f){const b=Rn(s),I=pE(b.serializer)+"/documents",O={documents:f.map(ge=>fE(b.serializer,ge))},B=yield b.fo("BatchGetDocuments",I,O,f.length),K=new Map;B.forEach(ge=>{const Te=function i6(n,e){return"found"in e?function(t,i){ai(!!i.found);const r=Um(t,i.found.name),s=ra(i.found.updateTime),f=i.found.createTime?ra(i.found.createTime):pi.min(),b=new ia({mapValue:{fields:i.found.fields}});return Ao.newFoundDocument(r,s,f,b)}(n,e):"missing"in e?function(t,i){ai(!!i.missing),ai(!!i.readTime);const r=Um(t,i.missing),s=ra(i.readTime);return Ao.newNoDocument(r,s)}(n,e):Hn()}(b.serializer,ge);K.set(Te.key.toString(),Te)});const le=[];return f.forEach(ge=>{const Te=K.get(ge.toString());ai(!!Te),le.push(Te)}),le}),function(s,f){return r.apply(this,arguments)})(t.datastore,e);var r;return i.forEach(r=>t.recordVersion(r)),i})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastWriteError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new cb(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,V.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var i;e.mutations.forEach(i=>{t.delete(i.key.toString())}),t.forEach((i,r)=>{const s=Pn.fromPath(r);e.mutations.push(new ZA(s,e.precondition(s)))}),yield(i=(0,V.Z)(function*(r,s){const f=Rn(r),b=pE(f.serializer)+"/documents",I={writes:s.map(O=>mE(f.serializer,O))};yield f.co("Commit",b,I)}),function(r,s){return i.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Hn();t=pi.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new Wt(Ct.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(pi.min())?he.exists(!1):he.updateTime(t):he.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(pi.min()))throw new Wt(Ct.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return he.updateTime(t)}return he.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class N${constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.Vc=i.maxAttempts,this.Co=new EP(this.asyncQueue,"transaction_retry")}run(){this.Vc-=1,this.Sc()}Sc(){var e=this;this.Co.Ao((0,V.Z)(function*(){const t=new L$(e.datastore),i=e.Dc(t);i&&i.then(r=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(r)}).catch(s=>{e.Cc(s)}))}).catch(r=>{e.Cc(r)})}))}Dc(e){try{const t=this.updateFunction(e);return!Xy(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Cc(e){this.Vc>0&&this.xc(e)?(this.Vc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Sc(),Promise.resolve()))):this.deferred.reject(e)}xc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!KL(t)}return!1}}class z${constructor(e,t,i,r){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=qs.UNAUTHENTICATED,this.clientId=Wy.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,function(){var f=(0,V.Z)(function*(b){sn("FirestoreClient","Received user=",b.uid),yield s.authCredentialListener(b),s.user=b});return function(b){return f.apply(this,arguments)}}()),this.appCheckCredentials.start(i,f=>(sn("FirestoreClient","Received new app check token=",f),this.appCheckCredentialListener(f,this.user)))}getConfiguration(){var e=this;return(0,V.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Wt(Ct.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new na;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,V.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(i){const r=Yw(i,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}function GS(n,e){return wO.apply(this,arguments)}function wO(){return wO=(0,V.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),sn("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(function(){var r=(0,V.Z)(function*(s){i.isEqual(s)||(yield GN(e.localStore,s),i=s)});return function(s){return r.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),wO.apply(this,arguments)}function CO(n,e){return EO.apply(this,arguments)}function EO(){return EO=(0,V.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield TO(n);sn("FirestoreClient","Initializing OnlineComponentProvider");const i=yield n.getConfiguration();yield e.initialize(t,i),n.setCredentialChangeListener(r=>az(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>az(e.remoteStore,s)),n._onlineComponents=e}),EO.apply(this,arguments)}function xz(n){return"FirebaseError"===n.name?n.code===Ct.FAILED_PRECONDITION||n.code===Ct.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function TO(n){return IO.apply(this,arguments)}function IO(){return IO=(0,V.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){sn("FirestoreClient","Using user provided OfflineComponentProvider");try{yield GS(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!xz(t))throw t;td("Error using user provided cache. Falling back to memory cache: "+t),yield GS(n,new jS)}}else sn("FirestoreClient","Using default OfflineComponentProvider"),yield GS(n,new jS);return n._offlineComponents}),IO.apply(this,arguments)}function HS(n){return SO.apply(this,arguments)}function SO(){return SO=(0,V.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(sn("FirestoreClient","Using user provided OnlineComponentProvider"),yield CO(n,n._uninitializedComponentsProvider._online)):(sn("FirestoreClient","Using default OnlineComponentProvider"),yield CO(n,new Jw))),n._onlineComponents}),SO.apply(this,arguments)}function wz(n){return TO(n).then(e=>e.persistence)}function qS(n){return TO(n).then(e=>e.localStore)}function MO(n){return HS(n).then(e=>e.remoteStore)}function DO(n){return HS(n).then(e=>e.syncEngine)}function e1(n){return AO.apply(this,arguments)}function AO(){return AO=(0,V.Z)(function*(n){const e=yield HS(n),t=e.eventManager;return t.onListen=_$.bind(null,e.syncEngine),t.onUnlisten=y$.bind(null,e.syncEngine),t}),AO.apply(this,arguments)}function Ez(n,e,t={}){const i=new na;return n.asyncQueue.enqueueAndForget((0,V.Z)(function*(){return function(r,s,f,b,I){const O=new $S({next:K=>{s.enqueueAndForget(()=>qP(r,B));const le=K.docs.has(f);!le&&K.fromCache?I.reject(new Wt(Ct.UNAVAILABLE,"Failed to get document because the client is offline.")):le&&K.fromCache&&b&&"server"===b.source?I.reject(new Wt(Ct.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):I.resolve(K)},error:K=>I.reject(K)}),B=new YP(wp(f.path),O,{includeMetadataChanges:!0,xu:!0});return GP(r,B)}(yield e1(n),n.asyncQueue,e,t,i)})),i.promise}function Tz(n,e,t={}){const i=new na;return n.asyncQueue.enqueueAndForget((0,V.Z)(function*(){return function(r,s,f,b,I){const O=new $S({next:K=>{s.enqueueAndForget(()=>qP(r,B)),K.fromCache&&"server"===b.source?I.reject(new Wt(Ct.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):I.resolve(K)},error:K=>I.reject(K)}),B=new YP(f,O,{includeMetadataChanges:!0,xu:!0});return GP(r,B)}(yield e1(n),n.asyncQueue,e,t,i)})),i.promise}const Iz=new Map;function PO(n,e,t){if(!t)throw new Wt(Ct.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Sz(n,e,t,i){if(!0===e&&!0===i)throw new Wt(Ct.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Mz(n){if(!Pn.isDocumentKey(n))throw new Wt(Ct.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Dz(n){if(Pn.isDocumentKey(n))throw new Wt(Ct.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ZS(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":Hn()}function Or(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Wt(Ct.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ZS(n);throw new Wt(Ct.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Az(n,e){if(e<=0)throw new Wt(Ct.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class Pz{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Wt(Ct.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Wt(Ct.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,Sz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class SE{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Pz({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Wt(Ct.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Wt(Ct.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Pz(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new BI;switch(t.type){case"firstParty":return new yA(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Wt(Ct.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Iz.get(e);t&&(sn("ComponentProvider","Removing Datastore"),Iz.delete(e),t.terminate())}(this),Promise.resolve()}}function Oz(n,e,t,i={}){var r;const s=(n=Or(n,SE))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==e&&td("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${t}`,ssl:!1})),i.mockUserToken){let f,b;if("string"==typeof i.mockUserToken)f=i.mockUserToken,b=qs.MOCK_USER;else{f=(0,te.Sg)(i.mockUserToken,null===(r=n._app)||void 0===r?void 0:r.options.projectId);const I=i.mockUserToken.sub||i.mockUserToken.user_id;if(!I)throw new Wt(Ct.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new qs(I)}n._authCredentials=new Ul(new $C(f,b))}}class ps{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jm(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ps(this.firestore,e,this._key)}}class Hl{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Hl(this.firestore,e,this._query)}}class jm extends Hl{constructor(e,t,i){super(e,t,wp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ps(this.firestore,null,new Pn(e))}withConverter(e){return new jm(this.firestore,e,this._path)}}function OO(n,e,...t){if(n=(0,te.m9)(n),PO("collection","path",e),n instanceof SE){const i=Pr.fromString(e,...t);return Dz(i),new jm(n,null,i)}{if(!(n instanceof ps||n instanceof jm))throw new Wt(Ct.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Pr.fromString(e,...t));return Dz(i),new jm(n.firestore,null,i)}}function WS(n,e,...t){if(n=(0,te.m9)(n),1===arguments.length&&(e=Wy.A()),PO("doc","path",e),n instanceof SE){const i=Pr.fromString(e,...t);return Mz(i),new ps(n,null,new Pn(i))}{if(!(n instanceof ps||n instanceof jm))throw new Wt(Ct.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Pr.fromString(e,...t));return Mz(i),new ps(n.firestore,n instanceof jm?n.converter:null,new Pn(i))}}function kz(n,e){return n=(0,te.m9)(n),e=(0,te.m9)(e),(n instanceof ps||n instanceof jm)&&(e instanceof ps||e instanceof jm)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function kO(n,e){return n=(0,te.m9)(n),e=(0,te.m9)(e),n instanceof Hl&&e instanceof Hl&&n.firestore===e.firestore&&ob(n._query,e._query)&&n.converter===e.converter}class W${constructor(){this.Nc=Promise.resolve(),this.kc=[],this.Oc=!1,this.$c=[],this.Mc=null,this.Fc=!1,this.Bc=!1,this.Lc=[],this.Co=new EP(this,"async_queue_retry"),this.qc=()=>{const t=BS();t&&sn("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Co.vo()};const e=BS();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.qc)}get isShuttingDown(){return this.Oc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Uc(),this.Kc(e)}enterRestrictedMode(e){if(!this.Oc){this.Oc=!0,this.Bc=e||!1;const t=BS();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.qc)}}enqueue(e){if(this.Uc(),this.Oc)return new Promise(()=>{});const t=new na;return this.Kc(()=>this.Oc&&this.Bc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.kc.push(e),this.Gc()))}Gc(){var e=this;return(0,V.Z)(function*(){if(0!==e.kc.length){try{yield e.kc[0](),e.kc.shift(),e.Co.reset()}catch(t){if(!_p(t))throw t;sn("AsyncQueue","Operation failed with retryable error: "+t)}e.kc.length>0&&e.Co.Ao(()=>e.Gc())}})()}Kc(e){const t=this.Nc.then(()=>(this.Fc=!0,e().catch(i=>{throw this.Mc=i,this.Fc=!1,Cs("INTERNAL UNHANDLED ERROR: ",function(s){let f=s.message||"";return s.stack&&(f=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),f}(i)),i}).then(i=>(this.Fc=!1,i))));return this.Nc=t,t}enqueueAfterDelay(e,t,i){this.Uc(),this.Lc.indexOf(e)>-1&&(t=0);const r=$P.createAndSchedule(this,e,t,i,s=>this.Qc(s));return this.$c.push(r),r}Uc(){this.Mc&&Hn()}verifyOperationInProgress(){}zc(){var e=this;return(0,V.Z)(function*(){let t;do{t=e.Nc,yield t}while(t!==e.Nc)})()}jc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Wc(e){return this.zc().then(()=>{this.$c.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()})}Hc(e){this.Lc.push(e)}Qc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}function RO(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const i=e;for(const r of["next","error","complete"])if(r in i&&"function"==typeof i[r])return!0;return!1}(n)}class Y${constructor(){this._progressObserver={},this._taskCompletionResolver=new na,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class ms extends SE{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new W$,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Rz(this),this._firestoreClient.terminate()}}function X$(n,e){const t="object"==typeof n?n:(0,Q.getApp)(),i="string"==typeof n?n:e||"(default)",r=(0,Q._getProvider)(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=(0,te.P0)("firestore");s&&Oz(r,...s)}return r}function oa(n){return n._firestoreClient||Rz(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Rz(n){var e,t,i;const r=n._freezeSettings(),s=(b=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new oS(n._databaseId,b,n._persistenceKey,(O=r).host,O.ssl,O.experimentalForceLongPolling,O.experimentalAutoDetectLongPolling,O.useFetchStreams));var b,O;n._firestoreClient=new z$(n._authCredentials,n._appCheckCredentials,n._queue,s),null!==(t=r.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(i=r.cache)&&void 0!==i&&i._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.cache.kind,_offline:r.cache._offlineComponentProvider,_online:r.cache._onlineComponentProvider})}function Fz(n,e,t){const i=new na;return n.asyncQueue.enqueue((0,V.Z)(function*(){try{yield GS(n,t),yield CO(n,e),i.resolve()}catch(r){const s=r;if(!xz(s))throw s;td("Error enabling indexeddb cache. Falling back to memory cache: "+s),i.reject(s)}})).then(()=>i.promise)}function Lz(n){if(n._initialized||n._terminated)throw new Wt(Ct.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class $m{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $m(Ca.fromBase64String(e))}catch(t){throw new Wt(Ct.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new $m(Ca.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class a_{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Wt(Ct.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class _b{constructor(e){this._methodName=e}}class YS{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Wt(Ct.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Wt(Ct.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $i(this._lat,e._lat)||$i(this._long,e._long)}}const aG=/^__.*__$/;class lG{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return null!==this.fieldMask?new Zt(e,this.data,this.fieldMask,t,this.fieldTransforms):new _i(e,this.data,t,this.fieldTransforms)}}class Nz{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Zt(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function zz(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Hn()}}class KS{constructor(e,t,i,r,s,f){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,void 0===s&&this.Jc(),this.fieldTransforms=s||[],this.fieldMask=f||[]}get path(){return this.settings.path}get Yc(){return this.settings.Yc}Zc(e){return new KS(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Xc(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Zc({path:i,ta:!1});return r.ea(e),r}na(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Zc({path:i,ta:!1});return r.Jc(),r}sa(e){return this.Zc({path:void 0,ta:!0})}ia(e){return JS(e,this.settings.methodName,this.settings.ra||!1,this.path,this.settings.oa)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Jc(){if(this.path)for(let e=0;e<this.path.length;e++)this.ea(this.path.get(e))}ea(e){if(0===e.length)throw this.ia("Document fields must not be empty");if(zz(this.Yc)&&aG.test(e))throw this.ia('Document fields cannot begin and end with "__"')}}class cG{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||EE(e)}ua(e,t,i,r=!1){return new KS({Yc:e,methodName:t,oa:i,path:fs.emptyPath(),ta:!1,ra:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yb(n){const e=n._freezeSettings(),t=EE(n._databaseId);return new cG(n._databaseId,!!e.ignoreUndefinedProperties,t)}function XS(n,e,t,i,r,s={}){const f=n.ua(s.merge||s.mergeFields?2:0,e,t,r);zO("Data must be an object, but it was:",f,i);const b=Uz(i,f);let I,O;if(s.merge)I=new Ec(f.fieldMask),O=f.fieldTransforms;else if(s.mergeFields){const B=[];for(const K of s.mergeFields){const le=AE(e,K,t);if(!f.contains(le))throw new Wt(Ct.INVALID_ARGUMENT,`Field '${le}' is specified in your field mask but missing from your input data.`);$z(B,le)||B.push(le)}I=new Ec(B),O=f.fieldTransforms.filter(K=>I.covers(K.field))}else I=null,O=f.fieldTransforms;return new lG(new ia(b),I,O)}class DE extends _b{_toFieldTransform(e){if(2!==e.Yc)throw e.ia(1===e.Yc?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof DE}}function Bz(n,e,t){return new KS({Yc:3,oa:e.settings.oa,methodName:n._methodName,ta:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class FO extends _b{_toFieldTransform(e){return new Z(e.path,new lb)}isEqual(e){return e instanceof FO}}class uG extends _b{constructor(e,t){super(e),this.ca=t}_toFieldTransform(e){const t=Bz(this,e,!0),i=this.ca.map(s=>vb(s,t)),r=new d(i);return new Z(e.path,r)}isEqual(e){return this===e}}class dG extends _b{constructor(e,t){super(e),this.ca=t}_toFieldTransform(e){const t=Bz(this,e,!0),i=this.ca.map(s=>vb(s,t)),r=new m(i);return new Z(e.path,r)}isEqual(e){return this===e}}class hG extends _b{constructor(e,t){super(e),this.aa=t}_toFieldTransform(e){const t=new T(e.serializer,HA(e.serializer,this.aa));return new Z(e.path,t)}isEqual(e){return this===e}}function LO(n,e,t,i){const r=n.ua(1,e,t);zO("Data must be an object, but it was:",r,i);const s=[],f=ia.empty();t_(i,(I,O)=>{const B=QS(e,I,t);O=(0,te.m9)(O);const K=r.na(B);if(O instanceof DE)s.push(B);else{const le=vb(O,K);null!=le&&(s.push(B),f.set(B,le))}});const b=new Ec(s);return new Nz(f,b,r.fieldTransforms)}function NO(n,e,t,i,r,s){const f=n.ua(1,e,t),b=[AE(e,i,t)],I=[r];if(s.length%2!=0)throw new Wt(Ct.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let le=0;le<s.length;le+=2)b.push(AE(e,s[le])),I.push(s[le+1]);const O=[],B=ia.empty();for(let le=b.length-1;le>=0;--le)if(!$z(O,b[le])){const ge=b[le];let Te=I[le];Te=(0,te.m9)(Te);const Ge=f.na(ge);if(Te instanceof DE)O.push(ge);else{const Je=vb(Te,Ge);null!=Je&&(O.push(ge),B.set(ge,Je))}}const K=new Ec(O);return new Nz(B,K,f.fieldTransforms)}function Vz(n,e,t,i=!1){return vb(t,n.ua(i?4:3,e))}function vb(n,e){if(jz(n=(0,te.m9)(n)))return zO("Unsupported field value:",e,n),Uz(n,e);if(n instanceof _b)return function(t,i){if(!zz(i.Yc))throw i.ia(`${t._methodName}() can only be used with update() and set()`);if(!i.path)throw i.ia(`${t._methodName}() is not currently supported inside arrays`);const r=t._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.ta&&4!==e.Yc)throw e.ia("Nested arrays are not supported");return function(t,i){const r=[];let s=0;for(const f of t){let b=vb(f,i.sa(s));null==b&&(b={nullValue:"NULL_VALUE"}),r.push(b),s++}return{arrayValue:{values:r}}}(n,e)}return function(t,i){if(null===(t=(0,te.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return HA(i.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const r=Vo.fromDate(t);return{timestampValue:Vw(i.serializer,r)}}if(t instanceof Vo){const r=new Vo(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vw(i.serializer,r)}}if(t instanceof YS)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof $m)return{bytesValue:iN(i.serializer,t._byteString)};if(t instanceof ps){const r=i.databaseId,s=t.firestore._databaseId;if(!s.isEqual(r))throw i.ia(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:JA(t.firestore._databaseId||i.databaseId,t._key.path)}}throw i.ia(`Unsupported field value: ${ZS(t)}`)}(n,e)}function Uz(n,e){const t={};return rS(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):t_(n,(i,r)=>{const s=vb(r,e.Xc(i));null!=s&&(t[i]=s)}),{mapValue:{fields:t}}}function jz(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Vo||n instanceof YS||n instanceof $m||n instanceof ps||n instanceof _b)}function zO(n,e,t){if(!jz(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const i=ZS(t);throw e.ia("an object"===i?n+" a custom object":n+" "+i)}var i}function AE(n,e,t){if((e=(0,te.m9)(e))instanceof a_)return e._internalPath;if("string"==typeof e)return QS(n,e);throw JS("Field path arguments must be of type string or ",n,!1,void 0,t)}const fG=new RegExp("[~\\*/\\[\\]]");function QS(n,e,t){if(e.search(fG)>=0)throw JS(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new a_(...e.split("."))._internalPath}catch{throw JS(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function JS(n,e,t,i,r){const s=i&&!i.isEmpty(),f=void 0!==r;let b=`Function ${e}() called with invalid data`;t&&(b+=" (via `toFirestore()`)"),b+=". ";let I="";return(s||f)&&(I+=" (found",s&&(I+=` in field ${i}`),f&&(I+=` in document ${r}`),I+=")"),new Wt(Ct.INVALID_ARGUMENT,b+n+I)}function $z(n,e){return n.some(t=>t.isEqual(e))}class PE{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ps(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new pG(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(eM("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class pG extends PE{data(){return super.data()}}function eM(n,e){return"string"==typeof e?QS(n,e):e instanceof a_?e._internalPath:e._delegate._internalPath}function Gz(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Wt(Ct.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class BO{}class OE extends BO{}function lv(n,e,...t){let i=[];e instanceof BO&&i.push(e),i=i.concat(t),function(r){const s=r.filter(b=>b instanceof t1).length,f=r.filter(b=>b instanceof kE).length;if(s>1||s>0&&f>0)throw new Wt(Ct.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class kE extends OE{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new kE(e,t,i)}_apply(e){const t=this._parse(e);return Wz(e._query,t),new Hl(e.firestore,e.converter,aE(e._query,t))}_parse(e){const t=yb(e.firestore);return function(r,s,f,b,I,O,B){let K;if(I.isKeyField()){if("array-contains"===O||"array-contains-any"===O)throw new Wt(Ct.INVALID_ARGUMENT,`Invalid Query. You can't perform '${O}' queries on documentId().`);if("in"===O||"not-in"===O){Zz(B,O);const le=[];for(const ge of B)le.push(qz(b,r,ge));K={arrayValue:{values:le}}}else K=qz(b,r,B)}else"in"!==O&&"not-in"!==O&&"array-contains-any"!==O||Zz(B,O),K=Vz(f,"where",B,"in"===O||"not-in"===O);return gr.create(I,O,K)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class t1 extends BO{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new t1(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return 1===t.length?t[0]:Xr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,r){let s=i;const f=r.getFlattenedFilters();for(const b of f)Wz(s,b),s=aE(s,b)}(e._query,t),new Hl(e.firestore,e.converter,aE(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class VO extends OE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new VO(e,t)}_apply(e){const t=function(i,r,s){if(null!==i.startAt)throw new Wt(Ct.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new Wt(Ct.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const f=new r_(r,s);return function(b,I){if(null===gS(b)){const O=sE(b);null!==O&&Yz(0,O,I.field)}}(i,f),f}(e._query,this._field,this._direction);return new Hl(e.firestore,e.converter,function(i,r){const s=i.explicitOrderBy.concat([r]);return new Xd(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class tM extends OE{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new tM(e,t,i)}_apply(e){return new Hl(e.firestore,e.converter,Nw(e._query,this._limit,this._limitType))}}class nM extends OE{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new nM(e,t,i)}_apply(e){const t=Hz(e,this.type,this._docOrFields,this._inclusive);return new Hl(e.firestore,e.converter,(r=t,new Xd((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,r,i.endAt)));var i,r}}class iM extends OE{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new iM(e,t,i)}_apply(e){const t=Hz(e,this.type,this._docOrFields,this._inclusive);return new Hl(e.firestore,e.converter,(r=t,new Xd((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,r)));var i,r}}function Hz(n,e,t,i){if(t[0]=(0,te.m9)(t[0]),t[0]instanceof PE)return function(r,s,f,b,I){if(!b)throw new Wt(Ct.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${f}().`);const O=[];for(const B of Vm(r))if(B.field.isKeyField())O.push(bp(s,b.key));else{const K=b.data.field(B.field);if(JC(K))throw new Wt(Ct.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+B.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===K){const le=B.field.canonicalString();throw new Wt(Ct.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${le}' (used as the orderBy) does not exist.`)}O.push(K)}return new xp(O,I)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{const r=yb(n.firestore);return function(s,f,b,I,O,B){const K=s.explicitOrderBy;if(O.length>K.length)throw new Wt(Ct.INVALID_ARGUMENT,`Too many arguments provided to ${I}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const le=[];for(let ge=0;ge<O.length;ge++){const Te=O[ge];if(K[ge].field.isKeyField()){if("string"!=typeof Te)throw new Wt(Ct.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${I}(), but got a ${typeof Te}`);if(!_S(s)&&-1!==Te.indexOf("/"))throw new Wt(Ct.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${I}() must be a plain document ID, but '${Te}' contains a slash.`);const Ge=s.path.child(Pr.fromString(Te));if(!Pn.isDocumentKey(Ge))throw new Wt(Ct.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${I}() must result in a valid document path, but '${Ge}' is not because it contains an odd number of segments.`);const Je=new Pn(Ge);le.push(bp(f,Je))}else{const Ge=Vz(b,I,Te);le.push(Ge)}}return new xp(le,B)}(n._query,n.firestore._databaseId,r,e,t,i)}}function qz(n,e,t){if("string"==typeof(t=(0,te.m9)(t))){if(""===t)throw new Wt(Ct.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_S(e)&&-1!==t.indexOf("/"))throw new Wt(Ct.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Pr.fromString(t));if(!Pn.isDocumentKey(i))throw new Wt(Ct.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return bp(n,new Pn(i))}if(t instanceof ps)return bp(n,t._key);throw new Wt(Ct.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ZS(t)}.`)}function Zz(n,e){if(!Array.isArray(n)||0===n.length)throw new Wt(Ct.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Wz(n,e){if(e.isInequality()){const i=sE(n),r=e.field;if(null!==i&&!i.isEqual(r))throw new Wt(Ct.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${i.toString()}' and '${r.toString()}'`);const s=gS(n);null!==s&&Yz(0,r,s)}const t=function(i,r){for(const s of i)for(const f of s.getFlattenedFilters())if(r.indexOf(f.op)>=0)return f.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Wt(Ct.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Yz(n,e,t){if(!t.isEqual(e))throw new Wt(Ct.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class UO{convertValue(e,t="none"){switch(i_(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ns(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(n_(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Hn()}}convertObject(e,t){const i={};return t_(e.fields,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertGeoPoint(e){return new YS(ns(e.latitude),ns(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Aw(e);return null==i?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Qy(e));default:return null}}convertTimestamp(e){const t=Nm(e);return new Vo(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Pr.fromString(e);ai(fN(i));const r=new zm(i.get(1),i.get(3)),s=new Pn(i.popFirst(5));return r.isEqual(t)||Cs(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function rM(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class CG extends UO{constructor(e){super(),this.firestore=e}convertBytes(e){return new $m(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ps(this.firestore,null,t)}}class bb{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class l_ extends PE{constructor(e,t,i,r,s,f){super(e,t,i,r,f),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new RE(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(eM("DocumentSnapshot.get",e));if(null!==i)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class RE extends l_{data(e={}){return super.data(e)}}class cv{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new bb(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new RE(this._firestore,this._userDataWriter,i.key,i,new bb(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Wt(Ct.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(f=>({type:"added",doc:new RE(i._firestore,i._userDataWriter,f.doc.key,f.doc,new bb(i._snapshot.mutatedKeys.has(f.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:s++}))}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(f=>r||3!==f.type).map(f=>{const b=new RE(i._firestore,i._userDataWriter,f.doc.key,f.doc,new bb(i._snapshot.mutatedKeys.has(f.doc.key),i._snapshot.fromCache),i.query.converter);let I=-1,O=-1;return 0!==f.type&&(I=s.indexOf(f.doc.key),s=s.delete(f.doc.key)),1!==f.type&&(s=s.add(f.doc),O=s.indexOf(f.doc.key)),{type:TG(f.type),doc:b,oldIndex:I,newIndex:O}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function TG(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Hn()}}function Xz(n,e){return n instanceof l_&&e instanceof l_?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof cv&&e instanceof cv&&n._firestore===e._firestore&&kO(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class uv extends UO{constructor(e){super(),this.firestore=e}convertBytes(e){return new $m(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ps(this.firestore,null,t)}}function Qz(n,e,t){n=Or(n,ps);const i=Or(n.firestore,ms),r=rM(n.converter,e,t);return n1(i,[XS(yb(i),"setDoc",n._key,r,null!==n.converter,t).toMutation(n._key,he.none())])}function Jz(n,e,t,...i){n=Or(n,ps);const r=Or(n.firestore,ms),s=yb(r);let f;return f="string"==typeof(e=(0,te.m9)(e))||e instanceof a_?NO(s,"updateDoc",n._key,e,t,i):LO(s,"updateDoc",n._key,e),n1(r,[f.toMutation(n._key,he.exists(!0))])}function eB(n,e){const t=Or(n.firestore,ms),i=WS(n),r=rM(n.converter,e);return n1(t,[XS(yb(n.firestore),"addDoc",i._key,r,null!==n.converter,{}).toMutation(i._key,he.exists(!1))]).then(()=>i)}function tB(n,...e){var t,i,r;n=(0,te.m9)(n);let s={includeMetadataChanges:!1},f=0;"object"!=typeof e[f]||RO(e[f])||(s=e[f],f++);const b={includeMetadataChanges:s.includeMetadataChanges};if(RO(e[f])){const K=e[f];e[f]=null===(t=K.next)||void 0===t?void 0:t.bind(K),e[f+1]=null===(i=K.error)||void 0===i?void 0:i.bind(K),e[f+2]=null===(r=K.complete)||void 0===r?void 0:r.bind(K)}let I,O,B;if(n instanceof ps)O=Or(n.firestore,ms),B=wp(n._key.path),I={next:K=>{e[f]&&e[f](jO(O,n,K))},error:e[f+1],complete:e[f+2]};else{const K=Or(n,Hl);O=Or(K.firestore,ms),B=K._query;const le=new uv(O);I={next:ge=>{e[f]&&e[f](new cv(O,le,K,ge))},error:e[f+1],complete:e[f+2]},Gz(n._query)}return function(K,le,ge,Te){const Ge=new $S(Te),Je=new YP(le,Ge,ge);return K.asyncQueue.enqueueAndForget((0,V.Z)(function*(){return GP(yield e1(K),Je)})),()=>{Ge.yc(),K.asyncQueue.enqueueAndForget((0,V.Z)(function*(){return qP(yield e1(K),Je)}))}}(oa(O),B,b,I)}function n1(n,e){return function(t,i){const r=new na;return t.asyncQueue.enqueueAndForget((0,V.Z)(function*(){return function v$(n,e,t){return eO.apply(this,arguments)}(yield DO(t),i,r)})),r.promise}(oa(n),e)}function jO(n,e,t){const i=t.docs.get(e._key),r=new uv(n);return new l_(n,r,e._key,i,new bb(t.hasPendingWrites,t.fromCache),e.converter)}const VG={maxAttempts:5};class nB{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=yb(e)}set(e,t,i){this._verifyNotCommitted();const r=dv(e,this._firestore),s=rM(r.converter,t,i),f=XS(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,i);return this._mutations.push(f.toMutation(r._key,he.none())),this}update(e,t,i,...r){this._verifyNotCommitted();const s=dv(e,this._firestore);let f;return f="string"==typeof(t=(0,te.m9)(t))||t instanceof a_?NO(this._dataReader,"WriteBatch.update",s._key,t,i,r):LO(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(f.toMutation(s._key,he.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=dv(e,this._firestore);return this._mutations=this._mutations.concat(new cb(t._key,he.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Wt(Ct.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function dv(n,e){if((n=(0,te.m9)(n)).firestore!==e)throw new Wt(Ct.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class UG extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=yb(e)}get(e){const t=dv(e,this._firestore),i=new CG(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||1!==r.length)return Hn();const s=r[0];if(s.isFoundDocument())return new PE(this._firestore,i,s.key,s,t.converter);if(s.isNoDocument())return new PE(this._firestore,i,t._key,null,t.converter);throw Hn()})}set(e,t,i){const r=dv(e,this._firestore),s=rM(r.converter,t,i),f=XS(this._dataReader,"Transaction.set",r._key,s,null!==r.converter,i);return this._transaction.set(r._key,f),this}update(e,t,i,...r){const s=dv(e,this._firestore);let f;return f="string"==typeof(t=(0,te.m9)(t))||t instanceof a_?NO(this._dataReader,"Transaction.update",s._key,t,i,r):LO(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,f),this}delete(e){const t=dv(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=dv(e,this._firestore),i=new uv(this._firestore);return super.get(e).then(r=>new l_(this._firestore,i,t._key,r._document,new bb(!1,!1),t.converter))}}!function(n,e=!0){km=Q.SDK_VERSION,(0,Q._registerComponent)(new ie.wA("firestore",(t,{instanceIdentifier:i,options:r})=>{const s=t.getProvider("app").getImmediate(),f=new ms(new Zy(t.getProvider("auth-internal")),new RL(t.getProvider("app-check-internal")),function(b,I){if(!Object.prototype.hasOwnProperty.apply(b.options,["projectId"]))throw new Wt(Ct.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zm(b.options.projectId,I)}(s,i),s);return r=Object.assign({useFetchStreams:e},r),f._setSettings(r),f},"PUBLIC").setMultipleInstances(!0)),(0,Q.registerVersion)(UC,"3.10.0",n),(0,Q.registerVersion)(UC,"3.10.0","esm2017")}(),(0,Q.registerVersion)("firebase","9.19.1","app");var r1=De(8766);const rB="@firebase/installations",$O="0.6.4",oB=1e4,sB=`w:${$O}`,aB="FIS_v2",QG="https://firebaseinstallations.googleapis.com/v1",JG=36e5,c_=new te.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function lB(n){return n instanceof te.ZR&&n.code.includes("request-failed")}function GO({projectId:n}){return`${QG}/projects/${n}/installations`}function cB(n){return{token:n.token,requestStatus:2,expiresIn:iH(n.expiresIn),creationTime:Date.now()}}function HO(n,e){return qO.apply(this,arguments)}function qO(){return qO=(0,V.Z)(function*(n,e){const i=(yield e.json()).error;return c_.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}),qO.apply(this,arguments)}function uB({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function ZO(n){return WO.apply(this,arguments)}function WO(){return WO=(0,V.Z)(function*(n){const e=yield n();return e.status>=500&&e.status<600?n():e}),WO.apply(this,arguments)}function iH(n){return Number(n.replace("s","000"))}function YO(){return YO=(0,V.Z)(function*({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=GO(n),r=uB(n),s=e.getImmediate({optional:!0});if(s){const O=yield s.getHeartbeatsHeader();O&&r.append("x-firebase-client",O)}const b={method:"POST",headers:r,body:JSON.stringify({fid:t,authVersion:aB,appId:n.appId,sdkVersion:sB})},I=yield ZO(()=>fetch(i,b));if(I.ok){const O=yield I.json();return{fid:O.fid||t,registrationStatus:2,refreshToken:O.refreshToken,authToken:cB(O.authToken)}}throw yield HO("Create Installation",I)}),YO.apply(this,arguments)}function hB(n){return new Promise(e=>{setTimeout(e,n)})}const aH=/^[cdef][\w-]{21}$/,KO="";function lH(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=function cH(n){return function sH(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return aH.test(t)?t:KO}catch{return KO}}function o1(n){return`${n.appName}!${n.appId}`}const s1=new Map;function fB(n,e){const t=o1(n);pB(t,e),function hH(n,e){const t=function mB(){return!xb&&"BroadcastChannel"in self&&(xb=new BroadcastChannel("[Firebase] FID Change"),xb.onmessage=n=>{pB(n.data.key,n.data.fid)}),xb}();t&&t.postMessage({key:n,fid:e}),function gB(){0===s1.size&&xb&&(xb.close(),xb=null)}()}(t,e)}function pB(n,e){const t=s1.get(n);if(t)for(const i of t)i(e)}let xb=null;const fH="firebase-installations-database",pH=1,wb="firebase-installations-store";let XO=null;function QO(){return XO||(XO=(0,r1.X3)(fH,pH,{upgrade:(n,e)=>{0===e&&n.createObjectStore(wb)}})),XO}function oM(n,e){return JO.apply(this,arguments)}function JO(){return JO=(0,V.Z)(function*(n,e){const t=o1(n),r=(yield QO()).transaction(wb,"readwrite"),s=r.objectStore(wb),f=yield s.get(t);return yield s.put(e,t),yield r.done,(!f||f.fid!==e.fid)&&fB(n,e.fid),e}),JO.apply(this,arguments)}function ek(n){return tk.apply(this,arguments)}function tk(){return tk=(0,V.Z)(function*(n){const e=o1(n),i=(yield QO()).transaction(wb,"readwrite");yield i.objectStore(wb).delete(e),yield i.done}),tk.apply(this,arguments)}function FE(n,e){return nk.apply(this,arguments)}function nk(){return nk=(0,V.Z)(function*(n,e){const t=o1(n),r=(yield QO()).transaction(wb,"readwrite"),s=r.objectStore(wb),f=yield s.get(t),b=e(f);return void 0===b?yield s.delete(t):yield s.put(b,t),yield r.done,b&&(!f||f.fid!==b.fid)&&fB(n,b.fid),b}),nk.apply(this,arguments)}function ik(n){return rk.apply(this,arguments)}function rk(){return rk=(0,V.Z)(function*(n){let e;const t=yield FE(n.appConfig,i=>{const r=function mH(n){return yB(n||{fid:lH(),registrationStatus:0})}(i),s=function gH(n,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(c_.create("app-offline"))};const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=function _H(n,e){return ok.apply(this,arguments)}(n,t);return{installationEntry:t,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:yH(n)}:{installationEntry:e}}(n,r);return e=s.registrationPromise,s.installationEntry});return t.fid===KO?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}}),rk.apply(this,arguments)}function ok(){return ok=(0,V.Z)(function*(n,e){try{const t=yield function oH(n,e){return YO.apply(this,arguments)}(n,e);return oM(n.appConfig,t)}catch(t){throw lB(t)&&409===t.customData.serverCode?yield ek(n.appConfig):yield oM(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}),ok.apply(this,arguments)}function yH(n){return sk.apply(this,arguments)}function sk(){return sk=(0,V.Z)(function*(n){let e=yield _B(n.appConfig);for(;1===e.registrationStatus;)yield hB(100),e=yield _B(n.appConfig);if(0===e.registrationStatus){const{installationEntry:t,registrationPromise:i}=yield ik(n);return i||t}return e}),sk.apply(this,arguments)}function _B(n){return FE(n,e=>{if(!e)throw c_.create("installation-not-found");return yB(e)})}function yB(n){return function vH(n){return 1===n.registrationStatus&&n.registrationTime+oB<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function ak(){return ak=(0,V.Z)(function*({appConfig:n,heartbeatServiceProvider:e},t){const i=function xH(n,{fid:e}){return`${GO(n)}/${e}/authTokens:generate`}(n,t),r=function dB(n,{refreshToken:e}){const t=uB(n);return t.append("Authorization",function rH(n){return`${aB} ${n}`}(e)),t}(n,t),s=e.getImmediate({optional:!0});if(s){const O=yield s.getHeartbeatsHeader();O&&r.append("x-firebase-client",O)}const b={method:"POST",headers:r,body:JSON.stringify({installation:{sdkVersion:sB,appId:n.appId}})},I=yield ZO(()=>fetch(i,b));if(I.ok)return cB(yield I.json());throw yield HO("Generate Auth Token",I)}),ak.apply(this,arguments)}function lk(n){return ck.apply(this,arguments)}function ck(){return ck=(0,V.Z)(function*(n,e=!1){let t;const i=yield FE(n.appConfig,s=>{if(!bB(s))throw c_.create("not-registered");const f=s.authToken;if(!e&&function EH(n){return 2===n.requestStatus&&!function TH(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+JG}(n)}(f))return s;if(1===f.requestStatus)return t=function wH(n,e){return uk.apply(this,arguments)}(n,e),s;{if(!navigator.onLine)throw c_.create("app-offline");const b=function IH(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}(s);return t=function CH(n,e){return dk.apply(this,arguments)}(n,b),b}});return t?yield t:i.authToken}),ck.apply(this,arguments)}function uk(){return uk=(0,V.Z)(function*(n,e){let t=yield vB(n.appConfig);for(;1===t.authToken.requestStatus;)yield hB(100),t=yield vB(n.appConfig);const i=t.authToken;return 0===i.requestStatus?lk(n,e):i}),uk.apply(this,arguments)}function vB(n){return FE(n,e=>{if(!bB(e))throw c_.create("not-registered");return function SH(n){return 1===n.requestStatus&&n.requestTime+oB<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function dk(){return dk=(0,V.Z)(function*(n,e){try{const t=yield function bH(n,e){return ak.apply(this,arguments)}(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return yield oM(n.appConfig,i),t}catch(t){if(!lB(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode){const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield oM(n.appConfig,i)}else yield ek(n.appConfig);throw t}}),dk.apply(this,arguments)}function bB(n){return void 0!==n&&2===n.registrationStatus}function hk(){return hk=(0,V.Z)(function*(n){const e=n,{installationEntry:t,registrationPromise:i}=yield ik(e);return i?i.catch(console.error):lk(e).catch(console.error),t.fid}),hk.apply(this,arguments)}function fk(){return fk=(0,V.Z)(function*(n,e=!1){const t=n;return yield function AH(n){return pk.apply(this,arguments)}(t),(yield lk(t,e)).token}),fk.apply(this,arguments)}function pk(){return pk=(0,V.Z)(function*(n){const{registrationPromise:e}=yield ik(n);e&&(yield e)}),pk.apply(this,arguments)}function _k(n){return c_.create("missing-app-config-values",{valueName:n})}const xB="installations",FH=n=>{const e=n.getProvider("app").getImmediate(),t=function kH(n){if(!n||!n.options)throw _k("App Configuration");if(!n.name)throw _k("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw _k(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(e);return{app:e,appConfig:t,heartbeatServiceProvider:(0,Q._getProvider)(e,"heartbeat"),_delete:()=>Promise.resolve()}},LH=n=>{const e=n.getProvider("app").getImmediate(),t=(0,Q._getProvider)(e,xB).getImmediate();return{getId:()=>function MH(n){return hk.apply(this,arguments)}(t),getToken:r=>function DH(n){return fk.apply(this,arguments)}(t,r)}};(function NH(){(0,Q._registerComponent)(new ie.wA(xB,FH,"PUBLIC")),(0,Q._registerComponent)(new ie.wA("installations-internal",LH,"PRIVATE"))})(),(0,Q.registerVersion)(rB,$O),(0,Q.registerVersion)(rB,$O,"esm2017");const yk="@firebase/remote-config",od=new te.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class WH{constructor(e,t,i,r){this.client=e,this.storage=t,this.storageCache=i,this.logger=r}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const i=Date.now()-t,r=i<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${i}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}fetch(e){var t=this;return(0,V.Z)(function*(){const[i,r]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(r&&t.isCachedDataFresh(e.cacheMaxAgeMillis,i))return r;e.eTag=r&&r.eTag;const s=yield t.client.fetch(e),f=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===s.status&&f.push(t.storage.setLastSuccessfulFetchResponse(s)),yield Promise.all(f),s})()}}function YH(n=navigator){return n.languages&&n.languages[0]||n.language}class KH{constructor(e,t,i,r,s,f){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=i,this.projectId=r,this.apiKey=s,this.appId=f}fetch(e){var t=this;return(0,V.Z)(function*(){const[i,r]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),f=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,b={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},I={sdk_version:t.sdkVersion,app_instance_id:i,app_instance_id_token:r,app_id:t.appId,language_code:YH()},O={method:"POST",headers:b,body:JSON.stringify(I)},B=fetch(f,O),K=new Promise((Qt,xn)=>{e.signal.addEventListener(()=>{const zn=new Error("The operation was aborted.");zn.name="AbortError",xn(zn)})});let le;try{yield Promise.race([B,K]),le=yield B}catch(Qt){let xn="fetch-client-network";throw"AbortError"===Qt?.name&&(xn="fetch-timeout"),od.create(xn,{originalErrorMessage:Qt?.message})}let ge=le.status;const Te=le.headers.get("ETag")||void 0;let Ge,Je;if(200===le.status){let Qt;try{Qt=yield le.json()}catch(xn){throw od.create("fetch-client-parse",{originalErrorMessage:xn?.message})}Ge=Qt.entries,Je=Qt.state}if("INSTANCE_STATE_UNSPECIFIED"===Je?ge=500:"NO_CHANGE"===Je?ge=304:("NO_TEMPLATE"===Je||"EMPTY_CONFIG"===Je)&&(Ge={}),304!==ge&&200!==ge)throw od.create("fetch-status",{httpStatus:ge});return{status:ge,eTag:Te,config:Ge}})()}}class JH{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return(0,V.Z)(function*(){const i=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,i)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:i}){var r=this;return(0,V.Z)(function*(){yield function XH(n,e){return new Promise((t,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(s),i(od.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(e.signal,t);try{const s=yield r.client.fetch(e);return yield r.storage.deleteThrottleMetadata(),s}catch(s){if(!function QH(n){if(!(n instanceof te.ZR&&n.customData))return!1;const e=Number(n.customData.httpStatus);return 429===e||500===e||503===e||504===e}(s))throw s;const f={throttleEndTimeMillis:Date.now()+(0,te.$s)(i),backoffCount:i+1};return yield r.storage.setThrottleMetadata(f),r.attemptFetch(e,f)}})()}}class nq{constructor(e,t,i,r,s){this.app=e,this._client=t,this._storageCache=i,this._storage=r,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function aM(n,e){const t=n.target.error||void 0;return od.create(e,{originalErrorMessage:t&&t?.message})}const Cb="app_namespace_store";class sq{constructor(e,t,i,r=function oq(){return new Promise((n,e)=>{try{const t=indexedDB.open("firebase_remote_config",1);t.onerror=i=>{e(aM(i,"storage-open"))},t.onsuccess=i=>{n(i.target.result)},t.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(Cb,{keyPath:"compositeKey"})}}catch(t){e(od.create("storage-open",{originalErrorMessage:t?.message}))}})}()){this.appId=e,this.appName=t,this.namespace=i,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return(0,V.Z)(function*(){const i=yield t.openDbPromise;return new Promise((r,s)=>{const b=i.transaction([Cb],"readonly").objectStore(Cb),I=t.createCompositeKey(e);try{const O=b.get(I);O.onerror=B=>{s(aM(B,"storage-get"))},O.onsuccess=B=>{const K=B.target.result;r(K?K.value:void 0)}}catch(O){s(od.create("storage-get",{originalErrorMessage:O?.message}))}})})()}set(e,t){var i=this;return(0,V.Z)(function*(){const r=yield i.openDbPromise;return new Promise((s,f)=>{const I=r.transaction([Cb],"readwrite").objectStore(Cb),O=i.createCompositeKey(e);try{const B=I.put({compositeKey:O,value:t});B.onerror=K=>{f(aM(K,"storage-set"))},B.onsuccess=()=>{s()}}catch(B){f(od.create("storage-set",{originalErrorMessage:B?.message}))}})})()}delete(e){var t=this;return(0,V.Z)(function*(){const i=yield t.openDbPromise;return new Promise((r,s)=>{const b=i.transaction([Cb],"readwrite").objectStore(Cb),I=t.createCompositeKey(e);try{const O=b.delete(I);O.onerror=B=>{s(aM(B,"storage-delete"))},O.onsuccess=()=>{r()}}catch(O){s(od.create("storage-delete",{originalErrorMessage:O?.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class aq{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return(0,V.Z)(function*(){const t=e.storage.getLastFetchStatus(),i=e.storage.getLastSuccessfulFetchTimestampMillis(),r=e.storage.getActiveConfig(),s=yield t;s&&(e.lastFetchStatus=s);const f=yield i;f&&(e.lastSuccessfulFetchTimestampMillis=f);const b=yield r;b&&(e.activeConfig=b)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function cq(){return Ck.apply(this,arguments)}function Ck(){return(Ck=(0,V.Z)(function*(){if(!(0,te.hl)())return!1;try{return yield(0,te.eu)()}catch{return!1}})).apply(this,arguments)}!function lq(){(0,Q._registerComponent)(new ie.wA("remote-config",function n(e,{instanceIdentifier:t}){const i=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw od.create("registration-window");if(!(0,te.hl)())throw od.create("indexed-db-unavailable");const{projectId:s,apiKey:f,appId:b}=i.options;if(!s)throw od.create("registration-project-id");if(!f)throw od.create("registration-api-key");if(!b)throw od.create("registration-app-id");const I=new sq(b,i.name,t=t||"firebase"),O=new aq(I),B=new se.Yd(yk);B.logLevel=se.in.ERROR;const K=new KH(r,Q.SDK_VERSION,t,s,f,b),le=new JH(K,I),ge=new WH(le,I,O,B),Te=new nq(i,ge,O,I,B);return function HH(n){const e=(0,te.m9)(n);e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0}))}(Te),Te},"PUBLIC").setMultipleInstances(!0)),(0,Q.registerVersion)(yk,"0.4.4"),(0,Q.registerVersion)(yk,"0.4.4","esm2017")}();const uq="/firebase-messaging-sw.js",dq="/firebase-cloud-messaging-push-scope",TB="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",hq="https://fcmregistrations.googleapis.com/v1",IB="google.c.a.c_id",fq="google.c.a.c_l",pq="google.c.a.ts",mq="google.c.a.e";var a1=(()=>(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"}(a1||(a1={})),a1))();function u_(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function gq(n){const t=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),r=new Uint8Array(i.length);for(let s=0;s<i.length;++s)r[s]=i.charCodeAt(s);return r}const Ek="fcm_token_details_db",_q=5,SB="fcm_token_object_Store";function Tk(){return Tk=(0,V.Z)(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(s=>s.name).includes(Ek))return null;let e=null;return(yield(0,r1.X3)(Ek,_q,{upgrade:(i=(0,V.Z)(function*(r,s,f,b){var I;if(s<2||!r.objectStoreNames.contains(SB))return;const O=b.objectStore(SB),B=yield O.index("fcmSenderId").get(n);if(yield O.clear(),B)if(2===s){const K=B;if(!K.auth||!K.p256dh||!K.endpoint)return;e={token:K.fcmToken,createTime:null!==(I=K.createTime)&&void 0!==I?I:Date.now(),subscriptionOptions:{auth:K.auth,p256dh:K.p256dh,endpoint:K.endpoint,swScope:K.swScope,vapidKey:"string"==typeof K.vapidKey?K.vapidKey:u_(K.vapidKey)}}}else if(3===s){const K=B;e={token:K.fcmToken,createTime:K.createTime,subscriptionOptions:{auth:u_(K.auth),p256dh:u_(K.p256dh),endpoint:K.endpoint,swScope:K.swScope,vapidKey:u_(K.vapidKey)}}}else if(4===s){const K=B;e={token:K.fcmToken,createTime:K.createTime,subscriptionOptions:{auth:u_(K.auth),p256dh:u_(K.p256dh),endpoint:K.endpoint,swScope:K.swScope,vapidKey:u_(K.vapidKey)}}}}),function(s,f,b,I){return i.apply(this,arguments)})})).close(),yield(0,r1.Lj)(Ek),yield(0,r1.Lj)("fcm_vapid_details_db"),yield(0,r1.Lj)("undefined"),function vq(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}(e)?e:null;var i}),Tk.apply(this,arguments)}const bq="firebase-messaging-database",xq=1,Eb="firebase-messaging-store";let Ik=null;function Sk(){return Ik||(Ik=(0,r1.X3)(bq,xq,{upgrade:(n,e)=>{0===e&&n.createObjectStore(Eb)}})),Ik}function MB(n){return Mk.apply(this,arguments)}function Mk(){return Mk=(0,V.Z)(function*(n){const e=Ok(n),i=yield(yield Sk()).transaction(Eb).objectStore(Eb).get(e);if(i)return i;{const r=yield function yq(n){return Tk.apply(this,arguments)}(n.appConfig.senderId);if(r)return yield Dk(n,r),r}}),Mk.apply(this,arguments)}function Dk(n,e){return Ak.apply(this,arguments)}function Ak(){return Ak=(0,V.Z)(function*(n,e){const t=Ok(n),r=(yield Sk()).transaction(Eb,"readwrite");return yield r.objectStore(Eb).put(e,t),yield r.done,e}),Ak.apply(this,arguments)}function Pk(){return Pk=(0,V.Z)(function*(n){const e=Ok(n),i=(yield Sk()).transaction(Eb,"readwrite");yield i.objectStore(Eb).delete(e),yield i.done}),Pk.apply(this,arguments)}function Ok({appConfig:n}){return n.appId}const ql=new te.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function Eq(n,e){return kk.apply(this,arguments)}function kk(){return kk=(0,V.Z)(function*(n,e){const t=yield Nk(n),i=AB(e),r={method:"POST",headers:t,body:JSON.stringify(i)};let s;try{s=yield(yield fetch(Lk(n.appConfig),r)).json()}catch(f){throw ql.create("token-subscribe-failed",{errorInfo:f?.toString()})}if(s.error)throw ql.create("token-subscribe-failed",{errorInfo:s.error.message});if(!s.token)throw ql.create("token-subscribe-no-token");return s.token}),kk.apply(this,arguments)}function Rk(){return Rk=(0,V.Z)(function*(n,e){const t=yield Nk(n),i=AB(e.subscriptionOptions),r={method:"PATCH",headers:t,body:JSON.stringify(i)};let s;try{s=yield(yield fetch(`${Lk(n.appConfig)}/${e.token}`,r)).json()}catch(f){throw ql.create("token-update-failed",{errorInfo:f?.toString()})}if(s.error)throw ql.create("token-update-failed",{errorInfo:s.error.message});if(!s.token)throw ql.create("token-update-no-token");return s.token}),Rk.apply(this,arguments)}function DB(n,e){return Fk.apply(this,arguments)}function Fk(){return Fk=(0,V.Z)(function*(n,e){const i={method:"DELETE",headers:yield Nk(n)};try{const s=yield(yield fetch(`${Lk(n.appConfig)}/${e}`,i)).json();if(s.error)throw ql.create("token-unsubscribe-failed",{errorInfo:s.error.message})}catch(r){throw ql.create("token-unsubscribe-failed",{errorInfo:r?.toString()})}}),Fk.apply(this,arguments)}function Lk({projectId:n}){return`${hq}/projects/${n}/registrations`}function Nk(n){return zk.apply(this,arguments)}function zk(){return zk=(0,V.Z)(function*({appConfig:n,installations:e}){const t=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}),zk.apply(this,arguments)}function AB({p256dh:n,auth:e,endpoint:t,vapidKey:i}){const r={web:{endpoint:t,auth:e,p256dh:n}};return i!==TB&&(r.web.applicationPubKey=i),r}const Iq=6048e5;function Bk(){return Bk=(0,V.Z)(function*(n){const e=yield function Dq(n,e){return $k.apply(this,arguments)}(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:u_(e.getKey("auth")),p256dh:u_(e.getKey("p256dh"))},i=yield MB(n.firebaseDependencies);if(i){if(function Aq(n,e){return e.vapidKey===n.vapidKey&&e.endpoint===n.endpoint&&e.auth===n.auth&&e.p256dh===n.p256dh}(i.subscriptionOptions,t))return Date.now()>=i.createTime+Iq?function Mq(n,e){return Uk.apply(this,arguments)}(n,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{yield DB(n.firebaseDependencies,i.token)}catch(r){console.warn(r)}return OB(n.firebaseDependencies,t)}return OB(n.firebaseDependencies,t)}),Bk.apply(this,arguments)}function Vk(){return Vk=(0,V.Z)(function*(n){const e=yield MB(n.firebaseDependencies);e&&(yield DB(n.firebaseDependencies,e.token),yield function wq(n){return Pk.apply(this,arguments)}(n.firebaseDependencies));const t=yield n.swRegistration.pushManager.getSubscription();return!t||t.unsubscribe()}),Vk.apply(this,arguments)}function Uk(){return Uk=(0,V.Z)(function*(n,e){try{const t=yield function Tq(n,e){return Rk.apply(this,arguments)}(n.firebaseDependencies,e),i=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield Dk(n.firebaseDependencies,i),t}catch(t){throw yield function PB(n){return Vk.apply(this,arguments)}(n),t}}),Uk.apply(this,arguments)}function OB(n,e){return jk.apply(this,arguments)}function jk(){return jk=(0,V.Z)(function*(n,e){const i={token:yield Eq(n,e),createTime:Date.now(),subscriptionOptions:e};return yield Dk(n,i),i.token}),jk.apply(this,arguments)}function $k(){return $k=(0,V.Z)(function*(n,e){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:gq(e)})}),$k.apply(this,arguments)}function kB(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function Pq(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const i=e.notification.body;i&&(n.notification.body=i);const r=e.notification.image;r&&(n.notification.image=r);const s=e.notification.icon;s&&(n.notification.icon=s)}(e,n),function Oq(n,e){e.data&&(n.data=e.data)}(e,n),function kq(n,e){var t,i,r,s,f;if(!(e.fcmOptions||null!==(t=e.notification)&&void 0!==t&&t.click_action))return;n.fcmOptions={};const b=null!==(r=null===(i=e.fcmOptions)||void 0===i?void 0:i.link)&&void 0!==r?r:null===(s=e.notification)||void 0===s?void 0:s.click_action;b&&(n.fcmOptions.link=b);const I=null===(f=e.fcmOptions)||void 0===f?void 0:f.analytics_label;I&&(n.fcmOptions.analyticsLabel=I)}(e,n),e}function RB(n,e){const t=[];for(let i=0;i<n.length;i++)t.push(n.charAt(i)),i<e.length&&t.push(e.charAt(i));return t.join("")}function Gk(n){return ql.create("missing-app-config-values",{valueName:n})}RB("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),RB("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Lq{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function Fq(n){if(!n||!n.options)throw Gk("App Configuration Object");if(!n.name)throw Gk("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const i of e)if(!t[i])throw Gk(i);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}function Hk(){return Hk=(0,V.Z)(function*(n){try{n.swRegistration=yield navigator.serviceWorker.register(uq,{scope:dq}),n.swRegistration.update().catch(()=>{})}catch(e){throw ql.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}),Hk.apply(this,arguments)}function qk(){return qk=(0,V.Z)(function*(n,e){if(!e&&!n.swRegistration&&(yield function FB(n){return Hk.apply(this,arguments)}(n)),e||!n.swRegistration){if(!(e instanceof ServiceWorkerRegistration))throw ql.create("invalid-sw-registration");n.swRegistration=e}}),qk.apply(this,arguments)}function Zk(){return Zk=(0,V.Z)(function*(n,e){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=TB)}),Zk.apply(this,arguments)}function Wk(){return Wk=(0,V.Z)(function*(n,e){if(!navigator)throw ql.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw ql.create("permission-blocked");return yield function zq(n,e){return Zk.apply(this,arguments)}(n,e?.vapidKey),yield function Nq(n,e){return qk.apply(this,arguments)}(n,e?.serviceWorkerRegistration),function Sq(n){return Bk.apply(this,arguments)}(n)}),Wk.apply(this,arguments)}function Yk(){return Yk=(0,V.Z)(function*(n,e,t){const i=function Vq(n){switch(n){case a1.NOTIFICATION_CLICKED:return"notification_open";case a1.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(e);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[IB],message_name:t[fq],message_time:t[pq],message_device_time:Math.floor(Date.now()/1e3)})}),Yk.apply(this,arguments)}function Kk(){return Kk=(0,V.Z)(function*(n,e){const t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===a1.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(kB(t)):n.onMessageHandler.next(kB(t)));const i=t.data;(function Rq(n){return"object"==typeof n&&!!n&&IB in n})(i)&&"1"===i[mq]&&(yield function Bq(n,e,t){return Yk.apply(this,arguments)}(n,t.messageType,i))}),Kk.apply(this,arguments)}const NB="@firebase/messaging",jq=n=>{const e=new Lq(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>function Uq(n,e){return Kk.apply(this,arguments)}(e,t)),e},$q=n=>{const e=n.getProvider("messaging").getImmediate();return{getToken:i=>function LB(n,e){return Wk.apply(this,arguments)}(e,i)}};function BB(){return Xk.apply(this,arguments)}function Xk(){return(Xk=(0,V.Z)(function*(){try{yield(0,te.eu)()}catch{return!1}return typeof window<"u"&&(0,te.hl)()&&(0,te.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function Gq(){(0,Q._registerComponent)(new ie.wA("messaging",jq,"PUBLIC")),(0,Q._registerComponent)(new ie.wA("messaging-internal",$q,"PRIVATE")),(0,Q.registerVersion)(NB,"0.12.4"),(0,Q.registerVersion)(NB,"0.12.4","esm2017")}();const lM="analytics",Zq="firebase_id",Wq="origin",Yq=6e4,Kq="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",eR="https://www.googletagmanager.com/gtag/js",hl=new se.Yd("@firebase/analytics"),sd=new te.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Qq(n){if(!n.startsWith(eR)){const e=sd.create("invalid-gtag-resource",{gtagURL:n});return hl.warn(e.message),""}return n}function VB(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function tR(){return tR=(0,V.Z)(function*(n,e,t,i,r,s){const f=i[r];try{if(f)yield e[f];else{const I=(yield VB(t)).find(O=>O.measurementId===r);I&&(yield e[I.appId])}}catch(b){hl.error(b)}n("config",r,s)}),tR.apply(this,arguments)}function nR(){return nR=(0,V.Z)(function*(n,e,t,i,r){try{let s=[];if(r&&r.send_to){let f=r.send_to;Array.isArray(f)||(f=[f]);const b=yield VB(t);for(const I of f){const O=b.find(K=>K.measurementId===I),B=O&&e[O.appId];if(!B){s=[];break}s.push(B)}}0===s.length&&(s=Object.values(e)),yield Promise.all(s),n("event",i,r||{})}catch(s){hl.error(s)}}),nR.apply(this,arguments)}const a8=30,UB=new class c8{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function u8(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function iR(){return iR=(0,V.Z)(function*(n){var e;const{appId:t,apiKey:i}=n,r={method:"GET",headers:u8(i)},s=Kq.replace("{app-id}",t),f=yield fetch(s,r);if(200!==f.status&&304!==f.status){let b="";try{const I=yield f.json();null!==(e=I.error)&&void 0!==e&&e.message&&(b=I.error.message)}catch{}throw sd.create("config-fetch-failed",{httpStatus:f.status,responseMessage:b})}return f.json()}),iR.apply(this,arguments)}function rR(){return rR=(0,V.Z)(function*(n,e=UB,t){const{appId:i,apiKey:r,measurementId:s}=n.options;if(!i)throw sd.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw sd.create("no-api-key")}const f=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},b=new m8;return setTimeout((0,V.Z)(function*(){b.abort()}),void 0!==t?t:Yq),jB({appId:i,apiKey:r,measurementId:s},f,b,e)}),rR.apply(this,arguments)}function jB(n,e,t){return oR.apply(this,arguments)}function oR(){return oR=(0,V.Z)(function*(n,{throttleEndTimeMillis:e,backoffCount:t},i,r=UB){var s;const{appId:f,measurementId:b}=n;try{yield function f8(n,e){return new Promise((t,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(s),i(sd.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(i,e)}catch(I){if(b)return hl.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${b} provided in the "measurementId" field in the local Firebase config. [${I?.message}]`),{appId:f,measurementId:b};throw I}try{const I=yield function d8(n){return iR.apply(this,arguments)}(n);return r.deleteThrottleMetadata(f),I}catch(I){const O=I;if(!function p8(n){if(!(n instanceof te.ZR&&n.customData))return!1;const e=Number(n.customData.httpStatus);return 429===e||500===e||503===e||504===e}(O)){if(r.deleteThrottleMetadata(f),b)return hl.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${b} provided in the "measurementId" field in the local Firebase config. [${O?.message}]`),{appId:f,measurementId:b};throw I}const B=503===Number(null===(s=O?.customData)||void 0===s?void 0:s.httpStatus)?(0,te.$s)(t,r.intervalMillis,a8):(0,te.$s)(t,r.intervalMillis),K={throttleEndTimeMillis:Date.now()+B,backoffCount:t+1};return r.setThrottleMetadata(f,K),hl.debug(`Calling attemptFetch again in ${B} millis`),jB(n,K,i,r)}}),oR.apply(this,arguments)}class m8{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let sR,hR;function aR(){return aR=(0,V.Z)(function*(n,e,t,i,r){if(r&&r.global)n("event",t,i);else{const s=yield e;n("event",t,Object.assign(Object.assign({},i),{send_to:s}))}}),aR.apply(this,arguments)}function cR(){return cR=(0,V.Z)(function*(n,e,t,i){if(i&&i.global)return n("set",{user_id:t}),Promise.resolve();n("config",yield e,{update:!0,user_id:t})}),cR.apply(this,arguments)}function fR(){return fR=(0,V.Z)(function*(){if(!(0,te.hl)())return hl.warn(sd.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,te.eu)()}catch(n){return hl.warn(sd.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}return!0}),fR.apply(this,arguments)}function pR(){return pR=(0,V.Z)(function*(n,e,t,i,r,s,f){var b;const I=function h8(n){return rR.apply(this,arguments)}(n);I.then(ge=>{t[ge.measurementId]=ge.appId,n.options.measurementId&&ge.measurementId!==n.options.measurementId&&hl.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${ge.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(ge=>hl.error(ge)),e.push(I);const O=function x8(){return fR.apply(this,arguments)}().then(ge=>{if(ge)return i.getId()}),[B,K]=yield Promise.all([I,O]);(function s8(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(eR)&&t.src.includes(n))return t;return null})(s)||function e8(n,e){const t=function Jq(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}("firebase-js-sdk-policy",{createScriptURL:Qq}),i=document.createElement("script"),r=`${eR}?l=${n}&id=${e}`;i.src=t?t?.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}(s,B.measurementId),hR&&(r("consent","default",hR),function $B(n){hR=n}(void 0)),r("js",new Date);const le=null!==(b=f?.config)&&void 0!==b?b:{};return le[Wq]="firebase",le.update=!0,null!=K&&(le[Zq]=K),r("config",B.measurementId,le),sR&&(r("set",sR),function GB(n){sR=n}(void 0)),B.measurementId}),pR.apply(this,arguments)}class C8{constructor(e){this.app=e}_delete(){return delete d_[this.app.options.appId],Promise.resolve()}}let d_={},HB=[];const qB={};let WB,h_,cM="dataLayer",ZB="gtag",mR=!1;function T8(n,e,t){!function E8(){const n=[];if((0,te.ru)()&&n.push("This is a browser extension environment."),(0,te.zI)()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,r)=>`(${r+1}) ${i}`).join(" "),t=sd.create("invalid-analytics-context",{errorInfo:e});hl.warn(t.message)}}();const i=n.options.appId;if(!i)throw sd.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw sd.create("no-api-key");hl.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=d_[i])throw sd.create("already-exists",{id:i});if(!mR){!function t8(n){let e=[];Array.isArray(window[n])?e=window[n]:window[n]=e}(cM);const{wrappedGtag:s,gtagCore:f}=function o8(n,e,t,i,r){let s=function(...f){window[i].push(arguments)};return window[r]&&"function"==typeof window[r]&&(s=window[r]),window[r]=function r8(n,e,t,i){function s(){return s=(0,V.Z)(function*(f,b,I){try{"event"===f?yield function i8(n,e,t,i,r){return nR.apply(this,arguments)}(n,e,t,b,I):"config"===f?yield function n8(n,e,t,i,r,s){return tR.apply(this,arguments)}(n,e,t,i,b,I):"consent"===f?n("consent","update",I):n("set",b)}catch(O){hl.error(O)}}),s.apply(this,arguments)}return function r(f,b,I){return s.apply(this,arguments)}}(s,n,e,t),{gtagCore:s,wrappedGtag:window[r]}}(d_,HB,qB,cM,ZB);h_=s,WB=f,mR=!0}return d_[i]=function w8(n,e,t,i,r,s,f){return pR.apply(this,arguments)}(n,HB,qB,e,WB,cM,t),new C8(n)}function I8(n=(0,Q.getApp)()){n=(0,te.m9)(n);const e=(0,Q._getProvider)(n,lM);return e.isInitialized()?e.getImmediate():function S8(n,e={}){const t=(0,Q._getProvider)(n,lM);if(t.isInitialized()){const r=t.getImmediate();if((0,te.vZ)(e,t.getOptions()))return r;throw sd.create("already-initialized")}return t.initialize({options:e})}(n)}function M8(){return gR.apply(this,arguments)}function gR(){return(gR=(0,V.Z)(function*(){if((0,te.ru)()||!(0,te.zI)()||!(0,te.hl)())return!1;try{return yield(0,te.eu)()}catch{return!1}})).apply(this,arguments)}function D8(n,e,t){n=(0,te.m9)(n),function y8(n,e,t,i){return cR.apply(this,arguments)}(h_,d_[n.app.options.appId],e,t).catch(i=>hl.error(i))}function YB(n,e,t,i){n=(0,te.m9)(n),function g8(n,e,t,i,r){return aR.apply(this,arguments)}(h_,d_[n.app.options.appId],e,t,i).catch(r=>hl.error(r))}const KB="@firebase/analytics";!function A8(){(0,Q._registerComponent)(new ie.wA(lM,(e,{options:t})=>T8(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),(0,Q._registerComponent)(new ie.wA("analytics-internal",function n(e){try{const t=e.getProvider(lM).getImmediate();return{logEvent:(i,r,s)=>YB(t,i,r,s)}}catch(t){throw sd.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),(0,Q.registerVersion)(KB,"0.9.5"),(0,Q.registerVersion)(KB,"0.9.5","esm2017")}();class P8 extends qe.w0{constructor(e,t){super()}schedule(e,t=0){return this}}const uM={setInterval(n,e,...t){const{delegate:i}=uM;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=uM;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var O8=De(8737);class dM extends P8{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return uM.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&uM.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,O8.P)(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const _R={now:()=>(_R.delegate||Date).now(),delegate:void 0};class LE{constructor(e,t=LE.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}LE.now=_R.now;class hM extends LE{constructor(e,t=LE.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const F8=new class R8 extends hM{}(class k8 extends dM{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!=i&&i>0||null==i&&this.delay>0?super.requestAsyncId(e,t,i):(e.flush(this),0)}}),NE=new hM(dM),L8=NE;var zE=De(9468),l1=De(5363);const hv=new u.GfV("7.5.0"),yR="__angularfire_symbol__analyticsIsSupportedValue",vR="__angularfire_symbol__analyticsIsSupported",bR="__angularfire_symbol__remoteConfigIsSupportedValue",xR="__angularfire_symbol__remoteConfigIsSupported",wR="__angularfire_symbol__messagingIsSupportedValue",CR="__angularfire_symbol__messagingIsSupported";globalThis[vR]||(globalThis[vR]=M8().then(n=>globalThis[yR]=n).catch(()=>globalThis[yR]=!1)),globalThis[CR]||(globalThis[CR]=BB().then(n=>globalThis[wR]=n).catch(()=>globalThis[wR]=!1)),globalThis[xR]||(globalThis[xR]=cq().then(n=>globalThis[bR]=n).catch(()=>globalThis[bR]=!1));const fM={async:()=>globalThis[vR],sync:()=>{const n=globalThis[yR];if(void 0===n)throw new Error((n=>`The APP_INITIALIZER that is "making" isSupported() sync for the sake of convenient DI has not resolved in this\ncontext. Rather than injecting ${n} in the constructor, first ensure that ${n} is supported by calling\n\`await isSupported()\`, then retrieve the instance from the injector manually \`injector.get(${n})\`.`)("Analytics"));return n}};function BE(n,e,t){if(e){if(1===e.length)return e[0];const s=e.filter(f=>f.app===t);if(1===s.length)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}const VE=(n,e)=>{const t=e?[e]:(0,Q.getApps)(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(f=>{i.includes(f)||i.push(f)})}),i};function c1(){}class QB{constructor(e,t=F8){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){const r=this.zone;return this.delegate.schedule(function(f){r.runGuarded(()=>{e.apply(this,[f])})},t,i)}}class N8{constructor(e){this.zone=e,this.task=null}call(e,t){const i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",c1,{},c1,c1)),t.pipe(vi({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Tb=(()=>{class n{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new QB(Zone.current)),this.insideAngular=t.run(()=>new QB(Zone.current,NE)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(u.R0b))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ib(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function Sb(n){return Ib().ngZone.run(()=>n())}function Qd(n){return Ib(),function B8(n){return function(t){return(t=t.lift(new N8(n.ngZone))).pipe((0,zE.R)(n.outsideAngular),(0,l1.Q)(n.insideAngular))}}(Ib())(n)}const V8=(n,e)=>function(){const i=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),Sb(()=>n.apply(void 0,i))},f_=(n,e)=>function(){let t;const i=arguments;for(let s=0;s<arguments.length;s++)"function"==typeof i[s]&&(e&&(t||(t=Sb(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",c1,{},c1,c1)))),i[s]=V8(i[s],t));const r=function z8(n){return Ib().ngZone.runOutsideAngular(()=>n())}(()=>n.apply(this,i));if(!e){if(r instanceof L.y){const s=Ib();return r.pipe((0,zE.R)(s.outsideAngular),(0,l1.Q)(s.insideAngular))}return Sb(()=>r)}return r instanceof L.y?r.pipe(Qd):r instanceof Promise?Sb(()=>new Promise((s,f)=>r.then(b=>Sb(()=>s(b)),b=>Sb(()=>f(b))))):"function"==typeof r&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),r.apply(this,arguments)}:Sb(()=>r)};class fv{constructor(e){return e}}class UE{constructor(){return(0,Q.getApps)()}}const TR=new u.OlP("angularfire2._apps"),j8={provide:fv,useFactory:function U8(n){return n&&1===n.length?n[0]:new fv((0,Q.getApp)())},deps:[[new u.FiY,TR]]},$8={provide:UE,deps:[[new u.FiY,TR]]};function G8(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new fv(i)}}let H8=(()=>{class n{constructor(t){(0,Q.registerVersion)("angularfire",hv.full,"core"),(0,Q.registerVersion)("angularfire",hv.full,"app"),(0,Q.registerVersion)("angular",u.q4F.full,t.toString())}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(u.Lbi))},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[j8,$8]}),n})();function q8(n,...e){return{ngModule:H8,providers:[{provide:TR,useFactory:G8(n),multi:!0,deps:[u.R0b,u.zs3,Tb,...e]}]}}const Z8=f_(Q.initializeApp,!0),IR=new Map,JB={activated:!1,tokenObservers:[]},W8={initialized:!1,enabled:!1};function Zl(n){return IR.get(n)||Object.assign({},JB)}function pM(){return W8}const SR="https://content-firebaseappcheck.googleapis.com/v1",Q8="exchangeDebugToken",e3={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class eZ{constructor(e,t,i,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,V.Z)(function*(){t.stop();try{t.pending=new te.BH,yield function tZ(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new te.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(i){t.retryPolicy(i)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const hu=new te.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function AR(){return AR=(0,V.Z)(function*({url:n,body:e},t){const i={"Content-Type":"application/json"},r=t.getImmediate({optional:!0});if(r){const K=yield r.getHeartbeatsHeader();K&&(i["X-Firebase-Client"]=K)}const s={method:"POST",body:JSON.stringify(e),headers:i};let f,b;try{f=yield fetch(n,s)}catch(K){throw hu.create("fetch-network-error",{originalErrorMessage:K?.message})}if(200!==f.status)throw hu.create("fetch-status-error",{httpStatus:f.status});try{b=yield f.json()}catch(K){throw hu.create("fetch-parse-error",{originalErrorMessage:K?.message})}const I=b.ttl.match(/^([\d.]+)(s)$/);if(!I||!I[2]||isNaN(Number(I[1])))throw hu.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${b.ttl}`});const O=1e3*Number(I[1]),B=Date.now();return{token:b.token,expireTimeMillis:B+O,issuedAtTimeMillis:B}}),AR.apply(this,arguments)}const sZ="firebase-app-check-database",aZ=1,jE="firebase-app-check-store";let _M=null;function PR(){return PR=(0,V.Z)(function*(n,e){const i=(yield function i3(){return _M||(_M=new Promise((n,e)=>{try{const t=indexedDB.open(sZ,aZ);t.onsuccess=i=>{n(i.target.result)},t.onerror=i=>{var r;e(hu.create("storage-open",{originalErrorMessage:null===(r=i.target.error)||void 0===r?void 0:r.message}))},t.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(jE,{keyPath:"compositeKey"})}}catch(t){e(hu.create("storage-open",{originalErrorMessage:t?.message}))}}),_M)}()).transaction(jE,"readwrite"),s=i.objectStore(jE).put({compositeKey:n,value:e});return new Promise((f,b)=>{s.onsuccess=I=>{f()},i.onerror=I=>{var O;b(hu.create("storage-set",{originalErrorMessage:null===(O=I.target.error)||void 0===O?void 0:O.message}))}})}),PR.apply(this,arguments)}const $E=new se.Yd("@firebase/app-check");function RR(n,e){return(0,te.hl)()?function cZ(n,e){return function r3(n,e){return PR.apply(this,arguments)}(function s3(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{$E.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function LR(){return LR=(0,V.Z)(function*(){const n=pM();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),LR.apply(this,arguments)}const mZ={error:"UNKNOWN_ERROR"};function gZ(n){return te.US.encodeString(JSON.stringify(n),!1)}function yM(n){return NR.apply(this,arguments)}function NR(){return NR=(0,V.Z)(function*(n,e=!1){const t=n.app;!function t3(n){if(!Zl(n).activated)throw hu.create("use-before-activation",{appName:n.name})}(t);const i=Zl(t);let s,r=i.token;if(r&&!u1(r)&&(i.token=void 0,r=void 0),!r){const I=yield i.cachedTokenPromise;I&&(u1(I)?r=I:yield RR(t,void 0))}if(!e&&r&&u1(r))return{token:r.token};let b,f=!1;if(function a3(){return pM().enabled}()){i.exchangeTokenPromise||(i.exchangeTokenPromise=function DR(n,e){return AR.apply(this,arguments)}(function oZ(n,e){const{projectId:t,appId:i,apiKey:r}=n.options;return{url:`${SR}/projects/${t}/apps/${i}:${Q8}?key=${r}`,body:{debug_token:e}}}(t,yield function l3(){return LR.apply(this,arguments)}()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),f=!0);const I=yield i.exchangeTokenPromise;return yield RR(t,I),i.token=I,{token:I.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),f=!0),r=yield Zl(t).exchangeTokenPromise}catch(I){"appCheck/throttled"===I.code?$E.warn(I.message):$E.error(I),s=I}return r?s?b=u1(r)?{token:r.token,internalError:s}:d3(s):(b={token:r.token},i.token=r,yield RR(t,r)):b=d3(s),f&&function u3(n,e){const t=Zl(n).tokenObservers;for(const i of t)try{"EXTERNAL"===i.type&&null!=e.error?i.error(e.error):i.next(e)}catch{}}(t,b),b}),NR.apply(this,arguments)}function BR(n,e){const t=Zl(n),i=t.tokenObservers.filter(r=>r.next!==e);0===i.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=i}function c3(n){const{app:e}=n,t=Zl(e);let i=t.tokenRefresher;i||(i=function _Z(n){const{app:e}=n;return new eZ((0,V.Z)(function*(){let i;if(i=Zl(e).token?yield yM(n,!0):yield yM(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{const t=Zl(e);if(t.token){let i=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return i=Math.min(i,t.token.expireTimeMillis-3e5),Math.max(0,i-Date.now())}return 0},e3.RETRIAL_MIN_WAIT,e3.RETRIAL_MAX_WAIT)}(n),t.tokenRefresher=i),!i.isRunning()&&t.isTokenAutoRefreshEnabled&&i.start()}function u1(n){return n.expireTimeMillis-Date.now()>0}function d3(n){return{token:gZ(mZ),error:n}}class yZ{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Zl(this.app);for(const t of e)BR(this.app,t.next);return Promise.resolve()}}const v3="app-check-internal";!function OZ(){(0,Q._registerComponent)(new ie.wA("app-check",n=>function vZ(n,e){return new yZ(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(v3).initialize()})),(0,Q._registerComponent)(new ie.wA(v3,n=>function bZ(n){return{getToken:e=>yM(n,e),addTokenListener:e=>function zR(n,e,t,i){const{app:r}=n,s=Zl(r);if(s.tokenObservers=[...s.tokenObservers,{next:t,error:i,type:e}],s.token&&u1(s.token)){const b=s.token;Promise.resolve().then(()=>{t({token:b.token}),c3(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>c3(n))}(n,"INTERNAL",e),removeTokenListener:e=>BR(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,Q.registerVersion)("@firebase/app-check","0.6.4")}();class d1{constructor(){return VE("app-check")}}typeof window<"u"&&window;var x3=De(3432);function NZ(n){return new L.y(function(e){return{unsubscribe:(0,x3.w)(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e))}})}class bM{constructor(e){return e}}class GR{constructor(){return VE("auth")}}const HR=new u.OlP("angularfire2.auth-instances");function VZ(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new bM(i)}}const UZ={provide:GR,deps:[[new u.FiY,HR]]},jZ={provide:bM,useFactory:function BZ(n,e){const t=BE("auth",n,e);return t&&new bM(t)},deps:[[new u.FiY,HR],fv]};let $Z=(()=>{class n{constructor(){(0,Q.registerVersion)("angularfire",hv.full,"auth")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[jZ,UZ]}),n})();function GZ(n,...e){return{ngModule:$Z,providers:[{provide:HR,useFactory:VZ(n),multi:!0,deps:[u.R0b,u.zs3,Tb,UE,[new u.FiY,d1],...e]}]}}const HZ=f_(NZ,!0),qZ=f_(x3.o,!0);class GE{constructor(e){return e}}const C3="firestore",qR=new u.OlP("angularfire2.firestore-instances");function YZ(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new GE(i)}}const KZ={provide:class ZZ{constructor(){return VE(C3)}},deps:[[new u.FiY,qR]]},XZ={provide:GE,useFactory:function WZ(n,e){const t=BE(C3,n,e);return t&&new GE(t)},deps:[[new u.FiY,qR],fv]};let QZ=(()=>{class n{constructor(){(0,Q.registerVersion)("angularfire",hv.full,"fst")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[XZ,KZ]}),n})();function JZ(n,...e){return{ngModule:QZ,providers:[{provide:qR,useFactory:YZ(n),multi:!0,deps:[u.R0b,u.zs3,Tb,UE,[new u.FiY,GR],[new u.FiY,d1],...e]}]}}const eW=f_(eB,!0),tW=f_(X$,!0);function xM(){return(0,Xe.e)((n,e)=>{let t,i=!1;n.subscribe((0,be.x)(e,r=>{const s=t;t=r,i&&e.next([s,r]),i=!0}))})}function wM(n,e=_e.y){return n=n??nW,(0,Xe.e)((t,i)=>{let r,s=!0;t.subscribe((0,be.x)(i,f=>{const b=e(f);(s||!n(r,b))&&(s=!1,r=b,i.next(f))}))})}function nW(n,e){return n===e}var Ep=De(2011),iW=(De(9568),De(3942));function ZR(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Wt("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function E3(){if(typeof Uint8Array>"u")throw new Wt("unimplemented","Uint8Arrays are not available in this environment.")}function T3(){if(!function PA(){return typeof atob<"u"}())throw new Wt("unimplemented","Blobs are unavailable in Firestore in this environment.")}class HE{constructor(e){this._delegate=e}static fromBase64String(e){return T3(),new HE($m.fromBase64String(e))}static fromUint8Array(e){return E3(),new HE($m.fromUint8Array(e))}toBase64(){return T3(),this._delegate.toBase64()}toUint8Array(){return E3(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function WR(n){return function sW(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const i of e)if(i in t&&"function"==typeof t[i])return!0;return!1}(n,["next","error","complete"])}class aW{enableIndexedDbPersistence(e,t){return function Q$(n,e){Lz(n=Or(n,ms));const t=oa(n);if(t._uninitializedComponentsProvider)throw new Wt(Ct.FAILED_PRECONDITION,"SDK cache is already specified.");td("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const i=n._freezeSettings(),r=new Jw;return Fz(t,r,new xO(r,i.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function J$(n){Lz(n=Or(n,ms));const e=oa(n);if(e._uninitializedComponentsProvider)throw new Wt(Ct.FAILED_PRECONDITION,"SDK cache is already specified.");td("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),i=new Jw;return Fz(e,i,new vz(i,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function eG(n){if(n._initialized&&!n._terminated)throw new Wt(Ct.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new na;return n._queue.enqueueAndForgetEvenWhileRestricted((0,V.Z)(function*(){try{yield(t=(0,V.Z)(function*(i){if(!nd.D())return Promise.resolve();const r=i+"main";yield nd.delete(r)}),function(i){return t.apply(this,arguments)})(fP(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class I3{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof zm||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&td("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,i={}){Oz(this._delegate,e,t,i)}enableNetwork(){return function nG(n){return function B$(n){return n.asyncQueue.enqueue((0,V.Z)(function*(){const e=yield wz(n),t=yield MO(n);return e.setNetworkEnabled(!0),function(i){const r=Rn(i);return r.du.delete(0),TE(r)}(t)}))}(oa(n=Or(n,ms)))}(this._delegate)}disableNetwork(){return function iG(n){return function V$(n){return n.asyncQueue.enqueue((0,V.Z)(function*(){const e=yield wz(n),t=yield MO(n);return e.setNetworkEnabled(!1),(i=(0,V.Z)(function*(r){const s=Rn(r);s.du.add(0),yield qw(s),s.mu.set("Offline")}),function(r){return i.apply(this,arguments)})(t);var i}))}(oa(n=Or(n,ms)))}(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,Sz("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function tG(n){return function(e){const t=new na;return e.asyncQueue.enqueueAndForget((0,V.Z)(function*(){return function C$(n,e){return oO.apply(this,arguments)}(yield DO(e),t)})),t.promise}(oa(n=Or(n,ms)))}(this._delegate)}onSnapshotsInSync(e){return function kG(n,e){return function $$(n,e){const t=new $S(e);return n.asyncQueue.enqueueAndForget((0,V.Z)(function*(){return i=yield e1(n),r=t,Rn(i).Au.add(r),void r.next();var i,r})),()=>{t.yc(),n.asyncQueue.enqueueAndForget((0,V.Z)(function*(){return i=yield e1(n),r=t,void Rn(i).Au.delete(r);var i,r}))}}(oa(n=Or(n,ms)),RO(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Wt("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new h1(this,OO(this._delegate,e))}catch(t){throw fu(t,"collection()","Firestore.collection()")}}doc(e){try{return new df(this,WS(this._delegate,e))}catch(t){throw fu(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new pu(this,function Z$(n,e){if(n=Or(n,SE),PO("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Wt(Ct.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Hl(n,null,(t=e,new Xd(Pr.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw fu(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function jG(n,e,t){n=Or(n,ms);const i=Object.assign(Object.assign({},VG),t);return function(r){if(r.maxAttempts<1)throw new Wt(Ct.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(r,s,f){const b=new na;return r.asyncQueue.enqueueAndForget((0,V.Z)(function*(){const I=yield function Cz(n){return HS(n).then(e=>e.datastore)}(r);new N$(r.asyncQueue,I,f,s,b).run()})),b.promise}(oa(n),r=>e(new UG(n,r)),i)}(this._delegate,t=>e(new S3(this,t)))}batch(){return oa(this._delegate),new M3(new nB(this._delegate,e=>n1(this._delegate,e)))}loadBundle(e){return function rG(n,e){const t=oa(n=Or(n,ms)),i=new Y$;return function G$(n,e,t,i){const r=function(s,f){let b;return b="string"==typeof s?(new TextEncoder).encode(s):s,I=function(I,O){if(I instanceof Uint8Array)return bz(I,O);if(I instanceof ArrayBuffer)return bz(new Uint8Array(I),O);if(I instanceof ReadableStream)return I.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(b),new F$(I,f);var I}(t,EE(e));n.asyncQueue.enqueueAndForget((0,V.Z)(function*(){!function R$(n,e,t){const i=Rn(n);var r;(r=(0,V.Z)(function*(s,f,b){try{const I=yield f.getMetadata();if(yield function(le,ge){const Te=Rn(le),Ge=ra(ge.createTime);return Te.persistence.runTransaction("hasNewerBundle","readonly",Je=>Te.xs.getBundleMetadata(Je,ge.id)).then(Je=>!!Je&&Je.createTime.compareTo(Ge)>=0)}(s.localStore,I))return yield f.close(),b._completeWith({taskState:"Success",documentsLoaded:(le=I).totalDocuments,bytesLoaded:le.totalBytes,totalDocuments:le.totalDocuments,totalBytes:le.totalBytes}),Promise.resolve(new Set);b._updateProgress(uz(I));const O=new f$(I,s.localStore,f.serializer);let B=yield f._c();for(;B;){const le=yield O.$u(B);le&&b._updateProgress(le),B=yield f._c()}const K=yield O.complete();return yield s_(s,K.Bu,void 0),yield function(le,ge){const Te=Rn(le);return Te.persistence.runTransaction("Save bundle","readwrite",Ge=>Te.xs.saveBundleMetadata(Ge,ge))}(s.localStore,I),b._completeWith(K.progress),Promise.resolve(K.Fu)}catch(I){return td("SyncEngine",`Loading bundle failed with ${I}`),b._failWith(I),Promise.resolve(new Set)}var le}),function(s,f,b){return r.apply(this,arguments)})(i,e,t).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}(yield DO(n),r,i)}))}(t,n._databaseId,e,i),i}(this._delegate,e)}namedQuery(e){return function oG(n,e){return function H$(n,e){return n.asyncQueue.enqueue((0,V.Z)(function*(){return function(t,i){const r=Rn(t);return r.persistence.runTransaction("Get named query","readonly",s=>r.xs.getNamedQuery(s,i))}(yield qS(n),e)}))}(oa(n=Or(n,ms)),e).then(t=>t?new Hl(n,null,t.query):null)}(this._delegate,e).then(t=>t?new pu(this,t):null)}}class CM extends UO{constructor(e){super(),this.firestore=e}convertBytes(e){return new HE(new $m(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return df.forKey(t,this.firestore,null)}}class S3{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new CM(e)}get(e){const t=Db(e);return this._delegate.get(t).then(i=>new qE(this._firestore,new l_(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const r=Db(e);return i?(ZR("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=Db(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=Db(e);return this._delegate.delete(t),this}}class M3{constructor(e){this._delegate=e}set(e,t,i){const r=Db(e);return i?(ZR("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=Db(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=Db(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Mb{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new RE(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ZE(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=Mb.INSTANCES;let r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(t);return s||(s=new Mb(e,new CM(e),t),r.set(t,s)),s}}Mb.INSTANCES=new WeakMap;class df{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new CM(e)}static forPath(e,t,i){if(e.length%2!=0)throw new Wt("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new df(t,new ps(t._delegate,i,new Pn(e)))}static forKey(e,t,i){return new df(t,new ps(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new h1(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new h1(this.firestore,OO(this._delegate,e))}catch(t){throw fu(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,te.m9)(e))instanceof ps&&kz(this._delegate,e)}set(e,t){t=ZR("DocumentReference.set",t);try{return t?Qz(this._delegate,e,t):Qz(this._delegate,e)}catch(i){throw fu(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return 1===arguments.length?Jz(this._delegate,e):Jz(this._delegate,e,t,...i)}catch(r){throw fu(r,"updateDoc()","DocumentReference.update()")}}delete(){return function OG(n){return n1(Or(n.firestore,ms),[new cb(n._key,he.none())])}(this._delegate)}onSnapshot(...e){const t=D3(e),i=A3(e,r=>new qE(this.firestore,new l_(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return tB(this._delegate,t,i)}get(e){let t;return t="cache"===e?.source?function SG(n){n=Or(n,ps);const e=Or(n.firestore,ms),t=oa(e),i=new uv(e);return function U$(n,e){const t=new na;return n.asyncQueue.enqueueAndForget((0,V.Z)(function*(){return(i=(0,V.Z)(function*(r,s,f){try{const b=yield function(I,O){const B=Rn(I);return B.persistence.runTransaction("read document","readonly",K=>B.localDocuments.getDocument(K,O))}(r,s);b.isFoundDocument()?f.resolve(b):b.isNoDocument()?f.resolve(null):f.reject(new Wt(Ct.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(b){const I=Yw(b,`Failed to get document '${s} from cache`);f.reject(I)}}),function(r,s,f){return i.apply(this,arguments)})(yield qS(n),e,t);var i})),t.promise}(t,n._key).then(r=>new l_(e,i,n._key,r,new bb(null!==r&&r.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function MG(n){n=Or(n,ps);const e=Or(n.firestore,ms);return Ez(oa(e),n._key,{source:"server"}).then(t=>jO(e,n,t))}(this._delegate):function IG(n){n=Or(n,ps);const e=Or(n.firestore,ms);return Ez(oa(e),n._key).then(t=>jO(e,n,t))}(this._delegate),t.then(i=>new qE(this.firestore,new l_(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new df(this.firestore,this._delegate.withConverter(e?Mb.getInstance(this.firestore,e):null))}}function fu(n,e,t){return n.message=n.message.replace(e,t),n}function D3(n){for(const e of n)if("object"==typeof e&&!WR(e))return e;return{}}function A3(n,e){var t,i;let r;return r=WR(n[0])?n[0]:WR(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(e(s))},error:null===(t=r.error)||void 0===t?void 0:t.bind(r),complete:null===(i=r.complete)||void 0===i?void 0:i.bind(r)}}class qE{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new df(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Xz(this._delegate,e._delegate)}}class ZE extends qE{data(e){const t=this._delegate.data(e);return function zI(n,e){n||Hn()}(void 0!==t),t}}class pu{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new CM(e)}where(e,t,i){try{return new pu(this.firestore,lv(this._delegate,function mG(n,e,t){const i=e,r=eM("where",n);return kE._create(r,i,t)}(e,t,i)))}catch(r){throw fu(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new pu(this.firestore,lv(this._delegate,function gG(n,e="asc"){const t=e,i=eM("orderBy",n);return VO._create(i,t)}(e,t)))}catch(i){throw fu(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new pu(this.firestore,lv(this._delegate,function _G(n){return Az("limit",n),tM._create("limit",n,"F")}(e)))}catch(t){throw fu(t,"limit()","Query.limit()")}}limitToLast(e){try{return new pu(this.firestore,lv(this._delegate,function yG(n){return Az("limitToLast",n),tM._create("limitToLast",n,"L")}(e)))}catch(t){throw fu(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new pu(this.firestore,lv(this._delegate,function vG(...n){return nM._create("startAt",n,!0)}(...e)))}catch(t){throw fu(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new pu(this.firestore,lv(this._delegate,function bG(...n){return nM._create("startAfter",n,!1)}(...e)))}catch(t){throw fu(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new pu(this.firestore,lv(this._delegate,function xG(...n){return iM._create("endBefore",n,!1)}(...e)))}catch(t){throw fu(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new pu(this.firestore,lv(this._delegate,function wG(...n){return iM._create("endAt",n,!0)}(...e)))}catch(t){throw fu(t,"endAt()","Query.endAt()")}}isEqual(e){return kO(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function AG(n){n=Or(n,Hl);const e=Or(n.firestore,ms),t=oa(e),i=new uv(e);return function j$(n,e){const t=new na;return n.asyncQueue.enqueueAndForget((0,V.Z)(function*(){return(i=(0,V.Z)(function*(r,s,f){try{const b=yield FS(r,s,!0),I=new fz(s,b.Wi),O=I.zu(b.documents),B=I.applyChanges(O,!1);f.resolve(B.snapshot)}catch(b){const I=Yw(b,`Failed to execute query '${s} against cache`);f.reject(I)}}),function(r,s,f){return i.apply(this,arguments)})(yield qS(n),e,t);var i})),t.promise}(t,n._query).then(r=>new cv(e,i,n,r))}(this._delegate):"server"===e?.source?function PG(n){n=Or(n,Hl);const e=Or(n.firestore,ms),t=oa(e),i=new uv(e);return Tz(t,n._query,{source:"server"}).then(r=>new cv(e,i,n,r))}(this._delegate):function DG(n){n=Or(n,Hl);const e=Or(n.firestore,ms),t=oa(e),i=new uv(e);return Gz(n._query),Tz(t,n._query).then(r=>new cv(e,i,n,r))}(this._delegate),t.then(i=>new YR(this.firestore,new cv(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=D3(e),i=A3(e,r=>new YR(this.firestore,new cv(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return tB(this._delegate,t,i)}withConverter(e){return new pu(this.firestore,this._delegate.withConverter(e?Mb.getInstance(this.firestore,e):null))}}class cW{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new ZE(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class YR{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new pu(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ZE(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new cW(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new ZE(this._firestore,i))})}isEqual(e){return Xz(this._delegate,e._delegate)}}class h1 extends pu{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new df(this.firestore,e):null}doc(e){try{return new df(this.firestore,void 0===e?WS(this._delegate):WS(this._delegate,e))}catch(t){throw fu(t,"doc()","CollectionReference.doc()")}}add(e){return eB(this._delegate,e).then(t=>new df(this.firestore,t))}isEqual(e){return kz(this._delegate,e._delegate)}withConverter(e){return new h1(this.firestore,this._delegate.withConverter(e?Mb.getInstance(this.firestore,e):null))}}function Db(n){return Or(n,ps)}class KR{constructor(...e){this._delegate=new a_(...e)}static documentId(){return new KR(fs.keyField().canonicalString())}isEqual(e){return(e=(0,te.m9)(e))instanceof a_&&this._delegate._internalPath.isEqual(e._internalPath)}}class Ab{constructor(e){this._delegate=e}static serverTimestamp(){const e=function GG(){return new FO("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Ab(e)}static delete(){const e=function $G(){return new DE("deleteField")}();return e._methodName="FieldValue.delete",new Ab(e)}static arrayUnion(...e){const t=function HG(...n){return new uG("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Ab(t)}static arrayRemove(...e){const t=function qG(...n){return new dG("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Ab(t)}static increment(e){const t=function ZG(n){return new hG("increment",n)}(e);return t._methodName="FieldValue.increment",new Ab(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const uW={Firestore:I3,GeoPoint:YS,Timestamp:Vo,Blob:HE,Transaction:S3,WriteBatch:M3,DocumentReference:df,DocumentSnapshot:qE,Query:pu,QueryDocumentSnapshot:ZE,QuerySnapshot:YR,CollectionReference:h1,FieldPath:KR,FieldValue:Ab,setLogLevel:function lW(n){!function gA(n){Rm.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function hW(n){(function dW(n,e){n.INTERNAL.registerComponent(new ie.wA("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},uW)))})(n,(e,t)=>new I3(e,t,new aW)),n.registerVersion("@firebase/firestore-compat","0.3.6")}(iW.Z);var p_=De(6451);class fW extends g.x{constructor(e=1/0,t=1/0,i=_R){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:f}=this;t||(i.push(e),!r&&i.push(s.now()+f)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,s=r.slice();for(let f=0;f<s.length&&!e.closed;f+=i?1:2)e.next(s[f]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<i.length&&i.splice(0,i.length-s),!r){const f=t.now();let b=0;for(let I=1;I<i.length&&i[I]<=f;I+=2)b=I;b&&i.splice(0,b+1)}}}var P3=De(3099);function O3(n,e,t){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=n):i=n??1/0,(0,P3.B)({connector:()=>new fW(i,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}function k3(n,e){return(0,at.m)(e)?dn(()=>n,e):dn(()=>n)}De(9260);const R3=new u.OlP("angularfire2.auth.use-emulator"),F3=new u.OlP("angularfire2.auth.settings"),L3=new u.OlP("angularfire2.auth.tenant-id"),N3=new u.OlP("angularfire2.auth.langugage-code"),z3=new u.OlP("angularfire2.auth.use-device-language"),B3=new u.OlP("angularfire.auth.persistence"),V3=(n,e,t,i,r,s,f,b)=>(0,Ep.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const I=e.runOutsideAngular(()=>n.auth());if(t&&I.useEmulator(...t),i&&(I.tenantId=i),I.languageCode=r,s&&I.useDeviceLanguage(),f)for(const[O,B]of Object.entries(f))I.settings[O]=B;return b&&I.setPersistence(b),I},[t,i,r,s,f,b]);let XR=(()=>{class n{constructor(t,i,r,s,f,b,I,O,B,K,le,ge){const Te=new g.x,Ge=c(void 0).pipe((0,l1.Q)(f.outsideAngular),dn(()=>s.runOutsideAngular(()=>Promise.resolve().then(De.bind(De,9568)))),(0,de.U)(()=>(0,Ep.on)(t,s,i)),(0,de.U)(Je=>V3(Je,s,b,O,B,K,I,le)),O3({bufferSize:1,refCount:!1}));if(bf(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=c(null);else{Ge.pipe(Ri()).subscribe();const Qt=Ge.pipe(dn(li=>li.getRedirectResult().then(Gi=>Gi,()=>null)),Qd,O3({bufferSize:1,refCount:!1})),xn=Ge.pipe(dn(li=>new L.y(Gi=>({unsubscribe:s.runOutsideAngular(()=>li.onAuthStateChanged(Ki=>Gi.next(Ki),Ki=>Gi.error(Ki),()=>Gi.complete()))})))),zn=Ge.pipe(dn(li=>new L.y(Gi=>({unsubscribe:s.runOutsideAngular(()=>li.onIdTokenChanged(Ki=>Gi.next(Ki),Ki=>Gi.error(Ki),()=>Gi.complete()))}))));this.authState=Qt.pipe(k3(xn),(0,zE.R)(f.outsideAngular),(0,l1.Q)(f.insideAngular)),this.user=Qt.pipe(k3(zn),(0,zE.R)(f.outsideAngular),(0,l1.Q)(f.insideAngular)),this.idToken=this.user.pipe(dn(li=>li?(0,Mi.D)(li.getIdToken()):c(null))),this.idTokenResult=this.user.pipe(dn(li=>li?(0,Mi.D)(li.getIdTokenResult()):c(null))),this.credential=(0,p_.T)(Qt,Te,this.authState.pipe(Yt(li=>!li))).pipe((0,de.U)(li=>li?.user?li:null),(0,zE.R)(f.outsideAngular),(0,l1.Q)(f.insideAngular))}return(0,Ep.pX)(this,Ge,s,{spy:{apply:(Je,Qt,xn)=>{(Je.startsWith("signIn")||Je.startsWith("createUser"))&&xn.then(zn=>Te.next(zn))}}})}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Ep.Dh),u.LFG(Ep.xv,8),u.LFG(u.Lbi),u.LFG(u.R0b),u.LFG(Tb),u.LFG(R3,8),u.LFG(F3,8),u.LFG(L3,8),u.LFG(N3,8),u.LFG(z3,8),u.LFG(B3,8),u.LFG(d1,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})();function U3(n,e){return function mW(n,e=NE){return new L.y(t=>{let i;return null!=e?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{i?.()}})}(n,e)}function QR(n,e){return U3(n,e).pipe((0,de.U)(t=>({payload:t,type:"query"})))}function EM(n,e){return QR(n,e).pipe(_n(void 0),xM(),(0,de.U)(([t,i])=>{const r=i.payload.docChanges(),s=r.map(f=>({type:f.type,payload:f}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((f,b)=>{const I=r.find(B=>B.doc.ref.isEqual(f.ref)),O=t?.payload.docs.find(B=>B.ref.isEqual(f.ref));I&&JSON.stringify(I.doc.metadata)===JSON.stringify(f.metadata)||!I&&O&&JSON.stringify(O.metadata)===JSON.stringify(f.metadata)||s.push({type:"modified",payload:{oldIndex:b,newIndex:b,type:"modified",doc:f}})}),s}))}function j3(n,e,t){return EM(n,t).pipe($s((i,r)=>function _W(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=function yW(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return JR(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return JR(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return JR(n,e.oldIndex,1)}return n}(n,i))}),n}(i,r.map(s=>s.payload),e),[]),wM(),(0,de.U)(i=>i.map(r=>({type:r.type,payload:r}))))}function JR(n,e,t,...i){const r=n.slice();return r.splice(e,t,...i),r}function $3(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class G3{constructor(e,t,i){this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=EM(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,de.U)(i=>i.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(_n(void 0),xM(),Yt(([i,r])=>r.length>0||!i),(0,de.U)(([i,r])=>r),Qd)}auditTrail(e){return this.stateChanges(e).pipe($s((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=$3(e);return j3(this.query,t,this.afs.schedulers.outsideAngular).pipe(Qd)}valueChanges(e={}){return QR(this.query,this.afs.schedulers.outsideAngular).pipe((0,de.U)(t=>t.payload.docs.map(i=>e.idField?Object.assign(Object.assign({},i.data()),{[e.idField]:i.id}):i.data())),Qd)}get(e){return(0,Mi.D)(this.query.get(e)).pipe(Qd)}add(e){return this.ref.add(e)}doc(e){return new H3(this.ref.doc(e),this.afs)}}class H3{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const i=this.ref.collection(e),{ref:r,query:s}=q3(i,t);return new G3(r,s,this.afs)}snapshotChanges(){return function gW(n,e){return U3(n,e).pipe(_n(void 0),xM(),(0,de.U)(([t,i])=>i.exists?t?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Qd)}valueChanges(e={}){return this.snapshotChanges().pipe((0,de.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,Mi.D)(this.ref.get(e)).pipe(Qd)}}class vW{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?EM(this.query,this.afs.schedulers.outsideAngular).pipe((0,de.U)(t=>t.filter(i=>e.indexOf(i.type)>-1)),Yt(t=>t.length>0),Qd):EM(this.query,this.afs.schedulers.outsideAngular).pipe(Qd)}auditTrail(e){return this.stateChanges(e).pipe($s((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=$3(e);return j3(this.query,t,this.afs.schedulers.outsideAngular).pipe(Qd)}valueChanges(e={}){return QR(this.query,this.afs.schedulers.outsideAngular).pipe((0,de.U)(i=>i.payload.docs.map(r=>e.idField?Object.assign({[e.idField]:r.id},r.data()):r.data())),Qd)}get(e){return(0,Mi.D)(this.query.get(e)).pipe(Qd)}}const bW=new u.OlP("angularfire2.enableFirestorePersistence"),xW=new u.OlP("angularfire2.firestore.persistenceSettings"),wW=new u.OlP("angularfire2.firestore.settings"),CW=new u.OlP("angularfire2.firestore.use-emulator");function q3(n,e=(t=>t)){return{query:e(n),ref:n}}let Z3=(()=>{class n{constructor(t,i,r,s,f,b,I,O,B,K,le,ge,Te,Ge,Je,Qt,xn){this.schedulers=I;const zn=(0,Ep.on)(t,b,i),li=B;K&&V3(zn,b,le,Te,Ge,Je,ge,Qt),[this.firestore,this.persistenceEnabled$]=(0,Ep.cc)(`${zn.name}.firestore`,"AngularFirestore",zn.name,()=>{const Gi=b.runOutsideAngular(()=>zn.firestore());if(s&&Gi.settings(s),li&&Gi.useEmulator(...li),r&&!bf(f)){const Ki=()=>{try{return(0,Mi.D)(Gi.enablePersistence(O||void 0).then(()=>!0,()=>!1))}catch(ao){return typeof console<"u"&&console.warn(ao),c(!1)}};return[Gi,b.runOutsideAngular(Ki)]}return[Gi,c(!1)]},[s,li,r])}collection(t,i){let r;r="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:f}=q3(r,i),b=this.schedulers.ngZone.run(()=>s);return new G3(b,f,this)}collectionGroup(t,i){const r=i||(f=>f),s=this.firestore.collectionGroup(t);return new vW(r(s),this)}doc(t){let i;i="string"==typeof t?this.firestore.doc(t):t;const r=this.schedulers.ngZone.run(()=>i);return new H3(r,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Ep.Dh),u.LFG(Ep.xv,8),u.LFG(bW,8),u.LFG(wW,8),u.LFG(u.Lbi),u.LFG(u.R0b),u.LFG(Tb),u.LFG(xW,8),u.LFG(CW,8),u.LFG(XR,8),u.LFG(R3,8),u.LFG(F3,8),u.LFG(L3,8),u.LFG(N3,8),u.LFG(z3,8),u.LFG(B3,8),u.LFG(d1,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),e2=(()=>{class n{constructor(t,i){this.db=t,this.firestore=i,this.dbName="bandeja-entrada",this.bandejaEntradaData=this.db.collection(this.dbName).valueChanges({idField:"id"})}getBandejaEntradaData(){return this.bandejaEntradaData}getEmailById(t){return this.db.collection(this.dbName).doc(t).valueChanges({idField:"id"})}addEmail(t){return eW(OO(this.firestore,this.dbName),t)}updateEmailALeido(t){return t.estado="LEIDO",this.db.collection(this.dbName).doc(t.id).update(t)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Z3),u.LFG(GE))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function EW(n,e){1&n&&(u.TgZ(0,"div",29),u._uU(1," * El nombre es obligatorio "),u.qZA())}function TW(n,e){1&n&&(u.TgZ(0,"div",29),u._uU(1," * El email es obligatorio y debe tener el formato correcto "),u.qZA())}function IW(n,e){1&n&&(u.TgZ(0,"div",29),u._uU(1," * El asunto es obligatorio "),u.qZA())}function SW(n,e){1&n&&(u.TgZ(0,"div",29),u._uU(1," * El mensaje es obligatorio "),u.qZA())}function MW(n,e){1&n&&(u.TgZ(0,"div",30),u._uU(1," \xa1Muchas gracias por contactar con nosotros! Nos pondremos en contacto contigo cuanto antes. "),u.qZA())}function DW(n,e){1&n&&(u.TgZ(0,"div",31),u._uU(1," Ha ocurrido un error al enviar el mensaje. Por favor, contacte con nosotros a trav\xe9s de "),u.TgZ(2,"b"),u._uU(3,"contacto@hasspro.es"),u.qZA(),u._uU(4,". "),u.qZA())}function AW(n,e){if(1&n&&(u.TgZ(0,"div",32)(1,"div",33),u._UZ(2,"img",34),u.qZA(),u.TgZ(3,"div",35),u._uU(4),u.qZA()()),2&n){const t=e.$implicit,i=u.oxw();u.xp6(2),u.Q6J("src",i.iconPath+t.icon,u.LSH),u.xp6(2),u.hij(" ",t.text," ")}}let PW=(()=>{class n{constructor(t,i){this.fb=t,this.messageService=i,this.correoEnviado=!1,this.errorEnviado=!1,this.enviandoCorreo=!1,this.iconPath="../../../assets/icons/",this.vDondeEncontrarnos=[{text:"Ronda del Carmen, 13. C\xe1ceres (CP: 10002)",icon:"icon-map.png"},{text:"640 90 36 70",icon:"icon-phone.png"},{text:"contacto@hasspro.es",icon:"icon-email.png"},{text:"Hasspro_es",icon:"icon-instagram.png"},{text:"Hasspro \xc1vila",icon:"icon-facebook.png"},{text:"hasspro.es",icon:"icon-website.png"}],this.center=[-6.3757,39.4684],this.zoom=16,this.container="mapa-container",this.formularioContacto=this.fb.group({nombre:["",[ar.required]],email:["",[ar.required,ar.email]],asunto:["",[ar.required]],mensaje:["",[ar.required]]})}ngOnInit(){}ngAfterViewInit(){gc.accessToken=Tg_mapboxToken;var t=new gc.Map({container:"mapa-container",style:"mapbox://styles/mapbox/streets-v11",center:this.center,zoom:this.zoom,scrollZoom:!1});t.scrollZoom.disable(),t.boxZoom.disable(),t.dragRotate.disable(),t.dragPan.disable(),t.keyboard.disable(),t.doubleClickZoom.disable(),t.touchZoomRotate.disable(),(new gc.Marker).setLngLat(this.center).addTo(t)}onSubmit(){if(this.formularioContacto.invalid)return void this.formularioContacto.markAllAsTouched();this.correoEnviado=!0;const t={fecha:Vo.fromDate(new Date),estado:"NO_LEIDO",...this.formularioContacto.value};this.enviandoCorreo=!0,this.messageService.addEmail(t).then(i=>{this.correoEnviado=!0,this.enviandoCorreo=!1,this.formularioContacto.reset()},i=>{console.log("Error al enviar el mensaje:",i),this.errorEnviado=!0,this.enviandoCorreo=!1})}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(E),u.Y36(e2))},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-contact"]],decls:84,vars:10,consts:[[1,"contacto-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"contactanos-container"],[1,"title"],[1,"parrafo"],[1,"formulario-container"],[3,"formGroup","submit"],[1,"input-group"],["for","nombre"],["type","text","id","nombre","formControlName","nombre"],["class","input-error",4,"ngIf"],["type","email","id","email","formControlName","email"],["type","text","id","asunto","formControlName","asunto"],["id","mensaje","formControlName","mensaje"],[1,"submit-container"],["type","submit",3,"disabled"],["class","correo-enviado",4,"ngIf"],["class","correo-enviado-error",4,"ngIf"],[1,"direccion-container"],[1,"nos-conocemos-container","animate__animated","animate__fadeIn","animate__delay-1s"],[1,"subtitle"],[1,"contact-list"],["class","item-contacto",4,"ngFor","ngForOf"],[1,"map-container"],["id","mapa-container"],[1,"input-error"],[1,"correo-enviado"],[1,"correo-enviado-error"],[1,"item-contacto"],[1,"icon"],[3,"src"],[1,"text"]],template:function(t,i){if(1&t&&(u.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),u._UZ(4,"img",4),u.qZA(),u.TgZ(5,"h1",5),u._uU(6," ASISTENTE PROFESIONAL DE HOSTELER\xcdA "),u.qZA()()(),u.TgZ(7,"div",6)(8,"div",7),u._uU(9,"\xbfD\xf3nde estamos?"),u.qZA(),u.TgZ(10,"div",8),u._uU(11," Visite nuestra oficina o "),u.TgZ(12,"b"),u._uU(13,"programe una cita"),u.qZA(),u._uU(14,", nos adaptamos a su horario. "),u.qZA(),u.TgZ(15,"div",8),u._uU(16,"Servicio "),u.TgZ(17,"b"),u._uU(18,"exclusivo"),u.qZA(),u._uU(19," y "),u.TgZ(20,"b"),u._uU(21,"personalizado"),u.qZA(),u._uU(22,"."),u.qZA(),u.TgZ(23,"div",7),u._uU(24,"Hablemos"),u.qZA(),u.TgZ(25,"div",8),u._uU(26," Estamos cerca, conectados con la realidad de la hosteler\xeda. Hablemos de "),u.TgZ(27,"b"),u._uU(28,"gesti\xf3n"),u.qZA(),u._uU(29,", de "),u.TgZ(30,"b"),u._uU(31,"operaciones"),u.qZA(),u._uU(32,", de "),u.TgZ(33,"b"),u._uU(34,"las compras"),u.qZA(),u._uU(35," y "),u.TgZ(36,"b"),u._uU(37,"la sala"),u.qZA(),u._uU(38,", de "),u.TgZ(39,"b"),u._uU(40,"la cocina"),u.qZA(),u._uU(41,", "),u.TgZ(42,"b"),u._uU(43,"del equipo"),u.qZA(),u._uU(44,"... "),u.TgZ(45,"b"),u._uU(46,"\xbfHablamos?"),u.qZA()()(),u.TgZ(47,"div",9)(48,"form",10),u.NdJ("submit",function(){return i.onSubmit()}),u.TgZ(49,"div",11)(50,"label",12),u._uU(51,"Nombre"),u.qZA(),u._UZ(52,"input",13),u.YNc(53,EW,2,0,"div",14),u.qZA(),u.TgZ(54,"div",11)(55,"label",12),u._uU(56,"Email"),u.qZA(),u._UZ(57,"input",15),u.YNc(58,TW,2,0,"div",14),u.qZA(),u.TgZ(59,"div",11)(60,"label",12),u._uU(61,"Asunto"),u.qZA(),u._UZ(62,"input",16),u.YNc(63,IW,2,0,"div",14),u.qZA(),u.TgZ(64,"div",11)(65,"label",12),u._uU(66,"Mensaje"),u.qZA(),u._UZ(67,"textarea",17),u.YNc(68,SW,2,0,"div",14),u.qZA(),u.TgZ(69,"div",18)(70,"button",19),u._uU(71),u.qZA()(),u.YNc(72,MW,2,0,"div",20),u.YNc(73,DW,5,0,"div",21),u.qZA()(),u.TgZ(74,"div",22)(75,"div",23)(76,"div",7),u._uU(77,"\xbfNos conocemos?"),u.qZA(),u.TgZ(78,"div",24),u._uU(79," Queremos escucharte y compartir nuestra experiencia contigo. Puedes encontrarnos en todos estos sitios: "),u.qZA(),u.TgZ(80,"div",25),u.YNc(81,AW,5,2,"div",26),u.qZA()(),u.TgZ(82,"div",27),u._UZ(83,"div",28),u.qZA()()()),2&t){let r,s,f,b;u.xp6(48),u.Q6J("formGroup",i.formularioContacto),u.xp6(5),u.Q6J("ngIf",(null==(r=i.formularioContacto.get("nombre"))?null:r.touched)&&null!==(null==(r=i.formularioContacto.get("nombre"))?null:r.errors)),u.xp6(5),u.Q6J("ngIf",(null==(s=i.formularioContacto.get("email"))?null:s.touched)&&null!==(null==(s=i.formularioContacto.get("email"))?null:s.errors)),u.xp6(5),u.Q6J("ngIf",(null==(f=i.formularioContacto.get("asunto"))?null:f.touched)&&null!==(null==(f=i.formularioContacto.get("asunto"))?null:f.errors)),u.xp6(5),u.Q6J("ngIf",(null==(b=i.formularioContacto.get("mensaje"))?null:b.touched)&&null!==(null==(b=i.formularioContacto.get("mensaje"))?null:b.errors)),u.xp6(2),u.Q6J("disabled",i.enviandoCorreo),u.xp6(1),u.hij(" ",i.enviandoCorreo?"Enviando...":"Enviar"," "),u.xp6(1),u.Q6J("ngIf",i.correoEnviado),u.xp6(1),u.Q6J("ngIf",i.errorEnviado),u.xp6(8),u.Q6J("ngForOf",i.vDondeEncontrarnos)}},dependencies:[Qi,Ro,f0,ym,hy,Dg,ba,Gg],styles:[".contacto-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;flex-wrap:wrap;width:calc(100% - 180px);padding:30px 50px 70px;margin:70px 40px;background-color:var(--principal-color-light-80);border-radius:5px;box-shadow:2px 2px 4px var(--principal-color-light)}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:36px;margin-bottom:10px;margin-top:20px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 50px 15px;border-bottom:1px solid var(--principal-color-80)}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .parrafo[_ngcontent-%COMP%]{font-size:18px;color:var(--principal-color)}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .parrafo[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-weight:900;color:var(--principal-color-bold)}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:10px;padding-bottom:60px}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:flex-start;width:500px;max-width:100%;gap:5px;flex-direction:column}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:var(--principal-color)}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:40px;padding:0 10px;border:1px solid var(--principal-color);border-radius:5px;box-sizing:border-box;font-size:14px;font-weight:700;color:var(--principal-color)}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;height:100px;padding:10px;border:1px solid var(--principal-color);border-radius:5px;box-sizing:border-box;font-size:14px;font-weight:700;resize:none;color:var(--principal-color)}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-error[_ngcontent-%COMP%]{color:red;font-size:12px}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]{display:flex;align-items:flex-end;justify-content:flex-end;width:100%;padding-top:20px}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:200px;height:40px;border:none;border-radius:5px;background-color:var(--principal-color);color:var(--white-color);font-size:16px;font-weight:700;cursor:pointer}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:var(--principal-color-light);color:var(--principal-color)}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .correo-enviado[_ngcontent-%COMP%]{text-align:center;width:calc(100% - 40px);max-width:500px;background-color:#cbeccb;color:#000;font-size:18px;padding:30px 10px;margin:30px 10px;border-radius:10px;box-shadow:2px 2px 4px #00000020}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .correo-enviado-error[_ngcontent-%COMP%]{text-align:center;width:calc(100% - 40px);max-width:500px;background-color:#eccbcb;color:#000;font-size:18px;padding:30px 10px;margin:30px 10px;border-radius:10px;box-shadow:2px 2px 4px #00000020}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;width:100%;background-color:var(--principal-color);color:var(--white-color)}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;padding:100px 40px;width:calc(50% - 80px);box-sizing:border-box}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:2.2rem;font-weight:700;text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-bottom:1px solid var(--principal-color-light);padding:8px 20px}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1.2rem;max-width:600px;font-weight:700;text-align:start;padding:8px 20px}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:20px}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .item-contacto[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;flex-direction:row;gap:20px}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .item-contacto[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:30px;height:auto}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .item-contacto[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:1rem;font-weight:700}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:50%;height:710px;box-sizing:border-box}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   #mapa-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column}@media screen and (min-width: 600px) and (max-width: 959px){.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:50px 10px;margin:70px 10px}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:30px;padding:0 10px 30px;text-align:center}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .parrafo[_ngcontent-%COMP%]{font-size:16px;text-align:center}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]{width:100%}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%], .contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]{width:95%}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]{flex-direction:column}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%], .contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:100%}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]{padding:80px 10px}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{text-align:center}}@media screen and (max-width: 599px){.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.contacto-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:50px 10px;margin:70px 10px}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:30px;padding:0 10px 30px;text-align:center}.contacto-container[_ngcontent-%COMP%]   .contactanos-container[_ngcontent-%COMP%]   .parrafo[_ngcontent-%COMP%]{font-size:16px;text-align:center}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]{width:100%}.contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%], .contacto-container[_ngcontent-%COMP%]   .formulario-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]{width:95%}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]{flex-direction:column}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%], .contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:100%}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]{padding:80px 10px}.contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .contacto-container[_ngcontent-%COMP%]   .direccion-container[_ngcontent-%COMP%]   .nos-conocemos-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{text-align:center}}"]}),n})(),OW=(()=>{class n{constructor(){}ngOnInit(){window.scroll({top:0,left:0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-sobre-hasspro"]],decls:27,vars:0,consts:[[1,"sobre-hasspro-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"sobre-hasspro-card"],[1,"title"],[1,"parrafo"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),u._UZ(4,"img",4),u.qZA(),u.TgZ(5,"h1",5),u._uU(6,"ASISTENTE PROFESIONAL DE HOSTELER\xcdA"),u.qZA()()(),u.TgZ(7,"div",6)(8,"div",7),u._uU(9," Sobre Hasspro "),u.qZA(),u.TgZ(10,"div",8),u._uU(11," Hasspro, fundada por "),u.TgZ(12,"b"),u._uU(13,"Abel \xc1vila Alcalde"),u.qZA(),u._uU(14," tras la formaci\xf3n, estudios y haber conocido de primera mano el sector hostelero, trabajando con diferentes responsabilidades, en diferentes establecimientos y haber obtenido el titulo de t\xe9cnico en gesti\xf3n administrativa, el titulo t\xe9cnico superior en administraci\xf3n y finanzas y me encuentro actualmente terminando el Grado en finanzas y contabilidad en la Universidad de Extremadura. "),u.qZA(),u.TgZ(15,"div",8),u._uU(16," Tras mi dilatada experiencia encontr\xe9 mi oportunidad de negocio al observar que las necesidades del restaurador son muchas y variadas, y no se pueden limitar solamente a las funciones de camarero o cocinero, sino que deben aprender a gestionar su negocio, para poder sacarle el mayor rendimiento. "),u.qZA(),u.TgZ(17,"div",8),u._uU(18," Mi "),u.TgZ(19,"b"),u._uU(20,"motivaci\xf3n"),u.qZA(),u._uU(21," para emprender en este negocio, es "),u.TgZ(22,"b"),u._uU(23,"contribuir a mejorar la situaci\xf3n de los establecimientos"),u.qZA(),u._uU(24," de mi ciudad natal. La hoster\xeda, un sector en auge actualmente, pero que en ocasiones denostado por una dif\xedcil conciliaci\xf3n, los altos costes o la poca formaci\xf3n. "),u.qZA(),u.TgZ(25,"div",8),u._uU(26," Busco ofrecer una mejora de la profesionalidad del sector y contribuir a una mayor rentabilidad de los negocios. "),u.qZA()()())},styles:[".sobre-hasspro-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.sobre-hasspro-container[_ngcontent-%COMP%]   .sobre-hasspro-card[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:50px;flex-wrap:wrap;width:calc(100% - 180px);padding:50px 50px 100px;margin:70px 40px 20px;background-color:var(--principal-color-light-80);border-radius:5px;box-shadow:2px 2px 4px var(--principal-color-light)}.sobre-hasspro-container[_ngcontent-%COMP%]   .sobre-hasspro-card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:36px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10% 30px;border-bottom:1px solid var(--principal-color-80)}.sobre-hasspro-container[_ngcontent-%COMP%]   .sobre-hasspro-card[_ngcontent-%COMP%]   .parrafo[_ngcontent-%COMP%]{width:100%;text-align:start;font-size:18px;color:var(--principal-color)}.sobre-hasspro-container[_ngcontent-%COMP%]   .sobre-hasspro-card[_ngcontent-%COMP%]   .parrafo[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-weight:900;text-shadow:1px 1px 2px var(--principal-color-20)}@media screen and (min-width: 600px) and (max-width: 959px){.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;width:calc(100% - 16px);padding:8px 20px}.sobre-hasspro-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]{padding:50px 20px 100px}.sobre-hasspro-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]{width:90%}}@media screen and (max-width: 599px){.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.sobre-hasspro-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.sobre-hasspro-container[_ngcontent-%COMP%]   .sobre-hasspro-card[_ngcontent-%COMP%]{width:calc(100% - 40px);padding:50px 10px 100px;margin:20px 10px}.sobre-hasspro-container[_ngcontent-%COMP%]   .sobre-hasspro-card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;padding:0 10px 30px;text-align:center}}"]}),n})();function kW(n,e){if(1&n&&(u.TgZ(0,"div",18)(1,"div",19)(2,"div",20),u._UZ(3,"img",21),u.qZA(),u.TgZ(4,"div",22),u._uU(5),u.qZA()(),u.TgZ(6,"div",23),u._uU(7),u.qZA()()),2&n){const t=e.$implicit;u.xp6(3),u.Q6J("src",t.iconPath,u.LSH),u.xp6(2),u.hij(" ",t.titulo," "),u.xp6(2),u.hij(" ",t.texto," ")}}function RW(n,e){if(1&n&&(u.TgZ(0,"div",28),u._UZ(1,"img",29),u._uU(2),u.qZA()),2&n){const t=e.$implicit;u.xp6(2),u.hij(" ",t," ")}}function FW(n,e){if(1&n&&(u.TgZ(0,"div",24)(1,"div",25),u._UZ(2,"img",21),u.qZA(),u.TgZ(3,"div",15)(4,"div",26),u._uU(5),u.qZA(),u.YNc(6,RW,3,1,"div",27),u.qZA()()),2&n){const t=e.$implicit,i=u.oxw();u.xp6(2),u.Q6J("src",i.pathImg+t.img,u.LSH),u.xp6(3),u.hij(" ",t.texto," "),u.xp6(1),u.Q6J("ngForOf",t.vPuntos)}}let LW=(()=>{class n{constructor(){this.pathImg="../../../assets/",this.vContabilidad=["An\xe1lisis, revisi\xf3n y evoluci\xf3n de la contabilidad","Cierre del ejercicio","Presentaci\xf3n de las cuentas anuales y libros","Gesti\xf3n y trato de informaci\xf3n","Inmovilizado (C\xe1lculo y Control de amortizaci\xf3n)"],this.vLaboral=["Elaboraci\xf3n de las n\xf3minas","Presentaci\xf3n de los impuestos correspondientes","Altas y bajas en la empresa","Elaboraci\xf3n de entrevistas y elecci\xf3n de candidatos","Expedientes y tr\xe1mites con la Seguridad Social"],this.vFiscalidad=["Impuesto sobre la Renta de las Personas F\xedsicas (IRPF)","Impuesto sobre el Valor A\xf1adido (IVA)","Impuesto sobre Sociedades (IS)","Impuesto sobre Actividades Econ\xf3micas (IAE)","Presentaci\xf3n de Modelos trimestrales y anuales"],this.vDatosServicios=[{texto:"En Hasspro ofrecemos un servicio de asesor\xeda personalizado capaz de gestionar y procesar la informaci\xf3n de la empresa.",img:"imagen-contabilidad-hasspro.webp",vPuntos:this.vContabilidad},{texto:"La mejor manera de estar al d\xeda con Hacienda, evitar penalizaciones fiscales o tener las cuentas saneadas ante una posible inspecci\xf3n.",img:"imagen-fiscalidad-hasspro.webp",vPuntos:this.vFiscalidad},{texto:"Servicio continuo de orientaci\xf3n, asistencia y gesti\xf3n de los recursos humanos, permitiendo el \xf3ptimo desarrollo de las relaciones laborales.",img:"imagen-laboral-hasspro.webp",vPuntos:this.vLaboral}],this.vDatos=[{titulo:"Contabilidad",iconPath:"../../../assets/icons/icon-contabilidad.png",datos:[],texto:"Externalizar las tareas de contabilidad y gesti\xf3n en un equipo de expertos en asesor\xeda contable y con herramientas actuales, le permite descarga de procesos rutinarios y gestiones administrativas. Nosotros resolvemos lo urgente y rutinario para que la direcci\xf3n pueda centrarse en lo importante."},{titulo:"Laboral",iconPath:"../../../assets/icons/icon-laboral.png",datos:[],texto:"Conscientes de que las personas son el activo m\xe1s valioso de las empresas, el equipo de expertos de Asesor\xeda Laboral de Hasspro ofrece un servicio continuo de orientaci\xf3n, asistencia y gesti\xf3n de los recursos humanos, permitiendo el \xf3ptimo desarrollo de las relaciones laborales y evitando cualquier contingencia ante las distintas administraciones."},{titulo:"Fiscalidad",iconPath:"i../../../assets/icons/icon-fiscalidad.png",datos:[],texto:"Un asesoramiento fiscal que garantiza el cumplimiento de plazos ofreciendo alternativas de ahorro fiscal dentro de la normativa. El equipo Fiscal de Hasspro ofrece un servicio \xe1gil y personalizado con gestores expertos en los sistemas tributarios legales espa\xf1oles."}]}ngOnInit(){window.scroll({top:0,left:0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-gestion-documentacion"]],decls:25,vars:2,consts:[[1,"servicios-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"servicios-items-container"],[1,"title"],[1,"subtitle"],[1,"listado-servicios"],["class","item-list",4,"ngFor","ngForOf"],[1,"descripcion-servicios"],[1,"title-descripcion"],["class","item",4,"ngFor","ngForOf"],[1,"solicita-nuestros-servicios"],[1,"texto"],[1,"boton"],[1,"boton-contacta-con-nosotros"],[1,"item-list"],[1,"title-item-list"],[1,"icon"],[3,"src"],[1,"text"],[1,"content-text"],[1,"item"],[1,"contenedor-imagen"],[1,"subtitulo"],["class","item-content-item-list",4,"ngFor","ngForOf"],[1,"item-content-item-list"],["src","../../../assets/icons/check.png"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),u._UZ(4,"img",4),u.qZA(),u.TgZ(5,"h1",5),u._uU(6," ASISTENTE PROFESIONAL DE HOSTELER\xcdA "),u.qZA()()(),u.TgZ(7,"div",6)(8,"div",7),u._uU(9,"A/Gesti\xf3n de la Documentaci\xf3n"),u.qZA(),u.TgZ(10,"div",8),u._uU(11,"Servicios"),u.qZA(),u.TgZ(12,"div",9),u.YNc(13,kW,8,3,"div",10),u.qZA()(),u.TgZ(14,"div",11)(15,"div",12),u._uU(16,"Ofrecemos:"),u.qZA(),u.YNc(17,FW,7,3,"div",13),u.qZA(),u.TgZ(18,"div",14)(19,"div",15)(20,"div",7),u._uU(21,"\xbfQuieres solicitar nuestros servicios?"),u.qZA()(),u.TgZ(22,"div",16)(23,"button",17),u._uU(24,"Contacta con nosotros"),u.qZA()()()()),2&t&&(u.xp6(13),u.Q6J("ngForOf",i.vDatos),u.xp6(4),u.Q6J("ngForOf",i.vDatosServicios))},dependencies:[Qi],styles:[".servicios-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;padding:100px 40px;width:calc(100% - 80px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:36px;width:800px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10px 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:30px;min-width:500px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10% 30px;border-bottom:1px solid var(--principal-color-80)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:center;gap:50px;flex-direction:row;flex-wrap:wrap;width:100%;margin-top:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{min-width:270px;max-width:calc(100% - 40px);width:400px;height:265px;background-color:var(--principal-color-light);box-shadow:1px 2px 4px var(--principal-color-light-40);border-radius:10px;padding:30px 20px;display:flex;align-items:flex-start;justify-self:flex-start;flex-direction:column;gap:30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:flex-start;flex-direction:row;gap:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:30px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:row;gap:10px;text-align:start}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-text[_ngcontent-%COMP%]{margin:0 20px;line-height:24px}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]{margin-top:60px;max-width:100%}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .title-descripcion[_ngcontent-%COMP%]{font-size:36px;width:100%;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);margin-bottom:30px}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{padding:40px 20px;max-width:100%;width:1000px;border-top:1px solid var(--principal-color-light);box-sizing:border-box;display:flex;align-items:center;justify-content:flex-start;flex-wrap:wrap;gap:50px}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:last-child{border-bottom:1px solid var(--principal-color-light)}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .contenedor-imagen[_ngcontent-%COMP%]{width:180px;height:180px;max-width:300px;border-radius:4px;box-shadow:3px 3px 10px var(--principal-color-80)}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .contenedor-imagen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:180px;height:180px;border-radius:4px}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]{flex:1;margin-top:10px;display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:14px}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]   .subtitulo[_ngcontent-%COMP%]{font-size:18px;color:var(--principal-color-bold);margin-bottom:15px}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;gap:10px;margin-left:10px}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]{padding:50px 0 100px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:36px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]{text-align:center}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]{font-size:20px;color:var(--principal-color);background-color:var(--principal-color-light);border:1px solid var(--principal-color);border-radius:10px;padding:10px 20px;margin-top:20px;cursor:pointer;transition:all .3s ease-in-out}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]:hover{background-color:var(--principal-color);color:var(--principal-color-light)}@media screen and (min-width: 600px) and (max-width: 959px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{align-items:center;justify-content:center;flex-direction:column}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .contenedor-imagen[_ngcontent-%COMP%], .servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .contenedor-imagen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]{text-align:center}}@media screen and (max-width: 599px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{align-items:center;justify-content:center;flex-direction:column}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .contenedor-imagen[_ngcontent-%COMP%], .servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .contenedor-imagen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.servicios-container[_ngcontent-%COMP%]   .descripcion-servicios[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]{text-align:center}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{padding:100px 5px;width:calc(100% - 10px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;min-width:100%;padding:0 10px 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{min-width:100%;padding-left:0;padding-right:0}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{min-width:100%}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{width:100%;height:auto}}"]}),n})();function NW(n,e){if(1&n&&(u.TgZ(0,"div",22),u._UZ(1,"img",23),u.TgZ(2,"span"),u._uU(3),u.qZA()()),2&n){const t=e.$implicit;u.xp6(3),u.hij(" ",t," ")}}function zW(n,e){if(1&n&&(u.TgZ(0,"div",15)(1,"div",16)(2,"div",17),u._UZ(3,"img",18),u.qZA(),u.TgZ(4,"div",19),u._uU(5),u.qZA()(),u.TgZ(6,"div",20),u.YNc(7,NW,4,1,"div",21),u.qZA()()),2&n){const t=e.$implicit;u.xp6(3),u.Q6J("src",t.iconPath,u.LSH),u.xp6(2),u.hij(" ",t.titulo," "),u.xp6(2),u.Q6J("ngForOf",t.datos)}}let BW=(()=>{class n{constructor(){this.vControlHorarios=["Horarios","Horas","App"],this.vControlProveedores=["Pedidos","Control de stock","Proveedores","App"],this.vGestionCartas=["Cartas","Digitalizacion de cartas","Inventarios","Escandallos","App"],this.vPersonal=["Charlas","Formaci\xf3n participativa","Organizaci\xf3n y gesti\xf3n del equipo"],this.vServicio=["Al\xe9rgenos","Gesti\xf3n antes y despu\xe9s del servicio","Gesti\xf3n de reservas","Organizaci\xf3n de mesas","Tiempos","Tipos de comanda","Tipos de servicios","App"],this.vGestionEventos=["Desarrollo del evento","Coordinador de eventos","Men\xfas","App"],this.vDatos=[{titulo:"Gesti\xf3n y control de horarios y horas",iconPath:"../../../assets/icons/icon-clock.png",datos:this.vControlHorarios},{titulo:"Gesti\xf3n y control de proveedores y stock",iconPath:"../../../assets/icons/icon-stock.png",datos:this.vControlProveedores},{titulo:"Gesti\xf3n y organizaci\xf3n de cartas",iconPath:"../../../assets/icons/icon-message.png",datos:this.vGestionCartas},{titulo:"Selecci\xf3n y formaci\xf3n del personal",iconPath:"../../../assets/icons/icon-person.png",datos:this.vPersonal},{titulo:"Gesti\xf3n y organizacion del servicio",iconPath:"../../../assets/icons/icon-service.png",datos:this.vServicio},{titulo:"Organizaci\xf3n y gesti\xf3n de eventos",iconPath:"../../../assets/icons/icon-events.png",datos:this.vGestionEventos}]}ngOnInit(){window.scroll({top:0,left:0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-gestion-participativa-sala"]],decls:21,vars:1,consts:[[1,"servicios-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"servicios-items-container"],[1,"title"],[1,"subtitle"],[1,"listado-servicios"],["class","item-list",4,"ngFor","ngForOf"],[1,"solicita-nuestros-servicios"],[1,"texto"],[1,"boton"],[1,"boton-contacta-con-nosotros"],[1,"item-list"],[1,"title-item-list"],[1,"icon"],[3,"src"],[1,"text"],[1,"content-item-list"],["class","item-content-item-list",4,"ngFor","ngForOf"],[1,"item-content-item-list"],["src","../../../assets/icons/check.png"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),u._UZ(4,"img",4),u.qZA(),u.TgZ(5,"h1",5),u._uU(6,"ASISTENTE PROFESIONAL DE HOSTELER\xcdA"),u.qZA()()(),u.TgZ(7,"div",6)(8,"div",7),u._uU(9," A/Gesti\xf3n Participativa de Sala "),u.qZA(),u.TgZ(10,"div",8),u._uU(11," Servicios "),u.qZA(),u.TgZ(12,"div",9),u.YNc(13,zW,8,3,"div",10),u.qZA()(),u.TgZ(14,"div",11)(15,"div",12)(16,"div",7),u._uU(17," \xbfQuieres solicitar nuestros servicios? "),u.qZA()(),u.TgZ(18,"div",13)(19,"button",14),u._uU(20," Contacta con nosotros "),u.qZA()()()()),2&t&&(u.xp6(13),u.Q6J("ngForOf",i.vDatos))},dependencies:[Qi],styles:[".servicios-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;padding:100px 40px;width:calc(100% - 80px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:36px;min-width:800px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10% 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:30px;min-width:500px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10% 30px;border-bottom:1px solid var(--principal-color-80)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:center;gap:50px;flex-direction:row;flex-wrap:wrap;min-width:950px;width:100%;margin-top:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{min-width:270px;max-width:330px;width:27%;background-color:var(--principal-color-light);box-shadow:1px 2px 4px var(--principal-color-light-40);border-radius:10px;padding:30px 20px;display:flex;align-items:flex-start;justify-self:flex-start;flex-direction:column;gap:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:flex-start;flex-direction:row;gap:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:22px;text-align:start;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;gap:10px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]{padding:50px 0 100px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:36px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]{text-align:center}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]{font-size:20px;color:var(--principal-color);background-color:var(--principal-color-light);border:1px solid var(--principal-color);border-radius:10px;padding:10px 20px;margin-top:20px;cursor:pointer;transition:all .3s ease-in-out}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]:hover{background-color:var(--principal-color);color:var(--principal-color-light)}@media screen and (max-width: 959px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{padding:100px 5px;width:calc(100% - 10px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;min-width:100%;padding:0 10px 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{min-width:100%;padding-left:0;padding-right:0}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{min-width:100%}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{width:100%}}"]}),n})(),t2=(()=>{class n{constructor(){}getLocalLinks(){return[{name:"Inicio",path:"home"},{name:"Servicios",path:"servicios",sublinks:[{name:"A/Gesti\xf3n de la Documentaci\xf3n",path:"/servicios/gestion-documentacion"},{name:"A/Gesti\xf3n Participativa de Sala",path:"/servicios/gestion-participativa-sala"},{name:"Aquisici\xf3n de los establecimientos",path:"/servicios/adquisicion-establecimientos"}]},{name:"Sobre Hasspro",path:"sobre-hasspro"},{name:"\xbfPor qu\xe9 contratarnos?",path:"por-que-contratarnos"},{name:"Contacto",path:"contacto"}]}getServiciosLinks(){return[{name:"Asesoramiento y gesti\xf3n de la Documentaci\xf3n",path:"/servicios/gestion-documentacion"},{name:"Asesoramiento y gesti\xf3n Participativa de Sala",path:"/servicios/gestion-participativa-sala"},{name:"Adquisici\xf3n de los establecimientos",path:"/servicios/adquisicion-establecimientos"}]}getLegalLinks(){return[{name:"Pol\xedtica de privacidad",path:""},{name:"T\xe9rminos y condiciones",path:""},{name:"Pol\xedtica de cookies",path:""}]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function VW(n,e){if(1&n&&(u.TgZ(0,"div",11)(1,"a",7),u._uU(2),u.qZA()()),2&n){const t=e.$implicit;u.xp6(1),u.Q6J("routerLink",t.path),u.xp6(1),u.Oqu(t.name)}}function UW(n,e){if(1&n&&(u.TgZ(0,"div",9),u.YNc(1,VW,3,2,"div",10),u.qZA()),2&n){const t=u.oxw().$implicit;u.xp6(1),u.Q6J("ngForOf",t.sublinks)}}function jW(n,e){if(1&n&&(u.TgZ(0,"div",6)(1,"a",7),u._uU(2),u.qZA(),u.YNc(3,UW,2,1,"div",8),u.qZA()),2&n){const t=e.$implicit;u.xp6(1),u.Q6J("routerLink",t.path),u.xp6(1),u.Oqu(t.name),u.xp6(1),u.Q6J("ngIf",void 0!==t.sublinks)}}function $W(n,e){if(1&n&&(u.TgZ(0,"div",17)(1,"a",13),u._uU(2),u.qZA()()),2&n){const t=e.$implicit;u.xp6(1),u.Q6J("routerLink",t.path),u.xp6(1),u.Oqu(t.name)}}function GW(n,e){if(1&n&&(u.TgZ(0,"div",15),u.YNc(1,$W,3,2,"div",16),u.qZA()),2&n){const t=u.oxw().$implicit;u.xp6(1),u.Q6J("ngForOf",t.sublinks)}}function HW(n,e){if(1&n){const t=u.EpF();u.TgZ(0,"div",12),u.NdJ("click",function(){u.CHM(t);const r=u.oxw();return u.KtG(r.menuMobileOpened=!1)}),u.TgZ(1,"a",13),u._uU(2),u.qZA(),u.YNc(3,GW,2,1,"div",14),u.qZA()}if(2&n){const t=e.$implicit;u.xp6(1),u.Q6J("routerLink",t.path),u.xp6(1),u.Oqu(t.name),u.xp6(1),u.Q6J("ngIf",void 0!==t.sublinks)}}const qW=function(n){return{"not-in-top":n}},ZW=function(n){return{"menu-mobile-button-opened":n}},WW=function(n){return{"link-mobile-menu-opened":n}};let YW=(()=>{class n{constructor(t){this.localDataService=t,this.vLocalLinks=[],this.menuMobileOpened=!1,this.notInTop=!1}ngOnInit(){this.vLocalLinks=this.localDataService.getLocalLinks()}onScroll(t){this.notInTop=window.pageYOffset>50}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(t2))},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-header"]],hostBindings:function(t,i){1&t&&u.NdJ("scroll",function(s){return i.onScroll(s)},!1,u.Jf7)},decls:6,vars:11,consts:[[1,"toolbar",3,"ngClass"],[1,"link-container"],["class","link",4,"ngFor","ngForOf"],[1,"menu-mobile-button",3,"ngClass","click"],[1,"link-mobile-container",3,"ngClass"],["class","link-mobile",3,"click",4,"ngFor","ngForOf"],[1,"link"],["routerLinkActive","link-active",3,"routerLink"],["class","submenu",4,"ngIf"],[1,"submenu"],["class","sublink",4,"ngFor","ngForOf"],[1,"sublink"],[1,"link-mobile",3,"click"],[3,"routerLink"],["class","submenu-mobile",4,"ngIf"],[1,"submenu-mobile"],["class","sublink-mobile",4,"ngFor","ngForOf"],[1,"sublink-mobile"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1),u.YNc(2,jW,4,3,"div",2),u.qZA(),u.TgZ(3,"div",3),u.NdJ("click",function(){return i.menuMobileOpened=!i.menuMobileOpened}),u.qZA(),u.TgZ(4,"div",4),u.YNc(5,HW,4,3,"div",5),u.qZA()()),2&t&&(u.Q6J("ngClass",u.VKq(5,qW,i.notInTop)),u.xp6(2),u.Q6J("ngForOf",i.vLocalLinks),u.xp6(1),u.Q6J("ngClass",u.VKq(7,ZW,i.menuMobileOpened)),u.xp6(1),u.Q6J("ngClass",u.VKq(9,WW,i.menuMobileOpened)),u.xp6(1),u.Q6J("ngForOf",i.vLocalLinks))},dependencies:[Mn,Qi,Ro,Kf,vx],styles:['.toolbar[_ngcontent-%COMP%]{width:100%;height:60px;position:fixed;top:0;z-index:100;display:flex;align-items:center;justify-content:flex-end;flex-direction:row;transition:.4s cubic-bezier(.075,.82,.165,1) background-color}.toolbar.not-in-top[_ngcontent-%COMP%]{background-color:var(--principal-color-light);transition:.4s cubic-bezier(.075,.82,.165,1) background-color;box-shadow:2px 2px 5px var(--principal-color-light-80)}.toolbar.not-in-top[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--principal-color);transition:.4s cubic-bezier(.075,.82,.165,1) color}.toolbar.not-in-top[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .toolbar.not-in-top[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   a.link-active[_ngcontent-%COMP%]{border-bottom:1px solid var(--principal-color-80)}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;flex-direction:row;position:fixed;top:10px}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{cursor:pointer;padding:10px 20px;position:relative}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--principal-color-light);font-size:1.1em;font-weight:500;text-decoration:none;text-shadow:1px 1px 2px var(--principal-color-light-20);border-bottom:1px solid transparent;padding-bottom:4px;transition:border-bottom .3s linear;transition:.4s cubic-bezier(.075,.82,.165,1) color}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   a.link-active[_ngcontent-%COMP%]{border-bottom:1px solid var(--principal-color-light-80)}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:hover   .submenu[_ngcontent-%COMP%]{top:42px;opacity:1;transition:.1s opacity}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .submenu[_ngcontent-%COMP%]{position:absolute;width:300px;left:-110px;top:-360px;opacity:0;transition:.1s opacity 0s,0s top .1s;padding:20px 5px;background-color:var(--principal-color-light);border-radius:5px;box-shadow:1px 2px 10px var(--principal-color-40)}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .submenu[_ngcontent-%COMP%]   .sublink[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;gap:10px;padding:10px 0}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .submenu[_ngcontent-%COMP%]   .sublink[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--principal-color);font-size:1em;font-weight:500;text-decoration:none;text-shadow:1px 1px 2px var(--principal-color-20);border-bottom:1px solid transparent;padding-bottom:4px;transition:border-bottom .3s linear;transition:.4s cubic-bezier(.075,.82,.165,1) color}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .submenu[_ngcontent-%COMP%]   .sublink[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .submenu[_ngcontent-%COMP%]   .sublink[_ngcontent-%COMP%]   a.link-active[_ngcontent-%COMP%]{border-bottom:1px solid var(--principal-color-80)}.toolbar[_ngcontent-%COMP%]   .link-mobile-container[_ngcontent-%COMP%]{display:none}@media screen and (max-width: 959px){.toolbar[_ngcontent-%COMP%]{background-color:var(--principal-color-light)}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button[_ngcontent-%COMP%]{width:30px;height:3px;background:var(--principal-color);margin-right:30px;border-radius:50px;transition:all .3s linear;position:relative;z-index:10;transition:.15s linear transform}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button[_ngcontent-%COMP%]:after, .toolbar[_ngcontent-%COMP%]   .menu-mobile-button[_ngcontent-%COMP%]:before{position:absolute;content:"";width:30px;height:3px;background:var(--principal-color);border-radius:50px;transition:.15s linear transform}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button[_ngcontent-%COMP%]:after{top:10px}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button[_ngcontent-%COMP%]:before{top:-10px}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button.menu-mobile-button-opened[_ngcontent-%COMP%]{background-color:transparent}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button.menu-mobile-button-opened[_ngcontent-%COMP%]:after{transform:rotate(45deg) translateY(-8px) translate(-6px);transition:.15s linear transform}.toolbar[_ngcontent-%COMP%]   .menu-mobile-button.menu-mobile-button-opened[_ngcontent-%COMP%]:before{transform:rotate(-45deg) translateY(8px) translate(-6px);transition:.15s linear transform}.toolbar[_ngcontent-%COMP%]   .link-container[_ngcontent-%COMP%]{display:none}.toolbar[_ngcontent-%COMP%]   .link-mobile-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;box-shadow:0 3px 10px var(--principal-color);position:absolute;top:0;left:0;width:100%;height:0px;background-color:var(--principal-color-light);transition:.3s cubic-bezier(.075,.82,.165,1) all .2s}.toolbar[_ngcontent-%COMP%]   .link-mobile-container.link-mobile-menu-opened[_ngcontent-%COMP%]{border-bottom:2px solid var(--principal-color);height:100vh;transition:.3s cubic-bezier(.075,.82,.165,1) all}.toolbar[_ngcontent-%COMP%]   .link-mobile-container.link-mobile-menu-opened[_ngcontent-%COMP%]   .link-mobile[_ngcontent-%COMP%]{font-size:24px!important;text-align:center;transition:.2s cubic-bezier(.075,.82,.165,1) all .3s}.toolbar[_ngcontent-%COMP%]   .link-mobile-container.link-mobile-menu-opened[_ngcontent-%COMP%]   .submenu-mobile[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;padding:10px 0;margin-top:20px;transition:.2s cubic-bezier(.075,.82,.165,1) all .3s;border-top:1px solid var(--principal-color-20);border-bottom:1px solid var(--principal-color-20)}.toolbar[_ngcontent-%COMP%]   .link-mobile-container.link-mobile-menu-opened[_ngcontent-%COMP%]   .submenu-mobile[_ngcontent-%COMP%]   .sublink-mobile[_ngcontent-%COMP%]{font-size:20px!important;text-align:center;transition:.2s cubic-bezier(.075,.82,.165,1) all .3s}.toolbar[_ngcontent-%COMP%]   .link-mobile-container.link-mobile-menu-opened[_ngcontent-%COMP%]   .submenu-mobile[_ngcontent-%COMP%]   .sublink-mobile[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--principal-color);text-decoration:none}.toolbar[_ngcontent-%COMP%]   .link-mobile-container.link-mobile-menu-opened[_ngcontent-%COMP%]   .submenu-mobile[_ngcontent-%COMP%]   .sublink-mobile[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .toolbar[_ngcontent-%COMP%]   .link-mobile-container.link-mobile-menu-opened[_ngcontent-%COMP%]   .submenu-mobile[_ngcontent-%COMP%]   .sublink-mobile[_ngcontent-%COMP%]   a.link-active[_ngcontent-%COMP%]{border-bottom:1px solid var(--principal-color-80)}.toolbar[_ngcontent-%COMP%]   .link-mobile-container[_ngcontent-%COMP%]   .link-mobile[_ngcontent-%COMP%], .toolbar[_ngcontent-%COMP%]   .link-mobile-container[_ngcontent-%COMP%]   .submenu-mobile[_ngcontent-%COMP%]{font-size:0px;text-shadow:1px 1px 2px var(--principal-color-40);transition:.2s cubic-bezier(.075,.82,.165,1) all}.toolbar[_ngcontent-%COMP%]   .link-mobile-container[_ngcontent-%COMP%]   .link-mobile[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .toolbar[_ngcontent-%COMP%]   .link-mobile-container[_ngcontent-%COMP%]   .submenu-mobile[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:var(--principal-color)}}']}),n})();function KW(n,e){if(1&n&&(u.TgZ(0,"div",16),u._uU(1),u.qZA()),2&n){const t=e.$implicit;u.Q6J("routerLink",t.path),u.xp6(1),u.hij(" ",t.name," ")}}function XW(n,e){if(1&n&&(u.TgZ(0,"div",16),u._uU(1),u.qZA()),2&n){const t=e.$implicit;u.Q6J("routerLink",t.path),u.xp6(1),u.hij(" ",t.name," ")}}function QW(n,e){if(1&n&&(u.TgZ(0,"div",16),u._uU(1),u.qZA()),2&n){const t=e.$implicit;u.Q6J("routerLink",t.path),u.xp6(1),u.hij(" ",t.name," ")}}let JW=(()=>{class n{constructor(t){this.localDataService=t,this.vLinks=[],this.vLinksServicios=[],this.vLegalLinks=[]}ngOnInit(){this.vLinks=this.localDataService.getLocalLinks(),this.vLegalLinks=this.localDataService.getLegalLinks(),this.vLinksServicios=this.localDataService.getServiciosLinks()}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(t2))},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-footer"]],decls:32,vars:3,consts:[[1,"footer-container"],[1,"data-container"],[1,"links-list"],["class","link-item",3,"routerLink",4,"ngFor","ngForOf"],[1,"address"],[1,"content"],[1,"item"],[1,"icon"],["src","../../../assets/icons/location-color-principal.png"],[1,"text"],["src","../../../assets/icons/email-color-principal.png"],["src","../../../assets/icons/phone-color-principal.png"],[1,"legal-links-list"],["routerLink","/private/auth-login",1,"link-item"],[1,"developer-container"],["href","https://sergiogdev.com/"],[1,"link-item",3,"routerLink"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1)(2,"div",2),u.YNc(3,KW,2,2,"div",3),u.qZA(),u.TgZ(4,"div",2),u.YNc(5,XW,2,2,"div",3),u.qZA(),u.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7),u._UZ(10,"img",8),u.qZA(),u.TgZ(11,"div",9),u._uU(12," Ronda del Carmen, 13. C\xe1ceres (CP: 10002) "),u.qZA()(),u.TgZ(13,"div",6)(14,"div",7),u._UZ(15,"img",10),u.qZA(),u.TgZ(16,"div",9),u._uU(17," contacto@hasspro.es "),u.qZA()(),u.TgZ(18,"div",6)(19,"div",7),u._UZ(20,"img",11),u.qZA(),u.TgZ(21,"div",9),u._uU(22," 640 90 36 70 "),u.qZA()()()(),u.TgZ(23,"div",12),u.YNc(24,QW,2,2,"div",3),u.TgZ(25,"div",13),u._uU(26," Secci\xf3n privada "),u.qZA()()(),u.TgZ(27,"div",14)(28,"div",9),u._uU(29," Hecho con \u2764\ufe0f por "),u.TgZ(30,"a",15),u._uU(31,"SergioGDev \xa9"),u.qZA()()()()),2&t&&(u.xp6(3),u.Q6J("ngForOf",i.vLinks),u.xp6(2),u.Q6J("ngForOf",i.vLinksServicios),u.xp6(19),u.Q6J("ngForOf",i.vLegalLinks))},dependencies:[Qi,Kf],styles:[".footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;flex-wrap:wrap;gap:20px;padding:30px;background-color:var(--principal-color-light)}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .links-list[_ngcontent-%COMP%]{width:25%}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .links-list[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:var(--principal-color);cursor:pointer;padding:5px 20px}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .links-list[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]:hover{text-shadow:1px 1px 1px var(--principal-color-20)}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{width:40%;display:flex;align-items:center;justify-content:center;flex-direction:column}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:center;flex-direction:column;gap:16px}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;gap:30px}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:32px;height:32px;color:var(--principal-color)}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px;height:32px}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:16px;color:var(--principal-color)}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .legal-links-list[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;flex-direction:row;flex-wrap:wrap;gap:20px}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .legal-links-list[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:var(--principal-color);cursor:pointer;padding:5px 20px}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .legal-links-list[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]:hover{text-shadow:1px 1px 1px var(--principal-color-20)}.footer-container[_ngcontent-%COMP%]   .developer-container[_ngcontent-%COMP%]{text-align:center;padding:30px;background-color:var(--principal-color-light-oscuro);color:var(--principal-color)}.footer-container[_ngcontent-%COMP%]   .developer-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--principal-color);text-shadow:1px 1px 1px var(--principal-color-20);text-decoration:none}@media screen and (min-width: 600px) and (max-width: 959px){.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .links-list[_ngcontent-%COMP%], .footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%], .footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .legal-links-list[_ngcontent-%COMP%]{width:100%}}@media screen and (max-width: 599px){.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .links-list[_ngcontent-%COMP%], .footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{width:100%}.footer-container[_ngcontent-%COMP%]   .data-container[_ngcontent-%COMP%]   .legal-links-list[_ngcontent-%COMP%]{width:100%;gap:10px}}"]}),n})(),e7=(()=>{class n{constructor(t){this.localDataService=t,this.vLocalLinks=[],this.menuMobileOpened=!1}ngOnInit(){this.vLocalLinks=this.localDataService.getLocalLinks()}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(t2))},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-home-layout"]],decls:7,vars:0,consts:[[1,"layout-container"],[1,"header"],[1,"content"],[1,"footbar"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1),u._UZ(2,"app-header"),u.qZA(),u.TgZ(3,"div",2),u._UZ(4,"router-outlet"),u.qZA(),u.TgZ(5,"div",3),u._UZ(6,"app-footer"),u.qZA()())},dependencies:[Gu,YW,JW],styles:[".layout-container[_ngcontent-%COMP%]{width:100%}"]}),n})();function t7(n,e){if(1&n&&(u.TgZ(0,"div",19)(1,"div",10),u._uU(2),u.qZA(),u.TgZ(3,"div",13),u._uU(4),u.qZA()()),2&n){const t=e.$implicit;u.xp6(2),u.hij(" ",t.title," "),u.xp6(2),u.hij(" ",t.text," ")}}function n7(n,e){if(1&n&&(u.TgZ(0,"div",10),u._uU(1),u.qZA()),2&n){const t=u.oxw().$implicit;u.xp6(1),u.hij(" ",t.subtitle," ")}}function i7(n,e){if(1&n&&(u.TgZ(0,"div",12)(1,"div",7),u._uU(2),u.qZA(),u.YNc(3,n7,2,1,"div",20),u.TgZ(4,"div",13),u._uU(5),u.qZA(),u.TgZ(6,"div",21)(7,"button",22),u._uU(8,"Ver m\xe1s"),u.qZA()()()),2&n){const t=e.$implicit;u.xp6(2),u.hij(" ",t.title," "),u.xp6(1),u.Q6J("ngIf",t.subtitle),u.xp6(2),u.hij(" ",t.text," "),u.xp6(2),u.Q6J("routerLink",t.path)}}let r7=(()=>{class n{constructor(){this.vServicios=[{title:"1\xba.-Realizamos un Estudio inicial participativo sin compromiso:",text:"Para poder conocer la situaci\xf3n en la que se encuentra cada local, as\xed como la documentaci\xf3n tratada y  gestionada."},{title:"2\xba.- Ofrecemos un presupuesto personalizado:",text:"Plantearemos los diferentes problemas y aplicaremos los mecanismos necesarios para optimizar y garantizar los diferentes procesos, acorde a las necesidades de cada negocio."},{title:"3\xba.-Realizamos el servicio acordado con profesionalidad, personalizado y con rigor.",text:"Establecemos un sello exclusivo de calidad, exigiendo rigor en su cumplimiento."}],this.vNuestrosServicios=[{title:"Asesoramiento y gesti\xf3n de la documentaci\xf3n",text:"Tramitamos toda la documentaci\xf3n necesaria para tu establecimiento. Te asesoramos y realizamos todo tipo de gestiones ajust\xe1ndolas a los par\xe1metros de tu negocio con el fin de obtener una mayor viabilidad del mismo.",path:"/servicios/gestion-documentacion"},{title:"Asesoramiento y gesti\xf3n participativa de sala",text:"Ofrecemos una mejora de los servicios y la optimizaci\xf3n de los procesos y recursos de los que disponga la empresa. Te asesoramos y adaptamos nuevos m\xe9todos de trabajo, gesti\xf3n, formaci\xf3n del equipo o mejora de los servicios, entre otros.",path:"/servicios/gestion-participativa-sala"},{title:"Adquisici\xf3n de los establecimientos",text:"Ofrecemos la gesti\xf3n y adquisici\xf3n total o parcial de establecimientos o locales dedicados al sector de la hosteler\xeda, te contamos como poder delegar aquellas funciones y gestiones que ser\xe1n necesarias para optimizar al m\xe1ximo el funcionamiento del establecimiento. Ofrecemos un trato personalizado que se adapte a las necesidades de los diferentes clientes con los que trabajamos.",path:"/servicios/adquisicion-establecimientos"}]}ngOnInit(){window.scroll({top:0,left:0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-servicios"]],decls:30,vars:2,consts:[[1,"servicios-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"como-trabajamos-container"],[1,"title"],["class","como-trabajamos-item",4,"ngFor","ngForOf"],[1,"nuestros-servicios-container"],[1,"subtitle"],[1,"items-nuestros-servicios"],[1,"item-nuestros-servicios"],[1,"text"],["class","item-nuestros-servicios",4,"ngFor","ngForOf"],[1,"solicita-nuestros-servicios"],[1,"texto"],[1,"boton"],[1,"boton-contacta-con-nosotros"],[1,"como-trabajamos-item"],["class","subtitle",4,"ngIf"],[1,"ver-mas"],[3,"routerLink"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),u._UZ(4,"img",4),u.qZA(),u.TgZ(5,"h1",5),u._uU(6," ASISTENTE PROFESIONAL DE HOSTELER\xcdA "),u.qZA()()(),u.TgZ(7,"div",6)(8,"div",7),u._uU(9,"\xbfC\xf3mo trabajamos?"),u.qZA(),u.YNc(10,t7,5,2,"div",8),u.qZA(),u.TgZ(11,"div",9)(12,"div",7),u._uU(13,"Nuestros servicios"),u.qZA(),u.TgZ(14,"div",10),u._uU(15,"Trabajamos para que tu negocio triunfe"),u.qZA(),u.TgZ(16,"div",11)(17,"div",12)(18,"div",7),u._uU(19,"Estudio inicial participativo SIN COMPROMISO"),u.qZA(),u.TgZ(20,"div",13),u._uU(21," Cont\xe1ctenos y analizaremos la situaci\xf3n de tu negocio. Te ofrecemos un estudio inicial participativo sin compromiso en el que estudiaremos los diferentes servicios y t\xe9cnicas que mejor se adapten a tu situaci\xf3n, ayud\xe1ndote a incorporar nuevas rutinas y formas de trabajo que garanticen el \xe9xito y la durabilidad de tu establecimiento. "),u.qZA()(),u.YNc(22,i7,9,4,"div",14),u.qZA()(),u.TgZ(23,"div",15)(24,"div",16)(25,"div",7),u._uU(26,"\xbfQuieres solicitar nuestros servicios?"),u.qZA()(),u.TgZ(27,"div",17)(28,"button",18),u._uU(29,"Contacta con nosotros"),u.qZA()()()()),2&t&&(u.xp6(10),u.Q6J("ngForOf",i.vServicios),u.xp6(12),u.Q6J("ngForOf",i.vNuestrosServicios))},dependencies:[Qi,Ro,Kf],styles:[".servicios-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:50px;flex-wrap:wrap;width:calc(100% - 180px);padding:50px 50px 100px;margin:70px 40px 20px;background-color:var(--principal-color-light-80);border-radius:5px;box-shadow:2px 2px 4px var(--principal-color-light)}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:36px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10% 30px;border-bottom:1px solid var(--principal-color-80)}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]   .como-trabajamos-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:10px;flex-direction:column;max-width:800px}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]   .como-trabajamos-item[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-weight:900;font-size:20px;text-align:center;color:var(--principal-color);text-shadow:1px 2px 2px var(--principal-color-20)}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]   .como-trabajamos-item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:18px;text-align:center;color:var(--principal-color)}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;flex-wrap:wrap;gap:20px;width:calc(100% - 180px);box-sizing:border-box;padding:50px 50px 100px;margin:20px 40px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:36px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 50px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:24px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10% 30px;border-bottom:1px solid var(--principal-color-80);text-align:center}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;flex-wrap:wrap;gap:20px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;width:40%;padding:40px;min-height:380px;background-color:var(--principal-color-light-80);border-radius:5px;box-shadow:2px 2px 4px var(--principal-color-light)}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]:first-child{width:75%;min-height:250px;gap:40px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%], .servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:var(--principal-color);width:100%;text-align:center}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:28px;font-weight:900;text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:24px;font-weight:700;border-bottom:none;text-shadow:1px 1px 2px var(--principal-color-20)}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:18px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]   .ver-mas[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:var(--principal-color);color:var(--principal-color-light);border:none;border-radius:5px;padding:10px 20px;font-size:18px;font-weight:700;cursor:pointer;transition:all .3s ease-in-out;margin-top:30px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]{padding:50px 0 100px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:36px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]{text-align:center}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]{font-size:20px;color:var(--principal-color);background-color:var(--principal-color-light);border:1px solid var(--principal-color);border-radius:10px;padding:10px 20px;margin-top:20px;cursor:pointer;transition:all .3s ease-in-out}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]:hover{background-color:var(--principal-color);color:var(--principal-color-light)}@media screen and (min-width: 600px) and (max-width: 959px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]{padding:50px 20px 100px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]{width:90%}}@media screen and (max-width: 599px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]{width:calc(100% - 40px);padding:50px 10px 100px;margin:20px 10px}.servicios-container[_ngcontent-%COMP%]   .como-trabajamos-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;padding:0 10px 30px;text-align:center}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]{width:calc(100% - 40px);padding:50px 10px 100px;margin:20px 10px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;padding:0}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{padding:0 0 30px}.servicios-container[_ngcontent-%COMP%]   .nuestros-servicios-container[_ngcontent-%COMP%]   .items-nuestros-servicios[_ngcontent-%COMP%]   .item-nuestros-servicios[_ngcontent-%COMP%]{width:100%!important;padding:40px 10px!important}}"]}),n})(),o7=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-desarrollo-establecimientos"]],decls:7,vars:0,consts:[[1,"servicios-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),u._UZ(4,"img",4),u.qZA(),u.TgZ(5,"h1",5),u._uU(6,"ASISTENTE PROFESIONAL DE HOSTELER\xcdA"),u.qZA()()()())}}),n})();function s7(n,e){if(1&n&&(u.TgZ(0,"div",15)(1,"div",16)(2,"div",17),u._UZ(3,"img",18),u.qZA(),u.TgZ(4,"div",19),u._uU(5),u.qZA()()()),2&n){const t=e.$implicit;u.xp6(3),u.Q6J("src",t.iconPath,u.LSH),u.xp6(2),u.hij(" ",t.titulo," ")}}let a7=(()=>{class n{constructor(){this.vDatos=[{titulo:"Planificaci\xf3n Financiera",iconPath:"../../../assets/icons/icon-planificacion-financiera.png",datos:[]},{titulo:"Estrategias de Ahorro",iconPath:"../../../assets/icons/icon-estrategia-ahorro.png",datos:[]},{titulo:"Inversiones",iconPath:"../../../assets/icons/icon-inversiones.png",datos:[]},{titulo:"Acortamiento de Hipotecas",iconPath:"../../../assets/icons/icon-acortamiento-hipotecas.png",datos:[]},{titulo:"Pensiones / Jubilaci\xf3n",iconPath:"../../../assets/icons/icon-pensiones-jubilacion.png",datos:[]},{titulo:"B\xfasqueda de Financiaci\xf3n y Seguros",iconPath:"../../../assets/icons/icon-busqueda-financiacion.png",datos:[]}]}ngOnInit(){window.scroll({top:0,left:0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-consultoria-financiera"]],decls:21,vars:1,consts:[[1,"servicios-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"servicios-items-container"],[1,"title"],[1,"subtitle"],[1,"listado-servicios"],["class","item-list",4,"ngFor","ngForOf"],[1,"solicita-nuestros-servicios"],[1,"texto"],[1,"boton"],[1,"boton-contacta-con-nosotros"],[1,"item-list"],[1,"title-item-list"],[1,"icon"],[3,"src"],[1,"text"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),u._UZ(4,"img",4),u.qZA(),u.TgZ(5,"h1",5),u._uU(6," ASISTENTE PROFESIONAL DE HOSTELER\xcdA "),u.qZA()()(),u.TgZ(7,"div",6)(8,"div",7),u._uU(9,"Consultor\xeda Financiera"),u.qZA(),u.TgZ(10,"div",8),u._uU(11,"Servicios"),u.qZA(),u.TgZ(12,"div",9),u.YNc(13,s7,6,2,"div",10),u.qZA()(),u.TgZ(14,"div",11)(15,"div",12)(16,"div",7),u._uU(17,"\xbfQuieres solicitar nuestros servicios?"),u.qZA()(),u.TgZ(18,"div",13)(19,"button",14),u._uU(20,"Contacta con nosotros"),u.qZA()()()()),2&t&&(u.xp6(13),u.Q6J("ngForOf",i.vDatos))},dependencies:[Qi],styles:[".servicios-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;padding:100px 40px;width:calc(100% - 80px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:36px;min-width:800px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10% 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:30px;min-width:500px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10% 30px;border-bottom:1px solid var(--principal-color-80)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:50px;flex-direction:row;flex-wrap:wrap;min-width:950px;width:100%;margin-top:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{min-width:270px;max-width:330px;height:60px;width:27%;background-color:var(--principal-color-light);box-shadow:1px 2px 4px var(--principal-color-light-40);border-radius:10px;padding:30px 20px;display:flex;align-items:flex-start;justify-content:center;flex-direction:column;gap:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:flex-start;flex-direction:row;gap:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .title-item-list[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:22px;text-align:start;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;gap:10px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]   .content-item-list[_ngcontent-%COMP%]   .item-content-item-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]{padding:50px 0 100px}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .texto[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-size:36px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]{text-align:center}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]{font-size:20px;color:var(--principal-color);background-color:var(--principal-color-light);border:1px solid var(--principal-color);border-radius:10px;padding:10px 20px;margin-top:20px;cursor:pointer;transition:all .3s ease-in-out}.servicios-container[_ngcontent-%COMP%]   .solicita-nuestros-servicios[_ngcontent-%COMP%]   .boton[_ngcontent-%COMP%]   .boton-contacta-con-nosotros[_ngcontent-%COMP%]:hover{background-color:var(--principal-color);color:var(--principal-color-light)}@media screen and (min-width: 600px) and (max-width: 959px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{padding:100px 5px;width:calc(100% - 10px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;min-width:100%;padding:0 10px 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{min-width:100%;padding-left:0;padding-right:0}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{min-width:100%}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{width:100%}}@media screen and (max-width: 599px){.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:240px;height:auto}.servicios-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .cortinilla[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]{padding:100px 5px;width:calc(100% - 10px)}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;min-width:100%;padding:0 10px 30px}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{min-width:100%;padding-left:0;padding-right:0}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]{min-width:100%}.servicios-container[_ngcontent-%COMP%]   .servicios-items-container[_ngcontent-%COMP%]   .listado-servicios[_ngcontent-%COMP%]   .item-list[_ngcontent-%COMP%]{width:100%}}"]}),n})(),n2=(()=>{class n{constructor(t,i,r,s){this.firestore=t,this.db=i,this.auth=r,this.router=s}register(t,i){return this.auth.createUserWithEmailAndPassword(t,i)}login(t,i){return this.auth.signInWithEmailAndPassword(t,i)}logout(){return localStorage.removeItem("hasspro_internal_token"),this.auth.signOut()}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(GE),u.LFG(Z3),u.LFG(XR),u.LFG(Lo))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function l7(n,e){1&n&&(u.TgZ(0,"div",11),u._uU(1," * El email es obligatorio "),u.qZA())}function c7(n,e){1&n&&(u.TgZ(0,"div",11),u._uU(1," * La contrase\xf1a es obligatoria "),u.qZA())}function u7(n,e){1&n&&(u.TgZ(0,"div",12),u._uU(1," Error: Usuario / contrase\xf1a no existentes "),u.qZA())}let r2,d7=(()=>{class n{constructor(t,i,r){this.fb=t,this.authService=i,this.router=r,this.loging=!1,this.errorLogin=!1,this.formularioLogin=this.fb.group({email:["",[ar.required,ar.email]],password:["",[ar.required,ar.minLength(6)]]})}ngOnInit(){}onSubmit(){if(this.formularioLogin.invalid)return void this.formularioLogin.markAllAsTouched();this.loging=!0;const{email:t,password:i}=this.formularioLogin.value;this.authService.login(t,i).then(r=>{localStorage.setItem("hasspro_internal_token",r.user.uid),this.loging=!1,this.router.navigateByUrl("/private/email-list")},r=>{console.log(r),this.loging=!1,this.errorLogin=!0})}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(E),u.Y36(n2),u.Y36(Lo))},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-login"]],decls:19,vars:6,consts:[[1,"login-container"],[1,"form-container"],[3,"formGroup","submit"],[1,"input-group"],["for","nombre"],["type","text","id","email","formControlName","email"],["class","input-error",4,"ngIf"],["type","password","id","password","formControlName","password"],["class","correo-enviado-error",4,"ngIf"],[1,"submit-container"],["type","submit",3,"disabled"],[1,"input-error"],[1,"correo-enviado-error"]],template:function(t,i){if(1&t&&(u.TgZ(0,"div",0)(1,"div",1)(2,"h2"),u._uU(3,"Hasspro - Secci\xf3n privada"),u.qZA(),u.TgZ(4,"form",2),u.NdJ("submit",function(){return i.onSubmit()}),u.TgZ(5,"div",3)(6,"label",4),u._uU(7,"Email"),u.qZA(),u._UZ(8,"input",5),u.YNc(9,l7,2,0,"div",6),u.qZA(),u.TgZ(10,"div",3)(11,"label",4),u._uU(12,"Password"),u.qZA(),u._UZ(13,"input",7),u.YNc(14,c7,2,0,"div",6),u.qZA(),u.YNc(15,u7,2,0,"div",8),u.TgZ(16,"div",9)(17,"button",10),u._uU(18),u.qZA()()()()()),2&t){let r,s;u.xp6(4),u.Q6J("formGroup",i.formularioLogin),u.xp6(5),u.Q6J("ngIf",(null==(r=i.formularioLogin.get("email"))?null:r.touched)&&null!==(null==(r=i.formularioLogin.get("email"))?null:r.errors)),u.xp6(5),u.Q6J("ngIf",(null==(s=i.formularioLogin.get("password"))?null:s.touched)&&null!==(null==(s=i.formularioLogin.get("password"))?null:s.errors)),u.xp6(1),u.Q6J("ngIf",i.errorLogin),u.xp6(2),u.Q6J("disabled",i.loging),u.xp6(1),u.hij(" ",i.loging?"Iniciando sesi\xf3n...":"Iniciar sesi\xf3n"," ")}},dependencies:[Ro,f0,ym,hy,Dg,ba,Gg],styles:[".login-container[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background-color:var(--principal-color)}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{background-color:var(--principal-color-light);padding:20px;border-radius:10px;box-shadow:0 0 10px #000000bf;width:400px}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--principal-color);text-align:center;margin-bottom:30px}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:flex-start;width:500px;max-width:100%;gap:5px;flex-direction:column}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:var(--principal-color)}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:40px;padding:0 10px;border:1px solid var(--principal-color);border-radius:5px;box-sizing:border-box;font-size:14px;font-weight:700;color:var(--principal-color)}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;height:100px;padding:10px;border:1px solid var(--principal-color);border-radius:5px;box-sizing:border-box;font-size:14px;font-weight:700;resize:none;color:var(--principal-color)}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-error[_ngcontent-%COMP%]{color:red;font-size:12px}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;padding-top:10px}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:200px;height:40px;border:none;border-radius:5px;background-color:var(--principal-color);color:var(--white-color);font-size:16px;font-weight:700;cursor:pointer}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:var(--principal-color-light);color:var(--principal-color);border:2px solid var(--principal-color)}.login-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .correo-enviado-error[_ngcontent-%COMP%]{text-align:center;background-color:#eccbcb;width:90%;color:#000;font-size:14px;padding:10px;margin-top:10px;border-radius:10px;box-shadow:2px 2px 4px #00000020}"]}),n})();try{r2=typeof Intl<"u"&&Intl.v8BreakIterator}catch{r2=!1}let WE,TM,Pb,o2,Wl=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function bu(n){return n===no}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!r2)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(u.Lbi))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function YE(n){return function h7(){if(null==WE&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>WE=!0}))}finally{WE=WE||!1}return WE}()?n:!!n.capture}function Y3(){if(null==Pb){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Pb=!1,Pb;if("scrollBehavior"in document.documentElement.style)Pb=!0;else{const n=Element.prototype.scrollTo;Pb=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Pb}function KE(){if("object"!=typeof document||!document)return 0;if(null==TM){const n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),TM=0,0===n.scrollLeft&&(n.scrollLeft=1,TM=0===n.scrollLeft?1:2),n.remove()}return TM}function pv(n){return n.composedPath?n.composedPath()[0]:n.target}function s2(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function p1(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}function c2(n,e=NE){return(0,Xe.e)((t,i)=>{let r=null,s=null,f=null;const b=()=>{if(r){r.unsubscribe(),r=null;const O=s;s=null,i.next(O)}};function I(){const O=f+n,B=e.now();if(B<O)return r=this.schedule(void 0,O-B),void i.add(r);b()}t.subscribe((0,be.x)(i,O=>{s=O,f=e.now(),r||(r=e.schedule(I,n),i.add(r))},()=>{b(),i.complete()},void 0,()=>{s=r=null}))})}function eV(n){return Yt((e,t)=>n<=t)}var M7=De(5032);function Wo(n){return(0,Xe.e)((e,t)=>{(0,Ut.Xf)(n).subscribe((0,be.x)(t,()=>t.complete(),M7.Z)),!t.closed&&e.subscribe(t)})}function is(n){return null!=n&&"false"!=`${n}`}function m_(n,e=0){return tV(n)?Number(n):e}function tV(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}function MM(n){return Array.isArray(n)?n:[n]}function Ta(n){return null==n?"":"string"==typeof n?n:`${n}px`}function Ob(n){return n instanceof u.SBq?n.nativeElement:n}let nV=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),D7=(()=>{class n{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,i)=>this._cleanupObserver(i))}observe(t){const i=Ob(t);return new L.y(r=>{const f=this._observeElement(i).subscribe(r);return()=>{f.unsubscribe(),this._unobserveElement(i)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const i=new g.x,r=this._mutationObserverFactory.create(s=>i.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:i,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:i,stream:r}=this._observedElements.get(t);i&&i.disconnect(),r.complete(),this._observedElements.delete(t)}}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(nV))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),A7=(()=>{class n{get disabled(){return this._disabled}set disabled(t){this._disabled=is(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=m_(t),this._subscribe()}constructor(t,i,r){this._contentObserver=t,this._elementRef=i,this._ngZone=r,this.event=new u.vpe,this._disabled=!1,this._currentSubscription=null}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(c2(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(D7),u.Y36(u.SBq),u.Y36(u.R0b))},n.\u0275dir=u.lG2({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),iV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[nV]}),n})();const rV=new Set;let m1,P7=(()=>{class n{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):k7}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function O7(n){if(!rV.has(n))try{m1||(m1=document.createElement("style"),m1.setAttribute("type","text/css"),document.head.appendChild(m1)),m1.sheet&&(m1.sheet.insertRule(`@media ${n} {body{ }}`,0),rV.add(n))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Wl))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function k7(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let R7=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new g.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return oV(MM(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=Le(oV(MM(t)).map(f=>this._registerQuery(f).observable));return s=st(s.pipe(Wn(1)),s.pipe(eV(1),c2(0))),s.pipe((0,de.U)(f=>{const b={matches:!1,breakpoints:{}};return f.forEach(({matches:I,query:O})=>{b.matches=b.matches||I,b.breakpoints[O]=I}),b}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new L.y(f=>{const b=I=>this._zone.run(()=>f.next(I));return i.addListener(b),()=>{i.removeListener(b)}}).pipe(_n(i),(0,de.U)(({matches:f})=>({query:t,matches:f})),Wo(this._destroySubject)),mql:i};return this._queries.set(t,s),s}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(P7),u.LFG(u.R0b))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function oV(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}function DM(n,e){return(n.getAttribute(e)||"").match(/\S+/g)||[]}const aV="cdk-describedby-message",AM="cdk-describedby-host";let u2=0,lV=(()=>{class n{constructor(t,i){this._platform=i,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+u2++,this._document=t,this._id=(0,u.f3M)(u.AFp)+"-"+u2++}describe(t,i,r){if(!this._canBeDescribed(t,i))return;const s=d2(i,r);"string"!=typeof i?(cV(i,this._id),this._messageRegistry.set(s,{messageElement:i,referenceCount:0})):this._messageRegistry.has(s)||this._createMessageElement(i,r),this._isElementDescribedByMessage(t,s)||this._addMessageReference(t,s)}removeDescription(t,i,r){if(!i||!this._isElementNode(t))return;const s=d2(i,r);if(this._isElementDescribedByMessage(t,s)&&this._removeMessageReference(t,s),"string"==typeof i){const f=this._messageRegistry.get(s);f&&0===f.referenceCount&&this._deleteMessageElement(s)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const t=this._document.querySelectorAll(`[${AM}="${this._id}"]`);for(let i=0;i<t.length;i++)this._removeCdkDescribedByReferenceIds(t[i]),t[i].removeAttribute(AM);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(t,i){const r=this._document.createElement("div");cV(r,this._id),r.textContent=t,i&&r.setAttribute("role",i),this._createMessagesContainer(),this._messagesContainer.appendChild(r),this._messageRegistry.set(d2(t,i),{messageElement:r,referenceCount:0})}_deleteMessageElement(t){this._messageRegistry.get(t)?.messageElement?.remove(),this._messageRegistry.delete(t)}_createMessagesContainer(){if(this._messagesContainer)return;const t="cdk-describedby-message-container",i=this._document.querySelectorAll(`.${t}[platform="server"]`);for(let s=0;s<i.length;s++)i[s].remove();const r=this._document.createElement("div");r.style.visibility="hidden",r.classList.add(t),r.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&r.setAttribute("platform","server"),this._document.body.appendChild(r),this._messagesContainer=r}_removeCdkDescribedByReferenceIds(t){const i=DM(t,"aria-describedby").filter(r=>0!=r.indexOf(aV));t.setAttribute("aria-describedby",i.join(" "))}_addMessageReference(t,i){const r=this._messageRegistry.get(i);(function F7(n,e,t){const i=DM(n,e);i.some(r=>r.trim()==t.trim())||(i.push(t.trim()),n.setAttribute(e,i.join(" ")))})(t,"aria-describedby",r.messageElement.id),t.setAttribute(AM,this._id),r.referenceCount++}_removeMessageReference(t,i){const r=this._messageRegistry.get(i);r.referenceCount--,function L7(n,e,t){const r=DM(n,e).filter(s=>s!=t.trim());r.length?n.setAttribute(e,r.join(" ")):n.removeAttribute(e)}(t,"aria-describedby",r.messageElement.id),t.removeAttribute(AM)}_isElementDescribedByMessage(t,i){const r=DM(t,"aria-describedby"),s=this._messageRegistry.get(i),f=s&&s.messageElement.id;return!!f&&-1!=r.indexOf(f)}_canBeDescribed(t,i){if(!this._isElementNode(t))return!1;if(i&&"object"==typeof i)return!0;const r=null==i?"":`${i}`.trim(),s=t.getAttribute("aria-label");return!(!r||s&&s.trim()===r)}_isElementNode(t){return t.nodeType===this._document.ELEMENT_NODE}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(ft),u.LFG(Wl))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function d2(n,e){return"string"==typeof n?`${e||""}/${n}`:n}function cV(n,e){n.id||(n.id=`${aV}-${e}-${u2++}`)}class N7{constructor(e){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new g.x,this._typeaheadSubscription=qe.w0.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new g.x,this.change=new g.x,e instanceof u.n_E&&(this._itemChangesSubscription=e.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(vi(t=>this._pressedLetters.push(t)),c2(e),Yt(()=>this._pressedLetters.length>0),(0,de.U)(()=>this._pressedLetters.join(""))).subscribe(t=>{const i=this._getItemsArray();for(let r=1;r<i.length+1;r++){const s=(this._activeItemIndex+r)%i.length,f=i[s];if(!this._skipPredicateFn(f)&&0===f.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,t=10){return this._pageUpAndDown={enabled:e,delta:t},this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex+this._pageUpAndDown.delta,f=this._getItemsArray().length;this._setActiveItemByIndex(s<f?s:f-1,-1);break}return;default:return void((r||p1(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),i="number"==typeof e?e:t.indexOf(e);this._activeItem=t[i]??null,this._activeItemIndex=i}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const r=(this._activeItemIndex+e*i+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const i=this._getItemsArray();if(i[e]){for(;this._skipPredicateFn(i[e]);)if(!i[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return this._items instanceof u.n_E?this._items.toArray():this._items}}class z7 extends N7{setActiveItem(e){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(e),this.activeItem&&this.activeItem.setActiveStyles()}}function dV(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function hV(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const G7=new u.OlP("cdk-input-modality-detector-options"),H7={ignoreKeys:[18,17,224,91,16]},g1=YE({passive:!0,capture:!0});let q7=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new C(null),this._lastTouchMs=0,this._onKeydown=f=>{this._options?.ignoreKeys?.some(b=>b===f.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=pv(f))},this._onMousedown=f=>{Date.now()-this._lastTouchMs<650||(this._modality.next(dV(f)?"keyboard":"mouse"),this._mostRecentTarget=pv(f))},this._onTouchstart=f=>{hV(f)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=pv(f))},this._options={...H7,...s},this.modalityDetected=this._modality.pipe(eV(1)),this.modalityChanged=this.modalityDetected.pipe(wM()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,g1),r.addEventListener("mousedown",this._onMousedown,g1),r.addEventListener("touchstart",this._onTouchstart,g1)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,g1),document.removeEventListener("mousedown",this._onMousedown,g1),document.removeEventListener("touchstart",this._onTouchstart,g1))}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Wl),u.LFG(u.R0b),u.LFG(ft),u.LFG(G7,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Z7=new u.OlP("liveAnnouncerElement",{providedIn:"root",factory:function W7(){return null}}),Y7=new u.OlP("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let K7=0,X7=(()=>{class n{constructor(t,i,r,s){this._ngZone=i,this._defaultOptions=s,this._document=r,this._liveElement=t||this._createLiveElement()}announce(t,...i){const r=this._defaultOptions;let s,f;return 1===i.length&&"number"==typeof i[0]?f=i[0]:[s,f]=i,this.clear(),clearTimeout(this._previousTimeout),s||(s=r&&r.politeness?r.politeness:"polite"),null==f&&r&&(f=r.duration),this._liveElement.setAttribute("aria-live",s),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(b=>this._currentResolve=b)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,"number"==typeof f&&(this._previousTimeout=setTimeout(()=>this.clear(),f)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const t="cdk-live-announcer-element",i=this._document.getElementsByClassName(t),r=this._document.createElement("div");for(let s=0;s<i.length;s++)i[s].remove();return r.classList.add(t),r.classList.add("cdk-visually-hidden"),r.setAttribute("aria-atomic","true"),r.setAttribute("aria-live","polite"),r.id="cdk-live-announcer-"+K7++,this._document.body.appendChild(r),r}_exposeAnnouncerToModals(t){const i=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let r=0;r<i.length;r++){const s=i[r],f=s.getAttribute("aria-owns");f?-1===f.indexOf(t)&&s.setAttribute("aria-owns",f+" "+t):s.setAttribute("aria-owns",t)}}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Z7,8),u.LFG(u.R0b),u.LFG(ft),u.LFG(Y7,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Q7=new u.OlP("cdk-focus-monitor-default-options"),PM=YE({passive:!0,capture:!0});let h2=(()=>{class n{constructor(t,i,r,s,f){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new g.x,this._rootNodeFocusAndBlurListener=b=>{for(let O=pv(b);O;O=O.parentElement)"focus"===b.type?this._onFocus(b,O):this._onBlur(b,O)},this._document=s,this._detectionMode=f?.detectionMode||0}monitor(t,i=!1){const r=Ob(t);if(!this._platform.isBrowser||1!==r.nodeType)return c(null);const s=function p7(n){if(function f7(){if(null==o2){const n=typeof document<"u"?document.head:null;o2=!(!n||!n.createShadowRoot&&!n.attachShadow)}return o2}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),f=this._elementInfo.get(r);if(f)return i&&(f.checkChildren=!0),f.subject;const b={checkChildren:i,subject:new g.x,rootNode:s};return this._elementInfo.set(r,b),this._registerGlobalListeners(b),b.subject}stopMonitoring(t){const i=Ob(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=Ob(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([b,I])=>this._originChanged(b,i,I)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=pv(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,PM),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,PM)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Wo(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,PM),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,PM),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let f=0;f<s.length;f++)if(s[f].contains(i))return!0;return!1}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(u.R0b),u.LFG(Wl),u.LFG(q7),u.LFG(ft,8),u.LFG(Q7,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const pV="cdk-high-contrast-black-on-white",mV="cdk-high-contrast-white-on-black",f2="cdk-high-contrast-active";let gV=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=(0,u.f3M)(R7).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(f2,pV,mV),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(f2,pV):2===i&&t.add(f2,mV)}}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Wl),u.LFG(ft))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),J7=(()=>{class n{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(gV))},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[iV]}),n})();const eY=new u.OlP("cdk-dir-doc",{providedIn:"root",factory:function tY(){return(0,u.f3M)(ft)}}),nY=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let g_=(()=>{class n{constructor(t){this.value="ltr",this.change=new u.vpe,t&&(this.value=function iY(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?nY.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(eY,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),XE=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({}),n})();const rY=["text"];function oY(n,e){if(1&n&&u._UZ(0,"mat-pseudo-checkbox",6),2&n){const t=u.oxw();u.Q6J("state",t.selected?"checked":"unchecked")("disabled",t.disabled)}}function sY(n,e){if(1&n&&u._UZ(0,"mat-pseudo-checkbox",7),2&n){const t=u.oxw();u.Q6J("disabled",t.disabled)}}function aY(n,e){if(1&n&&(u.TgZ(0,"span",8),u._uU(1),u.qZA()),2&n){const t=u.oxw();u.xp6(1),u.hij("(",t.group.label,")")}}const lY=[[["mat-icon"]],"*"],cY=["mat-icon","*"];let uY=(()=>{class n{}return n.STANDARD_CURVE="cubic-bezier(0.4,0.0,0.2,1)",n.DECELERATION_CURVE="cubic-bezier(0.0,0.0,0.2,1)",n.ACCELERATION_CURVE="cubic-bezier(0.4,0.0,1,1)",n.SHARP_CURVE="cubic-bezier(0.4,0.0,0.6,1)",n})(),dY=(()=>{class n{}return n.COMPLEX="375ms",n.ENTERING="225ms",n.EXITING="195ms",n})();const fY=new u.OlP("mat-sanity-checks",{providedIn:"root",factory:function hY(){return!0}});let Ha=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!s2()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(gV),u.LFG(fY,8),u.LFG(ft))},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[XE,XE]}),n})();function QE(n){return class extends n{get disabled(){return this._disabled}set disabled(e){this._disabled=is(e)}constructor(...e){super(...e),this._disabled=!1}}}function p2(n,e){return class extends n{get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...t){super(...t),this.defaultColor=e,this.color=e}}}function vV(n){return class extends n{get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=is(e)}constructor(...e){super(...e),this._disableRipple=!1}}}function pY(n,e=0){return class extends n{get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?m_(t):this.defaultTabIndex}constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}}}function mY(n){return class extends n{updateErrorState(){const e=this.errorState,s=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);s!==e&&(this.errorState=s,this.stateChanges.next())}constructor(...e){super(...e),this.errorState=!1}}}function bV(n){return class extends n{constructor(...e){super(...e),this._isInitialized=!1,this._pendingSubscribers=[],this.initialized=new L.y(t=>{this._isInitialized?this._notifySubscriber(t):this._pendingSubscribers.push(t)})}_markInitialized(){this._isInitialized=!0,this._pendingSubscribers.forEach(this._notifySubscriber),this._pendingSubscribers=null}_notifySubscriber(e){e.next(),e.complete()}}}let _Y=(()=>{class n{isErrorState(t,i){return!!(t&&t.invalid&&(t.touched||i&&i.submitted))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class yY{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const xV=YE({passive:!0,capture:!0});class vY{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=pv(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){const s=this._events.get(t);if(s){const f=s.get(i);f?f.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,xV)})}removeHandler(e,t,i){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(i),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,xV)))}}const wV={enterDuration:225,exitDuration:150},CV=YE({passive:!0,capture:!0}),EV=["mousedown","touchstart"],TV=["mouseup","mouseleave","touchend","touchcancel"];class eT{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Ob(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...wV,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const f=i.radius||function xY(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),b=e-r.left,I=t-r.top,O=s.enterDuration,B=document.createElement("div");B.classList.add("mat-ripple-element"),B.style.left=b-f+"px",B.style.top=I-f+"px",B.style.height=2*f+"px",B.style.width=2*f+"px",null!=i.color&&(B.style.backgroundColor=i.color),B.style.transitionDuration=`${O}ms`,this._containerElement.appendChild(B);const K=window.getComputedStyle(B),ge=K.transitionDuration,Te="none"===K.transitionProperty||"0s"===ge||"0s, 0s"===ge||0===r.width&&0===r.height,Ge=new yY(this,B,i,Te);B.style.transform="scale3d(1, 1, 1)",Ge.state=0,i.persistent||(this._mostRecentTransientRipple=Ge);let Je=null;return!Te&&(O||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const Qt=()=>this._finishRippleTransition(Ge),xn=()=>this._destroyRipple(Ge);B.addEventListener("transitionend",Qt),B.addEventListener("transitioncancel",xn),Je={onTransitionEnd:Qt,onTransitionCancel:xn}}),this._activeRipples.set(Ge,Je),(Te||!O)&&this._finishRippleTransition(Ge),Ge}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,i={...wV,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Ob(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,EV.forEach(i=>{eT._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{TV.forEach(t=>{this._triggerElement.addEventListener(t,this,CV)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=1,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=dV(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!hV(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(EV.forEach(t=>eT._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&TV.forEach(t=>e.removeEventListener(t,this,CV)))}}eT._eventManager=new vY;const wY=new u.OlP("mat-ripple-global-options");let m2=(()=>{class n{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,f){this._elementRef=t,this._animationMode=f,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new eT(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq),u.Y36(u.R0b),u.Y36(Wl),u.Y36(wY,8),u.Y36(u.QbO,8))},n.\u0275dir=u.lG2({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&u.ekj("mat-ripple-unbounded",i.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),IV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[Ha,Ha]}),n})(),CY=(()=>{class n{constructor(t){this._animationMode=t,this.state="unchecked",this.disabled=!1,this.appearance="full"}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.QbO,8))},n.\u0275cmp=u.Xpm({type:n,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(t,i){2&t&&u.ekj("mat-pseudo-checkbox-indeterminate","indeterminate"===i.state)("mat-pseudo-checkbox-checked","checked"===i.state)("mat-pseudo-checkbox-disabled",i.disabled)("mat-pseudo-checkbox-minimal","minimal"===i.appearance)("mat-pseudo-checkbox-full","full"===i.appearance)("_mat-animation-noopable","NoopAnimations"===i._animationMode)},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},decls:0,vars:0,template:function(t,i){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-full{border:2px solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0}),n})(),EY=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[Ha]}),n})();const SV=new u.OlP("MAT_OPTION_PARENT_COMPONENT"),MV=new u.OlP("MatOptgroup");let TY=0;class IY{constructor(e,t=!1){this.source=e,this.isUserInput=t}}let SY=(()=>{class n{get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(t){this._disabled=is(t)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get hideSingleSelectionIndicator(){return!(!this._parent||!this._parent.hideSingleSelectionIndicator)}constructor(t,i,r,s){this._element=t,this._changeDetectorRef=i,this._parent=r,this.group=s,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+TY++,this.onSelectionChange=new u.vpe,this._stateChanges=new g.x}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(t,i){const r=this._getHostElement();"function"==typeof r.focus&&r.focus(i)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(t){(13===t.keyCode||32===t.keyCode)&&!p1(t)&&(this._selectViaInteraction(),t.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const t=this.viewValue;t!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=t)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(t=!1){this.onSelectionChange.emit(new IY(this,t))}}return n.\u0275fac=function(t){u.$Z()},n.\u0275dir=u.lG2({type:n,viewQuery:function(t,i){if(1&t&&u.Gf(rY,7),2&t){let r;u.iGM(r=u.CRH())&&(i._text=r.first)}},inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),n})(),DV=(()=>{class n extends SY{constructor(t,i,r,s){super(t,i,r,s)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq),u.Y36(u.sBO),u.Y36(SV,8),u.Y36(MV,8))},n.\u0275cmp=u.Xpm({type:n,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(t,i){1&t&&u.NdJ("click",function(){return i._selectViaInteraction()})("keydown",function(s){return i._handleKeydown(s)}),2&t&&(u.Ikx("id",i.id),u.uIk("aria-selected",i.selected)("aria-disabled",i.disabled.toString()),u.ekj("mdc-list-item--selected",i.selected)("mat-mdc-option-multiple",i.multiple)("mat-mdc-option-active",i.active)("mdc-list-item--disabled",i.disabled))},exportAs:["matOption"],features:[u.qOj],ngContentSelectors:cY,decls:8,vars:5,consts:[["class","mat-mdc-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mdc-list-item__primary-text"],["text",""],["class","mat-mdc-option-pseudo-checkbox","state","checked","appearance","minimal",3,"disabled",4,"ngIf"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-mdc-option-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-mdc-option-pseudo-checkbox",3,"state","disabled"],["state","checked","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"]],template:function(t,i){1&t&&(u.F$t(lY),u.YNc(0,oY,1,2,"mat-pseudo-checkbox",0),u.Hsn(1),u.TgZ(2,"span",1,2),u.Hsn(4,1),u.qZA(),u.YNc(5,sY,1,1,"mat-pseudo-checkbox",3),u.YNc(6,aY,2,1,"span",4),u._UZ(7,"div",5)),2&t&&(u.Q6J("ngIf",i.multiple),u.xp6(5),u.Q6J("ngIf",!i.multiple&&i.selected&&!i.hideSingleSelectionIndicator),u.xp6(1),u.Q6J("ngIf",i.group&&i.group._inert),u.xp6(1),u.Q6J("matRippleTrigger",i._getHostElement())("matRippleDisabled",i.disabled||i.disableRipple))},dependencies:[m2,Ro,CY],styles:['.mat-mdc-option{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);min-height:48px}.mat-mdc-option:focus{outline:none}[dir=rtl] .mat-mdc-option,.mat-mdc-option[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-option.mdc-list-item{align-items:center}.mat-mdc-option.mdc-list-item--disabled{opacity:.38;cursor:default}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}.cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{right:auto;left:16px}.mat-mdc-option-active .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),n})(),AV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[IV,ys,Ha,EY]}),n})();class PV{}class AY{}const __="*";function Gm(n,e){return{type:7,name:n,definitions:e,options:{}}}function ad(n,e=null){return{type:4,styles:e,timings:n}}function OV(n,e=null){return{type:2,steps:n,options:e}}function Po(n){return{type:6,styles:n,offset:null}}function Ic(n,e,t){return{type:0,name:n,styles:e,options:t}}function OM(n){return{type:5,steps:n}}function Sc(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}function kV(n=null){return{type:9,options:n}}function RV(n,e,t=null){return{type:11,selector:n,animation:e,options:t}}function FV(n){Promise.resolve().then(n)}class tT{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){FV(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class LV{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?FV(()=>this._onFinish()):this.players.forEach(f=>{f.onDone(()=>{++t==s&&this._onFinish()}),f.onDestroy(()=>{++i==s&&this._onDestroy()}),f.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((f,b)=>Math.max(f,b.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}const g2="!",PY=["mat-sort-header",""];function OY(n,e){if(1&n){const t=u.EpF();u.TgZ(0,"div",3),u.NdJ("@arrowPosition.start",function(){u.CHM(t);const r=u.oxw();return u.KtG(r._disableViewStateAnimation=!0)})("@arrowPosition.done",function(){u.CHM(t);const r=u.oxw();return u.KtG(r._disableViewStateAnimation=!1)}),u._UZ(1,"div",4),u.TgZ(2,"div",5),u._UZ(3,"div",6)(4,"div",7)(5,"div",8),u.qZA()()}if(2&n){const t=u.oxw();u.Q6J("@arrowOpacity",t._getArrowViewState())("@arrowPosition",t._getArrowViewState())("@allowChildren",t._getArrowDirectionState()),u.xp6(2),u.Q6J("@indicator",t._getArrowDirectionState()),u.xp6(1),u.Q6J("@leftPointer",t._getArrowDirectionState()),u.xp6(1),u.Q6J("@rightPointer",t._getArrowDirectionState())}}const kY=["*"],NV=new u.OlP("MAT_SORT_DEFAULT_OPTIONS"),RY=bV(QE(class{}));let _2=(()=>{class n extends RY{get direction(){return this._direction}set direction(t){this._direction=t}get disableClear(){return this._disableClear}set disableClear(t){this._disableClear=is(t)}constructor(t){super(),this._defaultOptions=t,this.sortables=new Map,this._stateChanges=new g.x,this.start="asc",this._direction="",this.sortChange=new u.vpe}register(t){this.sortables.set(t.id,t)}deregister(t){this.sortables.delete(t.id)}sort(t){this.active!=t.id?(this.active=t.id,this.direction=t.start?t.start:this.start):this.direction=this.getNextSortDirection(t),this.sortChange.emit({active:this.active,direction:this.direction})}getNextSortDirection(t){if(!t)return"";let r=function FY(n,e){let t=["asc","desc"];return"desc"==n&&t.reverse(),e||t.push(""),t}(t.start||this.start,t?.disableClear??this.disableClear??!!this._defaultOptions?.disableClear),s=r.indexOf(this.direction)+1;return s>=r.length&&(s=0),r[s]}ngOnInit(){this._markInitialized()}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(NV,8))},n.\u0275dir=u.lG2({type:n,selectors:[["","matSort",""]],hostAttrs:[1,"mat-sort"],inputs:{disabled:["matSortDisabled","disabled"],active:["matSortActive","active"],start:["matSortStart","start"],direction:["matSortDirection","direction"],disableClear:["matSortDisableClear","disableClear"]},outputs:{sortChange:"matSortChange"},exportAs:["matSort"],features:[u.qOj,u.TTD]}),n})();const mv=dY.ENTERING+" "+uY.STANDARD_CURVE,_1={indicator:Gm("indicator",[Ic("active-asc, asc",Po({transform:"translateY(0px)"})),Ic("active-desc, desc",Po({transform:"translateY(10px)"})),Sc("active-asc <=> active-desc",ad(mv))]),leftPointer:Gm("leftPointer",[Ic("active-asc, asc",Po({transform:"rotate(-45deg)"})),Ic("active-desc, desc",Po({transform:"rotate(45deg)"})),Sc("active-asc <=> active-desc",ad(mv))]),rightPointer:Gm("rightPointer",[Ic("active-asc, asc",Po({transform:"rotate(45deg)"})),Ic("active-desc, desc",Po({transform:"rotate(-45deg)"})),Sc("active-asc <=> active-desc",ad(mv))]),arrowOpacity:Gm("arrowOpacity",[Ic("desc-to-active, asc-to-active, active",Po({opacity:1})),Ic("desc-to-hint, asc-to-hint, hint",Po({opacity:.54})),Ic("hint-to-desc, active-to-desc, desc, hint-to-asc, active-to-asc, asc, void",Po({opacity:0})),Sc("* => asc, * => desc, * => active, * => hint, * => void",ad("0ms")),Sc("* <=> *",ad(mv))]),arrowPosition:Gm("arrowPosition",[Sc("* => desc-to-hint, * => desc-to-active",ad(mv,OM([Po({transform:"translateY(-25%)"}),Po({transform:"translateY(0)"})]))),Sc("* => hint-to-desc, * => active-to-desc",ad(mv,OM([Po({transform:"translateY(0)"}),Po({transform:"translateY(25%)"})]))),Sc("* => asc-to-hint, * => asc-to-active",ad(mv,OM([Po({transform:"translateY(25%)"}),Po({transform:"translateY(0)"})]))),Sc("* => hint-to-asc, * => active-to-asc",ad(mv,OM([Po({transform:"translateY(0)"}),Po({transform:"translateY(-25%)"})]))),Ic("desc-to-hint, asc-to-hint, hint, desc-to-active, asc-to-active, active",Po({transform:"translateY(0)"})),Ic("hint-to-desc, active-to-desc, desc",Po({transform:"translateY(-25%)"})),Ic("hint-to-asc, active-to-asc, asc",Po({transform:"translateY(25%)"}))]),allowChildren:Gm("allowChildren",[Sc("* <=> *",[RV("@*",kV(),{optional:!0})])])};let kM=(()=>{class n{constructor(){this.changes=new g.x}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const NY={provide:kM,deps:[[new u.FiY,new u.tp0,kM]],useFactory:function LY(n){return n||new kM}},zY=QE(class{});let BY=(()=>{class n extends zY{get sortActionDescription(){return this._sortActionDescription}set sortActionDescription(t){this._updateSortActionDescription(t)}get disableClear(){return this._disableClear}set disableClear(t){this._disableClear=is(t)}constructor(t,i,r,s,f,b,I,O){super(),this._intl=t,this._changeDetectorRef=i,this._sort=r,this._columnDef=s,this._focusMonitor=f,this._elementRef=b,this._ariaDescriber=I,this._showIndicatorHint=!1,this._viewState={},this._arrowDirection="",this._disableViewStateAnimation=!1,this.arrowPosition="after",this._sortActionDescription="Sort",O?.arrowPosition&&(this.arrowPosition=O?.arrowPosition),this._handleStateChanges()}ngOnInit(){!this.id&&this._columnDef&&(this.id=this._columnDef.name),this._updateArrowDirection(),this._setAnimationTransitionState({toState:this._isSorted()?"active":this._arrowDirection}),this._sort.register(this),this._sortButton=this._elementRef.nativeElement.querySelector(".mat-sort-header-container"),this._updateSortActionDescription(this._sortActionDescription)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{const i=!!t;i!==this._showIndicatorHint&&(this._setIndicatorHintVisible(i),this._changeDetectorRef.markForCheck())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._sort.deregister(this),this._rerenderSubscription.unsubscribe()}_setIndicatorHintVisible(t){this._isDisabled()&&t||(this._showIndicatorHint=t,this._isSorted()||(this._updateArrowDirection(),this._setAnimationTransitionState(this._showIndicatorHint?{fromState:this._arrowDirection,toState:"hint"}:{fromState:"hint",toState:this._arrowDirection})))}_setAnimationTransitionState(t){this._viewState=t||{},this._disableViewStateAnimation&&(this._viewState={toState:t.toState})}_toggleOnInteraction(){this._sort.sort(this),("hint"===this._viewState.toState||"active"===this._viewState.toState)&&(this._disableViewStateAnimation=!0)}_handleClick(){this._isDisabled()||this._sort.sort(this)}_handleKeydown(t){!this._isDisabled()&&(32===t.keyCode||13===t.keyCode)&&(t.preventDefault(),this._toggleOnInteraction())}_isSorted(){return this._sort.active==this.id&&("asc"===this._sort.direction||"desc"===this._sort.direction)}_getArrowDirectionState(){return`${this._isSorted()?"active-":""}${this._arrowDirection}`}_getArrowViewState(){const t=this._viewState.fromState;return(t?`${t}-to-`:"")+this._viewState.toState}_updateArrowDirection(){this._arrowDirection=this._isSorted()?this._sort.direction:this.start||this._sort.start}_isDisabled(){return this._sort.disabled||this.disabled}_getAriaSortAttribute(){return this._isSorted()?"asc"==this._sort.direction?"ascending":"descending":"none"}_renderArrow(){return!this._isDisabled()||this._isSorted()}_updateSortActionDescription(t){this._sortButton&&(this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription),this._ariaDescriber?.describe(this._sortButton,t)),this._sortActionDescription=t}_handleStateChanges(){this._rerenderSubscription=(0,p_.T)(this._sort.sortChange,this._sort._stateChanges,this._intl.changes).subscribe(()=>{this._isSorted()&&(this._updateArrowDirection(),("hint"===this._viewState.toState||"active"===this._viewState.toState)&&(this._disableViewStateAnimation=!0),this._setAnimationTransitionState({fromState:this._arrowDirection,toState:"active"}),this._showIndicatorHint=!1),!this._isSorted()&&this._viewState&&"active"===this._viewState.toState&&(this._disableViewStateAnimation=!1,this._setAnimationTransitionState({fromState:"active",toState:this._arrowDirection})),this._changeDetectorRef.markForCheck()})}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(kM),u.Y36(u.sBO),u.Y36(_2,8),u.Y36("MAT_SORT_HEADER_COLUMN_DEF",8),u.Y36(h2),u.Y36(u.SBq),u.Y36(lV,8),u.Y36(NV,8))},n.\u0275cmp=u.Xpm({type:n,selectors:[["","mat-sort-header",""]],hostAttrs:[1,"mat-sort-header"],hostVars:3,hostBindings:function(t,i){1&t&&u.NdJ("click",function(){return i._handleClick()})("keydown",function(s){return i._handleKeydown(s)})("mouseenter",function(){return i._setIndicatorHintVisible(!0)})("mouseleave",function(){return i._setIndicatorHintVisible(!1)}),2&t&&(u.uIk("aria-sort",i._getAriaSortAttribute()),u.ekj("mat-sort-header-disabled",i._isDisabled()))},inputs:{disabled:"disabled",id:["mat-sort-header","id"],arrowPosition:"arrowPosition",start:"start",sortActionDescription:"sortActionDescription",disableClear:"disableClear"},exportAs:["matSortHeader"],features:[u.qOj],attrs:PY,ngContentSelectors:kY,decls:4,vars:7,consts:[[1,"mat-sort-header-container","mat-focus-indicator"],[1,"mat-sort-header-content"],["class","mat-sort-header-arrow",4,"ngIf"],[1,"mat-sort-header-arrow"],[1,"mat-sort-header-stem"],[1,"mat-sort-header-indicator"],[1,"mat-sort-header-pointer-left"],[1,"mat-sort-header-pointer-right"],[1,"mat-sort-header-pointer-middle"]],template:function(t,i){1&t&&(u.F$t(),u.TgZ(0,"div",0)(1,"div",1),u.Hsn(2),u.qZA(),u.YNc(3,OY,6,6,"div",2),u.qZA()),2&t&&(u.ekj("mat-sort-header-sorted",i._isSorted())("mat-sort-header-position-before","before"===i.arrowPosition),u.uIk("tabindex",i._isDisabled()?null:0)("role",i._isDisabled()?null:"button"),u.xp6(3),u.Q6J("ngIf",i._renderArrow()))},dependencies:[Ro],styles:[".mat-sort-header-container{display:flex;cursor:pointer;align-items:center;letter-spacing:normal;outline:0}[mat-sort-header].cdk-keyboard-focused .mat-sort-header-container,[mat-sort-header].cdk-program-focused .mat-sort-header-container{border-bottom:solid 1px currentColor}.mat-sort-header-disabled .mat-sort-header-container{cursor:default}.mat-sort-header-container::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-sort-header-content{text-align:center;display:flex;align-items:center}.mat-sort-header-position-before{flex-direction:row-reverse}.mat-sort-header-arrow{height:12px;width:12px;min-width:12px;position:relative;display:flex;opacity:0}.mat-sort-header-arrow,[dir=rtl] .mat-sort-header-position-before .mat-sort-header-arrow{margin:0 0 0 6px}.mat-sort-header-position-before .mat-sort-header-arrow,[dir=rtl] .mat-sort-header-arrow{margin:0 6px 0 0}.mat-sort-header-stem{background:currentColor;height:10px;width:2px;margin:auto;display:flex;align-items:center}.cdk-high-contrast-active .mat-sort-header-stem{width:0;border-left:solid 2px}.mat-sort-header-indicator{width:100%;height:2px;display:flex;align-items:center;position:absolute;top:0;left:0}.mat-sort-header-pointer-middle{margin:auto;height:2px;width:2px;background:currentColor;transform:rotate(45deg)}.cdk-high-contrast-active .mat-sort-header-pointer-middle{width:0;height:0;border-top:solid 2px;border-left:solid 2px}.mat-sort-header-pointer-left,.mat-sort-header-pointer-right{background:currentColor;width:6px;height:2px;position:absolute;top:0}.cdk-high-contrast-active .mat-sort-header-pointer-left,.cdk-high-contrast-active .mat-sort-header-pointer-right{width:0;height:0;border-left:solid 6px;border-top:solid 2px}.mat-sort-header-pointer-left{transform-origin:right;left:0}.mat-sort-header-pointer-right{transform-origin:left;right:0}"],encapsulation:2,data:{animation:[_1.indicator,_1.leftPointer,_1.rightPointer,_1.arrowOpacity,_1.arrowPosition,_1.allowChildren]},changeDetection:0}),n})(),VY=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[NY],imports:[ys,Ha]}),n})();const jY=["mat-icon-button",""],$Y=["*"],GY=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],HY=p2(QE(vV(class{constructor(n){this._elementRef=n}})));let qY=(()=>{class n extends HY{constructor(t,i,r,s){super(t),this._platform=i,this._ngZone=r,this._animationMode=s,this._focusMonitor=(0,u.f3M)(h2),this._isFab=!1;const f=t.nativeElement.classList;for(const b of GY)this._hasHostAttributes(b.selector)&&b.mdcClasses.forEach(I=>{f.add(I)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_hasHostAttributes(...t){return t.some(i=>this._elementRef.nativeElement.hasAttribute(i))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return n.\u0275fac=function(t){u.$Z()},n.\u0275dir=u.lG2({type:n,viewQuery:function(t,i){if(1&t&&u.Gf(m2,5),2&t){let r;u.iGM(r=u.CRH())&&(i.ripple=r.first)}},features:[u.qOj]}),n})(),y2=(()=>{class n extends qY{constructor(t,i,r,s){super(t,i,r,s)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq),u.Y36(Wl),u.Y36(u.R0b),u.Y36(u.QbO,8))},n.\u0275cmp=u.Xpm({type:n,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(t,i){2&t&&(u.uIk("disabled",i.disabled||null),u.ekj("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-unthemed",!i.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[u.qOj],attrs:jY,ngContentSelectors:$Y,decls:5,vars:3,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(t,i){1&t&&(u.F$t(),u._UZ(0,"span",0),u.Hsn(1),u._UZ(2,"span",1)(3,"span",2)(4,"span",3)),2&t&&(u.xp6(3),u.Q6J("matRippleDisabled",i._isRippleDisabled())("matRippleCentered",!0)("matRippleTrigger",i._elementRef.nativeElement))},dependencies:[m2],styles:['.mdc-icon-button{font-size:24px;width:48px;height:48px;padding:12px}.mdc-icon-button .mdc-icon-button__focus-ring{max-height:48px;max-width:48px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:40px;height:40px;margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:40px;max-width:40px}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button svg,.mdc-icon-button img{width:24px;height:24px}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size, 48px);width:var(--mdc-icon-button-state-layer-size, 48px);color:var(--mdc-icon-button-icon-color, inherit);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity, 0.38)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color, #000)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),zV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[Ha,IV,Ha]}),n})();var YY=De(1144);const KY=["addListener","removeListener"],XY=["addEventListener","removeEventListener"],QY=["on","off"];function RM(n,e,t,i){if((0,at.m)(t)&&(i=t,t=void 0),i)return RM(n,e,t).pipe(ue(i));const[r,s]=function t9(n){return(0,at.m)(n.addEventListener)&&(0,at.m)(n.removeEventListener)}(n)?XY.map(f=>b=>n[f](e,b,t)):function JY(n){return(0,at.m)(n.addListener)&&(0,at.m)(n.removeListener)}(n)?KY.map(BV(n,e)):function e9(n){return(0,at.m)(n.on)&&(0,at.m)(n.off)}(n)?QY.map(BV(n,e)):[];if(!r&&(0,YY.z)(n))return(0,yn.z)(f=>RM(f,e,t))((0,Ut.Xf)(n));if(!r)throw new TypeError("Invalid event target");return new L.y(f=>{const b=(...I)=>f.next(1<I.length?I:I[0]);return r(b),()=>s(b)})}function BV(n,e){return t=>i=>n[t](e,i)}const nT={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=nT;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new qe.w0(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=nT;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=nT;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},r9=new class i9 extends hM{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class n9 extends dM{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=nT.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(nT.cancelAnimationFrame(t),e._scheduled=void 0)}});let v2,o9=1;const FM={};function VV(n){return n in FM&&(delete FM[n],!0)}const s9={setImmediate(n){const e=o9++;return FM[e]=!0,v2||(v2=Promise.resolve()),v2.then(()=>VV(e)&&n()),e},clearImmediate(n){VV(n)}},{setImmediate:a9,clearImmediate:l9}=s9,LM={setImmediate(...n){const{delegate:e}=LM;return(e?.setImmediate||a9)(...n)},clearImmediate(n){const{delegate:e}=LM;return(e?.clearImmediate||l9)(n)},delegate:void 0},d9=new class u9 extends hM{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class c9 extends dM{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=LM.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(LM.clearImmediate(t),e._scheduled=void 0)}});var f9=De(3532);function b2(n,e=NE){return function h9(n){return(0,Xe.e)((e,t)=>{let i=!1,r=null,s=null,f=!1;const b=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const O=r;r=null,t.next(O)}f&&t.complete()},I=()=>{s=null,f&&t.complete()};e.subscribe((0,be.x)(t,O=>{i=!0,r=O,s||(0,Ut.Xf)(n(O)).subscribe(s=(0,be.x)(t,b,I))},()=>{f=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>function m9(n=0,e,t=L8){let i=-1;return null!=e&&((0,f9.K)(e)?t=e:i=e),new L.y(r=>{let s=function p9(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let f=0;return t.schedule(function(){r.closed||(r.next(f++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(n,e))}const g9=["contentWrapper"],_9=["*"],y9=new u.OlP("VIRTUAL_SCROLL_STRATEGY");let iT=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new g.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new L.y(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(b2(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):c()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(Yt(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=Ob(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>RM(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(u.R0b),u.LFG(Wl),u.LFG(ft,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),UV=(()=>{class n{constructor(t,i,r,s){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=r,this.dir=s,this._destroyed=new g.x,this._elementScrolled=new L.y(f=>this.ngZone.runOutsideAngular(()=>RM(this.elementRef.nativeElement,"scroll").pipe(Wo(this._destroyed)).subscribe(f)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const i=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),r&&0!=KE()?(null!=t.left&&(t.right=i.scrollWidth-i.clientWidth-t.left),2==KE()?t.left=t.right:1==KE()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const i=this.elementRef.nativeElement;Y3()?i.scrollTo(t):(null!=t.top&&(i.scrollTop=t.top),null!=t.left&&(i.scrollLeft=t.left))}measureScrollOffset(t){const i="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const f=this.dir&&"rtl"==this.dir.value;return"start"==t?t=f?r:i:"end"==t&&(t=f?i:r),f&&2==KE()?t==i?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:f&&1==KE()?t==i?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==i?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq),u.Y36(iT),u.Y36(u.R0b),u.Y36(g_,8))},n.\u0275dir=u.lG2({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),n})(),rT=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new g.x,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(b2(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Wl),u.LFG(u.R0b),u.LFG(ft,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const jV=new u.OlP("VIRTUAL_SCROLLABLE");let x9=(()=>{class n extends UV{constructor(t,i,r,s){super(t,i,r,s)}measureViewportSize(t){const i=this.elementRef.nativeElement;return"horizontal"===t?i.clientWidth:i.clientHeight}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq),u.Y36(iT),u.Y36(u.R0b),u.Y36(g_,8))},n.\u0275dir=u.lG2({type:n,features:[u.qOj]}),n})();const C9=typeof requestAnimationFrame<"u"?r9:d9;let E9=(()=>{class n extends x9{get orientation(){return this._orientation}set orientation(t){this._orientation!==t&&(this._orientation=t,this._calculateSpacerSize())}get appendOnly(){return this._appendOnly}set appendOnly(t){this._appendOnly=is(t)}constructor(t,i,r,s,f,b,I,O){super(t,b,r,f),this.elementRef=t,this._changeDetectorRef=i,this._scrollStrategy=s,this.scrollable=O,this._platform=(0,u.f3M)(Wl),this._detachedSubject=new g.x,this._renderedRangeSubject=new g.x,this._orientation="vertical",this._appendOnly=!1,this.scrolledIndexChange=new L.y(B=>this._scrollStrategy.scrolledIndexChange.subscribe(K=>Promise.resolve().then(()=>this.ngZone.run(()=>B.next(K))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=qe.w0.EMPTY,this._viewportChanges=I.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe(_n(null),b2(0,C9)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(t){this.ngZone.runOutsideAngular(()=>{this._forOf=t,this._forOf.dataStream.pipe(Wo(this._detachedSubject)).subscribe(i=>{const r=i.length;r!==this._dataLength&&(this._dataLength=r,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(t){return this.getElementRef().nativeElement.getBoundingClientRect()[t]}setTotalContentSize(t){this._totalContentSize!==t&&(this._totalContentSize=t,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(t){(function w9(n,e){return n.start==e.start&&n.end==e.end})(this._renderedRange,t)||(this.appendOnly&&(t={start:0,end:Math.max(this._renderedRange.end,t.end)}),this._renderedRangeSubject.next(this._renderedRange=t),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(t,i="to-start"){t=this.appendOnly&&"to-start"===i?0:t;const s="horizontal"==this.orientation,f=s?"X":"Y";let I=`translate${f}(${Number((s&&this.dir&&"rtl"==this.dir.value?-1:1)*t)}px)`;this._renderedContentOffset=t,"to-end"===i&&(I+=` translate${f}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=I&&(this._renderedContentTransform=I,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(t,i="auto"){const r={behavior:i};"horizontal"===this.orientation?r.start=t:r.top=t,this.scrollable.scrollTo(r)}scrollToIndex(t,i="auto"){this._scrollStrategy.scrollToIndex(t,i)}measureScrollOffset(t){let i;return i=this.scrollable==this?r=>super.measureScrollOffset(r):r=>this.scrollable.measureScrollOffset(r),Math.max(0,i(t??("horizontal"===this.orientation?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(t){let i;const r="left",s="right",f="rtl"==this.dir?.value;i="start"==t?f?s:r:"end"==t?f?r:s:t||("horizontal"===this.orientation?"left":"top");const b=this.scrollable.measureBoundingClientRectWithScrollOffset(i);return this.elementRef.nativeElement.getBoundingClientRect()[i]-b}measureRenderedContentSize(){const t=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?t.offsetWidth:t.offsetHeight}measureRangeSize(t){return this._forOf?this._forOf.measureRangeSize(t,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(t){t&&this._runAfterChangeDetection.push(t),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const t=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const i of t)i()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq),u.Y36(u.sBO),u.Y36(u.R0b),u.Y36(y9,8),u.Y36(g_,8),u.Y36(iT),u.Y36(rT),u.Y36(jV,8))},n.\u0275cmp=u.Xpm({type:n,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(t,i){if(1&t&&u.Gf(g9,7),2&t){let r;u.iGM(r=u.CRH())&&(i._contentWrapper=r.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(t,i){2&t&&u.ekj("cdk-virtual-scroll-orientation-horizontal","horizontal"===i.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==i.orientation)},inputs:{orientation:"orientation",appendOnly:"appendOnly"},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[u._Bn([{provide:UV,useFactory:(e,t)=>e||t,deps:[[new u.FiY,new u.tBr(jV)],n]}]),u.qOj,u.jDz],ngContentSelectors:_9,decls:4,vars:4,consts:[[1,"cdk-virtual-scroll-content-wrapper"],["contentWrapper",""],[1,"cdk-virtual-scroll-spacer"]],template:function(t,i){1&t&&(u.F$t(),u.TgZ(0,"div",0,1),u.Hsn(2),u.qZA(),u._UZ(3,"div",2)),2&t&&(u.xp6(3),u.Udp("width",i._totalContentWidth)("height",i._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0}),n})(),NM=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({}),n})(),x2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[XE,NM,E9,XE,NM]}),n})();class w2{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class $V extends w2{constructor(e,t,i,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class GV extends w2{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class T9 extends w2{constructor(e){super(),this.element=e instanceof u.SBq?e.nativeElement:e}}class I9{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof $V?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof GV?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof T9?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class S9 extends I9{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=f=>{const b=f.element,I=this._document.createComment("dom-portal");b.parentNode.insertBefore(I,b),this.outletElement.appendChild(b),this._attachedPortal=f,super.setDisposeFn(()=>{I.parentNode&&I.parentNode.replaceChild(b,I)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||u.zs3.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let M9=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({}),n})();const HV=Y3();class D9{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=Ta(-this._previousScrollPosition.left),e.style.top=Ta(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",f=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),HV&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),HV&&(i.scrollBehavior=s,r.scrollBehavior=f)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class A9{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(Yt(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class qV{enable(){}disable(){}attach(){}}function C2(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function ZV(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class P9{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();C2(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let O9=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new qV,this.close=f=>new A9(this._scrollDispatcher,this._ngZone,this._viewportRuler,f),this.block=()=>new D9(this._viewportRuler,this._document),this.reposition=f=>new P9(this._scrollDispatcher,this._viewportRuler,this._ngZone,f),this._document=s}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(iT),u.LFG(rT),u.LFG(u.R0b),u.LFG(ft))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class WV{constructor(e){if(this.scrollStrategy=new qV,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class k9{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let YV=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(ft))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),R9=(()=>{class n extends YV{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let f=s.length-1;f>-1;f--)if(s[f]._keydownEvents.observers.length>0){const b=s[f]._keydownEvents;this._ngZone?this._ngZone.run(()=>b.next(r)):b.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(ft),u.LFG(u.R0b,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),F9=(()=>{class n extends YV{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=pv(s)},this._clickListener=s=>{const f=pv(s),b="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:f;this._pointerDownEventTarget=null;const I=this._attachedOverlays.slice();for(let O=I.length-1;O>-1;O--){const B=I[O];if(B._outsidePointerEvents.observers.length<1||!B.hasAttached())continue;if(B.overlayElement.contains(f)||B.overlayElement.contains(b))break;const K=B._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>K.next(s)):K.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(ft),u.LFG(Wl),u.LFG(u.R0b,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),KV=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||s2()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),s2()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(ft),u.LFG(Wl))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class L9{constructor(e,t,i,r,s,f,b,I,O,B=!1){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=f,this._document=b,this._location=I,this._outsideClickDispatcher=O,this._animationsDisabled=B,this._backdropElement=null,this._backdropClick=new g.x,this._attachments=new g.x,this._detachments=new g.x,this._locationChanges=qe.w0.EMPTY,this._backdropClickHandler=K=>this._backdropClick.next(K),this._backdropTransitionendHandler=K=>{this._disposeBackdrop(K.target)},this._keydownEvents=new g.x,this._outsidePointerEvents=new g.x,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Wn(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=Ta(this._config.width),e.height=Ta(this._config.height),e.minWidth=Ta(this._config.minWidth),e.minHeight=Ta(this._config.minHeight),e.maxWidth=Ta(this._config.maxWidth),e.maxHeight=Ta(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){const r=MM(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(Wo((0,p_.T)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const XV="cdk-overlay-connected-position-bounding-box",N9=/([A-Za-z%]+)$/;class z9{get positions(){return this._preferredPositions}constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new g.x,this._resizeSubscription=qe.w0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(XV),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let f;for(let b of this._preferredPositions){let I=this._getOriginPoint(e,r,b),O=this._getOverlayPoint(I,t,b),B=this._getOverlayFit(O,t,i,b);if(B.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(b,I);this._canFitWithFlexibleDimensions(B,O,i)?s.push({position:b,origin:I,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(I,b)}):(!f||f.overlayFit.visibleArea<B.visibleArea)&&(f={overlayFit:B,overlayPoint:O,originPoint:I,position:b,overlayRect:t})}if(s.length){let b=null,I=-1;for(const O of s){const B=O.boundingBoxRect.width*O.boundingBoxRect.height*(O.position.weight||1);B>I&&(I=B,b=O)}return this._isPushed=!1,void this._applyPosition(b.position,b.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(f.position,f.originPoint);this._applyPosition(f.position,f.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&kb(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(XV),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const f=this._isRtl()?e.right:e.left,b=this._isRtl()?e.left:e.right;r="start"==i.originX?f:b}return t.left<0&&(r-=t.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=JV(t);let{x:f,y:b}=e,I=this._getOffset(r,"x"),O=this._getOffset(r,"y");I&&(f+=I),O&&(b+=O);let le=0-b,ge=b+s.height-i.height,Te=this._subtractOverflows(s.width,0-f,f+s.width-i.width),Ge=this._subtractOverflows(s.height,le,ge),Je=Te*Ge;return{visibleArea:Je,isCompletelyWithinViewport:s.width*s.height===Je,fitsInViewportVertically:Ge===s.height,fitsInViewportHorizontally:Te==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,f=QV(this._overlayRef.getConfig().minHeight),b=QV(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=f&&f<=r)&&(e.fitsInViewportHorizontally||null!=b&&b<=s)}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=JV(t),s=this._viewportRect,f=Math.max(e.x+r.width-s.width,0),b=Math.max(e.y+r.height-s.height,0),I=Math.max(s.top-i.top-e.y,0),O=Math.max(s.left-i.left-e.x,0);let B=0,K=0;return B=r.width<=s.width?O||-f:e.x<this._viewportMargin?s.left-i.left-e.x:0,K=r.height<=s.height?I||-b:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:B,y:K},{x:e.x+B,y:e.y+K}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new k9(e,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,f,b,B,K,le;if("top"===t.overlayY)f=e.y,s=i.height-f+this._viewportMargin;else if("bottom"===t.overlayY)b=i.height-e.y+2*this._viewportMargin,s=i.height-b+this._viewportMargin;else{const ge=Math.min(i.bottom-e.y+i.top,e.y),Te=this._lastBoundingBoxSize.height;s=2*ge,f=e.y-ge,s>Te&&!this._isInitialRender&&!this._growAfterOpen&&(f=e.y-Te/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)le=i.width-e.x+this._viewportMargin,B=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)K=e.x,B=i.right-e.x;else{const ge=Math.min(i.right-e.x+i.left,e.x),Te=this._lastBoundingBoxSize.width;B=2*ge,K=e.x-ge,B>Te&&!this._isInitialRender&&!this._growAfterOpen&&(K=e.x-Te/2)}return{top:f,left:K,bottom:b,right:le,width:B,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,f=this._overlayRef.getConfig().maxWidth;r.height=Ta(i.height),r.top=Ta(i.top),r.bottom=Ta(i.bottom),r.width=Ta(i.width),r.left=Ta(i.left),r.right=Ta(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=Ta(s)),f&&(r.maxWidth=Ta(f))}this._lastBoundingBoxSize=i,kb(this._boundingBox.style,r)}_resetBoundingBoxStyles(){kb(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){kb(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,f=this._overlayRef.getConfig();if(r){const B=this._viewportRuler.getViewportScrollPosition();kb(i,this._getExactOverlayY(t,e,B)),kb(i,this._getExactOverlayX(t,e,B))}else i.position="static";let b="",I=this._getOffset(t,"x"),O=this._getOffset(t,"y");I&&(b+=`translateX(${I}px) `),O&&(b+=`translateY(${O}px)`),i.transform=b.trim(),f.maxHeight&&(r?i.maxHeight=Ta(f.maxHeight):s&&(i.maxHeight="")),f.maxWidth&&(r?i.maxWidth=Ta(f.maxWidth):s&&(i.maxWidth="")),kb(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=Ta(s.y),r}_getExactOverlayX(e,t,i){let f,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),f=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===f?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=Ta(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:ZV(e,i),isOriginOutsideView:C2(e,i),isOverlayClipped:ZV(t,i),isOverlayOutsideView:C2(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&MM(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof u.SBq)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function kb(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function QV(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(N9);return t&&"px"!==t?null:parseFloat(e)}return n||null}function JV(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const eU="cdk-global-overlay-wrapper";class B9{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(eU),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:f,maxHeight:b}=i,I=!("100%"!==r&&"100vw"!==r||f&&"100%"!==f&&"100vw"!==f),O=!("100%"!==s&&"100vh"!==s||b&&"100%"!==b&&"100vh"!==b),B=this._xPosition,K=this._xOffset,le="rtl"===this._overlayRef.getConfig().direction;let ge="",Te="",Ge="";I?Ge="flex-start":"center"===B?(Ge="center",le?Te=K:ge=K):le?"left"===B||"end"===B?(Ge="flex-end",ge=K):("right"===B||"start"===B)&&(Ge="flex-start",Te=K):"left"===B||"start"===B?(Ge="flex-start",ge=K):("right"===B||"end"===B)&&(Ge="flex-end",Te=K),e.position=this._cssPosition,e.marginLeft=I?"0":ge,e.marginTop=O?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=I?"0":Te,t.justifyContent=Ge,t.alignItems=O?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(eU),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let V9=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new B9}flexibleConnectedTo(t){return new z9(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(rT),u.LFG(ft),u.LFG(Wl),u.LFG(KV))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),U9=0,y1=(()=>{class n{constructor(t,i,r,s,f,b,I,O,B,K,le,ge){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=f,this._injector=b,this._ngZone=I,this._document=O,this._directionality=B,this._location=K,this._outsideClickDispatcher=le,this._animationsModuleType=ge}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),f=new WV(t);return f.direction=f.direction||this._directionality.value,new L9(s,i,r,f,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+U9++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(u.z2F)),new S9(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(O9),u.LFG(KV),u.LFG(u._Vd),u.LFG(V9),u.LFG(R9),u.LFG(u.zs3),u.LFG(u.R0b),u.LFG(ft),u.LFG(g_),u.LFG(Jt),u.LFG(F9),u.LFG(u.QbO,8))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const j9=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],tU=new u.OlP("cdk-connected-overlay-scroll-strategy");let E2=(()=>{class n{constructor(t){this.elementRef=t}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq))},n.\u0275dir=u.lG2({type:n,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0}),n})(),nU=(()=>{class n{get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(t){this._hasBackdrop=is(t)}get lockPosition(){return this._lockPosition}set lockPosition(t){this._lockPosition=is(t)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(t){this._flexibleDimensions=is(t)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(t){this._growAfterOpen=is(t)}get push(){return this._push}set push(t){this._push=is(t)}constructor(t,i,r,s,f){this._overlay=t,this._dir=f,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=qe.w0.EMPTY,this._attachSubscription=qe.w0.EMPTY,this._detachSubscription=qe.w0.EMPTY,this._positionSubscription=qe.w0.EMPTY,this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.backdropClick=new u.vpe,this.positionChange=new u.vpe,this.attach=new u.vpe,this.detach=new u.vpe,this.overlayKeydown=new u.vpe,this.overlayOutsideClick=new u.vpe,this._templatePortal=new GV(i,r),this._scrollStrategyFactory=s,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(t){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),t.origin&&this.open&&this._position.apply()),t.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=j9);const t=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=t.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=t.detachments().subscribe(()=>this.detach.emit()),t.keydownEvents().subscribe(i=>{this.overlayKeydown.next(i),27===i.keyCode&&!this.disableClose&&!p1(i)&&(i.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(i=>{this.overlayOutsideClick.next(i)})}_buildConfig(){const t=this._position=this.positionStrategy||this._createPositionStrategy(),i=new WV({direction:this._dir,positionStrategy:t,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(i.width=this.width),(this.height||0===this.height)&&(i.height=this.height),(this.minWidth||0===this.minWidth)&&(i.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(i.minHeight=this.minHeight),this.backdropClass&&(i.backdropClass=this.backdropClass),this.panelClass&&(i.panelClass=this.panelClass),i}_updatePositionStrategy(t){const i=this.positions.map(r=>({originX:r.originX,originY:r.originY,overlayX:r.overlayX,overlayY:r.overlayY,offsetX:r.offsetX||this.offsetX,offsetY:r.offsetY||this.offsetY,panelClass:r.panelClass||void 0}));return t.setOrigin(this._getFlexibleConnectedPositionStrategyOrigin()).withPositions(i).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const t=this._overlay.position().flexibleConnectedTo(this._getFlexibleConnectedPositionStrategyOrigin());return this._updatePositionStrategy(t),t}_getFlexibleConnectedPositionStrategyOrigin(){return this.origin instanceof E2?this.origin.elementRef:this.origin}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(t=>{this.backdropClick.emit(t)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(sr(()=>this.positionChange.observers.length>0)).subscribe(t=>{this.positionChange.emit(t),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(y1),u.Y36(u.Rgc),u.Y36(u.s_b),u.Y36(tU),u.Y36(g_,8))},n.\u0275dir=u.lG2({type:n,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:["cdkConnectedOverlayOrigin","origin"],positions:["cdkConnectedOverlayPositions","positions"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:["cdkConnectedOverlayOpen","open"],disableClose:["cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[u.TTD]}),n})();const G9={provide:tU,deps:[y1],useFactory:function $9(n){return()=>n.scrollStrategies.reposition()}};let iU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[y1,G9],imports:[XE,M9,x2,x2]}),n})();const H9=["matFormFieldNotchedOutline",""],q9=["*"],Z9=["textField"],W9=["iconPrefixContainer"],Y9=["textPrefixContainer"];function K9(n,e){1&n&&u._UZ(0,"span",19)}function X9(n,e){if(1&n){const t=u.EpF();u.TgZ(0,"label",17),u.NdJ("cdkObserveContent",function(){u.CHM(t);const r=u.oxw(2);return u.KtG(r._refreshOutlineNotchWidth())}),u.Hsn(1,1),u.YNc(2,K9,1,0,"span",18),u.qZA()}if(2&n){const t=u.oxw(2);u.Q6J("floating",t._shouldLabelFloat())("cdkObserveContentDisabled",!t._hasOutline())("id",t._labelId),u.uIk("for",t._control.id)("aria-owns",t._control.id),u.xp6(2),u.Q6J("ngIf",!t.hideRequiredMarker&&t._control.required)}}function Q9(n,e){if(1&n&&u.YNc(0,X9,3,6,"label",16),2&n){const t=u.oxw();u.Q6J("ngIf",t._hasFloatingLabel())}}function J9(n,e){1&n&&u._UZ(0,"div",20)}function eK(n,e){}function tK(n,e){if(1&n&&u.YNc(0,eK,0,0,"ng-template",22),2&n){u.oxw(2);const t=u.MAs(1);u.Q6J("ngTemplateOutlet",t)}}function nK(n,e){if(1&n&&(u.TgZ(0,"div",21),u.YNc(1,tK,1,1,"ng-template",9),u.qZA()),2&n){const t=u.oxw();u.Q6J("matFormFieldNotchedOutlineOpen",t._shouldLabelFloat())("matFormFieldNotchedOutlineLabelWidth",t._labelWidth),u.xp6(1),u.Q6J("ngIf",!t._forceDisplayInfixLabel())}}function iK(n,e){1&n&&(u.TgZ(0,"div",23,24),u.Hsn(2,2),u.qZA())}function rK(n,e){1&n&&(u.TgZ(0,"div",25,26),u.Hsn(2,3),u.qZA())}function oK(n,e){}function sK(n,e){if(1&n&&u.YNc(0,oK,0,0,"ng-template",22),2&n){u.oxw();const t=u.MAs(1);u.Q6J("ngTemplateOutlet",t)}}function aK(n,e){1&n&&(u.TgZ(0,"div",27),u.Hsn(1,4),u.qZA())}function lK(n,e){1&n&&(u.TgZ(0,"div",28),u.Hsn(1,5),u.qZA())}function cK(n,e){1&n&&u._UZ(0,"div",29)}function uK(n,e){if(1&n&&(u.TgZ(0,"div",30),u.Hsn(1,6),u.qZA()),2&n){const t=u.oxw();u.Q6J("@transitionMessages",t._subscriptAnimationState)}}function dK(n,e){if(1&n&&(u.TgZ(0,"mat-hint",34),u._uU(1),u.qZA()),2&n){const t=u.oxw(2);u.Q6J("id",t._hintLabelId),u.xp6(1),u.Oqu(t.hintLabel)}}function hK(n,e){if(1&n&&(u.TgZ(0,"div",31),u.YNc(1,dK,2,2,"mat-hint",32),u.Hsn(2,7),u._UZ(3,"div",33),u.Hsn(4,8),u.qZA()),2&n){const t=u.oxw();u.Q6J("@transitionMessages",t._subscriptAnimationState),u.xp6(1),u.Q6J("ngIf",t.hintLabel)}}const fK=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],pK=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];let rU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=u.lG2({type:n,selectors:[["mat-label"]]}),n})();const mK=new u.OlP("MatError");let gK=0,oU=(()=>{class n{constructor(){this.align="start",this.id="mat-mdc-hint-"+gK++}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=u.lG2({type:n,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(t,i){2&t&&(u.Ikx("id",i.id),u.uIk("align",null),u.ekj("mat-mdc-form-field-hint-end","end"===i.align))},inputs:{align:"align",id:"id"}}),n})();const _K=new u.OlP("MatPrefix"),yK=new u.OlP("MatSuffix");let sU=(()=>{class n{constructor(t){this._elementRef=t,this.floating=!1}getWidth(){return function vK(n){if(null!==n.offsetParent)return n.scrollWidth;const t=n.cloneNode(!0);t.style.setProperty("position","absolute"),t.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(t);const i=t.scrollWidth;return t.remove(),i}(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq))},n.\u0275dir=u.lG2({type:n,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(t,i){2&t&&u.ekj("mdc-floating-label--float-above",i.floating)},inputs:{floating:"floating"}}),n})();const aU="mdc-line-ripple--active",zM="mdc-line-ripple--deactivating";let lU=(()=>{class n{constructor(t,i){this._elementRef=t,this._handleTransitionEnd=r=>{const s=this._elementRef.nativeElement.classList,f=s.contains(zM);"opacity"===r.propertyName&&f&&s.remove(aU,zM)},i.runOutsideAngular(()=>{t.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){const t=this._elementRef.nativeElement.classList;t.remove(zM),t.add(aU)}deactivate(){this._elementRef.nativeElement.classList.add(zM)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq),u.Y36(u.R0b))},n.\u0275dir=u.lG2({type:n,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]}),n})(),cU=(()=>{class n{constructor(t,i){this._elementRef=t,this._ngZone=i,this.labelWidth=0,this.open=!1}ngAfterViewInit(){const t=this._elementRef.nativeElement.querySelector(".mdc-floating-label");t?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),"function"==typeof requestAnimationFrame&&(t.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>t.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_getNotchWidth(){return this.open?this.labelWidth>0?`calc(${this.labelWidth}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`:"0px":null}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq),u.Y36(u.R0b))},n.\u0275cmp=u.Xpm({type:n,selectors:[["div","matFormFieldNotchedOutline",""]],hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(t,i){2&t&&u.ekj("mdc-notched-outline--notched",i.open)},inputs:{labelWidth:["matFormFieldNotchedOutlineLabelWidth","labelWidth"],open:["matFormFieldNotchedOutlineOpen","open"]},attrs:H9,ngContentSelectors:q9,decls:4,vars:2,consts:[[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(t,i){1&t&&(u.F$t(),u._UZ(0,"div",0),u.TgZ(1,"div",1),u.Hsn(2),u.qZA(),u._UZ(3,"div",2)),2&t&&(u.xp6(1),u.Udp("width",i._getNotchWidth()))},encapsulation:2,changeDetection:0}),n})();const bK={transitionMessages:Gm("transitionMessages",[Ic("enter",Po({opacity:1,transform:"translateY(0%)"})),Sc("void => enter",[Po({opacity:0,transform:"translateY(-5px)"}),ad("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let uU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=u.lG2({type:n}),n})();const dU=new u.OlP("MatFormField"),xK=new u.OlP("MAT_FORM_FIELD_DEFAULT_OPTIONS");let hU=0,EK=(()=>{class n{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(t){this._hideRequiredMarker=is(t)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||"auto"}set floatLabel(t){t!==this._floatLabel&&(this._floatLabel=t,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(t){const i=this._appearance;this._appearance=t||this._defaults?.appearance||"fill","outline"===this._appearance&&this._appearance!==i&&(this._refreshOutlineNotchWidth(),this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||"fixed"}set subscriptSizing(t){this._subscriptSizing=t||this._defaults?.subscriptSizing||"fixed"}get hintLabel(){return this._hintLabel}set hintLabel(t){this._hintLabel=t,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(t){this._explicitFormFieldControl=t}constructor(t,i,r,s,f,b,I,O){this._elementRef=t,this._changeDetectorRef=i,this._ngZone=r,this._dir=s,this._platform=f,this._defaults=b,this._animationMode=I,this._document=O,this._hideRequiredMarker=!1,this.color="primary",this._appearance="fill",this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId="mat-mdc-form-field-label-"+hU++,this._hintLabelId="mat-mdc-hint-"+hU++,this._subscriptAnimationState="",this._labelWidth=0,this._destroyed=new g.x,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,b&&(b.appearance&&(this.appearance=b.appearance),this._hideRequiredMarker=Boolean(b?.hideRequiredMarker),b.color&&(this.color=b.color))}ngAfterViewInit(){this._updateFocusState(),this._refreshOutlineNotchWidth(),this._document?.fonts?.ready?this._document.fonts.ready.then(()=>{this._refreshOutlineNotchWidth(),this._changeDetectorRef.markForCheck()}):setTimeout(()=>this._refreshOutlineNotchWidth(),100),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){const t=this._control;t.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${t.controlType}`),t.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),t.ngControl&&t.ngControl.valueChanges&&t.ngControl.valueChanges.pipe(Wo(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(t=>!t._isText),this._hasTextPrefix=!!this._prefixChildren.find(t=>t._isText),this._hasIconSuffix=!!this._suffixChildren.find(t=>!t._isText),this._hasTextSuffix=!!this._suffixChildren.find(t=>t._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),(0,p_.T)(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||null===this._isFocused)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(Wo(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(Wo(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return"always"===this.floatLabel}_hasOutline(){return"outline"===this.appearance}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(t){const i=this._control?this._control.ngControl:null;return i&&i[t]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||(this._labelWidth=this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_syncDescribedByIds(){if(this._control){let t=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&t.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const i=this._hintChildren?this._hintChildren.find(s=>"start"===s.align):null,r=this._hintChildren?this._hintChildren.find(s=>"end"===s.align):null;i?t.push(i.id):this._hintLabel&&t.push(this._hintLabelId),r&&t.push(r.id)}else this._errorChildren&&t.push(...this._errorChildren.map(i=>i.id));this._control.setDescribedByIds(t)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;const t=this._floatingLabel.element;if(!this._iconPrefixContainer&&!this._textPrefixContainer)return void(t.style.transform="");if(!this._isAttachedToDom())return void(this._needsOutlineLabelOffsetUpdateOnStable=!0);const i=this._iconPrefixContainer?.nativeElement,r=this._textPrefixContainer?.nativeElement,s=i?.getBoundingClientRect().width??0,f=r?.getBoundingClientRect().width??0;t.style.transform=`var(\n        --mat-mdc-form-field-label-transform,\n        translateY(-50%) translateX(calc(${"rtl"===this._dir.value?"-1":"1"} * (${s+f}px + var(--mat-mdc-form-field-label-offset-x, 0px))))\n    )`}_isAttachedToDom(){const t=this._elementRef.nativeElement;if(t.getRootNode){const i=t.getRootNode();return i&&i!==t}return document.documentElement.contains(t)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq),u.Y36(u.sBO),u.Y36(u.R0b),u.Y36(g_),u.Y36(Wl),u.Y36(xK,8),u.Y36(u.QbO,8),u.Y36(ft))},n.\u0275cmp=u.Xpm({type:n,selectors:[["mat-form-field"]],contentQueries:function(t,i,r){if(1&t&&(u.Suo(r,rU,5),u.Suo(r,rU,7),u.Suo(r,uU,5),u.Suo(r,_K,5),u.Suo(r,yK,5),u.Suo(r,mK,5),u.Suo(r,oU,5)),2&t){let s;u.iGM(s=u.CRH())&&(i._labelChildNonStatic=s.first),u.iGM(s=u.CRH())&&(i._labelChildStatic=s.first),u.iGM(s=u.CRH())&&(i._formFieldControl=s.first),u.iGM(s=u.CRH())&&(i._prefixChildren=s),u.iGM(s=u.CRH())&&(i._suffixChildren=s),u.iGM(s=u.CRH())&&(i._errorChildren=s),u.iGM(s=u.CRH())&&(i._hintChildren=s)}},viewQuery:function(t,i){if(1&t&&(u.Gf(Z9,5),u.Gf(W9,5),u.Gf(Y9,5),u.Gf(sU,5),u.Gf(cU,5),u.Gf(lU,5)),2&t){let r;u.iGM(r=u.CRH())&&(i._textField=r.first),u.iGM(r=u.CRH())&&(i._iconPrefixContainer=r.first),u.iGM(r=u.CRH())&&(i._textPrefixContainer=r.first),u.iGM(r=u.CRH())&&(i._floatingLabel=r.first),u.iGM(r=u.CRH())&&(i._notchedOutline=r.first),u.iGM(r=u.CRH())&&(i._lineRipple=r.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(t,i){2&t&&u.ekj("mat-mdc-form-field-label-always-float",i._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",i._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",i._hasIconSuffix)("mat-form-field-invalid",i._control.errorState)("mat-form-field-disabled",i._control.disabled)("mat-form-field-autofilled",i._control.autofilled)("mat-form-field-no-animations","NoopAnimations"===i._animationMode)("mat-form-field-appearance-fill","fill"==i.appearance)("mat-form-field-appearance-outline","outline"==i.appearance)("mat-form-field-hide-placeholder",i._hasFloatingLabel()&&!i._shouldLabelFloat())("mat-focused",i._control.focused)("mat-primary","accent"!==i.color&&"warn"!==i.color)("mat-accent","accent"===i.color)("mat-warn","warn"===i.color)("ng-untouched",i._shouldForward("untouched"))("ng-touched",i._shouldForward("touched"))("ng-pristine",i._shouldForward("pristine"))("ng-dirty",i._shouldForward("dirty"))("ng-valid",i._shouldForward("valid"))("ng-invalid",i._shouldForward("invalid"))("ng-pending",i._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[u._Bn([{provide:dU,useExisting:n}])],ngContentSelectors:pK,decls:18,vars:23,consts:[["labelTemplate",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],["textField",""],["class","mat-mdc-form-field-focus-overlay",4,"ngIf"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen","matFormFieldNotchedOutlineLabelWidth",4,"ngIf"],["class","mat-mdc-form-field-icon-prefix",4,"ngIf"],["class","mat-mdc-form-field-text-prefix",4,"ngIf"],[1,"mat-mdc-form-field-infix"],[3,"ngIf"],["class","mat-mdc-form-field-text-suffix",4,"ngIf"],["class","mat-mdc-form-field-icon-suffix",4,"ngIf"],["matFormFieldLineRipple","",4,"ngIf"],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align",3,"ngSwitch"],["class","mat-mdc-form-field-error-wrapper",4,"ngSwitchCase"],["class","mat-mdc-form-field-hint-wrapper",4,"ngSwitchCase"],["matFormFieldFloatingLabel","",3,"floating","cdkObserveContentDisabled","id","cdkObserveContent",4,"ngIf"],["matFormFieldFloatingLabel","",3,"floating","cdkObserveContentDisabled","id","cdkObserveContent"],["aria-hidden","true","class","mat-mdc-form-field-required-marker mdc-floating-label--required",4,"ngIf"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-focus-overlay"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen","matFormFieldNotchedOutlineLabelWidth"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-icon-prefix"],["iconPrefixContainer",""],[1,"mat-mdc-form-field-text-prefix"],["textPrefixContainer",""],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id",4,"ngIf"],[1,"mat-mdc-form-field-hint-spacer"],[3,"id"]],template:function(t,i){1&t&&(u.F$t(fK),u.YNc(0,Q9,1,1,"ng-template",null,0,u.W1O),u.TgZ(2,"div",1,2),u.NdJ("click",function(s){return i._control.onContainerClick&&i._control.onContainerClick(s)}),u.YNc(4,J9,1,0,"div",3),u.TgZ(5,"div",4),u.YNc(6,nK,2,3,"div",5),u.YNc(7,iK,3,0,"div",6),u.YNc(8,rK,3,0,"div",7),u.TgZ(9,"div",8),u.YNc(10,sK,1,1,"ng-template",9),u.Hsn(11),u.qZA(),u.YNc(12,aK,2,0,"div",10),u.YNc(13,lK,2,0,"div",11),u.qZA(),u.YNc(14,cK,1,0,"div",12),u.qZA(),u.TgZ(15,"div",13),u.YNc(16,uK,2,1,"div",14),u.YNc(17,hK,5,2,"div",15),u.qZA()),2&t&&(u.xp6(2),u.ekj("mdc-text-field--filled",!i._hasOutline())("mdc-text-field--outlined",i._hasOutline())("mdc-text-field--no-label",!i._hasFloatingLabel())("mdc-text-field--disabled",i._control.disabled)("mdc-text-field--invalid",i._control.errorState),u.xp6(2),u.Q6J("ngIf",!i._hasOutline()&&!i._control.disabled),u.xp6(2),u.Q6J("ngIf",i._hasOutline()),u.xp6(1),u.Q6J("ngIf",i._hasIconPrefix),u.xp6(1),u.Q6J("ngIf",i._hasTextPrefix),u.xp6(2),u.Q6J("ngIf",!i._hasOutline()||i._forceDisplayInfixLabel()),u.xp6(2),u.Q6J("ngIf",i._hasTextSuffix),u.xp6(1),u.Q6J("ngIf",i._hasIconSuffix),u.xp6(1),u.Q6J("ngIf",!i._hasOutline()),u.xp6(1),u.ekj("mat-mdc-form-field-subscript-dynamic-size","dynamic"===i.subscriptSizing),u.Q6J("ngSwitch",i._getDisplayedMessages()),u.xp6(1),u.Q6J("ngSwitchCase","error"),u.xp6(1),u.Q6J("ngSwitchCase","hint"))},dependencies:[Ro,aa,Ui,cd,A7,oU,sU,cU,lU],styles:['.mdc-text-field{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px, var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 96px / 0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{line-height:normal;pointer-events:all}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:12px;box-sizing:content-box}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0 - 0%)) translateY(-10.25px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-10.25px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-10.25px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-10.25px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-24.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-24.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-106%) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-106%) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}'],encapsulation:2,data:{animation:[bK.transitionMessages]},changeDetection:0}),n})(),TK=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[Ha,ys,iV,Ha]}),n})();class IK{}function T2(n){return n&&"function"==typeof n.connect&&!(n instanceof Rt)}class mU{applyChanges(e,t,i,r,s){e.forEachOperation((f,b,I)=>{let O,B;if(null==f.previousIndex){const K=i(f,b,I);O=t.createEmbeddedView(K.templateRef,K.context,K.index),B=1}else null==I?(t.remove(b),B=3):(O=t.get(b),t.move(O,I),B=2);s&&s({context:O?.context,operation:B,record:f})})}detach(){}}class SK{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(e=!1,t,i=!0,r){this._multiple=e,this._emitChanges=i,this.compareWith=r,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new g.x,t&&t.length&&(e?t.forEach(s=>this._markSelected(s)):this._markSelected(t[0]),this._selectedToEmit.length=0)}select(...e){this._verifyValueAssignment(e),e.forEach(i=>this._markSelected(i));const t=this._hasQueuedChanges();return this._emitChangeEvent(),t}deselect(...e){this._verifyValueAssignment(e),e.forEach(i=>this._unmarkSelected(i));const t=this._hasQueuedChanges();return this._emitChangeEvent(),t}setSelection(...e){this._verifyValueAssignment(e);const t=this.selected,i=new Set(e);e.forEach(s=>this._markSelected(s)),t.filter(s=>!i.has(s)).forEach(s=>this._unmarkSelected(s));const r=this._hasQueuedChanges();return this._emitChangeEvent(),r}toggle(e){return this.isSelected(e)?this.deselect(e):this.select(e)}clear(e=!0){this._unmarkAll();const t=this._hasQueuedChanges();return e&&this._emitChangeEvent(),t}isSelected(e){return this._selection.has(this._getConcreteValue(e))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(e){this._multiple&&this.selected&&this._selected.sort(e)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(e){e=this._getConcreteValue(e),this.isSelected(e)||(this._multiple||this._unmarkAll(),this.isSelected(e)||this._selection.add(e),this._emitChanges&&this._selectedToEmit.push(e))}_unmarkSelected(e){e=this._getConcreteValue(e),this.isSelected(e)&&(this._selection.delete(e),this._emitChanges&&this._deselectedToEmit.push(e))}_unmarkAll(){this.isEmpty()||this._selection.forEach(e=>this._unmarkSelected(e))}_verifyValueAssignment(e){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(e){if(this.compareWith){for(let t of this._selection)if(this.compareWith(e,t))return t;return e}return e}}const oT=new u.OlP("_ViewRepeater"),MK=["trigger"],DK=["panel"];function AK(n,e){if(1&n&&(u.TgZ(0,"span",10),u._uU(1),u.qZA()),2&n){const t=u.oxw();u.xp6(1),u.Oqu(t.placeholder)}}function PK(n,e){if(1&n&&(u.TgZ(0,"span",14),u._uU(1),u.qZA()),2&n){const t=u.oxw(2);u.xp6(1),u.Oqu(t.triggerValue)}}function OK(n,e){1&n&&u.Hsn(0,0,["*ngSwitchCase","true"])}function kK(n,e){if(1&n&&(u.TgZ(0,"span",11),u.YNc(1,PK,2,1,"span",12),u.YNc(2,OK,1,0,"ng-content",13),u.qZA()),2&n){const t=u.oxw();u.Q6J("ngSwitch",!!t.customTrigger),u.xp6(2),u.Q6J("ngSwitchCase",!0)}}function RK(n,e){if(1&n){const t=u.EpF();u.O4$(),u.kcU(),u.TgZ(0,"div",15,16),u.NdJ("@transformPanel.done",function(r){u.CHM(t);const s=u.oxw();return u.KtG(s._panelDoneAnimatingStream.next(r.toState))})("keydown",function(r){u.CHM(t);const s=u.oxw();return u.KtG(s._handleKeydown(r))}),u.Hsn(2,1),u.qZA()}if(2&n){const t=u.oxw();u.Gre("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",t._getPanelTheme(),""),u.Q6J("ngClass",t.panelClass)("@transformPanel","showing"),u.uIk("id",t.id+"-panel")("aria-multiselectable",t.multiple)("aria-label",t.ariaLabel||null)("aria-labelledby",t._getPanelAriaLabelledby())}}const FK=[[["mat-select-trigger"]],"*"],LK=["mat-select-trigger","*"],NK={transformPanelWrap:Gm("transformPanelWrap",[Sc("* => void",RV("@transformPanel",[kV()],{optional:!0}))]),transformPanel:Gm("transformPanel",[Ic("void",Po({opacity:0,transform:"scale(1, 0.8)"})),Sc("void => showing",ad("120ms cubic-bezier(0, 0, 0.2, 1)",Po({opacity:1,transform:"scale(1, 1)"}))),Sc("* => void",ad("100ms linear",Po({opacity:0})))])};let _U=0;const yU=new u.OlP("mat-select-scroll-strategy"),BK=new u.OlP("MAT_SELECT_CONFIG"),VK={provide:yU,deps:[y1],useFactory:function zK(n){return()=>n.scrollStrategies.reposition()}},UK=new u.OlP("MatSelectTrigger");class jK{constructor(e,t){this.source=e,this.value=t}}const $K=vV(pY(QE(mY(class{constructor(n,e,t,i,r){this._elementRef=n,this._defaultErrorStateMatcher=e,this._parentForm=t,this._parentFormGroup=i,this.ngControl=r,this.stateChanges=new g.x}}))));let GK=(()=>{class n extends $K{get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(t){this._placeholder=t,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(ar.required)??!1}set required(t){this._required=is(t),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(t){this._multiple=is(t)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(t){this._disableOptionCentering=is(t)}get compareWith(){return this._compareWith}set compareWith(t){this._compareWith=t,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(t){this._assignValue(t)&&this._onChange(t)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(t){this._typeaheadDebounceInterval=m_(t)}get id(){return this._id}set id(t){this._id=t||this._uid,this.stateChanges.next()}constructor(t,i,r,s,f,b,I,O,B,K,le,ge,Te,Ge){super(f,s,I,O,K),this._viewportRuler=t,this._changeDetectorRef=i,this._ngZone=r,this._dir=b,this._parentFormField=B,this._liveAnnouncer=Te,this._defaultOptions=Ge,this._panelOpen=!1,this._compareWith=(Je,Qt)=>Je===Qt,this._uid="mat-select-"+_U++,this._triggerAriaLabelledBy=null,this._destroy=new g.x,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+_U++,this._panelDoneAnimatingStream=new g.x,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this._multiple=!1,this._disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.optionSelectionChanges=Qe(()=>{const Je=this.options;return Je?Je.changes.pipe(_n(Je),dn(()=>(0,p_.T)(...Je.map(Qt=>Qt.onSelectionChange)))):this._ngZone.onStable.pipe(Wn(1),dn(()=>this.optionSelectionChanges))}),this.openedChange=new u.vpe,this._openedStream=this.openedChange.pipe(Yt(Je=>Je),(0,de.U)(()=>{})),this._closedStream=this.openedChange.pipe(Yt(Je=>!Je),(0,de.U)(()=>{})),this.selectionChange=new u.vpe,this.valueChange=new u.vpe,this.ngControl&&(this.ngControl.valueAccessor=this),null!=Ge?.typeaheadDebounceInterval&&(this._typeaheadDebounceInterval=Ge.typeaheadDebounceInterval),this._scrollStrategyFactory=ge,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(le)||0,this.id=this.id}ngOnInit(){this._selectionModel=new SK(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(wM(),Wo(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen))}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe(Wo(this._destroy)).subscribe(t=>{t.added.forEach(i=>i.select()),t.removed.forEach(i=>i.deselect())}),this.options.changes.pipe(_n(null),Wo(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const t=this._getTriggerAriaLabelledby(),i=this.ngControl;if(t!==this._triggerAriaLabelledBy){const r=this._elementRef.nativeElement;this._triggerAriaLabelledBy=t,t?r.setAttribute("aria-labelledby",t):r.removeAttribute("aria-labelledby")}i&&(this._previousControl!==i.control&&(void 0!==this._previousControl&&null!==i.disabled&&i.disabled!==this.disabled&&(this.disabled=i.disabled),this._previousControl=i.control),this.updateErrorState())}ngOnChanges(t){(t.disabled||t.userAriaDescribedBy)&&this.stateChanges.next(),t.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(t){this._assignValue(t)}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const t=this._selectionModel.selected.map(i=>i.viewValue);return this._isRtl()&&t.reverse(),t.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(t){this.disabled||(this.panelOpen?this._handleOpenKeydown(t):this._handleClosedKeydown(t))}_handleClosedKeydown(t){const i=t.keyCode,r=40===i||38===i||37===i||39===i,s=13===i||32===i,f=this._keyManager;if(!f.isTyping()&&s&&!p1(t)||(this.multiple||t.altKey)&&r)t.preventDefault(),this.open();else if(!this.multiple){const b=this.selected;f.onKeydown(t);const I=this.selected;I&&b!==I&&this._liveAnnouncer.announce(I.viewValue,1e4)}}_handleOpenKeydown(t){const i=this._keyManager,r=t.keyCode,s=40===r||38===r,f=i.isTyping();if(s&&t.altKey)t.preventDefault(),this.close();else if(f||13!==r&&32!==r||!i.activeItem||p1(t))if(!f&&this._multiple&&65===r&&t.ctrlKey){t.preventDefault();const b=this.options.some(I=>!I.disabled&&!I.selected);this.options.forEach(I=>{I.disabled||(b?I.select():I.deselect())})}else{const b=i.activeItemIndex;i.onKeydown(t),this._multiple&&s&&t.shiftKey&&i.activeItem&&i.activeItemIndex!==b&&i.activeItem._selectViaInteraction()}else t.preventDefault(),i.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(Wn(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(t){if(this.options.forEach(i=>i.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&t)Array.isArray(t),t.forEach(i=>this._selectOptionByValue(i)),this._sortValues();else{const i=this._selectOptionByValue(t);i?this._keyManager.updateActiveItem(i):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(t){const i=this.options.find(r=>{if(this._selectionModel.isSelected(r))return!1;try{return null!=r.value&&this._compareWith(r.value,t)}catch{return!1}});return i&&this._selectionModel.select(i),i}_assignValue(t){return!!(t!==this._value||this._multiple&&Array.isArray(t))&&(this.options&&this._setSelectionByValue(t),this._value=t,!0)}_initKeyManager(){this._keyManager=new z7(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const t=(0,p_.T)(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(Wo(t)).subscribe(i=>{this._onSelect(i.source,i.isUserInput),i.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),(0,p_.T)(...this.options.map(i=>i._stateChanges)).pipe(Wo(t)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(t,i){const r=this._selectionModel.isSelected(t);null!=t.value||this._multiple?(r!==t.selected&&(t.selected?this._selectionModel.select(t):this._selectionModel.deselect(t)),i&&this._keyManager.setActiveItem(t),this.multiple&&(this._sortValues(),i&&this.focus())):(t.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(t.value)),r!==this._selectionModel.isSelected(t)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const t=this.options.toArray();this._selectionModel.sort((i,r)=>this.sortComparator?this.sortComparator(i,r,t):t.indexOf(i)-t.indexOf(r)),this.stateChanges.next()}}_propagateChanges(t){let i=null;i=this.multiple?this.selected.map(r=>r.value):this.selected?this.selected.value:t,this._value=i,this.valueChange.emit(i),this._onChange(i),this.selectionChange.emit(this._getChangeEvent(i)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(t){this._elementRef.nativeElement.focus(t)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const t=this._parentFormField?.getLabelId();return this.ariaLabelledby?(t?t+" ":"")+this.ariaLabelledby:t}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;const t=this._parentFormField?.getLabelId();let i=(t?t+" ":"")+this._valueId;return this.ariaLabelledby&&(i+=" "+this.ariaLabelledby),i}_panelDoneAnimating(t){this.openedChange.emit(t)}setDescribedByIds(t){t.length?this._elementRef.nativeElement.setAttribute("aria-describedby",t.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty||this._focused&&!!this._placeholder}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(rT),u.Y36(u.sBO),u.Y36(u.R0b),u.Y36(_Y),u.Y36(u.SBq),u.Y36(g_,8),u.Y36(zg,8),u.Y36(ba,8),u.Y36(dU,8),u.Y36(au,10),u.$8M("tabindex"),u.Y36(yU),u.Y36(X7),u.Y36(BK,8))},n.\u0275dir=u.lG2({type:n,viewQuery:function(t,i){if(1&t&&(u.Gf(MK,5),u.Gf(DK,5),u.Gf(nU,5)),2&t){let r;u.iGM(r=u.CRH())&&(i.trigger=r.first),u.iGM(r=u.CRH())&&(i.panel=r.first),u.iGM(r=u.CRH())&&(i._overlayDir=r.first)}},inputs:{userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",placeholder:"placeholder",required:"required",multiple:"multiple",disableOptionCentering:"disableOptionCentering",compareWith:"compareWith",value:"value",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:"typeaheadDebounceInterval",sortComparator:"sortComparator",id:"id"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},features:[u.qOj,u.TTD]}),n})(),HK=(()=>{class n extends GK{constructor(){super(...arguments),this._positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}],this._hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}ngOnInit(){super.ngOnInit(),this._viewportRuler.change().pipe(Wo(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(),this._changeDetectorRef.detectChanges())})}ngAfterViewInit(){this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin())}open(){this._overlayWidth=this._getOverlayWidth(),super.open(),this.stateChanges.next()}close(){super.close(),this.stateChanges.next()}_scrollOptionIntoView(t){const i=this.options.toArray()[t];if(i){const r=this.panel.nativeElement,s=function MY(n,e,t){if(t.length){let i=e.toArray(),r=t.toArray(),s=0;for(let f=0;f<n+1;f++)i[f].group&&i[f].group===r[s]&&s++;return s}return 0}(t,this.options,this.optionGroups),f=i._getHostElement();r.scrollTop=0===t&&1===s?0:function DY(n,e,t,i){return n<t?n:n+e>t+i?Math.max(0,n-i+e):t}(f.offsetTop,f.offsetHeight,r.scrollTop,r.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(t){return new jK(this,t)}_getOverlayWidth(){return(this._preferredOverlayOrigin instanceof E2?this._preferredOverlayOrigin.elementRef:this._preferredOverlayOrigin||this._elementRef).nativeElement.getBoundingClientRect().width}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(t){this._hideSingleSelectionIndicator=is(t),this._syncParentProperties()}_syncParentProperties(){if(this.options)for(const t of this.options)t._changeDetectorRef.markForCheck()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275cmp=u.Xpm({type:n,selectors:[["mat-select"]],contentQueries:function(t,i,r){if(1&t&&(u.Suo(r,UK,5),u.Suo(r,DV,5),u.Suo(r,MV,5)),2&t){let s;u.iGM(s=u.CRH())&&(i.customTrigger=s.first),u.iGM(s=u.CRH())&&(i.options=s),u.iGM(s=u.CRH())&&(i.optionGroups=s)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","listbox",1,"mat-mdc-select"],hostVars:19,hostBindings:function(t,i){1&t&&u.NdJ("keydown",function(s){return i._handleKeydown(s)})("focus",function(){return i._onFocus()})("blur",function(){return i._onBlur()}),2&t&&(u.uIk("id",i.id)("tabindex",i.tabIndex)("aria-controls",i.panelOpen?i.id+"-panel":null)("aria-expanded",i.panelOpen)("aria-label",i.ariaLabel||null)("aria-required",i.required.toString())("aria-disabled",i.disabled.toString())("aria-invalid",i.errorState)("aria-activedescendant",i._getAriaActiveDescendant()),u.ekj("mat-mdc-select-disabled",i.disabled)("mat-mdc-select-invalid",i.errorState)("mat-mdc-select-required",i.required)("mat-mdc-select-empty",i.empty)("mat-mdc-select-multiple",i.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matSelect"],features:[u._Bn([{provide:uU,useExisting:n},{provide:SV,useExisting:n}]),u.qOj],ngContentSelectors:LK,decls:11,vars:11,consts:[["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],[1,"mat-mdc-select-value",3,"ngSwitch"],["class","mat-mdc-select-placeholder mat-mdc-select-min-line",4,"ngSwitchCase"],["class","mat-mdc-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth","backdropClick","attach","detach"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text",3,"ngSwitch"],["class","mat-mdc-select-min-line",4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(t,i){if(1&t&&(u.F$t(FK),u.TgZ(0,"div",0,1),u.NdJ("click",function(){return i.toggle()}),u.TgZ(3,"div",2),u.YNc(4,AK,2,1,"span",3),u.YNc(5,kK,3,2,"span",4),u.qZA(),u.TgZ(6,"div",5)(7,"div",6),u.O4$(),u.TgZ(8,"svg",7),u._UZ(9,"path",8),u.qZA()()()(),u.YNc(10,RK,3,9,"ng-template",9),u.NdJ("backdropClick",function(){return i.close()})("attach",function(){return i._onAttached()})("detach",function(){return i.close()})),2&t){const r=u.MAs(1);u.uIk("aria-owns",i.panelOpen?i.id+"-panel":null),u.xp6(3),u.Q6J("ngSwitch",i.empty),u.uIk("id",i._valueId),u.xp6(1),u.Q6J("ngSwitchCase",!0),u.xp6(1),u.Q6J("ngSwitchCase",!1),u.xp6(5),u.Q6J("cdkConnectedOverlayPanelClass",i._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",i._scrollStrategy)("cdkConnectedOverlayOrigin",i._preferredOverlayOrigin||r)("cdkConnectedOverlayOpen",i.panelOpen)("cdkConnectedOverlayPositions",i._positions)("cdkConnectedOverlayWidth",i._overlayWidth)}},dependencies:[Mn,Ui,cd,fo,nU,E2],styles:['.mdc-menu-surface{display:none;position:absolute;box-sizing:border-box;max-width:calc(100vw - 32px);max-width:var(--mdc-menu-max-width, calc(100vw - 32px));max-height:calc(100vh - 32px);max-height:var(--mdc-menu-max-height, calc(100vh - 32px));margin:0;padding:0;transform:scale(1);transform-origin:top left;opacity:0;overflow:auto;will-change:transform,opacity;z-index:8;border-radius:4px;border-radius:var(--mdc-shape-medium, 4px);transform-origin-left:top left;transform-origin-right:top right}.mdc-menu-surface:focus{outline:none}.mdc-menu-surface--animating-open{display:inline-block;transform:scale(0.8);opacity:0}.mdc-menu-surface--open{display:inline-block;transform:scale(1);opacity:1}.mdc-menu-surface--animating-closed{display:inline-block;opacity:0}[dir=rtl] .mdc-menu-surface,.mdc-menu-surface[dir=rtl]{transform-origin-left:top right;transform-origin-right:top left}.mdc-menu-surface--anchor{position:relative;overflow:visible}.mdc-menu-surface--fixed{position:fixed}.mdc-menu-surface--fullwidth{width:100%}.mat-mdc-select{display:inline-block;width:100%;outline:none}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:translateY(-8px)}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-select-arrow{width:10px;height:5px;position:relative}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:GrayText}.mdc-menu-surface.mat-mdc-select-panel{width:100%;max-height:275px;position:static;outline:0;margin:0;padding:8px 0;list-style-type:none}.mdc-menu-surface.mat-mdc-select-panel:focus{outline:none}.cdk-high-contrast-active .mdc-menu-surface.mat-mdc-select-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) .mdc-menu-surface.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above .mdc-menu-surface.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}'],encapsulation:2,data:{animation:[NK.transformPanel]},changeDetection:0}),n})(),qK=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[VK],imports:[ys,iU,AV,Ha,NM,TK,AV,Ha]}),n})();const ZK=["tooltip"],vU=new u.OlP("mat-tooltip-scroll-strategy"),KK={provide:vU,deps:[y1],useFactory:function YK(n){return()=>n.scrollStrategies.reposition({scrollThrottle:20})}},QK=new u.OlP("mat-tooltip-default-options",{providedIn:"root",factory:function XK(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),bU="tooltip-panel",xU=YE({passive:!0});let rX=(()=>{class n{get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(t){this._positionAtOrigin=is(t),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(t){this._disabled=is(t),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=m_(t)}get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=m_(t),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(t){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=t?String(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(t,i,r,s,f,b,I,O,B,K,le,ge){this._overlay=t,this._elementRef=i,this._scrollDispatcher=r,this._viewContainerRef=s,this._ngZone=f,this._platform=b,this._ariaDescriber=I,this._focusMonitor=O,this._dir=K,this._defaultOptions=le,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._viewportMargin=8,this._cssClassPrefix="mat",this._showDelay=this._defaultOptions.showDelay,this._hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new g.x,this._scrollStrategy=B,this._document=ge,le&&(le.position&&(this.position=le.position),le.positionAtOrigin&&(this.positionAtOrigin=le.positionAtOrigin),le.touchGestures&&(this.touchGestures=le.touchGestures)),K.change.pipe(Wo(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Wo(this._destroyed)).subscribe(t=>{t?"keyboard"===t&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const t=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([i,r])=>{t.removeEventListener(i,r,xU)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(t,this.message,"tooltip"),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay,i){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const r=this._createOverlay(i);this._detach(),this._portal=this._portal||new $V(this._tooltipComponent,this._viewContainerRef);const s=this._tooltipInstance=r.attach(this._portal).instance;s._triggerElement=this._elementRef.nativeElement,s._mouseLeaveHideDelay=this._hideDelay,s.afterHidden().pipe(Wo(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),s.show(t)}hide(t=this.hideDelay){const i=this._tooltipInstance;i&&(i.isVisible()?i.hide(t):(i._cancelPendingAnimations(),this._detach()))}toggle(t){this._isTooltipVisible()?this.hide():this.show(void 0,t)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(t){if(this._overlayRef){const s=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!t)&&s._origin instanceof u.SBq)return this._overlayRef;this._detach()}const i=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),r=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin&&t||this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(i);return r.positionChanges.pipe(Wo(this._destroyed)).subscribe(s=>{this._updateCurrentPositionClass(s.connectionPair),this._tooltipInstance&&s.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:r,panelClass:`${this._cssClassPrefix}-${bU}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Wo(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Wo(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(Wo(this._destroyed)).subscribe(s=>{this._isTooltipVisible()&&27===s.keyCode&&!p1(s)&&(s.preventDefault(),s.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(t){const i=t.getConfig().positionStrategy,r=this._getOrigin(),s=this._getOverlayPosition();i.withPositions([this._addOffset({...r.main,...s.main}),this._addOffset({...r.fallback,...s.fallback})])}_addOffset(t){return t}_getOrigin(){const t=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i||"below"==i?r={originX:"center",originY:"above"==i?"top":"bottom"}:"before"==i||"left"==i&&t||"right"==i&&!t?r={originX:"start",originY:"center"}:("after"==i||"right"==i&&t||"left"==i&&!t)&&(r={originX:"end",originY:"center"});const{x:s,y:f}=this._invertPosition(r.originX,r.originY);return{main:r,fallback:{originX:s,originY:f}}}_getOverlayPosition(){const t=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i?r={overlayX:"center",overlayY:"bottom"}:"below"==i?r={overlayX:"center",overlayY:"top"}:"before"==i||"left"==i&&t||"right"==i&&!t?r={overlayX:"end",overlayY:"center"}:("after"==i||"right"==i&&t||"left"==i&&!t)&&(r={overlayX:"start",overlayY:"center"});const{x:s,y:f}=this._invertPosition(r.overlayX,r.overlayY);return{main:r,fallback:{overlayX:s,overlayY:f}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(Wn(1),Wo(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,i){return"above"===this.position||"below"===this.position?"top"===i?i="bottom":"bottom"===i&&(i="top"):"end"===t?t="start":"start"===t&&(t="end"),{x:t,y:i}}_updateCurrentPositionClass(t){const{overlayY:i,originX:r,originY:s}=t;let f;if(f="center"===i?this._dir&&"rtl"===this._dir.value?"end"===r?"left":"right":"start"===r?"left":"right":"bottom"===i&&"top"===s?"above":"below",f!==this._currentPosition){const b=this._overlayRef;if(b){const I=`${this._cssClassPrefix}-${bU}-`;b.removePanelClass(I+this._currentPosition),b.addPanelClass(I+f)}this._currentPosition=f}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",t=>{let i;this._setupPointerExitEventsIfNeeded(),void 0!==t.x&&void 0!==t.y&&(i=t),this.show(void 0,i)}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",t=>{const i=t.targetTouches?.[0],r=i?{x:i.clientX,y:i.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(void 0,r),500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const t=[];if(this._platformSupportsMouseEvents())t.push(["mouseleave",i=>{const r=i.relatedTarget;(!r||!this._overlayRef?.overlayElement.contains(r))&&this.hide()}],["wheel",i=>this._wheelListener(i)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const i=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};t.push(["touchend",i],["touchcancel",i])}this._addListeners(t),this._passiveListeners.push(...t)}_addListeners(t){t.forEach(([i,r])=>{this._elementRef.nativeElement.addEventListener(i,r,xU)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(t){if(this._isTooltipVisible()){const i=this._document.elementFromPoint(t.clientX,t.clientY),r=this._elementRef.nativeElement;i!==r&&!r.contains(i)&&this.hide()}}_disableNativeGesturesIfNecessary(){const t=this.touchGestures;if("off"!==t){const i=this._elementRef.nativeElement,r=i.style;("on"===t||"INPUT"!==i.nodeName&&"TEXTAREA"!==i.nodeName)&&(r.userSelect=r.msUserSelect=r.webkitUserSelect=r.MozUserSelect="none"),("on"===t||!i.draggable)&&(r.webkitUserDrag="none"),r.touchAction="none",r.webkitTapHighlightColor="transparent"}}}return n.\u0275fac=function(t){u.$Z()},n.\u0275dir=u.lG2({type:n,inputs:{position:["matTooltipPosition","position"],positionAtOrigin:["matTooltipPositionAtOrigin","positionAtOrigin"],disabled:["matTooltipDisabled","disabled"],showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]}}),n})(),wU=(()=>{class n extends rX{constructor(t,i,r,s,f,b,I,O,B,K,le,ge){super(t,i,r,s,f,b,I,O,B,K,le,ge),this._tooltipComponent=sX,this._cssClassPrefix="mat-mdc",this._viewportMargin=8}_addOffset(t){const r=!this._dir||"ltr"==this._dir.value;return"top"===t.originY?t.offsetY=-8:"bottom"===t.originY?t.offsetY=8:"start"===t.originX?t.offsetX=r?-8:8:"end"===t.originX&&(t.offsetX=r?8:-8),t}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(y1),u.Y36(u.SBq),u.Y36(iT),u.Y36(u.s_b),u.Y36(u.R0b),u.Y36(Wl),u.Y36(lV),u.Y36(h2),u.Y36(vU),u.Y36(g_,8),u.Y36(QK,8),u.Y36(ft))},n.\u0275dir=u.lG2({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],exportAs:["matTooltip"],features:[u.qOj]}),n})(),oX=(()=>{class n{constructor(t,i){this._changeDetectorRef=t,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new g.x,this._animationsDisabled="NoopAnimations"===i}show(t){clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},t)}hide(t){clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},t)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:t}){(!t||!this._triggerElement.contains(t))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){}_handleAnimationEnd({animationName:t}){(t===this._showAnimation||t===this._hideAnimation)&&this._finalizeAnimation(t===this._showAnimation)}_cancelPendingAnimations(){clearTimeout(this._showTimeoutId),clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(t){t?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(t){const i=this._tooltip.nativeElement,r=this._showAnimation,s=this._hideAnimation;if(i.classList.remove(t?s:r),i.classList.add(t?r:s),this._isVisible=t,t&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const f=getComputedStyle(i);("0s"===f.getPropertyValue("animation-duration")||"none"===f.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}t&&this._onShow(),this._animationsDisabled&&(i.classList.add("_mat-animation-noopable"),this._finalizeAnimation(t))}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.sBO),u.Y36(u.QbO,8))},n.\u0275dir=u.lG2({type:n}),n})(),sX=(()=>{class n extends oX{constructor(t,i,r){super(t,r),this._elementRef=i,this._isMultiline=!1,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide"}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){const t=this._elementRef.nativeElement.getBoundingClientRect();return t.height>24&&t.width>=200}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.sBO),u.Y36(u.SBq),u.Y36(u.QbO,8))},n.\u0275cmp=u.Xpm({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(t,i){if(1&t&&u.Gf(ZK,7),2&t){let r;u.iGM(r=u.CRH())&&(i._tooltip=r.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(t,i){1&t&&u.NdJ("mouseleave",function(s){return i._handleMouseLeave(s)}),2&t&&u.Udp("zoom",i.isVisible()?1:null)},features:[u.qOj],decls:4,vars:4,consts:[[1,"mdc-tooltip","mdc-tooltip--shown","mat-mdc-tooltip",3,"ngClass","animationend"],["tooltip",""],[1,"mdc-tooltip__surface","mdc-tooltip__surface-animation"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0,1),u.NdJ("animationend",function(s){return i._handleAnimationEnd(s)}),u.TgZ(2,"div",2),u._uU(3),u.qZA()()),2&t&&(u.ekj("mdc-tooltip--multiline",i._isMultiline),u.Q6J("ngClass",i.tooltipClass),u.xp6(3),u.Oqu(i.message))},dependencies:[Mn],styles:['.mdc-tooltip__surface{word-break:var(--mdc-tooltip-word-break, normal);overflow-wrap:anywhere}.mdc-tooltip{position:fixed;display:none;z-index:9}.mdc-tooltip-wrapper--rich{position:relative}.mdc-tooltip--shown,.mdc-tooltip--showing,.mdc-tooltip--hide{display:inline-flex}.mdc-tooltip--shown.mdc-tooltip--rich,.mdc-tooltip--showing.mdc-tooltip--rich,.mdc-tooltip--hide.mdc-tooltip--rich{display:inline-block;left:-320px;position:absolute}.mdc-tooltip__surface{line-height:16px;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center}.mdc-tooltip__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-tooltip__surface::before{border-color:CanvasText}}.mdc-tooltip--rich .mdc-tooltip__surface{align-items:flex-start;display:flex;flex-direction:column;min-height:24px;min-width:40px;max-width:320px;position:relative}.mdc-tooltip--multiline .mdc-tooltip__surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mdc-tooltip__surface,.mdc-tooltip--multiline .mdc-tooltip__surface[dir=rtl]{text-align:right}.mdc-tooltip__surface .mdc-tooltip__title{margin:0 8px}.mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(200px - (2 * 8px));margin:8px;text-align:left}[dir=rtl] .mdc-tooltip__surface .mdc-tooltip__content,.mdc-tooltip__surface .mdc-tooltip__content[dir=rtl]{text-align:right}.mdc-tooltip--rich .mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(320px - (2 * 8px));align-self:stretch}.mdc-tooltip__surface .mdc-tooltip__content-link{text-decoration:none}.mdc-tooltip--rich-actions,.mdc-tooltip__content,.mdc-tooltip__title{z-index:1}.mdc-tooltip__surface-animation{opacity:0;transform:scale(0.8);will-change:transform,opacity}.mdc-tooltip--shown .mdc-tooltip__surface-animation{transform:scale(1);opacity:1}.mdc-tooltip--hide .mdc-tooltip__surface-animation{transform:scale(1)}.mdc-tooltip__caret-surface-top,.mdc-tooltip__caret-surface-bottom{position:absolute;height:24px;width:24px;transform:rotate(35deg) skewY(20deg) scaleX(0.9396926208)}.mdc-tooltip__caret-surface-top .mdc-elevation-overlay,.mdc-tooltip__caret-surface-bottom .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-tooltip__caret-surface-bottom{outline:1px solid rgba(0,0,0,0);z-index:-1}@media screen and (forced-colors: active){.mdc-tooltip__caret-surface-bottom{outline-color:CanvasText}}.mdc-tooltip__surface{background-color:var(--mdc-plain-tooltip-container-color, #fff)}.mdc-tooltip__surface{border-radius:var(--mdc-plain-tooltip-container-shape, var(--mdc-shape-small, 4px))}.mdc-tooltip__caret-surface-top,.mdc-tooltip__caret-surface-bottom{border-radius:var(--mdc-plain-tooltip-container-shape, var(--mdc-shape-small, 4px))}.mdc-tooltip__surface{color:var(--mdc-plain-tooltip-supporting-text-color, #000)}.mdc-tooltip__surface{font-family:var(--mdc-plain-tooltip-supporting-text-font, inherit);font-size:var(--mdc-plain-tooltip-supporting-text-size, inherit);font-weight:var(--mdc-plain-tooltip-supporting-text-weight, inherit);letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, inherit)}.mat-mdc-tooltip{position:relative;transform:scale(0)}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0}),n})(),CU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[KK],imports:[J7,ys,iU,Ha,Ha,NM]}),n})();function aX(n,e){if(1&n&&(u.TgZ(0,"mat-option",19),u._uU(1),u.qZA()),2&n){const t=e.$implicit;u.Q6J("value",t),u.xp6(1),u.hij(" ",t," ")}}function lX(n,e){if(1&n){const t=u.EpF();u.TgZ(0,"mat-form-field",16)(1,"mat-select",17),u.NdJ("selectionChange",function(r){u.CHM(t);const s=u.oxw(2);return u.KtG(s._changePageSize(r.value))}),u.YNc(2,aX,2,2,"mat-option",18),u.qZA()()}if(2&n){const t=u.oxw(2);u.Q6J("appearance",t._formFieldAppearance)("color",t.color),u.xp6(1),u.Q6J("value",t.pageSize)("disabled",t.disabled)("aria-labelledby",t._pageSizeLabelId)("panelClass",t.selectConfig.panelClass||"")("disableOptionCentering",t.selectConfig.disableOptionCentering),u.xp6(1),u.Q6J("ngForOf",t._displayedPageSizeOptions)}}function cX(n,e){if(1&n&&(u.TgZ(0,"div",20),u._uU(1),u.qZA()),2&n){const t=u.oxw(2);u.xp6(1),u.Oqu(t.pageSize)}}function uX(n,e){if(1&n&&(u.TgZ(0,"div",12)(1,"div",13),u._uU(2),u.qZA(),u.YNc(3,lX,3,8,"mat-form-field",14),u.YNc(4,cX,2,1,"div",15),u.qZA()),2&n){const t=u.oxw();u.xp6(1),u.s9C("id",t._pageSizeLabelId),u.xp6(1),u.hij(" ",t._intl.itemsPerPageLabel," "),u.xp6(1),u.Q6J("ngIf",t._displayedPageSizeOptions.length>1),u.xp6(1),u.Q6J("ngIf",t._displayedPageSizeOptions.length<=1)}}function dX(n,e){if(1&n){const t=u.EpF();u.TgZ(0,"button",21),u.NdJ("click",function(){u.CHM(t);const r=u.oxw();return u.KtG(r.firstPage())}),u.O4$(),u.TgZ(1,"svg",7),u._UZ(2,"path",22),u.qZA()()}if(2&n){const t=u.oxw();u.Q6J("matTooltip",t._intl.firstPageLabel)("matTooltipDisabled",t._previousButtonsDisabled())("matTooltipPosition","above")("disabled",t._previousButtonsDisabled()),u.uIk("aria-label",t._intl.firstPageLabel)}}function hX(n,e){if(1&n){const t=u.EpF();u.O4$(),u.kcU(),u.TgZ(0,"button",23),u.NdJ("click",function(){u.CHM(t);const r=u.oxw();return u.KtG(r.lastPage())}),u.O4$(),u.TgZ(1,"svg",7),u._UZ(2,"path",24),u.qZA()()}if(2&n){const t=u.oxw();u.Q6J("matTooltip",t._intl.lastPageLabel)("matTooltipDisabled",t._nextButtonsDisabled())("matTooltipPosition","above")("disabled",t._nextButtonsDisabled()),u.uIk("aria-label",t._intl.lastPageLabel)}}let BM=(()=>{class n{constructor(){this.changes=new g.x,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(t,i,r)=>{if(0==r||0==i)return`0 of ${r}`;const s=t*i;return`${s+1} \u2013 ${s<(r=Math.max(r,0))?Math.min(s+i,r):s+i} of ${r}`}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const pX={provide:BM,deps:[[new u.FiY,new u.tp0,BM]],useFactory:function fX(n){return n||new BM}},gX=new u.OlP("MAT_PAGINATOR_DEFAULT_OPTIONS"),_X=QE(bV(class{}));let yX=(()=>{class n extends _X{get pageIndex(){return this._pageIndex}set pageIndex(t){this._pageIndex=Math.max(m_(t),0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(t){this._length=m_(t),this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(t){this._pageSize=Math.max(m_(t),0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(t){this._pageSizeOptions=(t||[]).map(i=>m_(i)),this._updateDisplayedPageSizeOptions()}get hidePageSize(){return this._hidePageSize}set hidePageSize(t){this._hidePageSize=is(t)}get showFirstLastButtons(){return this._showFirstLastButtons}set showFirstLastButtons(t){this._showFirstLastButtons=is(t)}constructor(t,i,r){if(super(),this._intl=t,this._changeDetectorRef=i,this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this._hidePageSize=!1,this._showFirstLastButtons=!1,this.selectConfig={},this.page=new u.vpe,this._intlChanges=t.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),r){const{pageSize:s,pageSizeOptions:f,hidePageSize:b,showFirstLastButtons:I}=r;null!=s&&(this._pageSize=s),null!=f&&(this._pageSizeOptions=f),null!=b&&(this._hidePageSize=b),null!=I&&(this._showFirstLastButtons=I)}}ngOnInit(){this._initialized=!0,this._updateDisplayedPageSizeOptions(),this._markInitialized()}ngOnDestroy(){this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex=this.pageIndex+1,this._emitPageEvent(t)}previousPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex=this.pageIndex-1,this._emitPageEvent(t)}firstPage(){if(!this.hasPreviousPage())return;const t=this.pageIndex;this.pageIndex=0,this._emitPageEvent(t)}lastPage(){if(!this.hasNextPage())return;const t=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(t)}hasPreviousPage(){return this.pageIndex>=1&&0!=this.pageSize}hasNextPage(){const t=this.getNumberOfPages()-1;return this.pageIndex<t&&0!=this.pageSize}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(t){const r=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/t)||0,this.pageSize=t,this._emitPageEvent(r)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._initialized&&(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((t,i)=>t-i),this._changeDetectorRef.markForCheck())}_emitPageEvent(t){this.page.emit({previousPageIndex:t,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}}return n.\u0275fac=function(t){u.$Z()},n.\u0275dir=u.lG2({type:n,inputs:{color:"color",pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",hidePageSize:"hidePageSize",showFirstLastButtons:"showFirstLastButtons",selectConfig:"selectConfig"},outputs:{page:"page"},features:[u.qOj]}),n})(),vX=0,EU=(()=>{class n extends yX{constructor(t,i,r){super(t,i,r),this._pageSizeLabelId="mat-paginator-page-size-label-"+vX++,this._formFieldAppearance=r?.formFieldAppearance||"outline"}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(BM),u.Y36(u.sBO),u.Y36(gX,8))},n.\u0275cmp=u.Xpm({type:n,selectors:[["mat-paginator"]],hostAttrs:["role","group",1,"mat-mdc-paginator"],inputs:{disabled:"disabled"},exportAs:["matPaginator"],features:[u.qOj],decls:14,vars:14,consts:[[1,"mat-mdc-paginator-outer-container"],[1,"mat-mdc-paginator-container"],["class","mat-mdc-paginator-page-size",4,"ngIf"],[1,"mat-mdc-paginator-range-actions"],["aria-live","polite",1,"mat-mdc-paginator-range-label"],["mat-icon-button","","type","button","class","mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-previous",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["viewBox","0 0 24 24","focusable","false",1,"mat-mdc-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-next",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","class","mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],[1,"mat-mdc-paginator-page-size"],[1,"mat-mdc-paginator-page-size-label",3,"id"],["class","mat-mdc-paginator-page-size-select",3,"appearance","color",4,"ngIf"],["class","mat-mdc-paginator-page-size-value",4,"ngIf"],[1,"mat-mdc-paginator-page-size-select",3,"appearance","color"],["hideSingleSelectionIndicator","",3,"value","disabled","aria-labelledby","panelClass","disableOptionCentering","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-mdc-paginator-page-size-value"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1),u.YNc(2,uX,5,4,"div",2),u.TgZ(3,"div",3)(4,"div",4),u._uU(5),u.qZA(),u.YNc(6,dX,3,5,"button",5),u.TgZ(7,"button",6),u.NdJ("click",function(){return i.previousPage()}),u.O4$(),u.TgZ(8,"svg",7),u._UZ(9,"path",8),u.qZA()(),u.kcU(),u.TgZ(10,"button",9),u.NdJ("click",function(){return i.nextPage()}),u.O4$(),u.TgZ(11,"svg",7),u._UZ(12,"path",10),u.qZA()(),u.YNc(13,hX,3,5,"button",11),u.qZA()()()),2&t&&(u.xp6(2),u.Q6J("ngIf",!i.hidePageSize),u.xp6(3),u.hij(" ",i._intl.getRangeLabel(i.pageIndex,i.pageSize,i.length)," "),u.xp6(1),u.Q6J("ngIf",i.showFirstLastButtons),u.xp6(1),u.Q6J("matTooltip",i._intl.previousPageLabel)("matTooltipDisabled",i._previousButtonsDisabled())("matTooltipPosition","above")("disabled",i._previousButtonsDisabled()),u.uIk("aria-label",i._intl.previousPageLabel),u.xp6(3),u.Q6J("matTooltip",i._intl.nextPageLabel)("matTooltipDisabled",i._nextButtonsDisabled())("matTooltipPosition","above")("disabled",i._nextButtonsDisabled()),u.uIk("aria-label",i._intl.nextPageLabel),u.xp6(3),u.Q6J("ngIf",i.showFirstLastButtons))},dependencies:[Qi,Ro,y2,EK,HK,DV,wU],styles:[".mat-mdc-paginator{display:block}.mat-mdc-paginator .mat-mdc-form-field-subscript-wrapper{display:none}.mat-mdc-paginator .mat-mdc-select{line-height:1.5}.mat-mdc-paginator-outer-container{display:flex}.mat-mdc-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap-reverse;width:100%}.mat-mdc-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-mdc-paginator-page-size{margin-right:0;margin-left:8px}.mat-mdc-paginator-page-size-label{margin:0 4px}.mat-mdc-paginator-page-size-select{margin:0 4px;width:84px}.mat-mdc-paginator-range-label{margin:0 32px 0 24px}.mat-mdc-paginator-range-actions{display:flex;align-items:center}.mat-mdc-paginator-icon{display:inline-block;width:28px}[dir=rtl] .mat-mdc-paginator-icon{transform:rotate(180deg)}.cdk-high-contrast-active .mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon,.cdk-high-contrast-active .mat-mdc-paginator-icon{fill:currentColor;fill:CanvasText}.cdk-high-contrast-active .mat-mdc-paginator-range-actions .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),bX=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[pX],imports:[ys,zV,qK,CU]}),n})();const wX=[[["caption"]],[["colgroup"],["col"]]],CX=["caption","colgroup, col"];function I2(n){return class extends n{get sticky(){return this._sticky}set sticky(e){const t=this._sticky;this._sticky=is(e),this._hasStickyChanged=t!==this._sticky}hasStickyChanged(){const e=this._hasStickyChanged;return this._hasStickyChanged=!1,e}resetStickyChanged(){this._hasStickyChanged=!1}constructor(...e){super(...e),this._sticky=!1,this._hasStickyChanged=!1}}}const v1=new u.OlP("CDK_TABLE");let b1=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.Rgc))},n.\u0275dir=u.lG2({type:n,selectors:[["","cdkCellDef",""]]}),n})(),x1=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.Rgc))},n.\u0275dir=u.lG2({type:n,selectors:[["","cdkHeaderCellDef",""]]}),n})(),VM=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.Rgc))},n.\u0275dir=u.lG2({type:n,selectors:[["","cdkFooterCellDef",""]]}),n})();class SX{}const MX=I2(SX);let y_=(()=>{class n extends MX{get name(){return this._name}set name(t){this._setNameInput(t)}get stickyEnd(){return this._stickyEnd}set stickyEnd(t){const i=this._stickyEnd;this._stickyEnd=is(t),this._hasStickyChanged=i!==this._stickyEnd}constructor(t){super(),this._table=t,this._stickyEnd=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(t){t&&(this._name=t,this.cssClassFriendlyName=t.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(v1,8))},n.\u0275dir=u.lG2({type:n,selectors:[["","cdkColumnDef",""]],contentQueries:function(t,i,r){if(1&t&&(u.Suo(r,b1,5),u.Suo(r,x1,5),u.Suo(r,VM,5)),2&t){let s;u.iGM(s=u.CRH())&&(i.cell=s.first),u.iGM(s=u.CRH())&&(i.headerCell=s.first),u.iGM(s=u.CRH())&&(i.footerCell=s.first)}},inputs:{sticky:"sticky",name:["cdkColumnDef","name"],stickyEnd:"stickyEnd"},features:[u._Bn([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),u.qOj]}),n})();class S2{constructor(e,t){t.nativeElement.classList.add(...e._columnCssClassName)}}let M2=(()=>{class n extends S2{constructor(t,i){super(t,i)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(y_),u.Y36(u.SBq))},n.\u0275dir=u.lG2({type:n,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[u.qOj]}),n})(),D2=(()=>{class n extends S2{constructor(t,i){if(super(t,i),1===t._table?._elementRef.nativeElement.nodeType){const r=t._table._elementRef.nativeElement.getAttribute("role");i.nativeElement.setAttribute("role","grid"===r||"treegrid"===r?"gridcell":"cell")}}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(y_),u.Y36(u.SBq))},n.\u0275dir=u.lG2({type:n,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],features:[u.qOj]}),n})();class IU{constructor(){this.tasks=[],this.endTasks=[]}}const A2=new u.OlP("_COALESCED_STYLE_SCHEDULER");let SU=(()=>{class n{constructor(t){this._ngZone=t,this._currentSchedule=null,this._destroyed=new g.x}schedule(t){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(t)}scheduleEnd(t){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(t)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new IU,this._getScheduleObservable().pipe(Wo(this._destroyed)).subscribe(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){const t=this._currentSchedule;this._currentSchedule=new IU;for(const i of t.tasks)i();for(const i of t.endTasks)i()}this._currentSchedule=null}))}_getScheduleObservable(){return this._ngZone.isStable?(0,Mi.D)(Promise.resolve(void 0)):this._ngZone.onStable.pipe(Wn(1))}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(u.R0b))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})(),P2=(()=>{class n{constructor(t,i){this.template=t,this._differs=i}ngOnChanges(t){if(!this._columnsDiffer){const i=t.columns&&t.columns.currentValue||[];this._columnsDiffer=this._differs.find(i).create(),this._columnsDiffer.diff(i)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(t){return this instanceof sT?t.headerCell.template:this instanceof aT?t.footerCell.template:t.cell.template}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.Rgc),u.Y36(u.ZZ4))},n.\u0275dir=u.lG2({type:n,features:[u.TTD]}),n})();class DX extends P2{}const AX=I2(DX);let sT=(()=>{class n extends AX{constructor(t,i,r){super(t,i),this._table=r}ngOnChanges(t){super.ngOnChanges(t)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.Rgc),u.Y36(u.ZZ4),u.Y36(v1,8))},n.\u0275dir=u.lG2({type:n,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:["cdkHeaderRowDef","columns"],sticky:["cdkHeaderRowDefSticky","sticky"]},features:[u.qOj,u.TTD]}),n})();class PX extends P2{}const OX=I2(PX);let aT=(()=>{class n extends OX{constructor(t,i,r){super(t,i),this._table=r}ngOnChanges(t){super.ngOnChanges(t)}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.Rgc),u.Y36(u.ZZ4),u.Y36(v1,8))},n.\u0275dir=u.lG2({type:n,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:["cdkFooterRowDef","columns"],sticky:["cdkFooterRowDefSticky","sticky"]},features:[u.qOj,u.TTD]}),n})(),UM=(()=>{class n extends P2{constructor(t,i,r){super(t,i),this._table=r}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.Rgc),u.Y36(u.ZZ4),u.Y36(v1,8))},n.\u0275dir=u.lG2({type:n,selectors:[["","cdkRowDef",""]],inputs:{columns:["cdkRowDefColumns","columns"],when:["cdkRowDefWhen","when"]},features:[u.qOj]}),n})(),v_=(()=>{class n{constructor(t){this._viewContainer=t,n.mostRecentCellOutlet=this}ngOnDestroy(){n.mostRecentCellOutlet===this&&(n.mostRecentCellOutlet=null)}}return n.mostRecentCellOutlet=null,n.\u0275fac=function(t){return new(t||n)(u.Y36(u.s_b))},n.\u0275dir=u.lG2({type:n,selectors:[["","cdkCellOutlet",""]]}),n})(),O2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,i){1&t&&u.GkF(0,0)},dependencies:[v_],encapsulation:2}),n})(),R2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,i){1&t&&u.GkF(0,0)},dependencies:[v_],encapsulation:2}),n})(),jM=(()=>{class n{constructor(t){this.templateRef=t,this._contentClassName="cdk-no-data-row"}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.Rgc))},n.\u0275dir=u.lG2({type:n,selectors:[["ng-template","cdkNoDataRow",""]]}),n})();const MU=["top","bottom","left","right"];class kX{constructor(e,t,i,r,s=!0,f=!0,b){this._isNativeHtmlTable=e,this._stickCellCss=t,this.direction=i,this._coalescedStyleScheduler=r,this._isBrowser=s,this._needsPositionStickyOnElement=f,this._positionListener=b,this._cachedCellWidths=[],this._borderCellCss={top:`${t}-border-elem-top`,bottom:`${t}-border-elem-bottom`,left:`${t}-border-elem-left`,right:`${t}-border-elem-right`}}clearStickyPositioning(e,t){const i=[];for(const r of e)if(r.nodeType===r.ELEMENT_NODE){i.push(r);for(let s=0;s<r.children.length;s++)i.push(r.children[s])}this._coalescedStyleScheduler.schedule(()=>{for(const r of i)this._removeStickyStyle(r,t)})}updateStickyColumns(e,t,i,r=!0){if(!e.length||!this._isBrowser||!t.some(le=>le)&&!i.some(le=>le))return void(this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]})));const s=e[0],f=s.children.length,b=this._getCellWidths(s,r),I=this._getStickyStartColumnPositions(b,t),O=this._getStickyEndColumnPositions(b,i),B=t.lastIndexOf(!0),K=i.indexOf(!0);this._coalescedStyleScheduler.schedule(()=>{const le="rtl"===this.direction,ge=le?"right":"left",Te=le?"left":"right";for(const Ge of e)for(let Je=0;Je<f;Je++){const Qt=Ge.children[Je];t[Je]&&this._addStickyStyle(Qt,ge,I[Je],Je===B),i[Je]&&this._addStickyStyle(Qt,Te,O[Je],Je===K)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:-1===B?[]:b.slice(0,B+1).map((Ge,Je)=>t[Je]?Ge:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:-1===K?[]:b.slice(K).map((Ge,Je)=>i[Je+K]?Ge:null).reverse()}))})}stickRows(e,t,i){if(!this._isBrowser)return;const r="bottom"===i?e.slice().reverse():e,s="bottom"===i?t.slice().reverse():t,f=[],b=[],I=[];for(let B=0,K=0;B<r.length;B++){if(!s[B])continue;f[B]=K;const le=r[B];I[B]=this._isNativeHtmlTable?Array.from(le.children):[le];const ge=le.getBoundingClientRect().height;K+=ge,b[B]=ge}const O=s.lastIndexOf(!0);this._coalescedStyleScheduler.schedule(()=>{for(let B=0;B<r.length;B++){if(!s[B])continue;const K=f[B],le=B===O;for(const ge of I[B])this._addStickyStyle(ge,i,K,le)}"top"===i?this._positionListener?.stickyHeaderRowsUpdated({sizes:b,offsets:f,elements:I}):this._positionListener?.stickyFooterRowsUpdated({sizes:b,offsets:f,elements:I})})}updateStickyFooterContainer(e,t){if(!this._isNativeHtmlTable)return;const i=e.querySelector("tfoot");this._coalescedStyleScheduler.schedule(()=>{t.some(r=>!r)?this._removeStickyStyle(i,["bottom"]):this._addStickyStyle(i,"bottom",0,!1)})}_removeStickyStyle(e,t){for(const r of t)e.style[r]="",e.classList.remove(this._borderCellCss[r]);MU.some(r=>-1===t.indexOf(r)&&e.style[r])?e.style.zIndex=this._getCalculatedZIndex(e):(e.style.zIndex="",this._needsPositionStickyOnElement&&(e.style.position=""),e.classList.remove(this._stickCellCss))}_addStickyStyle(e,t,i,r){e.classList.add(this._stickCellCss),r&&e.classList.add(this._borderCellCss[t]),e.style[t]=`${i}px`,e.style.zIndex=this._getCalculatedZIndex(e),this._needsPositionStickyOnElement&&(e.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(e){const t={top:100,bottom:10,left:1,right:1};let i=0;for(const r of MU)e.style[r]&&(i+=t[r]);return i?`${i}`:""}_getCellWidths(e,t=!0){if(!t&&this._cachedCellWidths.length)return this._cachedCellWidths;const i=[],r=e.children;for(let s=0;s<r.length;s++)i.push(r[s].getBoundingClientRect().width);return this._cachedCellWidths=i,i}_getStickyStartColumnPositions(e,t){const i=[];let r=0;for(let s=0;s<e.length;s++)t[s]&&(i[s]=r,r+=e[s]);return i}_getStickyEndColumnPositions(e,t){const i=[];let r=0;for(let s=e.length;s>0;s--)t[s]&&(i[s]=r,r+=e[s]);return i}}const F2=new u.OlP("CDK_SPL");let $M=(()=>{class n{constructor(t,i){this.viewContainer=t,this.elementRef=i}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.s_b),u.Y36(u.SBq))},n.\u0275dir=u.lG2({type:n,selectors:[["","rowOutlet",""]]}),n})(),GM=(()=>{class n{constructor(t,i){this.viewContainer=t,this.elementRef=i}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.s_b),u.Y36(u.SBq))},n.\u0275dir=u.lG2({type:n,selectors:[["","headerRowOutlet",""]]}),n})(),HM=(()=>{class n{constructor(t,i){this.viewContainer=t,this.elementRef=i}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.s_b),u.Y36(u.SBq))},n.\u0275dir=u.lG2({type:n,selectors:[["","footerRowOutlet",""]]}),n})(),qM=(()=>{class n{constructor(t,i){this.viewContainer=t,this.elementRef=i}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.s_b),u.Y36(u.SBq))},n.\u0275dir=u.lG2({type:n,selectors:[["","noDataRowOutlet",""]]}),n})(),ZM=(()=>{class n{get trackBy(){return this._trackByFn}set trackBy(t){this._trackByFn=t}get dataSource(){return this._dataSource}set dataSource(t){this._dataSource!==t&&this._switchDataSource(t)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(t){this._multiTemplateDataRows=is(t),this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(t){this._fixedLayout=is(t),this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}constructor(t,i,r,s,f,b,I,O,B,K,le,ge){this._differs=t,this._changeDetectorRef=i,this._elementRef=r,this._dir=f,this._platform=I,this._viewRepeater=O,this._coalescedStyleScheduler=B,this._viewportRuler=K,this._stickyPositioningListener=le,this._ngZone=ge,this._onDestroy=new g.x,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new u.vpe,this.viewChange=new C({start:0,end:Number.MAX_VALUE}),s||this._elementRef.nativeElement.setAttribute("role","table"),this._document=b,this._isNativeHtmlTable="TABLE"===this._elementRef.nativeElement.nodeName}ngOnInit(){this._setupStickyStyler(),this._isNativeHtmlTable&&this._applyNativeTableSections(),this._dataDiffer=this._differs.find([]).create((t,i)=>this.trackBy?this.trackBy(i.dataIndex,i.data):i),this._viewportRuler.change().pipe(Wo(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentChecked(){this._cacheRowDefs(),this._cacheColumnDefs();const i=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||i,this._forceRecalculateCellWidths=i,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}ngOnDestroy(){[this._rowOutlet.viewContainer,this._headerRowOutlet.viewContainer,this._footerRowOutlet.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(t=>{t.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),T2(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();const t=this._dataDiffer.diff(this._renderRows);if(!t)return this._updateNoDataRow(),void this.contentChanged.next();const i=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(t,i,(r,s,f)=>this._getEmbeddedViewArgs(r.item,f),r=>r.item.data,r=>{1===r.operation&&r.context&&this._renderCellTemplateForItem(r.record.item.rowDef,r.context)}),this._updateRowIndexContext(),t.forEachIdentityChange(r=>{i.get(r.currentIndex).context.$implicit=r.item.data}),this._updateNoDataRow(),this._ngZone&&u.R0b.isInAngularZone()?this._ngZone.onStable.pipe(Wn(1),Wo(this._onDestroy)).subscribe(()=>{this.updateStickyColumnStyles()}):this.updateStickyColumnStyles(),this.contentChanged.next()}addColumnDef(t){this._customColumnDefs.add(t)}removeColumnDef(t){this._customColumnDefs.delete(t)}addRowDef(t){this._customRowDefs.add(t)}removeRowDef(t){this._customRowDefs.delete(t)}addHeaderRowDef(t){this._customHeaderRowDefs.add(t),this._headerRowDefChanged=!0}removeHeaderRowDef(t){this._customHeaderRowDefs.delete(t),this._headerRowDefChanged=!0}addFooterRowDef(t){this._customFooterRowDefs.add(t),this._footerRowDefChanged=!0}removeFooterRowDef(t){this._customFooterRowDefs.delete(t),this._footerRowDefChanged=!0}setNoDataRow(t){this._customNoDataRow=t}updateStickyHeaderRowStyles(){const t=this._getRenderedRows(this._headerRowOutlet),r=this._elementRef.nativeElement.querySelector("thead");r&&(r.style.display=t.length?"":"none");const s=this._headerRowDefs.map(f=>f.sticky);this._stickyStyler.clearStickyPositioning(t,["top"]),this._stickyStyler.stickRows(t,s,"top"),this._headerRowDefs.forEach(f=>f.resetStickyChanged())}updateStickyFooterRowStyles(){const t=this._getRenderedRows(this._footerRowOutlet),r=this._elementRef.nativeElement.querySelector("tfoot");r&&(r.style.display=t.length?"":"none");const s=this._footerRowDefs.map(f=>f.sticky);this._stickyStyler.clearStickyPositioning(t,["bottom"]),this._stickyStyler.stickRows(t,s,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,s),this._footerRowDefs.forEach(f=>f.resetStickyChanged())}updateStickyColumnStyles(){const t=this._getRenderedRows(this._headerRowOutlet),i=this._getRenderedRows(this._rowOutlet),r=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...t,...i,...r],["left","right"]),this._stickyColumnStylesNeedReset=!1),t.forEach((s,f)=>{this._addStickyColumnStyles([s],this._headerRowDefs[f])}),this._rowDefs.forEach(s=>{const f=[];for(let b=0;b<i.length;b++)this._renderRows[b].rowDef===s&&f.push(i[b]);this._addStickyColumnStyles(f,s)}),r.forEach((s,f)=>{this._addStickyColumnStyles([s],this._footerRowDefs[f])}),Array.from(this._columnDefsByName.values()).forEach(s=>s.resetStickyChanged())}_getAllRenderRows(){const t=[],i=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let r=0;r<this._data.length;r++){let s=this._data[r];const f=this._getRenderRowsForData(s,r,i.get(s));this._cachedRenderRowsMap.has(s)||this._cachedRenderRowsMap.set(s,new WeakMap);for(let b=0;b<f.length;b++){let I=f[b];const O=this._cachedRenderRowsMap.get(I.data);O.has(I.rowDef)?O.get(I.rowDef).push(I):O.set(I.rowDef,[I]),t.push(I)}}return t}_getRenderRowsForData(t,i,r){return this._getRowDefs(t,i).map(f=>{const b=r&&r.has(f)?r.get(f):[];if(b.length){const I=b.shift();return I.dataIndex=i,I}return{data:t,rowDef:f,dataIndex:i}})}_cacheColumnDefs(){this._columnDefsByName.clear(),WM(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(i=>{this._columnDefsByName.has(i.name),this._columnDefsByName.set(i.name,i)})}_cacheRowDefs(){this._headerRowDefs=WM(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=WM(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=WM(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);const t=this._rowDefs.filter(i=>!i.when);this._defaultRowDef=t[0]}_renderUpdatedColumns(){const t=(f,b)=>f||!!b.getColumnsDiff(),i=this._rowDefs.reduce(t,!1);i&&this._forceRenderDataRows();const r=this._headerRowDefs.reduce(t,!1);r&&this._forceRenderHeaderRows();const s=this._footerRowDefs.reduce(t,!1);return s&&this._forceRenderFooterRows(),i||r||s}_switchDataSource(t){this._data=[],T2(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),t||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear()),this._dataSource=t}_observeRenderChanges(){if(!this.dataSource)return;let t;T2(this.dataSource)?t=this.dataSource.connect(this):function xX(n){return!!n&&(n instanceof L.y||(0,at.m)(n.lift)&&(0,at.m)(n.subscribe))}(this.dataSource)?t=this.dataSource:Array.isArray(this.dataSource)&&(t=c(this.dataSource)),this._renderChangeSubscription=t.pipe(Wo(this._onDestroy)).subscribe(i=>{this._data=i||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((t,i)=>this._renderRow(this._headerRowOutlet,t,i)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((t,i)=>this._renderRow(this._footerRowOutlet,t,i)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(t,i){const r=Array.from(i.columns||[]).map(b=>this._columnDefsByName.get(b)),s=r.map(b=>b.sticky),f=r.map(b=>b.stickyEnd);this._stickyStyler.updateStickyColumns(t,s,f,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(t){const i=[];for(let r=0;r<t.viewContainer.length;r++){const s=t.viewContainer.get(r);i.push(s.rootNodes[0])}return i}_getRowDefs(t,i){if(1==this._rowDefs.length)return[this._rowDefs[0]];let r=[];if(this.multiTemplateDataRows)r=this._rowDefs.filter(s=>!s.when||s.when(i,t));else{let s=this._rowDefs.find(f=>f.when&&f.when(i,t))||this._defaultRowDef;s&&r.push(s)}return r}_getEmbeddedViewArgs(t,i){return{templateRef:t.rowDef.template,context:{$implicit:t.data},index:i}}_renderRow(t,i,r,s={}){const f=t.viewContainer.createEmbeddedView(i.template,s,r);return this._renderCellTemplateForItem(i,s),f}_renderCellTemplateForItem(t,i){for(let r of this._getCellTemplates(t))v_.mostRecentCellOutlet&&v_.mostRecentCellOutlet._viewContainer.createEmbeddedView(r,i);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){const t=this._rowOutlet.viewContainer;for(let i=0,r=t.length;i<r;i++){const f=t.get(i).context;f.count=r,f.first=0===i,f.last=i===r-1,f.even=i%2==0,f.odd=!f.even,this.multiTemplateDataRows?(f.dataIndex=this._renderRows[i].dataIndex,f.renderIndex=i):f.index=this._renderRows[i].dataIndex}}_getCellTemplates(t){return t&&t.columns?Array.from(t.columns,i=>{const r=this._columnDefsByName.get(i);return t.extractCellTemplate(r)}):[]}_applyNativeTableSections(){const t=this._document.createDocumentFragment(),i=[{tag:"thead",outlets:[this._headerRowOutlet]},{tag:"tbody",outlets:[this._rowOutlet,this._noDataRowOutlet]},{tag:"tfoot",outlets:[this._footerRowOutlet]}];for(const r of i){const s=this._document.createElement(r.tag);s.setAttribute("role","rowgroup");for(const f of r.outlets)s.appendChild(f.elementRef.nativeElement);t.appendChild(s)}this._elementRef.nativeElement.appendChild(t)}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){const t=(i,r)=>i||r.hasStickyChanged();this._headerRowDefs.reduce(t,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(t,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(t,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){this._stickyStyler=new kX(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:c()).pipe(Wo(this._onDestroy)).subscribe(i=>{this._stickyStyler.direction=i,this.updateStickyColumnStyles()})}_getOwnDefs(t){return t.filter(i=>!i._table||i._table===this)}_updateNoDataRow(){const t=this._customNoDataRow||this._noDataRow;if(!t)return;const i=0===this._rowOutlet.viewContainer.length;if(i===this._isShowingNoDataRow)return;const r=this._noDataRowOutlet.viewContainer;if(i){const s=r.createEmbeddedView(t.templateRef),f=s.rootNodes[0];1===s.rootNodes.length&&f?.nodeType===this._document.ELEMENT_NODE&&(f.setAttribute("role","row"),f.classList.add(t._contentClassName))}else r.clear();this._isShowingNoDataRow=i}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.ZZ4),u.Y36(u.sBO),u.Y36(u.SBq),u.$8M("role"),u.Y36(g_,8),u.Y36(ft),u.Y36(Wl),u.Y36(oT),u.Y36(A2),u.Y36(rT),u.Y36(F2,12),u.Y36(u.R0b,8))},n.\u0275cmp=u.Xpm({type:n,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(t,i,r){if(1&t&&(u.Suo(r,jM,5),u.Suo(r,y_,5),u.Suo(r,UM,5),u.Suo(r,sT,5),u.Suo(r,aT,5)),2&t){let s;u.iGM(s=u.CRH())&&(i._noDataRow=s.first),u.iGM(s=u.CRH())&&(i._contentColumnDefs=s),u.iGM(s=u.CRH())&&(i._contentRowDefs=s),u.iGM(s=u.CRH())&&(i._contentHeaderRowDefs=s),u.iGM(s=u.CRH())&&(i._contentFooterRowDefs=s)}},viewQuery:function(t,i){if(1&t&&(u.Gf($M,7),u.Gf(GM,7),u.Gf(HM,7),u.Gf(qM,7)),2&t){let r;u.iGM(r=u.CRH())&&(i._rowOutlet=r.first),u.iGM(r=u.CRH())&&(i._headerRowOutlet=r.first),u.iGM(r=u.CRH())&&(i._footerRowOutlet=r.first),u.iGM(r=u.CRH())&&(i._noDataRowOutlet=r.first)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(t,i){2&t&&u.ekj("cdk-table-fixed-layout",i.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:"multiTemplateDataRows",fixedLayout:"fixedLayout"},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],features:[u._Bn([{provide:v1,useExisting:n},{provide:oT,useClass:mU},{provide:A2,useClass:SU},{provide:F2,useValue:null}])],ngContentSelectors:CX,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(t,i){1&t&&(u.F$t(wX),u.Hsn(0),u.Hsn(1,1),u.GkF(2,0)(3,1)(4,2)(5,3))},dependencies:[$M,GM,HM,qM],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2}),n})();function WM(n,e){return n.concat(Array.from(e))}let FX=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[x2]}),n})();const LX=[[["caption"]],[["colgroup"],["col"]]],NX=["caption","colgroup, col"];let AU=(()=>{class n extends ZM{constructor(){super(...arguments),this.stickyCssClass="mat-mdc-table-sticky",this.needsPositionStickyOnElement=!1}ngOnInit(){super.ngOnInit(),this._isNativeHtmlTable&&this._elementRef.nativeElement.querySelector("tbody").classList.add("mdc-data-table__content")}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275cmp=u.Xpm({type:n,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-mdc-table","mdc-data-table__table"],hostVars:2,hostBindings:function(t,i){2&t&&u.ekj("mdc-table-fixed-layout",i.fixedLayout)},exportAs:["matTable"],features:[u._Bn([{provide:ZM,useExisting:n},{provide:v1,useExisting:n},{provide:A2,useClass:SU},{provide:oT,useClass:mU},{provide:F2,useValue:null}]),u.qOj],ngContentSelectors:NX,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(t,i){1&t&&(u.F$t(LX),u.Hsn(0),u.Hsn(1,1),u.GkF(2,0)(3,1)(4,2)(5,3))},dependencies:[$M,GM,HM,qM],styles:[".mdc-data-table{border-radius:var(--mdc-shape-medium, 4px);border-width:1px;border-style:solid}.mdc-data-table .mdc-data-table__header-cell:first-child{border-top-left-radius:var(--mdc-shape-medium, 4px)}[dir=rtl] .mdc-data-table .mdc-data-table__header-cell:first-child,.mdc-data-table .mdc-data-table__header-cell:first-child[dir=rtl]{border-top-right-radius:var(--mdc-shape-medium, 4px);border-top-left-radius:0}.mdc-data-table .mdc-data-table__header-cell:last-child{border-top-right-radius:var(--mdc-shape-medium, 4px)}[dir=rtl] .mdc-data-table .mdc-data-table__header-cell:last-child,.mdc-data-table .mdc-data-table__header-cell:last-child[dir=rtl]{border-top-left-radius:var(--mdc-shape-medium, 4px);border-top-right-radius:0}.mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:first-child{border-bottom-left-radius:var(--mdc-shape-medium, 4px)}[dir=rtl] .mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:first-child,.mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:first-child[dir=rtl]{border-bottom-right-radius:var(--mdc-shape-medium, 4px);border-bottom-left-radius:0}.mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:last-child{border-bottom-right-radius:var(--mdc-shape-medium, 4px)}[dir=rtl] .mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:last-child,.mdc-data-table.mdc-data-table--without-footer .mdc-data-table__row:last-child .mdc-data-table__cell:last-child[dir=rtl]{border-bottom-left-radius:var(--mdc-shape-medium, 4px);border-bottom-right-radius:0}.mdc-data-table__cell,.mdc-data-table__header-cell{border-bottom-width:1px;border-bottom-style:solid}.mdc-data-table__pagination{border-top-width:1px;border-top-style:solid}.mdc-data-table__row:last-child .mdc-data-table__cell{border-bottom:none}.mdc-data-table__row{height:52px}.mdc-data-table__pagination{min-height:52px}.mdc-data-table__header-row{height:56px}.mdc-data-table__cell,.mdc-data-table__header-cell{padding:0 16px 0 16px}.mdc-data-table__header-cell--checkbox,.mdc-data-table__cell--checkbox{padding-left:4px;padding-right:0}[dir=rtl] .mdc-data-table__header-cell--checkbox,[dir=rtl] .mdc-data-table__cell--checkbox,.mdc-data-table__header-cell--checkbox[dir=rtl],.mdc-data-table__cell--checkbox[dir=rtl]{padding-left:0;padding-right:4px}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell,.mdc-data-table__cell[dir=rtl]{text-align:right}.mdc-data-table__cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__cell--numeric,.mdc-data-table__cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__cell--checkbox{width:1px}.mdc-data-table__header-cell{box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mdc-data-table__header-cell,.mdc-data-table__header-cell[dir=rtl]{text-align:right}.mdc-data-table__header-cell--checkbox{width:1px}.mdc-data-table__header-cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__header-cell--numeric,.mdc-data-table__header-cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__sort-icon-button{width:28px;height:28px;padding:2px;transform:rotate(0.0001deg);margin-left:4px;margin-right:0;opacity:0}.mdc-data-table__sort-icon-button .mdc-icon-button__focus-ring{max-height:28px;max-width:28px}.mdc-data-table__sort-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:28px;height:28px;margin-top:0px;margin-bottom:0px;margin-right:0px;margin-left:0px}.mdc-data-table__sort-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:28px;max-width:28px}.mdc-data-table__sort-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:28px;left:50%;width:28px;transform:translate(-50%, -50%)}[dir=rtl] .mdc-data-table__sort-icon-button,.mdc-data-table__sort-icon-button[dir=rtl]{margin-left:0;margin-right:4px}.mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button{margin-left:0;margin-right:4px}[dir=rtl] .mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button,.mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button[dir=rtl]{margin-left:4px;margin-right:0}.mdc-data-table__header-cell--sorted-descending .mdc-data-table__sort-icon-button{transform:rotate(-180deg)}.mdc-data-table__sort-icon-button:focus,.mdc-data-table__header-cell:hover .mdc-data-table__sort-icon-button,.mdc-data-table__header-cell--sorted .mdc-data-table__sort-icon-button{opacity:1}.mdc-data-table__header-cell-wrapper{align-items:center;display:inline-flex;vertical-align:middle}.mdc-data-table__header-cell--with-sort{cursor:pointer}.mdc-data-table__sort-status-label{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.mdc-data-table--sticky-header .mdc-data-table__header-cell{position:sticky;top:0;z-index:1}.mdc-data-table{-webkit-overflow-scrolling:touch;display:inline-flex;flex-direction:column;box-sizing:border-box;position:relative}.mdc-data-table__table-container{-webkit-overflow-scrolling:touch;overflow-x:auto;width:100%}.mdc-data-table__table{min-width:100%;border:0;white-space:nowrap;border-spacing:0;table-layout:fixed}.mdc-data-table__header-cell{box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mdc-data-table__header-cell,.mdc-data-table__header-cell[dir=rtl]{text-align:right}.mdc-data-table__header-cell--checkbox{width:1px}.mdc-data-table__header-cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__header-cell--numeric,.mdc-data-table__header-cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__sort-icon-button{width:28px;height:28px;padding:2px;transform:rotate(0.0001deg);margin-left:4px;margin-right:0;opacity:0}.mdc-data-table__sort-icon-button .mdc-icon-button__focus-ring{max-height:28px;max-width:28px}.mdc-data-table__sort-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:28px;height:28px;margin-top:0px;margin-bottom:0px;margin-right:0px;margin-left:0px}.mdc-data-table__sort-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:28px;max-width:28px}.mdc-data-table__sort-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:28px;left:50%;width:28px;transform:translate(-50%, -50%)}[dir=rtl] .mdc-data-table__sort-icon-button,.mdc-data-table__sort-icon-button[dir=rtl]{margin-left:0;margin-right:4px}.mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button{margin-left:0;margin-right:4px}[dir=rtl] .mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button,.mdc-data-table__header-cell--numeric .mdc-data-table__sort-icon-button[dir=rtl]{margin-left:4px;margin-right:0}.mdc-data-table__header-cell--sorted-descending .mdc-data-table__sort-icon-button{transform:rotate(-180deg)}.mdc-data-table__sort-icon-button:focus,.mdc-data-table__header-cell:hover .mdc-data-table__sort-icon-button,.mdc-data-table__header-cell--sorted .mdc-data-table__sort-icon-button{opacity:1}.mdc-data-table__header-cell-wrapper{align-items:center;display:inline-flex;vertical-align:middle}.mdc-data-table__header-cell--with-sort{cursor:pointer}.mdc-data-table__sort-status-label{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell,.mdc-data-table__cell[dir=rtl]{text-align:right}.mdc-data-table__cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__cell--numeric,.mdc-data-table__cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__cell--checkbox{width:1px}.mdc-data-table__pagination{box-sizing:border-box;display:flex;justify-content:flex-end}.mdc-data-table__pagination-trailing{margin-left:4px;margin-right:0;align-items:center;display:flex;flex-wrap:wrap;justify-content:flex-end}[dir=rtl] .mdc-data-table__pagination-trailing,.mdc-data-table__pagination-trailing[dir=rtl]{margin-left:0;margin-right:4px}.mdc-data-table__pagination-navigation{align-items:center;display:flex}.mdc-data-table__pagination-button{margin-left:0;margin-right:4px}[dir=rtl] .mdc-data-table__pagination-button .mdc-button__icon,.mdc-data-table__pagination-button .mdc-button__icon[dir=rtl]{transform:rotate(180deg)}[dir=rtl] .mdc-data-table__pagination-button,.mdc-data-table__pagination-button[dir=rtl]{margin-left:4px;margin-right:0}.mdc-data-table__pagination-total{margin-left:14px;margin-right:36px;white-space:nowrap}[dir=rtl] .mdc-data-table__pagination-total,.mdc-data-table__pagination-total[dir=rtl]{margin-left:36px;margin-right:14px}.mdc-data-table__pagination-rows-per-page{margin-left:0;margin-right:22px;align-items:center;display:inline-flex}[dir=rtl] .mdc-data-table__pagination-rows-per-page,.mdc-data-table__pagination-rows-per-page[dir=rtl]{margin-left:22px;margin-right:0}.mdc-data-table__pagination-rows-per-page-label{margin-left:0;margin-right:12px;white-space:nowrap}[dir=rtl] .mdc-data-table__pagination-rows-per-page-label,.mdc-data-table__pagination-rows-per-page-label[dir=rtl]{margin-left:12px;margin-right:0}.mdc-data-table__pagination-rows-per-page-select{min-width:var(--mdc-menu-min-width, 80px);margin:8px 0}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor{width:100%;min-width:80px}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor{height:36px}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor .mdc-floating-label--float-above{font-size:.75rem}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-data-table__pagination-rows-per-page-select .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-data-table__pagination-rows-per-page-select .mdc-select__dropdown-icon{width:20px;height:20px}.mdc-data-table__pagination-rows-per-page-select.mdc-select--outlined .mdc-select__anchor :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 56px)}.mdc-data-table__pagination-rows-per-page-select .mdc-list-item.mdc-list-item--with-one-line{height:36px}.mdc-data-table__progress-indicator{display:none;position:absolute;width:100%}.mdc-data-table--in-progress .mdc-data-table__progress-indicator{display:block}.mdc-data-table__scrim{background-color:var(--mdc-theme-surface, #fff);height:100%;opacity:.32;position:absolute;top:0;width:100%}mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.mat-mdc-table-sticky{position:sticky !important}.mat-mdc-table{table-layout:auto;white-space:normal}mat-row.mat-mdc-row,mat-header-row.mat-mdc-header-row,mat-footer-row.mat-mdc-footer-row{border-bottom:none}.mat-mdc-table tbody,.mat-mdc-table tfoot,.mat-mdc-table thead,.mat-mdc-cell,.mat-mdc-footer-cell,.mat-mdc-header-row,.mat-mdc-row,.mat-mdc-footer-row,.mat-mdc-table .mat-mdc-header-cell{background:inherit}.mat-mdc-table .mat-mdc-row:hover,.mat-mdc-table .mat-mdc-footer-row:hover{background-color:inherit}.mat-mdc-table mat-header-row.mat-mdc-header-row,.mat-mdc-table mat-row.mat-mdc-row,.mat-mdc-table mat-footer-row.mat-mdc-footer-cell{height:unset}mat-header-cell.mat-mdc-header-cell,mat-cell.mat-mdc-cell,mat-footer-cell.mat-mdc-footer-cell{align-self:stretch}"],encapsulation:2}),n})(),L2=(()=>{class n extends b1{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275dir=u.lG2({type:n,selectors:[["","matCellDef",""]],features:[u._Bn([{provide:b1,useExisting:n}]),u.qOj]}),n})(),N2=(()=>{class n extends x1{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275dir=u.lG2({type:n,selectors:[["","matHeaderCellDef",""]],features:[u._Bn([{provide:x1,useExisting:n}]),u.qOj]}),n})(),z2=(()=>{class n extends y_{get name(){return this._name}set name(t){this._setNameInput(t)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275dir=u.lG2({type:n,selectors:[["","matColumnDef",""]],inputs:{sticky:"sticky",name:["matColumnDef","name"]},features:[u._Bn([{provide:y_,useExisting:n},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),u.qOj]}),n})(),B2=(()=>{class n extends M2{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275dir=u.lG2({type:n,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-mdc-header-cell","mdc-data-table__header-cell"],features:[u.qOj]}),n})(),V2=(()=>{class n extends D2{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275dir=u.lG2({type:n,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:[1,"mat-mdc-cell","mdc-data-table__cell"],features:[u.qOj]}),n})(),PU=(()=>{class n extends sT{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275dir=u.lG2({type:n,selectors:[["","matHeaderRowDef",""]],inputs:{columns:["matHeaderRowDef","columns"],sticky:["matHeaderRowDefSticky","sticky"]},features:[u._Bn([{provide:sT,useExisting:n}]),u.qOj]}),n})(),OU=(()=>{class n extends UM{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275dir=u.lG2({type:n,selectors:[["","matRowDef",""]],inputs:{columns:["matRowDefColumns","columns"],when:["matRowDefWhen","when"]},features:[u._Bn([{provide:UM,useExisting:n}]),u.qOj]}),n})(),kU=(()=>{class n extends O2{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275cmp=u.Xpm({type:n,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-mdc-header-row","mdc-data-table__header-row"],exportAs:["matHeaderRow"],features:[u._Bn([{provide:O2,useExisting:n}]),u.qOj],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,i){1&t&&u.GkF(0,0)},dependencies:[v_],encapsulation:2}),n})(),RU=(()=>{class n extends R2{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275cmp=u.Xpm({type:n,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-mdc-row","mdc-data-table__row"],exportAs:["matRow"],features:[u._Bn([{provide:R2,useExisting:n}]),u.qOj],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,i){1&t&&u.GkF(0,0)},dependencies:[v_],encapsulation:2}),n})(),FU=(()=>{class n extends jM{constructor(){super(...arguments),this._contentClassName="mat-mdc-no-data-row"}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=u.n5z(n)))(i||n)}}(),n.\u0275dir=u.lG2({type:n,selectors:[["ng-template","matNoDataRow",""]],features:[u._Bn([{provide:jM,useExisting:n}]),u.qOj]}),n})(),qX=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[Ha,FX,Ha]}),n})();class WX extends IK{get data(){return this._data.value}set data(e){e=Array.isArray(e)?e:[],this._data.next(e),this._renderChangesSubscription||this._filterData(e)}get filter(){return this._filter.value}set filter(e){this._filter.next(e),this._renderChangesSubscription||this._filterData(this.data)}get sort(){return this._sort}set sort(e){this._sort=e,this._updateChangeSubscription()}get paginator(){return this._paginator}set paginator(e){this._paginator=e,this._updateChangeSubscription()}constructor(e=[]){super(),this._renderData=new C([]),this._filter=new C(""),this._internalPageChanges=new g.x,this._renderChangesSubscription=null,this.sortingDataAccessor=(t,i)=>{const r=t[i];if(tV(r)){const s=Number(r);return s<9007199254740991?s:r}return r},this.sortData=(t,i)=>{const r=i.active,s=i.direction;return r&&""!=s?t.sort((f,b)=>{let I=this.sortingDataAccessor(f,r),O=this.sortingDataAccessor(b,r);const B=typeof I,K=typeof O;B!==K&&("number"===B&&(I+=""),"number"===K&&(O+=""));let le=0;return null!=I&&null!=O?I>O?le=1:I<O&&(le=-1):null!=I?le=1:null!=O&&(le=-1),le*("asc"==s?1:-1)}):t},this.filterPredicate=(t,i)=>{const r=Object.keys(t).reduce((f,b)=>f+t[b]+"\u25ec","").toLowerCase(),s=i.trim().toLowerCase();return-1!=r.indexOf(s)},this._data=new C(e),this._updateChangeSubscription()}_updateChangeSubscription(){const e=this._sort?(0,p_.T)(this._sort.sortChange,this._sort.initialized):c(null),t=this._paginator?(0,p_.T)(this._paginator.page,this._internalPageChanges,this._paginator.initialized):c(null),r=Le([this._data,this._filter]).pipe((0,de.U)(([b])=>this._filterData(b))),s=Le([r,e]).pipe((0,de.U)(([b])=>this._orderData(b))),f=Le([s,t]).pipe((0,de.U)(([b])=>this._pageData(b)));this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=f.subscribe(b=>this._renderData.next(b))}_filterData(e){return this.filteredData=null==this.filter||""===this.filter?e:e.filter(t=>this.filterPredicate(t,this.filter)),this.paginator&&this._updatePaginator(this.filteredData.length),this.filteredData}_orderData(e){return this.sort?this.sortData(e.slice(),this.sort):e}_pageData(e){if(!this.paginator)return e;const t=this.paginator.pageIndex*this.paginator.pageSize;return e.slice(t,t+this.paginator.pageSize)}_updatePaginator(e){Promise.resolve().then(()=>{const t=this.paginator;if(t&&(t.length=e,t.pageIndex>0)){const i=Math.ceil(t.length/t.pageSize)-1||0,r=Math.min(t.pageIndex,i);r!==t.pageIndex&&(t.pageIndex=r,this._internalPageChanges.next())}})}connect(){return this._renderChangesSubscription||this._updateChangeSubscription(),this._renderData}disconnect(){this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=null}}class LU extends WX{}class U2{}class gv{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),f=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(f):this.headers.set(s,[f])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof gv?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new gv;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof gv?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let f=this.headers.get(t);if(!f)return;f=f.filter(b=>-1===s.indexOf(b)),0===f.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,f)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class YX{encodeKey(e){return zU(e)}encodeValue(e){return zU(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const XX=/%(\d[a-f0-9])/gi,QX={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function zU(n){return encodeURIComponent(n).replace(XX,(e,t)=>QX[t]??e)}function YM(n){return`${n}`}class _v{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new YX,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function KX(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[f,b]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],I=t.get(f)||[];I.push(b),t.set(f,I)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(YM):[YM(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new _v({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(YM(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(YM(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class JX{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function BU(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function VU(n){return typeof Blob<"u"&&n instanceof Blob}function UU(n){return typeof FormData<"u"&&n instanceof FormData}class lT{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function eQ(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new gv),this.context||(this.context=new JX),this.params){const f=this.params.toString();if(0===f.length)this.urlWithParams=t;else{const b=t.indexOf("?");this.urlWithParams=t+(-1===b?"?":b<t.length-1?"&":"")+f}}else this.params=new _v,this.urlWithParams=t}serializeBody(){return null===this.body?null:BU(this.body)||VU(this.body)||UU(this.body)||function tQ(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof _v?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||UU(this.body)?null:VU(this.body)?this.body.type||null:BU(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof _v?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,f=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,b=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let I=e.headers||this.headers,O=e.params||this.params;const B=e.context??this.context;return void 0!==e.setHeaders&&(I=Object.keys(e.setHeaders).reduce((K,le)=>K.set(le,e.setHeaders[le]),I)),e.setParams&&(O=Object.keys(e.setParams).reduce((K,le)=>K.set(le,e.setParams[le]),O)),new lT(t,i,s,{params:O,headers:I,context:B,reportProgress:b,responseType:r,withCredentials:f})}}var Yl=(()=>((Yl=Yl||{})[Yl.Sent=0]="Sent",Yl[Yl.UploadProgress=1]="UploadProgress",Yl[Yl.ResponseHeader=2]="ResponseHeader",Yl[Yl.DownloadProgress=3]="DownloadProgress",Yl[Yl.Response=4]="Response",Yl[Yl.User=5]="User",Yl))();class nQ{constructor(e,t=200,i="OK"){this.headers=e.headers||new gv,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class j2 extends nQ{constructor(e={}){super(e),this.type=Yl.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new j2({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}function $2(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let G2=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof lT)s=t;else{let I,O;I=r.headers instanceof gv?r.headers:new gv(r.headers),r.params&&(O=r.params instanceof _v?r.params:new _v({fromObject:r.params})),s=new lT(t,i,void 0!==r.body?r.body:null,{headers:I,context:r.context,params:O,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const f=c(s).pipe(or(I=>this.handler.handle(I)));if(t instanceof lT||"events"===r.observe)return f;const b=f.pipe(Yt(I=>I instanceof j2));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return b.pipe((0,de.U)(I=>{if(null!==I.body&&!(I.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return I.body}));case"blob":return b.pipe((0,de.U)(I=>{if(null!==I.body&&!(I.body instanceof Blob))throw new Error("Response is not a Blob.");return I.body}));case"text":return b.pipe((0,de.U)(I=>{if(null!==I.body&&"string"!=typeof I.body)throw new Error("Response is not a string.");return I.body}));default:return b.pipe((0,de.U)(I=>I.body))}case"response":return b;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new _v).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,$2(r,i))}post(t,i,r={}){return this.request("POST",t,$2(r,i))}put(t,i,r={}){return this.request("PUT",t,$2(r,i))}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(U2))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();const mQ=["*"];let XM;function cT(n){return function gQ(){if(void 0===XM&&(XM=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(XM=n.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return XM}()?.createHTML(n)||n}function YU(n){return Error(`Unable to find icon with the name "${n}"`)}function KU(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function XU(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class Rb{constructor(e,t,i){this.url=e,this.svgText=t,this.options=i}}let QM=(()=>{class n{constructor(t,i,r,s){this._httpClient=t,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,s){return this._addSvgIconConfig(t,i,new Rb(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,s){const f=this._sanitizer.sanitize(u.q3G.HTML,r);if(!f)throw XU(r);const b=cT(f);return this._addSvgIconConfig(t,i,new Rb("",b,s))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new Rb(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const s=this._sanitizer.sanitize(u.q3G.HTML,i);if(!s)throw XU(i);const f=cT(s);return this._addSvgIconSetConfig(t,new Rb("",f,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(u.q3G.RESOURCE_URL,t);if(!i)throw KU(t);const r=this._cachedIconsByUrl.get(i);return r?c(JM(r)):this._loadSvgIconFromConfig(new Rb(t,null)).pipe(vi(s=>this._cachedIconsByUrl.set(i,s)),(0,de.U)(s=>JM(s)))}getNamedSvgIcon(t,i=""){const r=QU(i,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const f=this._iconSetConfigs.get(i);return f?this._getSvgFromIconSetConfigs(t,f):Ot(YU(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?c(JM(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe((0,de.U)(i=>JM(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?c(r):ry(i.filter(f=>!f.svgText).map(f=>this._loadSvgIconSetFromConfig(f).pipe(Dr(b=>{const O=`Loading icon set URL: ${this._sanitizer.sanitize(u.q3G.RESOURCE_URL,f.url)} failed: ${b.message}`;return this._errorHandler.handleError(new Error(O)),c(null)})))).pipe((0,de.U)(()=>{const f=this._extractIconWithNameFromAnySet(t,i);if(!f)throw YU(t);return f}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const f=this._svgElementFromConfig(s),b=this._extractSvgIconFromSet(f,t,s.options);if(b)return b}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(vi(i=>t.svgText=i),(0,de.U)(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?c(null):this._fetchIcon(t).pipe(vi(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const s=t.querySelector(`[id="${i}"]`);if(!s)return null;const f=s.cloneNode(!0);if(f.removeAttribute("id"),"svg"===f.nodeName.toLowerCase())return this._setSvgAttributes(f,r);if("symbol"===f.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(f),r);const b=this._svgElementFromString(cT("<svg></svg>"));return b.appendChild(f),this._setSvgAttributes(b,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString(cT("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:f,value:b}=r[s];"id"!==f&&i.setAttribute(f,b)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){const{url:i,options:r}=t,s=r?.withCredentials??!1;if(!this._httpClient)throw function _Q(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const f=this._sanitizer.sanitize(u.q3G.RESOURCE_URL,i);if(!f)throw KU(i);const b=this._inProgressUrlFetches.get(f);if(b)return b;const I=this._httpClient.get(f,{responseType:"text",withCredentials:s}).pipe((0,de.U)(O=>cT(O)),Fr(()=>this._inProgressUrlFetches.delete(f)),(0,P3.B)());return this._inProgressUrlFetches.set(f,I),I}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(QU(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](i,t);if(s)return vQ(s)?new Rb(s.url,null,s.options):new Rb(s,null)}}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(G2,8),u.LFG(Eh),u.LFG(ft,8),u.LFG(u.qLn))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function JM(n){return n.cloneNode(!0)}function QU(n,e){return n+":"+e}function vQ(n){return!(!n.url||!n.options)}const bQ=p2(class{constructor(n){this._elementRef=n}}),xQ=new u.OlP("MAT_ICON_DEFAULT_OPTIONS"),wQ=new u.OlP("mat-icon-location",{providedIn:"root",factory:function CQ(){const n=(0,u.f3M)(ft),e=n?n.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),JU=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],EQ=JU.map(n=>`[${n}]`).join(", "),TQ=/^url\(['"]?#(.*?)['"]?\)$/;let ej=(()=>{class n extends bQ{get inline(){return this._inline}set inline(t){this._inline=is(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(t,i,r,s,f,b){super(t),this._iconRegistry=i,this._location=s,this._errorHandler=f,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=qe.w0.EMPTY,b&&(b.color&&(this.color=this.defaultColor=b.color),b.fontSet&&(this.fontSet=b.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),i.forEach(r=>t.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,s)=>{r.forEach(f=>{s.setAttribute(f.name,`url('${t}#${f.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(EQ),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)JU.forEach(f=>{const b=i[s],I=b.getAttribute(f),O=I?I.match(TQ):null;if(O){let B=r.get(b);B||(B=[],r.set(b,B)),B.push({name:f,value:O[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(Wn(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${s.message}`))})}}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq),u.Y36(QM),u.$8M("aria-hidden"),u.Y36(wQ),u.Y36(u.qLn),u.Y36(xQ,8))},n.\u0275cmp=u.Xpm({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(t,i){2&t&&(u.uIk("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet)("fontIcon",i._usingFontIcon()?i.fontIcon:null),u.ekj("mat-icon-inline",i.inline)("mat-icon-no-color","primary"!==i.color&&"accent"!==i.color&&"warn"!==i.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[u.qOj],ngContentSelectors:mQ,decls:1,vars:0,template:function(t,i){1&t&&(u.F$t(),u.Hsn(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),n})(),IQ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[Ha,Ha]}),n})();const SQ=["*",[["mat-toolbar-row"]]],MQ=["*","mat-toolbar-row"],DQ=p2(class{constructor(n){this._elementRef=n}});let AQ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=u.lG2({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),n})(),tj=(()=>{class n extends DQ{constructor(t,i,r){super(t),this._platform=i,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(u.SBq),u.Y36(Wl),u.Y36(ft))},n.\u0275cmp=u.Xpm({type:n,selectors:[["mat-toolbar"]],contentQueries:function(t,i,r){if(1&t&&u.Suo(r,AQ,5),2&t){let s;u.iGM(s=u.CRH())&&(i._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,i){2&t&&u.ekj("mat-toolbar-multiple-rows",i._toolbarRows.length>0)("mat-toolbar-single-row",0===i._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[u.qOj],ngContentSelectors:MQ,decls:2,vars:0,template:function(t,i){1&t&&(u.F$t(SQ),u.Hsn(0),u.Hsn(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),n})(),PQ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[Ha,Ha]}),n})();function OQ(n,e){1&n&&(u.TgZ(0,"div",21),u._uU(1," Obteniendo correos... "),u.qZA())}function kQ(n,e){if(1&n&&(u.TgZ(0,"div",22),u._uU(1),u.qZA()),2&n){const t=u.oxw();u.xp6(1),u.hij(" Tienes ",t.mensajesPendientes," mensajes pendientes de lectura. ")}}function RQ(n,e){1&n&&(u.TgZ(0,"mat-header-cell",23),u._uU(1," Nombre "),u.qZA())}function FQ(n,e){if(1&n&&(u.TgZ(0,"mat-cell"),u._uU(1),u.qZA()),2&n){const t=e.$implicit;u.xp6(1),u.hij(" ",t.nombre," ")}}function LQ(n,e){1&n&&(u.TgZ(0,"mat-header-cell",24),u._uU(1," Asunto "),u.qZA())}function NQ(n,e){if(1&n&&(u.TgZ(0,"mat-cell"),u._uU(1),u.qZA()),2&n){const t=e.$implicit;u.xp6(1),u.hij(" ",t.asunto," ")}}function zQ(n,e){1&n&&(u.TgZ(0,"mat-header-cell",25),u._uU(1," Fecha "),u.qZA())}function BQ(n,e){if(1&n&&(u.TgZ(0,"mat-cell"),u._uU(1),u.ALo(2,"date"),u.qZA()),2&n){const t=e.$implicit;u.xp6(1),u.hij(" ",u.xi3(2,1,t.fecha.toDate(),"dd/MM/yyyy HH:mm")," ")}}function VQ(n,e){1&n&&u._UZ(0,"mat-header-row")}const UQ=function(n){return{"no-leido":n}};function jQ(n,e){if(1&n){const t=u.EpF();u.TgZ(0,"mat-row",26),u.NdJ("click",function(){const s=u.CHM(t).$implicit,f=u.oxw();return u.KtG(f.abrirMensaje(s))}),u.qZA()}2&n&&u.Q6J("ngClass",u.VKq(1,UQ,"NO_LEIDO"===e.$implicit.estado))}function $Q(n,e){1&n&&(u.TgZ(0,"tr",27)(1,"td",28),u._uU(2,"No hay coincidencias"),u.qZA()())}const GQ=function(){return[25,50,100]};let HQ=(()=>{class n{constructor(t,i,r){this.messageService=t,this.authService=i,this.router=r,this.bandejaEntrada=[],this.displayedColumns=["nombre","fecha","asunto"],this.dataSource=new LU,this.obteniendoCorreos=!1,this.mensajesPendientes=0,this.asignarDataSource()}ngOnInit(){this.obteniendoCorreos=!0,this.messageService.getBandejaEntradaData().subscribe(t=>{this.paginator._intl.itemsPerPageLabel="N\xba de correos por p\xe1gina:",this.paginator._intl.getRangeLabel=(i,r,s)=>{const b=(i+1)*r;return`Del ${i*r+1} al ${b>s?s:b} (Total: ${s})`},this.bandejaEntrada=t,this.mensajesPendientes=this.bandejaEntrada.filter(i=>"NO_LEIDO"===i.estado).length,this.ordenarTabla({active:"fecha",direction:"desc"}),this.asignarDataSource(),this.obteniendoCorreos=!1})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}asignarDataSource(){this.dataSource=new LU(this.bandejaEntrada),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}ordenarTabla(t){const{active:i,direction:r}=t;!i||""===r||(this.bandejaEntrada=this.bandejaEntrada.sort((s,f)=>{const b="asc"===r;switch(i){case"nombre":return this.compare(s.nombre,f.nombre,b);case"fecha":return this.compare(s.fecha.seconds,f.fecha.seconds,b);case"asunto":return this.compare(s.asunto,f.asunto,b);default:return 0}}))}compare(t,i,r){return(t<i?-1:1)*(r?1:-1)}aplicarFiltro(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}abrirMensaje(t){this.router.navigateByUrl(`/private/email-list/${t.id}`)}logout(){this.authService.logout(),this.router.navigateByUrl("/private/auth-login")}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(e2),u.Y36(n2),u.Y36(Lo))},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-internal-email-list"]],viewQuery:function(t,i){if(1&t&&(u.Gf(EU,7),u.Gf(_2,7)),2&t){let r;u.iGM(r=u.CRH())&&(i.paginator=r.first),u.iGM(r=u.CRH())&&(i.sort=r.first)}},decls:26,vars:8,consts:[[1,"internal-email-list-container"],[1,"toolbar"],["mat-icon-button","",3,"click"],[1,"listado-emails"],["class","obteniendo-correos",4,"ngIf"],[1,"bandeja-entrada",3,"hidden"],["class","mensajes-pendientes",4,"ngIf"],[1,"input-group"],["type","text","id","busqueda-tabla","placeholder","Buscar en la bandeja de entrada...",3,"keyup"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource","matSortChange"],["matColumnDef","nombre"],["mat-sort-header","nombre",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","asunto"],["mat-sort-header","asunto",4,"matHeaderCellDef"],["matColumnDef","fecha"],["mat-sort-header","fecha",4,"matHeaderCellDef"],[4,"matHeaderRowDef"],["class","mat-row",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],["class","mat-row-no-mails",4,"matNoDataRow"],["aria-label","Select page",1,"mat-elevation-z8",3,"pageSizeOptions"],[1,"obteniendo-correos"],[1,"mensajes-pendientes"],["mat-sort-header","nombre"],["mat-sort-header","asunto"],["mat-sort-header","fecha"],[1,"mat-row",3,"ngClass","click"],[1,"mat-row-no-mails"],["colspan","3"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"mat-toolbar",1),u._uU(2," Hasspro - Bandeja de entrada del formulario de contacto "),u.TgZ(3,"button",2),u.NdJ("click",function(){return i.logout()}),u.TgZ(4,"mat-icon"),u._uU(5,"logout"),u.qZA()()(),u.TgZ(6,"div",3),u.YNc(7,OQ,2,0,"div",4),u.TgZ(8,"div",5),u.YNc(9,kQ,2,1,"div",6),u.TgZ(10,"div",7)(11,"input",8),u.NdJ("keyup",function(s){return i.aplicarFiltro(s)}),u.qZA()(),u.TgZ(12,"table",9),u.NdJ("matSortChange",function(s){return i.ordenarTabla(s)}),u.ynx(13,10),u.YNc(14,RQ,2,0,"mat-header-cell",11),u.YNc(15,FQ,2,1,"mat-cell",12),u.BQk(),u.ynx(16,13),u.YNc(17,LQ,2,0,"mat-header-cell",14),u.YNc(18,NQ,2,1,"mat-cell",12),u.BQk(),u.ynx(19,15),u.YNc(20,zQ,2,0,"mat-header-cell",16),u.YNc(21,BQ,3,4,"mat-cell",12),u.BQk(),u.YNc(22,VQ,1,0,"mat-header-row",17),u.YNc(23,jQ,1,3,"mat-row",18),u.YNc(24,$Q,3,0,"tr",19),u.qZA(),u._UZ(25,"mat-paginator",20),u.qZA()()()),2&t&&(u.xp6(7),u.Q6J("ngIf",i.obteniendoCorreos),u.xp6(1),u.Q6J("hidden",i.obteniendoCorreos),u.xp6(1),u.Q6J("ngIf",i.mensajesPendientes>0),u.xp6(3),u.Q6J("dataSource",i.dataSource),u.xp6(10),u.Q6J("matHeaderRowDef",i.displayedColumns),u.xp6(1),u.Q6J("matRowDefColumns",i.displayedColumns),u.xp6(2),u.Q6J("pageSizeOptions",u.DdM(7,GQ)))},dependencies:[Mn,Ro,y2,ej,EU,_2,BY,AU,N2,PU,z2,L2,OU,B2,V2,kU,RU,FU,tj,Us],styles:[".internal-email-list-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;background-color:var(--principal-color);color:var(--principal-color-light)}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]{margin:30px 50px}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .obteniendo-correos[_ngcontent-%COMP%]{text-align:center;background-color:var(--principal-color-light);color:var(--principal-color);padding:30px 10px;border-radius:10px;text-shadow:1px 1px 3px var(--principal-color-40);font-size:18px}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mensajes-pendientes[_ngcontent-%COMP%]{text-align:center;background-color:var(--principal-color);color:var(--principal-color-light);padding:30px 10px;border-radius:10px;text-shadow:1px 1px 3px var(--principal-color-40);font-size:18px;margin-bottom:30px}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:40px;padding:0 10px;border:1px solid var(--principal-color);border-radius:5px;box-sizing:border-box;font-size:14px;font-weight:700;color:var(--principal-color);margin-bottom:30px}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-column-acciones[_ngcontent-%COMP%]{max-width:100px}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-row-no-mails[_ngcontent-%COMP%]{text-align:center}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-row-no-mails[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:30px 10px}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{cursor:pointer;background-color:var(--principal-color-light);transition:.2s linear all}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]{color:var(--principal-color)}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:hover{background-color:#fff;transition:.2s linear all}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:hover   mat-cell[_ngcontent-%COMP%]{color:#000}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .no-leido[_ngcontent-%COMP%]{background-color:var(--principal-color);font-weight:900;transition:.2s linear all}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .no-leido[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]{color:var(--principal-color-light)}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .no-leido[_ngcontent-%COMP%]:hover{background-color:#4384a4;transition:.2s linear all}.internal-email-list-container[_ngcontent-%COMP%]   .listado-emails[_ngcontent-%COMP%]   .no-leido[_ngcontent-%COMP%]:hover   mat-cell[_ngcontent-%COMP%]{color:#fff}"]}),n})();function qQ(n,e){1&n&&(u.TgZ(0,"div",6),u._uU(1," Obteniendo los datos del mensaje... "),u.qZA())}function ZQ(n,e){if(1&n&&(u.TgZ(0,"div",7)(1,"div",8)(2,"div",9),u._uU(3,"Nombre"),u.qZA(),u.TgZ(4,"div",10),u._uU(5),u.qZA()(),u.TgZ(6,"div",8)(7,"div",9),u._uU(8,"Email"),u.qZA(),u.TgZ(9,"div",10),u._uU(10),u.qZA()(),u.TgZ(11,"div",8)(12,"div",9),u._uU(13,"Fecha de env\xedo"),u.qZA(),u.TgZ(14,"div",10),u._uU(15),u.ALo(16,"date"),u.qZA()(),u.TgZ(17,"div",8)(18,"div",9),u._uU(19,"Asunto"),u.qZA(),u.TgZ(20,"div",10),u._uU(21),u.qZA()(),u.TgZ(22,"div",8)(23,"div",9),u._uU(24,"Mensaje"),u.qZA(),u.TgZ(25,"div",10),u._uU(26),u.qZA()()()),2&n){const t=u.oxw();u.xp6(5),u.Oqu(t.datosEmail.nombre),u.xp6(5),u.Oqu(t.datosEmail.email),u.xp6(5),u.Oqu(u.xi3(16,5,t.datosEmail.fecha.toDate(),"dd/MM/yyyy HH:mm")),u.xp6(6),u.Oqu(t.datosEmail.asunto),u.xp6(5),u.Oqu(t.datosEmail.mensaje)}}let WQ=(()=>{class n{constructor(t,i,r){this.authService=t,this.messageService=i,this.router=r,this.obteniendoDatos=!1}ngOnInit(){this.obteniendoDatos=!0;const t=this.router.url.split("/")[3];this.messageService.getEmailById(t).subscribe(i=>{this.datosEmail=i,this.obteniendoDatos=!1})}ngOnDestroy(){this.messageService.updateEmailALeido(this.datosEmail)}goToList(){this.router.navigateByUrl("/private/email-list")}logout(){this.authService.logout(),this.router.navigateByUrl("/private/auth-login")}}return n.\u0275fac=function(t){return new(t||n)(u.Y36(n2),u.Y36(e2),u.Y36(Lo))},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-internal-email-detail"]],decls:12,vars:2,consts:[[1,"internal-email-detail-container"],[1,"toolbar"],["mat-icon-button","","matTooltip","Volver a la bandeja de entrada",3,"click"],["mat-icon-button","",3,"click"],["class","obteniendo-datos",4,"ngIf"],["class","email-detail",4,"ngIf"],[1,"obteniendo-datos"],[1,"email-detail"],[1,"group"],[1,"title"],[1,"value"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"mat-toolbar",1)(2,"div")(3,"button",2),u.NdJ("click",function(){return i.goToList()}),u.TgZ(4,"mat-icon"),u._uU(5,"arrow_back"),u.qZA()(),u._uU(6," Hasspro - Detalles del mensaje "),u.qZA(),u.TgZ(7,"button",3),u.NdJ("click",function(){return i.logout()}),u.TgZ(8,"mat-icon"),u._uU(9,"logout"),u.qZA()()(),u.YNc(10,qQ,2,0,"div",4),u.YNc(11,ZQ,27,8,"div",5),u.qZA()),2&t&&(u.xp6(10),u.Q6J("ngIf",i.obteniendoDatos),u.xp6(1),u.Q6J("ngIf",i.datosEmail&&!i.obteniendoDatos))},dependencies:[Ro,y2,ej,tj,wU,Us],styles:[".internal-email-detail-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;background-color:var(--principal-color);color:var(--principal-color-light)}.internal-email-detail-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;gap:10px;height:100%}.internal-email-detail-container[_ngcontent-%COMP%]   .obteniendo-datos[_ngcontent-%COMP%], .internal-email-detail-container[_ngcontent-%COMP%]   .email-detail[_ngcontent-%COMP%]{background-color:var(--principal-color-light);color:#000;padding:30px 10px;border-radius:10px;margin:20px 40px;box-shadow:1px 1px 3px var(--principal-color-light-80)}.internal-email-detail-container[_ngcontent-%COMP%]   .obteniendo-datos[_ngcontent-%COMP%]{text-align:center}.internal-email-detail-container[_ngcontent-%COMP%]   .email-detail[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;flex-direction:column;gap:30px}.internal-email-detail-container[_ngcontent-%COMP%]   .email-detail[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:14px;width:100%}.internal-email-detail-container[_ngcontent-%COMP%]   .email-detail[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box;font-weight:700;font-size:18px;text-shadow:1px 1px 1px rgba(0,0,0,.2509803922);padding-left:20px}.internal-email-detail-container[_ngcontent-%COMP%]   .email-detail[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:16px;color:var(--principal-color);padding-left:40px;white-space:break-spaces}"]}),n})(),q2=(()=>{class n{constructor(t){this.router=t}canActivate(t,i){const{url:r}=i;if(r.indexOf("private/email-list")>-1){if(!localStorage.getItem("hasspro_internal_token"))return this.router.navigateByUrl("private/auth-login"),!1}else if(r.indexOf("private/auth-login")>-1&&localStorage.getItem("hasspro_internal_token"))return this.router.navigateByUrl("private/email-list"),!0;return!0}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Lo))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function YQ(n,e){if(1&n&&(u.TgZ(0,"div",15)(1,"div",16),u._UZ(2,"img",17),u.qZA(),u.TgZ(3,"div",18)(4,"div",19),u._uU(5),u.qZA(),u.TgZ(6,"div",20),u._uU(7),u.qZA()()()),2&n){const t=e.$implicit,i=u.oxw();u.xp6(2),u.Q6J("src",i.pathImg+t.img,u.LSH),u.xp6(3),u.hij(" ",t.title," "),u.xp6(2),u.hij(" ",t.text," ")}}let KQ=(()=>{class n{constructor(){this.pathImg="../../../assets/",this.vCardsTop=[{title:"\xbfC\xf3mo lo hacemos?",text:"Crear el escenario futuro, saber a que nos enfrentamos de manera consciente y lo m\xe1s realista posible, nos ayuda a anticiparnos y no cometer error y gastos imprevisibles en el futuro."},{title:"\xbfC\xf3mo trabajamos?",text:"Hasspro te proporciona el desarrollo de planes de negocio para restaurantes, bares y discotecas."},{title:"\xbfQuieres delegar funciones?",text:"En Hasspro te ofrecemos una gesti\xf3n integral de todo el restaurante o bar, adapt\xe1ndonos a tus necesidades."},{title:"\xbfQuieres traspasar tu restaurante?",text:"Cansado de tu restaurante o local, quieres dejarlo, hasspro te hace propuesta de adquisici\xf3n, total o parcial."}],this.vDescripcion=[{title:"Propuestas de Compra de Establecimientos",text:"Ya se trate de un local de nueva apertura, existente o cerrado  nuestra la empresa HASSPRO puede dise\xf1ar integralmente una oferta atractiva para que puedas sacarle el m\xe1ximo partido a tu establecimiento, soluciones adecuada para que tus necesidades queden totalmente cubiertas.",img:"presupuestos-hasspro.webp"},{title:"Montaje de un Establecimiento Nuevo",text:"\xbfSue\xf1as con abrir tu propio local en el sector de la hosteler\xeda? Te acompa\xf1amos en todo el proceso, desde la concepci\xf3n inicial hasta la gran inauguraci\xf3n. Nuestro experimentado equipo trabajar\xe1 codo con codo contigo, proporcion\xe1ndote orientaci\xf3n ya asesoramiento personalizado en cada paso del camino. Desde la selecci\xf3n del lugar ideal, la planificaci\xf3n de la distribuci\xf3n del espacio, la adquisici\xf3n de equipos y mobiliario, hasta la creaci\xf3n de un plan de marketing ejecutivo, estaremos a tu lado para hacer realidad tu visi\xf3n.",img:"propuestas-hasspro.webp"},{title:"Cesi\xf3n Funcional del Establecimiento",text:"\xbfTe gustar\xeda liberarte de las responsabilidades diarias de la gesti\xf3n de tu negocio sin perder su potencial? Nuestra empresa te ofrece la opci\xf3n de ceder las funciones de tu establecimiento en nuestras manos expertas. Conf\xeda en nuestro equipo altamente capacitado para llevar a cabo la gesti\xf3n operativa, la supervisi\xf3n del personal, el control de costos y la optimizaci\xf3n de los procesos. De esta manera, podr\xe1s dedicar m\xe1s tiempo a otros aspectos importantes de tu vida o incluso a la expansi\xf3n de tus negocios.",img:"soluciones-hasspro.webp"}]}ngOnInit(){window.scroll({top:0,left:0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-adquisicion-establecimientos"]],decls:20,vars:1,consts:[[1,"servicios-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"servicios-items-container"],[1,"title"],[1,"listado-servicios"],[1,"card-service"],[1,"subtitle"],[1,"description"],[1,"descripcion-servicios"],[1,"title-descripcion"],["class","item",4,"ngFor","ngForOf"],[1,"item"],[1,"contenedor-imagen"],[3,"src"],[1,"texto"],[1,"subtitulo"],[1,"descripcion"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),u._UZ(4,"img",4),u.qZA(),u.TgZ(5,"h1",5),u._uU(6," ASISTENTE PROFESIONAL DE HOSTELER\xcdA "),u.qZA()()(),u.TgZ(7,"div",6)(8,"div",7),u._uU(9,"Adquisici\xf3n de establecimientos"),u.qZA(),u.TgZ(10,"div",8)(11,"div",9)(12,"div",10),u._uU(13," \xbfC\xf3mo trabajamos? "),u.qZA(),u.TgZ(14,"div",11),u._uU(15," Hasspro te proporciona el desarrollo de planes y soluciones adaptadas a las necesidades de cada negocio. "),u.qZA()()(),u.TgZ(16,"div",12)(17,"div",13),u._uU(18,"Ofrecemos:"),u.qZA(),u.YNc(19,YQ,8,3,"div",14),u.qZA()()()),2&t&&(u.xp6(19),u.Q6J("ngForOf",i.vDescripcion))},dependencies:[Qi],styles:[".servicios-container{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.servicios-container .header-container{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.servicios-container .header-container .cortinilla{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.servicios-container .header-container .cortinilla .logo img{width:240px;height:auto}.servicios-container .header-container .cortinilla h1{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.servicios-container .servicios-items-container{display:flex;align-items:center;justify-content:center;flex-direction:column;padding:100px 40px;width:calc(100% - 80px)}.servicios-container .servicios-items-container .title{max-width:100%;box-sizing:border-box;font-size:36px;min-width:800px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10% 30px}.servicios-container .servicios-items-container .texto-descriptivo{max-width:1400px;font-size:20px;text-align:center}.servicios-container .servicios-items-container .listado-servicios{display:flex;align-items:center;justify-content:center;gap:50px;flex-direction:row;flex-wrap:wrap;max-width:100%;width:1200px;margin-top:40px}.servicios-container .servicios-items-container .listado-servicios .card-service{max-width:100%;background-color:var(--principal-color-light);color:var(--principal-color);border-radius:10px;box-shadow:3px 3px 10px var(--principal-color-light-40);padding:40px 60px}.servicios-container .servicios-items-container .listado-servicios .card-service .subtitle{font-size:26px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding-bottom:20px;border-bottom:1px solid var(--principal-color-80)}.servicios-container .servicios-items-container .listado-servicios .card-service .description{line-height:24x;font-size:20px;color:var(--principal-color-bold);text-align:center;margin:40px 20px 10px}.servicios-container .servicios-items-container .listado-servicios .card-service .description span.negrita{color:var(--principal-color-bold)!important;font-weight:900!important}.servicios-container .servicios-items-container .listado-servicios .item-list{min-width:270px;max-width:330px;height:60px;width:27%;background-color:var(--principal-color-light);box-shadow:1px 2px 4px var(--principal-color-light-40);border-radius:10px;padding:30px 20px;display:flex;align-items:flex-start;justify-content:center;flex-direction:column;gap:40px}.servicios-container .servicios-items-container .listado-servicios .item-list .title-item-list{width:100%;display:flex;align-items:center;justify-content:flex-start;flex-direction:row;gap:20px}.servicios-container .servicios-items-container .listado-servicios .item-list .title-item-list .icon,.servicios-container .servicios-items-container .listado-servicios .item-list .title-item-list .icon img{width:40px;height:40px}.servicios-container .servicios-items-container .listado-servicios .item-list .title-item-list .text{font-size:22px;text-align:start;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container .servicios-items-container .listado-servicios .item-list .content-item-list{display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;gap:20px}.servicios-container .servicios-items-container .listado-servicios .item-list .content-item-list .item-content-item-list{display:flex;align-items:center;justify-content:center;flex-direction:row;gap:10px}.servicios-container .servicios-items-container .listado-servicios .item-list .content-item-list .item-content-item-list img{width:20px;height:20px}.servicios-container .servicios-items-container .listado-servicios .item-list .content-item-list .item-content-item-list span{font-size:16px}.servicios-container .servicios-items-container .descripcion-servicios{margin-top:60px;max-width:100%}.servicios-container .servicios-items-container .descripcion-servicios .title-descripcion{font-size:36px;width:100%;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);margin-bottom:30px}.servicios-container .servicios-items-container .descripcion-servicios .item{padding:40px 20px;max-width:100%;width:1000px;border-top:1px solid var(--principal-color-light);box-sizing:border-box;display:flex;align-items:center;justify-content:flex-start;flex-wrap:wrap;gap:50px}.servicios-container .servicios-items-container .descripcion-servicios .item:last-child{border-bottom:1px solid var(--principal-color-light)}.servicios-container .servicios-items-container .descripcion-servicios .item .contenedor-imagen{width:180px;height:180px;max-width:300px;border-radius:4px;box-shadow:3px 3px 10px var(--principal-color-80)}.servicios-container .servicios-items-container .descripcion-servicios .item .contenedor-imagen img{width:180px;height:180px;border-radius:4px}.servicios-container .servicios-items-container .descripcion-servicios .item .texto{flex:1;margin-top:10px;text-align:center}.servicios-container .servicios-items-container .descripcion-servicios .item .texto .subtitulo{font-size:22px;color:var(--principal-color-bold);margin-bottom:15px}.servicios-container .servicios-items-container .descripcion-servicios .item .texto .descripcion{color:var(--principal-color);font-size:18px}.servicios-container .solicita-nuestros-servicios{padding:50px 0 100px}.servicios-container .solicita-nuestros-servicios .texto .title{max-width:100%;box-sizing:border-box;font-size:36px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container .solicita-nuestros-servicios .boton{text-align:center}.servicios-container .solicita-nuestros-servicios .boton .boton-contacta-con-nosotros{font-size:20px;color:var(--principal-color);background-color:var(--principal-color-light);border:1px solid var(--principal-color);border-radius:10px;padding:10px 20px;margin-top:20px;cursor:pointer;transition:all .3s ease-in-out}.servicios-container .solicita-nuestros-servicios .boton .boton-contacta-con-nosotros:hover{background-color:var(--principal-color);color:var(--principal-color-light)}@media screen and (max-width: 1184px){.servicios-container .servicios-items-container .listado-servicios .card-service{height:auto}}@media screen and (min-width: 600px) and (max-width: 959px){.servicios-container .header-container .cortinilla{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container .header-container .cortinilla .logo img{width:240px;height:auto}.servicios-container .header-container .cortinilla h1{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container .servicios-items-container{padding:100px 5px;width:calc(100% - 10px)}.servicios-container .servicios-items-container .title{max-width:100%;box-sizing:border-box;min-width:100%;padding:0 10px 30px}.servicios-container .servicios-items-container .subtitle{min-width:100%;padding-left:0;padding-right:0}.servicios-container .servicios-items-container .listado-servicios{min-width:100%}.servicios-container .servicios-items-container .listado-servicios .card-service{padding:40px 10px}.servicios-container .servicios-items-container .listado-servicios .card-service .description{font-size:18px}.servicios-container .servicios-items-container .listado-servicios .item-list{width:100%}.servicios-container .servicios-items-container .descripcion-servicios .item{align-items:center;justify-content:center;flex-direction:column}.servicios-container .servicios-items-container .descripcion-servicios .item .contenedor-imagen,.servicios-container .servicios-items-container .descripcion-servicios .item .contenedor-imagen img{width:100%;height:auto}.servicios-container .servicios-items-container .descripcion-servicios .item .texto{text-align:center}}@media screen and (max-width: 599px){.servicios-container .header-container .cortinilla{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container .header-container .cortinilla .logo img{width:240px;height:auto}.servicios-container .header-container .cortinilla h1{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container .servicios-items-container{padding:100px 5px;width:calc(100% - 10px)}.servicios-container .servicios-items-container .title{max-width:100%;box-sizing:border-box;min-width:100%;padding:0 10px 30px}.servicios-container .servicios-items-container .subtitle{min-width:100%;padding-left:0;padding-right:0}.servicios-container .servicios-items-container .listado-servicios{min-width:100%}.servicios-container .servicios-items-container .listado-servicios .item-list{width:100%}.servicios-container .servicios-items-container .descripcion-servicios .item{align-items:center;justify-content:center}.servicios-container .servicios-items-container .descripcion-servicios .item .contenedor-imagen,.servicios-container .servicios-items-container .descripcion-servicios .item .contenedor-imagen img{width:100%;height:auto}.servicios-container .servicios-items-container .descripcion-servicios .item .texto{text-align:center}}\n"],encapsulation:2}),n})();function XQ(n,e){if(1&n&&(u.TgZ(0,"div",14),u._UZ(1,"div",15),u.qZA()),2&n){const t=e.$implicit;u.xp6(1),u.Q6J("innerHTML",t,u.oJD)}}function QQ(n,e){if(1&n&&(u.TgZ(0,"div",9)(1,"div",10),u._uU(2),u.qZA(),u.TgZ(3,"div",11)(4,"div",12),u._uU(5),u.qZA(),u.YNc(6,XQ,2,1,"div",13),u.qZA()()),2&n){const t=e.$implicit,i=e.index;u.xp6(2),u.hij(" ",i+1," "),u.xp6(3),u.hij(" ",t.title," "),u.xp6(1),u.Q6J("ngForOf",t.parrafos)}}const JQ=[{path:"private",children:[{path:"auth-login",component:d7,canActivate:[q2]},{path:"email-list",component:HQ,canActivate:[q2]},{path:"email-list/:id",component:WQ,canActivate:[q2]},{path:"**",redirectTo:"auth-login"}]},{path:"",component:e7,children:[{path:"home",component:Mx},{path:"servicios",component:r7},{path:"contacto",component:PW},{path:"sobre-hasspro",component:OW},{path:"por-que-contratarnos",component:(()=>{class n{constructor(){this.vMensajes=[{title:"Iniciar un proyecto nuevo",parrafos:["En caso de que nuestro restaurante a\xfan no haya abierto, el tener a un lado un asesor y gestor de establecimientos de hosteler\xeda <b>nos ahorrar\xe1 mucho tiempo y preocupaciones antes de la apertura</b>. Ya que un profesional nos ayudar\xe1 a definir la propuesta  que se ofrecer\xe1 al p\xfablico desde el principio.","Tambi\xe9n nos aconsejar\xe1 en la compra de maquinaria, vajilla y utensilios para el restaurante, adem\xe1s de ayudarnos con el dise\xf1o en general para lograr una buena gesti\xf3n del espacio."]},{title:"Tramitaci\xf3n, gesti\xf3n y evoluci\xf3n de la documentaci\xf3n",parrafos:["Hay documentaci\xf3n en hosteler\xeda compleja, con poco tiempo para tramitar y presentar, adem\xe1s sin sinergia con t\xfa establecimiento y para colmo con un sin fin de tramites para tener tu establecimiento a punto.","Imagina una empresa que muestre sinergias entre la documentaci\xf3n, costes, rentabilidades, sala, stock, proveedores, personal... que pueda reflejar un realidad real y poder trabajar en un realidad futura <b>somos el profesional que estas buscado</b>."]},{title:"T\xe9cnicas de venta y promoci\xf3n de nuevos productos",parrafos:["Muchos clientes llegan a los restaurantes buscando recomendaciones a la hora de comer y es demasiado habitual que los equipos de sala no est\xe9n preparados para ofrecerlas.","Por eso esta es una de las funciones m\xe1s importantes de un asesor gastron\xf3mico, ya que <b>proporciona a los equipos de sala herramientas y t\xe9cnicas de venta sugestiva</b> para que nuestros empleados puedan aconsejar correctamente a nuestros clientes y adem\xe1s aumentar la facturaci\xf3n."]},{title:"B\xfasqueda y gesti\xf3n de proveedores",parrafos:["Disponer de buenos proveedores es de vital importancia para nuestro restaurante, porque ellos inciden directamente en la calidad y el coste de los productos que ofrecemos a nuestros clientes.","Y el papel de asesor es de mucha utilidad en este punto, puesto que <b>nos ayudar\xe1 a encontrar los mejores proveedores y a negociar con ellos</b> para obtener los mejores precios y aumentar la rentabilidad de nuestro restaurante."]},{title:"Seleccionar y formar al personal",parrafos:["Hoy en d\xeda, muchos de los problemas que tienen los restaurantes est\xe1n relacionados con la mala gesti\xf3n del personal, as\xed que, tener empleados responsables y formados sin duda marcar\xe1 la diferencia con nuestra competencia.","El asesor se encargar\xe1 de buscar al personal adecuado para nuestro restaurante y de entrenarlos</b> para que ofrezcan una buena imagen del negocio y que nuestros clientes se sientan siempre c\xf3modos y bien atendidos."]},{title:"Mejorar la gesti\xf3n en la cocina",parrafos:["Algunas de las soluciones que nos puede ofrecer un asesor gastron\xf3mico a la hora de gestionar mejor nuestra cocina son las siguientes: calcular los escandallos de cada plato, analizar la rentabilidad de nuestro men\xfa, corregor los problemas sobre los objetivos que se tienen establecidos o implementar y dar seguimiento al control de calidad."]},{title:"Mantenernos constantemente actualizados",parrafos:["Se recomienda que los restaurantes est\xe9n en constante renovaci\xf3n, es decir, hacer cambios que ayuden a <b>adaptar nuestro negocio a las nuevas modalidades y exigencias de los comensales</b>.","Algunos de estos cambios pueden ser: la renovaci\xf3n del men\xfa, detalles que ayuden a que el cliente se sienta especial o la organizaci\xf3n de eventos que llamen la atenci\xf3n del p\xfablico, entre otros muchos m\xe1s."]}]}ngOnInit(){window.scroll({top:0,left:0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-por-que-contratarnos"]],decls:11,vars:1,consts:[[1,"servicios-container"],[1,"header-container"],[1,"cortinilla"],[1,"logo","animate__animated","animate__fadeIn"],["src","../../../assets/logo-hasspro-sin-fondo.png"],[1,"animate__animated","animate__fadeIn"],[1,"como-trabajamos-container"],[1,"title"],["class","razon-container",4,"ngFor","ngForOf"],[1,"razon-container"],[1,"number"],[1,"razones"],[1,"title-razon"],["class","razon",4,"ngFor","ngForOf"],[1,"razon"],[3,"innerHTML"]],template:function(t,i){1&t&&(u.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),u._UZ(4,"img",4),u.qZA(),u.TgZ(5,"h1",5),u._uU(6," ASISTENTE PROFESIONAL DE HOSTELER\xcdA "),u.qZA()()(),u.TgZ(7,"div",6)(8,"div",7),u._uU(9,"\xbfPor qu\xe9 contratarnos?"),u.qZA(),u.YNc(10,QQ,7,3,"div",8),u.qZA()()),2&t&&(u.xp6(10),u.Q6J("ngForOf",i.vMensajes))},dependencies:[Qi],styles:[".razon-container{display:flex;align-items:flex-start;justify-content:center;gap:40px;border-bottom:1px solid var(--principal-color-40);color:var(--principal-color);padding-bottom:30px}.razon-container .number{width:100px;font-size:50px}.razon-container .razones{max-width:800px}.razon-container .razones .title-razon{font-size:26px;font-weight:800;margin-bottom:14px}.razon-container .razones .razon div{margin-bottom:10px}.razon-container .razones .razon div b{color:var(--principal-color-bold)}\n",".servicios-container{display:flex;align-items:center;justify-content:center;width:100%;flex-direction:column}.servicios-container .header-container{background-image:url(fondo-header-home.35c2ce85435e538a.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;width:100%}.servicios-container .header-container .cortinilla{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:80px 0;box-sizing:border-box}.servicios-container .header-container .cortinilla .logo img{width:240px;height:auto}.servicios-container .header-container .cortinilla h1{font-family:Cormorant,serif;font-size:2.5rem;font-weight:700;color:var(--principal-color-light);text-align:center;text-shadow:1px 1px 5px var(--principal-color-light-40);border-top:1px solid var(--principal-color-light);border-bottom:1px solid var(--principal-color-light);padding:8px 20px;box-sizing:border-box}.servicios-container .como-trabajamos-container{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:50px;flex-wrap:wrap;width:calc(100% - 180px);padding:50px 50px 100px;margin:70px 40px 20px;background-color:var(--principal-color-light-80);border-radius:5px;box-shadow:2px 2px 4px var(--principal-color-light)}.servicios-container .como-trabajamos-container .title{max-width:100%;box-sizing:border-box;font-size:36px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10% 30px;border-bottom:1px solid var(--principal-color-80)}.servicios-container .como-trabajamos-container .como-trabajamos-item{display:flex;align-items:center;justify-content:center;gap:10px;flex-direction:column;max-width:800px}.servicios-container .como-trabajamos-container .como-trabajamos-item .subtitle{font-weight:900;font-size:20px;text-align:center;color:var(--principal-color);text-shadow:1px 2px 2px var(--principal-color-20)}.servicios-container .como-trabajamos-container .como-trabajamos-item .text{font-size:18px;text-align:center;color:var(--principal-color)}.servicios-container .nuestros-servicios-container{display:flex;align-items:center;justify-content:center;flex-direction:column;flex-wrap:wrap;gap:20px;width:calc(100% - 180px);box-sizing:border-box;padding:50px 50px 100px;margin:20px 40px}.servicios-container .nuestros-servicios-container .title{max-width:100%;box-sizing:border-box;font-size:36px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 50px}.servicios-container .nuestros-servicios-container .subtitle{font-size:24px;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40);padding:0 10% 30px;border-bottom:1px solid var(--principal-color-80);text-align:center}.servicios-container .nuestros-servicios-container .items-nuestros-servicios{display:flex;align-items:center;justify-content:center;flex-direction:row;flex-wrap:wrap;gap:20px}.servicios-container .nuestros-servicios-container .items-nuestros-servicios .item-nuestros-servicios{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;width:40%;padding:40px;min-height:380px;background-color:var(--principal-color-light-80);border-radius:5px;box-shadow:2px 2px 4px var(--principal-color-light)}.servicios-container .nuestros-servicios-container .items-nuestros-servicios .item-nuestros-servicios:first-child{width:75%;min-height:250px;gap:40px}.servicios-container .nuestros-servicios-container .items-nuestros-servicios .item-nuestros-servicios .title,.servicios-container .nuestros-servicios-container .items-nuestros-servicios .item-nuestros-servicios .subtitle,.servicios-container .nuestros-servicios-container .items-nuestros-servicios .item-nuestros-servicios .text{color:var(--principal-color);width:100%;text-align:center}.servicios-container .nuestros-servicios-container .items-nuestros-servicios .item-nuestros-servicios .title{max-width:100%;box-sizing:border-box;font-size:28px;font-weight:900;text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container .nuestros-servicios-container .items-nuestros-servicios .item-nuestros-servicios .subtitle{font-size:24px;font-weight:700;border-bottom:none;text-shadow:1px 1px 2px var(--principal-color-20)}.servicios-container .nuestros-servicios-container .items-nuestros-servicios .item-nuestros-servicios .text{font-size:18px}.servicios-container .nuestros-servicios-container .items-nuestros-servicios .item-nuestros-servicios .ver-mas button{background-color:var(--principal-color);color:var(--principal-color-light);border:none;border-radius:5px;padding:10px 20px;font-size:18px;font-weight:700;cursor:pointer;transition:all .3s ease-in-out;margin-top:30px}.servicios-container .solicita-nuestros-servicios{padding:50px 0 100px}.servicios-container .solicita-nuestros-servicios .texto .title{max-width:100%;box-sizing:border-box;font-size:36px;text-align:center;color:var(--principal-color);text-shadow:1px 1px 2px var(--principal-color-40)}.servicios-container .solicita-nuestros-servicios .boton{text-align:center}.servicios-container .solicita-nuestros-servicios .boton .boton-contacta-con-nosotros{font-size:20px;color:var(--principal-color);background-color:var(--principal-color-light);border:1px solid var(--principal-color);border-radius:10px;padding:10px 20px;margin-top:20px;cursor:pointer;transition:all .3s ease-in-out}.servicios-container .solicita-nuestros-servicios .boton .boton-contacta-con-nosotros:hover{background-color:var(--principal-color);color:var(--principal-color-light)}@media screen and (min-width: 600px) and (max-width: 959px){.servicios-container .header-container .cortinilla{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container .header-container .cortinilla .logo img{width:240px;height:auto}.servicios-container .header-container .cortinilla h1{font-size:1.8rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container .nuestros-servicios-container{padding:50px 20px 100px}.servicios-container .nuestros-servicios-container .items-nuestros-servicios .item-nuestros-servicios{width:90%}}@media screen and (max-width: 599px){.servicios-container .header-container .cortinilla{display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#00000080;padding:140px 0 80px}.servicios-container .header-container .cortinilla .logo img{width:240px;height:auto}.servicios-container .header-container .cortinilla h1{font-size:1.6rem;width:calc(100% - 16px);padding:8px 20px}.servicios-container .como-trabajamos-container{width:calc(100% - 40px);padding:50px 10px 100px;margin:20px 10px}.servicios-container .como-trabajamos-container .title{max-width:100%;box-sizing:border-box;padding:0 10px 30px;text-align:center}.servicios-container .nuestros-servicios-container{width:calc(100% - 40px);padding:50px 10px 100px;margin:20px 10px}.servicios-container .nuestros-servicios-container .title{max-width:100%;box-sizing:border-box;padding:0}.servicios-container .nuestros-servicios-container .subtitle{padding:0 0 30px}.servicios-container .nuestros-servicios-container .items-nuestros-servicios .item-nuestros-servicios{width:100%!important;padding:40px 10px!important}}\n"],encapsulation:2}),n})()},{path:"servicios/gestion-documentacion",component:LW},{path:"servicios/gestion-participativa-sala",component:BW},{path:"servicios/consultoria-financiera",component:a7},{path:"servicios/adquisicion-establecimientos",component:KQ},{path:"servicios/desarrollo-establecimientos",component:o7},{path:"**",redirectTo:"home"}]},{path:"**",redirectTo:"/home",pathMatch:"full"}];let eJ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[Tx.forRoot(JQ),Tx]}),n})(),tJ=(()=>{class n{constructor(){this.title="hasspro"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=u.Xpm({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){1&t&&u._UZ(0,"router-outlet")},dependencies:[Gu]}),n})();const nj={firebase:{apiKey:"AIzaSyDXN9asVVTHL7WB2g-jbrATljfaRk4v8e0",authDomain:"hasspro-bb0e4.firebaseapp.com",databaseURL:"https://hasspro-bb0e4-default-rtdb.europe-west1.firebasedatabase.app",projectId:"hasspro-bb0e4",storageBucket:"hasspro-bb0e4.appspot.com",messagingSenderId:"386256142322",appId:"1:386256142322:web:2241bf83271e673de5356b",measurementId:"G-X98710WS66"},production:!1,mapboxToken:"pk.eyJ1Ijoic2VyZ2lvZ2RldiIsImEiOiJja3J2eW9zcGIwYmR2MnVxamJ3MGk0djRiIn0.R1ANSOBYyCstt-QxZcI5pg"};var iJ=De(655);class uT{constructor(e){return e}}const ij="analytics",rj=fM.async,oJ=f_(I8,!0),sJ=f_(YB,!0),aJ=f_(D8,!0);let Z2=(()=>{class n{constructor(t,i,r){let s;this.disposables=[],(0,Q.registerVersion)("angularfire",hv.full,"user-tracking"),this.initialized=i.runOutsideAngular(()=>new Promise(f=>{s=f})),rj().then(()=>{const f=r.get(uT);f?this.disposables=[HZ(t).subscribe(b=>{aJ(f,b?.uid),s()})]:s()})}ngOnDestroy(){this.disposables.forEach(t=>t.unsubscribe())}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(bM),u.LFG(u.R0b),u.LFG(u.zs3))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();const oj="firebase_screen_id",W2="outlet",dT="screen_class",sj="screen_name";let vJ=Math.floor(Math.random()*(Math.pow(2,32)-1))-Math.pow(2,31);const Y2={},bJ=n=>{const e=[n[dT],n[W2]].join("#");if(Y2.hasOwnProperty(e))return Y2[e];{const t=vJ++;return Y2[e]=t,t}};let aj=(()=>{class n{constructor(t,i,r,s,f,b){(0,Q.registerVersion)("angularfire",hv.full,"screen-tracking"),rj().then(()=>{const I=b.get(uT);!t||!I||s.runOutsideAngular(()=>{this.disposable=((n,e,t)=>n.events.pipe(Yt(r=>r instanceof P_)).pipe(dn(r=>{var s;const b=(null===(s=n.parseUrl(n.url.replace(/(?:\().+(?:\))/g,ge=>ge.replace("://",":///"))).root.children[r.snapshot.outlet])||void 0===s?void 0:s.toString())||"",I=n.routerState.root.children.map(ge=>ge).find(ge=>ge.outlet===r.snapshot.outlet);if(!I)return c(null);let O=I;for(;O.firstChild;)O=O.firstChild;const B=O.pathFromRoot.map(ge=>{var Te;return null===(Te=ge.routeConfig)||void 0===Te?void 0:Te.path}).filter(ge=>ge).join("/")||"/",K={[sj]:B,page_path:`/${b}`,firebase_event_origin:"auto",firebase_screen:B,[W2]:r.snapshot.outlet};e&&(K.page_title=e.getTitle());let le=I.component;if(le){if(le===ug){let ge=r.snapshot;for(;ge.firstChild;)ge=ge.firstChild;le=ge.component}}else le=r.snapshot.component;if("string"==typeof le)return c(Object.assign(Object.assign({},K),{[dT]:le}));if(le){const ge=t.resolveComponentFactory(le);return c(Object.assign(Object.assign({},K),{[dT]:ge.selector}))}return c(null)}),Yt(r=>!!r),(0,de.U)(r=>Object.assign({firebase_screen_class:r[dT],[oj]:bJ(r)},r)),function nJ(n,e,t,i){return(0,Xe.e)((r,s)=>{let f;e&&"function"!=typeof e?({duration:t,element:f,connector:i}=e):f=e;const b=new Map,I=Te=>{b.forEach(Te),Te(s)},O=Te=>I(Ge=>Ge.error(Te));let B=0,K=!1;const le=new be.Q(s,Te=>{try{const Ge=n(Te);let Je=b.get(Ge);if(!Je){b.set(Ge,Je=i?i():new g.x);const Qt=function ge(Te,Ge){const Je=new L.y(Qt=>{B++;const xn=Ge.subscribe(Qt);return()=>{xn.unsubscribe(),0==--B&&K&&le.unsubscribe()}});return Je.key=Te,Je}(Ge,Je);if(s.next(Qt),t){const xn=(0,be.x)(Je,()=>{Je.complete(),xn?.unsubscribe()},void 0,void 0,()=>b.delete(Ge));le.add((0,Ut.Xf)(t(Qt)).subscribe(xn))}}Je.next(f?f(Te):Te)}catch(Ge){O(Ge)}},()=>I(Te=>Te.complete()),O,()=>b.clear(),()=>(K=!0,0===B));r.subscribe(le)})}(r=>r[W2]),(0,yn.z)(r=>r.pipe(wM((s,f)=>JSON.stringify(s)===JSON.stringify(f)),_n(void 0),xM(),(0,de.U)(([s,f])=>s?Object.assign({firebase_previous_class:s[dT],firebase_previous_screen:s[sj],firebase_previous_id:s[oj]},f):f)))))(t,i,r).pipe(dn(O=>(0,iJ.mG)(this,void 0,void 0,function*(){return f&&(yield f.initialized),sJ(I,"screen_view",O)}))).subscribe()})})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(Lo,8),u.LFG(gn,8),u.LFG(u._Vd),u.LFG(u.R0b),u.LFG(Z2,8),u.LFG(u.zs3))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();const K2=new u.OlP("angularfire2.analytics-instances");function CJ(n){return(e,t)=>{if(!fM.sync())return null;const i=e.runOutsideAngular(()=>n(t));return new uT(i)}}const EJ={provide:class rJ{constructor(){return VE(ij)}},deps:[[new u.FiY,K2]]},TJ={provide:uT,useFactory:function wJ(n,e){if(!fM.sync())return null;const t=BE(ij,n,e);return t&&new uT(t)},deps:[[new u.FiY,K2],fv]};let IJ=(()=>{class n{constructor(t,i){(0,Q.registerVersion)("angularfire",hv.full,"analytics")}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(aj,8),u.LFG(Z2,8))},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[TJ,EJ,{provide:u.ip1,useValue:fM.async,multi:!0}]}),n})();function SJ(n,...e){return{ngModule:IJ,providers:[{provide:K2,useFactory:CJ(n),multi:!0,deps:[u.R0b,u.zs3,Tb,UE,...e]}]}}const lj="@firebase/database";let X2="";class DJ{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,te.Wl)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,te.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class AJ{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,te.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const uj=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new DJ(e)}}catch{}return new AJ},Fb=uj("localStorage"),Q2=uj("sessionStorage"),E1=new se.Yd("@firebase/database"),dj=function(){let n=1;return function(){return n++}}(),hj=function(n){const e=(0,te.dS)(n),t=new te.gQ;t.update(e);const i=t.digest();return te.US.encodeByteArray(i)},hT=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?e+=hT.apply(null,i):e+="object"==typeof i?(0,te.Wl)(i):i,e+=" "}return e};let Lb=null,fj=!0;const fl=function(...n){if(!0===fj&&(fj=!1,null===Lb&&!0===Q2.get("logging_enabled")&&function(n,e){(0,te.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(E1.logLevel=se.in.VERBOSE,Lb=E1.log.bind(E1),e&&Q2.set("logging_enabled",!0)):"function"==typeof n?Lb=n:(Lb=null,Q2.remove("logging_enabled"))}(!0)),Lb){const e=hT.apply(null,n);Lb(e)}},fT=function(n){return function(...e){fl(n,...e)}},J2=function(...n){const e="FIREBASE INTERNAL ERROR: "+hT(...n);E1.error(e)},Hm=function(...n){const e=`FIREBASE FATAL ERROR: ${hT(...n)}`;throw E1.error(e),new Error(e)},Mc=function(...n){const e="FIREBASE WARNING: "+hT(...n);E1.warn(e)},eD=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},yv="[MIN_NAME]",b_="[MAX_NAME]",Nb=function(n,e){if(n===e)return 0;if(n===yv||e===b_)return-1;if(e===yv||n===b_)return 1;{const t=_j(n),i=_j(e);return null!==t?null!==i?t-i==0?n.length-e.length:t-i:-1:null!==i?1:n<e?-1:1}},kJ=function(n,e){return n===e?0:n<e?-1:1},pT=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,te.Wl)(e))},eF=function(n){if("object"!=typeof n||null===n)return(0,te.Wl)(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)0!==i&&(t+=","),t+=(0,te.Wl)(e[i]),t+=":",t+=eF(n[e[i]]);return t+="}",t},mj=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let r=0;r<t;r+=e)i.push(n.substring(r,r+e>t?t:r+e));return i};function pl(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const gj=function(n){(0,te.hu)(!eD(n),"Invalid JSON number");const i=1023;let r,s,f,b,I;0===n?(s=0,f=0,r=1/n==-1/0?1:0):(r=n<0,(n=Math.abs(n))>=Math.pow(2,1-i)?(b=Math.min(Math.floor(Math.log(n)/Math.LN2),i),s=b+i,f=Math.round(n*Math.pow(2,52-b)-Math.pow(2,52))):(s=0,f=Math.round(n/Math.pow(2,-1074))));const O=[];for(I=52;I;I-=1)O.push(f%2?1:0),f=Math.floor(f/2);for(I=11;I;I-=1)O.push(s%2?1:0),s=Math.floor(s/2);O.push(r?1:0),O.reverse();const B=O.join("");let K="";for(I=0;I<64;I+=8){let le=parseInt(B.substr(I,8),2).toString(16);1===le.length&&(le="0"+le),K+=le}return K.toLowerCase()},NJ=new RegExp("^-?(0*)\\d{1,10}$"),_j=function(n){if(NJ.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},T1=function(n){try{n()}catch(e){setTimeout(()=>{throw Mc("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},VJ=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},mT=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class UJ{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Mc(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class jJ{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(fl("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Mc(e)}}let gT=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const wj=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Tj="websocket",Ij="long_polling";class nF{constructor(e,t,i,r,s=!1,f="",b=!1,I=!1){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=f,this.includeNamespaceInQueryParams=b,this.isUsingEmulator=I,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Fb.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Fb.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function Sj(n,e,t){let i;if((0,te.hu)("string"==typeof e,"typeof type must == string"),(0,te.hu)("object"==typeof t,"typeof params must == object"),e===Tj)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==Ij)throw new Error("Unknown connection type: "+e);i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function $J(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const r=[];return pl(t,(s,f)=>{r.push(s+"="+f)}),i+r.join("&")}class GJ{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,te.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,te.p$)(this.counters_)}}const iF={},rF={};function oF(n){const e=n.toString();return iF[e]||(iF[e]=new GJ),iF[e]}class qJ{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&T1(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class vv{constructor(e,t,i,r,s,f,b){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=f,this.lastSessionId=b,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=fT(e),this.stats_=oF(t),this.urlFn=I=>(this.appCheckToken&&(I.ac=this.appCheckToken),Sj(t,Ij,I))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new qJ(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,te.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new sF((...s)=>{const[f,b,I,O,B]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===f)this.id=b,this.password=I;else{if("close"!==f)throw new Error("Unrecognized command received: "+f);b?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(b,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[f,b]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(f,b)},()=>{this.onClosed_()},this.urlFn);const i={start:"t"};i.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(i.cb=this.scriptTagHolder.uniqueCallbackIdentifier),i.v="5",this.transportSessionId&&(i.s=this.transportSessionId),this.lastSessionId&&(i.ls=this.lastSessionId),this.applicationId&&(i.p=this.applicationId),this.appCheckToken&&(i.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&wj.test(location.hostname)&&(i.r="f");const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){vv.forceAllow_=!0}static forceDisallow(){vv.forceDisallow_=!0}static isAvailable(){return!((0,te.Yr)()||!vv.forceAllow_&&(vv.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,te.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=(0,te.h$)(t),r=mj(i,1840);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,te.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const i={dframe:"t"};i.id=e,i.pw=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,te.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class sF{constructor(e,t,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,te.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=dj(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=sF.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const f="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(f),this.myIFrame.doc.close()}catch(b){fl("frame writing exception"),b.stack&&fl(b.stack),fl(b)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||fl("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+i.length<=1870;){const f=this.pendingSegs.shift();i=i+"&seg"+r+"="+f.seg+"&ts"+r+"="+f.ts+"&d"+r+"="+f.d,r++}return t+=i,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(r),i()})}addTag(e,t){(0,te.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||"loaded"===r||"complete"===r)&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{fl("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}let nD=null;typeof MozWebSocket<"u"?nD=MozWebSocket:typeof WebSocket<"u"&&(nD=WebSocket);let I1=(()=>{class n{constructor(t,i,r,s,f,b,I){this.connId=t,this.applicationId=r,this.appCheckToken=s,this.authToken=f,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=fT(this.connId),this.stats_=oF(i),this.connURL=n.connectionURL_(i,b,I,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(t,i,r,s,f){const b={v:"5"};return!(0,te.Yr)()&&typeof location<"u"&&location.hostname&&wj.test(location.hostname)&&(b.r="f"),i&&(b.s=i),r&&(b.ls=r),s&&(b.ac=s),f&&(b.p=f),Sj(t,Tj,b)}open(t,i){this.onDisconnect=i,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Fb.set("previous_websocket_failure",!0);try{let r;if((0,te.Yr)()){r={headers:{"User-Agent":`Firebase/5/${X2}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);const f=process.env,b=0===this.connURL.indexOf("wss://")?f.HTTPS_PROXY||f.https_proxy:f.HTTP_PROXY||f.http_proxy;b&&(r.proxy={origin:b})}this.mySock=new nD(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==nD&&!n.forceDisallow_}static previouslyFailed(){return Fb.isInMemoryStorage||!0===Fb.get("previous_websocket_failure")}markConnectionHealthy(){Fb.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const i=this.frames.join("");this.frames=null;const r=(0,te.cI)(i);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,te.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const i=Number(t);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const i=t.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(i);else{const r=this.extractFrameCount_(i);null!==r&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();const i=(0,te.Wl)(t);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);const r=mj(i,16384);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),Rj=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[vv,I1]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const i=I1&&I1.isAvailable();let r=i&&!I1.previouslyFailed();if(t.webSocketOnly&&(i||Mc("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[I1];else{const s=this.transports_=[];for(const f of n.ALL_TRANSPORTS)f&&f.isAvailable()&&s.push(f);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class Uj{constructor(e,t,i,r,s,f,b,I,O,B){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=f,this.onReady_=b,this.onDisconnect_=I,this.onKill_=O,this.lastSessionId=B,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=fT("c:"+this.id+":"),this.transportManager_=new Rj(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=mT(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=pT("t",e),i=pT("d",e);if("c"===t)this.onSecondaryControl_(i);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(i)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=pT("t",e),i=pT("d",e);"c"===t?this.onControl_(i):"d"===t&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=pT("t",e);if("d"in e){const i=e.d;if("h"===t){const r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(i):"r"===t?this.onReset_(i):"e"===t?J2("Server Error: "+i):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):J2("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==i&&Mc("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),mT(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):mT(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Fb.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class jj{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}class $j{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,te.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!i||i===r[s].context))return void r.splice(s,1)}validateEventType_(e){(0,te.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class iD extends $j{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,te.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new iD}getInitialEvent(e){return(0,te.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const Gj=32,Hj=768;class xo{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Qr(){return new xo("")}function vr(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function bv(n){return n.pieces_.length-n.pieceNum_}function Yo(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new xo(n.pieces_,e)}function lF(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function _T(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function qj(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new xo(e,0)}function Ts(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof xo)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new xo(t,0)}function br(n){return n.pieceNum_>=n.pieces_.length}function mu(n,e){const t=vr(n),i=vr(e);if(null===t)return e;if(t===i)return mu(Yo(n),Yo(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function cF(n,e){if(bv(n)!==bv(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function hf(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(bv(n)>bv(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class mee{constructor(e,t){this.errorPrefix_=t,this.parts_=_T(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=(0,te.ug)(this.parts_[i]);Zj(this)}}function Zj(n){if(n.byteLength_>Hj)throw new Error(n.errorPrefix_+"has a key path longer than "+Hj+" bytes ("+n.byteLength_+").");if(n.parts_.length>Gj)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Gj+") or object contains a cycle "+zb(n))}function zb(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class uF extends $j{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new uF}getInitialEvent(e){return(0,te.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const yT=1e3;let oD,Bb=(()=>{class n extends jj{constructor(t,i,r,s,f,b,I,O){if(super(),this.repoInfo_=t,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=f,this.authTokenProvider_=b,this.appCheckTokenProvider_=I,this.authOverride_=O,this.id=n.nextPersistentConnectionId_++,this.log_=fT("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=yT,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,O&&!(0,te.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");uF.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&iD.getInstance().on("online",this.onOnline_,this)}sendRequest(t,i,r){const s=++this.requestNumber_,f={r:s,a:t,b:i};this.log_((0,te.Wl)(f)),(0,te.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(f),r&&(this.requestCBHash_[s]=r)}get(t){this.initConnection_();const i=new te.BH,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:b=>{const I=b.d;"ok"===b.s?i.resolve(I):i.reject(I)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),i.promise}listen(t,i,r,s){this.initConnection_();const f=t._queryIdentifier,b=t._path.toString();this.log_("Listen called for "+b+" "+f),this.listens.has(b)||this.listens.set(b,new Map),(0,te.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,te.hu)(!this.listens.get(b).has(f),"listen() called twice for same path/queryId.");const I={onComplete:s,hashFn:i,query:t,tag:r};this.listens.get(b).set(f,I),this.connected_&&this.sendListen_(I)}sendGet_(t){const i=this.outstandingGets_[t];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(t){const i=t.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);const f={p:r};t.tag&&(f.q=i._queryObject,f.t=t.tag),f.h=t.hashFn(),this.sendRequest("q",f,I=>{const O=I.d,B=I.s;n.warnOnListenWarnings_(O,i),(this.listens.get(r)&&this.listens.get(r).get(s))===t&&(this.log_("listen response",I),"ok"!==B&&this.removeListen_(r,s),t.onComplete&&t.onComplete(B,O))})}static warnOnListenWarnings_(t,i){if(t&&"object"==typeof t&&(0,te.r3)(t,"w")){const r=(0,te.DV)(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',f=i._path.toString();Mc(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${f} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,te.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,i=(0,te.w9)(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{const f=s.s,b=s.d||"error";this.authToken_===t&&("ok"===f?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(f,b))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const i=t.s,r=t.d||"error";"ok"===i?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(t,i){const r=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),(0,te.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,t._queryObject,i)}sendUnlisten_(t,i,r,s){this.log_("Unlisten on "+t+" for "+i);const f={p:t};s&&(f.q=r,f.t=s),this.sendRequest("n",f)}onDisconnectPut(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:i,onComplete:r})}onDisconnectMerge(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:i,onComplete:r})}onDisconnectCancel(t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(t,i,r,s){const f={p:i,d:r};this.log_("onDisconnect "+t,f),this.sendRequest(t,f,b=>{s&&setTimeout(()=>{s(b.s,b.d)},Math.floor(0))})}put(t,i,r,s){this.putInternal("p",t,i,r,s)}merge(t,i,r,s){this.putInternal("m",t,i,r,s)}putInternal(t,i,r,s,f){this.initConnection_();const b={p:i,d:r};void 0!==f&&(b.h=f),this.outstandingPuts_.push({action:t,request:b,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+i)}sendPut_(t){const i=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(i,r,f=>{this.log_(i+" response",f),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(f.s,f.d)})}reportStats(t){if(this.connected_){const i={c:t};this.log_("reportStats",i),this.sendRequest("s",i,r=>{"ok"!==r.s&&this.log_("reportStats","Error sending stats: "+r.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,te.Wl)(t));const i=t.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,i){this.log_("handleServerMessage",t,i),"d"===t?this.onDataUpdate_(i.p,i.d,!1,i.t):"m"===t?this.onDataUpdate_(i.p,i.d,!0,i.t):"c"===t?this.onListenRevoked_(i.p,i.q):"ac"===t?this.onAuthRevoked_(i.s,i.d):"apc"===t?this.onAppCheckRevoked_(i.s,i.d):"sd"===t?this.onSecurityDebugPacket_(i):J2("Unrecognized action received from server: "+(0,te.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,te.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=yT,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=yT,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=yT),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let i=Math.max(0,this.reconnectDelay_-t);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,V.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const i=t.onDataMessage_.bind(t),r=t.onReady_.bind(t),s=t.onRealtimeDisconnect_.bind(t),f=t.id+":"+n.nextConnectionId_++,b=t.lastSessionId;let I=!1,O=null;const B=function(){O?O.close():(I=!0,s())};t.realtime_={close:B,sendRequest:function(ge){(0,te.hu)(O,"sendRequest call when we're not connected not allowed."),O.sendRequest(ge)}};const le=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[ge,Te]=yield Promise.all([t.authTokenProvider_.getToken(le),t.appCheckTokenProvider_.getToken(le)]);I?fl("getToken() completed but was canceled"):(fl("getToken() completed. Creating connection."),t.authToken_=ge&&ge.accessToken,t.appCheckToken_=Te&&Te.token,O=new Uj(f,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,i,r,s,Ge=>{Mc(Ge+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},b))}catch(ge){t.log_("Failed to get token: "+ge),I||(t.repoInfo_.nodeAdmin&&Mc(ge),B())}}})()}interrupt(t){fl("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){fl("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,te.xb)(this.interruptReasons_)&&(this.reconnectDelay_=yT,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const i=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const i=this.outstandingPuts_[t];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,i){let r;r=i?i.map(f=>eF(f)).join("$"):"default";const s=this.removeListen_(t,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,i){const r=new xo(t).toString();let s;if(this.listens.has(r)){const f=this.listens.get(r);s=f.get(i),f.delete(i),0===f.size&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(t,i){fl("Auth token revoked: "+t+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,i){fl("App check token revoked: "+t+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const i of t.values())this.sendListen_(i);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let i="js";(0,te.Yr)()&&(i=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+i+"."+X2.replace(/\./g,"-")]=1,(0,te.uI)()?t["framework.cordova"]=1:(0,te.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=iD.getInstance().currentlyOnline();return(0,te.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class Cr{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Cr(e,t)}}class rD{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new Cr(yv,e),r=new Cr(yv,t);return 0!==this.compare(i,r)}minPost(){return Cr.MIN}}class Kj extends rD{static get __EMPTY_NODE(){return oD}static set __EMPTY_NODE(e){oD=e}compare(e,t){return Nb(e.name,t.name)}isDefinedOn(e){throw(0,te.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Cr.MIN}maxPost(){return new Cr(b_,oD)}makePost(e,t){return(0,te.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new Cr(e,oD)}toString(){return".key"}}const qm=new Kj;class sD{constructor(e,t,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let f=1;for(;!e.isEmpty();)if(f=t?i(e.key,t):1,r&&(f*=-1),f<0)e=this.isReverse_?e.left:e.right;else{if(0===f){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let hF,Tp=(()=>{class n{constructor(t,i,r,s,f){this.key=t,this.value=i,this.color=r??n.RED,this.left=s??ld.EMPTY_NODE,this.right=f??ld.EMPTY_NODE}copy(t,i,r,s,f){return new n(t??this.key,i??this.value,r??this.color,s??this.left,f??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this;const f=r(t,s.key);return s=f<0?s.copy(null,null,null,s.left.insert(t,i,r),null):0===f?s.copy(null,i,null,null,null):s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return ld.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,i){let r,s;if(r=this,i(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),0===i(t,r.key)){if(r.right.isEmpty())return ld.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class ld{constructor(e,t=ld.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new ld(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Tp.BLACK,null,null))}remove(e){return new ld(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Tp.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),0===t)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),0===t){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}t<0?i=i.left:t>0&&(r=i,i=i.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new sD(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new sD(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new sD(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new sD(this.root_,null,this.comparator_,!0,e)}}function Cee(n,e){return Nb(n.name,e.name)}function dF(n,e){return Nb(n,e)}ld.EMPTY_NODE=new class wee{copy(e,t,i,r,s){return this}insert(e,t,i){return new Tp(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Xj=function(n){return"number"==typeof n?"number:"+gj(n):"string:"+n},Qj=function(n){if(n.isLeafNode()){const e=n.val();(0,te.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,te.r3)(e,".sv"),"Priority must be a string or number.")}else(0,te.hu)(n===hF||n.isEmpty(),"priority of unexpected type.");(0,te.hu)(n===hF||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Jj,e4,t4,S1=(()=>{class n{constructor(t,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=i,this.lazyHash_=null,(0,te.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Qj(this.priorityNode_)}static set __childrenNodeConstructor(t){Jj=t}static get __childrenNodeConstructor(){return Jj}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return br(t)?this:".priority"===vr(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,i){return null}updateImmediateChild(t,i){return".priority"===t?this.updatePriority(i):i.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,i).updatePriority(this.priorityNode_)}updateChild(t,i){const r=vr(t);return null===r?i:i.isEmpty()&&".priority"!==r?this:((0,te.hu)(".priority"!==r||1===bv(t),".priority must be the last token in a path"),this.updateImmediateChild(r,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Yo(t),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,i){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Xj(this.priorityNode_.val())+":");const i=typeof this.value_;t+=i+":",t+="number"===i?gj(this.value_):this.value_,this.lazyHash_=hj(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,te.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const i=typeof t.value_,r=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(i),f=n.VALUE_TYPE_ORDER.indexOf(r);return(0,te.hu)(s>=0,"Unknown leaf type: "+i),(0,te.hu)(f>=0,"Unknown leaf type: "+r),s===f?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:f-s}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const rs=new class See extends rD{compare(e,t){const i=e.node.getPriority(),r=t.node.getPriority(),s=i.compareTo(r);return 0===s?Nb(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Cr.MIN}maxPost(){return new Cr(b_,new S1("[PRIORITY-POST]",t4))}makePost(e,t){const i=e4(e);return new Cr(t,new S1("[PRIORITY-POST]",i))}toString(){return".priority"}},Mee=Math.log(2);class Dee{constructor(e){this.count=parseInt(Math.log(e+1)/Mee,10),this.current_=this.count-1;const r=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const aD=function(n,e,t,i){n.sort(e);const r=function(I,O){const B=O-I;let K,le;if(0===B)return null;if(1===B)return K=n[I],le=t?t(K):K,new Tp(le,K.node,Tp.BLACK,null,null);{const ge=parseInt(B/2,10)+I,Te=r(I,ge),Ge=r(ge+1,O);return K=n[ge],le=t?t(K):K,new Tp(le,K.node,Tp.BLACK,Te,Ge)}},b=function(I){let O=null,B=null,K=n.length;const le=function(Te,Ge){const Je=K-Te,Qt=K;K-=Te;const xn=r(Je+1,Qt),zn=n[Je],li=t?t(zn):zn;ge(new Tp(li,zn.node,Ge,null,xn))},ge=function(Te){O?(O.left=Te,O=Te):(B=Te,O=Te)};for(let Te=0;Te<I.count;++Te){const Ge=I.nextBitIsOne(),Je=Math.pow(2,I.count-(Te+1));Ge?le(Je,Tp.BLACK):(le(Je,Tp.BLACK),le(Je,Tp.RED))}return B}(new Dee(n.length));return new ld(i||e,b)};let fF;const M1={};class x_{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,te.hu)(M1&&rs,"ChildrenNode.ts has not been loaded"),fF=fF||new x_({".priority":M1},{".priority":rs}),fF}get(e){const t=(0,te.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof ld?t:null}hasIndex(e){return(0,te.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,te.hu)(e!==qm,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const s=t.getIterator(Cr.Wrap);let b,f=s.getNext();for(;f;)r=r||e.isDefinedOn(f.node),i.push(f),f=s.getNext();b=r?aD(i,e.getCompare()):M1;const I=e.toString(),O=Object.assign({},this.indexSet_);O[I]=e;const B=Object.assign({},this.indexes_);return B[I]=b,new x_(B,O)}addToIndexes(e,t){const i=(0,te.UI)(this.indexes_,(r,s)=>{const f=(0,te.DV)(this.indexSet_,s);if((0,te.hu)(f,"Missing index implementation for "+s),r===M1){if(f.isDefinedOn(e.node)){const b=[],I=t.getIterator(Cr.Wrap);let O=I.getNext();for(;O;)O.name!==e.name&&b.push(O),O=I.getNext();return b.push(e),aD(b,f.getCompare())}return M1}{const b=t.get(e.name);let I=r;return b&&(I=I.remove(new Cr(e.name,b))),I.insert(e,e.node)}});return new x_(i,this.indexSet_)}removeFromIndexes(e,t){const i=(0,te.UI)(this.indexes_,r=>{if(r===M1)return r;{const s=t.get(e.name);return s?r.remove(new Cr(e.name,s)):r}});return new x_(i,this.indexSet_)}}let vT,cr=(()=>{class n{constructor(t,i,r){this.children_=t,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Qj(this.priorityNode_),this.children_.isEmpty()&&(0,te.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return vT||(vT=new n(new ld(dF),null,x_.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||vT}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const i=this.children_.get(t);return null===i?vT:i}}getChild(t){const i=vr(t);return null===i?this:this.getImmediateChild(i).getChild(Yo(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,i){if((0,te.hu)(i,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(i);{const r=new Cr(t,i);let s,f;i.isEmpty()?(s=this.children_.remove(t),f=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(t,i),f=this.indexMap_.addToIndexes(r,this.children_));const b=s.isEmpty()?vT:this.priorityNode_;return new n(s,b,f)}}updateChild(t,i){const r=vr(t);if(null===r)return i;{(0,te.hu)(".priority"!==vr(t)||1===bv(t),".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Yo(t),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const i={};let r=0,s=0,f=!0;if(this.forEachChild(rs,(b,I)=>{i[b]=I.val(t),r++,f&&n.INTEGER_REGEXP_.test(b)?s=Math.max(s,Number(b)):f=!1}),!t&&f&&s<2*r){const b=[];for(const I in i)b[I]=i[I];return b}return t&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+Xj(this.getPriority().val())+":"),this.forEachChild(rs,(i,r)=>{const s=r.hash();""!==s&&(t+=":"+i+":"+s)}),this.lazyHash_=""===t?"":hj(t)}return this.lazyHash_}getPredecessorChildName(t,i,r){const s=this.resolveIndex_(r);if(s){const f=s.getPredecessorKey(new Cr(t,i));return f?f.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const i=this.resolveIndex_(t);if(i){const r=i.minKey();return r&&r.name}return this.children_.minKey()}getFirstChild(t){const i=this.getFirstChildName(t);return i?new Cr(i,this.children_.get(i)):null}getLastChildName(t){const i=this.resolveIndex_(t);if(i){const r=i.maxKey();return r&&r.name}return this.children_.maxKey()}getLastChild(t){const i=this.getLastChildName(t);return i?new Cr(i,this.children_.get(i)):null}forEachChild(t,i){const r=this.resolveIndex_(t);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,i){const r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,Cr.Wrap);let f=s.peek();for(;null!=f&&i.compare(f,t)<0;)s.getNext(),f=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,i){const r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,Cr.Wrap);let f=s.peek();for(;null!=f&&i.compare(f,t)>0;)s.getNext(),f=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===bT?-1:0}withIndex(t){if(t===qm||this.indexMap_.hasIndex(t))return this;{const i=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(t){return t===qm||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const i=t;if(this.getPriority().equals(i.getPriority())){if(this.children_.count()===i.children_.count()){const r=this.getIterator(rs),s=i.getIterator(rs);let f=r.getNext(),b=s.getNext();for(;f&&b;){if(f.name!==b.name||!f.node.equals(b.node))return!1;f=r.getNext(),b=s.getNext()}return null===f&&null===b}return!1}return!1}}resolveIndex_(t){return t===qm?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const bT=new class Aee extends cr{constructor(){super(new ld(dF),cr.EMPTY_NODE,x_.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return cr.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Cr,{MIN:{value:new Cr(yv,cr.EMPTY_NODE)},MAX:{value:new Cr(b_,bT)}}),Kj.__EMPTY_NODE=cr.EMPTY_NODE,S1.__childrenNodeConstructor=cr,function Eee(n){hF=n}(bT),function Iee(n){t4=n}(bT);const Pee=!0;function Ns(n,e=null){if(null===n)return cr.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,te.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new S1(n,Ns(e));if(n instanceof Array||!Pee){let t=cr.EMPTY_NODE;return pl(n,(i,r)=>{if((0,te.r3)(n,i)&&"."!==i.substring(0,1)){const s=Ns(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(i,s))}}),t.updatePriority(Ns(e))}{const t=[];let i=!1;if(pl(n,(f,b)=>{if("."!==f.substring(0,1)){const I=Ns(b);I.isEmpty()||(i=i||!I.getPriority().isEmpty(),t.push(new Cr(f,I)))}}),0===t.length)return cr.EMPTY_NODE;const s=aD(t,Cee,f=>f.name,dF);if(i){const f=aD(t,rs.getCompare());return new cr(s,Ns(e),new x_({".priority":f},{".priority":rs}))}return new cr(s,Ns(e),x_.Default)}}!function Tee(n){e4=n}(Ns);class pF extends rD{constructor(e){super(),this.indexPath_=e,(0,te.hu)(!br(e)&&".priority"!==vr(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),r=this.extractChild(t.node),s=i.compareTo(r);return 0===s?Nb(e.name,t.name):s}makePost(e,t){const i=Ns(e),r=cr.EMPTY_NODE.updateChild(this.indexPath_,i);return new Cr(t,r)}maxPost(){const e=cr.EMPTY_NODE.updateChild(this.indexPath_,bT);return new Cr(b_,e)}toString(){return _T(this.indexPath_,0).join("/")}}const mF=new class Oee extends rD{compare(e,t){const i=e.node.compareTo(t.node);return 0===i?Nb(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Cr.MIN}maxPost(){return Cr.MAX}makePost(e,t){const i=Ns(e);return new Cr(t,i)}toString(){return".value"}};function wT(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class _F{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=rs}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,te.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,te.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:yv}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,te.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,te.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:b_}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,te.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===rs}copy(){const e=new _F;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function i4(n){const e={};if(n.isDefault())return e;let t;if(n.index_===rs?t="$priority":n.index_===mF?t="$value":n.index_===qm?t="$key":((0,te.hu)(n.index_ instanceof pF,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,te.Wl)(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=(0,te.Wl)(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+(0,te.Wl)(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=(0,te.Wl)(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+(0,te.Wl)(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function r4(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==rs&&(e.i=n.index_.toString()),e}class cD extends jj{constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=fT("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,te.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,r){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const f=cD.getListenId_(e,i),b={};this.listens_[f]=b;const I=i4(e._queryParams);this.restRequest_(s+".json",I,(O,B)=>{let K=B;if(404===O&&(K=null,O=null),null===O&&this.onDataUpdate_(s,K,!1,i),(0,te.DV)(this.listens_,f)===b){let le;le=O?401===O?"permission_denied":"rest_error:"+O:"ok",r(le,null)}})}unlisten(e,t){const i=cD.getListenId_(e,t);delete this.listens_[i]}get(e){const t=i4(e._queryParams),i=e._path.toString(),r=new te.BH;return this.restRequest_(i+".json",t,(s,f)=>{let b=f;404===s&&(b=null,s=null),null===s?(this.onDataUpdate_(i,b,!1,null),r.resolve(b)):r.reject(new Error(b))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);const f=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,te.xO)(t);this.log_("Sending REST request for "+f);const b=new XMLHttpRequest;b.onreadystatechange=()=>{if(i&&4===b.readyState){this.log_("REST Response for "+f+" received. status:",b.status,"response:",b.responseText);let I=null;if(b.status>=200&&b.status<300){try{I=(0,te.cI)(b.responseText)}catch{Mc("Failed to parse JSON response for "+f+": "+b.responseText)}i(null,I)}else 401!==b.status&&404!==b.status&&Mc("Got unsuccessful REST response for "+f+" Status: "+b.status),i(b.status);i=null}},b.open("GET",f,!0),b.send()})}}class Vee{constructor(){this.rootNode_=cr.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function uD(){return{value:null,children:new Map}}function A1(n,e,t){if(br(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const i=vr(e);n.children.has(i)||n.children.set(i,uD()),A1(n.children.get(i),e=Yo(e),t)}}function xF(n,e,t){null!==n.value?t(e,n.value):function Uee(n,e){n.children.forEach((t,i)=>{e(i,t)})}(n,(i,r)=>{xF(r,new xo(e.toString()+"/"+i),t)})}class jee{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&pl(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}}class Hee{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new jee(e);const i=1e4+2e4*Math.random();mT(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;pl(e,(r,s)=>{s>0&&(0,te.r3)(this.statsToReport_,r)&&(t[r]=s,i=!0)}),i&&this.server_.reportStats(t),mT(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var ff=(()=>(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(ff||(ff={})),ff))();function EF(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class dD{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=ff.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(br(this.path)){if(null!=this.affectedTree.value)return(0,te.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new xo(e));return new dD(Qr(),t,this.revert)}}return(0,te.hu)(vr(this.path)===e,"operationForChild called for unrelated child."),new dD(Yo(this.path),this.affectedTree,this.revert)}}class Vb{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=ff.OVERWRITE}operationForChild(e){return br(this.path)?new Vb(this.source,Qr(),this.snap.getImmediateChild(e)):new Vb(this.source,Yo(this.path),this.snap)}}class P1{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=ff.MERGE}operationForChild(e){if(br(this.path)){const t=this.children.subtree(new xo(e));return t.isEmpty()?null:t.value?new Vb(this.source,Qr(),t.value):new P1(this.source,Qr(),t)}return(0,te.hu)(vr(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new P1(this.source,Yo(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class xv{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(br(e))return this.isFullyInitialized()&&!this.filtered_;const t=vr(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function TT(n,e,t,i,r,s){const f=i.filter(b=>b.type===t);f.sort((b,I)=>function Yee(n,e,t){if(null==e.childName||null==t.childName)throw(0,te.g5)("Should only compare child_ events.");const i=new Cr(e.childName,e.snapshotNode),r=new Cr(t.childName,t.snapshotNode);return n.index_.compare(i,r)}(n,b,I)),f.forEach(b=>{const I=function Wee(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,b,s);r.forEach(O=>{O.respondsTo(b.type)&&e.push(O.createEvent(I,n.query_))})})}function hD(n,e){return{eventCache:n,serverCache:e}}function IT(n,e,t,i){return hD(new xv(e,t,i),n.serverCache)}function s4(n,e,t,i){return hD(n.eventCache,new xv(e,t,i))}function fD(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Ub(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let TF;class os{constructor(e,t=(()=>(TF||(TF=new ld(kJ)),TF))()){this.value=e,this.children=t}static fromObject(e){let t=new os(null);return pl(e,(i,r)=>{t=t.set(new xo(i),r)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Qr(),value:this.value};if(br(e))return null;{const i=vr(e),r=this.children.get(i);if(null!==r){const s=r.findRootMostMatchingPathAndValue(Yo(e),t);return null!=s?{path:Ts(new xo(i),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(br(e))return this;{const t=vr(e),i=this.children.get(t);return null!==i?i.subtree(Yo(e)):new os(null)}}set(e,t){if(br(e))return new os(t,this.children);{const i=vr(e),s=(this.children.get(i)||new os(null)).set(Yo(e),t),f=this.children.insert(i,s);return new os(this.value,f)}}remove(e){if(br(e))return this.children.isEmpty()?new os(null):new os(null,this.children);{const t=vr(e),i=this.children.get(t);if(i){const r=i.remove(Yo(e));let s;return s=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&s.isEmpty()?new os(null):new os(this.value,s)}return this}}get(e){if(br(e))return this.value;{const t=vr(e),i=this.children.get(t);return i?i.get(Yo(e)):null}}setTree(e,t){if(br(e))return t;{const i=vr(e),s=(this.children.get(i)||new os(null)).setTree(Yo(e),t);let f;return f=s.isEmpty()?this.children.remove(i):this.children.insert(i,s),new os(this.value,f)}}fold(e){return this.fold_(Qr(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(Ts(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,Qr(),t)}findOnPath_(e,t,i){const r=!!this.value&&i(t,this.value);if(r)return r;if(br(e))return null;{const s=vr(e),f=this.children.get(s);return f?f.findOnPath_(Yo(e),Ts(t,s),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Qr(),t)}foreachOnPath_(e,t,i){if(br(e))return this;{this.value&&i(t,this.value);const r=vr(e),s=this.children.get(r);return s?s.foreachOnPath_(Yo(e),Ts(t,r),i):new os(null)}}foreach(e){this.foreach_(Qr(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_(Ts(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}class Ip{constructor(e){this.writeTree_=e}static empty(){return new Ip(new os(null))}}function ST(n,e,t){if(br(e))return new Ip(new os(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(null!=i){const r=i.path;let s=i.value;const f=mu(r,e);return s=s.updateChild(f,t),new Ip(n.writeTree_.set(r,s))}{const r=new os(t),s=n.writeTree_.setTree(e,r);return new Ip(s)}}}function IF(n,e,t){let i=n;return pl(t,(r,s)=>{i=ST(i,Ts(e,r),s)}),i}function a4(n,e){if(br(e))return Ip.empty();{const t=n.writeTree_.setTree(e,new os(null));return new Ip(t)}}function SF(n,e){return null!=jb(n,e)}function jb(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(mu(t.path,e)):null}function l4(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(rs,(i,r)=>{e.push(new Cr(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{null!=r.value&&e.push(new Cr(i,r.value))}),e}function wv(n,e){if(br(e))return n;{const t=jb(n,e);return new Ip(null!=t?new os(t):n.writeTree_.subtree(e))}}function MF(n){return n.writeTree_.isEmpty()}function O1(n,e){return c4(Qr(),n.writeTree_,e)}function c4(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{".priority"===r?((0,te.hu)(null!==s.value,"Priority writes must always be leaf nodes"),i=s.value):t=c4(Ts(n,r),s,t)}),!t.getChild(n).isEmpty()&&null!==i&&(t=t.updateChild(Ts(n,".priority"),i)),t}}function pD(n,e){return p4(e,n)}function tte(n,e){if(n.snap)return hf(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&hf(Ts(n.path,t),e))return!0;return!1}function ite(n){return n.visible}function u4(n,e,t){let i=Ip.empty();for(let r=0;r<n.length;++r){const s=n[r];if(e(s)){const f=s.path;let b;if(s.snap)hf(t,f)?(b=mu(t,f),i=ST(i,b,s.snap)):hf(f,t)&&(b=mu(f,t),i=ST(i,Qr(),s.snap.getChild(b)));else{if(!s.children)throw(0,te.g5)("WriteRecord should have .snap or .children");if(hf(t,f))b=mu(t,f),i=IF(i,b,s.children);else if(hf(f,t))if(b=mu(f,t),br(b))i=IF(i,Qr(),s.children);else{const I=(0,te.DV)(s.children,vr(b));if(I){const O=I.getChild(Yo(b));i=ST(i,Qr(),O)}}}}}return i}function d4(n,e,t,i,r){if(i||r){const s=wv(n.visibleWrites,e);return!r&&MF(s)?t:r||null!=t||SF(s,Qr())?O1(u4(n.allWrites,function(O){return(O.visible||r)&&(!i||!~i.indexOf(O.writeId))&&(hf(O.path,e)||hf(e,O.path))},e),t||cr.EMPTY_NODE):null}{const s=jb(n.visibleWrites,e);if(null!=s)return s;{const f=wv(n.visibleWrites,e);return MF(f)?t:null!=t||SF(f,Qr())?O1(f,t||cr.EMPTY_NODE):null}}}function mD(n,e,t,i){return d4(n.writeTree,n.treePath,e,t,i)}function DF(n,e){return function rte(n,e,t){let i=cr.EMPTY_NODE;const r=jb(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(rs,(s,f)=>{i=i.updateImmediateChild(s,f)}),i;if(t){const s=wv(n.visibleWrites,e);return t.forEachChild(rs,(f,b)=>{const I=O1(wv(s,new xo(f)),b);i=i.updateImmediateChild(f,I)}),l4(s).forEach(f=>{i=i.updateImmediateChild(f.name,f.node)}),i}return l4(wv(n.visibleWrites,e)).forEach(f=>{i=i.updateImmediateChild(f.name,f.node)}),i}(n.writeTree,n.treePath,e)}function h4(n,e,t,i){return function ote(n,e,t,i,r){(0,te.hu)(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=Ts(e,t);if(SF(n.visibleWrites,s))return null;{const f=wv(n.visibleWrites,s);return MF(f)?r.getChild(t):O1(f,r.getChild(t))}}(n.writeTree,n.treePath,e,t,i)}function gD(n,e){return function ate(n,e){return jb(n.visibleWrites,e)}(n.writeTree,Ts(n.treePath,e))}function AF(n,e,t){return function ste(n,e,t,i){const r=Ts(e,t),s=jb(n.visibleWrites,r);return null!=s?s:i.isCompleteForChild(t)?O1(wv(n.visibleWrites,r),i.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function f4(n,e){return p4(Ts(n.treePath,e),n.writeTree)}function p4(n,e){return{treePath:n,writeTree:e}}class dte{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;(0,te.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,te.hu)(".priority"!==i,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const s=r.type;if("child_added"===t&&"child_removed"===s)this.changeMap.set(i,wT(i,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===s)this.changeMap.delete(i);else if("child_removed"===t&&"child_changed"===s)this.changeMap.set(i,function xT(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}(i,r.oldSnap));else if("child_changed"===t&&"child_added"===s)this.changeMap.set(i,function D1(n,e){return{type:"child_added",snapshotNode:e,childName:n}}(i,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==s)throw(0,te.g5)("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(i,wT(i,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}const m4=new class hte{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}};class PF{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=null!=this.optCompleteServerCache_?new xv(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return AF(this.writes_,e,i)}}getChildAfterChild(e,t,i){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ub(this.viewCache_),s=function ute(n,e,t,i,r,s){return function lte(n,e,t,i,r,s,f){let b;const I=wv(n.visibleWrites,e),O=jb(I,Qr());if(null!=O)b=O;else{if(null==t)return[];b=O1(I,t)}if(b=b.withIndex(f),b.isEmpty()||b.isLeafNode())return[];{const B=[],K=f.getCompare(),le=s?b.getReverseIteratorFrom(i,f):b.getIteratorFrom(i,f);let ge=le.getNext();for(;ge&&B.length<r;)0!==K(ge,i)&&B.push(ge),ge=le.getNext();return B}}(n.writeTree,n.treePath,e,t,i,r,s)}(this.writes_,r,t,1,i,e);return 0===s.length?null:s[0]}}function g4(n,e,t,i,r,s){const f=e.eventCache;if(null!=gD(i,t))return e;{let b,I;if(br(t))if((0,te.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const O=Ub(e),K=DF(i,O instanceof cr?O:cr.EMPTY_NODE);b=n.filter.updateFullNode(e.eventCache.getNode(),K,s)}else{const O=mD(i,Ub(e));b=n.filter.updateFullNode(e.eventCache.getNode(),O,s)}else{const O=vr(t);if(".priority"===O){(0,te.hu)(1===bv(t),"Can't have a priority with additional path components");const B=f.getNode();I=e.serverCache.getNode();const K=h4(i,t,B,I);b=null!=K?n.filter.updatePriority(B,K):f.getNode()}else{const B=Yo(t);let K;if(f.isCompleteForChild(O)){I=e.serverCache.getNode();const le=h4(i,t,f.getNode(),I);K=null!=le?f.getNode().getImmediateChild(O).updateChild(B,le):f.getNode().getImmediateChild(O)}else K=AF(i,O,e.serverCache);b=null!=K?n.filter.updateChild(f.getNode(),O,K,B,r,s):f.getNode()}}return IT(e,b,f.isFullyInitialized()||br(t),n.filter.filtersNodes())}}function _D(n,e,t,i,r,s,f,b){const I=e.serverCache;let O;const B=f?n.filter:n.filter.getIndexedFilter();if(br(t))O=B.updateFullNode(I.getNode(),i,null);else if(B.filtersNodes()&&!I.isFiltered()){const ge=I.getNode().updateChild(t,i);O=B.updateFullNode(I.getNode(),ge,null)}else{const ge=vr(t);if(!I.isCompleteForPath(t)&&bv(t)>1)return e;const Te=Yo(t),Je=I.getNode().getImmediateChild(ge).updateChild(Te,i);O=".priority"===ge?B.updatePriority(I.getNode(),Je):B.updateChild(I.getNode(),ge,Je,Te,m4,null)}const K=s4(e,O,I.isFullyInitialized()||br(t),B.filtersNodes());return g4(n,K,t,r,new PF(r,K,s),b)}function OF(n,e,t,i,r,s,f){const b=e.eventCache;let I,O;const B=new PF(r,e,s);if(br(t))O=n.filter.updateFullNode(e.eventCache.getNode(),i,f),I=IT(e,O,!0,n.filter.filtersNodes());else{const K=vr(t);if(".priority"===K)O=n.filter.updatePriority(e.eventCache.getNode(),i),I=IT(e,O,b.isFullyInitialized(),b.isFiltered());else{const le=Yo(t),ge=b.getNode().getImmediateChild(K);let Te;if(br(le))Te=i;else{const Ge=B.getCompleteChild(K);Te=null!=Ge?".priority"===lF(le)&&Ge.getChild(qj(le)).isEmpty()?Ge:Ge.updateChild(le,i):cr.EMPTY_NODE}I=ge.equals(Te)?e:IT(e,n.filter.updateChild(b.getNode(),K,Te,le,B,f),b.isFullyInitialized(),n.filter.filtersNodes())}}return I}function _4(n,e){return n.eventCache.isCompleteForChild(e)}function y4(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function kF(n,e,t,i,r,s,f,b){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let O,I=e;O=br(t)?i:new os(null).setTree(t,i);const B=e.serverCache.getNode();return O.children.inorderTraversal((K,le)=>{if(B.hasChild(K)){const Te=y4(0,e.serverCache.getNode().getImmediateChild(K),le);I=_D(n,I,new xo(K),Te,r,s,f,b)}}),O.children.inorderTraversal((K,le)=>{const ge=!e.serverCache.isCompleteForChild(K)&&null===le.value;if(!B.hasChild(K)&&!ge){const Ge=y4(0,e.serverCache.getNode().getImmediateChild(K),le);I=_D(n,I,new xo(K),Ge,r,s,f,b)}}),I}function Ete(n,e){const t=Ub(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!br(e)&&!t.getImmediateChild(vr(e)).isEmpty())?t.getChild(e):null}function x4(n,e,t,i){e.type===ff.MERGE&&null!==e.source.queryId&&((0,te.hu)(Ub(n.viewCache_),"We should always have a full cache before handling merges"),(0,te.hu)(fD(n.viewCache_),"Missing event cache, even though we have a server cache"));const r=n.viewCache_,s=function mte(n,e,t,i,r){const s=new dte;let f,b;if(t.type===ff.OVERWRITE){const O=t;O.source.fromUser?f=OF(n,e,O.path,O.snap,i,r,s):((0,te.hu)(O.source.fromServer,"Unknown source."),b=O.source.tagged||e.serverCache.isFiltered()&&!br(O.path),f=_D(n,e,O.path,O.snap,i,r,b,s))}else if(t.type===ff.MERGE){const O=t;O.source.fromUser?f=function _te(n,e,t,i,r,s,f){let b=e;return i.foreach((I,O)=>{const B=Ts(t,I);_4(e,vr(B))&&(b=OF(n,b,B,O,r,s,f))}),i.foreach((I,O)=>{const B=Ts(t,I);_4(e,vr(B))||(b=OF(n,b,B,O,r,s,f))}),b}(n,e,O.path,O.children,i,r,s):((0,te.hu)(O.source.fromServer,"Unknown source."),b=O.source.tagged||e.serverCache.isFiltered(),f=kF(n,e,O.path,O.children,i,r,b,s))}else if(t.type===ff.ACK_USER_WRITE){const O=t;f=O.revert?function bte(n,e,t,i,r,s){let f;if(null!=gD(i,t))return e;{const b=new PF(i,e,r),I=e.eventCache.getNode();let O;if(br(t)||".priority"===vr(t)){let B;if(e.serverCache.isFullyInitialized())B=mD(i,Ub(e));else{const K=e.serverCache.getNode();(0,te.hu)(K instanceof cr,"serverChildren would be complete if leaf node"),B=DF(i,K)}O=n.filter.updateFullNode(I,B,s)}else{const B=vr(t);let K=AF(i,B,e.serverCache);null==K&&e.serverCache.isCompleteForChild(B)&&(K=I.getImmediateChild(B)),O=null!=K?n.filter.updateChild(I,B,K,Yo(t),b,s):e.eventCache.getNode().hasChild(B)?n.filter.updateChild(I,B,cr.EMPTY_NODE,Yo(t),b,s):I,O.isEmpty()&&e.serverCache.isFullyInitialized()&&(f=mD(i,Ub(e)),f.isLeafNode()&&(O=n.filter.updateFullNode(O,f,s)))}return f=e.serverCache.isFullyInitialized()||null!=gD(i,Qr()),IT(e,O,f,n.filter.filtersNodes())}}(n,e,O.path,i,r,s):function yte(n,e,t,i,r,s,f){if(null!=gD(r,t))return e;const b=e.serverCache.isFiltered(),I=e.serverCache;if(null!=i.value){if(br(t)&&I.isFullyInitialized()||I.isCompleteForPath(t))return _D(n,e,t,I.getNode().getChild(t),r,s,b,f);if(br(t)){let O=new os(null);return I.getNode().forEachChild(qm,(B,K)=>{O=O.set(new xo(B),K)}),kF(n,e,t,O,r,s,b,f)}return e}{let O=new os(null);return i.foreach((B,K)=>{const le=Ts(t,B);I.isCompleteForPath(le)&&(O=O.set(B,I.getNode().getChild(le)))}),kF(n,e,t,O,r,s,b,f)}}(n,e,O.path,O.affectedTree,i,r,s)}else{if(t.type!==ff.LISTEN_COMPLETE)throw(0,te.g5)("Unknown operation type: "+t.type);f=function vte(n,e,t,i,r){const s=e.serverCache;return g4(n,s4(e,s.getNode(),s.isFullyInitialized()||br(t),s.isFiltered()),t,i,m4,r)}(n,e,t.path,i,s)}const I=s.getChanges();return function gte(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=fD(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&t.push(function n4(n){return{type:"value",snapshotNode:n}}(fD(e)))}}(e,f,I),{viewCache:f,changes:I}}(n.processor_,r,e,t,i);return function pte(n,e){(0,te.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,te.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,s.viewCache),(0,te.hu)(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,function w4(n,e,t,i){return function Zee(n,e,t,i){const r=[],s=[];return e.forEach(f=>{"child_changed"===f.type&&n.index_.indexedValueChanged(f.oldSnap,f.snapshotNode)&&s.push(function kee(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(f.childName,f.snapshotNode))}),TT(n,r,"child_removed",e,i,t),TT(n,r,"child_added",e,i,t),TT(n,r,"child_moved",s,i,t),TT(n,r,"child_changed",e,i,t),TT(n,r,"value",e,i,t),r}(n.eventGenerator_,e,t,i?[i]:n.eventRegistrations_)}(n,s.changes,s.viewCache.eventCache.getNode(),null)}let yD,bD;function RF(n,e,t,i){const r=e.source.queryId;if(null!==r){const s=n.views.get(r);return(0,te.hu)(null!=s,"SyncTree gave us an op for an invalid query."),x4(s,e,t,i)}{let s=[];for(const f of n.views.values())s=s.concat(x4(f,e,t,i));return s}}function Cv(n,e){let t=null;for(const i of n.views.values())t=t||Ete(i,e);return t}class M4{constructor(e){this.listenProvider_=e,this.syncPointTree_=new os(null),this.pendingWriteTree_=function cte(){return{visibleWrites:Ip.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function FF(n,e,t,i,r){return function Xee(n,e,t,i,r){(0,te.hu)(i>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=ST(n.visibleWrites,e,t)),n.lastWriteId=i}(n.pendingWriteTree_,e,t,i,r),r?k1(n,new Vb({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function Tv(n,e,t=!1){const i=function Jee(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}(n.pendingWriteTree_,e);if(function ete(n,e){const t=n.allWrites.findIndex(b=>b.writeId===e);(0,te.hu)(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,s=!1,f=n.allWrites.length-1;for(;r&&f>=0;){const b=n.allWrites[f];b.visible&&(f>=t&&tte(b,i.path)?r=!1:hf(i.path,b.path)&&(s=!0)),f--}return!!r&&(s?(function nte(n){n.visibleWrites=u4(n.allWrites,ite,Qr()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(i.snap?n.visibleWrites=a4(n.visibleWrites,i.path):pl(i.children,I=>{n.visibleWrites=a4(n.visibleWrites,Ts(i.path,I))}),!0))}(n.pendingWriteTree_,e)){let s=new os(null);return null!=i.snap?s=s.set(Qr(),!0):pl(i.children,f=>{s=s.set(new xo(f),!0)}),k1(n,new dD(i.path,s,t))}return[]}function MT(n,e,t){return k1(n,new Vb({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function wD(n,e,t){const r=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(f,b)=>{const O=Cv(b,mu(f,e));if(O)return O});return d4(r,e,s,t,!0)}function k1(n,e){return A4(e,n.syncPointTree_,null,pD(n.pendingWriteTree_,Qr()))}function A4(n,e,t,i){if(br(n.path))return P4(n,e,t,i);{const r=e.get(Qr());null==t&&null!=r&&(t=Cv(r,Qr()));let s=[];const f=vr(n.path),b=n.operationForChild(f),I=e.children.get(f);if(I&&b){const O=t?t.getImmediateChild(f):null,B=f4(i,f);s=s.concat(A4(b,I,O,B))}return r&&(s=s.concat(RF(r,n,i,t))),s}}function P4(n,e,t,i){const r=e.get(Qr());null==t&&null!=r&&(t=Cv(r,Qr()));let s=[];return e.children.inorderTraversal((f,b)=>{const I=t?t.getImmediateChild(f):null,O=f4(i,f),B=n.operationForChild(f);B&&(s=s.concat(P4(B,b,I,O)))}),r&&(s=s.concat(RF(r,n,i,t))),s}function NF(n,e){return n.tagToQueryMap.get(e)}function zF(n){const e=n.indexOf("$");return(0,te.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new xo(n.substr(0,e))}}function BF(n,e,t){const i=n.syncPointTree_.get(e);return(0,te.hu)(i,"Missing sync point for query tag that we're tracking"),RF(i,t,pD(n.pendingWriteTree_,e),null)}class VF{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new VF(t)}node(){return this.node_}}class UF{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Ts(this.path_,e);return new UF(this.syncTree_,t)}node(){return wD(this.syncTree_,this.path_)}}const Hte=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},k4=function(n,e,t){return n&&"object"==typeof n?((0,te.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?qte(n[".sv"],e,t):"object"==typeof n[".sv"]?Zte(n[".sv"],e):void(0,te.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},qte=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,te.hu)(!1,"Unexpected server value: "+n)},Zte=function(n,e,t){n.hasOwnProperty("increment")||(0,te.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;"number"!=typeof i&&(0,te.hu)(!1,"Unexpected increment value: "+i);const r=e.node();if((0,te.hu)(null!==r&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const f=r.getValue();return"number"!=typeof f?i:f+i},R4=function(n,e,t,i){return $F(e,new UF(t,n),i)},jF=function(n,e,t){return $F(n,new VF(e),t)};function $F(n,e,t){const i=n.getPriority().val(),r=k4(i,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const f=n,b=k4(f.getValue(),e,t);return b!==f.getValue()||r!==f.getPriority().val()?new S1(b,Ns(r)):n}{const f=n;return s=f,r!==f.getPriority().val()&&(s=s.updatePriority(new S1(r))),f.forEachChild(rs,(b,I)=>{const O=$F(I,e.getImmediateChild(b),t);O!==I&&(s=s.updateImmediateChild(b,O))}),s}}class GF{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function ED(n,e){let t=e instanceof xo?e:new xo(e),i=n,r=vr(t);for(;null!==r;){const s=(0,te.DV)(i.node.children,r)||{children:{},childCount:0};i=new GF(r,i,s),t=Yo(t),r=vr(t)}return i}function $b(n){return n.node.value}function HF(n,e){n.node.value=e,qF(n)}function F4(n){return n.node.childCount>0}function TD(n,e){pl(n.node.children,(t,i)=>{e(new GF(t,n,i))})}function L4(n,e,t,i){t&&!i&&e(n),TD(n,r=>{L4(r,e,!0,i)}),t&&i&&e(n)}function PT(n){return new xo(null===n.parent?n.name:PT(n.parent)+"/"+n.name)}function qF(n){null!==n.parent&&function Kte(n,e,t){const i=function Wte(n){return void 0===$b(n)&&!F4(n)}(t),r=(0,te.r3)(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,qF(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,qF(n))}(n.parent,n.name,n)}const Xte=/[\[\].#$\/\u0000-\u001F\u007F]/,Qte=/[\[\].#$\u0000-\u001F\u007F]/,ZF=10485760,ID=function(n){return"string"==typeof n&&0!==n.length&&!Xte.test(n)},kT=function(n,e,t){const i=t instanceof xo?new mee(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+zb(i));if("function"==typeof e)throw new Error(n+"contains a function "+zb(i)+" with contents = "+e.toString());if(eD(e))throw new Error(n+"contains "+e.toString()+" "+zb(i));if("string"==typeof e&&e.length>ZF/3&&(0,te.ug)(e)>ZF)throw new Error(n+"contains a string greater than "+ZF+" utf8 bytes "+zb(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let r=!1,s=!1;if(pl(e,(f,b)=>{if(".value"===f)r=!0;else if(".priority"!==f&&".sv"!==f&&(s=!0,!ID(f)))throw new Error(n+" contains an invalid key ("+f+") "+zb(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function gee(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,te.ug)(e),Zj(n)})(i,f),kT(n,b,i),function _ee(n){const e=n.parts_.pop();n.byteLength_-=(0,te.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(i)}),r&&s)throw new Error(n+' contains ".value" child '+zb(i)+" in addition to actual children.")}},B4=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!ID(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),function(n){return"string"==typeof n&&0!==n.length&&!Qte.test(n)}(n)}(t))throw new Error((0,te.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class nne{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Jd(n,e,t){(function SD(n,e){let t=null;for(let i=0;i<e.length;i++){const r=e[i],s=r.getPath();null!==t&&!cF(s,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:s}),t.events.push(r)}t&&n.eventLists_.push(t)})(n,t),function U4(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const r=n.eventLists_[i];r&&(e(r.path)?(ine(n.eventLists_[i]),n.eventLists_[i]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}(n,i=>hf(i,e)||hf(e,i))}function ine(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const i=t.getEventRunner();Lb&&fl("event: "+t.toString()),T1(i)}}}const j4="repo_interrupt",rne=25;class one{constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new nne,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=uD(),this.transactionQueueTree_=new GF,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function $4(n){const t=n.infoData_.getNode(new xo(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function FT(n){return Hte({timestamp:$4(n)})}function G4(n,e,t,i,r){n.dataUpdateCount++;const s=new xo(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let f=[];if(r)if(i){const I=(0,te.UI)(t,O=>Ns(O));f=function Bte(n,e,t,i){const r=NF(n,i);if(r){const s=zF(r),f=s.path,b=s.queryId,I=mu(f,e),O=os.fromObject(t);return BF(n,f,new P1(EF(b),I,O))}return[]}(n.serverSyncTree_,s,I,r)}else{const I=Ns(t);f=function D4(n,e,t,i){const r=NF(n,i);if(null!=r){const s=zF(r),f=s.path,b=s.queryId,I=mu(f,e);return BF(n,f,new Vb(EF(b),I,t))}return[]}(n.serverSyncTree_,s,I,r)}else if(i){const I=(0,te.UI)(t,O=>Ns(O));f=function Lte(n,e,t){const i=os.fromObject(t);return k1(n,new P1({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,s,I)}else{const I=Ns(t);f=MT(n.serverSyncTree_,s,I)}let b=s;f.length>0&&(b=F1(n,s)),Jd(n.eventQueue_,b,f)}function H4(n,e){KF(n,"connected",e),!1===e&&function une(n){R1(n,"onDisconnectEvents");const e=FT(n),t=uD();xF(n.onDisconnect_,Qr(),(r,s)=>{const f=R4(r,s,n.serverSyncTree_,e);A1(t,r,f)});let i=[];xF(t,Qr(),(r,s)=>{i=i.concat(MT(n.serverSyncTree_,r,s));const f=function eL(n,e){const t=PT(W4(n,e)),i=ED(n.transactionQueueTree_,e);return function Yte(n,e,t){let i=t?n:n.parent;for(;null!==i;){if(e(i))return!0;i=i.parent}}(i,r=>{tL(n,r)}),tL(n,i),L4(i,r=>{tL(n,r)}),t}(n,r);F1(n,f)}),n.onDisconnect_=uD(),Jd(n.eventQueue_,Qr(),i)}(n)}function KF(n,e,t){const i=new xo("/.info/"+e),r=Ns(t);n.infoData_.updateSnapshot(i,r);const s=MT(n.infoSyncTree_,i,r);Jd(n.eventQueue_,i,s)}function MD(n){return n.nextWriteId_++}function R1(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),fl(t,...e)}function JF(n,e,t){return wD(n.serverSyncTree_,e,t)||cr.EMPTY_NODE}function DD(n,e=n.transactionQueueTree_){if(e||AD(n,e),$b(e)){const t=Y4(n,e);(0,te.hu)(t.length>0,"Sending zero length transaction queue"),t.every(r=>0===r.status)&&function _ne(n,e,t){const i=t.map(O=>O.currentWriteId),r=JF(n,e,i);let s=r;const f=r.hash();for(let O=0;O<t.length;O++){const B=t[O];(0,te.hu)(0===B.status,"tryToSendTransactionQueue_: items in queue should all be run."),B.status=1,B.retryCount++;const K=mu(e,B.path);s=s.updateChild(K,B.currentOutputSnapshotRaw)}const b=s.val(!0),I=e;n.server_.put(I.toString(),b,O=>{R1(n,"transaction put response",{path:I.toString(),status:O});let B=[];if("ok"===O){const K=[];for(let le=0;le<t.length;le++)t[le].status=2,B=B.concat(Tv(n.serverSyncTree_,t[le].currentWriteId)),t[le].onComplete&&K.push(()=>t[le].onComplete(null,!0,t[le].currentOutputSnapshotResolved)),t[le].unwatcher();AD(n,ED(n.transactionQueueTree_,e)),DD(n,n.transactionQueueTree_),Jd(n.eventQueue_,e,B);for(let le=0;le<K.length;le++)T1(K[le])}else{if("datastale"===O)for(let K=0;K<t.length;K++)t[K].status=3===t[K].status?4:0;else{Mc("transaction at "+I.toString()+" failed: "+O);for(let K=0;K<t.length;K++)t[K].status=4,t[K].abortReason=O}F1(n,e)}},f)}(n,PT(e),t)}else F4(e)&&TD(e,t=>{DD(n,t)})}function F1(n,e){const t=W4(n,e),i=PT(t);return function yne(n,e,t){if(0===e.length)return;const i=[];let r=[];const f=e.filter(b=>0===b.status).map(b=>b.currentWriteId);for(let b=0;b<e.length;b++){const I=e[b],O=mu(t,I.path);let K,B=!1;if((0,te.hu)(null!==O,"rerunTransactionsUnderNode_: relativePath should not be null."),4===I.status)B=!0,K=I.abortReason,r=r.concat(Tv(n.serverSyncTree_,I.currentWriteId,!0));else if(0===I.status)if(I.retryCount>=rne)B=!0,K="maxretry",r=r.concat(Tv(n.serverSyncTree_,I.currentWriteId,!0));else{const le=JF(n,I.path,f);I.currentInputSnapshot=le;const ge=e[b].update(le.val());if(void 0!==ge){kT("transaction failed: Data returned ",ge,I.path);let Te=Ns(ge);"object"==typeof ge&&null!=ge&&(0,te.r3)(ge,".priority")||(Te=Te.updatePriority(le.getPriority()));const Je=I.currentWriteId,Qt=FT(n),xn=jF(Te,le,Qt);I.currentOutputSnapshotRaw=Te,I.currentOutputSnapshotResolved=xn,I.currentWriteId=MD(n),f.splice(f.indexOf(Je),1),r=r.concat(FF(n.serverSyncTree_,I.path,xn,I.currentWriteId,I.applyLocally)),r=r.concat(Tv(n.serverSyncTree_,Je,!0))}else B=!0,K="nodata",r=r.concat(Tv(n.serverSyncTree_,I.currentWriteId,!0))}Jd(n.eventQueue_,t,r),r=[],B&&(e[b].status=2,setTimeout(e[b].unwatcher,Math.floor(0)),e[b].onComplete&&i.push("nodata"===K?()=>e[b].onComplete(null,!1,e[b].currentInputSnapshot):()=>e[b].onComplete(new Error(K),!1,null)))}AD(n,n.transactionQueueTree_);for(let b=0;b<i.length;b++)T1(i[b]);DD(n,n.transactionQueueTree_)}(n,Y4(n,t),i),i}function W4(n,e){let t,i=n.transactionQueueTree_;for(t=vr(e);null!==t&&void 0===$b(i);)i=ED(i,t),t=vr(e=Yo(e));return i}function Y4(n,e){const t=[];return K4(n,e,t),t.sort((i,r)=>i.order-r.order),t}function K4(n,e,t){const i=$b(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);TD(e,r=>{K4(n,r,t)})}function AD(n,e){const t=$b(e);if(t){let i=0;for(let r=0;r<t.length;r++)2!==t[r].status&&(t[i]=t[r],i++);t.length=i,HF(e,t.length>0?t:void 0)}TD(e,i=>{AD(n,i)})}function tL(n,e){const t=$b(e);if(t){const i=[];let r=[],s=-1;for(let f=0;f<t.length;f++)3===t[f].status||(1===t[f].status?((0,te.hu)(s===f-1,"All SENT items should be at beginning of queue."),s=f,t[f].status=3,t[f].abortReason="set"):((0,te.hu)(0===t[f].status,"Unexpected transaction status in abort"),t[f].unwatcher(),r=r.concat(Tv(n.serverSyncTree_,t[f].currentWriteId,!0)),t[f].onComplete&&i.push(t[f].onComplete.bind(null,new Error("set"),!1,null))));-1===s?HF(e,void 0):t.length=s+1,Jd(n.eventQueue_,PT(e),r);for(let f=0;f<i.length;f++)T1(i[f])}}const nL=function(n,e){const t=xne(n),i=t.namespace;return"firebase.com"===t.domain&&Hm(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||"undefined"===i)&&"localhost"!==t.domain&&Hm("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Mc("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new nF(t.host,t.secure,i,"ws"===t.scheme||"wss"===t.scheme,e,"",i!==t.subdomain),path:new xo(t.pathString)}},xne=function(n){let e="",t="",i="",r="",s="",f=!0,b="https",I=443;if("string"==typeof n){let O=n.indexOf("//");O>=0&&(b=n.substring(0,O-1),n=n.substring(O+2));let B=n.indexOf("/");-1===B&&(B=n.length);let K=n.indexOf("?");-1===K&&(K=n.length),e=n.substring(0,Math.min(B,K)),B<K&&(r=function vne(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}(n.substring(B,K)));const le=function bne(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const i=t.split("=");2===i.length?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Mc(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,K)));O=e.indexOf(":"),O>=0?(f="https"===b||"wss"===b,I=parseInt(e.substring(O+1),10)):O=e.length;const ge=e.slice(0,O);if("localhost"===ge.toLowerCase())t="localhost";else if(ge.split(".").length<=2)t=ge;else{const Te=e.indexOf(".");i=e.substring(0,Te).toLowerCase(),t=e.substring(Te+1),s=i}"ns"in le&&(s=le.ns)}return{host:e,port:I,domain:t,subdomain:i,secure:f,scheme:b,pathString:r,namespace:s}};class eh{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return br(this._path)?null:lF(this._path)}get ref(){return new Sp(this._repo,this._path)}get _queryIdentifier(){const e=r4(this._queryParams),t=eF(e);return"{}"===t?"default":t}get _queryObject(){return r4(this._queryParams)}isEqual(e){if(!((e=(0,te.m9)(e))instanceof eh))return!1;const t=this._repo===e._repo,i=cF(this._path,e._path);return t&&i&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function fee(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}class Sp extends eh{constructor(e,t){super(e,t,new _F,!1)}get parent(){const e=qj(this._path);return null===e?null:new Sp(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}(function Ste(n){(0,te.hu)(!yD,"__referenceConstructor has already been defined"),yD=n})(Sp),function Ote(n){(0,te.hu)(!bD,"__referenceConstructor has already been defined"),bD=n}(Sp);const Fne="FIREBASE_DATABASE_EMULATOR_HOST",rL={};let i5=!1;class Une{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function sne(n,e,t){if(n.stats_=oF(n.repoInfo_),n.forceRestClient_||VJ())n.server_=new cD(n.repoInfo_,(i,r,s,f)=>{G4(n,i,r,s,f)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>H4(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,te.Wl)(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Bb(n.repoInfo_,e,(i,r,s,f)=>{G4(n,i,r,s,f)},i=>{H4(n,i)},i=>{!function ane(n,e){pl(e,(t,i)=>{KF(n,t,i)})}(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=function HJ(n,e){const t=n.toString();return rF[t]||(rF[t]=e()),rF[t]}(n.repoInfo_,()=>new Hee(n.stats_,n.server_)),n.infoData_=new Vee,n.infoSyncTree_=new M4({startListening:(i,r,s,f)=>{let b=[];const I=n.infoData_.getNode(i._path);return I.isEmpty()||(b=MT(n.infoSyncTree_,i._path,I),setTimeout(()=>{f("ok")},0)),b},stopListening:()=>{}}),KF(n,"connected",!1),n.serverSyncTree_=new M4({startListening:(i,r,s,f)=>(n.server_.listen(i,s,r,(b,I)=>{const O=f(b,I);Jd(n.eventQueue_,i._path,O)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Sp(this._repo,Qr())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function zne(n,e){const t=rL[e];(!t||t[n.key]!==n)&&Hm(`Database ${e}(${n.repoInfo_}) has already been deleted.`),function Z4(n){n.persistentConnection_&&n.persistentConnection_.interrupt(j4)}(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Hm("Cannot call "+e+" on a deleted database.")}}function jne(n=(0,Q.getApp)(),e){const t=(0,Q._getProvider)(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=(0,te.P0)("database");i&&function $ne(n,e,t,i={}){(n=(0,te.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Hm("Cannot call useEmulator() after instance has already been initialized.");const r=n._repoInternal;let s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Hm('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new gT(gT.OWNER);else if(i.mockUserToken){const f="string"==typeof i.mockUserToken?i.mockUserToken:(0,te.Sg)(i.mockUserToken,n.app.options.projectId);s=new gT(f)}!function Lne(n,e,t,i){n.repoInfo_=new nF(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}(r,e,t,s)}(t,...i)}return t}Bb.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},Bb.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function Gne(n){(function MJ(n){X2=n})(Q.SDK_VERSION),(0,Q._registerComponent)(new ie.wA("database",(e,{instanceIdentifier:t})=>function Nne(n,e,t,i,r){let s=i||n.options.databaseURL;void 0===s&&(n.options.projectId||Hm("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),fl("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let I,O,f=nL(s,r),b=f.repoInfo;typeof process<"u"&&process.env&&(O=process.env[Fne]),O?(I=!0,s=`http://${O}?ns=${b.namespace}`,f=nL(s,r),b=f.repoInfo):I=!f.repoInfo.secure;const B=r&&I?new gT(gT.OWNER):new jJ(n.name,n.options,e);B4("Invalid Firebase Database URL",f),br(f.path)||Hm("Database URL must point to the root of a Firebase Database (not including a child path).");const K=function Bne(n,e,t,i){let r=rL[e.name];r||(r={},rL[e.name]=r);let s=r[n.toURLString()];return s&&Hm("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new one(n,i5,t,i),r[n.toURLString()]=s,s}(b,n,B,new UJ(n.name,t));return new Une(K,n)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,Q.registerVersion)(lj,"0.14.4",n),(0,Q.registerVersion)(lj,"0.14.4","esm2017")}();class oL{constructor(e){return e}}const o5="database",sL=new u.OlP("angularfire2.database-instances");function Yne(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new oL(i)}}const Kne={provide:class Zne{constructor(){return VE(o5)}},deps:[[new u.FiY,sL]]},Xne={provide:oL,useFactory:function Wne(n,e){const t=BE(o5,n,e);return t&&new oL(t)},deps:[[new u.FiY,sL],fv]};let Qne=(()=>{class n{constructor(){(0,Q.registerVersion)("angularfire",hv.full,"rtdb")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[Xne,Kne]}),n})();function Jne(n,...e){return{ngModule:Qne,providers:[{provide:sL,useFactory:Yne(n),multi:!0,deps:[u.R0b,u.zs3,Tb,UE,[new u.FiY,GR],[new u.FiY,d1],...e]}]}}const eie=f_(jne,!0);function s5(n){return new u.vHH(3e3,!1)}function Fie(){return typeof window<"u"&&typeof window.document<"u"}function aL(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Mv(n){switch(n.length){case 0:return new tT;case 1:return n[0];default:return new LV(n)}}function a5(n,e,t,i,r=new Map,s=new Map){const f=[],b=[];let I=-1,O=null;if(i.forEach(B=>{const K=B.get("offset"),le=K==I,ge=le&&O||new Map;B.forEach((Te,Ge)=>{let Je=Ge,Qt=Te;if("offset"!==Ge)switch(Je=e.normalizePropertyName(Je,f),Qt){case g2:Qt=r.get(Ge);break;case __:Qt=s.get(Ge);break;default:Qt=e.normalizeStyleValue(Ge,Je,Qt,f)}ge.set(Je,Qt)}),le||b.push(ge),O=ge,I=K}),f.length)throw function Cie(n){return new u.vHH(3502,!1)}();return b}function lL(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&cL(t,"start",n)));break;case"done":n.onDone(()=>i(t&&cL(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&cL(t,"destroy",n)))}}function cL(n,e,t){const s=uL(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),f=n._data;return null!=f&&(s._data=f),s}function uL(n,e,t,i,r="",s=0,f){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!f}}function th(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function l5(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}let dL=(n,e)=>!1,c5=(n,e,t)=>[],u5=null;function hL(n){const e=n.parentNode||n.host;return e===u5?null:e}(aL()||typeof Element<"u")&&(Fie()?(u5=(()=>document.documentElement)(),dL=(n,e)=>{for(;e;){if(e===n)return!0;e=hL(e)}return!1}):dL=(n,e)=>n.contains(e),c5=(n,e,t)=>{if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]});let Hb=null,d5=!1;const h5=dL,f5=c5;let p5=(()=>{class n{validateStyleProperty(t){return function Nie(n){Hb||(Hb=function zie(){return typeof document<"u"?document.body:null}()||{},d5=!!Hb.style&&"WebkitAppearance"in Hb.style);let e=!0;return Hb.style&&!function Lie(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Hb.style,!e&&d5&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Hb.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return h5(t,i)}getParentElement(t){return hL(t)}query(t,i,r){return f5(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,f,b=[],I){return new tT(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})(),fL=(()=>{class n{}return n.NOOP=new p5,n})();const Bie=1e3,pL="ng-enter",RD="ng-leave",FD="ng-trigger",LD=".ng-trigger",g5="ng-animating",mL=".ng-animating";function w_(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:gL(parseFloat(e[1]),e[2])}function gL(n,e){return"s"===e?n*Bie:n}function ND(n,e,t){return n.hasOwnProperty("duration")?n:function Uie(n,e,t){let r,s=0,f="";if("string"==typeof n){const b=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===b)return e.push(s5()),{duration:0,delay:0,easing:""};r=gL(parseFloat(b[1]),b[2]);const I=b[3];null!=I&&(s=gL(parseFloat(I),b[4]));const O=b[5];O&&(f=O)}else r=n;if(!t){let b=!1,I=e.length;r<0&&(e.push(function tie(){return new u.vHH(3100,!1)}()),b=!0),s<0&&(e.push(function nie(){return new u.vHH(3101,!1)}()),b=!0),b&&e.splice(I,0,s5())}return{duration:r,delay:s,easing:f}}(n,e,t)}function zT(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function _5(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function Dv(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function v5(n,e,t){return t?e+":"+t+";":""}function b5(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=v5(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=v5(0,Hie(t),n.style[t]));n.setAttribute("style",e)}function Ym(n,e,t){n.style&&(e.forEach((i,r)=>{const s=yL(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i}),aL()&&b5(n))}function qb(n,e){n.style&&(e.forEach((t,i)=>{const r=yL(i);n.style[r]=""}),aL()&&b5(n))}function BT(n){return Array.isArray(n)?1==n.length?n[0]:OV(n):n}const _L=new RegExp("{{\\s*(.+?)\\s*}}","g");function x5(n){let e=[];if("string"==typeof n){let t;for(;t=_L.exec(n);)e.push(t[1]);_L.lastIndex=0}return e}function VT(n,e,t){const i=n.toString(),r=i.replace(_L,(s,f)=>{let b=e[f];return null==b&&(t.push(function rie(n){return new u.vHH(3003,!1)}()),b=""),b.toString()});return r==i?n:r}function zD(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const Gie=/-+([a-z0-9])/g;function yL(n){return n.replace(Gie,(...e)=>e[1].toUpperCase())}function Hie(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function nh(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function oie(n){return new u.vHH(3004,!1)}()}}const UD="*";function Xie(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function Qie(n,e,t){if(":"==n[0]){const I=function Jie(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function vie(n){return new u.vHH(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof I)return void e.push(I);n=I}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function yie(n){return new u.vHH(3015,!1)}()),e;const r=i[1],s=i[2],f=i[3];e.push(C5(r,f));"<"==s[0]&&!(r==UD&&f==UD)&&e.push(C5(f,r))}(i,t,e)):t.push(n),t}const jD=new Set(["true","1"]),$D=new Set(["false","0"]);function C5(n,e){const t=jD.has(n)||$D.has(n),i=jD.has(e)||$D.has(e);return(r,s)=>{let f=n==UD||n==r,b=e==UD||e==s;return!f&&t&&"boolean"==typeof r&&(f=r?jD.has(n):$D.has(n)),!b&&i&&"boolean"==typeof s&&(b=s?jD.has(e):$D.has(e)),f&&b}}const ere=new RegExp("s*:selfs*,?","g");function vL(n,e,t,i){return new tre(n).build(e,t,i)}class tre{constructor(e){this._driver=e}build(e,t,i){const r=new rre(t);return this._resetContextStyleTimingState(r),nh(this,BT(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],f=[];return"@"==e.name.charAt(0)&&t.errors.push(function aie(){return new u.vHH(3006,!1)}()),e.definitions.forEach(b=>{if(this._resetContextStyleTimingState(t),0==b.type){const I=b,O=I.name;O.toString().split(/\s*,\s*/).forEach(B=>{I.name=B,s.push(this.visitState(I,t))}),I.name=O}else if(1==b.type){const I=this.visitTransition(b,t);i+=I.queryCount,r+=I.depCount,f.push(I)}else t.errors.push(function lie(){return new u.vHH(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:f,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,f=r||{};i.styles.forEach(b=>{b instanceof Map&&b.forEach(I=>{x5(I).forEach(O=>{f.hasOwnProperty(O)||s.add(O)})})}),s.size&&(zD(s.values()),t.errors.push(function cie(n,e){return new u.vHH(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=nh(this,BT(e.animation),t);return{type:1,matchers:Xie(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Zb(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>nh(this,i,t)),options:Zb(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(f=>{t.currentTime=i;const b=nh(this,f,t);return r=Math.max(r,t.currentTime),b});return t.currentTime=r,{type:3,steps:s,options:Zb(e.options)}}visitAnimate(e,t){const i=function sre(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return bL(ND(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=bL(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=ND(t,e);return bL(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:Po({});if(5==s.type)r=this.visitKeyframes(s,t);else{let f=e.styles,b=!1;if(!f){b=!0;const O={};i.easing&&(O.easing=i.easing),f=Po(O)}t.currentTime+=i.duration+i.delay;const I=this.visitStyle(f,t);I.isEmptyStep=b,r=I}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let b of r)"string"==typeof b?b===__?i.push(b):t.errors.push(new u.vHH(3002,!1)):i.push(_5(b));let s=!1,f=null;return i.forEach(b=>{if(b instanceof Map&&(b.has("easing")&&(f=b.get("easing"),b.delete("easing")),!s))for(let I of b.values())if(I.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:f,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(f=>{"string"!=typeof f&&f.forEach((b,I)=>{const O=t.collectedStyles.get(t.currentQuerySelector),B=O.get(I);let K=!0;B&&(s!=r&&s>=B.startTime&&r<=B.endTime&&(t.errors.push(function die(n,e,t,i,r){return new u.vHH(3010,!1)}()),K=!1),s=B.startTime),K&&O.set(I,{startTime:s,endTime:r}),t.options&&function $ie(n,e,t){const i=e.params||{},r=x5(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function iie(n){return new u.vHH(3001,!1)}())})}(b,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function hie(){return new u.vHH(3011,!1)}()),i;let s=0;const f=[];let b=!1,I=!1,O=0;const B=e.steps.map(Qt=>{const xn=this._makeStyleAst(Qt,t);let zn=null!=xn.offset?xn.offset:function ore(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(xn.styles),li=0;return null!=zn&&(s++,li=xn.offset=zn),I=I||li<0||li>1,b=b||li<O,O=li,f.push(li),xn});I&&t.errors.push(function fie(){return new u.vHH(3012,!1)}()),b&&t.errors.push(function pie(){return new u.vHH(3200,!1)}());const K=e.steps.length;let le=0;s>0&&s<K?t.errors.push(function mie(){return new u.vHH(3202,!1)}()):0==s&&(le=1/(K-1));const ge=K-1,Te=t.currentTime,Ge=t.currentAnimateTimings,Je=Ge.duration;return B.forEach((Qt,xn)=>{const zn=le>0?xn==ge?1:le*xn:f[xn],li=zn*Je;t.currentTime=Te+Ge.delay+li,Ge.duration=li,this._validateStyleAst(Qt,t),Qt.offset=zn,i.styles.push(Qt)}),i}visitReference(e,t){return{type:8,animation:nh(this,BT(e.animation),t),options:Zb(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Zb(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Zb(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,f]=function nre(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(ere,"")),n=n.replace(/@\*/g,LD).replace(/@\w+/g,t=>LD+"-"+t.slice(1)).replace(/:animating/g,mL),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,th(t.collectedStyles,t.currentQuerySelector,new Map);const b=nh(this,BT(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:f,animation:b,originalSelector:e.selector,options:Zb(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function gie(){return new u.vHH(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:ND(e.timings,t.errors,!0);return{type:12,animation:nh(this,BT(e.animation),t),timings:i,options:null}}}class rre{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Zb(n){return n?(n=zT(n)).params&&(n.params=function ire(n){return n?zT(n):null}(n.params)):n={},n}function bL(n,e,t){return{duration:n,delay:e,easing:t}}function xL(n,e,t,i,r,s,f=null,b=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:f,subTimeline:b}}class GD{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const cre=new RegExp(":enter","g"),dre=new RegExp(":leave","g");function wL(n,e,t,i,r,s=new Map,f=new Map,b,I,O=[]){return(new hre).buildKeyframes(n,e,t,i,r,s,f,b,I,O)}class hre{buildKeyframes(e,t,i,r,s,f,b,I,O,B=[]){O=O||new GD;const K=new CL(e,t,O,r,s,B,[]);K.options=I;const le=I.delay?w_(I.delay):0;K.currentTimeline.delayNextStep(le),K.currentTimeline.setStyles([f],null,K.errors,I),nh(this,i,K);const ge=K.timelines.filter(Te=>Te.containsAnimation());if(ge.length&&b.size){let Te;for(let Ge=ge.length-1;Ge>=0;Ge--){const Je=ge[Ge];if(Je.element===t){Te=Je;break}}Te&&!Te.allowOnlyTimelineStyles()&&Te.setStyles([b],null,K.errors,I)}return ge.length?ge.map(Te=>Te.buildKeyframes()):[xL(t,[],[],[],0,le,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,f=this._visitSubInstructions(i,r,r.options);s!=f&&t.transformIntoNewTimeline(f)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const f="number"==typeof s?s:w_(VT(s,r?.params??{},t.errors));i.delayNextStep(f)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const f=null!=i.duration?w_(i.duration):null,b=null!=i.delay?w_(i.delay):null;return 0!==f&&e.forEach(I=>{const O=t.appendInstructionToTimeline(I,f,b);s=Math.max(s,O.duration+O.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),nh(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=HD);const f=w_(s.delay);r.delayNextStep(f)}e.steps.length&&(e.steps.forEach(f=>nh(this,f,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?w_(e.options.delay):0;e.steps.forEach(f=>{const b=t.createSubContext(e.options);s&&b.delayNextStep(s),nh(this,f,b),r=Math.max(r,b.currentTimeline.currentTime),i.push(b.currentTimeline)}),i.forEach(f=>t.currentTimeline.mergeTimelineCollectedStyles(f)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return ND(t.params?VT(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,b=t.createSubContext().currentTimeline;b.easing=i.easing,e.styles.forEach(I=>{b.forwardTime((I.offset||0)*s),b.setStyles(I.styles,I.easing,t.errors,t.options),b.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(b),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?w_(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=HD);let f=i;const b=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=b.length;let I=null;b.forEach((O,B)=>{t.currentQueryIndex=B;const K=t.createSubContext(e.options,O);s&&K.delayNextStep(s),O===t.element&&(I=K.currentTimeline),nh(this,e.animation,K),K.currentTimeline.applyStylesToKeyframe(),f=Math.max(f,K.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(f),I&&(t.currentTimeline.mergeTimelineCollectedStyles(I),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,f=Math.abs(s.duration),b=f*(t.currentQueryTotal-1);let I=f*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":I=b-I;break;case"full":I=i.currentStaggerTime}const B=t.currentTimeline;I&&B.delayNextStep(I);const K=B.currentTime;nh(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-K+(r.startTime-i.currentTimeline.startTime)}}const HD={};class CL{constructor(e,t,i,r,s,f,b,I){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=f,this.timelines=b,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=HD,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=I||new qD(this._driver,t,0),b.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=w_(i.duration)),null!=i.delay&&(r.delay=w_(i.delay));const s=i.params;if(s){let f=r.params;f||(f=this.options.params={}),Object.keys(s).forEach(b=>{(!t||!f.hasOwnProperty(b))&&(f[b]=VT(s[b],f,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new CL(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=HD,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new fre(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,f){let b=[];if(r&&b.push(this.element),e.length>0){e=(e=e.replace(cre,"."+this._enterClassName)).replace(dre,"."+this._leaveClassName);let O=this._driver.query(this.element,e,1!=i);0!==i&&(O=i<0?O.slice(O.length+i,O.length):O.slice(0,i)),b.push(...O)}return!s&&0==b.length&&f.push(function _ie(n){return new u.vHH(3014,!1)}()),b}}class qD{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new qD(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||__),this._currentKeyframe.set(t,__);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},f=function pre(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,__)}else Dv(r,t)}),t}(e,this._globalTimelineStyles);for(let[b,I]of f){const O=VT(I,s,i);this._pendingStyles.set(b,O),this._localTimelineStyles.has(b)||this._backFill.set(b,this._globalTimelineStyles.get(b)??__),this._updateStyle(b,O)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((b,I)=>{const O=Dv(b,new Map,this._backFill);O.forEach((B,K)=>{B===g2?e.add(K):B===__&&t.add(K)}),i||O.set("offset",I/this.duration),r.push(O)});const s=e.size?zD(e.values()):[],f=t.size?zD(t.values()):[];if(i){const b=r[0],I=new Map(b);b.set("offset",0),I.set("offset",1),r=[b,I]}return xL(this.element,r,s,f,this.duration,this.startTime,this.easing,!1)}}class fre extends qD{constructor(e,t,i,r,s,f,b=!1){super(e,t,f.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=b,this.timings={duration:f.duration,delay:f.delay,easing:f.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],f=i+t,b=t/f,I=Dv(e[0]);I.set("offset",0),s.push(I);const O=Dv(e[0]);O.set("offset",I5(b)),s.push(O);const B=e.length-1;for(let K=1;K<=B;K++){let le=Dv(e[K]);const ge=le.get("offset");le.set("offset",I5((t+ge*i)/f)),s.push(le)}i=f,t=0,r="",e=s}return xL(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function I5(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class EL{}const mre=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class gre extends EL{normalizePropertyName(e,t){return yL(e)}normalizeStyleValue(e,t,i,r){let s="";const f=i.toString().trim();if(mre.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const b=i.match(/^[+-]?[\d\.]+([a-z]*)$/);b&&0==b[1].length&&r.push(function sie(n,e){return new u.vHH(3005,!1)}())}return f+s}}function S5(n,e,t,i,r,s,f,b,I,O,B,K,le){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:f,timelines:b,queriedElements:I,preStyleProps:O,postStyleProps:B,totalTime:K,errors:le}}const TL={};class M5{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function _re(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,f,b,I,O,B){const K=[],le=this.ast.options&&this.ast.options.params||TL,Te=this.buildStyles(i,b&&b.params||TL,K),Ge=I&&I.params||TL,Je=this.buildStyles(r,Ge,K),Qt=new Set,xn=new Map,zn=new Map,li="void"===r,Gi={params:yre(Ge,le),delay:this.ast.options?.delay},Ki=B?[]:wL(e,t,this.ast.animation,s,f,Te,Je,Gi,O,K);let ao=0;if(Ki.forEach(C_=>{ao=Math.max(C_.duration+C_.delay,ao)}),K.length)return S5(t,this._triggerName,i,r,li,Te,Je,[],[],xn,zn,ao,K);Ki.forEach(C_=>{const E_=C_.element,$5=th(xn,E_,new Set);C_.preStyleProps.forEach(Wb=>$5.add(Wb));const jT=th(zn,E_,new Set);C_.postStyleProps.forEach(Wb=>jT.add(Wb)),E_!==t&&Qt.add(E_)});const ml=zD(Qt.values());return S5(t,this._triggerName,i,r,li,Te,Je,Ki,ml,xn,zn,ao)}}function yre(n,e){const t=zT(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class vre{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=zT(this.defaultParams);return Object.keys(e).forEach(s=>{const f=e[s];null!==f&&(r[s]=f)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((f,b)=>{f&&(f=VT(f,r,t));const I=this.normalizer.normalizePropertyName(b,t);f=this.normalizer.normalizeStyleValue(b,I,f,t),i.set(b,f)})}),i}}class xre{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new vre(r.style,r.options&&r.options.params||{},i))}),D5(this.states,"true","1"),D5(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new M5(e,r,this.states))}),this.fallbackTransition=function wre(n,e,t){return new M5(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(f,b)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(f=>f.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function D5(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const Cre=new GD;class Ere{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],r=[],s=vL(this._driver,t,i,r);if(i.length)throw function Eie(n){return new u.vHH(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=a5(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let f;const b=new Map;if(s?(f=wL(this._driver,t,s,pL,RD,new Map,new Map,i,Cre,r),f.forEach(B=>{const K=th(b,B.element,new Map);B.postStyleProps.forEach(le=>K.set(le,null))})):(r.push(function Tie(){return new u.vHH(3300,!1)}()),f=[]),r.length)throw function Iie(n){return new u.vHH(3504,!1)}();b.forEach((B,K)=>{B.forEach((le,ge)=>{B.set(ge,this._driver.computeStyle(K,ge,__))})});const O=Mv(f.map(B=>{const K=b.get(B.element);return this._buildPlayer(B,new Map,K)}));return this._playersById.set(e,O),O.onDestroy(()=>this.destroy(e)),this.players.push(O),O}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function Sie(n){return new u.vHH(3301,!1)}();return t}listen(e,t,i,r){const s=uL(t,"","","");return lL(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const A5="ng-animate-queued",IL="ng-animate-disabled",Dre=[],P5={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Are={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},pf="__ng_removed";class SL{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function Rre(n){return n??null}(i?e.value:e),i){const s=zT(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const UT="void",ML=new SL(UT);class Pre{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,mf(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function Mie(n,e){return new u.vHH(3302,!1)}();if(null==i||0==i.length)throw function Die(n){return new u.vHH(3303,!1)}();if(!function Fre(n){return"start"==n||"done"==n}(i))throw function Aie(n,e){return new u.vHH(3400,!1)}();const s=th(this._elementListeners,e,[]),f={name:t,phase:i,callback:r};s.push(f);const b=th(this._engine.statesByElement,e,new Map);return b.has(t)||(mf(e,FD),mf(e,FD+"-"+t),b.set(t,ML)),()=>{this._engine.afterFlush(()=>{const I=s.indexOf(f);I>=0&&s.splice(I,1),this._triggers.has(t)||b.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function Pie(n){return new u.vHH(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),f=new DL(this.id,t,e);let b=this._engine.statesByElement.get(e);b||(mf(e,FD),mf(e,FD+"-"+t),this._engine.statesByElement.set(e,b=new Map));let I=b.get(t);const O=new SL(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&I&&O.absorbOptions(I.options),b.set(t,O),I||(I=ML),O.value!==UT&&I.value===O.value){if(!function zre(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(I.params,O.params)){const Ge=[],Je=s.matchStyles(I.value,I.params,Ge),Qt=s.matchStyles(O.value,O.params,Ge);Ge.length?this._engine.reportError(Ge):this._engine.afterFlush(()=>{qb(e,Je),Ym(e,Qt)})}return}const le=th(this._engine.playersByElement,e,[]);le.forEach(Ge=>{Ge.namespaceId==this.id&&Ge.triggerName==t&&Ge.queued&&Ge.destroy()});let ge=s.matchTransition(I.value,O.value,e,O.params),Te=!1;if(!ge){if(!r)return;ge=s.fallbackTransition,Te=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:ge,fromState:I,toState:O,player:f,isFallbackTransition:Te}),Te||(mf(e,A5),f.onStart(()=>{N1(e,A5)})),f.onDone(()=>{let Ge=this.players.indexOf(f);Ge>=0&&this.players.splice(Ge,1);const Je=this._engine.playersByElement.get(e);if(Je){let Qt=Je.indexOf(f);Qt>=0&&Je.splice(Qt,1)}}),this.players.push(f),le.push(f),f}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,LD,!0);i.forEach(r=>{if(r[pf])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(f=>f.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),f=new Map;if(s){const b=[];if(s.forEach((I,O)=>{if(f.set(O,I.value),this._triggers.has(O)){const B=this.trigger(e,O,UT,r);B&&b.push(B)}}),b.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,f),i&&Mv(b).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const f=s.name;if(r.has(f))return;r.add(f);const I=this._triggers.get(f).fallbackTransition,O=i.get(f)||ML,B=new SL(UT),K=new DL(this.id,f,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:f,transition:I,fromState:O,toState:B,player:K,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let f=e;for(;f=f.parentNode;)if(i.statesByElement.get(f)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[pf];(!s||s===P5)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){mf(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,f=this._elementListeners.get(s);f&&f.forEach(b=>{if(b.name==i.triggerName){const I=uL(s,i.triggerName,i.fromState.value,i.toState.value);I._data=e,lL(i.player,b.phase,I,b.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,f=r.transition.ast.depCount;return 0==s||0==f?s-f:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(i=>i.element===e)||t,t}}class Ore{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new Pre(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let f=!1,b=this.driver.getParentElement(t);for(;b;){const I=r.get(b);if(I){const O=i.indexOf(I);i.splice(O+1,0,e),f=!0;break}b=this.driver.getParentElement(b)}f||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(ZD(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!ZD(t))return;const s=t[pf];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const f=this.collectedLeaveElements.indexOf(t);f>=0&&this.collectedLeaveElements.splice(f,1)}if(e){const f=this._fetchNamespace(e);f&&f.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),mf(e,IL)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),N1(e,IL))}removeNode(e,t,i,r){if(ZD(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),i){const f=this.namespacesByHostElement.get(t);f&&f.id!==e&&f.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[pf]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return ZD(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,LD,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,mL,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Mv(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[pf];if(t&&t.setForRemoval){if(e[pf]=P5,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(IL)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)mf(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?Mv(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function Oie(n){return new u.vHH(3402,!1)}()}_flushAnimations(e,t){const i=new GD,r=[],s=new Map,f=[],b=new Map,I=new Map,O=new Map,B=new Set;this.disabledNodes.forEach(ci=>{B.add(ci);const Si=this.driver.query(ci,".ng-animate-queued",!0);for(let Ni=0;Ni<Si.length;Ni++)B.add(Si[Ni])});const K=this.bodyNode,le=Array.from(this.statesByElement.keys()),ge=R5(le,this.collectedEnterElements),Te=new Map;let Ge=0;ge.forEach((ci,Si)=>{const Ni=pL+Ge++;Te.set(Si,Ni),ci.forEach(Hr=>mf(Hr,Ni))});const Je=[],Qt=new Set,xn=new Set;for(let ci=0;ci<this.collectedLeaveElements.length;ci++){const Si=this.collectedLeaveElements[ci],Ni=Si[pf];Ni&&Ni.setForRemoval&&(Je.push(Si),Qt.add(Si),Ni.hasAnimation?this.driver.query(Si,".ng-star-inserted",!0).forEach(Hr=>Qt.add(Hr)):xn.add(Si))}const zn=new Map,li=R5(le,Array.from(Qt));li.forEach((ci,Si)=>{const Ni=RD+Ge++;zn.set(Si,Ni),ci.forEach(Hr=>mf(Hr,Ni))}),e.push(()=>{ge.forEach((ci,Si)=>{const Ni=Te.get(Si);ci.forEach(Hr=>N1(Hr,Ni))}),li.forEach((ci,Si)=>{const Ni=zn.get(Si);ci.forEach(Hr=>N1(Hr,Ni))}),Je.forEach(ci=>{this.processLeaveNode(ci)})});const Gi=[],Ki=[];for(let ci=this._namespaceList.length-1;ci>=0;ci--)this._namespaceList[ci].drainQueuedTransitions(t).forEach(Ni=>{const Hr=Ni.player,gl=Ni.element;if(Gi.push(Hr),this.collectedEnterElements.length){const Dc=gl[pf];if(Dc&&Dc.setForMove){if(Dc.previousTriggersValues&&Dc.previousTriggersValues.has(Ni.triggerName)){const Yb=Dc.previousTriggersValues.get(Ni.triggerName),gf=this.statesByElement.get(Ni.element);if(gf&&gf.has(Ni.triggerName)){const KD=gf.get(Ni.triggerName);KD.value=Yb,gf.set(Ni.triggerName,KD)}}return void Hr.destroy()}}const Km=!K||!this.driver.containsElement(K,gl),ih=zn.get(gl),Av=Te.get(gl),zs=this._buildInstruction(Ni,i,Av,ih,Km);if(zs.errors&&zs.errors.length)return void Ki.push(zs);if(Km)return Hr.onStart(()=>qb(gl,zs.fromStyles)),Hr.onDestroy(()=>Ym(gl,zs.toStyles)),void r.push(Hr);if(Ni.isFallbackTransition)return Hr.onStart(()=>qb(gl,zs.fromStyles)),Hr.onDestroy(()=>Ym(gl,zs.toStyles)),void r.push(Hr);const q5=[];zs.timelines.forEach(Dc=>{Dc.stretchStartingKeyframe=!0,this.disabledNodes.has(Dc.element)||q5.push(Dc)}),zs.timelines=q5,i.append(gl,zs.timelines),f.push({instruction:zs,player:Hr,element:gl}),zs.queriedElements.forEach(Dc=>th(b,Dc,[]).push(Hr)),zs.preStyleProps.forEach((Dc,Yb)=>{if(Dc.size){let gf=I.get(Yb);gf||I.set(Yb,gf=new Set),Dc.forEach((KD,PL)=>gf.add(PL))}}),zs.postStyleProps.forEach((Dc,Yb)=>{let gf=O.get(Yb);gf||O.set(Yb,gf=new Set),Dc.forEach((KD,PL)=>gf.add(PL))})});if(Ki.length){const ci=[];Ki.forEach(Si=>{ci.push(function kie(n,e){return new u.vHH(3505,!1)}())}),Gi.forEach(Si=>Si.destroy()),this.reportError(ci)}const ao=new Map,ml=new Map;f.forEach(ci=>{const Si=ci.element;i.has(Si)&&(ml.set(Si,Si),this._beforeAnimationBuild(ci.player.namespaceId,ci.instruction,ao))}),r.forEach(ci=>{const Si=ci.element;this._getPreviousPlayers(Si,!1,ci.namespaceId,ci.triggerName,null).forEach(Hr=>{th(ao,Si,[]).push(Hr),Hr.destroy()})});const C_=Je.filter(ci=>L5(ci,I,O)),E_=new Map;k5(E_,this.driver,xn,O,__).forEach(ci=>{L5(ci,I,O)&&C_.push(ci)});const jT=new Map;ge.forEach((ci,Si)=>{k5(jT,this.driver,new Set(ci),I,g2)}),C_.forEach(ci=>{const Si=E_.get(ci),Ni=jT.get(ci);E_.set(ci,new Map([...Array.from(Si?.entries()??[]),...Array.from(Ni?.entries()??[])]))});const Wb=[],G5=[],H5={};f.forEach(ci=>{const{element:Si,player:Ni,instruction:Hr}=ci;if(i.has(Si)){if(B.has(Si))return Ni.onDestroy(()=>Ym(Si,Hr.toStyles)),Ni.disabled=!0,Ni.overrideTotalTime(Hr.totalTime),void r.push(Ni);let gl=H5;if(ml.size>1){let ih=Si;const Av=[];for(;ih=ih.parentNode;){const zs=ml.get(ih);if(zs){gl=zs;break}Av.push(ih)}Av.forEach(zs=>ml.set(zs,gl))}const Km=this._buildAnimation(Ni.namespaceId,Hr,ao,s,jT,E_);if(Ni.setRealPlayer(Km),gl===H5)Wb.push(Ni);else{const ih=this.playersByElement.get(gl);ih&&ih.length&&(Ni.parentPlayer=Mv(ih)),r.push(Ni)}}else qb(Si,Hr.fromStyles),Ni.onDestroy(()=>Ym(Si,Hr.toStyles)),G5.push(Ni),B.has(Si)&&r.push(Ni)}),G5.forEach(ci=>{const Si=s.get(ci.element);if(Si&&Si.length){const Ni=Mv(Si);ci.setRealPlayer(Ni)}}),r.forEach(ci=>{ci.parentPlayer?ci.syncPlayerEvents(ci.parentPlayer):ci.destroy()});for(let ci=0;ci<Je.length;ci++){const Si=Je[ci],Ni=Si[pf];if(N1(Si,RD),Ni&&Ni.hasAnimation)continue;let Hr=[];if(b.size){let Km=b.get(Si);Km&&Km.length&&Hr.push(...Km);let ih=this.driver.query(Si,mL,!0);for(let Av=0;Av<ih.length;Av++){let zs=b.get(ih[Av]);zs&&zs.length&&Hr.push(...zs)}}const gl=Hr.filter(Km=>!Km.destroyed);gl.length?Lre(this,Si,gl):this.processLeaveNode(Si)}return Je.length=0,Wb.forEach(ci=>{this.players.push(ci),ci.onDone(()=>{ci.destroy();const Si=this.players.indexOf(ci);this.players.splice(Si,1)}),ci.play()}),Wb}elementContainsData(e,t){let i=!1;const r=t[pf];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let f=[];if(t){const b=this.playersByQueriedElement.get(e);b&&(f=b)}else{const b=this.playersByElement.get(e);if(b){const I=!s||s==UT;b.forEach(O=>{O.queued||!I&&O.triggerName!=r||f.push(O)})}}return(i||r)&&(f=f.filter(b=>!(i&&i!=b.namespaceId||r&&r!=b.triggerName))),f}_beforeAnimationBuild(e,t,i){const s=t.element,f=t.isRemovalTransition?void 0:e,b=t.isRemovalTransition?void 0:t.triggerName;for(const I of t.timelines){const O=I.element,B=O!==s,K=th(i,O,[]);this._getPreviousPlayers(O,B,f,b,t.toState).forEach(ge=>{const Te=ge.getRealPlayer();Te.beforeDestroy&&Te.beforeDestroy(),ge.destroy(),K.push(ge)})}qb(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,f){const b=t.triggerName,I=t.element,O=[],B=new Set,K=new Set,le=t.timelines.map(Te=>{const Ge=Te.element;B.add(Ge);const Je=Ge[pf];if(Je&&Je.removedBeforeQueried)return new tT(Te.duration,Te.delay);const Qt=Ge!==I,xn=function Nre(n){const e=[];return F5(n,e),e}((i.get(Ge)||Dre).map(ao=>ao.getRealPlayer())).filter(ao=>!!ao.element&&ao.element===Ge),zn=s.get(Ge),li=f.get(Ge),Gi=a5(0,this._normalizer,0,Te.keyframes,zn,li),Ki=this._buildPlayer(Te,Gi,xn);if(Te.subTimeline&&r&&K.add(Ge),Qt){const ao=new DL(e,b,Ge);ao.setRealPlayer(Ki),O.push(ao)}return Ki});O.forEach(Te=>{th(this.playersByQueriedElement,Te.element,[]).push(Te),Te.onDone(()=>function kre(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,Te.element,Te))}),B.forEach(Te=>mf(Te,g5));const ge=Mv(le);return ge.onDestroy(()=>{B.forEach(Te=>N1(Te,g5)),Ym(I,t.toStyles)}),K.forEach(Te=>{th(r,Te,[]).push(ge)}),ge}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new tT(e.duration,e.delay)}}class DL{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new tT,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>lL(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){th(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function ZD(n){return n&&1===n.nodeType}function O5(n,e){const t=n.style.display;return n.style.display=e??"none",t}function k5(n,e,t,i,r){const s=[];t.forEach(I=>s.push(O5(I)));const f=[];i.forEach((I,O)=>{const B=new Map;I.forEach(K=>{const le=e.computeStyle(O,K,r);B.set(K,le),(!le||0==le.length)&&(O[pf]=Are,f.push(O))}),n.set(O,B)});let b=0;return t.forEach(I=>O5(I,s[b++])),f}function R5(n,e){const t=new Map;if(n.forEach(b=>t.set(b,[])),0==e.length)return t;const i=1,r=new Set(e),s=new Map;function f(b){if(!b)return i;let I=s.get(b);if(I)return I;const O=b.parentNode;return I=t.has(O)?O:r.has(O)?i:f(O),s.set(b,I),I}return e.forEach(b=>{const I=f(b);I!==i&&t.get(I).push(b)}),t}function mf(n,e){n.classList?.add(e)}function N1(n,e){n.classList?.remove(e)}function Lre(n,e,t){Mv(t).onDone(()=>n.processLeaveNode(e))}function F5(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof LV?F5(i.players,e):e.push(i)}}function L5(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class WD{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new Ore(e,t,i),this._timelineEngine=new Ere(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const f=e+"-"+r;let b=this._triggerCache[f];if(!b){const I=[],O=[],B=vL(this._driver,s,I,O);if(I.length)throw function wie(n,e){return new u.vHH(3404,!1)}();b=function bre(n,e,t){return new xre(n,e,t)}(r,B,this._normalizer),this._triggerCache[f]=b}this._transitionEngine.registerTrigger(t,r,b)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i,r){this._transitionEngine.removeNode(e,t,r||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,f]=l5(i);this._timelineEngine.command(s,t,f,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[f,b]=l5(i);return this._timelineEngine.listen(f,t,b,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let $re=(()=>{class n extends PV{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:u.ifc.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?OV(t):t;return z5(this._renderer,null,i,"register",[r]),new Gre(i,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(u.FYo),u.LFG(ft))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();class Gre extends AY{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Hre(this._id,e,t||{},this._renderer)}}class Hre{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return z5(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function z5(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const B5="@.disabled";let qre=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,f)=>{const b=f?.parentNode(s);b&&f.removeChild(b,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let B=this._rendererCache.get(s);return B||(B=new V5("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,B)),B}const f=i.id,b=i.id+"-"+this._currentId;this._currentId++,this.engine.register(b,t);const I=B=>{Array.isArray(B)?B.forEach(I):this.engine.registerTrigger(f,b,t,B.name,B)};return i.data.animation.forEach(I),new Zre(this,b,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[f,b]=s;f(b)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(u.FYo),u.LFG(WD),u.LFG(u.R0b))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();class V5{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==B5?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Zre extends V5{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==B5?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function Wre(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),f="";return"@"!=s.charAt(0)&&([s,f]=function Yre(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,f,b=>{this.factory.scheduleListenerCallback(b._data||-1,i,b)})}return this.delegate.listen(e,t,i)}}let Kre=(()=>{class n extends WD{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(u.LFG(ft),u.LFG(fL),u.LFG(EL),u.LFG(u.z2F))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac}),n})();const U5=[{provide:PV,useClass:$re},{provide:EL,useFactory:function Xre(){return new gre}},{provide:WD,useClass:Kre},{provide:u.FYo,useFactory:function Qre(n,e,t){return new qre(n,e,t)},deps:[ph,WD,u.R0b]}],j5=[{provide:fL,useClass:p5},{provide:u.QbO,useValue:"NoopAnimations"},...U5];let eoe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:j5,imports:[Os]}),n})(),toe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({imports:[ys,zV,IQ,bX,VY,qX,PQ,CU]}),n})(),noe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.oAB({type:n,bootstrap:[tJ]}),n.\u0275inj=u.cJS({providers:[aj,Z2,{provide:Ep.Dh,useValue:nj.firebase},{provide:An,useClass:kt}],imports:[Os,eJ,U,W,toe,q8(()=>Z8(nj.firebase)),SJ(()=>oJ()),GZ(()=>qZ()),Jne(()=>eie()),JZ(()=>tW()),eoe]}),n})();Df().bootstrapModule(noe).catch(n=>console.error(n))},9898:function(ui){ui.exports=function(){"use strict";var Kt,De,u;function Ne(_,$e){if(Kt)if(De){var ft="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Kt+")(sharedChunk); ("+De+")(sharedChunk); self.onerror = null;",on={};Kt(on),u=$e(on),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(u.workerUrl=window.URL.createObjectURL(new Blob([ft],{type:"text/javascript"})))}else De=$e;else Kt=$e}return Ne(0,function(_){var $e=typeof self<"u"?self:{},ft="2.13.0";let on;const yt={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==on){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{on=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):a}catch{on=a}}return on},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},It={supported:!1,testSupport:function(a){!Ke&&je&&(pn?nn(a):Ve=a)}};let Ve,je,Ke=!1,pn=!1;function nn(a){const o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,je),a.isContextLost())return;It.supported=!0}catch{}a.deleteTexture(o),Ke=!0}$e.document&&(je=$e.document.createElement("img"),je.onload=function(){Ve&&nn(Ve),Ve=null,pn=!0},je.onerror=function(){Ke=!0,Ve=null},je.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const bn="01";var An=vt;function vt(a,o,l,p){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(p-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=o,this.p2x=l,this.p2y=p}vt.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,o){if(void 0===o&&(o=1e-6),a<0)return 0;if(a>1)return 1;for(var l=a,p=0;p<8;p++){var y=this.sampleCurveX(l)-a;if(Math.abs(y)<o)return l;var w=this.sampleCurveDerivativeX(l);if(Math.abs(w)<1e-6)break;l-=y/w}var E=0,M=1;for(l=a,p=0;p<20&&(y=this.sampleCurveX(l),!(Math.abs(y-a)<o));p++)a>y?E=l:M=l,l=.5*(M-E)+E;return l},solve:function(a,o){return this.sampleCurveY(this.solveCurveX(a,o))}};var Ye=kt;function kt(a,o){this.x=a,this.y=o}kt.prototype={clone:function(){return new kt(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,o){return this.clone()._rotateAround(a,o)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var o=a.x-this.x,l=a.y-this.y;return o*o+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,o){return Math.atan2(this.x*o-this.y*a,this.x*a+this.y*o)},_matMult:function(a){var o=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=o,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var o=Math.cos(a),l=Math.sin(a),p=l*this.x+o*this.y;return this.x=o*this.x-l*this.y,this.y=p,this},_rotateAround:function(a,o){var l=Math.cos(a),p=Math.sin(a),y=o.y+p*(this.x-o.x)+l*(this.y-o.y);return this.x=o.x+l*(this.x-o.x)-p*(this.y-o.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},kt.convert=function(a){return a instanceof kt?a:Array.isArray(a)?new kt(a[0],a[1]):a};const Jt=Math.PI/180,Xt=180/Math.PI;function xt(a){return a*Jt}function Pt(a){return a*Xt}const un=[[0,0],[1,0],[1,1],[0,1]];function nt(a){if(a<=0)return 0;if(a>=1)return 1;const o=a*a,l=o*a;return 4*(a<.5?l:3*(a-o)+l-.75)}function pt(a,o,l,p){const y=new An(a,o,l,p);return function(w){return y.solve(w)}}const Nt=pt(.25,.1,.25,1);function zt(a,o,l){return Math.min(l,Math.max(o,a))}function an(a,o,l){return(l=zt((l-a)/(o-a),0,1))*l*(3-2*l)}function si(a,o,l){const p=l-o,y=((a-o)%p+p)%p+o;return y===o?l:y}function On(a,o,l){if(!a.length)return l(null,[]);let p=a.length;const y=new Array(a.length);let w=null;a.forEach((E,M)=>{o(E,(k,F)=>{k&&(w=k),y[M]=F,0==--p&&l(w,y)})})}function mt(a){const o=[];for(const l in a)o.push(a[l]);return o}function gt(a,...o){for(const l of o)for(const p in l)a[p]=l[p];return a}let Dt=1;function Ht(){return Dt++}function rn(){return function a(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function en(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function wn(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function Cn(a,o){a.forEach(l=>{o[l]&&(o[l]=o[l].bind(o))})}function ir(a,o){return-1!==a.indexOf(o,a.length-o.length)}function qn(a,o,l){const p={};for(const y in a)p[y]=o.call(l||this,a[y],y,a);return p}function Bn(a,o,l){const p={};for(const y in a)o.call(l||this,a[y],y,a)&&(p[y]=a[y]);return p}function vn(a){return Array.isArray(a)?a.map(vn):"object"==typeof a&&a?qn(a,vn):a}const Xi={};function Ai(a){Xi[a]||(typeof console<"u"&&console.warn(a),Xi[a]=!0)}function dr(a,o,l){return(l.y-a.y)*(o.x-a.x)>(o.y-a.y)*(l.x-a.x)}function Un(a){let o=0;for(let l,p,y=0,w=a.length,E=w-1;y<w;E=y++)l=a[y],p=a[E],o+=(p.x-l.x)*(l.y+p.y);return o}function kr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function lo(a){const o={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,p,y,w)=>{const E=y||w;return o[p]=!E||E.toLowerCase(),""}),o["max-age"]){const l=parseInt(o["max-age"],10);isNaN(l)?delete o["max-age"]:o["max-age"]=l}return o}let Is=null;function co(a){if(null==Is){const o=a.navigator?a.navigator.userAgent:null;Is=!!a.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return Is}function Ss(a){try{const o=$e[a];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}}function gs(a,o){return[a[4*o],a[4*o+1],a[4*o+2],a[4*o+3]]}const Sr="mapbox-tiles";let $r,In,Uo=500,ss=50;function wo(){try{return $e.caches}catch{}}function Gr(){wo()&&!$r&&($r=$e.caches.open(Sr))}function as(a){const o=a.indexOf("?");if(o<0)return a;const p=function(y){const w=y.indexOf("?");return w>0?y.slice(w+1).split("&"):[]}(a).filter(y=>{const w=y.split("=");return"language"===w[0]||"worldview"===w[0]});return p.length?`${a.slice(0,o)}?${p.join("&")}`:a.slice(0,o)}let hi=1/0;const jn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(jn);class Xn extends Error{constructor(o,l,p){401===l&&qr(p)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=l,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const zr=kr()?()=>self.worker&&self.worker.referrer:()=>("blob:"===$e.location.protocol?$e.parent:$e).location.href,Mr=function(a,o){if(!(/^file:/.test(l=a.url)||/^file:/.test(zr())&&!/^\w+:/.test(l))){if($e.fetch&&$e.Request&&$e.AbortController&&$e.Request.prototype.hasOwnProperty("signal"))return function(p,y){const w=new $e.AbortController,E=new $e.Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:zr(),signal:w.signal});let M=!1,k=!1;const F=(U=E.url).indexOf("sku=")>0&&qr(U);var U;"json"===p.type&&E.headers.set("Accept","application/json");const W=(Q,ie,se)=>{if(k)return;if(Q&&"SecurityError"!==Q.message&&Ai(Q),ie&&se)return V(ie);const te=Date.now();$e.fetch(E).then(we=>{if(we.ok){const Oe=F?we.clone():null;return V(we,Oe,te)}return y(new Xn(we.statusText,we.status,p.url))}).catch(we=>{"AbortError"!==we.name&&y(new Error(`${we.message} ${p.url}`))})},V=(Q,ie,se)=>{("arrayBuffer"===p.type?Q.arrayBuffer():"json"===p.type?Q.json():Q.text()).then(te=>{k||(ie&&se&&function(we,Oe,me){if(Gr(),!$r)return;const Ae={status:Oe.status,statusText:Oe.statusText,headers:new $e.Headers};Oe.headers.forEach((lt,tt)=>Ae.headers.set(tt,lt));const Ee=lo(Oe.headers.get("Cache-Control")||"");if(Ee["no-store"])return;Ee["max-age"]&&Ae.headers.set("Expires",new Date(me+1e3*Ee["max-age"]).toUTCString());const Re=Ae.headers.get("Expires");Re&&(new Date(Re).getTime()-me<42e4||function(lt,tt){if(void 0===In)try{new Response(new ReadableStream),In=!0}catch{In=!1}In?tt(lt.body):lt.blob().then(tt)}(Oe,lt=>{const tt=new $e.Response(lt,Ae);Gr(),$r&&$r.then(wt=>wt.put(as(we.url),tt)).catch(wt=>Ai(wt.message))}))}(E,ie,se),M=!0,y(null,te,Q.headers.get("Cache-Control"),Q.headers.get("Expires")))}).catch(te=>{k||y(new Error(te.message))})};return F?function(Q,ie){if(Gr(),!$r)return ie(null);const se=as(Q.url);$r.then(te=>{te.match(se).then(we=>{const Oe=function(me){if(!me)return!1;const Ae=new Date(me.headers.get("Expires")||0),Ee=lo(me.headers.get("Cache-Control")||"");return Ae>Date.now()&&!Ee["no-cache"]}(we);te.delete(se),Oe&&te.put(se,we.clone()),ie(null,we,Oe)}).catch(ie)}).catch(ie)}(E,W):W(null,null),{cancel:()=>{k=!0,M||w.abort()}}}(a,o);if(kr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,o,void 0,!0)}var l;return function(p,y){const w=new $e.XMLHttpRequest;w.open(p.method||"GET",p.url,!0),"arrayBuffer"===p.type&&(w.responseType="arraybuffer");for(const E in p.headers)w.setRequestHeader(E,p.headers[E]);return"json"===p.type&&(w.responseType="text",w.setRequestHeader("Accept","application/json")),w.withCredentials="include"===p.credentials,w.onerror=()=>{y(new Error(w.statusText))},w.onload=()=>{if((w.status>=200&&w.status<300||0===w.status)&&null!==w.response){let E=w.response;if("json"===p.type)try{E=JSON.parse(w.response)}catch(M){return y(M)}y(null,E,w.getResponseHeader("Cache-Control"),w.getResponseHeader("Expires"))}else y(new Xn(w.statusText,w.status,p.url))},w.send(p.body),{cancel:()=>w.abort()}}(a,o)},Jr=function(a,o){return Mr(gt(a,{type:"arrayBuffer"}),o)};function Oo(a){const o=$e.document.createElement("a");return o.href=a,o.protocol===$e.document.location.protocol&&o.host===$e.document.location.host}const uo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let _s,wi;_s=[],wi=0;const Bs=function(a,o){if(It.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),wi>=yt.MAX_PARALLEL_IMAGE_REQUESTS){const w={requestParameters:a,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return _s.push(w),w}wi++;let l=!1;const p=()=>{if(!l)for(l=!0,wi--;_s.length&&wi<yt.MAX_PARALLEL_IMAGE_REQUESTS;){const w=_s.shift(),{requestParameters:E,callback:M,cancelled:k}=w;k||(w.cancel=Bs(E,M).cancel)}},y=Jr(a,(w,E,M,k)=>{p(),w?o(w):E&&($e.createImageBitmap?function(F,U){const W=new $e.Blob([new Uint8Array(F)],{type:"image/png"});$e.createImageBitmap(W).then(V=>{U(null,V)}).catch(V=>{U(new Error(`Could not load image because of ${V.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(E,(F,U)=>o(F,U,M,k)):function(F,U){const W=new $e.Image,V=$e.URL;W.onload=()=>{U(null,W),V.revokeObjectURL(W.src),W.onload=null,$e.requestAnimationFrame(()=>{W.src=uo})},W.onerror=()=>U(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Q=new $e.Blob([new Uint8Array(F)],{type:"image/png"});W.src=F.byteLength?V.createObjectURL(Q):uo}(E,(F,U)=>o(F,U,M,k)))});return{cancel:()=>{y.cancel(),p()}}},Ei="NO_ACCESS_TOKEN";function ho(a){return 0===a.indexOf("mapbox:")}function qr(a){return yt.API_URL_REGEX.test(a)}function cn(a){return yt.API_CDN_URL_REGEX.test(a)}function Bt(a){return yt.API_STYLE_REGEX.test(a)&&!Sn(a)}function Sn(a){return yt.API_SPRITE_REGEX.test(a)}const Zn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ti(a){const o=a.match(Zn);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function Oi(a){const o=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${o}`}function eo(a){if(!a)return null;const o=a.split(".");if(!o||3!==o.length)return null;try{return JSON.parse(decodeURIComponent($e.atob(o[1]).split("").map(l=>"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class ze{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const l=eo(yt.ACCESS_TOKEN);let p="";return p=l&&l.u?$e.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,(y,w)=>String.fromCharCode(Number("0x"+w)))):yt.ACCESS_TOKEN||"",o?`mapbox.eventData.${o}:${p}`:`mapbox.eventData:${p}`}fetchEventData(){const o=Ss("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid");if(o)try{const y=$e.localStorage.getItem(l);y&&(this.eventData=JSON.parse(y));const w=$e.localStorage.getItem(p);w&&(this.anonId=w)}catch{Ai("Unable to read from LocalStorage")}}saveEventData(){const o=Ss("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid");if(o)try{$e.localStorage.setItem(p,this.anonId),Object.keys(this.eventData).length>=1&&$e.localStorage.setItem(l,JSON.stringify(this.eventData))}catch{Ai("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,l,p,y){if(!yt.EVENTS_URL)return;const w=ti(yt.EVENTS_URL);w.params.push(`access_token=${y||yt.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(o).toISOString()},M=l?gt(E,l):E,k={url:Oi(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([M])};var U;this.pendingRequest=(U=F=>{this.pendingRequest=null,p(F),this.saveEventData(),this.processRequests(y)},Mr(gt(k,{method:"POST"}),U))}queueRequest(o,l){this.queue.push(o),this.processRequests(l)}}const ne=new class extends ze{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,o){yt.EVENTS_URL&&yt.ACCESS_TOKEN&&Array.isArray(a)&&a.some(l=>ho(l)||qr(l))&&this.queueRequest(Date.now(),o)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=eo(yt.ACCESS_TOKEN),l=o?o.u:yt.ACCESS_TOKEN;let p=l!==this.eventData.tokenU;wn(this.anonId)||(this.anonId=rn(),p=!0);const y=this.queue.shift();if(this.eventData.lastSuccess){const w=new Date(this.eventData.lastSuccess),E=new Date(y),M=(y-this.eventData.lastSuccess)/864e5;p=p||M>=1||M<-1||w.getDate()!==E.getDate()}else p=!0;p?this.postEvent(y,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ft,skuId:bn,"enabled.telemetry":!1,userId:this.anonId},w=>{w||(this.eventData.lastSuccess=y,this.eventData.tokenU=l)},a):this.processRequests()}},$=ne.postTurnstileEvent.bind(ne),H=new class extends ze{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,o,l,p){this.skuToken=o,this.errorCb=p,yt.EVENTS_URL&&(l||yt.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},l):this.errorCb(new Error(Ei)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:o,timestamp:l}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),wn(this.anonId)||(this.anonId=rn()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ft,skuId:bn,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):o&&(this.success[o]=!0)},a))}},Y=H.postMapLoadEvent.bind(H),ae=new class extends ze{constructor(){super("gljs.performance")}postPerformanceEvent(a,o){yt.EVENTS_URL&&(a||yt.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},a)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:o,performanceData:l}=this.queue.shift(),p=function(y){const w=$e.performance.getEntriesByType("resource"),E=$e.performance.getEntriesByType("mark"),M=function(V){const Q={};if(V)for(const ie in V)if("other"!==ie)for(const se of V[ie]){const te=`${ie}ResolveRangeMin`,we=`${ie}ResolveRangeMax`,Oe=`${ie}RequestCount`,me=`${ie}RequestCachedCount`;Q[te]=Math.min(Q[te]||1/0,se.startTime),Q[we]=Math.max(Q[we]||-1/0,se.responseEnd);const Ae=Ee=>{void 0===Q[Ee]&&(Q[Ee]=0),++Q[Ee]};void 0!==se.transferSize&&0===se.transferSize&&Ae(me),Ae(Oe)}return Q}(function(V,Q){const ie={};if(V)for(const se of V){const te=Q(se);void 0===ie[te]&&(ie[te]=[]),ie[te].push(se)}return ie}(w,$t)),k=$e.devicePixelRatio,F=$e.navigator.connection||$e.navigator.mozConnection||$e.navigator.webkitConnection,U={counters:[],metadata:[],attributes:[]},W=(V,Q,ie)=>{null!=ie&&V.push({name:Q,value:ie.toString()})};for(const V in M)W(U.counters,V,M[V]);if(y.interactionRange[0]!==1/0&&y.interactionRange[1]!==-1/0&&(W(U.counters,"interactionRangeMin",y.interactionRange[0]),W(U.counters,"interactionRangeMax",y.interactionRange[1])),E)for(const V of Object.keys(He)){const Q=He[V],ie=E.find(se=>se.name===Q);ie&&W(U.counters,Q,ie.startTime)}return W(U.counters,"visibilityHidden",y.visibilityHidden),W(U.attributes,"style",function(V){if(V)for(const Q of V){const ie=Q.name.split("?")[0];if(Bt(ie)){const se=ie.split("/").slice(-2);if(2===se.length)return`mapbox://styles/${se[0]}/${se[1]}`}}}(w)),W(U.attributes,"terrainEnabled",y.terrainEnabled?"true":"false"),W(U.attributes,"fogEnabled",y.fogEnabled?"true":"false"),W(U.attributes,"projection",y.projection),W(U.attributes,"zoom",y.zoom),W(U.metadata,"devicePixelRatio",k),W(U.metadata,"connectionEffectiveType",F?F.effectiveType:void 0),W(U.metadata,"navigatorUserAgent",$e.navigator.userAgent),W(U.metadata,"screenWidth",$e.screen.width),W(U.metadata,"screenHeight",$e.screen.height),W(U.metadata,"windowWidth",$e.innerWidth),W(U.metadata,"windowHeight",$e.innerHeight),W(U.metadata,"mapWidth",y.width/k),W(U.metadata,"mapHeight",y.height/k),W(U.metadata,"webglRenderer",y.renderer),W(U.metadata,"webglVendor",y.vendor),W(U.metadata,"sdkVersion",ft),W(U.metadata,"sdkIdentifier","mapbox-gl-js"),U}(l);for(const y of p.metadata);for(const y of p.counters);for(const y of p.attributes);this.postEvent(o,p,()=>{},a)}},pe=ae.postPerformanceEvent.bind(ae),ke=new class extends ze{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,o,l,p){if(!yt.API_URL||!yt.SESSION_PATH)return;const y=ti(yt.API_URL+yt.SESSION_PATH);y.params.push(`sku=${o||""}`),y.params.push(`access_token=${p||yt.ACCESS_TOKEN||""}`);const w={url:Oi(y),headers:{"Content-Type":"text/plain"}};var M;this.pendingRequest=(M=E=>{this.pendingRequest=null,l(E),this.saveEventData(),this.processRequests(p)},Mr(gt(w,{method:"GET"}),M))}getSessionAPI(a,o,l,p){this.skuToken=o,this.errorCb=p,yt.SESSION_PATH&&yt.API_URL&&(l||yt.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},l):this.errorCb(new Error(Ei)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:o,timestamp:l}=this.queue.shift();o&&this.success[o]||this.getSession(l,this.skuToken,p=>{p?this.errorCb(p):o&&(this.success[o]=!0)},a)}},Be=ke.getSessionAPI.bind(ke),Pe=new Set,He={create:"create",load:"load",fullLoad:"fullLoad"},rt={mark(a){$e.performance.mark(a)},measure(a,o,l){$e.performance.measure(a,o,l)}};function $t(a){const o=a.name.split("?")[0];return cn(o)&&o.includes("mapbox-gl.js")?"javascript":cn(o)&&o.includes("mapbox-gl.css")?"css":yt.API_FONTS_REGEX.test(o)?"fontRange":Sn(o)?"sprite":Bt(o)?"style":yt.API_TILEJSON_REGEX.test(o)?"tilejson":"other"}const _t=$e.performance;function En(a){const o=a?a.url.toString():void 0;return _t.getEntriesByName(o)}let Nn,Ln,ii,Ci;const mi={now:()=>void 0!==ii?ii:$e.performance.now(),setNow(a){ii=a},restoreNow(){ii=void 0},frame(a){const o=$e.requestAnimationFrame(a);return{cancel:()=>$e.cancelAnimationFrame(o)}},getImageData(a,o=0){const{width:l,height:p}=a;Ci||(Ci=$e.document.createElement("canvas"));const y=Ci.getContext("2d",{willReadFrequently:!0});if(!y)throw new Error("failed to create canvas 2d context");return(l>Ci.width||p>Ci.height)&&(Ci.width=l,Ci.height=p),y.clearRect(-o,-o,l+2*o,p+2*o),y.drawImage(a,0,0,l,p),y.getImageData(-o,-o,l+2*o,p+2*o)},resolveURL:a=>(Nn||(Nn=$e.document.createElement("a")),Nn.href=a,Nn.href),get devicePixelRatio(){return $e.devicePixelRatio},get prefersReducedMotion(){return!!$e.matchMedia&&(null==Ln&&(Ln=$e.matchMedia("(prefers-reduced-motion: reduce)")),Ln.matches)}};function $n(a,o,l){l[a]&&-1!==l[a].indexOf(o)||(l[a]=l[a]||[],l[a].push(o))}function hr(a,o,l){if(l&&l[a]){const p=l[a].indexOf(o);-1!==p&&l[a].splice(p,1)}}class fr{constructor(o,l={}){gt(this,l),this.type=o}}class Zi extends fr{constructor(o,l={}){super("error",gt({error:o},l))}}class Rr{on(o,l){return this._listeners=this._listeners||{},$n(o,l,this._listeners),this}off(o,l){return hr(o,l,this._listeners),hr(o,l,this._oneTimeListeners),this}once(o,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},$n(o,l,this._oneTimeListeners),this):new Promise(p=>this.once(o,p))}fire(o,l){"string"==typeof o&&(o=new fr(o,l||{}));const p=o.type;if(this.listens(p)){o.target=this;const y=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const M of y)M.call(this,o);const w=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const M of w)hr(p,M,this._oneTimeListeners),M.call(this,o);const E=this._eventedParent;E&&(gt(o,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),E.fire(o))}else o instanceof Zi&&console.error(o.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,l){return this._eventedParent=o,this._eventedParentData=l,this}}var dt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ko(a,...o){for(const l of o)for(const p in l)a[p]=l[p];return a}function ur(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function qa(a){if(Array.isArray(a))return a.map(qa);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const o={};for(const l in a)o[l]=qa(a[l]);return o}return ur(a)}class rh extends Error{constructor(o,l){super(l),this.message=l,this.key=o}}var ls=rh;class Ms{constructor(o,l=[]){this.parent=o,this.bindings={};for(const[p,y]of l)this.bindings[p]=y}concat(o){return new Ms(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}var Mn=Ms;const Ti={kind:"null"},Ft={kind:"number"},oi={kind:"string"},gi={kind:"boolean"},Qi={kind:"color"},Ds={kind:"object"},Gn={kind:"value"},Ro={kind:"collator"},_l={kind:"formatted"},bi={kind:"resolvedImage"};function jo(a,o){return{kind:"array",itemType:a,N:o}}function Ui(a){if("array"===a.kind){const o=Ui(a.itemType);return"number"==typeof a.N?`array<${o}, ${a.N}>`:"value"===a.itemType.kind?"array":`array<${o}>`}return a.kind}const cd=[Ti,Ft,oi,gi,Qi,_l,Ds,jo(Gn),bi];function fo(a,o){if("error"===o.kind)return null;if("array"===a.kind){if("array"===o.kind&&(0===o.N&&"value"===o.itemType.kind||!fo(a.itemType,o.itemType))&&("number"!=typeof a.N||a.N===o.N))return null}else{if(a.kind===o.kind)return null;if("value"===a.kind)for(const l of cd)if(!fo(l,o))return null}return`Expected ${Ui(a)} but found ${Ui(o)} instead.`}function cs(a,o){return o.some(l=>l.kind===a.kind)}function Vs(a,o){return o.some(l=>"null"===l?null===a:"array"===l?Array.isArray(a):"object"===l?a&&!Array.isArray(a)&&"object"==typeof a:l===typeof a)}var sa,Co={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function aa(a){return(a=Math.round(a))<0?0:a>255?255:a}function Ac(a){return aa("%"===a[a.length-1]?parseFloat(a)/100*255:parseInt(a))}function yi(a){return(o="%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))<0?0:o>1?1:o;var o}function Mp(a,o,l){return l<0?l+=1:l>1&&(l-=1),6*l<1?a+(o-a)*l*6:2*l<1?o:3*l<2?a+(o-a)*(2/3-l)*6:a}try{sa={}.parseCSSColor=function(a){var o,l=a.replace(/ /g,"").toLowerCase();if(l in Co)return Co[l].slice();if("#"===l[0])return 4===l.length?(o=parseInt(l.substr(1),16))>=0&&o<=4095?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null:7===l.length&&(o=parseInt(l.substr(1),16))>=0&&o<=16777215?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null;var p=l.indexOf("("),y=l.indexOf(")");if(-1!==p&&y+1===l.length){var w=l.substr(0,p),E=l.substr(p+1,y-(p+1)).split(","),M=1;switch(w){case"rgba":if(4!==E.length)return null;M=yi(E.pop());case"rgb":return 3!==E.length?null:[Ac(E[0]),Ac(E[1]),Ac(E[2]),M];case"hsla":if(4!==E.length)return null;M=yi(E.pop());case"hsl":if(3!==E.length)return null;var k=(parseFloat(E[0])%360+360)%360/360,F=yi(E[1]),U=yi(E[2]),W=U<=.5?U*(F+1):U+F-U*F,V=2*U-W;return[aa(255*Mp(V,W,k+1/3)),aa(255*Mp(V,W,k)),aa(255*Mp(V,W,k-1/3)),M];default:return null}}return null}}catch{}class Ko{constructor(o,l,p,y=1){this.r=o,this.g=l,this.b=p,this.a=y}static parse(o){if(!o)return;if(o instanceof Ko)return o;if("string"!=typeof o)return;const l=sa(o);return l?new Ko(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[o,l,p,y]=this.toArray();return`rgba(${Math.round(o)},${Math.round(l)},${Math.round(p)},${y})`}toArray(){const{r:o,g:l,b:p,a:y}=this;return 0===y?[0,0,0,0]:[255*o/y,255*l/y,255*p/y,y]}toArray01(){const{r:o,g:l,b:p,a:y}=this;return 0===y?[0,0,0,0]:[o/y,l/y,p/y,y]}toArray01PremultipliedAlpha(){const{r:o,g:l,b:p,a:y}=this;return[o,l,p,y]}}Ko.black=new Ko(0,0,0,1),Ko.white=new Ko(1,1,1,1),Ko.transparent=new Ko(0,0,0,0),Ko.red=new Ko(1,0,0,1),Ko.blue=new Ko(0,0,1,1);var to=Ko;class yl{constructor(o,l,p){this.sensitivity=o?l?"variant":"case":l?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,l){return this.collator.compare(o,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Kl{constructor(o,l,p,y,w){this.text=o.normalize?o.normalize():o,this.image=l,this.scale=p,this.fontStack=y,this.textColor=w}}class Eo{constructor(o){this.sections=o}static fromString(o){return new Eo([new Kl(o,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(o=>0!==o.text.length||o.image&&0!==o.image.name.length)}static factory(o){return o instanceof Eo?o:Eo.fromString(o)}toString(){return 0===this.sections.length?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const l of this.sections){if(l.image){o.push(["image",l.image.name]);continue}o.push(l.text);const p={};l.fontStack&&(p["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(p["font-scale"]=l.scale),l.textColor&&(p["text-color"]=["rgba"].concat(l.textColor.toArray())),o.push(p)}return o}}class Er{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new Er({name:o,available:!1}):null}serialize(){return["image",this.name]}}function Xm(a,o,l,p){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof o&&o>=0&&o<=255&&"number"==typeof l&&l>=0&&l<=255?void 0===p||"number"==typeof p&&p>=0&&p<=1?null:`Invalid rgba value [${[a,o,l,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof p?[a,o,l,p]:[a,o,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Xo(a){if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||a instanceof to||a instanceof yl||a instanceof Eo||a instanceof Er)return!0;if(Array.isArray(a)){for(const o of a)if(!Xo(o))return!1;return!0}if("object"==typeof a){for(const o in a)if(!Xo(a[o]))return!1;return!0}return!1}function Ji(a){if(null===a)return Ti;if("string"==typeof a)return oi;if("boolean"==typeof a)return gi;if("number"==typeof a)return Ft;if(a instanceof to)return Qi;if(a instanceof yl)return Ro;if(a instanceof Eo)return _l;if(a instanceof Er)return bi;if(Array.isArray(a)){const o=a.length;let l;for(const p of a){const y=Ji(p);if(l){if(l===y)continue;l=Gn;break}l=y}return jo(l||Gn,o)}return Ds}function Pc(a){const o=typeof a;return null===a?"":"string"===o||"number"===o||"boolean"===o?String(a):a instanceof to||a instanceof Eo||a instanceof Er?a.toString():JSON.stringify(a)}class Oc{constructor(o,l){this.type=o,this.value=l}static parse(o,l){if(2!==o.length)return l.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!Xo(o[1]))return l.error("invalid value");const p=o[1];let y=Ji(p);const w=l.expectedType;return"array"!==y.kind||0!==y.N||!w||"array"!==w.kind||"number"==typeof w.N&&0!==w.N||(y=w),new Oc(y,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof to?["rgba"].concat(this.value.toArray()):this.value instanceof Eo?this.value.serialize():this.value}}var Us=Oc,Br=class{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}};const gu={string:oi,number:Ft,boolean:gi,object:Ds};class Zs{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");let p,y=1;const w=o[0];if("array"===w){let M,k;if(o.length>2){const F=o[1];if("string"!=typeof F||!(F in gu)||"object"===F)return l.error('The item type argument of "array" must be one of string, number, boolean',1);M=gu[F],y++}else M=Gn;if(o.length>3){if(null!==o[2]&&("number"!=typeof o[2]||o[2]<0||o[2]!==Math.floor(o[2])))return l.error('The length argument to "array" must be a positive integer literal',2);k=o[2],y++}p=jo(M,k)}else p=gu[w];const E=[];for(;y<o.length;y++){const M=l.parse(o[y],y,Gn);if(!M)return null;E.push(M)}return new Zs(p,E)}evaluate(o){for(let l=0;l<this.args.length;l++){const p=this.args[l].evaluate(o);if(!fo(this.type,Ji(p)))return p;if(l===this.args.length-1)throw new Br(`Expected value to be of type ${Ui(this.type)}, but found ${Ui(Ji(p))} instead.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,l=[o.kind];if("array"===o.kind){const p=o.itemType;if("string"===p.kind||"number"===p.kind||"boolean"===p.kind){l.push(p.kind);const y=o.N;("number"==typeof y||this.args.length>1)&&l.push(y)}}return l.concat(this.args.map(p=>p.serialize()))}}var js=Zs;class vl{constructor(o){this.type=_l,this.sections=o}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const p=o[1];if(!Array.isArray(p)&&"object"==typeof p)return l.error("First argument must be an image or text section.");const y=[];let w=!1;for(let E=1;E<=o.length-1;++E){const M=o[E];if(w&&"object"==typeof M&&!Array.isArray(M)){w=!1;let k=null;if(M["font-scale"]&&(k=l.parse(M["font-scale"],1,Ft),!k))return null;let F=null;if(M["text-font"]&&(F=l.parse(M["text-font"],1,jo(oi)),!F))return null;let U=null;if(M["text-color"]&&(U=l.parse(M["text-color"],1,Qi),!U))return null;const W=y[y.length-1];W.scale=k,W.font=F,W.textColor=U}else{const k=l.parse(o[E],1,Gn);if(!k)return null;const F=k.type.kind;if("string"!==F&&"value"!==F&&"null"!==F&&"resolvedImage"!==F)return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");w=!0,y.push({content:k,scale:null,font:null,textColor:null})}}return new vl(y)}evaluate(o){return new Eo(this.sections.map(l=>{const p=l.content.evaluate(o);return Ji(p)===bi?new Kl("",p,null,null,null):new Kl(Pc(p),null,l.scale?l.scale.evaluate(o):null,l.font?l.font.evaluate(o).join(","):null,l.textColor?l.textColor.evaluate(o):null)}))}eachChild(o){for(const l of this.sections)o(l.content),l.scale&&o(l.scale),l.font&&o(l.font),l.textColor&&o(l.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const l of this.sections){o.push(l.content.serialize());const p={};l.scale&&(p["font-scale"]=l.scale.serialize()),l.font&&(p["text-font"]=l.font.serialize()),l.textColor&&(p["text-color"]=l.textColor.serialize()),o.push(p)}return o}}class _f{constructor(o){this.type=bi,this.input=o}static parse(o,l){if(2!==o.length)return l.error("Expected two arguments.");const p=l.parse(o[1],1,oi);return p?new _f(p):l.error("No image name provided.")}evaluate(o){const l=this.input.evaluate(o),p=Er.fromString(l);return p&&o.availableImages&&(p.available=o.availableImages.indexOf(l)>-1),p}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Qm={"to-boolean":gi,"to-color":Qi,"to-number":Ft,"to-string":oi};class Dp{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const p=o[0];if(("to-boolean"===p||"to-string"===p)&&2!==o.length)return l.error("Expected one argument.");const y=Qm[p],w=[];for(let E=1;E<o.length;E++){const M=l.parse(o[E],E,Gn);if(!M)return null;w.push(M)}return new Dp(y,w)}evaluate(o){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(o));if("color"===this.type.kind){let l,p;for(const y of this.args){if(l=y.evaluate(o),p=null,l instanceof to)return l;if("string"==typeof l){const w=o.parseColor(l);if(w)return w}else if(Array.isArray(l)&&(p=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Xm(l[0],l[1],l[2],l[3]),!p))return new to(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Br(p||`Could not parse color from value '${"string"==typeof l?l:String(JSON.stringify(l))}'`)}if("number"===this.type.kind){let l=null;for(const p of this.args){if(l=p.evaluate(o),null===l)return 0;const y=Number(l);if(!isNaN(y))return y}throw new Br(`Could not convert ${JSON.stringify(l)} to number.`)}return"formatted"===this.type.kind?Eo.fromString(Pc(this.args[0].evaluate(o))):"resolvedImage"===this.type.kind?Er.fromString(Pc(this.args[0].evaluate(o))):Pc(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if("formatted"===this.type.kind)return new vl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new _f(this.args[0]).serialize();const o=[`to-${this.type.kind}`];return this.eachChild(l=>{o.push(l.serialize())}),o}}var ud=Dp;const _u=["Unknown","Point","LineString","Polygon"];var yu=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?_u[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:l,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(l*o-a[0])+this.featureDistanceData.bearing[1]*(p*o-a[1])}return 0}parseColor(a){let o=this._parseColorCache[a];return o||(o=this._parseColorCache[a]=to.parse(a)),o}};class Za{constructor(o,l,p,y){this.name=o,this.type=l,this._evaluate=p,this.args=y}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,l){const p=o[0],y=Za.definitions[p];if(!y)return l.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const w=Array.isArray(y)?y[0]:y.type,E=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,M=E.filter(([F])=>!Array.isArray(F)||F.length===o.length-1);let k=null;for(const[F,U]of M){k=new xl(l.registry,l.path,null,l.scope);const W=[];let V=!1;for(let Q=1;Q<o.length;Q++){const ie=o[Q],se=Array.isArray(F)?F[Q-1]:F.type,te=k.parse(ie,1+W.length,se);if(!te){V=!0;break}W.push(te)}if(!V)if(Array.isArray(F)&&F.length!==W.length)k.error(`Expected ${F.length} arguments, but found ${W.length} instead.`);else{for(let Q=0;Q<W.length;Q++){const ie=Array.isArray(F)?F[Q]:F.type,se=W[Q];k.concat(Q+1).checkSubtype(ie,se.type)}if(0===k.errors.length)return new Za(p,w,U,W)}}if(1===M.length)l.errors.push(...k.errors);else{const F=(M.length?M:E).map(([W])=>{return V=W,Array.isArray(V)?`(${V.map(Ui).join(", ")})`:`(${Ui(V.type)}...)`;var V}).join(" | "),U=[];for(let W=1;W<o.length;W++){const V=l.parse(o[W],1+U.length);if(!V)return null;U.push(Ui(V.type))}l.error(`Expected arguments of type ${F}, but found (${U.join(", ")}) instead.`)}return null}static register(o,l){Za.definitions=l;for(const p in l)o[p]=Za}}var vu=Za;class yf{constructor(o,l,p){this.type=Ro,this.locale=p,this.caseSensitive=o,this.diacriticSensitive=l}static parse(o,l){if(2!==o.length)return l.error("Expected one argument.");const p=o[1];if("object"!=typeof p||Array.isArray(p))return l.error("Collator options argument must be an object.");const y=l.parse(void 0!==p["case-sensitive"]&&p["case-sensitive"],1,gi);if(!y)return null;const w=l.parse(void 0!==p["diacritic-sensitive"]&&p["diacritic-sensitive"],1,gi);if(!w)return null;let E=null;return p.locale&&(E=l.parse(p.locale,1,oi),!E)?null:new yf(y,w,E)}evaluate(o){return new yl(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}const ys=8192;function no(a,o){a[0]=Math.min(a[0],o[0]),a[1]=Math.min(a[1],o[1]),a[2]=Math.max(a[2],o[0]),a[3]=Math.max(a[3],o[1])}function dd(a,o){return!(a[0]<=o[0]||a[2]>=o[2]||a[1]<=o[1]||a[3]>=o[3])}function vf(a,o){const l=(180+a[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,y=Math.pow(2,o.z);return[Math.round(l*y*ys),Math.round(p*y*ys)]}function hd(a,o,l){const p=a[0]-o[0],y=a[1]-o[1],w=a[0]-l[0],E=a[1]-l[1];return p*E-w*y==0&&p*w<=0&&y*E<=0}function bu(a,o){let l=!1;for(let E=0,M=o.length;E<M;E++){const k=o[E];for(let F=0,U=k.length;F<U-1;F++){if(hd(a,k[F],k[F+1]))return!1;(y=k[F])[1]>(p=a)[1]!=(w=k[F+1])[1]>p[1]&&p[0]<(w[0]-y[0])*(p[1]-y[1])/(w[1]-y[1])+y[0]&&(l=!l)}}var p,y,w;return l}function bf(a,o){for(let l=0;l<o.length;l++)if(bu(a,o[l]))return!0;return!1}function Ap(a,o,l,p){const y=p[0]-l[0],w=p[1]-l[1],E=(a[0]-l[0])*w-y*(a[1]-l[1]),M=(o[0]-l[0])*w-y*(o[1]-l[1]);return E>0&&M<0||E<0&&M>0}function Xl(a,o,l){for(const F of l)for(let U=0;U<F.length-1;++U)if((M=[(E=F[U+1])[0]-(w=F[U])[0],E[1]-w[1]])[0]*(k=[(y=o)[0]-(p=a)[0],y[1]-p[1]])[1]-M[1]*k[0]!=0&&Ap(p,y,w,E)&&Ap(w,E,p,y))return!0;var p,y,w,E,M,k;return!1}function kc(a,o){for(let l=0;l<a.length;++l)if(!bu(a[l],o))return!1;for(let l=0;l<a.length-1;++l)if(Xl(a[l],a[l+1],o))return!1;return!0}function xu(a,o){for(let l=0;l<o.length;l++)if(kc(a,o[l]))return!0;return!1}function Rc(a,o,l){const p=[];for(let y=0;y<a.length;y++){const w=[];for(let E=0;E<a[y].length;E++){const M=vf(a[y][E],l);no(o,M),w.push(M)}p.push(w)}return p}function Ql(a,o,l){const p=[];for(let y=0;y<a.length;y++){const w=Rc(a[y],o,l);p.push(w)}return p}function fd(a,o,l,p){if(a[0]<l[0]||a[0]>l[2]){const y=.5*p;let w=a[0]-l[0]>y?-p:l[0]-a[0]>y?p:0;0===w&&(w=a[0]-l[2]>y?-p:l[2]-a[0]>y?p:0),a[0]+=w}no(o,a)}function Jl(a,o,l,p){const y=Math.pow(2,p.z)*ys,w=[p.x*ys,p.y*ys],E=[];if(!a)return E;for(const M of a)for(const k of M){const F=[k.x+w[0],k.y+w[1]];fd(F,o,l,y),E.push(F)}return E}function Wi(a,o,l,p){const y=Math.pow(2,p.z)*ys,w=[p.x*ys,p.y*ys],E=[];if(!a)return E;for(const k of a){const F=[];for(const U of k){const W=[U.x+w[0],U.y+w[1]];no(o,W),F.push(W)}E.push(F)}if(o[2]-o[0]<=y/2){(M=o)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const k of E)for(const F of k)fd(F,o,l,y)}var M;return E}class pd{constructor(o,l){this.type=gi,this.geojson=o,this.geometries=l}static parse(o,l){if(2!==o.length)return l.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(Xo(o[1])){const p=o[1];if("FeatureCollection"===p.type)for(let y=0;y<p.features.length;++y){const w=p.features[y].geometry.type;if("Polygon"===w||"MultiPolygon"===w)return new pd(p,p.features[y].geometry)}else if("Feature"===p.type){const y=p.geometry.type;if("Polygon"===y||"MultiPolygon"===y)return new pd(p,p.geometry)}else if("Polygon"===p.type||"MultiPolygon"===p.type)return new pd(p,p)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(null!=o.geometry()&&null!=o.canonicalID()){if("Point"===o.geometryType())return function(l,p){const y=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],E=l.canonicalID();if(!E)return!1;if("Polygon"===p.type){const M=Rc(p.coordinates,w,E),k=Jl(l.geometry(),y,w,E);if(!dd(y,w))return!1;for(const F of k)if(!bu(F,M))return!1}if("MultiPolygon"===p.type){const M=Ql(p.coordinates,w,E),k=Jl(l.geometry(),y,w,E);if(!dd(y,w))return!1;for(const F of k)if(!bf(F,M))return!1}return!0}(o,this.geometries);if("LineString"===o.geometryType())return function(l,p){const y=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],E=l.canonicalID();if(!E)return!1;if("Polygon"===p.type){const M=Rc(p.coordinates,w,E),k=Wi(l.geometry(),y,w,E);if(!dd(y,w))return!1;for(const F of k)if(!kc(F,M))return!1}if("MultiPolygon"===p.type){const M=Ql(p.coordinates,w,E),k=Wi(l.geometry(),y,w,E);if(!dd(y,w))return!1;for(const F of k)if(!xu(F,M))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var bl=pd;function Fc(a){if(a instanceof vu&&("get"===a.name&&1===a.args.length||"feature-state"===a.name||"has"===a.name&&1===a.args.length||"properties"===a.name||"geometry-type"===a.name||"id"===a.name||/^filter-/.test(a.name))||a instanceof bl)return!1;let o=!0;return a.eachChild(l=>{o&&!Fc(l)&&(o=!1)}),o}function Qo(a){if(a instanceof vu&&"feature-state"===a.name)return!1;let o=!0;return a.eachChild(l=>{o&&!Qo(l)&&(o=!1)}),o}function wu(a,o){if(a instanceof vu&&o.indexOf(a.name)>=0)return!1;let l=!0;return a.eachChild(p=>{l&&!wu(p,o)&&(l=!1)}),l}class Lc{constructor(o,l){this.type=l.type,this.name=o,this.boundExpression=l}static parse(o,l){if(2!==o.length||"string"!=typeof o[1])return l.error("'var' expression requires exactly one string literal argument.");const p=o[1];return l.scope.has(p)?new Lc(p,l.scope.get(p)):l.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var io=Lc;class Cu{constructor(o,l=[],p,y=new Mn,w=[]){this.registry=o,this.path=l,this.key=l.map(E=>`[${E}]`).join(""),this.scope=y,this.errors=w,this.expectedType=p}parse(o,l,p,y,w={}){return l?this.concat(l,p,y)._parse(o,w):this._parse(o,w)}_parse(o,l){function p(y,w,E){return"assert"===E?new js(w,[y]):"coerce"===E?new ud(w,[y]):y}if(null!==o&&"string"!=typeof o&&"boolean"!=typeof o&&"number"!=typeof o||(o=["literal",o]),Array.isArray(o)){if(0===o.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const y=o[0];if("string"!=typeof y)return this.error(`Expression name must be a string, but found ${typeof y} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const w=this.registry[y];if(w){let E=w.parse(o,this);if(!E)return null;if(this.expectedType){const M=this.expectedType,k=E.type;if("string"!==M.kind&&"number"!==M.kind&&"boolean"!==M.kind&&"object"!==M.kind&&"array"!==M.kind||"value"!==k.kind)if("color"!==M.kind&&"formatted"!==M.kind&&"resolvedImage"!==M.kind||"value"!==k.kind&&"string"!==k.kind){if(this.checkSubtype(M,k))return null}else E=p(E,M,l.typeAnnotation||"coerce");else E=p(E,M,l.typeAnnotation||"assert")}if(!(E instanceof Us)&&"resolvedImage"!==E.type.kind&&po(E)){const M=new yu;try{E=new Us(E.type,E.evaluate(M))}catch(k){return this.error(k.message),null}}return E}return this.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===o?"'undefined' value invalid. Use null instead.":"object"==typeof o?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,l,p){const y="number"==typeof o?this.path.concat(o):this.path,w=p?this.scope.concat(p):this.scope;return new Cu(this.registry,y,l||null,w,this.errors)}error(o,...l){const p=`${this.key}${l.map(y=>`[${y}]`).join("")}`;this.errors.push(new ls(p,o))}checkSubtype(o,l){const p=fo(o,l);return p&&this.error(p),p}}var xl=Cu;function po(a){if(a instanceof io)return po(a.boundExpression);if(a instanceof vu&&"error"===a.name||a instanceof yf||a instanceof bl)return!1;const o=a instanceof ud||a instanceof js;let l=!0;return a.eachChild(p=>{l=o?l&&po(p):l&&p instanceof Us}),!!l&&Fc(a)&&wu(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Nc(a,o){const l=a.length-1;let p,y,w=0,E=l,M=0;for(;w<=E;)if(M=Math.floor((w+E)/2),p=a[M],y=a[M+1],p<=o){if(M===l||o<y)return M;w=M+1}else{if(!(p>o))throw new Br("Input is not a number.");E=M-1}return 0}class Eu{constructor(o,l,p){this.type=o,this.input=l,this.labels=[],this.outputs=[];for(const[y,w]of p)this.labels.push(y),this.outputs.push(w)}static parse(o,l){if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return l.error("Expected an even number of arguments.");const p=l.parse(o[1],1,Ft);if(!p)return null;const y=[];let w=null;l.expectedType&&"value"!==l.expectedType.kind&&(w=l.expectedType);for(let E=1;E<o.length;E+=2){const M=1===E?-1/0:o[E],k=o[E+1],F=E,U=E+1;if("number"!=typeof M)return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(y.length&&y[y.length-1][0]>=M)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);const W=l.parse(k,U,w);if(!W)return null;w=w||W.type,y.push([M,W])}return new Eu(w,p,y)}evaluate(o){const l=this.labels,p=this.outputs;if(1===l.length)return p[0].evaluate(o);const y=this.input.evaluate(o);if(y<=l[0])return p[0].evaluate(o);const w=l.length;return y>=l[w-1]?p[w-1].evaluate(o):p[Nc(l,y)].evaluate(o)}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&o.push(this.labels[l]),o.push(this.outputs[l].serialize());return o}}var la=Eu;function di(a,o,l){return a*(1-l)+o*l}var zc=Object.freeze({__proto__:null,number:di,color:function(a,o,l){return new to(di(a.r,o.r,l),di(a.g,o.g,l),di(a.b,o.b,l),di(a.a,o.a,l))},array:function(a,o,l){return a.map((p,y)=>di(p,o[y],l))}});const ec=.95047,Jm=1.08883,ca=4/29,oh=6/29,Bc=3*oh*oh,Ii=Math.PI/180,xf=180/Math.PI;function sh(a){return a>.008856451679035631?Math.pow(a,1/3):a/Bc+ca}function md(a){return a>oh?a*a*a:Bc*(a-ca)}function ah(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Tu(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Pp(a){const o=Tu(a.r),l=Tu(a.g),p=Tu(a.b),y=sh((.4124564*o+.3575761*l+.1804375*p)/ec),w=sh((.2126729*o+.7151522*l+.072175*p)/1);return{l:116*w-16,a:500*(y-w),b:200*(w-sh((.0193339*o+.119192*l+.9503041*p)/Jm)),alpha:a.a}}function lh(a){let o=(a.l+16)/116,l=isNaN(a.a)?o:o+a.a/500,p=isNaN(a.b)?o:o-a.b/200;return o=1*md(o),l=ec*md(l),p=Jm*md(p),new to(ah(3.2404542*l-1.5371385*o-.4985314*p),ah(-.969266*l+1.8760108*o+.041556*p),ah(.0556434*l-.2040259*o+1.0572252*p),a.alpha)}function To(a,o,l){const p=o-a;return a+l*(p>180||p<-180?p-360*Math.round(p/360):p)}const qt={forward:Pp,reverse:lh,interpolate:function(a,o,l){return{l:di(a.l,o.l,l),a:di(a.a,o.a,l),b:di(a.b,o.b,l),alpha:di(a.alpha,o.alpha,l)}}},ji={forward:function(a){const{l:o,a:l,b:p}=Pp(a),y=Math.atan2(p,l)*xf;return{h:y<0?y+360:y,c:Math.sqrt(l*l+p*p),l:o,alpha:a.a}},reverse:function(a){const o=a.h*Ii,l=a.c;return lh({l:a.l,a:Math.cos(o)*l,b:Math.sin(o)*l,alpha:a.alpha})},interpolate:function(a,o,l){return{h:To(a.h,o.h,l),c:di(a.c,o.c,l),l:di(a.l,o.l,l),alpha:di(a.alpha,o.alpha,l)}}};var Op=Object.freeze({__proto__:null,lab:qt,hcl:ji});class gd{constructor(o,l,p,y,w){this.type=o,this.operator=l,this.interpolation=p,this.input=y,this.labels=[],this.outputs=[];for(const[E,M]of w)this.labels.push(E),this.outputs.push(M)}static interpolationFactor(o,l,p,y){let w=0;if("exponential"===o.name)w=Fo(l,o.base,p,y);else if("linear"===o.name)w=Fo(l,1,p,y);else if("cubic-bezier"===o.name){const E=o.controlPoints;w=new An(E[0],E[1],E[2],E[3]).solve(Fo(l,1,p,y))}return w}static parse(o,l){let[p,y,w,...E]=o;if(!Array.isArray(y)||0===y.length)return l.error("Expected an interpolation type expression.",1);if("linear"===y[0])y={name:"linear"};else if("exponential"===y[0]){const F=y[1];if("number"!=typeof F)return l.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:F}}else{if("cubic-bezier"!==y[0])return l.error(`Unknown interpolation type ${String(y[0])}`,1,0);{const F=y.slice(1);if(4!==F.length||F.some(U=>"number"!=typeof U||U<0||U>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:F}}}if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(w=l.parse(w,2,Ft),!w)return null;const M=[];let k=null;"interpolate-hcl"===p||"interpolate-lab"===p?k=Qi:l.expectedType&&"value"!==l.expectedType.kind&&(k=l.expectedType);for(let F=0;F<E.length;F+=2){const U=E[F],W=E[F+1],V=F+3,Q=F+4;if("number"!=typeof U)return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(M.length&&M[M.length-1][0]>=U)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const ie=l.parse(W,Q,k);if(!ie)return null;k=k||ie.type,M.push([U,ie])}return"number"===k.kind||"color"===k.kind||"array"===k.kind&&"number"===k.itemType.kind&&"number"==typeof k.N?new gd(k,p,y,w,M):l.error(`Type ${Ui(k)} is not interpolatable.`)}evaluate(o){const l=this.labels,p=this.outputs;if(1===l.length)return p[0].evaluate(o);const y=this.input.evaluate(o);if(y<=l[0])return p[0].evaluate(o);const w=l.length;if(y>=l[w-1])return p[w-1].evaluate(o);const E=Nc(l,y),M=gd.interpolationFactor(this.interpolation,y,l[E],l[E+1]),k=p[E].evaluate(o),F=p[E+1].evaluate(o);return"interpolate"===this.operator?zc[this.type.kind.toLowerCase()](k,F,M):"interpolate-hcl"===this.operator?ji.reverse(ji.interpolate(ji.forward(k),ji.forward(F),M)):qt.reverse(qt.interpolate(qt.forward(k),qt.forward(F),M))}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,o,this.input.serialize()];for(let p=0;p<this.labels.length;p++)l.push(this.labels[p],this.outputs[p].serialize());return l}}function Fo(a,o,l,p){const y=p-l,w=a-l;return 0===y?0:1===o?w/y:(Math.pow(o,w)-1)/(Math.pow(o,y)-1)}var Wa=gd;class wl{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expectected at least one argument.");let p=null;const y=l.expectedType;y&&"value"!==y.kind&&(p=y);const w=[];for(const M of o.slice(1)){const k=l.parse(M,1+w.length,p,void 0,{typeAnnotation:"omit"});if(!k)return null;p=p||k.type,w.push(k)}const E=y&&w.some(M=>fo(y,M.type));return new wl(E?Gn:p,w)}evaluate(o){let l,p=null,y=0;for(const w of this.args){if(y++,p=w.evaluate(o),p&&p instanceof Er&&!p.available&&(l||(l=p),p=null,y===this.args.length))return l;if(null!==p)break}return p}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(l=>{o.push(l.serialize())}),o}}var Ya=wl;class Vc{constructor(o,l){this.type=l.type,this.bindings=[].concat(o),this.result=l}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const l of this.bindings)o(l[1]);o(this.result)}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const p=[];for(let w=1;w<o.length-1;w+=2){const E=o[w];if("string"!=typeof E)return l.error(`Expected string, but found ${typeof E} instead.`,w);if(/[^a-zA-Z0-9_]/.test(E))return l.error("Variable names must contain only alphanumeric characters or '_'.",w);const M=l.parse(o[w+1],w+1);if(!M)return null;p.push([E,M])}const y=l.parse(o[o.length-1],o.length-1,l.expectedType,p);return y?new Vc(p,y):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[l,p]of this.bindings)o.push(l,p.serialize());return o.push(this.result.serialize()),o}}var ch=Vc;class Uc{constructor(o,l,p){this.type=o,this.index=l,this.input=p}static parse(o,l){if(3!==o.length)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const p=l.parse(o[1],1,Ft),y=l.parse(o[2],2,jo(l.expectedType||Gn));return p&&y?new Uc(y.type.itemType,p,y):null}evaluate(o){const l=this.index.evaluate(o),p=this.input.evaluate(o);if(l<0)throw new Br(`Array index out of bounds: ${l} < 0.`);if(l>=p.length)throw new Br(`Array index out of bounds: ${l} > ${p.length-1}.`);if(l!==Math.floor(l))throw new Br(`Array index must be an integer, but found ${l} instead.`);return p[l]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var T_=Uc;class Iu{constructor(o,l){this.type=gi,this.needle=o,this.haystack=l}static parse(o,l){if(3!==o.length)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const p=l.parse(o[1],1,Gn),y=l.parse(o[2],2,Gn);return p&&y?cs(p.type,[gi,oi,Ft,Ti,Gn])?new Iu(p,y):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ui(p.type)} instead`):null}evaluate(o){const l=this.needle.evaluate(o),p=this.haystack.evaluate(o);if(null==p)return!1;if(!Vs(l,["boolean","string","number","null"]))throw new Br(`Expected first argument to be of type boolean, string, number or null, but found ${Ui(Ji(l))} instead.`);if(!Vs(p,["string","array"]))throw new Br(`Expected second argument to be of type array or string, but found ${Ui(Ji(p))} instead.`);return p.indexOf(l)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Jo=Iu;class $o{constructor(o,l,p){this.type=Ft,this.needle=o,this.haystack=l,this.fromIndex=p}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const p=l.parse(o[1],1,Gn),y=l.parse(o[2],2,Gn);if(!p||!y)return null;if(!cs(p.type,[gi,oi,Ft,Ti,Gn]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ui(p.type)} instead`);if(4===o.length){const w=l.parse(o[3],3,Ft);return w?new $o(p,y,w):null}return new $o(p,y)}evaluate(o){const l=this.needle.evaluate(o),p=this.haystack.evaluate(o);if(!Vs(l,["boolean","string","number","null"]))throw new Br(`Expected first argument to be of type boolean, string, number or null, but found ${Ui(Ji(l))} instead.`);if(!Vs(p,["string","array"]))throw new Br(`Expected second argument to be of type array or string, but found ${Ui(Ji(p))} instead.`);if(this.fromIndex){const y=this.fromIndex.evaluate(o);return p.indexOf(l,y)}return p.indexOf(l)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var kp=$o;class Cl{constructor(o,l,p,y,w,E){this.inputType=o,this.type=l,this.input=p,this.cases=y,this.outputs=w,this.otherwise=E}static parse(o,l){if(o.length<5)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return l.error("Expected an even number of arguments.");let p,y;l.expectedType&&"value"!==l.expectedType.kind&&(y=l.expectedType);const w={},E=[];for(let F=2;F<o.length-1;F+=2){let U=o[F];const W=o[F+1];Array.isArray(U)||(U=[U]);const V=l.concat(F);if(0===U.length)return V.error("Expected at least one branch label.");for(const ie of U){if("number"!=typeof ie&&"string"!=typeof ie)return V.error("Branch labels must be numbers or strings.");if("number"==typeof ie&&Math.abs(ie)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof ie&&Math.floor(ie)!==ie)return V.error("Numeric branch labels must be integer values.");if(p){if(V.checkSubtype(p,Ji(ie)))return null}else p=Ji(ie);if(void 0!==w[String(ie)])return V.error("Branch labels must be unique.");w[String(ie)]=E.length}const Q=l.parse(W,F,y);if(!Q)return null;y=y||Q.type,E.push(Q)}const M=l.parse(o[1],1,Gn);if(!M)return null;const k=l.parse(o[o.length-1],o.length-1,y);return k?"value"!==M.type.kind&&l.concat(1).checkSubtype(p,M.type)?null:new Cl(p,y,M,w,E,k):null}evaluate(o){const l=this.input.evaluate(o);return(Ji(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),p=[],y={};for(const E of l){const M=y[this.cases[E]];void 0===M?(y[this.cases[E]]=p.length,p.push([this.cases[E],[E]])):p[M][1].push(E)}const w=E=>"number"===this.inputType.kind?Number(E):E;for(const[E,M]of p)o.push(1===M.length?w(M[0]):M.map(w)),o.push(this.outputs[E].serialize());return o.push(this.otherwise.serialize()),o}}var Ka=Cl;class uh{constructor(o,l,p){this.type=o,this.branches=l,this.otherwise=p}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return l.error("Expected an odd number of arguments.");let p;l.expectedType&&"value"!==l.expectedType.kind&&(p=l.expectedType);const y=[];for(let E=1;E<o.length-1;E+=2){const M=l.parse(o[E],E,gi);if(!M)return null;const k=l.parse(o[E+1],E+1,p);if(!k)return null;y.push([M,k]),p=p||k.type}const w=l.parse(o[o.length-1],o.length-1,p);return w?new uh(p,y,w):null}evaluate(o){for(const[l,p]of this.branches)if(l.evaluate(o))return p.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[l,p]of this.branches)o(l),o(p);o(this.otherwise)}outputDefined(){return this.branches.every(([o,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(l=>{o.push(l.serialize())}),o}}var Rp=uh;class tc{constructor(o,l,p,y){this.type=o,this.input=l,this.beginIndex=p,this.endIndex=y}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const p=l.parse(o[1],1,Gn),y=l.parse(o[2],2,Ft);if(!p||!y)return null;if(!cs(p.type,[jo(Gn),oi,Gn]))return l.error(`Expected first argument to be of type array or string, but found ${Ui(p.type)} instead`);if(4===o.length){const w=l.parse(o[3],3,Ft);return w?new tc(p.type,p,y,w):null}return new tc(p.type,p,y)}evaluate(o){const l=this.input.evaluate(o),p=this.beginIndex.evaluate(o);if(!Vs(l,["string","array"]))throw new Br(`Expected first argument to be of type array or string, but found ${Ui(Ji(l))} instead.`);if(this.endIndex){const y=this.endIndex.evaluate(o);return l.slice(p,y)}return l.slice(p)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Fp=tc;function Ia(a,o){return"=="===a||"!="===a?"boolean"===o.kind||"string"===o.kind||"number"===o.kind||"null"===o.kind||"value"===o.kind:"string"===o.kind||"number"===o.kind||"value"===o.kind}function dh(a,o,l,p){return 0===p.compare(o,l)}function Su(a,o,l){const p="=="!==a&&"!="!==a;return class Z5{constructor(w,E,M){this.type=gi,this.lhs=w,this.rhs=E,this.collator=M,this.hasUntypedArgument="value"===w.type.kind||"value"===E.type.kind}static parse(w,E){if(3!==w.length&&4!==w.length)return E.error("Expected two or three arguments.");const M=w[0];let k=E.parse(w[1],1,Gn);if(!k)return null;if(!Ia(M,k.type))return E.concat(1).error(`"${M}" comparisons are not supported for type '${Ui(k.type)}'.`);let F=E.parse(w[2],2,Gn);if(!F)return null;if(!Ia(M,F.type))return E.concat(2).error(`"${M}" comparisons are not supported for type '${Ui(F.type)}'.`);if(k.type.kind!==F.type.kind&&"value"!==k.type.kind&&"value"!==F.type.kind)return E.error(`Cannot compare types '${Ui(k.type)}' and '${Ui(F.type)}'.`);p&&("value"===k.type.kind&&"value"!==F.type.kind?k=new js(F.type,[k]):"value"!==k.type.kind&&"value"===F.type.kind&&(F=new js(k.type,[F])));let U=null;if(4===w.length){if("string"!==k.type.kind&&"string"!==F.type.kind&&"value"!==k.type.kind&&"value"!==F.type.kind)return E.error("Cannot use collator to compare non-string types.");if(U=E.parse(w[3],3,Ro),!U)return null}return new Z5(k,F,U)}evaluate(w){const E=this.lhs.evaluate(w),M=this.rhs.evaluate(w);if(p&&this.hasUntypedArgument){const k=Ji(E),F=Ji(M);if(k.kind!==F.kind||"string"!==k.kind&&"number"!==k.kind)throw new Br(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${k.kind}, ${F.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const k=Ji(E),F=Ji(M);if("string"!==k.kind||"string"!==F.kind)return o(w,E,M)}return this.collator?l(w,E,M,this.collator.evaluate(w)):o(w,E,M)}eachChild(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)}outputDefined(){return!0}serialize(){const w=[a];return this.eachChild(E=>{w.push(E.serialize())}),w}}}const Lp=Su("==",function(a,o,l){return o===l},dh),eg=Su("!=",function(a,o,l){return o!==l},function(a,o,l,p){return!dh(0,o,l,p)}),Np=Su("<",function(a,o,l){return o<l},function(a,o,l,p){return p.compare(o,l)<0}),wf=Su(">",function(a,o,l){return o>l},function(a,o,l,p){return p.compare(o,l)>0}),zp=Su("<=",function(a,o,l){return o<=l},function(a,o,l,p){return p.compare(o,l)<=0}),tg=Su(">=",function(a,o,l){return o>=l},function(a,o,l,p){return p.compare(o,l)>=0});class Cf{constructor(o,l,p,y,w,E){this.type=oi,this.number=o,this.locale=l,this.currency=p,this.unit=y,this.minFractionDigits=w,this.maxFractionDigits=E}static parse(o,l){if(3!==o.length)return l.error("Expected two arguments.");const p=l.parse(o[1],1,Ft);if(!p)return null;const y=o[2];if("object"!=typeof y||Array.isArray(y))return l.error("NumberFormat options argument must be an object.");let w=null;if(y.locale&&(w=l.parse(y.locale,1,oi),!w))return null;let E=null;if(y.currency&&(E=l.parse(y.currency,1,oi),!E))return null;let M=null;if(y.unit&&(M=l.parse(y.unit,1,oi),!M))return null;let k=null;if(y["min-fraction-digits"]&&(k=l.parse(y["min-fraction-digits"],1,Ft),!k))return null;let F=null;return y["max-fraction-digits"]&&(F=l.parse(y["max-fraction-digits"],1,Ft),!F)?null:new Cf(p,w,E,M,k,F)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class Ef{constructor(o){this.type=Ft,this.input=o}static parse(o,l){if(2!==o.length)return l.error(`Expected 1 argument, but found ${o.length-1} instead.`);const p=l.parse(o[1],1);return p?"array"!==p.type.kind&&"string"!==p.type.kind&&"value"!==p.type.kind?l.error(`Expected argument of type string or array, but found ${Ui(p.type)} instead.`):new Ef(p):null}evaluate(o){const l=this.input.evaluate(o);if("string"==typeof l||Array.isArray(l))return l.length;throw new Br(`Expected value to be of type string or array, but found ${Ui(Ji(l))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(l=>{o.push(l.serialize())}),o}}const Tf={"==":Lp,"!=":eg,">":wf,"<":Np,">=":tg,"<=":zp,array:js,at:T_,boolean:js,case:Rp,coalesce:Ya,collator:yf,format:vl,image:_f,in:Jo,"index-of":kp,interpolate:Wa,"interpolate-hcl":Wa,"interpolate-lab":Wa,length:Ef,let:ch,literal:Us,match:Ka,number:js,"number-format":Cf,object:js,slice:Fp,step:la,string:js,"to-boolean":ud,"to-color":ud,"to-number":ud,"to-string":ud,var:io,within:bl};function I_(a,[o,l,p,y]){o=o.evaluate(a),l=l.evaluate(a),p=p.evaluate(a);const w=y?y.evaluate(a):1,E=Xm(o,l,p,w);if(E)throw new Br(E);return new to(o/255*w,l/255*w,p/255*w,w)}function ng(a,o){return a in o}function vs(a,o){const l=o[a];return void 0===l?null:l}function As(a){return{type:a}}vu.register(Tf,{error:[{kind:"error"},[oi],(a,[o])=>{throw new Br(o.evaluate(a))}],typeof:[oi,[Gn],(a,[o])=>Ui(Ji(o.evaluate(a)))],"to-rgba":[jo(Ft,4),[Qi],(a,[o])=>o.evaluate(a).toArray()],rgb:[Qi,[Ft,Ft,Ft],I_],rgba:[Qi,[Ft,Ft,Ft,Ft],I_],has:{type:gi,overloads:[[[oi],(a,[o])=>ng(o.evaluate(a),a.properties())],[[oi,Ds],(a,[o,l])=>ng(o.evaluate(a),l.evaluate(a))]]},get:{type:Gn,overloads:[[[oi],(a,[o])=>vs(o.evaluate(a),a.properties())],[[oi,Ds],(a,[o,l])=>vs(o.evaluate(a),l.evaluate(a))]]},"feature-state":[Gn,[oi],(a,[o])=>vs(o.evaluate(a),a.featureState||{})],properties:[Ds,[],a=>a.properties()],"geometry-type":[oi,[],a=>a.geometryType()],id:[Gn,[],a=>a.id()],zoom:[Ft,[],a=>a.globals.zoom],pitch:[Ft,[],a=>a.globals.pitch||0],"distance-from-center":[Ft,[],a=>a.distanceFromCenter()],"heatmap-density":[Ft,[],a=>a.globals.heatmapDensity||0],"line-progress":[Ft,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[Ft,[],a=>a.globals.skyRadialProgress||0],accumulated:[Gn,[],a=>void 0===a.globals.accumulated?null:a.globals.accumulated],"+":[Ft,As(Ft),(a,o)=>{let l=0;for(const p of o)l+=p.evaluate(a);return l}],"*":[Ft,As(Ft),(a,o)=>{let l=1;for(const p of o)l*=p.evaluate(a);return l}],"-":{type:Ft,overloads:[[[Ft,Ft],(a,[o,l])=>o.evaluate(a)-l.evaluate(a)],[[Ft],(a,[o])=>-o.evaluate(a)]]},"/":[Ft,[Ft,Ft],(a,[o,l])=>o.evaluate(a)/l.evaluate(a)],"%":[Ft,[Ft,Ft],(a,[o,l])=>o.evaluate(a)%l.evaluate(a)],ln2:[Ft,[],()=>Math.LN2],pi:[Ft,[],()=>Math.PI],e:[Ft,[],()=>Math.E],"^":[Ft,[Ft,Ft],(a,[o,l])=>Math.pow(o.evaluate(a),l.evaluate(a))],sqrt:[Ft,[Ft],(a,[o])=>Math.sqrt(o.evaluate(a))],log10:[Ft,[Ft],(a,[o])=>Math.log(o.evaluate(a))/Math.LN10],ln:[Ft,[Ft],(a,[o])=>Math.log(o.evaluate(a))],log2:[Ft,[Ft],(a,[o])=>Math.log(o.evaluate(a))/Math.LN2],sin:[Ft,[Ft],(a,[o])=>Math.sin(o.evaluate(a))],cos:[Ft,[Ft],(a,[o])=>Math.cos(o.evaluate(a))],tan:[Ft,[Ft],(a,[o])=>Math.tan(o.evaluate(a))],asin:[Ft,[Ft],(a,[o])=>Math.asin(o.evaluate(a))],acos:[Ft,[Ft],(a,[o])=>Math.acos(o.evaluate(a))],atan:[Ft,[Ft],(a,[o])=>Math.atan(o.evaluate(a))],min:[Ft,As(Ft),(a,o)=>Math.min(...o.map(l=>l.evaluate(a)))],max:[Ft,As(Ft),(a,o)=>Math.max(...o.map(l=>l.evaluate(a)))],abs:[Ft,[Ft],(a,[o])=>Math.abs(o.evaluate(a))],round:[Ft,[Ft],(a,[o])=>{const l=o.evaluate(a);return l<0?-Math.round(-l):Math.round(l)}],floor:[Ft,[Ft],(a,[o])=>Math.floor(o.evaluate(a))],ceil:[Ft,[Ft],(a,[o])=>Math.ceil(o.evaluate(a))],"filter-==":[gi,[oi,Gn],(a,[o,l])=>a.properties()[o.value]===l.value],"filter-id-==":[gi,[Gn],(a,[o])=>a.id()===o.value],"filter-type-==":[gi,[oi],(a,[o])=>a.geometryType()===o.value],"filter-<":[gi,[oi,Gn],(a,[o,l])=>{const p=a.properties()[o.value],y=l.value;return typeof p==typeof y&&p<y}],"filter-id-<":[gi,[Gn],(a,[o])=>{const l=a.id(),p=o.value;return typeof l==typeof p&&l<p}],"filter->":[gi,[oi,Gn],(a,[o,l])=>{const p=a.properties()[o.value],y=l.value;return typeof p==typeof y&&p>y}],"filter-id->":[gi,[Gn],(a,[o])=>{const l=a.id(),p=o.value;return typeof l==typeof p&&l>p}],"filter-<=":[gi,[oi,Gn],(a,[o,l])=>{const p=a.properties()[o.value],y=l.value;return typeof p==typeof y&&p<=y}],"filter-id-<=":[gi,[Gn],(a,[o])=>{const l=a.id(),p=o.value;return typeof l==typeof p&&l<=p}],"filter->=":[gi,[oi,Gn],(a,[o,l])=>{const p=a.properties()[o.value],y=l.value;return typeof p==typeof y&&p>=y}],"filter-id->=":[gi,[Gn],(a,[o])=>{const l=a.id(),p=o.value;return typeof l==typeof p&&l>=p}],"filter-has":[gi,[Gn],(a,[o])=>o.value in a.properties()],"filter-has-id":[gi,[],a=>null!==a.id()&&void 0!==a.id()],"filter-type-in":[gi,[jo(oi)],(a,[o])=>o.value.indexOf(a.geometryType())>=0],"filter-id-in":[gi,[jo(Gn)],(a,[o])=>o.value.indexOf(a.id())>=0],"filter-in-small":[gi,[oi,jo(Gn)],(a,[o,l])=>l.value.indexOf(a.properties()[o.value])>=0],"filter-in-large":[gi,[oi,jo(Gn)],(a,[o,l])=>function(p,y,w,E){for(;w<=E;){const M=w+E>>1;if(y[M]===p)return!0;y[M]>p?E=M-1:w=M+1}return!1}(a.properties()[o.value],l.value,0,l.value.length-1)],all:{type:gi,overloads:[[[gi,gi],(a,[o,l])=>o.evaluate(a)&&l.evaluate(a)],[As(gi),(a,o)=>{for(const l of o)if(!l.evaluate(a))return!1;return!0}]]},any:{type:gi,overloads:[[[gi,gi],(a,[o,l])=>o.evaluate(a)||l.evaluate(a)],[As(gi),(a,o)=>{for(const l of o)if(l.evaluate(a))return!0;return!1}]]},"!":[gi,[gi],(a,[o])=>!o.evaluate(a)],"is-supported-script":[gi,[oi],(a,[o])=>{const l=a.globals&&a.globals.isSupportedScript;return!l||l(o.evaluate(a))}],upcase:[oi,[oi],(a,[o])=>o.evaluate(a).toUpperCase()],downcase:[oi,[oi],(a,[o])=>o.evaluate(a).toLowerCase()],concat:[oi,As(Gn),(a,o)=>o.map(l=>Pc(l.evaluate(a))).join("")],"resolved-locale":[oi,[Ro],(a,[o])=>o.evaluate(a).resolvedLocale()]});var pr=Tf;function jc(a){return{result:"success",value:a}}function _d(a){return{result:"error",value:a}}function Mu(a){return"data-driven"===a["property-type"]}function nc(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Bp(a){return!!a.expression&&a.expression.interpolated}function Hi(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function Du(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function yd(a){return a}function ic(a,o){const l="color"===o.type,p=a.stops&&"object"==typeof a.stops[0][0],y=p||!(p||void 0!==a.property),w=a.type||(Bp(o)?"exponential":"interval");if(l&&((a=ko({},a)).stops&&(a.stops=a.stops.map(F=>[F[0],to.parse(F[1])])),a.default=to.parse(a.default?a.default:o.default)),a.colorSpace&&"rgb"!==a.colorSpace&&!Op[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let E,M,k;if("exponential"===w)E=ua;else if("interval"===w)E=If;else if("categorical"===w){E=Sa,M=Object.create(null);for(const F of a.stops)M[F[0]]=F[1];k=typeof a.stops[0][0]}else{if("identity"!==w)throw new Error(`Unknown function type "${w}"`);E=Au}if(p){const F={},U=[];for(let Q=0;Q<a.stops.length;Q++){const ie=a.stops[Q],se=ie[0].zoom;void 0===F[se]&&(F[se]={zoom:se,type:a.type,property:a.property,default:a.default,stops:[]},U.push(se)),F[se].stops.push([ie[0].value,ie[1]])}const W=[];for(const Q of U)W.push([F[Q].zoom,ic(F[Q],o)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:Wa.interpolationFactor.bind(void 0,V),zoomStops:W.map(Q=>Q[0]),evaluate:({zoom:Q},ie)=>ua({stops:W,base:a.base},o,Q).evaluate(Q,ie)}}if(y){const F="exponential"===w?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:Wa.interpolationFactor.bind(void 0,F),zoomStops:a.stops.map(U=>U[0]),evaluate:({zoom:U})=>E(a,o,U,M,k)}}return{kind:"source",evaluate(F,U){const W=U&&U.properties?U.properties[a.property]:void 0;return void 0===W?El(a.default,o.default):E(a,o,W,M,k)}}}function El(a,o,l){return void 0!==a?a:void 0!==o?o:void 0!==l?l:void 0}function Sa(a,o,l,p,y){return El(typeof l===y?p[l]:void 0,a.default,o.default)}function If(a,o,l){if("number"!==Hi(l))return El(a.default,o.default);const p=a.stops.length;if(1===p||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[p-1][0])return a.stops[p-1][1];const y=Nc(a.stops.map(w=>w[0]),l);return a.stops[y][1]}function ua(a,o,l){const p=void 0!==a.base?a.base:1;if("number"!==Hi(l))return El(a.default,o.default);const y=a.stops.length;if(1===y||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[y-1][0])return a.stops[y-1][1];const w=Nc(a.stops.map(U=>U[0]),l),E=function(U,W,V,Q){const ie=Q-V,se=U-V;return 0===ie?0:1===W?se/ie:(Math.pow(W,se)-1)/(Math.pow(W,ie)-1)}(l,p,a.stops[w][0],a.stops[w+1][0]),M=a.stops[w][1],k=a.stops[w+1][1];let F=zc[o.type]||yd;if(a.colorSpace&&"rgb"!==a.colorSpace){const U=Op[a.colorSpace];F=(W,V)=>U.reverse(U.interpolate(U.forward(W),U.forward(V),E))}return"function"==typeof M.evaluate?{evaluate(...U){const W=M.evaluate.apply(void 0,U),V=k.evaluate.apply(void 0,U);if(void 0!==W&&void 0!==V)return F(W,V,E)}}:F(M,k,E)}function Au(a,o,l){return"color"===o.type?l=to.parse(l):"formatted"===o.type?l=Eo.fromString(l.toString()):"resolvedImage"===o.type?l=Er.fromString(l.toString()):Hi(l)===o.type||"enum"===o.type&&o.values[l]||(l=void 0),El(l,a.default,o.default)}class vd{constructor(o,l){var p;this.expression=o,this._warningHistory={},this._evaluator=new yu,this._defaultValue=l?"color"===(p=l).type&&(Du(p.default)||Array.isArray(p.default))?new to(0,0,0,0):"color"===p.type?to.parse(p.default)||null:void 0===p.default?null:p.default:null,this._enumValues=l&&"enum"===l.type?l.values:null}evaluateWithoutErrorHandling(o,l,p,y,w,E,M,k){return this._evaluator.globals=o,this._evaluator.feature=l,this._evaluator.featureState=p,this._evaluator.canonical=y||null,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=E,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=k||null,this.expression.evaluate(this._evaluator)}evaluate(o,l,p,y,w,E,M,k){this._evaluator.globals=o,this._evaluator.feature=l||null,this._evaluator.featureState=p||null,this._evaluator.canonical=y||null,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=E||null,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=k||null;try{const F=this.expression.evaluate(this._evaluator);if(null==F||"number"==typeof F&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new Br(`Expected value to be one of ${Object.keys(this._enumValues).map(U=>JSON.stringify(U)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,typeof console<"u"&&console.warn(F.message)),this._defaultValue}}}function hh(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in pr}function Tl(a,o){const l=new xl(pr,[],o?function(y){const w={color:Qi,string:oi,number:Ft,enum:oi,boolean:gi,formatted:_l,resolvedImage:bi};return"array"===y.type?jo(w[y.value]||Gn,y.length):w[y.type]}(o):void 0),p=l.parse(a,void 0,void 0,void 0,o&&"string"===o.type?{typeAnnotation:"coerce"}:void 0);return p?jc(new vd(p,o)):_d(l.errors)}class Vp{constructor(o,l){this.kind=o,this._styleExpression=l,this.isStateDependent="constant"!==o&&!Qo(l.expression)}evaluateWithoutErrorHandling(o,l,p,y,w,E){return this._styleExpression.evaluateWithoutErrorHandling(o,l,p,y,w,E)}evaluate(o,l,p,y,w,E){return this._styleExpression.evaluate(o,l,p,y,w,E)}}class Il{constructor(o,l,p,y){this.kind=o,this.zoomStops=p,this._styleExpression=l,this.isStateDependent="camera"!==o&&!Qo(l.expression),this.interpolationType=y}evaluateWithoutErrorHandling(o,l,p,y,w,E){return this._styleExpression.evaluateWithoutErrorHandling(o,l,p,y,w,E)}evaluate(o,l,p,y,w,E){return this._styleExpression.evaluate(o,l,p,y,w,E)}interpolationFactor(o,l,p){return this.interpolationType?Wa.interpolationFactor(this.interpolationType,o,l,p):0}}function Xa(a,o){if("error"===(a=Tl(a,o)).result)return a;const l=a.value.expression,p=Fc(l);if(!p&&!Mu(o))return _d([new ls("","data expressions not supported")]);const y=wu(l,["zoom","pitch","distance-from-center"]);if(!y&&!nc(o))return _d([new ls("","zoom expressions not supported")]);const w=Sl(l);return w||y?w instanceof ls?_d([w]):w instanceof Wa&&!Bp(o)?_d([new ls("",'"interpolate" expressions cannot be used with this property')]):jc(w?new Il(p?"camera":"composite",a.value,w.labels,w instanceof Wa?w.interpolation:void 0):new Vp(p?"constant":"source",a.value)):_d([new ls("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class $c{constructor(o,l){this._parameters=o,this._specification=l,ko(this,ic(this._parameters,this._specification))}static deserialize(o){return new $c(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function Sl(a){let o=null;if(a instanceof ch)o=Sl(a.result);else if(a instanceof Ya){for(const l of a.args)if(o=Sl(l),o)break}else(a instanceof la||a instanceof Wa)&&a.input instanceof vu&&"zoom"===a.input.name&&(o=a);return o instanceof ls||a.eachChild(l=>{const p=Sl(l);p instanceof ls?o=p:!o&&p?o=new ls("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&p&&o!==p&&(o=new ls("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}class fn{constructor(o,l,p,y){this.message=(o?`${o}: `:"")+p,y&&(this.identifier=y),null!=l&&l.__line__&&(this.line=l.__line__)}}function rr(a){const o=a.key,l=a.value,p=a.valueSpec||{},y=a.objectElementValidators||{},w=a.style,E=a.styleSpec;let M=[];const k=Hi(l);if("object"!==k)return[new fn(o,l,`object expected, ${k} found`)];for(const F in l){const U=F.split(".")[0];let V;y[U]?V=y[U]:p[U]?V=Io:y["*"]?V=y["*"]:p["*"]&&(V=Io),V?M=M.concat(V({key:(o&&`${o}.`)+F,value:l[F],valueSpec:p[U]||p["*"],style:w,styleSpec:E,object:l,objectKey:F},l)):M.push(new fn(o,l[F],`unknown property "${F}"`))}for(const F in p)y[F]||p[F].required&&void 0===p[F].default&&void 0===l[F]&&M.push(new fn(o,l,`missing required property "${F}"`));return M}function bd(a){const o=a.value,l=a.valueSpec,p=a.style,y=a.styleSpec,w=a.key,E=a.arrayElementValidator||Io;if("array"!==Hi(o))return[new fn(w,o,`array expected, ${Hi(o)} found`)];if(l.length&&o.length!==l.length)return[new fn(w,o,`array length ${l.length} expected, length ${o.length} found`)];if(l["min-length"]&&o.length<l["min-length"])return[new fn(w,o,`array length at least ${l["min-length"]} expected, length ${o.length} found`)];let M={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};y.$version<7&&(M.function=l.function),"object"===Hi(l.value)&&(M=l.value);let k=[];for(let F=0;F<o.length;F++)k=k.concat(E({array:o,arrayIndex:F,value:o[F],valueSpec:M,style:p,styleSpec:y,key:`${w}[${F}]`}));return k}function Ma(a){const o=a.key,l=a.value,p=a.valueSpec;let y=Hi(l);if("number"===y&&l!=l&&(y="NaN"),"number"!==y)return[new fn(o,l,`number expected, ${y} found`)];if("minimum"in p){let w=p.minimum;if("array"===Hi(p.minimum)&&(w=p.minimum[a.arrayIndex]),l<w)return[new fn(o,l,`${l} is less than the minimum value ${w}`)]}if("maximum"in p){let w=p.maximum;if("array"===Hi(p.maximum)&&(w=p.maximum[a.arrayIndex]),l>w)return[new fn(o,l,`${l} is greater than the maximum value ${w}`)]}return[]}function Gc(a){const o=a.valueSpec,l=ur(a.value.type);let p,y,w,E={};const M="categorical"!==l&&void 0===a.value.property,k=!M,F="array"===Hi(a.value.stops)&&"array"===Hi(a.value.stops[0])&&"object"===Hi(a.value.stops[0][0]),U=rr({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(Q){if("identity"===l)return[new fn(Q.key,Q.value,'identity function may not have a "stops" property')];let ie=[];const se=Q.value;return ie=ie.concat(bd({key:Q.key,value:se,valueSpec:Q.valueSpec,style:Q.style,styleSpec:Q.styleSpec,arrayElementValidator:W})),"array"===Hi(se)&&0===se.length&&ie.push(new fn(Q.key,se,"array must have at least one stop")),ie},default:function(Q){return Io({key:Q.key,value:Q.value,valueSpec:o,style:Q.style,styleSpec:Q.styleSpec})}}});return"identity"===l&&M&&U.push(new fn(a.key,a.value,'missing required property "property"')),"identity"===l||a.value.stops||U.push(new fn(a.key,a.value,'missing required property "stops"')),"exponential"===l&&a.valueSpec.expression&&!Bp(a.valueSpec)&&U.push(new fn(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(k&&!Mu(a.valueSpec)?U.push(new fn(a.key,a.value,"property functions not supported")):M&&!nc(a.valueSpec)&&U.push(new fn(a.key,a.value,"zoom functions not supported"))),"categorical"!==l&&!F||void 0!==a.value.property||U.push(new fn(a.key,a.value,'"property" property is required')),U;function W(Q){let ie=[];const se=Q.value,te=Q.key;if("array"!==Hi(se))return[new fn(te,se,`array expected, ${Hi(se)} found`)];if(2!==se.length)return[new fn(te,se,`array length 2 expected, length ${se.length} found`)];if(F){if("object"!==Hi(se[0]))return[new fn(te,se,`object expected, ${Hi(se[0])} found`)];if(void 0===se[0].zoom)return[new fn(te,se,"object stop key must have zoom")];if(void 0===se[0].value)return[new fn(te,se,"object stop key must have value")];const we=ur(se[0].zoom);if("number"!=typeof we)return[new fn(te,se[0].zoom,"stop zoom values must be numbers")];if(w&&w>we)return[new fn(te,se[0].zoom,"stop zoom values must appear in ascending order")];we!==w&&(w=we,y=void 0,E={}),ie=ie.concat(rr({key:`${te}[0]`,value:se[0],valueSpec:{zoom:{}},style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{zoom:Ma,value:V}}))}else ie=ie.concat(V({key:`${te}[0]`,value:se[0],valueSpec:{},style:Q.style,styleSpec:Q.styleSpec},se));return hh(qa(se[1]))?ie.concat([new fn(`${te}[1]`,se[1],"expressions are not allowed in function stops.")]):ie.concat(Io({key:`${te}[1]`,value:se[1],valueSpec:o,style:Q.style,styleSpec:Q.styleSpec}))}function V(Q,ie){const se=Hi(Q.value),te=ur(Q.value),we=null!==Q.value?Q.value:ie;if(p){if(se!==p)return[new fn(Q.key,we,`${se} stop domain type must match previous stop domain type ${p}`)]}else p=se;if("number"!==se&&"string"!==se&&"boolean"!==se&&"number"!=typeof te&&"string"!=typeof te&&"boolean"!=typeof te)return[new fn(Q.key,we,"stop domain value must be a number, string, or boolean")];if("number"!==se&&"categorical"!==l){let Oe=`number expected, ${se} found`;return Mu(o)&&void 0===l&&(Oe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new fn(Q.key,we,Oe)]}return"categorical"!==l||"number"!==se||"number"==typeof te&&isFinite(te)&&Math.floor(te)===te?"categorical"!==l&&"number"===se&&"number"==typeof te&&"number"==typeof y&&void 0!==y&&te<y?[new fn(Q.key,we,"stop domain values must appear in ascending order")]:(y=te,"categorical"===l&&te in E?[new fn(Q.key,we,"stop domain values must be unique")]:(E[te]=!0,[])):[new fn(Q.key,we,`integer expected, found ${String(te)}`)]}}function Qa(a){const o=("property"===a.expressionContext?Xa:Tl)(qa(a.value),a.valueSpec);if("error"===o.result)return o.value.map(p=>new fn(`${a.key}${p.key}`,a.value,p.message));const l=o.value.expression||o.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!l.outputDefined())return[new fn(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===a.expressionContext&&"layout"===a.propertyType&&!Qo(l))return[new fn(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext)return xd(l,a);if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!wu(l,["zoom","feature-state"]))return[new fn(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!Fc(l))return[new fn(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function xd(a,o){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const y of o.valueSpec.expression.parameters)l.delete(y);if(0===l.size)return[];const p=[];return a instanceof vu&&l.has(a.name)?[new fn(o.key,o.value,`["${a.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(a.eachChild(y=>{p.push(...xd(y,o))}),p)}function fh(a){const o=a.key,l=a.value,p=a.valueSpec,y=[];return Array.isArray(p.values)?-1===p.values.indexOf(ur(l))&&y.push(new fn(o,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):-1===Object.keys(p.values).indexOf(ur(l))&&y.push(new fn(o,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),y}function Hc(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const o of a.slice(1))if(!Hc(o)&&"boolean"!=typeof o)return!1;return!0;default:return!0}}function qc(a,o="fill"){if(null==a)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Hc(a)||(a=Cd(a));const l=a;let p=!0;try{p=function(F){if(!Zr(F))return F;let U=qa(F);return wd(U),U=Da(U),U}(l)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(l,null,2)}\n        `)}const y=dt[`filter_${o}`],w=Tl(p,y);let E=null;if("error"===w.result)throw new Error(w.value.map(F=>`${F.key}: ${F.message}`).join(", "));E=(F,U,W)=>w.value.evaluate(F,U,{},W);let M=null,k=null;if(p!==l){const F=Tl(l,y);if("error"===F.result)throw new Error(F.value.map(U=>`${U.key}: ${U.message}`).join(", "));M=(U,W,V,Q,ie)=>F.value.evaluate(U,W,{},V,void 0,void 0,Q,ie),k=!Fc(F.value.expression)}return{filter:E,dynamicFilter:M||void 0,needGeometry:Ps(p),needFeature:!!k}}function Da(a){if(!Array.isArray(a))return a;const o=function(l){if(Ml.has(l[0]))for(let p=1;p<l.length;p++)if(Zr(l[p]))return!0;return l}(a);return!0===o?o:o.map(l=>Da(l))}function wd(a){let o=!1;const l=[];if("case"===a[0]){for(let p=1;p<a.length-1;p+=2)o=o||Zr(a[p]),l.push(a[p+1]);l.push(a[a.length-1])}else if("match"===a[0]){o=o||Zr(a[1]);for(let p=2;p<a.length-1;p+=2)l.push(a[p+1]);l.push(a[a.length-1])}else if("step"===a[0]){o=o||Zr(a[1]);for(let p=1;p<a.length-1;p+=2)l.push(a[p+1])}o&&(a.length=0,a.push("any",...l));for(let p=1;p<a.length;p++)wd(a[p])}function Zr(a){if(!Array.isArray(a))return!1;if("pitch"===(o=a[0])||"distance-from-center"===o)return!0;var o;for(let l=1;l<a.length;l++)if(Zr(a[l]))return!0;return!1}const Ml=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ph(a,o){return a<o?-1:a>o?1:0}function Ps(a){if(!Array.isArray(a))return!1;if("within"===a[0])return!0;for(let o=1;o<a.length;o++)if(Ps(a[o]))return!0;return!1}function Cd(a){if(!a)return!0;const o=a[0];return a.length<=1?"any"!==o:"=="===o?Dl(a[1],a[2],"=="):"!="===o?Aa(Dl(a[1],a[2],"==")):"<"===o||">"===o||"<="===o||">="===o?Dl(a[1],a[2],o):"any"===o?(l=a.slice(1),["any"].concat(l.map(Cd))):"all"===o?["all"].concat(a.slice(1).map(Cd)):"none"===o?["all"].concat(a.slice(1).map(Cd).map(Aa)):"in"===o?Zc(a[1],a.slice(2)):"!in"===o?Aa(Zc(a[1],a.slice(2))):"has"===o?Ed(a[1]):"!has"===o?Aa(Ed(a[1])):"within"!==o||a;var l}function Dl(a,o,l){switch(a){case"$type":return[`filter-type-${l}`,o];case"$id":return[`filter-id-${l}`,o];default:return[`filter-${l}`,a,o]}}function Zc(a,o){if(0===o.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(l=>typeof l!=typeof o[0])?["filter-in-large",a,["literal",o.sort(ph)]]:["filter-in-small",a,["literal",o]]}}function Ed(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Aa(a){return["!",a]}function Pu(a){return Hc(qa(a.value))?Qa(ko({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):Up(a)}function Up(a){const o=a.value,l=a.key;if("array"!==Hi(o))return[new fn(l,o,`array expected, ${Hi(o)} found`)];const p=a.styleSpec;let y,w=[];if(o.length<1)return[new fn(l,o,"filter array must have at least 1 element")];switch(w=w.concat(fh({key:`${l}[0]`,value:o[0],valueSpec:p.filter_operator,style:a.style,styleSpec:a.styleSpec})),ur(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&"$type"===ur(o[1])&&w.push(new fn(l,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":3!==o.length&&w.push(new fn(l,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(y=Hi(o[1]),"string"!==y&&w.push(new fn(`${l}[1]`,o[1],`string expected, ${y} found`)));for(let E=2;E<o.length;E++)y=Hi(o[E]),"$type"===ur(o[1])?w=w.concat(fh({key:`${l}[${E}]`,value:o[E],valueSpec:p.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==y&&"number"!==y&&"boolean"!==y&&w.push(new fn(`${l}[${E}]`,o[E],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let E=1;E<o.length;E++)w=w.concat(Up({key:`${l}[${E}]`,value:o[E],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":y=Hi(o[1]),2!==o.length?w.push(new fn(l,o,`filter array for "${o[0]}" operator must have 2 elements`)):"string"!==y&&w.push(new fn(`${l}[1]`,o[1],`string expected, ${y} found`));break;case"within":y=Hi(o[1]),2!==o.length?w.push(new fn(l,o,`filter array for "${o[0]}" operator must have 2 elements`)):"object"!==y&&w.push(new fn(`${l}[1]`,o[1],`object expected, ${y} found`))}return w}function Td(a,o){const l=a.key,p=a.style,y=a.styleSpec,w=a.value,E=a.objectKey,M=y[`${o}_${a.layerType}`];if(!M)return[];const k=E.match(/^(.*)-transition$/);if("paint"===o&&k&&M[k[1]]&&M[k[1]].transition)return Io({key:l,value:w,valueSpec:y.transition,style:p,styleSpec:y});const F=a.valueSpec||M[E];if(!F)return[new fn(l,w,`unknown property "${E}"`)];let U;if("string"===Hi(w)&&Mu(F)&&!F.tokens&&(U=/^{([^}]+)}$/.exec(w)))return[new fn(l,w,`"${E}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(U[1])} }\`.`)];const W=[];return"symbol"===a.layerType&&("text-field"===E&&p&&!p.glyphs&&W.push(new fn(l,w,'use of "text-field" requires a style "glyphs" property')),"text-font"===E&&Du(qa(w))&&"identity"===ur(w.type)&&W.push(new fn(l,w,'"text-font" does not support identity functions'))),W.concat(Io({key:a.key,value:w,valueSpec:F,style:p,styleSpec:y,expressionContext:"property",propertyType:o,propertyKey:E}))}function mh(a){return Td(a,"paint")}function gh(a){return Td(a,"layout")}function _h(a){let o=[];const l=a.value,p=a.key,y=a.style,w=a.styleSpec;l.type||l.ref||o.push(new fn(p,l,'either "type" or "ref" is required'));let E=ur(l.type);const M=ur(l.ref);if(l.id){const k=ur(l.id);for(let F=0;F<a.arrayIndex;F++){const U=y.layers[F];ur(U.id)===k&&o.push(new fn(p,l.id,`duplicate layer id "${l.id}", previously used at line ${U.id.__line__}`))}}if("ref"in l){let k;["type","source","source-layer","filter","layout"].forEach(F=>{F in l&&o.push(new fn(p,l[F],`"${F}" is prohibited for ref layers`))}),y.layers.forEach(F=>{ur(F.id)===M&&(k=F)}),k?k.ref?o.push(new fn(p,l.ref,"ref cannot reference another ref layer")):E=ur(k.type):"string"==typeof M&&o.push(new fn(p,l.ref,`ref layer "${M}" not found`))}else if("background"!==E&&"sky"!==E)if(l.source){const k=y.sources&&y.sources[l.source],F=k&&ur(k.type);k?"vector"===F&&"raster"===E?o.push(new fn(p,l.source,`layer "${l.id}" requires a raster source`)):"raster"===F&&"raster"!==E?o.push(new fn(p,l.source,`layer "${l.id}" requires a vector source`)):"vector"!==F||l["source-layer"]?"raster-dem"===F&&"hillshade"!==E?o.push(new fn(p,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==E||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||"geojson"===F&&k.lineMetrics||o.push(new fn(p,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new fn(p,l,`layer "${l.id}" must specify a "source-layer"`)):o.push(new fn(p,l.source,`source "${l.source}" not found`))}else o.push(new fn(p,l,'missing required property "source"'));return o=o.concat(rr({key:p,value:l,valueSpec:w.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Io({key:`${p}.type`,value:l.type,valueSpec:w.layer.type,style:a.style,styleSpec:a.styleSpec,object:l,objectKey:"type"}),filter:k=>Pu(ko({layerType:E},k)),layout:k=>rr({layer:l,key:k.key,value:k.value,valueSpec:{},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{"*":F=>gh(ko({layerType:E},F))}}),paint:k=>rr({layer:l,key:k.key,value:k.value,valueSpec:{},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{"*":F=>mh(ko({layerType:E},F))}})}})),o}function rc(a){const o=a.value,l=a.key,p=Hi(o);return"string"!==p?[new fn(l,o,`string expected, ${p} found`)]:[]}const Ou={promoteId:function({key:a,value:o}){if("string"===Hi(o))return rc({key:a,value:o});{const l=[];for(const p in o)l.push(...rc({key:`${a}.${p}`,value:o[p]}));return l}}};function da(a){const o=a.value,l=a.key,p=a.styleSpec,y=a.style;if(!o.type)return[new fn(l,o,'"type" is required')];const w=ur(o.type);let E;switch(w){case"vector":case"raster":case"raster-dem":return E=rr({key:l,value:o,valueSpec:p[`source_${w.replace("-","_")}`],style:a.style,styleSpec:p,objectElementValidators:Ou}),E;case"geojson":if(E=rr({key:l,value:o,valueSpec:p.source_geojson,style:y,styleSpec:p,objectElementValidators:Ou}),o.cluster)for(const M in o.clusterProperties){const[k,F]=o.clusterProperties[M],U="string"==typeof k?[k,["accumulated"],["get",M]]:k;E.push(...Qa({key:`${l}.${M}.map`,value:F,expressionContext:"cluster-map"})),E.push(...Qa({key:`${l}.${M}.reduce`,value:U,expressionContext:"cluster-reduce"}))}return E;case"video":return rr({key:l,value:o,valueSpec:p.source_video,style:y,styleSpec:p});case"image":return rr({key:l,value:o,valueSpec:p.source_image,style:y,styleSpec:p});case"canvas":return[new fn(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return fh({key:`${l}.type`,value:o.type,valueSpec:{values:Sf(p)},style:y,styleSpec:p})}}function Sf(a){return a.source.reduce((o,l)=>{const p=a[l];return"enum"===p.type.type&&(o=o.concat(Object.keys(p.type.values))),o},[])}function Mf(a){const o=a.value,l=a.styleSpec,p=l.light,y=a.style;let w=[];const E=Hi(o);if(void 0===o)return w;if("object"!==E)return w=w.concat([new fn("light",o,`object expected, ${E} found`)]),w;for(const M in o){const k=M.match(/^(.*)-transition$/);w=w.concat(k&&p[k[1]]&&p[k[1]].transition?Io({key:M,value:o[M],valueSpec:l.transition,style:y,styleSpec:l}):p[M]?Io({key:M,value:o[M],valueSpec:p[M],style:y,styleSpec:l}):[new fn(M,o[M],`unknown property "${M}"`)])}return w}function Id(a){const o=a.value,l=a.key,p=a.style,y=a.styleSpec,w=y.terrain;let E=[];const M=Hi(o);if(void 0===o)return E;if("object"!==M)return E=E.concat([new fn("terrain",o,`object expected, ${M} found`)]),E;for(const k in o){const F=k.match(/^(.*)-transition$/);E=E.concat(F&&w[F[1]]&&w[F[1]].transition?Io({key:k,value:o[k],valueSpec:y.transition,style:p,styleSpec:y}):w[k]?Io({key:k,value:o[k],valueSpec:w[k],style:p,styleSpec:y}):[new fn(k,o[k],`unknown property "${k}"`)])}if(o.source){const k=p.sources&&p.sources[o.source],F=k&&ur(k.type);k?"raster-dem"!==F&&E.push(new fn(l,o.source,`terrain cannot be used with a source of type ${String(F)}, it only be used with a "raster-dem" source type`)):E.push(new fn(l,o.source,`source "${o.source}" not found`))}else E.push(new fn(l,o,'terrain is missing required property "source"'));return E}function Wc(a){const o=a.value,l=a.style,p=a.styleSpec,y=p.fog;let w=[];const E=Hi(o);if(void 0===o)return w;if("object"!==E)return w=w.concat([new fn("fog",o,`object expected, ${E} found`)]),w;for(const M in o){const k=M.match(/^(.*)-transition$/);w=w.concat(k&&y[k[1]]&&y[k[1]].transition?Io({key:M,value:o[M],valueSpec:p.transition,style:l,styleSpec:p}):y[M]?Io({key:M,value:o[M],valueSpec:y[M],style:l,styleSpec:p}):[new fn(M,o[M],`unknown property "${M}"`)])}return w}const yh={"*":()=>[],array:bd,boolean:function(a){const o=a.value,l=a.key,p=Hi(o);return"boolean"!==p?[new fn(l,o,`boolean expected, ${p} found`)]:[]},number:Ma,color:function(a){const o=a.key,l=a.value,p=Hi(l);return"string"!==p?[new fn(o,l,`color expected, ${p} found`)]:null===sa(l)?[new fn(o,l,`color expected, "${l}" found`)]:[]},enum:fh,filter:Pu,function:Gc,layer:_h,object:rr,source:da,light:Mf,terrain:Id,fog:Wc,string:rc,formatted:function(a){return 0===rc(a).length?[]:Qa(a)},resolvedImage:function(a){return 0===rc(a).length?[]:Qa(a)},projection:function(a){const o=a.value,l=a.styleSpec,p=l.projection,y=a.style;let w=[];const E=Hi(o);if("object"===E)for(const M in o)w=w.concat(Io({key:M,value:o[M],valueSpec:p[M],style:y,styleSpec:l}));else"string"!==E&&(w=w.concat([new fn("projection",o,`object or string expected, ${E} found`)]));return w}};function Io(a){const o=a.value,l=a.valueSpec,p=a.styleSpec;return l.expression&&Du(ur(o))?Gc(a):l.expression&&hh(qa(o))?Qa(a):l.type&&yh[l.type]?yh[l.type](a):rr(ko({},a,{valueSpec:l.type?p[l.type]:l}))}function Df(a){const o=a.value,l=a.key,p=rc(a);return p.length||(-1===o.indexOf("{fontstack}")&&p.push(new fn(l,o,'"glyphs" url must include a "{fontstack}" token')),-1===o.indexOf("{range}")&&p.push(new fn(l,o,'"glyphs" url must include a "{range}" token'))),p}function Af(a,o=dt){return Os(Io({key:"",value:a,valueSpec:o.$root,styleSpec:o,style:a,objectElementValidators:{glyphs:Df,"*":()=>[]}}))}const Pf=a=>Os(mh(a)),Yc=a=>Os(gh(a));function Os(a){return a.slice().sort((o,l)=>o.line&&l.line?o.line-l.line:0)}function ku(a,o){let l=!1;if(o&&o.length)for(const p of o)a.fire(new Zi(new Error(p.message))),l=!0;return l}var Pa=Ja;function Ja(a,o,l){var p=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var y=new Int32Array(this.arrayBuffer);a=y[0],this.d=(o=y[1])+2*(l=y[2]);for(var w=0;w<this.d*this.d;w++){var E=y[3+w],M=y[3+w+1];p.push(E===M?null:y.subarray(E,M))}var k=y[3+p.length+1];this.keys=y.subarray(y[3+p.length],k),this.bboxes=y.subarray(k),this.insert=this._insertReadonly}else{this.d=o+2*l;for(var F=0;F<this.d*this.d;F++)p.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=a,this.padding=l,this.scale=o/a,this.uid=0;var U=l/o*a;this.min=-U,this.max=a+U}Ja.prototype.insert=function(a,o,l,p,y){this._forEachCell(o,l,p,y,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(y)},Ja.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ja.prototype._insertCell=function(a,o,l,p,y,w){this.cells[y].push(w)},Ja.prototype.query=function(a,o,l,p,y){var w=this.min,E=this.max;if(a<=w&&o<=w&&E<=l&&E<=p&&!y)return Array.prototype.slice.call(this.keys);var M=[];return this._forEachCell(a,o,l,p,this._queryCell,M,{},y),M},Ja.prototype._queryCell=function(a,o,l,p,y,w,E,M){var k=this.cells[y];if(null!==k)for(var F=this.keys,U=this.bboxes,W=0;W<k.length;W++){var V=k[W];if(void 0===E[V]){var Q=4*V;(M?M(U[Q+0],U[Q+1],U[Q+2],U[Q+3]):a<=U[Q+2]&&o<=U[Q+3]&&l>=U[Q+0]&&p>=U[Q+1])?(E[V]=!0,w.push(F[V])):E[V]=!1}}},Ja.prototype._forEachCell=function(a,o,l,p,y,w,E,M){for(var k=this._convertToCellCoord(a),F=this._convertToCellCoord(o),U=this._convertToCellCoord(l),W=this._convertToCellCoord(p),V=k;V<=U;V++)for(var Q=F;Q<=W;Q++){var ie=this.d*Q+V;if((!M||M(this._convertFromCellCoord(V),this._convertFromCellCoord(Q),this._convertFromCellCoord(V+1),this._convertFromCellCoord(Q+1)))&&y.call(this,a,o,l,p,ie,w,E,M))return}},Ja.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},Ja.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},Ja.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,o=3+this.cells.length+1+1,l=0,p=0;p<this.cells.length;p++)l+=this.cells[p].length;var y=new Int32Array(o+l+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var w=o,E=0;E<a.length;E++){var M=a[E];y[3+E]=w,y.set(M,w),w+=M.length}return y[3+a.length]=w,y.set(this.keys,w),y[3+a.length+1]=w+=this.keys.length,y.set(this.bboxes,w),w+=this.bboxes.length,y.buffer};const Ru={};function gn(a,o,l={}){Object.defineProperty(a,"_classRegistryKey",{value:o,writeable:!1}),Ru[o]={klass:a,omit:l.omit||[]}}gn(Object,"Object"),Pa.serialize=function(a,o){const l=a.toArrayBuffer();return o&&o.push(l),{buffer:l}},Pa.deserialize=function(a){return new Pa(a.buffer)},Object.defineProperty(Pa,"name",{value:"Grid"}),gn(Pa,"Grid"),gn(to,"Color"),gn(Error,"Error"),gn(Xn,"AJAXError"),gn(Er,"ResolvedImage"),gn($c,"StylePropertyFunction"),gn(vd,"StyleExpression",{omit:["_evaluator"]}),gn(Il,"ZoomDependentExpression"),gn(Vp,"ZoomConstantExpression"),gn(vu,"CompoundExpression",{omit:["_evaluate"]});for(const a in pr)Ru[pr[a]._classRegistryKey]||gn(pr[a],`Expression${a}`);function jp(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function ha(a){return $e.ImageBitmap&&a instanceof $e.ImageBitmap}function xr(a,o){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(jp(a)||ha(a))return o&&o.push(a),a;if(ArrayBuffer.isView(a)){const l=a;return o&&o.push(l.buffer),l}if(a instanceof $e.ImageData)return o&&o.push(a.data.buffer),a;if(Array.isArray(a)){const l=[];for(const p of a)l.push(xr(p,o));return l}if("object"==typeof a){const l=a.constructor,p=l._classRegistryKey;if(!p)throw new Error(`can't serialize object of unregistered class ${p}`);const y=l.serialize?l.serialize(a,o):{};if(!l.serialize){for(const w in a)a.hasOwnProperty(w)&&(Ru[p].omit.indexOf(w)>=0||(y[w]=xr(a[w],o)));a instanceof Error&&(y.message=a.message)}if(y.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==p&&(y.$name=p),y}throw new Error("can't serialize object of type "+typeof a)}function Fu(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||jp(a)||ha(a)||ArrayBuffer.isView(a)||a instanceof $e.ImageData)return a;if(Array.isArray(a))return a.map(Fu);if("object"==typeof a){const o=a.$name||"Object",{klass:l}=Ru[o];if(!l)throw new Error(`can't deserialize unregistered class ${o}`);if(l.deserialize)return l.deserialize(a);const p=Object.create(l.prototype);for(const y of Object.keys(a))"$name"!==y&&(p[y]=Fu(a[y]));return p}throw new Error("can't deserialize object of type "+typeof a)}const Lu=a=>a>=1536&&a<=1791,vh=a=>a>=1872&&a<=1919,ig=a=>a>=2208&&a<=2303,$p=a=>a>=11904&&a<=12031,rg=a=>a>=12032&&a<=12255,bh=a=>a>=12272&&a<=12287,Oa=a=>a>=12288&&a<=12351,xh=a=>a>=12352&&a<=12447,wh=a=>a>=12448&&a<=12543,ro=a=>a>=12544&&a<=12591,Of=a=>a>=12704&&a<=12735,fa=a=>a>=12736&&a<=12783,Ch=a=>a>=12784&&a<=12799,pa=a=>a>=12800&&a<=13055,Kc=a=>a>=13056&&a<=13311,Gp=a=>a>=13312&&a<=19903,Xc=a=>a>=19968&&a<=40959,Nu=a=>a>=40960&&a<=42127,Eh=a=>a>=42128&&a<=42191,og=a=>a>=44032&&a<=55215,Sd=a=>a>=63744&&a<=64255,Hp=a=>a>=64336&&a<=65023,Mi=a=>a>=65040&&a<=65055,v=a=>a>=65072&&a<=65103,c=a=>a>=65104&&a<=65135,g=a=>a>=65136&&a<=65279,C=a=>a>=65280&&a<=65519;function S(a){for(const o of a)if(z(o.charCodeAt(0)))return!0;return!1}function D(a){for(const o of a)if(!L(o.charCodeAt(0)))return!1;return!0}function L(a){return!(Lu(a)||vh(a)||ig(a)||Hp(a)||g(a))}function z(a){return!(746!==a&&747!==a&&(a<4352||!(Of(a)||ro(a)||v(a)&&!(a>=65097&&a<=65103)||Sd(a)||Kc(a)||$p(a)||fa(a)||!(!Oa(a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||Gp(a)||Xc(a)||pa(a)||(o=a,o>=12592&&o<=12687)||(o=>o>=43360&&o<=43391)(a)||(o=>o>=55216&&o<=55295)(a)||(o=>o>=4352&&o<=4607)(a)||og(a)||xh(a)||bh(a)||(o=>o>=12688&&o<=12703)(a)||rg(a)||Ch(a)||wh(a)&&12540!==a||!(!C(a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!c(a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||(o=>o>=5120&&o<=5759)(a)||(o=>o>=6320&&o<=6399)(a)||Mi(a)||(o=>o>=19904&&o<=19967)(a)||Nu(a)||Eh(a))));var o}function G(a){return!(z(a)||(o=a,(l=o)>=128&&l<=255&&(167===o||169===o||174===o||177===o||188===o||189===o||190===o||215===o||247===o)||(l=>l>=8192&&l<=8303)(o)&&(8214===o||8224===o||8225===o||8240===o||8241===o||8251===o||8252===o||8258===o||8263===o||8264===o||8265===o||8273===o)||(l=>l>=8448&&l<=8527)(o)||(l=>l>=8528&&l<=8591)(o)||(l=>l>=8960&&l<=9215)(o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||9003===o||o>=9085&&o<=9114||o>=9150&&o<=9165||9167===o||o>=9169&&o<=9179||o>=9186&&o<=9215)||(l=>l>=9216&&l<=9279)(o)&&9251!==o||(l=>l>=9280&&l<=9311)(o)||(l=>l>=9312&&l<=9471)(o)||(l=>l>=9632&&l<=9727)(o)||(l=>l>=9728&&l<=9983)(o)&&!(o>=9754&&o<=9759)||(l=>l>=11008&&l<=11263)(o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Oa(o)||wh(o)||(l=>l>=57344&&l<=63743)(o)||v(o)||c(o)||C(o)||8734===o||8756===o||8757===o||o>=9984&&o<=10087||o>=10102&&o<=10131||65532===o||65533===o));var o,l}function J(a){return a>=1424&&a<=2303||Hp(a)||g(a)}function ee(a,o){return!(!o&&J(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||(l=a,l>=6016&&l<=6143));var l}function re(a){for(const o of a)if(J(o.charCodeAt(0)))return!0;return!1}const fe="deferred",_e="loading",de="loaded";let ve=null,xe="unavailable",ue=null;const Ce=function(a){a&&"string"==typeof a&&a.indexOf("NetworkError")>-1&&(xe="error"),ve&&ve(a)};function be(){Me.fire(new fr("pluginStateChange",{pluginStatus:xe,pluginURL:ue}))}const Me=new Rr,Le=function(){return xe},Fe=function(){if(xe!==fe||!ue)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");xe=_e,be(),ue&&Jr({url:ue},a=>{a?Ce(a):(xe=de,be())})},Ue={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>xe===de||null!=Ue.applyArabicShaping,isLoading:()=>xe===_e,setState(a){xe=a.pluginStatus,ue=a.pluginURL},isParsed:()=>null!=Ue.applyArabicShaping&&null!=Ue.processBidirectionalText&&null!=Ue.processStyledBidirectionalText,getPluginURL:()=>ue};class We{constructor(o,l){this.zoom=o,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(o){return function(l,p){for(const y of l)if(!ee(y.charCodeAt(0),p))return!1;return!0}(o,Ue.isLoaded())}}class it{constructor(o,l){this.property=o,this.value=l,this.expression=function(p,y){if(Du(p))return new $c(p,y);if(hh(p)){const w=Xa(p,y);if("error"===w.result)throw new Error(w.value.map(E=>`${E.key}: ${E.message}`).join(", "));return w.value}{let w=p;return"string"==typeof p&&"color"===y.type&&(w=to.parse(p)),{kind:"constant",evaluate:()=>w}}}(void 0===l?o.specification.default:l,o.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(o,l,p){return this.property.possiblyEvaluate(this,o,l,p)}}class st{constructor(o){this.property=o,this.value=new it(o,void 0)}transitioned(o,l){return new Qe(this.property,this.value,l,gt({},o.transition,this.transition),o.now)}untransitioned(){return new Qe(this.property,this.value,null,{},0)}}class Ut{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return vn(this._values[o].value.value)}setValue(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new st(this._values[o].property)),this._values[o].value=new it(this._values[o].property,null===l?void 0:vn(l))}getTransition(o){return vn(this._values[o].transition)}setTransition(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new st(this._values[o].property)),this._values[o].transition=vn(l)||void 0}serialize(){const o={};for(const l of Object.keys(this._values)){const p=this.getValue(l);void 0!==p&&(o[l]=p);const y=this.getTransition(l);void 0!==y&&(o[`${l}-transition`]=y)}return o}transitioned(o,l){const p=new St(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].transitioned(o,l._values[y]);return p}untransitioned(){const o=new St(this._properties);for(const l of Object.keys(this._values))o._values[l]=this._values[l].untransitioned();return o}}class Qe{constructor(o,l,p,y,w){const E=y.delay||0,M=y.duration||0;w=w||0,this.property=o,this.value=l,this.begin=w+E,this.end=this.begin+M,o.specification.transition&&(y.delay||y.duration)&&(this.prior=p)}possiblyEvaluate(o,l,p){const y=o.now||0,w=this.value.possiblyEvaluate(o,l,p),E=this.prior;if(E){if(y>this.end)return this.prior=null,w;if(this.value.isDataDriven())return this.prior=null,w;if(y<this.begin)return E.possiblyEvaluate(o,l,p);{const M=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(o,l,p),w,nt(M))}}return w}}class St{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,l,p){const y=new et(this._properties);for(const w of Object.keys(this._values))y._values[w]=this._values[w].possiblyEvaluate(o,l,p);return y}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class at{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}getValue(o){return vn(this._values[o].value)}setValue(o,l){this._values[o]=new it(this._values[o].property,null===l?void 0:vn(l))}serialize(){const o={};for(const l of Object.keys(this._values)){const p=this.getValue(l);void 0!==p&&(o[l]=p)}return o}possiblyEvaluate(o,l,p){const y=new et(this._properties);for(const w of Object.keys(this._values))y._values[w]=this._values[w].possiblyEvaluate(o,l,p);return y}}class Ot{constructor(o,l,p){this.property=o,this.value=l,this.parameters=p}isConstant(){return"constant"===this.value.kind}constantOr(o){return"constant"===this.value.kind?this.value.value:o}evaluate(o,l,p,y){return this.property.evaluate(this.value,this.parameters,o,l,p,y)}}class et{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class qe{constructor(o){this.specification=o}possiblyEvaluate(o,l){return o.expression.evaluate(l)}interpolate(o,l,p){const y=zc[this.specification.type];return y?y(o,l,p):o}}class Xe{constructor(o,l){this.specification=o,this.overrides=l}possiblyEvaluate(o,l,p,y){return new Ot(this,"constant"===o.expression.kind||"camera"===o.expression.kind?{kind:"constant",value:o.expression.evaluate(l,null,{},p,y)}:o.expression,l)}interpolate(o,l,p){if("constant"!==o.value.kind||"constant"!==l.value.kind)return o;if(void 0===o.value.value||void 0===l.value.value)return new Ot(this,{kind:"constant",value:void 0},o.parameters);const y=zc[this.specification.type];return y?new Ot(this,{kind:"constant",value:y(o.value.value,l.value.value,p)},o.parameters):o}evaluate(o,l,p,y,w,E){return"constant"===o.kind?o.value:o.evaluate(l,p,y,w,E)}}class Mt{constructor(o){this.specification=o}possiblyEvaluate(o,l,p,y){return!!o.expression.evaluate(l,null,{},p,y)}interpolate(){return!1}}class Rt{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new We(0,{});for(const p in o){const y=o[p];y.specification.overridable&&this.overridableProperties.push(p);const w=this.defaultPropertyValues[p]=new it(y,void 0),E=this.defaultTransitionablePropertyValues[p]=new st(y);this.defaultTransitioningPropertyValues[p]=E.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=w.possiblyEvaluate(l)}}}function dn(a,o){return 256*(a=zt(Math.floor(a),0,255))+zt(Math.floor(o),0,255)}gn(Xe,"DataDrivenProperty"),gn(qe,"DataConstantProperty"),gn(Mt,"ColorRampProperty");const Wn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class _n{constructor(o,l){this._structArray=o,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Yt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,l){return o._trim(),l&&(o.isTransferred=!0,l.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const l=Object.create(this.prototype);return l.arrayBuffer=o.arrayBuffer,l.length=o.length,l.capacity=o.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function yn(a,o=1){let l=0,p=0;return{members:a.map(y=>{const w=Wn[y.type].BYTES_PER_ELEMENT,E=l=xi(l,Math.max(o,w)),M=y.components||1;return p=Math.max(p,w),l+=w*M,{name:y.name,type:y.type,components:M,offset:E}}),size:xi(l,Math.max(p,o)),alignment:o}}function xi(a,o){return Math.ceil(a/o)*o}class Vn extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l){const p=this.length;return this.resize(p+1),this.emplace(p,o,l)}emplace(o,l,p){const y=2*o;return this.int16[y+0]=l,this.int16[y+1]=p,o}}Vn.prototype.bytesPerElement=4,gn(Vn,"StructArrayLayout2i4");class er extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,p)}emplace(o,l,p,y){const w=3*o;return this.int16[w+0]=l,this.int16[w+1]=p,this.int16[w+2]=y,o}}er.prototype.bytesPerElement=6,gn(er,"StructArrayLayout3i6");class Ri extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,p,y){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,p,y)}emplace(o,l,p,y,w){const E=4*o;return this.int16[E+0]=l,this.int16[E+1]=p,this.int16[E+2]=y,this.int16[E+3]=w,o}}Ri.prototype.bytesPerElement=8,gn(Ri,"StructArrayLayout4i8");class or extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E,M){const k=this.length;return this.resize(k+1),this.emplace(k,o,l,p,y,w,E,M)}emplace(o,l,p,y,w,E,M,k){const F=6*o,U=12*o,W=3*o;return this.int16[F+0]=l,this.int16[F+1]=p,this.uint8[U+4]=y,this.uint8[U+5]=w,this.uint8[U+6]=E,this.uint8[U+7]=M,this.float32[W+2]=k,o}}or.prototype.bytesPerElement=12,gn(or,"StructArrayLayout2i4ub1f12");class vi extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p,y){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,p,y)}emplace(o,l,p,y,w){const E=4*o;return this.float32[E+0]=l,this.float32[E+1]=p,this.float32[E+2]=y,this.float32[E+3]=w,o}}vi.prototype.bytesPerElement=16,gn(vi,"StructArrayLayout4f16");class Dr extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,p,y,w)}emplace(o,l,p,y,w,E){const M=6*o,k=3*o;return this.uint16[M+0]=l,this.uint16[M+1]=p,this.uint16[M+2]=y,this.uint16[M+3]=w,this.float32[k+2]=E,o}}Dr.prototype.bytesPerElement=12,gn(Dr,"StructArrayLayout4ui1f12");class Ws extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,p,y){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,p,y)}emplace(o,l,p,y,w){const E=4*o;return this.uint16[E+0]=l,this.uint16[E+1]=p,this.uint16[E+2]=y,this.uint16[E+3]=w,o}}Ws.prototype.bytesPerElement=8,gn(Ws,"StructArrayLayout4ui8");class $s extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E){const M=this.length;return this.resize(M+1),this.emplace(M,o,l,p,y,w,E)}emplace(o,l,p,y,w,E,M){const k=6*o;return this.int16[k+0]=l,this.int16[k+1]=p,this.int16[k+2]=y,this.int16[k+3]=w,this.int16[k+4]=E,this.int16[k+5]=M,o}}$s.prototype.bytesPerElement=12,gn($s,"StructArrayLayout6i12");class ka extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E,M,k,F,U,W,V){const Q=this.length;return this.resize(Q+1),this.emplace(Q,o,l,p,y,w,E,M,k,F,U,W,V)}emplace(o,l,p,y,w,E,M,k,F,U,W,V,Q){const ie=12*o;return this.int16[ie+0]=l,this.int16[ie+1]=p,this.int16[ie+2]=y,this.int16[ie+3]=w,this.uint16[ie+4]=E,this.uint16[ie+5]=M,this.uint16[ie+6]=k,this.uint16[ie+7]=F,this.int16[ie+8]=U,this.int16[ie+9]=W,this.int16[ie+10]=V,this.int16[ie+11]=Q,o}}ka.prototype.bytesPerElement=24,gn(ka,"StructArrayLayout4i4ui4i24");class Tr extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E){const M=this.length;return this.resize(M+1),this.emplace(M,o,l,p,y,w,E)}emplace(o,l,p,y,w,E,M){const k=10*o,F=5*o;return this.int16[k+0]=l,this.int16[k+1]=p,this.int16[k+2]=y,this.float32[F+2]=w,this.float32[F+3]=E,this.float32[F+4]=M,o}}Tr.prototype.bytesPerElement=20,gn(Tr,"StructArrayLayout3i3f20");class sr extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint32[1*o+0]=l,o}}sr.prototype.bytesPerElement=4,gn(sr,"StructArrayLayout1ul4");class Yi extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E,M,k,F,U,W,V,Q){const ie=this.length;return this.resize(ie+1),this.emplace(ie,o,l,p,y,w,E,M,k,F,U,W,V,Q)}emplace(o,l,p,y,w,E,M,k,F,U,W,V,Q,ie){const se=20*o,te=10*o;return this.int16[se+0]=l,this.int16[se+1]=p,this.int16[se+2]=y,this.int16[se+3]=w,this.int16[se+4]=E,this.float32[te+3]=M,this.float32[te+4]=k,this.float32[te+5]=F,this.float32[te+6]=U,this.int16[se+14]=W,this.uint32[te+8]=V,this.uint16[se+18]=Q,this.uint16[se+19]=ie,o}}Yi.prototype.bytesPerElement=40,gn(Yi,"StructArrayLayout5i4f1i1ul2ui40");class Fr extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E,M){const k=this.length;return this.resize(k+1),this.emplace(k,o,l,p,y,w,E,M)}emplace(o,l,p,y,w,E,M,k){const F=8*o;return this.int16[F+0]=l,this.int16[F+1]=p,this.int16[F+2]=y,this.int16[F+4]=w,this.int16[F+5]=E,this.int16[F+6]=M,this.int16[F+7]=k,o}}Fr.prototype.bytesPerElement=16,gn(Fr,"StructArrayLayout3i2i2i16");class Qn extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,p,y,w)}emplace(o,l,p,y,w,E){const M=4*o,k=8*o;return this.float32[M+0]=l,this.float32[M+1]=p,this.float32[M+2]=y,this.int16[k+6]=w,this.int16[k+7]=E,o}}Qn.prototype.bytesPerElement=16,gn(Qn,"StructArrayLayout2f1f2i16");class Fi extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p,y){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,p,y)}emplace(o,l,p,y,w){const E=12*o,M=3*o;return this.uint8[E+0]=l,this.uint8[E+1]=p,this.float32[M+1]=y,this.float32[M+2]=w,o}}Fi.prototype.bytesPerElement=12,gn(Fi,"StructArrayLayout2ub2f12");class bs extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,p)}emplace(o,l,p,y){const w=3*o;return this.float32[w+0]=l,this.float32[w+1]=p,this.float32[w+2]=y,o}}bs.prototype.bytesPerElement=12,gn(bs,"StructArrayLayout3f12");class mo extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,p)}emplace(o,l,p,y){const w=3*o;return this.uint16[w+0]=l,this.uint16[w+1]=p,this.uint16[w+2]=y,o}}mo.prototype.bytesPerElement=6,gn(mo,"StructArrayLayout3ui6");class oc extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E,M,k,F,U,W,V,Q,ie,se,te,we,Oe,me,Ae,Ee){const Re=this.length;return this.resize(Re+1),this.emplace(Re,o,l,p,y,w,E,M,k,F,U,W,V,Q,ie,se,te,we,Oe,me,Ae,Ee)}emplace(o,l,p,y,w,E,M,k,F,U,W,V,Q,ie,se,te,we,Oe,me,Ae,Ee,Re){const lt=30*o,tt=15*o,wt=60*o;return this.int16[lt+0]=l,this.int16[lt+1]=p,this.int16[lt+2]=y,this.float32[tt+2]=w,this.float32[tt+3]=E,this.uint16[lt+8]=M,this.uint16[lt+9]=k,this.uint32[tt+5]=F,this.uint32[tt+6]=U,this.uint32[tt+7]=W,this.uint16[lt+16]=V,this.uint16[lt+17]=Q,this.uint16[lt+18]=ie,this.float32[tt+10]=se,this.float32[tt+11]=te,this.uint8[wt+48]=we,this.uint8[wt+49]=Oe,this.uint8[wt+50]=me,this.uint32[tt+13]=Ae,this.int16[lt+28]=Ee,this.uint8[wt+58]=Re,o}}oc.prototype.bytesPerElement=60,gn(oc,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Qc extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w,E,M,k,F,U,W,V,Q,ie,se,te,we,Oe,me,Ae,Ee,Re,lt,tt,wt,jt,ht,Tt,At,Et){const Vt=this.length;return this.resize(Vt+1),this.emplace(Vt,o,l,p,y,w,E,M,k,F,U,W,V,Q,ie,se,te,we,Oe,me,Ae,Ee,Re,lt,tt,wt,jt,ht,Tt,At,Et)}emplace(o,l,p,y,w,E,M,k,F,U,W,V,Q,ie,se,te,we,Oe,me,Ae,Ee,Re,lt,tt,wt,jt,ht,Tt,At,Et,Vt){const ot=38*o,tn=19*o;return this.int16[ot+0]=l,this.int16[ot+1]=p,this.int16[ot+2]=y,this.float32[tn+2]=w,this.float32[tn+3]=E,this.int16[ot+8]=M,this.int16[ot+9]=k,this.int16[ot+10]=F,this.int16[ot+11]=U,this.int16[ot+12]=W,this.int16[ot+13]=V,this.uint16[ot+14]=Q,this.uint16[ot+15]=ie,this.uint16[ot+16]=se,this.uint16[ot+17]=te,this.uint16[ot+18]=we,this.uint16[ot+19]=Oe,this.uint16[ot+20]=me,this.uint16[ot+21]=Ae,this.uint16[ot+22]=Ee,this.uint16[ot+23]=Re,this.uint16[ot+24]=lt,this.uint16[ot+25]=tt,this.uint16[ot+26]=wt,this.uint16[ot+27]=jt,this.uint16[ot+28]=ht,this.uint32[tn+15]=Tt,this.float32[tn+16]=At,this.float32[tn+17]=Et,this.float32[tn+18]=Vt,o}}Qc.prototype.bytesPerElement=76,gn(Qc,"StructArrayLayout3i2f6i15ui1ul3f76");class Wr extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.float32[1*o+0]=l,o}}Wr.prototype.bytesPerElement=4,gn(Wr,"StructArrayLayout1f4");class Ys extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,p,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,p,y,w)}emplace(o,l,p,y,w,E){const M=5*o;return this.float32[M+0]=l,this.float32[M+1]=p,this.float32[M+2]=y,this.float32[M+3]=w,this.float32[M+4]=E,o}}Ys.prototype.bytesPerElement=20,gn(Ys,"StructArrayLayout5f20");class ma extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,p,y){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,p,y)}emplace(o,l,p,y,w){const E=6*o;return this.uint32[3*o+0]=l,this.uint16[E+2]=p,this.uint16[E+3]=y,this.uint16[E+4]=w,o}}ma.prototype.bytesPerElement=12,gn(ma,"StructArrayLayout1ul3ui12");class Al extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l){const p=this.length;return this.resize(p+1),this.emplace(p,o,l)}emplace(o,l,p){const y=2*o;return this.uint16[y+0]=l,this.uint16[y+1]=p,o}}Al.prototype.bytesPerElement=4,gn(Al,"StructArrayLayout2ui4");class el extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint16[1*o+0]=l,o}}el.prototype.bytesPerElement=2,gn(el,"StructArrayLayout1ui2");class go extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l){const p=this.length;return this.resize(p+1),this.emplace(p,o,l)}emplace(o,l,p){const y=2*o;return this.float32[y+0]=l,this.float32[y+1]=p,o}}go.prototype.bytesPerElement=8,gn(go,"StructArrayLayout2f8");class sc extends _n{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}sc.prototype.size=40;class us extends Yi{get(o){return new sc(this,o)}}gn(us,"CollisionBoxArray");class Th extends _n{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}Th.prototype.size=60;class qp extends oc{get(o){return new Th(this,o)}}gn(qp,"PlacedSymbolArray");class Zp extends _n{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(o){this._structArray.uint32[this._pos4+15]=o}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Zp.prototype.size=76;class ds extends Qc{get(o){return new Zp(this,o)}}gn(ds,"SymbolInstanceArray");class zu extends Wr{getoffsetX(o){return this.float32[1*o+0]}}gn(zu,"GlyphOffsetArray");class Ih extends Vn{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}gn(Ih,"SymbolLineVertexArray");class kf extends _n{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}kf.prototype.size=12;class Wp extends ma{get(o){return new kf(this,o)}}gn(Wp,"FeatureIndexArray");class Sh extends Al{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}gn(Sh,"FillExtrusionCentroidArray");const Bu=yn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),qi=yn([{name:"a_dash",components:4,type:"Uint16"}]);var Pl={},S_={get exports(){return Pl},set exports(a){Pl=a}},ac={};({get exports(){return ac},set exports(a){ac=a}}).exports=function(a,o){var l,p,y,w,E,M,k,F;for(p=a.length-(l=3&a.length),y=o,E=3432918353,M=461845907,F=0;F<p;)k=255&a.charCodeAt(F)|(255&a.charCodeAt(++F))<<8|(255&a.charCodeAt(++F))<<16|(255&a.charCodeAt(++F))<<24,++F,y=27492+(65535&(w=5*(65535&(y=(y^=k=(65535&(k=(k=(65535&k)*E+(((k>>>16)*E&65535)<<16)&4294967295)<<15|k>>>17))*M+(((k>>>16)*M&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(k=0,l){case 3:k^=(255&a.charCodeAt(F+2))<<16;case 2:k^=(255&a.charCodeAt(F+1))<<8;case 1:y^=k=(65535&(k=(k=(65535&(k^=255&a.charCodeAt(F)))*E+(((k>>>16)*E&65535)<<16)&4294967295)<<15|k>>>17))*M+(((k>>>16)*M&65535)<<16)&4294967295}return y^=a.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0};var sg={};({get exports(){return sg},set exports(a){sg=a}}).exports=function(a,o){for(var l,p=a.length,y=o^p,w=0;p>=4;)l=1540483477*(65535&(l=255&a.charCodeAt(w)|(255&a.charCodeAt(++w))<<8|(255&a.charCodeAt(++w))<<16|(255&a.charCodeAt(++w))<<24))+((1540483477*(l>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),p-=4,++w;switch(p){case 3:y^=(255&a.charCodeAt(w+2))<<16;case 2:y^=(255&a.charCodeAt(w+1))<<8;case 1:y=1540483477*(65535&(y^=255&a.charCodeAt(w)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0};var Vu=ac,j=sg;S_.exports=Vu,Pl.murmur3=Vu,Pl.murmur2=j;class P{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,l,p,y){this.ids.push(R(o)),this.positions.push(l,p,y)}getPositions(o){const l=R(o);let p=0,y=this.ids.length-1;for(;p<y;){const E=p+y>>1;this.ids[E]>=l?y=E:p=E+1}const w=[];for(;this.ids[p]===l;)w.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return w}static serialize(o,l){const p=new Float64Array(o.ids),y=new Uint32Array(o.positions);return q(p,y,0,p.length-1),l&&l.push(p.buffer,y.buffer),{ids:p,positions:y}}static deserialize(o){const l=new P;return l.ids=o.ids,l.positions=o.positions,l.indexed=!0,l}}function R(a){const o=+a;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:Pl(String(a))}function q(a,o,l,p){for(;l<p;){const y=a[l+p>>1];let w=l-1,E=p+1;for(;;){do{w++}while(a[w]<y);do{E--}while(a[E]>y);if(w>=E)break;ce(a,w,E),ce(o,3*w,3*E),ce(o,3*w+1,3*E+1),ce(o,3*w+2,3*E+2)}E-l<p-E?(q(a,o,l,E),l=E+1):(q(a,o,E+1,p),p=E)}}function ce(a,o,l){const p=a[o];a[o]=a[l],a[l]=p}gn(P,"FeaturePositionMap");class ye{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,l),this.initialized=!0),!!this.location}}class ct extends ye{constructor(o){super(o),this.current=0}set(o,l,p){this.fetchUniformLocation(o,l)&&this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class Gt extends ye{constructor(o){super(o),this.current=[0,0,0,0]}set(o,l,p){this.fetchUniformLocation(o,l)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3])))}}class Tn extends ye{constructor(o){super(o),this.current=to.transparent}set(o,l,p){this.fetchUniformLocation(o,l)&&(p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a)))}}const ri=new Float32Array(16),zi=new Float32Array(9),_o=new Float32Array(4);function ga(a){return[dn(255*a.r,255*a.g),dn(255*a.b,255*a.a)]}class tl{constructor(o,l,p){this.value=o,this.uniformNames=l.map(y=>`u_${y}`),this.type=p}setUniform(o,l,p,y,w){l.set(o,w,y.constantOr(this.value))}getBinding(o,l){return"color"===this.type?new Tn(o):new ct(o)}}class nl{constructor(o,l){this.uniformNames=l.map(p=>`u_${p}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,l,p,y,w){const E="u_pattern"===w||"u_dash"===w?this.pattern:"u_pixel_ratio"===w?this.pixelRatio:null;E&&l.set(o,w,E)}getBinding(o,l){return"u_pattern"===l||"u_dash"===l?new Gt(o):new ct(o)}}class lc{constructor(o,l,p,y){this.expression=o,this.type=p,this.maxValue=0,this.paintVertexAttributes=l.map(w=>({name:`a_${w}`,type:"Float32",components:"color"===p?2:1,offset:0})),this.paintVertexArray=new y}populatePaintArray(o,l,p,y,w,E){const M=this.paintVertexArray.length,k=this.expression.evaluate(new We(0),l,{},w,y,E);this.paintVertexArray.resize(o),this._setPaintValue(M,o,k)}updatePaintArray(o,l,p,y,w){const E=this.expression.evaluate({zoom:0},p,y,void 0,w);this._setPaintValue(o,l,E)}_setPaintValue(o,l,p){if("color"===this.type){const y=ga(p);for(let w=o;w<l;w++)this.paintVertexArray.emplace(w,y[0],y[1])}else{for(let y=o;y<l;y++)this.paintVertexArray.emplace(y,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ra{constructor(o,l,p,y,w,E){this.expression=o,this.uniformNames=l.map(M=>`u_${M}_t`),this.type=p,this.useIntegerZoom=y,this.zoom=w,this.maxValue=0,this.paintVertexAttributes=l.map(M=>({name:`a_${M}`,type:"Float32",components:"color"===p?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(o,l,p,y,w,E){const M=this.expression.evaluate(new We(this.zoom),l,{},w,y,E),k=this.expression.evaluate(new We(this.zoom+1),l,{},w,y,E),F=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(F,o,M,k)}updatePaintArray(o,l,p,y,w){const E=this.expression.evaluate({zoom:this.zoom},p,y,void 0,w),M=this.expression.evaluate({zoom:this.zoom+1},p,y,void 0,w);this._setPaintValue(o,l,E,M)}_setPaintValue(o,l,p,y){if("color"===this.type){const w=ga(p),E=ga(y);for(let M=o;M<l;M++)this.paintVertexArray.emplace(M,w[0],w[1],E[0],E[1])}else{for(let w=o;w<l;w++)this.paintVertexArray.emplace(w,p,y);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(y))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,l,p,y,w){const E=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,M=zt(this.expression.interpolationFactor(E,this.zoom,this.zoom+1),0,1);l.set(o,w,M)}getBinding(o,l){return new ct(o)}}class Jc{constructor(o,l,p,y,w){this.expression=o,this.layerId=w,this.paintVertexAttributes=("array"===p?qi:Bu).members;for(let E=0;E<l.length;++E);this.paintVertexArray=new y}populatePaintArray(o,l,p){const y=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(y,o,l.patterns&&l.patterns[this.layerId],p)}updatePaintArray(o,l,p,y,w,E){this._setPaintValues(o,l,p.patterns&&p.patterns[this.layerId],E)}_setPaintValues(o,l,p,y){if(!y||!p)return;const w=y[p];if(!w)return;const{tl:E,br:M,pixelRatio:k}=w;for(let F=o;F<l;F++)this.paintVertexArray.emplace(F,E[0],E[1],M[0],M[1],k)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class eu{constructor(o,l,p=(()=>!0)){this.binders={},this._buffers=[];const y=[];for(const w in o.paint._values){if(!p(w))continue;const E=o.paint.get(w);if(!(E instanceof Ot&&Mu(E.property.specification)))continue;const M=Dh(w,o.type),k=E.value,F=E.property.specification.type,U=E.property.useIntegerZoom,W="line-dasharray"===w||w.endsWith("pattern"),V="line-dasharray"===w&&"constant"!==o.layout.get("line-cap").value.kind;if("constant"!==k.kind||V)if("source"===k.kind||V||W){const Q=Yp(w,F,"source");this.binders[w]=W?new Jc(k,M,F,Q,o.id):new lc(k,M,F,Q),y.push(`/a_${w}`)}else{const Q=Yp(w,F,"composite");this.binders[w]=new Ra(k,M,F,U,l,Q),y.push(`/z_${w}`)}else this.binders[w]=W?new nl(k.value,M):new tl(k.value,M,F),y.push(`/u_${w}`)}this.cacheKey=y.sort().join("")}getMaxValue(o){const l=this.binders[o];return l instanceof lc||l instanceof Ra?l.maxValue:0}populatePaintArrays(o,l,p,y,w,E){for(const M in this.binders){const k=this.binders[M];(k instanceof lc||k instanceof Ra||k instanceof Jc)&&k.populatePaintArray(o,l,p,y,w,E)}}setConstantPatternPositions(o){for(const l in this.binders){const p=this.binders[l];p instanceof nl&&p.setConstantPatternPositions(o)}}updatePaintArrays(o,l,p,y,w,E){let M=!1;for(const k in o){const F=l.getPositions(k);for(const U of F){const W=p.feature(U.index);for(const V in this.binders){const Q=this.binders[V];if((Q instanceof lc||Q instanceof Ra||Q instanceof Jc)&&!0===Q.expression.isStateDependent){const ie=y.paint.get(V);Q.expression=ie.value,Q.updatePaintArray(U.start,U.end,W,o[k],w,E),M=!0}}}}return M}defines(){const o=[];for(const l in this.binders){const p=this.binders[l];(p instanceof tl||p instanceof nl)&&o.push(...p.uniformNames.map(y=>`#define HAS_UNIFORM_${y}`))}return o}getBinderAttributes(){const o=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof lc||p instanceof Ra||p instanceof Jc)for(let y=0;y<p.paintVertexAttributes.length;y++)o.push(p.paintVertexAttributes[y].name)}return o}getBinderUniforms(){const o=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof tl||p instanceof nl||p instanceof Ra)for(const y of p.uniformNames)o.push(y)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const l=[];for(const p in this.binders){const y=this.binders[p];if(y instanceof tl||y instanceof nl||y instanceof Ra)for(const w of y.uniformNames)l.push({name:w,property:p,binding:y.getBinding(o,w)})}return l}setUniforms(o,l,p,y,w){for(const{name:E,property:M,binding:k}of p)this.binders[M].setUniform(o,k,w,y.get(M),E)}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const l=this.binders[o];(l instanceof lc||l instanceof Ra||l instanceof Jc)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(o){for(const l in this.binders){const p=this.binders[l];(p instanceof lc||p instanceof Ra||p instanceof Jc)&&p.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const l=this.binders[o];(l instanceof lc||l instanceof Ra||l instanceof Jc)&&l.destroy()}}}class cc{constructor(o,l,p=(()=>!0)){this.programConfigurations={};for(const y of o)this.programConfigurations[y.id]=new eu(y,l,p);this.needsUpload=!1,this._featureMap=new P,this._bufferOffset=0}populatePaintArrays(o,l,p,y,w,E,M){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(o,l,y,w,E,M);void 0!==l.id&&this._featureMap.add(l.id,p,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,l,p,y,w){for(const E of p)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(o,this._featureMap,l,E,y,w)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const Mh={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Dh(a,o){return Mh[a]||[a.replace(`${o}-`,"").replace(/-/g,"_")]}const Rf={"line-pattern":{source:Dr,composite:Dr},"fill-pattern":{source:Dr,composite:Dr},"fill-extrusion-pattern":{source:Dr,composite:Dr},"line-dasharray":{source:Ws,composite:Ws}},Uu={color:{source:go,composite:vi},number:{source:Wr,composite:go}};function Yp(a,o,l){const p=Rf[a];return p&&p[l]||Uu[o][l]}gn(tl,"ConstantBinder"),gn(nl,"PatternConstantBinder"),gn(lc,"SourceExpressionBinder"),gn(Jc,"PatternCompositeBinder"),gn(Ra,"CompositeExpressionBinder"),gn(eu,"ProgramConfiguration",{omit:["_buffers"]}),gn(cc,"ProgramConfigurationSet");const Ah="-transition";class Fa extends Rr{constructor(o,l){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==o.type&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,"background"!==o.type&&"sky"!==o.type&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),l.layout&&(this._unevaluatedLayout=new at(l.layout)),l.paint)){this._transitionablePaint=new Ut(l.paint);for(const p in o.paint)this.setPaintProperty(p,o.paint[p],{validate:!1});for(const p in o.layout)this.setLayoutProperty(p,o.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new et(l.paint)}}getLayoutProperty(o){return"visibility"===o?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,l,p={}){null!=l&&this._validate(Yc,`layers.${this.id}.layout.${o}`,o,l,p)||("visibility"!==o?this._unevaluatedLayout.setValue(o,l):this.visibility=l)}getPaintProperty(o){return ir(o,Ah)?this._transitionablePaint.getTransition(o.slice(0,-Ah.length)):this._transitionablePaint.getValue(o)}setPaintProperty(o,l,p={}){if(null!=l&&this._validate(Pf,`layers.${this.id}.paint.${o}`,o,l,p))return!1;if(ir(o,Ah))return this._transitionablePaint.setTransition(o.slice(0,-Ah.length),l||void 0),!1;{const y=this._transitionablePaint._values[o],w=y.value.isDataDriven(),E=y.value;this._transitionablePaint.setValue(o,l),this._handleSpecialPaintPropertyUpdate(o);const M=this._transitionablePaint._values[o].value,k=M.isDataDriven(),F=ir(o,"pattern")||"line-dasharray"===o;return k||w||F||this._handleOverridablePaintPropertyUpdate(o,E,M)}}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getProgramConfiguration(o){return null}_handleOverridablePaintPropertyUpdate(o,l,p){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||"none"===this.visibility}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,l)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),Bn(o,(l,p)=>!(void 0===l||"layout"===p&&!Object.keys(l).length||"paint"===p&&!Object.keys(l).length))}_validate(o,l,p,y,w={}){return(!w||!1!==w.validate)&&ku(this,o.call(Af,{key:l,layerType:this.type,objectKey:p,value:y,styleSpec:dt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const l=this.paint.get(o);if(l instanceof Ot&&Mu(l.property.specification)&&("source"===l.value.kind||"composite"===l.value.kind)&&l.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=qc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Ph=yn([{name:"a_pos",components:2,type:"Int16"}],4),Kb=yn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Yr{constructor(o=[]){this.segments=o}prepareSegment(o,l,p,y){let w=this.segments[this.segments.length-1];return o>Yr.MAX_VERTEX_ARRAY_LENGTH&&Ai(`Max vertices per segment is ${Yr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!w||w.vertexLength+o>Yr.MAX_VERTEX_ARRAY_LENGTH||w.sortKey!==y)&&(w={vertexOffset:l.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},void 0!==y&&(w.sortKey=y),this.segments.push(w)),w}get(){return this.segments}destroy(){for(const o of this.segments)for(const l in o.vaos)o.vaos[l].destroy()}static simpleSegment(o,l,p,y){return new Yr([{vertexOffset:o,primitiveOffset:l,vertexLength:p,primitiveLength:y,vaos:{},sortKey:0}])}}Yr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,gn(Yr,"SegmentVector");var Jn=8192;class uc{constructor(o,l){o&&(l?this.setSouthWest(o).setNorthEast(l):4===o.length?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))}setNorthEast(o){return this._ne=o instanceof tr?new tr(o.lng,o.lat):tr.convert(o),this}setSouthWest(o){return this._sw=o instanceof tr?new tr(o.lng,o.lat):tr.convert(o),this}extend(o){const l=this._sw,p=this._ne;let y,w;if(o instanceof tr)y=o,w=o;else{if(!(o instanceof uc))return Array.isArray(o)?4===o.length||o.every(Array.isArray)?this.extend(uc.convert(o)):this.extend(tr.convert(o)):"object"==typeof o&&null!==o&&o.hasOwnProperty("lat")&&o.hasOwnProperty("lon")?this.extend(tr.convert(o)):this;if(y=o._sw,w=o._ne,!y||!w)return this}return l||p?(l.lng=Math.min(y.lng,l.lng),l.lat=Math.min(y.lat,l.lat),p.lng=Math.max(w.lng,p.lng),p.lat=Math.max(w.lat,p.lat)):(this._sw=new tr(y.lng,y.lat),this._ne=new tr(w.lng,w.lat)),this}getCenter(){return new tr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new tr(this.getWest(),this.getNorth())}getSouthEast(){return new tr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:l,lat:p}=tr.convert(o);let y=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&y}static convert(o){return!o||o instanceof uc?o:new uc(o)}}var Oh=1e-6,La=typeof Float32Array<"u"?Float32Array:Array;function M_(){var a=new La(9);return La!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function kh(a,o,l){var p=o[0],y=o[1],w=o[2],E=o[3],M=o[4],k=o[5],F=o[6],U=o[7],W=o[8],V=l[0],Q=l[1],ie=l[2],se=l[3],te=l[4],we=l[5],Oe=l[6],me=l[7],Ae=l[8];return a[0]=V*p+Q*E+ie*F,a[1]=V*y+Q*M+ie*U,a[2]=V*w+Q*k+ie*W,a[3]=se*p+te*E+we*F,a[4]=se*y+te*M+we*U,a[5]=se*w+te*k+we*W,a[6]=Oe*p+me*E+Ae*F,a[7]=Oe*y+me*M+Ae*U,a[8]=Oe*w+me*k+Ae*W,a}function dc(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function ag(a,o){var l=o[0],p=o[1],y=o[2],w=o[3],E=o[4],M=o[5],k=o[6],F=o[7],U=o[8],W=o[9],V=o[10],Q=o[11],ie=o[12],se=o[13],te=o[14],we=o[15],Oe=l*M-p*E,me=l*k-y*E,Ae=l*F-w*E,Ee=p*k-y*M,Re=p*F-w*M,lt=y*F-w*k,tt=U*se-W*ie,wt=U*te-V*ie,jt=U*we-Q*ie,ht=W*te-V*se,Tt=W*we-Q*se,At=V*we-Q*te,Et=Oe*At-me*Tt+Ae*ht+Ee*jt-Re*wt+lt*tt;return Et?(a[0]=(M*At-k*Tt+F*ht)*(Et=1/Et),a[1]=(y*Tt-p*At-w*ht)*Et,a[2]=(se*lt-te*Re+we*Ee)*Et,a[3]=(V*Re-W*lt-Q*Ee)*Et,a[4]=(k*jt-E*At-F*wt)*Et,a[5]=(l*At-y*jt+w*wt)*Et,a[6]=(te*Ae-ie*lt-we*me)*Et,a[7]=(U*lt-V*Ae+Q*me)*Et,a[8]=(E*Tt-M*jt+F*tt)*Et,a[9]=(p*jt-l*Tt-w*tt)*Et,a[10]=(ie*Re-se*Ae+we*Oe)*Et,a[11]=(W*Ae-U*Re-Q*Oe)*Et,a[12]=(M*wt-E*ht-k*tt)*Et,a[13]=(l*ht-p*wt+y*tt)*Et,a[14]=(se*me-ie*Ee-te*Oe)*Et,a[15]=(U*Ee-W*me+V*Oe)*Et,a):null}function Md(a,o,l){var p=o[0],y=o[1],w=o[2],E=o[3],M=o[4],k=o[5],F=o[6],U=o[7],W=o[8],V=o[9],Q=o[10],ie=o[11],se=o[12],te=o[13],we=o[14],Oe=o[15],me=l[0],Ae=l[1],Ee=l[2],Re=l[3];return a[0]=me*p+Ae*M+Ee*W+Re*se,a[1]=me*y+Ae*k+Ee*V+Re*te,a[2]=me*w+Ae*F+Ee*Q+Re*we,a[3]=me*E+Ae*U+Ee*ie+Re*Oe,a[4]=(me=l[4])*p+(Ae=l[5])*M+(Ee=l[6])*W+(Re=l[7])*se,a[5]=me*y+Ae*k+Ee*V+Re*te,a[6]=me*w+Ae*F+Ee*Q+Re*we,a[7]=me*E+Ae*U+Ee*ie+Re*Oe,a[8]=(me=l[8])*p+(Ae=l[9])*M+(Ee=l[10])*W+(Re=l[11])*se,a[9]=me*y+Ae*k+Ee*V+Re*te,a[10]=me*w+Ae*F+Ee*Q+Re*we,a[11]=me*E+Ae*U+Ee*ie+Re*Oe,a[12]=(me=l[12])*p+(Ae=l[13])*M+(Ee=l[14])*W+(Re=l[15])*se,a[13]=me*y+Ae*k+Ee*V+Re*te,a[14]=me*w+Ae*F+Ee*Q+Re*we,a[15]=me*E+Ae*U+Ee*ie+Re*Oe,a}function Rh(a,o,l){var p,y,w,E,M,k,F,U,W,V,Q,ie,se=l[0],te=l[1],we=l[2];return o===a?(a[12]=o[0]*se+o[4]*te+o[8]*we+o[12],a[13]=o[1]*se+o[5]*te+o[9]*we+o[13],a[14]=o[2]*se+o[6]*te+o[10]*we+o[14],a[15]=o[3]*se+o[7]*te+o[11]*we+o[15]):(y=o[1],w=o[2],E=o[3],M=o[4],k=o[5],F=o[6],U=o[7],W=o[8],V=o[9],Q=o[10],ie=o[11],a[0]=p=o[0],a[1]=y,a[2]=w,a[3]=E,a[4]=M,a[5]=k,a[6]=F,a[7]=U,a[8]=W,a[9]=V,a[10]=Q,a[11]=ie,a[12]=p*se+M*te+W*we+o[12],a[13]=y*se+k*te+V*we+o[13],a[14]=w*se+F*te+Q*we+o[14],a[15]=E*se+U*te+ie*we+o[15]),a}function hc(a,o,l){var p=l[0],y=l[1],w=l[2];return a[0]=o[0]*p,a[1]=o[1]*p,a[2]=o[2]*p,a[3]=o[3]*p,a[4]=o[4]*y,a[5]=o[5]*y,a[6]=o[6]*y,a[7]=o[7]*y,a[8]=o[8]*w,a[9]=o[9]*w,a[10]=o[10]*w,a[11]=o[11]*w,a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],a}function Dd(a,o,l){var p=Math.sin(l),y=Math.cos(l),w=o[4],E=o[5],M=o[6],k=o[7],F=o[8],U=o[9],W=o[10],V=o[11];return o!==a&&(a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[4]=w*y+F*p,a[5]=E*y+U*p,a[6]=M*y+W*p,a[7]=k*y+V*p,a[8]=F*y-w*p,a[9]=U*y-E*p,a[10]=W*y-M*p,a[11]=V*y-k*p,a}function Kp(a,o,l){var p=Math.sin(l),y=Math.cos(l),w=o[0],E=o[1],M=o[2],k=o[3],F=o[8],U=o[9],W=o[10],V=o[11];return o!==a&&(a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=w*y-F*p,a[1]=E*y-U*p,a[2]=M*y-W*p,a[3]=k*y-V*p,a[8]=w*p+F*y,a[9]=E*p+U*y,a[10]=M*p+W*y,a[11]=k*p+V*y,a}function Xp(a,o){return a[0]=o[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=o[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=o[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function D_(a,o,l){var p,y,w,E=l[0],M=l[1],k=l[2],F=Math.hypot(E,M,k);return F<Oh?null:(E*=F=1/F,M*=F,k*=F,p=Math.sin(o),y=Math.cos(o),a[0]=E*E*(w=1-y)+y,a[1]=M*E*w+k*p,a[2]=k*E*w-M*p,a[3]=0,a[4]=E*M*w-k*p,a[5]=M*M*w+y,a[6]=k*M*w+E*p,a[7]=0,a[8]=E*k*w+M*p,a[9]=M*k*w-E*p,a[10]=k*k*w+y,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}Math.hypot||(Math.hypot=function(){for(var a=0,o=arguments.length;o--;)a+=arguments[o]*arguments[o];return Math.sqrt(a)});var Qp=Md;function A_(){var a=new La(3);return La!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function Ff(a){var o=new La(3);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o}function il(a){return Math.hypot(a[0],a[1],a[2])}function Fh(a,o,l){var p=new La(3);return p[0]=a,p[1]=o,p[2]=l,p}function Na(a,o,l){return a[0]=o[0]+l[0],a[1]=o[1]+l[1],a[2]=o[2]+l[2],a}function Lf(a,o,l){return a[0]=o[0]-l[0],a[1]=o[1]-l[1],a[2]=o[2]-l[2],a}function Jp(a,o,l){return a[0]=o[0]*l[0],a[1]=o[1]*l[1],a[2]=o[2]*l[2],a}function ju(a,o,l){return a[0]=Math.min(o[0],l[0]),a[1]=Math.min(o[1],l[1]),a[2]=Math.min(o[2],l[2]),a}function Nf(a,o,l){return a[0]=Math.max(o[0],l[0]),a[1]=Math.max(o[1],l[1]),a[2]=Math.max(o[2],l[2]),a}function Gs(a,o,l){return a[0]=o[0]*l,a[1]=o[1]*l,a[2]=o[2]*l,a}function lg(a,o,l,p){return a[0]=o[0]+l[0]*p,a[1]=o[1]+l[1]*p,a[2]=o[2]+l[2]*p,a}function _a(a,o){var l=o[0],p=o[1],y=o[2],w=l*l+p*p+y*y;return w>0&&(w=1/Math.sqrt(w)),a[0]=o[0]*w,a[1]=o[1]*w,a[2]=o[2]*w,a}function tu(a,o){return a[0]*o[0]+a[1]*o[1]+a[2]*o[2]}function Pv(a,o,l){var p=o[0],y=o[1],w=o[2],E=l[0],M=l[1],k=l[2];return a[0]=y*k-w*M,a[1]=w*E-p*k,a[2]=p*M-y*E,a}function yo(a,o,l){var p=o[0],y=o[1],w=o[2],E=l[3]*p+l[7]*y+l[11]*w+l[15];return a[0]=(l[0]*p+l[4]*y+l[8]*w+l[12])/(E=E||1),a[1]=(l[1]*p+l[5]*y+l[9]*w+l[13])/E,a[2]=(l[2]*p+l[6]*y+l[10]*w+l[14])/E,a}function Xb(a,o,l){var p=l[0],y=l[1],w=l[2],E=o[0],M=o[1],k=o[2],F=y*k-w*M,U=w*E-p*k,W=p*M-y*E,V=y*W-w*U,Q=w*F-p*W,ie=p*U-y*F,se=2*l[3];return U*=se,W*=se,Q*=2,ie*=2,a[0]=E+(F*=se)+(V*=2),a[1]=M+U+Q,a[2]=k+W+ie,a}var em,rl=Lf,P_=Jp,Ov=il;function kv(a,o,l){return a[0]=o[0]*l,a[1]=o[1]*l,a[2]=o[2]*l,a[3]=o[3]*l,a}function Rv(a,o){var l=o[0],p=o[1],y=o[2],w=o[3],E=l*l+p*p+y*y+w*w;return E>0&&(E=1/Math.sqrt(E)),a[0]=l*E,a[1]=p*E,a[2]=y*E,a[3]=w*E,a}function Ol(a,o,l){var p=o[0],y=o[1],w=o[2],E=o[3];return a[0]=l[0]*p+l[4]*y+l[8]*w+l[12]*E,a[1]=l[1]*p+l[5]*y+l[9]*w+l[13]*E,a[2]=l[2]*p+l[6]*y+l[10]*w+l[14]*E,a[3]=l[3]*p+l[7]*y+l[11]*w+l[15]*E,a}function Qb(){var a=new La(4);return La!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function Jb(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function Fv(a,o,l){l*=.5;var p=o[0],y=o[1],w=o[2],E=o[3],M=Math.sin(l),k=Math.cos(l);return a[0]=p*k+E*M,a[1]=y*k+w*M,a[2]=w*k-y*M,a[3]=E*k-p*M,a}function O_(a,o,l){l*=.5;var p=o[0],y=o[1],w=o[2],E=o[3],M=Math.sin(l),k=Math.cos(l);return a[0]=p*k-w*M,a[1]=y*k+E*M,a[2]=w*k+p*M,a[3]=E*k-y*M,a}A_(),em=new La(4),La!=Float32Array&&(em[0]=0,em[1]=0,em[2]=0,em[3]=0);var Lv=Rv;A_(),Fh(1,0,0),Fh(0,1,0),Qb(),Qb(),M_();const Ks=yn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:fc}=Ks,Nv=yn([{name:"a_pos_3",components:3,type:"Int16"}]);var tm=yn([{name:"a_pos",type:"Int16",components:2}]);class zv{constructor(o,l){this.pos=o,this.dir=l}intersectsPlane(o,l,p){const y=tu(l,this.dir);if(Math.abs(y)<1e-6)return!1;const w=((o[0]-this.pos[0])*l[0]+(o[1]-this.pos[1])*l[1]+(o[2]-this.pos[2])*l[2])/y;return p[0]=this.pos[0]+this.dir[0]*w,p[1]=this.pos[1]+this.dir[1]*w,p[2]=this.pos[2]+this.dir[2]*w,!0}closestPointOnSphere(o,l,p){if(se=(Q=this.pos)[0],te=Q[1],we=Q[2],Oe=(ie=o)[0],me=ie[1],Ae=ie[2],Math.abs(se-Oe)<=Oh*Math.max(1,Math.abs(se),Math.abs(Oe))&&Math.abs(te-me)<=Oh*Math.max(1,Math.abs(te),Math.abs(me))&&Math.abs(we-Ae)<=Oh*Math.max(1,Math.abs(we),Math.abs(Ae))||0===l)return p[0]=p[1]=p[2]=0,!1;var Q,ie,se,te,we,Oe,me,Ae;const[y,w,E]=this.dir,M=this.pos[0]-o[0],k=this.pos[1]-o[1],F=this.pos[2]-o[2],U=y*y+w*w+E*E,W=2*(M*y+k*w+F*E),V=W*W-4*U*(M*M+k*k+F*F-l*l);if(V<0){const Q=Math.max(-W/2,0),ie=M+y*Q,se=k+w*Q,te=F+E*Q,we=Math.hypot(ie,se,te);return p[0]=ie*l/we,p[1]=se*l/we,p[2]=te*l/we,!1}{const Q=(-W-Math.sqrt(V))/(2*U);if(Q<0){const ie=Math.hypot(M,k,F);return p[0]=M*l/ie,p[1]=k*l/ie,p[2]=F*l/ie,!1}return p[0]=M+y*Q,p[1]=k+w*Q,p[2]=F+E*Q,!0}}}class Lh{constructor(o,l,p,y,w){this.TL=o,this.TR=l,this.BR=p,this.BL=y,this.horizon=w}static fromInvProjectionMatrix(o,l,p){const y=[-1,1,1],w=[1,1,1],E=[1,-1,1],M=[-1,-1,1],k=yo(y,y,o),F=yo(w,w,o),U=yo(E,E,o),W=yo(M,M,o);return new Lh(k,F,U,W,l/p)}}class k_{constructor(o,l){this.points=o,this.planes=l}static fromInvProjectionMatrix(o,l,p,y){const w=Math.pow(2,p),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const F=Ol([],k,o),U=1/F[3]/l*w;return(W=F)[0]=(V=F)[0]*(Q=[U,U,y?1/F[3]:U,U])[0],W[1]=V[1]*Q[1],W[2]=V[2]*Q[2],W[3]=V[3]*Q[3],W;var W,V,Q}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const F=_a([],Pv([],rl([],E[k[0]],E[k[1]]),rl([],E[k[2]],E[k[1]]))),U=-tu(F,E[k[1]]);return F.concat(U)});return new k_(E,M)}}class ya{static fromPoints(o){const l=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0];for(const y of o)ju(l,l,y),Nf(p,p,y);return new ya(l,p)}static applyTransform(o,l){const p=o.getCorners();for(let y=0;y<p.length;++y)yo(p[y],p[y],l);return ya.fromPoints(p)}constructor(o,l){this.min=o,this.max=l,this.center=Gs([],Na([],this.min,this.max),.5)}quadrant(o){const l=[o%2==0,o<2],p=Ff(this.min),y=Ff(this.max);for(let w=0;w<l.length;w++)p[w]=l[w]?this.min[w]:this.center[w],y[w]=l[w]?this.center[w]:this.max[w];return y[2]=this.max[2],new ya(p,y)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,l=this.max;return[[o[0],o[1],o[2]],[l[0],o[1],o[2]],[l[0],l[1],o[2]],[o[0],l[1],o[2]],[o[0],o[1],l[2]],[l[0],o[1],l[2]],[l[0],l[1],l[2]],[o[0],l[1],l[2]]]}intersects(o){const l=this.getCorners();let p=!0;for(let y=0;y<o.planes.length;y++){const w=o.planes[y];let E=0;for(let M=0;M<l.length;M++)E+=tu(w,l[M])+w[3]>=0;if(0===E)return 0;E!==l.length&&(p=!1)}if(p)return 2;for(let y=0;y<3;y++){let w=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let M=0;M<o.points.length;M++){const k=o.points[M][y]-this.min[y];w=Math.min(w,k),E=Math.max(E,k)}if(E<0||w>this.max[y]-this.min[y])return 0}return 1}}const ol=Jn/Math.PI/2,zf=[64,32,16],kl=-ol,sl=ol,nm=[new ya([kl,kl,kl],[sl,sl,sl]),new ya([kl,kl,kl],[0,0,sl]),new ya([0,kl,kl],[sl,0,sl]),new ya([kl,0,kl],[0,sl,sl]),new ya([0,0,kl],[sl,sl,sl])];function pc(a){return a*ol/Ad}function $u(a,o,l,p=!0){const y=Gs([],a._camera.position,a.worldSize),w=[o,l,1,1];Ol(w,w,a.pixelMatrixInverse),kv(w,w,1/w[3]);const E=_a([],rl([],w,y)),M=a.globeMatrix,k=[M[12],M[13],M[14]],F=rl([],k,y),U=il(F),W=_a([],F),V=a.worldSize/(2*Math.PI),Q=tu(W,E),ie=Math.asin(V/U);if(ie<Math.acos(Q)){if(!p)return null;const jt=[],ht=[];Gs(jt,E,U/Q),_a(ht,rl(ht,jt,F)),_a(E,Na(E,F,Gs(E,ht,Math.tan(ie)*U)))}const se=[];new zv(y,E).closestPointOnSphere(k,V,se);const te=_a([],gs(M,0)),we=_a([],gs(M,1)),Oe=_a([],gs(M,2)),me=tu(te,se),Ae=tu(we,se),Ee=tu(Oe,se),Re=Pt(Math.asin(-Ae/V));let lt=Pt(Math.atan2(me,Ee));lt=a.center.lng+function(jt,ht){const Tt=(ht-jt+180)%360-180;return Tt<-180?Tt+360:Tt}(a.center.lng,lt);const tt=Hu(lt),wt=zt(qu(Re),0,1);return new jf(tt,wt)}class ex{constructor(o,l,p){this.a=rl([],o,p),this.b=rl([],l,p),this.center=p;const y=_a([],this.a),w=_a([],this.b);this.angle=Math.acos(tu(y,w))}}function R_(a,o){if(0===a.angle)return null;let l;return l=0===a.a[o]?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[o]/a.a[o]/Math.sin(a.angle)-1/Math.tan(a.angle)),l<0||l>1?null:function(p,y,w,E){const M=Math.sin(w);return p*(Math.sin((1-E)*w)/M)+y*(Math.sin(E*w)/M)}(a.a[o],a.b[o],a.angle,zt(l,0,1))+a.center[o]}function Rl(a){if(a.z<=1)return nm[a.z+2*a.y+a.x];const o=rm(im(a));return ya.fromPoints(o)}function Bf(a,o,l){return Gs(a,a,1-l),lg(a,a,o,l)}function tx(a,o){const l=sm(o.zoom);if(0===l)return Rl(a);const p=im(a),y=rm(p),w=Hu(p.getWest())*o.worldSize,E=Hu(p.getEast())*o.worldSize,M=qu(p.getNorth())*o.worldSize,k=qu(p.getSouth())*o.worldSize,F=[w,M,0],U=[E,M,0],W=[w,k,0],V=[E,k,0],Q=ag([],o.globeMatrix);return yo(F,F,Q),yo(U,U,Q),yo(W,W,Q),yo(V,V,Q),y[0]=Bf(y[0],W,l),y[1]=Bf(y[1],V,l),y[2]=Bf(y[2],U,l),y[3]=Bf(y[3],F,l),ya.fromPoints(y)}function nx(a,o,l){for(const p of a)yo(p,p,o),Gs(p,p,l)}function im({x:a,y:o,z:l}){const p=1/(1<<l),y=new tr(za(a*p),Xs((o+1)*p)),w=new tr(za((a+1)*p),Xs(o*p));return new uc(y,w)}function rm(a){const o=xt(a.getNorth()),l=xt(a.getSouth()),p=Math.cos(o),y=Math.cos(l),w=Math.sin(o),E=Math.sin(l),M=a.getWest(),k=a.getEast();return[zh(y,E,M),zh(y,E,k),zh(p,w,k),zh(p,w,M)]}function zh(a,o,l,p=ol){return l=xt(l),[a*Math.sin(l)*p,-o*p,a*Math.cos(l)*p]}function Gu(a,o,l){return zh(Math.cos(xt(a)),Math.sin(xt(a)),o,l)}function cg(a,o,l,p){const y=1<<l.z,w=(a/Jn+l.x)/y;return Gu(Xs((o/Jn+l.y)/y),za(w),p)}function L_({min:a,max:o}){return 16383/Math.max(o[0]-a[0],o[1]-a[1],o[2]-a[2])}const ug=new Float64Array(16);function om(a){const o=L_(a),l=Xp(ug,[o,o,o]);return Rh(l,l,((p=[])[0]=-(y=a.min)[0],p[1]=-y[1],p[2]=-y[2],p));var p,y}function Bv(a){const o=(p=a.min,(l=ug)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=p[0],l[13]=p[1],l[14]=p[2],l[15]=1,l);var l,p;const y=1/L_(a);return hc(o,o,[y,y,y])}function N_(a,o,l,p,y){const w=function(k){const F=Jn/(2*Math.PI);return k/(2*Math.PI)/F}(l),E=[a,o,-l/(2*Math.PI)],M=dc(new Float64Array(16));return Rh(M,M,E),hc(M,M,[w,w,w]),Dd(M,M,xt(-y)),Kp(M,M,xt(-p)),M}function sm(a){return an(5,6,a)}function Vv(a,o){const l=Gu(o.lat,o.lng);return E=(y=Lf([],function(ie){const se=Gu(ie._center.lat,ie._center.lng);let te=Pv([],Fh(0,1,0),se);const we=D_([],-ie.angle,se);te=yo(te,te,we),D_(we,-ie._pitch,te);const Oe=_a([],se);return Gs(Oe,Oe,pc(ie.cameraToCenterDistance/ie.pixelsPerMeter)),yo(Oe,Oe,we),Na([],se,Oe)}(a),l))[0],M=y[1],k=y[2],F=(w=l)[0],U=w[1],W=w[2],Q=(V=Math.sqrt(E*E+M*M+k*k)*Math.sqrt(F*F+U*U+W*W))&&tu(y,w)/V,Math.acos(Math.min(Math.max(Q,-1),1));var y,w,E,M,k,F,U,W,V,Q}function dg(a,o){return Vv(a,o)>Math.PI/2*1.01}const es=xt(85),ix=Math.cos(es),z1=Math.sin(es),Ad=6371008.8,al=2*Math.PI*Ad;class tr{constructor(o,l){if(isNaN(o)||isNaN(l))throw new Error(`Invalid LngLat object: (${o}, ${l})`);if(this.lng=+o,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new tr(si(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const l=Math.PI/180,p=this.lat*l,y=o.lat*l,w=Math.sin(p)*Math.sin(y)+Math.cos(p)*Math.cos(y)*Math.cos((o.lng-this.lng)*l);return Ad*Math.acos(Math.min(w,1))}toBounds(o=0){const l=360*o/40075017,p=l/Math.cos(Math.PI/180*this.lat);return new uc(new tr(this.lng-p,this.lat-l),new tr(this.lng+p,this.lat+l))}toEcef(o){const l=pc(o);return Gu(this.lat,this.lng,ol+l)}static convert(o){if(o instanceof tr)return o;if(Array.isArray(o)&&(2===o.length||3===o.length))return new tr(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&"object"==typeof o&&null!==o)return new tr(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function Vf(a){return al*Math.cos(a*Math.PI/180)}function Hu(a){return(180+a)/360}function qu(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Fl(a,o){return a/Vf(o)}function za(a){return 360*a-180}function Xs(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function am(a,o){return a*Vf(Xs(o))}const So=85.051129;function Uf(a){return 1/Math.cos(a*Math.PI/180)}class jf{constructor(o,l,p=0){this.x=+o,this.y=+l,this.z=+p}static fromLngLat(o,l=0){const p=tr.convert(o);return new jf(Hu(p.lng),qu(p.lat),Fl(l,p.lat))}toLngLat(){return new tr(za(this.x),Xs(this.y))}toAltitude(){return am(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/al*Uf(Xs(this.y))}}function z_(a,o,l,p,y,w,E,M,k){const F=(o+p)/2,U=(l+y)/2,W=new Ye(F,U);M(W),function(V,Q,ie,se,te,we){const Oe=ie-te,me=se-we;return Math.abs((se-Q)*Oe-(ie-V)*me)/Math.hypot(Oe,me)}(W.x,W.y,w.x,w.y,E.x,E.y)>=k?(z_(a,o,l,F,U,w,W,M,k),z_(a,F,U,p,y,W,E,M,k)):a.push(E)}function hg(a,o,l){let p=a[0],y=p.x,w=p.y;o(p);const E=[p];for(let M=1;M<a.length;M++){const k=a[M],{x:F,y:U}=k;o(k),z_(E,y,w,F,U,p,k,o,l),y=F,w=U,p=k}return E}function $f(a,o,l,p){if(p(o,l)){const y=o.add(l)._mult(.5);$f(a,o,y,p),$f(a,y,l,p)}else a.push(l)}function rx(a,o){let l=a[0];const p=[l];for(let y=1;y<a.length;y++){const w=a[y];$f(p,l,w,o),l=w}return p}const B_=Math.pow(2,14)-1,V_=-B_-1;function $T(a,o){const l=Math.round(a.x*o),p=Math.round(a.y*o);return a.x=zt(l,V_,B_),a.y=zt(p,V_,B_),(l<a.x||l>a.x+1||p<a.y||p>a.y+1)&&Ai("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function nu(a,o,l){const p=a.loadGeometry(),y=a.extent,w=Jn/y;if(o&&l&&l.projection.isReprojectedInTileSpace){const E=1<<o.z,{scale:M,x:k,y:F,projection:U}=l,W=V=>{const Q=za((o.x+V.x/y)/E),ie=Xs((o.y+V.y/y)/E),se=U.project(Q,ie);V.x=(se.x*M-k)*y,V.y=(se.y*M-F)*y};for(let V=0;V<p.length;V++)if(1!==a.type)p[V]=hg(p[V],W,1);else{const Q=[];for(const ie of p[V])ie.x<0||ie.x>=y||ie.y<0||ie.y>=y||(W(ie),Q.push(ie));p[V]=Q}}for(const E of p)for(const M of E)$T(M,w);return p}function Gf(a,o){return{type:a.type,id:a.id,properties:a.properties,geometry:o?nu(a):[]}}function fg(a,o,l,p,y){a.emplaceBack(2*o+(p+1)/2,2*l+(y+1)/2)}function pg(a,o,l){a.emplaceBack(o.x,o.y,o.z,16384*l[0],16384*l[1],16384*l[2])}class lm{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new Vn,this.indexArray=new mo,this.segments=new Yr,this.programConfigurations=new cc(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(o,l,p,y){const w=this.layers[0],E=[];let M=null;"circle"===w.type&&(M=w.layout.get("circle-sort-key"));for(const{feature:F,id:U,index:W,sourceLayerIndex:V}of o){const Q=this.layers[0]._featureFilter.needGeometry,ie=Gf(F,Q);if(!this.layers[0]._featureFilter.filter(new We(this.zoom),ie,p))continue;const se=M?M.evaluate(ie,{},p):void 0,te={id:U,properties:F.properties,type:F.type,sourceLayerIndex:V,index:W,geometry:Q?ie.geometry:nu(F,p,y),patterns:{},sortKey:se};E.push(te)}M&&E.sort((F,U)=>F.sortKey-U.sortKey);let k=null;"globe"===y.projection.name&&(this.globeExtVertexArray=new $s,k=y.projection);for(const F of E){const{geometry:U,index:W,sourceLayerIndex:V}=F,Q=o[W].feature;this.addFeature(F,U,W,l.availableImages,p,k),l.featureIndex.insert(Q,U,W,V,this.index)}}update(o,l,p,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,p,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Ph.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Kb.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,l,p,y,w,E){for(const M of l)for(const k of M){const F=k.x,U=k.y;if(F<0||F>=Jn||U<0||U>=Jn)continue;if(E){const Q=E.projectTilePoint(F,U,w),ie=E.upVector(w,F,U),se=this.globeExtVertexArray;pg(se,Q,ie),pg(se,Q,ie),pg(se,Q,ie),pg(se,Q,ie)}const W=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),V=W.vertexLength;fg(this.layoutVertexArray,F,U,-1,-1),fg(this.layoutVertexArray,F,U,1,-1),fg(this.layoutVertexArray,F,U,1,1),fg(this.layoutVertexArray,F,U,-1,1),this.indexArray.emplaceBack(V,V+1,V+2),this.indexArray.emplaceBack(V,V+2,V+3),W.vertexLength+=4,W.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,p,{},y,w)}}function iu(a,o){for(let l=0;l<a.length;l++)if(Pd(o,a[l]))return!0;for(let l=0;l<o.length;l++)if(Pd(a,o[l]))return!0;return!!Uv(a,o)}function cm(a,o,l){return!!Pd(a,o)||!!um(o,a,l)}function U_(a,o){if(1===a.length)return $v(o,a[0]);for(let l=0;l<o.length;l++){const p=o[l];for(let y=0;y<p.length;y++)if(Pd(a,p[y]))return!0}for(let l=0;l<a.length;l++)if($v(o,a[l]))return!0;for(let l=0;l<o.length;l++)if(Uv(a,o[l]))return!0;return!1}function j_(a,o,l){if(a.length>1){if(Uv(a,o))return!0;for(let p=0;p<o.length;p++)if(um(o[p],a,l))return!0}for(let p=0;p<a.length;p++)if(um(a[p],o,l))return!0;return!1}function Uv(a,o){if(0===a.length||0===o.length)return!1;for(let l=0;l<a.length-1;l++){const p=a[l],y=a[l+1];for(let w=0;w<o.length-1;w++)if(jv(p,y,o[w],o[w+1]))return!0}return!1}function jv(a,o,l,p){return dr(a,l,p)!==dr(o,l,p)&&dr(a,o,l)!==dr(a,o,p)}function um(a,o,l){const p=l*l;if(1===o.length)return a.distSqr(o[0])<p;for(let y=1;y<o.length;y++)if(Bh(a,o[y-1],o[y])<p)return!0;return!1}function Bh(a,o,l){const p=o.distSqr(l);if(0===p)return a.distSqr(o);const y=((a.x-o.x)*(l.x-o.x)+(a.y-o.y)*(l.y-o.y))/p;return a.distSqr(y<0?o:y>1?l:l.sub(o)._mult(y)._add(o))}function $v(a,o){let l,p,y,w=!1;for(let E=0;E<a.length;E++){l=a[E];for(let M=0,k=l.length-1;M<l.length;k=M++)p=l[M],y=l[k],p.y>o.y!=y.y>o.y&&o.x<(y.x-p.x)*(o.y-p.y)/(y.y-p.y)+p.x&&(w=!w)}return w}function Pd(a,o){let l=!1;for(let p=0,y=a.length-1;p<a.length;y=p++){const w=a[p],E=a[y];w.y>o.y!=E.y>o.y&&o.x<(E.x-w.x)*(o.y-w.y)/(E.y-w.y)+w.x&&(l=!l)}return l}function ox(a,o,l,p,y){for(const E of a)if(o<=E.x&&l<=E.y&&p>=E.x&&y>=E.y)return!0;const w=[new Ye(o,l),new Ye(o,y),new Ye(p,y),new Ye(p,l)];if(a.length>2)for(const E of w)if(Pd(a,E))return!0;for(let E=0;E<a.length-1;E++)if(sx(a[E],a[E+1],w))return!0;return!1}function sx(a,o,l){const p=l[0],y=l[2];if(a.x<p.x&&o.x<p.x||a.x>y.x&&o.x>y.x||a.y<p.y&&o.y<p.y||a.y>y.y&&o.y>y.y)return!1;const w=dr(a,o,l[0]);return w!==dr(a,o,l[1])||w!==dr(a,o,l[2])||w!==dr(a,o,l[3])}function Hf(a,o,l){const p=o.paint.get(a).value;return"constant"===p.kind?p.value:l.programConfigurations.get(o.id).getMaxValue(a)}function ru(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Gv(a,o,l,p,y){if(!o[0]&&!o[1])return a;const w=Ye.convert(o)._mult(y);"viewport"===l&&w._rotate(-p);const E=[];for(let M=0;M<a.length;M++)E.push(a[M].sub(w));return E}function $_(a,o,l,p){const y=Ye.convert(a)._mult(p);return"viewport"===o&&y._rotate(-l),y}gn(lm,"CircleBucket",{omit:["layers"]});const G_=new Rt({"circle-sort-key":new Xe(dt.layout_circle["circle-sort-key"])});var Hv={paint:new Rt({"circle-radius":new Xe(dt.paint_circle["circle-radius"]),"circle-color":new Xe(dt.paint_circle["circle-color"]),"circle-blur":new Xe(dt.paint_circle["circle-blur"]),"circle-opacity":new Xe(dt.paint_circle["circle-opacity"]),"circle-translate":new qe(dt.paint_circle["circle-translate"]),"circle-translate-anchor":new qe(dt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new qe(dt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new qe(dt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Xe(dt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Xe(dt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Xe(dt.paint_circle["circle-stroke-opacity"])}),layout:G_};function ax(a,o,l,p,y,w,E,M,k){if(w&&a.queryGeometry.isAboveHorizon)return!1;w&&(k*=a.pixelToTileUnitsFactor);const F=a.tileID.canonical,U=l.projection.upVectorScale(F,l.center.lat,l.worldSize).metersToTile;for(const W of o)for(const V of W){const Q=V.add(M),ie=y&&l.elevation?l.elevation.exaggeration()*y.getElevationAt(Q.x,Q.y,!0):0,se=l.projection.projectTilePoint(Q.x,Q.y,F);if(ie>0){const me=l.projection.upVector(F,Q.x,Q.y);se.x+=me[0]*U*ie,se.y+=me[1]*U*ie,se.z+=me[2]*U*ie}const te=w?Q:lx(se.x,se.y,se.z,p),we=w?a.tilespaceRays.map(me=>B1(me,ie)):a.queryGeometry.screenGeometry,Oe=Ol([],[se.x,se.y,se.z,1],p);if(!E&&w?k*=Oe[3]/l.cameraToCenterDistance:E&&!w&&(k*=l.cameraToCenterDistance/Oe[3]),w){const me=Xs((V.y/Jn+F.y)/(1<<F.z));k/=l.projection.pixelsPerMeter(me,1)/Fl(1,me)}if(cm(we,te,k))return!0}return!1}function lx(a,o,l,p){const y=Ol([],[a,o,l,1],p);return new Ye(y[0]/y[3],y[1]/y[3])}const cx=Fh(0,0,0),mg=Fh(0,0,1);function B1(a,o){const l=A_();return cx[2]=o,a.intersectsPlane(cx,mg,l),new Ye(l[0],l[1])}class qv extends lm{}function Od(a,{width:o,height:l},p,y){if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==o*l*p)throw new RangeError("mismatched image size")}else y=new Uint8Array(o*l*p);return a.width=o,a.height=l,a.data=y,a}function gg(a,o,l){const{width:p,height:y}=o;p===a.width&&y===a.height||(kd(a,o,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,p),height:Math.min(a.height,y)},l),a.width=p,a.height=y,a.data=o.data)}function kd(a,o,l,p,y,w){if(0===y.width||0===y.height)return o;if(y.width>a.width||y.height>a.height||l.x>a.width-y.width||l.y>a.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>o.width||y.height>o.height||p.x>o.width-y.width||p.y>o.height-y.height)throw new RangeError("out of range destination coordinates for image copy");const E=a.data,M=o.data;for(let k=0;k<y.height;k++){const F=((l.y+k)*a.width+l.x)*w,U=((p.y+k)*o.width+p.x)*w;for(let W=0;W<y.width*w;W++)M[U+W]=E[F+W]}return o}gn(qv,"HeatmapBucket",{omit:["layers"]});class Qs{constructor(o,l){Od(this,o,1,l)}resize(o){gg(this,new Qs(o),1)}clone(){return new Qs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,p,y,w){kd(o,l,p,y,w,1)}}class Ba{constructor(o,l){Od(this,o,4,l)}resize(o){gg(this,new Ba(o),4)}replace(o,l){l?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new Ba({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,p,y,w){kd(o,l,p,y,w,4)}}gn(Qs,"AlphaImage"),gn(Ba,"RGBAImage");var ux={paint:new Rt({"heatmap-radius":new Xe(dt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Xe(dt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new qe(dt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mt(dt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new qe(dt.paint_heatmap["heatmap-opacity"])})};function Zv(a){const o={},l=a.resolution||256,p=a.clips?a.clips.length:1,y=a.image||new Ba({width:l,height:p}),w=(E,M,k)=>{o[a.evaluationKey]=k;const F=a.expression.evaluate(o);y.data[E+M+0]=Math.floor(255*F.r/F.a),y.data[E+M+1]=Math.floor(255*F.g/F.a),y.data[E+M+2]=Math.floor(255*F.b/F.a),y.data[E+M+3]=Math.floor(255*F.a)};if(a.clips)for(let E=0,M=0;E<p;++E,M+=4*l)for(let k=0,F=0;k<l;k++,F+=4){const U=k/(l-1),{start:W,end:V}=a.clips[E];w(M,F,W*(1-U)+V*U)}else for(let E=0,M=0;E<l;E++,M+=4)w(0,M,E/(l-1));return y}var V1={paint:new Rt({"hillshade-illumination-direction":new qe(dt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new qe(dt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new qe(dt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new qe(dt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new qe(dt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new qe(dt.paint_hillshade["hillshade-accent-color"])})};const U1=yn([{name:"a_pos",components:2,type:"Int16"}],4),{members:dx}=U1;var Vh={};function dm(a,o,l){l=l||2;var p,y,w,E,M,k,F,U=o&&o.length,W=U?o[0]*l:a.length,V=H_(a,0,W,l,!0),Q=[];if(!V||V.next===V.prev)return Q;if(U&&(V=function(se,te,we,Oe){var me,Ae,Ee,Re=[];for(me=0,Ae=te.length;me<Ae;me++)(Ee=H_(se,te[me]*Oe,me<Ae-1?te[me+1]*Oe:se.length,Oe,!1))===Ee.next&&(Ee.steiner=!0),Re.push(Wf(Ee));for(Re.sort(G1),me=0;me<Re.length;me++)we=Wv(Re[me],we);return we}(a,o,V,l)),a.length>80*l){p=w=a[0],y=E=a[1];for(var ie=l;ie<W;ie+=l)(M=a[ie])<p&&(p=M),(k=a[ie+1])<y&&(y=k),M>w&&(w=M),k>E&&(E=k);F=0!==(F=Math.max(w-p,E-y))?32767/F:0}return Zf(V,Q,l,p,y,F,0),Q}function H_(a,o,l,p,y){var w,E;if(y===Qv(a,o,l,p)>0)for(w=o;w<l;w+=p)E=Xv(w,a[w],a[w+1],E);else for(w=l-p;w>=o;w-=p)E=Xv(w,a[w],a[w+1],E);return E&&Yv(E,E.next)&&(ou(E),E=E.next),E}function qf(a,o){if(!a)return a;o||(o=a);var l,p=a;do{if(l=!1,p.steiner||!Yv(p,p.next)&&0!==Go(p.prev,p,p.next))p=p.next;else{if(ou(p),(p=o=p.prev)===p.next)break;l=!0}}while(l||p!==o);return o}function Zf(a,o,l,p,y,w,E){if(a){!E&&w&&function(U,W,V,Q){var ie=U;do{0===ie.z&&(ie.z=px(ie.x,ie.y,W,V,Q)),ie.prevZ=ie.prev,ie.nextZ=ie.next,ie=ie.next}while(ie!==U);ie.prevZ.nextZ=null,ie.prevZ=null,function(se){var te,we,Oe,me,Ae,Ee,Re,lt,tt=1;do{for(we=se,se=null,Ae=null,Ee=0;we;){for(Ee++,Oe=we,Re=0,te=0;te<tt&&(Re++,Oe=Oe.nextZ);te++);for(lt=tt;Re>0||lt>0&&Oe;)0!==Re&&(0===lt||!Oe||we.z<=Oe.z)?(me=we,we=we.nextZ,Re--):(me=Oe,Oe=Oe.nextZ,lt--),Ae?Ae.nextZ=me:se=me,me.prevZ=Ae,Ae=me;we=Oe}Ae.nextZ=null,tt*=2}while(Ee>1)}(ie)}(a,p,y,w);for(var M,k,F=a;a.prev!==a.next;)if(M=a.prev,k=a.next,w?j1(a,p,y,w):_g(a))o.push(M.i/l|0),o.push(a.i/l|0),o.push(k.i/l|0),ou(a),a=k.next,F=k.next;else if((a=k)===F){E?1===E?Zf(a=$1(qf(a),o,l),o,l,p,y,w,2):2===E&&hx(a,o,l,p,y,w):Zf(qf(a),o,l,p,y,w,1);break}}}function _g(a){var o=a.prev,l=a,p=a.next;if(Go(o,l,p)>=0)return!1;for(var y=o.x,w=l.x,E=p.x,M=o.y,k=l.y,F=p.y,U=y<w?y<E?y:E:w<E?w:E,W=M<k?M<F?M:F:k<F?k:F,V=y>w?y>E?y:E:w>E?w:E,Q=M>k?M>F?M:F:k>F?k:F,ie=p.next;ie!==o;){if(ie.x>=U&&ie.x<=V&&ie.y>=W&&ie.y<=Q&&Va(y,M,w,k,E,F,ie.x,ie.y)&&Go(ie.prev,ie,ie.next)>=0)return!1;ie=ie.next}return!0}function j1(a,o,l,p){var y=a.prev,w=a,E=a.next;if(Go(y,w,E)>=0)return!1;for(var M=y.x,k=w.x,F=E.x,U=y.y,W=w.y,V=E.y,Q=M<k?M<F?M:F:k<F?k:F,ie=U<W?U<V?U:V:W<V?W:V,se=M>k?M>F?M:F:k>F?k:F,te=U>W?U>V?U:V:W>V?W:V,we=px(Q,ie,o,l,p),Oe=px(se,te,o,l,p),me=a.prevZ,Ae=a.nextZ;me&&me.z>=we&&Ae&&Ae.z<=Oe;){if(me.x>=Q&&me.x<=se&&me.y>=ie&&me.y<=te&&me!==y&&me!==E&&Va(M,U,k,W,F,V,me.x,me.y)&&Go(me.prev,me,me.next)>=0||(me=me.prevZ,Ae.x>=Q&&Ae.x<=se&&Ae.y>=ie&&Ae.y<=te&&Ae!==y&&Ae!==E&&Va(M,U,k,W,F,V,Ae.x,Ae.y)&&Go(Ae.prev,Ae,Ae.next)>=0))return!1;Ae=Ae.nextZ}for(;me&&me.z>=we;){if(me.x>=Q&&me.x<=se&&me.y>=ie&&me.y<=te&&me!==y&&me!==E&&Va(M,U,k,W,F,V,me.x,me.y)&&Go(me.prev,me,me.next)>=0)return!1;me=me.prevZ}for(;Ae&&Ae.z<=Oe;){if(Ae.x>=Q&&Ae.x<=se&&Ae.y>=ie&&Ae.y<=te&&Ae!==y&&Ae!==E&&Va(M,U,k,W,F,V,Ae.x,Ae.y)&&Go(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.nextZ}return!0}function $1(a,o,l){var p=a;do{var y=p.prev,w=p.next.next;!Yv(y,w)&&q1(y,p,p.next,w)&&Yf(y,w)&&Yf(w,y)&&(o.push(y.i/l|0),o.push(p.i/l|0),o.push(w.i/l|0),ou(p),ou(p.next),p=a=w),p=p.next}while(p!==a);return qf(p)}function hx(a,o,l,p,y,w){var E=a;do{for(var M=E.next.next;M!==E.prev;){if(E.i!==M.i&&H1(E,M)){var k=vg(E,M);return E=qf(E,E.next),k=qf(k,k.next),Zf(E,o,l,p,y,w,0),void Zf(k,o,l,p,y,w,0)}M=M.next}E=E.next}while(E!==a)}function G1(a,o){return a.x-o.x}function Wv(a,o){var l=function(y,w){var E,M=w,k=y.x,F=y.y,U=-1/0;do{if(F<=M.y&&F>=M.next.y&&M.next.y!==M.y){var W=M.x+(F-M.y)*(M.next.x-M.x)/(M.next.y-M.y);if(W<=k&&W>U&&(U=W,E=M.x<M.next.x?M:M.next,W===k))return E}M=M.next}while(M!==w);if(!E)return null;var V,Q=E,ie=E.x,se=E.y,te=1/0;M=E;do{k>=M.x&&M.x>=ie&&k!==M.x&&Va(F<se?k:U,F,ie,se,F<se?U:k,F,M.x,M.y)&&(V=Math.abs(F-M.y)/(k-M.x),Yf(M,y)&&(V<te||V===te&&(M.x>E.x||M.x===E.x&&fx(E,M)))&&(E=M,te=V)),M=M.next}while(M!==Q);return E}(a,o);if(!l)return o;var p=vg(l,a);return qf(p,p.next),qf(l,l.next)}function fx(a,o){return Go(a.prev,a,o.prev)<0&&Go(o.next,a,a.next)<0}function px(a,o,l,p,y){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-l)*y|0)|a<<8))|a<<4))|a<<2))|a<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-p)*y|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function Wf(a){var o=a,l=a;do{(o.x<l.x||o.x===l.x&&o.y<l.y)&&(l=o),o=o.next}while(o!==a);return l}function Va(a,o,l,p,y,w,E,M){return(y-E)*(o-M)>=(a-E)*(w-M)&&(a-E)*(p-M)>=(l-E)*(o-M)&&(l-E)*(w-M)>=(y-E)*(p-M)}function H1(a,o){return a.next.i!==o.i&&a.prev.i!==o.i&&!function(l,p){var y=l;do{if(y.i!==l.i&&y.next.i!==l.i&&y.i!==p.i&&y.next.i!==p.i&&q1(y,y.next,l,p))return!0;y=y.next}while(y!==l);return!1}(a,o)&&(Yf(a,o)&&Yf(o,a)&&function(l,p){var y=l,w=!1,E=(l.x+p.x)/2,M=(l.y+p.y)/2;do{y.y>M!=y.next.y>M&&y.next.y!==y.y&&E<(y.next.x-y.x)*(M-y.y)/(y.next.y-y.y)+y.x&&(w=!w),y=y.next}while(y!==l);return w}(a,o)&&(Go(a.prev,a,o.prev)||Go(a,o.prev,o))||Yv(a,o)&&Go(a.prev,a,a.next)>0&&Go(o.prev,o,o.next)>0)}function Go(a,o,l){return(o.y-a.y)*(l.x-o.x)-(o.x-a.x)*(l.y-o.y)}function Yv(a,o){return a.x===o.x&&a.y===o.y}function q1(a,o,l,p){var y=Kv(Go(a,o,l)),w=Kv(Go(a,o,p)),E=Kv(Go(l,p,a)),M=Kv(Go(l,p,o));return y!==w&&E!==M||!(0!==y||!yg(a,l,o))||!(0!==w||!yg(a,p,o))||!(0!==E||!yg(l,a,p))||!(0!==M||!yg(l,o,p))}function yg(a,o,l){return o.x<=Math.max(a.x,l.x)&&o.x>=Math.min(a.x,l.x)&&o.y<=Math.max(a.y,l.y)&&o.y>=Math.min(a.y,l.y)}function Kv(a){return a>0?1:a<0?-1:0}function Yf(a,o){return Go(a.prev,a,a.next)<0?Go(a,o,a.next)>=0&&Go(a,a.prev,o)>=0:Go(a,o,a.prev)<0||Go(a,a.next,o)<0}function vg(a,o){var l=new bg(a.i,a.x,a.y),p=new bg(o.i,o.x,o.y),y=a.next,w=o.prev;return a.next=o,o.prev=a,l.next=y,y.prev=l,p.next=l,l.prev=p,w.next=p,p.prev=w,p}function Xv(a,o,l,p){var y=new bg(a,o,l);return p?(y.next=p.next,y.prev=p,p.next.prev=y,p.next=y):(y.prev=y,y.next=y),y}function ou(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function bg(a,o,l){this.i=a,this.x=o,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qv(a,o,l,p){for(var y=0,w=o,E=l-p;w<l;w+=p)y+=(a[E]-a[w])*(a[w+1]+a[E+1]),E=w;return y}function mc(a,o,l,p,y){xg(a,o,l||0,p||a.length-1,y||mx)}function xg(a,o,l,p,y){for(;p>l;){if(p-l>600){var w=p-l+1,E=o-l+1,M=Math.log(w),k=.5*Math.exp(2*M/3),F=.5*Math.sqrt(M*k*(w-k)/w)*(E-w/2<0?-1:1);xg(a,o,Math.max(l,Math.floor(o-E*k/w+F)),Math.min(p,Math.floor(o+(w-E)*k/w+F)),y)}var U=a[o],W=l,V=p;for(Rd(a,l,o),y(a[p],U)>0&&Rd(a,l,p);W<V;){for(Rd(a,W,V),W++,V--;y(a[W],U)<0;)W++;for(;y(a[V],U)>0;)V--}0===y(a[l],U)?Rd(a,l,V):Rd(a,++V,p),V<=o&&(l=V+1),o<=V&&(p=V-1)}}function Rd(a,o,l){var p=a[o];a[o]=a[l],a[l]=p}function mx(a,o){return a<o?-1:a>o?1:0}function q_(a,o){const l=a.length;if(l<=1)return[a];const p=[];let y,w;for(let E=0;E<l;E++){const M=Un(a[E]);0!==M&&(a[E].area=Math.abs(M),void 0===w&&(w=M<0),w===M<0?(y&&p.push(y),y=[a[E]]):y.push(a[E]))}if(y&&p.push(y),o>1)for(let E=0;E<p.length;E++)p[E].length<=o||(mc(p[E],o,1,p[E].length-1,Z1),p[E]=p[E].slice(0,o));return p}function Z1(a,o){return o.area-a.area}function Jv(a,o,l){const p=l.patternDependencies;let y=!1;for(const w of o){const E=w.paint.get(`${a}-pattern`);E.isConstant()||(y=!0);const M=E.constantOr(null);M&&(y=!0,p[M]=!0)}return y}function Z_(a,o,l,p,y){const w=y.patternDependencies;for(const E of o){const M=E.paint.get(`${a}-pattern`).value;if("constant"!==M.kind){let k=M.evaluate({zoom:p},l,{},y.availableImages);k=k&&k.name?k.name:k,w[k]=!0,l.patterns[E.id]=k}}return l}({get exports(){return Vh},set exports(a){Vh=a}}).exports=dm,Vh.default=dm,dm.deviation=function(a,o,l,p){var y=o&&o.length,w=Math.abs(Qv(a,0,y?o[0]*l:a.length,l));if(y)for(var E=0,M=o.length;E<M;E++)w-=Math.abs(Qv(a,o[E]*l,E<M-1?o[E+1]*l:a.length,l));var k=0;for(E=0;E<p.length;E+=3){var F=p[E]*l,U=p[E+1]*l,W=p[E+2]*l;k+=Math.abs((a[F]-a[W])*(a[U+1]-a[F+1])-(a[F]-a[U])*(a[W+1]-a[F+1]))}return 0===w&&0===k?0:Math.abs((k-w)/w)},dm.flatten=function(a){for(var o=a[0][0].length,l={vertices:[],holes:[],dimensions:o},p=0,y=0;y<a.length;y++){for(var w=0;w<a[y].length;w++)for(var E=0;E<o;E++)l.vertices.push(a[y][w][E]);y>0&&l.holes.push(p+=a[y-1].length)}return l};class W_{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Vn,this.indexArray=new mo,this.indexArray2=new Al,this.programConfigurations=new cc(o.layers,o.zoom),this.segments=new Yr,this.segments2=new Yr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=o.projection}populate(o,l,p,y){this.hasPattern=Jv("fill",this.layers,l);const w=this.layers[0].layout.get("fill-sort-key"),E=[];for(const{feature:M,id:k,index:F,sourceLayerIndex:U}of o){const W=this.layers[0]._featureFilter.needGeometry,V=Gf(M,W);if(!this.layers[0]._featureFilter.filter(new We(this.zoom),V,p))continue;const Q=w?w.evaluate(V,{},p,l.availableImages):void 0,ie={id:k,properties:M.properties,type:M.type,sourceLayerIndex:U,index:F,geometry:W?V.geometry:nu(M,p,y),patterns:{},sortKey:Q};E.push(ie)}w&&E.sort((M,k)=>M.sortKey-k.sortKey);for(const M of E){const{geometry:k,index:F,sourceLayerIndex:U}=M;if(this.hasPattern){const W=Z_("fill",this.layers,M,this.zoom,l);this.patternFeatures.push(W)}else this.addFeature(M,k,F,p,{},l.availableImages);l.featureIndex.insert(o[F].feature,k,F,U,this.index)}}update(o,l,p,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,p,y)}addFeatures(o,l,p,y,w){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,l,p,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,dx),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,l,p,y,w,E=[]){for(const M of q_(l,500)){let k=0;for(const ie of M)k+=ie.length;const F=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),U=F.vertexLength,W=[],V=[];for(const ie of M){if(0===ie.length)continue;ie!==M[0]&&V.push(W.length/2);const se=this.segments2.prepareSegment(ie.length,this.layoutVertexArray,this.indexArray2),te=se.vertexLength;this.layoutVertexArray.emplaceBack(ie[0].x,ie[0].y),this.indexArray2.emplaceBack(te+ie.length-1,te),W.push(ie[0].x),W.push(ie[0].y);for(let we=1;we<ie.length;we++)this.layoutVertexArray.emplaceBack(ie[we].x,ie[we].y),this.indexArray2.emplaceBack(te+we-1,te+we),W.push(ie[we].x),W.push(ie[we].y);se.vertexLength+=ie.length,se.primitiveLength+=ie.length}const Q=Vh(W,V);for(let ie=0;ie<Q.length;ie+=3)this.indexArray.emplaceBack(U+Q[ie],U+Q[ie+1],U+Q[ie+2]);F.vertexLength+=k,F.primitiveLength+=Q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,p,w,E,y)}}gn(W_,"FillBucket",{omit:["layers","patternFeatures"]});const W1=new Rt({"fill-sort-key":new Xe(dt.layout_fill["fill-sort-key"])});var Y_={paint:new Rt({"fill-antialias":new qe(dt.paint_fill["fill-antialias"]),"fill-opacity":new Xe(dt.paint_fill["fill-opacity"]),"fill-color":new Xe(dt.paint_fill["fill-color"]),"fill-outline-color":new Xe(dt.paint_fill["fill-outline-color"]),"fill-translate":new qe(dt.paint_fill["fill-translate"]),"fill-translate-anchor":new qe(dt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Xe(dt.paint_fill["fill-pattern"])}),layout:W1};const Bi=yn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),gx=yn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),K_=yn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:_x}=Bi;var X_={},Y1=Ye,e0=Lo;function Lo(a,o,l,p,y){this.properties={},this.extent=l,this.type=0,this._pbf=a,this._geometry=-1,this._keys=p,this._values=y,a.readFields(yx,this,o)}function yx(a,o,l){1==a?o.id=l.readVarint():2==a?function(p,y){for(var w=p.readVarint()+p.pos;p.pos<w;){var E=y._keys[p.readVarint()],M=y._values[p.readVarint()];y.properties[E]=M}}(l,o):3==a?o.type=l.readVarint():4==a&&(o._geometry=l.pos)}function Kf(a){for(var o,l,p=0,y=0,w=a.length,E=w-1;y<w;E=y++)p+=((l=a[E]).x-(o=a[y]).x)*(o.y+l.y);return p}Lo.types=["Unknown","Point","LineString","Polygon"],Lo.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var o,l=a.readVarint()+a.pos,p=1,y=0,w=0,E=0,M=[];a.pos<l;){if(y<=0){var k=a.readVarint();p=7&k,y=k>>3}if(y--,1===p||2===p)w+=a.readSVarint(),E+=a.readSVarint(),1===p&&(o&&M.push(o),o=[]),o.push(new Y1(w,E));else{if(7!==p)throw new Error("unknown command "+p);o&&o.push(o[0].clone())}}return o&&M.push(o),M},Lo.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var o=a.readVarint()+a.pos,l=1,p=0,y=0,w=0,E=1/0,M=-1/0,k=1/0,F=-1/0;a.pos<o;){if(p<=0){var U=a.readVarint();l=7&U,p=U>>3}if(p--,1===l||2===l)(y+=a.readSVarint())<E&&(E=y),y>M&&(M=y),(w+=a.readSVarint())<k&&(k=w),w>F&&(F=w);else if(7!==l)throw new Error("unknown command "+l)}return[E,k,M,F]},Lo.prototype.toGeoJSON=function(a,o,l){var p,y,w=this.extent*Math.pow(2,l),E=this.extent*a,M=this.extent*o,k=this.loadGeometry(),F=Lo.types[this.type];function U(Q){for(var ie=0;ie<Q.length;ie++){var se=Q[ie];Q[ie]=[360*(se.x+E)/w-180,360/Math.PI*Math.atan(Math.exp((180-360*(se.y+M)/w)*Math.PI/180))-90]}}switch(this.type){case 1:var W=[];for(p=0;p<k.length;p++)W[p]=k[p][0];U(k=W);break;case 2:for(p=0;p<k.length;p++)U(k[p]);break;case 3:for(k=function(Q){var ie=Q.length;if(ie<=1)return[Q];for(var se,te,we=[],Oe=0;Oe<ie;Oe++){var me=Kf(Q[Oe]);0!==me&&(void 0===te&&(te=me<0),te===me<0?(se&&we.push(se),se=[Q[Oe]]):se.push(Q[Oe]))}return se&&we.push(se),we}(k),p=0;p<k.length;p++)for(y=0;y<k[p].length;y++)U(k[p][y])}1===k.length?k=k[0]:F="Multi"+F;var V={type:"Feature",geometry:{type:F,coordinates:k},properties:this.properties};return"id"in this&&(V.id=this.id),V};var vx=e0,K1=Q_;function Q_(a,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(X1,this,o),this.length=this._features.length}function X1(a,o,l){15===a?o.version=l.readVarint():1===a?o.name=l.readString():5===a?o.extent=l.readVarint():2===a?o._features.push(l.pos):3===a?o._keys.push(l.readString()):4===a&&o._values.push(function(p){for(var y=null,w=p.readVarint()+p.pos;p.pos<w;){var E=p.readVarint()>>3;y=1===E?p.readString():2===E?p.readFloat():3===E?p.readDouble():4===E?p.readVarint64():5===E?p.readVarint():6===E?p.readSVarint():7===E?p.readBoolean():null}return y}(l))}Q_.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var o=this._pbf.readVarint()+this._pbf.pos;return new vx(this._pbf,o,this.extent,this._keys,this._values)};var hm=K1;function Q1(a,o,l){if(3===a){var p=new hm(l,l.readVarint()+l.pos);p.length&&(o[p.name]=p)}}var Xf=X_.VectorTile=function(a,o){this.layers=a.readFields(Q1,{},o)},Qf=X_.VectorTileFeature=e0;function va(a,o,l,p){const y=[],w=0===p?(E,M,k,F,U,W)=>{E.push(new Ye(W,k+(W-M)/(F-M)*(U-k)))}:(E,M,k,F,U,W)=>{E.push(new Ye(M+(W-k)/(U-k)*(F-M),W))};for(const E of a){const M=[];for(const k of E){if(k.length<=2)continue;const F=[];for(let V=0;V<k.length-1;V++){const Q=k[V].x,ie=k[V].y,se=k[V+1].x,te=k[V+1].y,we=0===p?Q:ie,Oe=0===p?se:te;we<o?Oe>o&&w(F,Q,ie,se,te,o):we>l?Oe<l&&w(F,Q,ie,se,te,l):F.push(k[V]),Oe<o&&we>=o&&w(F,Q,ie,se,te,o),Oe>l&&we<=l&&w(F,Q,ie,se,te,l)}let U=k[k.length-1];const W=0===p?U.x:U.y;W>=o&&W<=l&&F.push(U),F.length&&(U=F[F.length-1],F[0].x===U.x&&F[0].y===U.y||F.push(F[0]),M.push(F))}M.length&&y.push(M)}return y}X_.VectorTileLayer=K1;const GT=Qf.types,wg=Math.pow(2,13);function t0(a,o,l,p,y,w,E,M){a.emplaceBack((o<<1)+E,(l<<1)+w,(Math.floor(p*wg)<<1)+y,Math.round(M))}function fm(a,o,l){a.emplaceBack(o.x,o.y,o.z,16384*l[0],16384*l[1],16384*l[2])}class Zu{constructor(){this.acc=new Ye(0,0),this.polyCount=[]}startRing(o){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Ye(o.x,o.y),this.max=new Ye(o.x,o.y))}append(o,l){this.currentPolyCount.edges++,this.acc._add(o);const p=this.min,y=this.max;o.x<p.x?p.x=o.x:o.x>y.x&&(y.x=o.x),o.y<p.y?p.y=o.y:o.y>y.y&&(y.y=o.y),((0===o.x||o.x===Jn)&&o.x===l.x)!=((0===o.y||o.y===Jn)&&o.y===l.y)&&this.processBorderOverlap(o,l),l.x<0!=o.x<0&&this.addBorderIntersection(0,di(l.y,o.y,(0-l.x)/(o.x-l.x))),l.x>Jn!=o.x>Jn&&this.addBorderIntersection(1,di(l.y,o.y,(Jn-l.x)/(o.x-l.x))),l.y<0!=o.y<0&&this.addBorderIntersection(2,di(l.x,o.x,(0-l.y)/(o.y-l.y))),l.y>Jn!=o.y>Jn&&this.addBorderIntersection(3,di(l.x,o.x,(Jn-l.y)/(o.y-l.y)))}addBorderIntersection(o,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[o];l<p[0]&&(p[0]=l),l>p[1]&&(p[1]=l)}processBorderOverlap(o,l){if(o.x===l.x){if(o.y===l.y)return;const p=0===o.x?0:1;this.addBorderIntersection(p,l.y),this.addBorderIntersection(p,o.y)}else{const p=0===o.y?2:3;this.addBorderIntersection(p,l.x),this.addBorderIntersection(p,o.x)}}centroid(){const o=this.polyCount.reduce((l,p)=>l+p.edges,0);return 0!==o?this.acc.div(o)._round():new Ye(0,0)}span(){return new Ye(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((o,l)=>o+ +(l[0]!==Number.MAX_VALUE),0)}}class pm{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.layoutVertexArray=new Ri,this.centroidVertexArray=new Sh,this.indexArray=new mo,this.programConfigurations=new cc(o.layers,o.zoom),this.segments=new Yr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.enableTerrain=o.enableTerrain}populate(o,l,p,y){this.features=[],this.hasPattern=Jv("fill-extrusion",this.layers,l),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(w){const E=Math.exp(Math.PI*(1-w.y/(1<<w.z)*2));return 80150034*E/(E*E+1)/Jn/(1<<w.z)}(p),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:w,id:E,index:M,sourceLayerIndex:k}of o){const F=this.layers[0]._featureFilter.needGeometry,U=Gf(w,F);if(!this.layers[0]._featureFilter.filter(new We(this.zoom),U,p))continue;const W={id:E,sourceLayerIndex:k,index:M,geometry:F?U.geometry:nu(w,p,y),properties:w.properties,type:w.type,patterns:{}},V=this.layoutVertexArray.length;this.hasPattern?this.features.push(Z_("fill-extrusion",this.layers,W,this.zoom,l)):this.addFeature(W,W.geometry,M,p,{},l.availableImages,y),l.featureIndex.insert(w,W.geometry,M,k,this.index,V)}this.sortBorders()}addFeatures(o,l,p,y,w){for(const E of this.features){const{geometry:M}=E;this.addFeature(E,M,E.index,l,p,y,w)}this.sortBorders()}update(o,l,p,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,p,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,_x),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,K_.members,!0))),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,gx.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,l,p,y,w,E,M){const k=[new Ye(0,0),new Ye(Jn,Jn)],F=M.projection,U="globe"===F.name,W=this.enableTerrain&&!U?new Zu:null,V="Polygon"===GT[o.type];U&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new $s);const Q=q_(l,500);for(let we=Q.length-1;we>=0;we--){const Oe=Q[we];(0===Oe.length||(ie=Oe[0]).every(me=>me.x<=0)||ie.every(me=>me.x>=Jn)||ie.every(me=>me.y<=0)||ie.every(me=>me.y>=Jn))&&Q.splice(we,1)}var ie;let se;if(U)se=xx(Q,k,y);else{se=[];for(const we of Q)se.push({polygon:we,bounds:k})}const te=V?this.edgeRadius:0;for(const{polygon:we,bounds:Oe}of se){let me=0,Ae=0;for(const Re of we)V&&!Re[0].equals(Re[Re.length-1])&&Re.push(Re[0]),Ae+=V?Re.length-1:Re.length;const Ee=this.segments.prepareSegment((V?5:4)*Ae,this.layoutVertexArray,this.indexArray);if(V){const Re=[],lt=[];me=Ee.vertexLength;for(const wt of we){let jt,ht;wt.length&&wt!==we[0]&&lt.push(Re.length/2),jt=wt[1].sub(wt[0])._perp()._unit();for(let Tt=1;Tt<wt.length;Tt++){const At=wt[Tt],Et=wt[Tt===wt.length-1?1:Tt+1];let{x:Vt,y:ot}=At;if(te){ht=Et.sub(At)._perp()._unit();const tn=jt.add(ht)._unit(),Yn=te*Math.min(4,1/(jt.x*tn.x+jt.y*tn.y));Vt+=Yn*tn.x,ot+=Yn*tn.y,jt=ht}t0(this.layoutVertexArray,Vt,ot,0,0,1,1,0),Ee.vertexLength++,Re.push(At.x,At.y),U&&fm(this.layoutVertexExtArray,F.projectTilePoint(Vt,ot,y),F.upVector(y,Vt,ot))}}const tt=Vh(Re,lt);for(let wt=0;wt<tt.length;wt+=3)this.indexArray.emplaceBack(me+tt[wt],me+tt[wt+2],me+tt[wt+1]),Ee.primitiveLength++}for(const Re of we){W&&Re.length&&W.startRing(Re[0]);let lt,tt,wt,jt=Re.length>4&&mm(Re[Re.length-2],Re[0],Re[1]),ht=te?Cg(Re[Re.length-2],Re[0],Re[1],te):0;tt=Re[1].sub(Re[0])._perp()._unit();let Tt=!0;for(let At=1,Et=0;At<Re.length;At++){let Vt=Re[At-1],ot=Re[At];const tn=Re[At===Re.length-1?1:At+1];if(W&&V&&W.currentPolyCount.top++,J_(ot,Vt,Oe)){te&&(tt=tn.sub(ot)._perp()._unit(),Tt=!Tt);continue}W&&W.append(ot,Vt);const Yn=ot.sub(Vt)._perp(),mn=Yn.x/(Math.abs(Yn.x)+Math.abs(Yn.y)),Dn=Yn.y>0?1:0,ln=Vt.dist(ot);if(Et+ln>32768&&(Et=0),te){wt=tn.sub(ot)._perp()._unit();let Pi=J1(Vt,ot,tn,bx(tt,wt),te);isNaN(Pi)&&(Pi=0);const ni=ot.sub(Vt)._unit();Vt=Vt.add(ni.mult(ht))._round(),ot=ot.add(ni.mult(-Pi))._round(),ht=Pi,tt=wt}const kn=Ee.vertexLength,Li=Re.length>4&&mm(Vt,ot,tn);let Di=ey(Et,jt,Tt);if(t0(this.layoutVertexArray,Vt.x,Vt.y,mn,Dn,0,0,Di),t0(this.layoutVertexArray,Vt.x,Vt.y,mn,Dn,0,1,Di),Et+=ln,Di=ey(Et,Li,!Tt),jt=Li,t0(this.layoutVertexArray,ot.x,ot.y,mn,Dn,0,0,Di),t0(this.layoutVertexArray,ot.x,ot.y,mn,Dn,0,1,Di),Ee.vertexLength+=4,this.indexArray.emplaceBack(kn+0,kn+1,kn+2),this.indexArray.emplaceBack(kn+1,kn+3,kn+2),Ee.primitiveLength+=2,te){const Pi=me+(1===At?Re.length-2:At-2),ni=1===At?me:Pi+1;if(this.indexArray.emplaceBack(kn+1,Pi,kn+3),this.indexArray.emplaceBack(Pi,ni,kn+3),Ee.primitiveLength+=2,void 0===lt&&(lt=kn),!J_(tn,Re[At],Oe)){const mr=At===Re.length-1?lt:Ee.vertexLength;this.indexArray.emplaceBack(kn+2,kn+3,mr),this.indexArray.emplaceBack(kn+3,mr+1,mr),this.indexArray.emplaceBack(kn+3,ni,mr+1),Ee.primitiveLength+=3}Tt=!Tt}if(U){const Pi=this.layoutVertexExtArray,ni=F.projectTilePoint(Vt.x,Vt.y,y),mr=F.projectTilePoint(ot.x,ot.y,y),ei=F.upVector(y,Vt.x,Vt.y),ki=F.upVector(y,ot.x,ot.y);fm(Pi,ni,ei),fm(Pi,ni,ei),fm(Pi,mr,ki),fm(Pi,mr,ki)}}V&&(me+=Re.length-1)}}if(W&&W.polyCount.length>0){if(W.borders){W.vertexArrayOffset=this.centroidVertexArray.length;const we=W.borders,Oe=this.featuresOnBorder.push(W)-1;for(let me=0;me<4;me++)we[me][0]!==Number.MAX_VALUE&&this.borders[me].push(Oe)}this.encodeCentroid(W.borders?void 0:W.centroid(),W)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,p,w,E,y)}sortBorders(){for(let o=0;o<4;o++)this.borders[o].sort((l,p)=>this.featuresOnBorder[l].borders[o][0]-this.featuresOnBorder[p].borders[o][0])}encodeCentroid(o,l,p=!0){let y,w;if(o)if(0!==o.y){const M=l.span()._mult(this.tileToMeter);y=(Math.max(o.x,1)<<3)+Math.min(7,Math.round(M.x/10)),w=(Math.max(o.y,1)<<3)+Math.min(7,Math.round(M.y/10))}else y=Math.ceil(7*(o.x+450)),w=0;else y=0,w=+p;let E=p?this.centroidVertexArray.length:l.vertexArrayOffset;for(const M of l.polyCount){p&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*M.edges+M.top);for(let k=0;k<M.top;k++)this.centroidVertexArray.emplace(E++,y,w);for(let k=0;k<2*M.edges;k++)this.centroidVertexArray.emplace(E++,0,w),this.centroidVertexArray.emplace(E++,y,w)}}}function bx(a,o){const l=a.add(o)._unit();return a.x*l.x+a.y*l.y}function Cg(a,o,l,p){const y=o.sub(a)._perp()._unit(),w=l.sub(o)._perp()._unit();return J1(a,o,l,bx(y,w),p)}function J1(a,o,l,p,y){const w=Math.sqrt(1-p*p);return Math.min(a.dist(o)/3,o.dist(l)/3,y*w/p)}function J_(a,o,l){return a.x<l[0].x&&o.x<l[0].x||a.x>l[1].x&&o.x>l[1].x||a.y<l[0].y&&o.y<l[0].y||a.y>l[1].y&&o.y>l[1].y}function mm(a,o,l){if(a.x<0||a.x>=Jn||o.x<0||o.x>=Jn||l.x<0||l.x>=Jn)return!1;const p=l.sub(o),y=p.perp(),w=a.sub(o);return(p.x*w.x+p.y*w.y)/Math.sqrt((p.x*p.x+p.y*p.y)*(w.x*w.x+w.y*w.y))>-.866&&y.x*w.x+y.y*w.y<0}function ey(a,o,l){const p=o?2|a:-3&a;return l?1|p:-2&p}function n0(){const a=Math.PI/32,o=Math.tan(a),l=Ad;return l*Math.sqrt(1+2*o*o)-l}function xx(a,o,l){const p=1<<l.z,y=za(l.x/p),w=za((l.x+1)/p),E=Xs(l.y/p),M=Xs((l.y+1)/p);return function(k,F,U,W,V=0,Q){const ie=[];if(!k.length||!U||!W)return ie;const se=(Re,lt)=>{for(const tt of Re)ie.push({polygon:tt,bounds:lt})},te=Math.ceil(Math.log2(U)),we=Math.ceil(Math.log2(W)),Oe=te-we,me=[];for(let Re=0;Re<Math.abs(Oe);Re++)me.push(Oe>0?0:1);for(let Re=0;Re<Math.min(te,we);Re++)me.push(0),me.push(1);let Ae=k;if(Ae=va(Ae,F[0].y-V,F[1].y+V,1),Ae=va(Ae,F[0].x-V,F[1].x+V,0),!Ae.length)return ie;const Ee=[];for(me.length?Ee.push({polygons:Ae,bounds:F,depth:0}):se(Ae,F);Ee.length;){const Re=Ee.pop(),lt=Re.depth,tt=me[lt],wt=Re.bounds[0],jt=Re.bounds[1],ht=0===tt?wt.x:wt.y,Tt=0===tt?jt.x:jt.y,At=Q?Q(tt,ht,Tt):.5*(ht+Tt),Et=va(Re.polygons,ht-V,At+V,tt),Vt=va(Re.polygons,At-V,Tt+V,tt);if(Et.length){const ot=[wt,new Ye(0===tt?At:jt.x,1===tt?At:jt.y)];me.length>lt+1?Ee.push({polygons:Et,bounds:ot,depth:lt+1}):se(Et,ot)}if(Vt.length){const ot=[new Ye(0===tt?At:wt.x,1===tt?At:wt.y),jt];me.length>lt+1?Ee.push({polygons:Vt,bounds:ot,depth:lt+1}):se(Vt,ot)}}return ie}(a,o,Math.ceil((w-y)/11.25),Math.ceil((E-M)/11.25),1,(k,F,U)=>{if(0===k)return.5*(F+U);{const W=Xs((l.y+F/Jn)/p);return(qu(.5*(Xs((l.y+U/Jn)/p)+W))*p-l.y)*Jn}})}gn(pm,"FillExtrusionBucket",{omit:["layers","features"]}),gn(Zu,"PartMetadata");const eC=new Rt({"fill-extrusion-edge-radius":new qe(dt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var wx={paint:new Rt({"fill-extrusion-opacity":new qe(dt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Xe(dt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new qe(dt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new qe(dt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Xe(dt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Xe(dt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Xe(dt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new qe(dt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new qe(dt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new qe(dt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:eC};function Cx(a,o,l){var p=2*Math.PI*6378137/256/Math.pow(2,l);return[a*p-2*Math.PI*6378137/2,o*p-2*Math.PI*6378137/2]}class r0{constructor(o,l,p){this.z=o,this.x=l,this.y=p,this.key=Wu(0,o,o,l,p)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,l){const p=(E=this.y,M=this.z,k=Cx(256*(w=this.x),256*(E=Math.pow(2,M)-E-1),M),F=Cx(256*(w+1),256*(E+1),M),k[0]+","+k[1]+","+F[0]+","+F[1]),y=function(w,E,M){let k,F="";for(let U=w;U>0;U--)k=1<<U-1,F+=(E&k?1:0)+(M&k?2:0);return F}(this.z,this.x,this.y);var w,E,M,k,F;return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===l?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",y).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ex{constructor(o,l){this.wrap=o,this.canonical=l,this.key=Wu(o,l.z,l.z,l.x,l.y)}}class Ua{constructor(o,l,p,y,w){this.overscaledZ=o,this.wrap=l,this.canonical=new r0(p,+y,+w),this.key=0===l&&o===p?this.canonical.key:Wu(l,o,p,y,w)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const l=this.canonical.z-o;return o>this.canonical.z?new Ua(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ua(o,this.wrap,o,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(o,l=!0){if(this.overscaledZ===o&&l)return this.key;if(o>this.canonical.z)return Wu(this.wrap*+l,o,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-o;return Wu(this.wrap*+l,o,o,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const l=this.canonical.z-o.canonical.z;return 0===o.overscaledZ||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>l&&o.canonical.y===this.canonical.y>>l}children(o){if(this.overscaledZ>=o)return[new Ua(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,p=2*this.canonical.x,y=2*this.canonical.y;return[new Ua(l,this.wrap,l,p,y),new Ua(l,this.wrap,l,p+1,y),new Ua(l,this.wrap,l,p,y+1),new Ua(l,this.wrap,l,p+1,y+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new Ua(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new Ua(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ex(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Wu(a,o,l,p,y){const w=1<<Math.min(l,22);let E=w*(y%w)+p%w;return a&&l<22&&(E+=w*w*((a<0?-2*a-1:2*a)%(1<<2*(22-l)))),16*(32*E+l)+(o-l)}gn(r0,"CanonicalTileID"),gn(Ua,"OverscaledTileID",{omit:["projMatrix"]});class gm extends Ye{constructor(o,l,p){super(o,l),this.z=p}}function Uh(a,o){return a.x*o.x+a.y*o.y}function tC(a,o){if(1===a.length){let l=0;const p=o[l++];let y;for(;!y||p.equals(y);)if(y=o[l++],!y)return 1/0;for(;l<o.length;l++){const w=o[l],E=a[0],M=y.sub(p),k=w.sub(p),F=E.sub(p),U=Uh(M,M),W=Uh(M,k),V=Uh(k,k),Q=Uh(F,M),ie=Uh(F,k),se=U*V-W*W,te=(V*Q-W*ie)/se,we=(U*ie-W*Q)/se,Oe=p.z*(1-te-we)+y.z*te+w.z*we;if(isFinite(Oe))return Oe}return 1/0}{let l=1/0;for(const p of o)l=Math.min(l,p.z);return l}}function ty(a,o,l,p,y,w,E,M){const k=E*y.getElevationAt(a,o,!0,!0),F=0!==w[0],U=F?0===w[1]?E*(w[0]/7-450):E*function(W,V,Q){const ie=Math.floor(V[0]/8),se=Math.floor(V[1]/8),te=10*(V[0]-8*ie),we=10*(V[1]-8*se),Oe=W.getElevationAt(ie,se,!0,!0),me=W.getMeterToDEM(Q),Ae=Math.floor(.5*(te*me-1)),Ee=Math.floor(.5*(we*me-1)),Re=W.tileCoordToPixel(ie,se),lt=2*Ae+1,tt=2*Ee+1,wt=(Yn=lt,mn=tt,[(Vt=W).getElevationAtPixel(ot=Re.x-Ae,tn=Re.y-Ee,!0),Vt.getElevationAtPixel(ot+mn,tn,!0),Vt.getElevationAtPixel(ot,tn+mn,!0),Vt.getElevationAtPixel(ot+Yn,tn+mn,!0)]),jt=Math.abs(wt[0]-wt[1]),ht=Math.abs(wt[2]-wt[3]),Tt=Math.abs(wt[0]-wt[2])+Math.abs(wt[1]-wt[3]),At=Math.min(.25,.5*me*(jt+ht)/lt),Et=Math.min(.25,.5*me*Tt/tt);var Vt,ot,tn,Yn,mn;return Oe+Math.max(At*te,Et*we)}(y,w,M):k;return{base:k+(0===l)?-1:l,top:F?Math.max(U+p,k+l+2):k+p}}const Tx=yn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:HT}=Tx,_m=yn([{name:"a_packed",components:4,type:"Float32"}]),{members:Ix}=_m,nC=Qf.types,Sx=Math.cos(Math.PI/180*37.5);class Eg{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new or,this.layoutVertexArray2=new vi,this.indexArray=new mo,this.programConfigurations=new cc(o.layers,o.zoom),this.segments=new Yr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(o,l,p,y){this.hasPattern=Jv("line",this.layers,l);const w=this.layers[0].layout.get("line-sort-key"),E=[];for(const{feature:U,id:W,index:V,sourceLayerIndex:Q}of o){const ie=this.layers[0]._featureFilter.needGeometry,se=Gf(U,ie);if(!this.layers[0]._featureFilter.filter(new We(this.zoom),se,p))continue;const te=w?w.evaluate(se,{},p):void 0,we={id:W,properties:U.properties,type:U.type,sourceLayerIndex:Q,index:V,geometry:ie?se.geometry:nu(U,p,y),patterns:{},sortKey:te};E.push(we)}w&&E.sort((U,W)=>U.sortKey-W.sortKey);const{lineAtlas:M,featureIndex:k}=l,F=this.addConstantDashes(M);for(const U of E){const{geometry:W,index:V,sourceLayerIndex:Q}=U;if(F&&this.addFeatureDashes(U,M),this.hasPattern){const ie=Z_("line",this.layers,U,this.zoom,l);this.patternFeatures.push(ie)}else this.addFeature(U,W,V,p,M.positions,l.availableImages);k.insert(o[V].feature,W,V,Q,this.index)}}addConstantDashes(o){let l=!1;for(const p of this.layers){const y=p.paint.get("line-dasharray").value,w=p.layout.get("line-cap").value;if("constant"!==y.kind||"constant"!==w.kind)l=!0;else{const E=w.value,M=y.value;if(!M)continue;o.addDash(M,E)}}return l}addFeatureDashes(o,l){const p=this.zoom;for(const y of this.layers){const w=y.paint.get("line-dasharray").value,E=y.layout.get("line-cap").value;if("constant"===w.kind&&"constant"===E.kind)continue;let M,k;if("constant"===w.kind){if(M=w.value,!M)continue}else M=w.evaluate({zoom:p},o);k="constant"===E.kind?E.value:E.evaluate({zoom:p},o),l.addDash(M,k),o.patterns[y.id]=l.getKey(M,k)}}update(o,l,p,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,p,y)}addFeatures(o,l,p,y,w){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,l,p,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,Ix)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,HT),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,l,p,y,w,E){const M=this.layers[0].layout,k=M.get("line-join").evaluate(o,{}),F=M.get("line-cap").evaluate(o,{}),U=M.get("line-miter-limit"),W=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const V of l)this.addLine(V,o,k,F,U,W);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,p,w,E,y)}addLine(o,l,p,y,w,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let we=0;we<o.length-1;we++)this.totalDistance+=o[we].dist(o[we+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const M="Polygon"===nC[l.type];let k=o.length;for(;k>=2&&o[k-1].equals(o[k-2]);)k--;let F=0;for(;F<k-1&&o[F].equals(o[F+1]);)F++;if(k<(M?3:2))return;"bevel"===p&&(w=1.05);const U=this.overscaling<=16?122880/(512*this.overscaling):0,W=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray);let V,Q,ie,se,te;this.e1=this.e2=-1,M&&(V=o[k-2],te=o[F].sub(V)._unit()._perp());for(let we=F;we<k;we++){if(ie=we===k-1?M?o[F+1]:void 0:o[we+1],ie&&o[we].equals(ie))continue;te&&(se=te),V&&(Q=V),V=o[we],te=ie?ie.sub(V)._unit()._perp():se,se=se||te;let Oe=se.add(te);0===Oe.x&&0===Oe.y||Oe._unit();const me=se.x*te.x+se.y*te.y,Ae=Oe.x*te.x+Oe.y*te.y,Ee=0!==Ae?1/Ae:1/0,Re=2*Math.sqrt(2-2*Ae),lt=Ae<Sx&&Q&&ie,tt=se.x*te.y-se.y*te.x>0;if(lt&&we>F){const ht=V.dist(Q);if(ht>2*U){const Tt=V.sub(V.sub(Q)._mult(U/ht)._round());this.updateDistance(Q,Tt),this.addCurrentVertex(Tt,se,0,0,W),Q=Tt}}const wt=Q&&ie;let jt=wt?p:M?"butt":y;if(wt&&"round"===jt&&(Ee<E?jt="miter":Ee<=2&&(jt="fakeround")),"miter"===jt&&Ee>w&&(jt="bevel"),"bevel"===jt&&(Ee>2&&(jt="flipbevel"),Ee<w&&(jt="miter")),Q&&this.updateDistance(Q,V),"miter"===jt)Oe._mult(Ee),this.addCurrentVertex(V,Oe,0,0,W);else if("flipbevel"===jt){if(Ee>100)Oe=te.mult(-1);else{const ht=Ee*se.add(te).mag()/se.sub(te).mag();Oe._perp()._mult(ht*(tt?-1:1))}this.addCurrentVertex(V,Oe,0,0,W),this.addCurrentVertex(V,Oe.mult(-1),0,0,W)}else if("bevel"===jt||"fakeround"===jt){const ht=-Math.sqrt(Ee*Ee-1),Tt=tt?ht:0,At=tt?0:ht;if(Q&&this.addCurrentVertex(V,se,Tt,At,W),"fakeround"===jt){const Et=Math.round(180*Re/Math.PI/20);for(let Vt=1;Vt<Et;Vt++){let ot=Vt/Et;if(.5!==ot){const Yn=ot-.5;ot+=ot*Yn*(ot-1)*((1.0904+me*(me*(3.55645-1.43519*me)-3.2452))*Yn*Yn+(.848013+me*(.215638*me-1.06021)))}const tn=te.sub(se)._mult(ot)._add(se)._unit()._mult(tt?-1:1);this.addHalfVertex(V,tn.x,tn.y,!1,tt,0,W)}}ie&&this.addCurrentVertex(V,te,-Tt,-At,W)}else if("butt"===jt)this.addCurrentVertex(V,Oe,0,0,W);else if("square"===jt){const ht=Q?1:-1;Q||this.addCurrentVertex(V,Oe,ht,ht,W),this.addCurrentVertex(V,Oe,0,0,W),Q&&this.addCurrentVertex(V,Oe,ht,ht,W)}else"round"===jt&&(Q&&(this.addCurrentVertex(V,se,0,0,W),this.addCurrentVertex(V,se,1,1,W,!0)),ie&&(this.addCurrentVertex(V,te,-1,-1,W,!0),this.addCurrentVertex(V,te,0,0,W)));if(lt&&we<k-1){const ht=V.dist(ie);if(ht>2*U){const Tt=V.add(ie.sub(V)._mult(U/ht)._round());this.updateDistance(V,Tt),this.addCurrentVertex(Tt,te,0,0,W),V=Tt}}}}addCurrentVertex(o,l,p,y,w,E=!1){const M=l.y*y-l.x,k=-l.y-l.x*y;this.addHalfVertex(o,l.x+l.y*p,l.y-l.x*p,E,!1,p,w),this.addHalfVertex(o,M,k,E,!0,-y,w)}addHalfVertex({x:o,y:l},p,y,w,E,M,k){this.layoutVertexArray.emplaceBack((o<<1)+(w?1:0),(l<<1)+(E?1:0),Math.round(63*p)+128,Math.round(63*y)+128,1+(0===M?0:M<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const F=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,F),k.primitiveLength++),E?this.e2=F:this.e1=F}updateScaledDistance(){if(this.lineClips){const o=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=o*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(o,l){this.distance+=o.dist(l),this.updateScaledDistance()}}gn(Eg,"LineBucket",{omit:["layers","patternFeatures"]});const iC=new Rt({"line-cap":new Xe(dt.layout_line["line-cap"]),"line-join":new Xe(dt.layout_line["line-join"]),"line-miter-limit":new qe(dt.layout_line["line-miter-limit"]),"line-round-limit":new qe(dt.layout_line["line-round-limit"]),"line-sort-key":new Xe(dt.layout_line["line-sort-key"])});var ny={paint:new Rt({"line-opacity":new Xe(dt.paint_line["line-opacity"]),"line-color":new Xe(dt.paint_line["line-color"]),"line-translate":new qe(dt.paint_line["line-translate"]),"line-translate-anchor":new qe(dt.paint_line["line-translate-anchor"]),"line-width":new Xe(dt.paint_line["line-width"]),"line-gap-width":new Xe(dt.paint_line["line-gap-width"]),"line-offset":new Xe(dt.paint_line["line-offset"]),"line-blur":new Xe(dt.paint_line["line-blur"]),"line-dasharray":new Xe(dt.paint_line["line-dasharray"]),"line-pattern":new Xe(dt.paint_line["line-pattern"]),"line-gradient":new Mt(dt.paint_line["line-gradient"]),"line-trim-offset":new qe(dt.paint_line["line-trim-offset"])}),layout:iC};const gc=new class extends Xe{possiblyEvaluate(a,o){return o=new We(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(a,o)}evaluate(a,o,l,p){return o=gt({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(a,o,l,p)}}(ny.paint.properties["line-width"].specification);function Tg(a,o){return o>0?o+2*a:a}gc.useIntegerZoom=!0;const Ig=yn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),o0=yn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),iy=yn([{name:"a_projected_pos",components:4,type:"Float32"}],4);yn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Mx=yn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),ry=yn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);yn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Sg=yn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Fd=yn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);yn([{name:"triangle",components:3,type:"Uint16"}]),yn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),yn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),yn([{type:"Float32",name:"offsetX"}]),yn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Kr=24;const _c=128;function oy(a,o){const{expression:l}=o;if("constant"===l.kind)return{kind:"constant",layoutSize:l.evaluate(new We(a+1))};if("source"===l.kind)return{kind:"source"};{const{zoomStops:p,interpolationType:y}=l;let w=0;for(;w<p.length&&p[w]<=a;)w++;w=Math.max(0,w-1);let E=w;for(;E<p.length&&p[E]<a+1;)E++;E=Math.min(p.length-1,E);const M=p[w],k=p[E];return"composite"===l.kind?{kind:"composite",minZoom:M,maxZoom:k,interpolationType:y}:{kind:"camera",minZoom:M,maxZoom:k,minSize:l.evaluate(new We(M)),maxSize:l.evaluate(new We(k)),interpolationType:y}}}function sy(a,{uSize:o,uSizeT:l},{lowerSize:p,upperSize:y}){return"source"===a.kind?p/_c:"composite"===a.kind?di(p/_c,y/_c,l):o}function Jf(a,o){let l=0,p=0;if("constant"===a.kind)p=a.layoutSize;else if("source"!==a.kind){const{interpolationType:y,minZoom:w,maxZoom:E}=a,M=y?zt(Wa.interpolationFactor(y,o,w,E),0,1):0;"camera"===a.kind?p=di(a.minSize,a.maxSize,M):l=M}return{uSizeT:l,uSize:p}}var rC=Object.freeze({__proto__:null,getSizeData:oy,evaluateSizeForFeature:sy,evaluateSizeForZoom:Jf,SIZE_PACK_FACTOR:_c});function ym(a,o,l){return a.sections.forEach(p=>{p.text=function(y,w,E){const M=w.layout.get("text-transform").evaluate(E,{});return"uppercase"===M?y=y.toLocaleUpperCase():"lowercase"===M&&(y=y.toLocaleLowerCase()),Ue.applyArabicShaping&&(y=Ue.applyArabicShaping(y)),y}(p.text,o,l)}),a}const vm={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function jh(a){return"\ufe36"===a||"\ufe48"===a||"\ufe38"===a||"\ufe44"===a||"\ufe42"===a||"\ufe3e"===a||"\ufe3c"===a||"\ufe3a"===a||"\ufe18"===a||"\ufe40"===a||"\ufe10"===a||"\ufe13"===a||"\ufe14"===a||"\uff40"===a||"\uffe3"===a||"\ufe11"===a||"\ufe12"===a}function Dx(a){return"\ufe35"===a||"\ufe47"===a||"\ufe37"===a||"\ufe43"===a||"\ufe41"===a||"\ufe3d"===a||"\ufe3b"===a||"\ufe39"===a||"\ufe17"===a||"\ufe3f"===a}var Ar=ar,Yu=function(a,o,l,p,y){var w,E,M=8*y-p-1,k=(1<<M)-1,F=k>>1,U=-7,W=l?y-1:0,V=l?-1:1,Q=a[o+W];for(W+=V,w=Q&(1<<-U)-1,Q>>=-U,U+=M;U>0;w=256*w+a[o+W],W+=V,U-=8);for(E=w&(1<<-U)-1,w>>=-U,U+=p;U>0;E=256*E+a[o+W],W+=V,U-=8);if(0===w)w=1-F;else{if(w===k)return E?NaN:1/0*(Q?-1:1);E+=Math.pow(2,p),w-=F}return(Q?-1:1)*E*Math.pow(2,w-p)},Ax=function(a,o,l,p,y,w){var E,M,k,F=8*w-y-1,U=(1<<F)-1,W=U>>1,V=23===y?Math.pow(2,-24)-Math.pow(2,-77):0,Q=p?0:w-1,ie=p?1:-1,se=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(M=isNaN(o)?1:0,E=U):(E=Math.floor(Math.log(o)/Math.LN2),o*(k=Math.pow(2,-E))<1&&(E--,k*=2),(o+=E+W>=1?V/k:V*Math.pow(2,1-W))*k>=2&&(E++,k/=2),E+W>=U?(M=0,E=U):E+W>=1?(M=(o*k-1)*Math.pow(2,y),E+=W):(M=o*Math.pow(2,W-1)*Math.pow(2,y),E=0));y>=8;a[l+Q]=255&M,Q+=ie,M/=256,y-=8);for(E=E<<y|M,F+=y;F>0;a[l+Q]=255&E,Q+=ie,E/=256,F-=8);a[l+Q-ie]|=128*se};function ar(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}ar.Varint=0,ar.Fixed64=1,ar.Bytes=2,ar.Fixed32=5;var bm=4294967296,ay=1/bm,s0=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ku(a){return a.type===ar.Bytes?a.readVarint()+a.pos:a.pos+1}function ly(a,o,l){var p=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));l.realloc(p);for(var y=l.pos-1;y>=a;y--)l.buf[y+p]=l.buf[y]}function Px(a,o){for(var l=0;l<a.length;l++)o.writeVarint(a[l])}function Ox(a,o){for(var l=0;l<a.length;l++)o.writeSVarint(a[l])}function xm(a,o){for(var l=0;l<a.length;l++)o.writeFloat(a[l])}function kx(a,o){for(var l=0;l<a.length;l++)o.writeDouble(a[l])}function Rx(a,o){for(var l=0;l<a.length;l++)o.writeBoolean(a[l])}function Fx(a,o){for(var l=0;l<a.length;l++)o.writeFixed32(a[l])}function Lx(a,o){for(var l=0;l<a.length;l++)o.writeSFixed32(a[l])}function oC(a,o){for(var l=0;l<a.length;l++)o.writeFixed64(a[l])}function su(a,o){for(var l=0;l<a.length;l++)o.writeSFixed64(a[l])}function tp(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+16777216*a[o+3]}function $h(a,o,l){a[l]=o,a[l+1]=o>>>8,a[l+2]=o>>>16,a[l+3]=o>>>24}function a0(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+(a[o+3]<<24)}function cy(a,o,l){o.glyphs=[],1===a&&l.readMessage(Nx,o)}function Nx(a,o,l){if(3===a){const{id:p,bitmap:y,width:w,height:E,left:M,top:k,advance:F}=l.readMessage(zx,{});o.glyphs.push({id:p,bitmap:new Qs({width:w+6,height:E+6},y),metrics:{width:w,height:E,left:M,top:k,advance:F}})}else 4===a?o.ascender=l.readSVarint():5===a&&(o.descender=l.readSVarint())}function zx(a,o,l){1===a?o.id=l.readVarint():2===a?o.bitmap=l.readBytes():3===a?o.width=l.readVarint():4===a?o.height=l.readVarint():5===a?o.left=l.readSVarint():6===a?o.top=l.readSVarint():7===a&&(o.advance=l.readVarint())}function uy(a){let o=0,l=0;for(const E of a)o+=E.w*E.h,l=Math.max(l,E.w);a.sort((E,M)=>M.h-E.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),l),h:1/0}];let y=0,w=0;for(const E of a)for(let M=p.length-1;M>=0;M--){const k=p[M];if(!(E.w>k.w||E.h>k.h)){if(E.x=k.x,E.y=k.y,w=Math.max(w,E.y+E.h),y=Math.max(y,E.x+E.w),E.w===k.w&&E.h===k.h){const F=p.pop();M<p.length&&(p[M]=F)}else E.h===k.h?(k.x+=E.w,k.w-=E.w):E.w===k.w?(k.y+=E.h,k.h-=E.h):(p.push({x:k.x+E.w,y:k.y,w:k.w-E.w,h:E.h}),k.y+=E.h,k.h-=E.h);break}}return{w:y,h:w,fill:o/(y*w)||0}}ar.prototype={destroy:function(){this.buf=null},readFields:function(a,o,l){for(l=l||this.length;this.pos<l;){var p=this.readVarint(),y=p>>3,w=this.pos;this.type=7&p,a(y,o,this),this.pos===w&&this.skip(p)}return o},readMessage:function(a,o){return this.readFields(a,o,this.readVarint()+this.pos)},readFixed32:function(){var a=tp(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=a0(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=tp(this.buf,this.pos)+tp(this.buf,this.pos+4)*bm;return this.pos+=8,a},readSFixed64:function(){var a=tp(this.buf,this.pos)+a0(this.buf,this.pos+4)*bm;return this.pos+=8,a},readFloat:function(){var a=Yu(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Yu(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var o,l,p=this.buf;return o=127&(l=p[this.pos++]),l<128?o:(o|=(127&(l=p[this.pos++]))<<7,l<128?o:(o|=(127&(l=p[this.pos++]))<<14,l<128?o:(o|=(127&(l=p[this.pos++]))<<21,l<128?o:function(y,w,E){var M,k,F=E.buf;if(M=(112&(k=F[E.pos++]))>>4,k<128||(M|=(127&(k=F[E.pos++]))<<3,k<128)||(M|=(127&(k=F[E.pos++]))<<10,k<128)||(M|=(127&(k=F[E.pos++]))<<17,k<128)||(M|=(127&(k=F[E.pos++]))<<24,k<128)||(M|=(1&(k=F[E.pos++]))<<31,k<128))return function ep(a,o,l){return l?4294967296*o+(a>>>0):4294967296*(o>>>0)+(a>>>0)}(y,M,w);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(l=p[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,o=this.pos;return this.pos=a,a-o>=12&&s0?s0.decode(this.buf.subarray(o,a)):function(l,p,y){for(var w="",E=p;E<y;){var M,k,F,U=l[E],W=null,V=U>239?4:U>223?3:U>191?2:1;if(E+V>y)break;1===V?U<128&&(W=U):2===V?128==(192&(M=l[E+1]))&&(W=(31&U)<<6|63&M)<=127&&(W=null):3===V?(k=l[E+2],128==(192&(M=l[E+1]))&&128==(192&k)&&((W=(15&U)<<12|(63&M)<<6|63&k)<=2047||W>=55296&&W<=57343)&&(W=null)):4===V&&(k=l[E+2],F=l[E+3],128==(192&(M=l[E+1]))&&128==(192&k)&&128==(192&F)&&((W=(15&U)<<18|(63&M)<<12|(63&k)<<6|63&F)<=65535||W>=1114112)&&(W=null)),null===W?(W=65533,V=1):W>65535&&(W-=65536,w+=String.fromCharCode(W>>>10&1023|55296),W=56320|1023&W),w+=String.fromCharCode(W),E+=V}return w}(this.buf,o,a)},readBytes:function(){var a=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,a);return this.pos=a,o},readPackedVarint:function(a,o){if(this.type!==ar.Bytes)return a.push(this.readVarint(o));var l=Ku(this);for(a=a||[];this.pos<l;)a.push(this.readVarint(o));return a},readPackedSVarint:function(a){if(this.type!==ar.Bytes)return a.push(this.readSVarint());var o=Ku(this);for(a=a||[];this.pos<o;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==ar.Bytes)return a.push(this.readBoolean());var o=Ku(this);for(a=a||[];this.pos<o;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==ar.Bytes)return a.push(this.readFloat());var o=Ku(this);for(a=a||[];this.pos<o;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==ar.Bytes)return a.push(this.readDouble());var o=Ku(this);for(a=a||[];this.pos<o;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==ar.Bytes)return a.push(this.readFixed32());var o=Ku(this);for(a=a||[];this.pos<o;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==ar.Bytes)return a.push(this.readSFixed32());var o=Ku(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==ar.Bytes)return a.push(this.readFixed64());var o=Ku(this);for(a=a||[];this.pos<o;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==ar.Bytes)return a.push(this.readSFixed64());var o=Ku(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed64());return a},skip:function(a){var o=7&a;if(o===ar.Varint)for(;this.buf[this.pos++]>127;);else if(o===ar.Bytes)this.pos=this.readVarint()+this.pos;else if(o===ar.Fixed32)this.pos+=4;else{if(o!==ar.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(a,o){this.writeVarint(a<<3|o)},realloc:function(a){for(var o=this.length||16;o<this.pos+a;)o*=2;if(o!==this.length){var l=new Uint8Array(o);l.set(this.buf),this.buf=l,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),$h(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),$h(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),$h(this.buf,-1&a,this.pos),$h(this.buf,Math.floor(a*ay),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),$h(this.buf,-1&a,this.pos),$h(this.buf,Math.floor(a*ay),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(o,l){var p,y,w,M;if(o>=0?(p=o%4294967296|0,y=o/4294967296|0):(y=~(-o/4294967296),4294967295^(p=~(-o%4294967296))?p=p+1|0:(p=0,y=y+1|0)),o>=0x10000000000000000||o<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),w=p,(M=l).buf[M.pos++]=127&w|128,w>>>=7,M.buf[M.pos++]=127&w|128,w>>>=7,M.buf[M.pos++]=127&w|128,w>>>=7,M.buf[M.pos++]=127&w|128,M.buf[M.pos]=127&(w>>>=7),function(w,E){var M=(7&w)<<4;E.buf[E.pos++]|=M|((w>>>=3)?128:0),w&&(E.buf[E.pos++]=127&w|((w>>>=7)?128:0),w&&(E.buf[E.pos++]=127&w|((w>>>=7)?128:0),w&&(E.buf[E.pos++]=127&w|((w>>>=7)?128:0),w&&(E.buf[E.pos++]=127&w|((w>>>=7)?128:0),w&&(E.buf[E.pos++]=127&w)))))}(y,l)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var o=this.pos;this.pos=function(p,y,w){for(var E,M,k=0;k<y.length;k++){if((E=y.charCodeAt(k))>55295&&E<57344){if(!M){E>56319||k+1===y.length?(p[w++]=239,p[w++]=191,p[w++]=189):M=E;continue}if(E<56320){p[w++]=239,p[w++]=191,p[w++]=189,M=E;continue}E=M-55296<<10|E-56320|65536,M=null}else M&&(p[w++]=239,p[w++]=191,p[w++]=189,M=null);E<128?p[w++]=E:(E<2048?p[w++]=E>>6|192:(E<65536?p[w++]=E>>12|224:(p[w++]=E>>18|240,p[w++]=E>>12&63|128),p[w++]=E>>6&63|128),p[w++]=63&E|128)}return w}(this.buf,a,this.pos);var l=this.pos-o;l>=128&&ly(o,l,this),this.pos=o-1,this.writeVarint(l),this.pos+=l},writeFloat:function(a){this.realloc(4),Ax(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),Ax(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var o=a.length;this.writeVarint(o),this.realloc(o);for(var l=0;l<o;l++)this.buf[this.pos++]=a[l]},writeRawMessage:function(a,o){this.pos++;var l=this.pos;a(o,this);var p=this.pos-l;p>=128&&ly(l,p,this),this.pos=l-1,this.writeVarint(p),this.pos+=p},writeMessage:function(a,o,l){this.writeTag(a,ar.Bytes),this.writeRawMessage(o,l)},writePackedVarint:function(a,o){o.length&&this.writeMessage(a,Px,o)},writePackedSVarint:function(a,o){o.length&&this.writeMessage(a,Ox,o)},writePackedBoolean:function(a,o){o.length&&this.writeMessage(a,Rx,o)},writePackedFloat:function(a,o){o.length&&this.writeMessage(a,xm,o)},writePackedDouble:function(a,o){o.length&&this.writeMessage(a,kx,o)},writePackedFixed32:function(a,o){o.length&&this.writeMessage(a,Fx,o)},writePackedSFixed32:function(a,o){o.length&&this.writeMessage(a,Lx,o)},writePackedFixed64:function(a,o){o.length&&this.writeMessage(a,oC,o)},writePackedSFixed64:function(a,o){o.length&&this.writeMessage(a,su,o)},writeBytesField:function(a,o){this.writeTag(a,ar.Bytes),this.writeBytes(o)},writeFixed32Field:function(a,o){this.writeTag(a,ar.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(a,o){this.writeTag(a,ar.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(a,o){this.writeTag(a,ar.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(a,o){this.writeTag(a,ar.Fixed64),this.writeSFixed64(o)},writeVarintField:function(a,o){this.writeTag(a,ar.Varint),this.writeVarint(o)},writeSVarintField:function(a,o){this.writeTag(a,ar.Varint),this.writeSVarint(o)},writeStringField:function(a,o){this.writeTag(a,ar.Bytes),this.writeString(o)},writeFloatField:function(a,o){this.writeTag(a,ar.Fixed32),this.writeFloat(o)},writeDoubleField:function(a,o){this.writeTag(a,ar.Fixed64),this.writeDouble(o)},writeBooleanField:function(a,o){this.writeVarintField(a,Boolean(o))}};class np{constructor(o,{pixelRatio:l,version:p,stretchX:y,stretchY:w,content:E}){this.paddedRect=o,this.pixelRatio=l,this.stretchX=y,this.stretchY=w,this.content=E,this.version=p}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Mg{constructor(o,l){const p={},y={};this.haveRenderCallbacks=[];const w=[];this.addImages(o,p,w),this.addImages(l,y,w);const{w:E,h:M}=uy(w),k=new Ba({width:E||1,height:M||1});for(const F in o){const U=o[F],W=p[F].paddedRect;Ba.copy(U.data,k,{x:0,y:0},{x:W.x+1,y:W.y+1},U.data)}for(const F in l){const U=l[F],W=y[F].paddedRect,V=W.x+1,Q=W.y+1,ie=U.data.width,se=U.data.height;Ba.copy(U.data,k,{x:0,y:0},{x:V,y:Q},U.data),Ba.copy(U.data,k,{x:0,y:se-1},{x:V,y:Q-1},{width:ie,height:1}),Ba.copy(U.data,k,{x:0,y:0},{x:V,y:Q+se},{width:ie,height:1}),Ba.copy(U.data,k,{x:ie-1,y:0},{x:V-1,y:Q},{width:1,height:se}),Ba.copy(U.data,k,{x:0,y:0},{x:V+ie,y:Q},{width:1,height:se})}this.image=k,this.iconPositions=p,this.patternPositions=y}addImages(o,l,p){for(const y in o){const w=o[y],E={x:0,y:0,w:w.data.width+2,h:w.data.height+2};p.push(E),l[y]=new np(E,w),w.hasRenderCallback&&this.haveRenderCallbacks.push(y)}}patchUpdatedImages(o,l){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>o.hasImage(p)),o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in o.updatedImages)this.patchUpdatedImage(this.iconPositions[p],o.getImage(p),l),this.patchUpdatedImage(this.patternPositions[p],o.getImage(p),l)}patchUpdatedImage(o,l,p){if(!o||!l||o.version===l.version)return;o.version=l.version;const[y,w]=o.tl;p.update(l.data,void 0,{x:y,y:w})}}gn(np,"ImagePosition"),gn(Mg,"ImageAtlas");const ll={horizontal:1,vertical:2,horizontalOnly:3};class Ld{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,l){const p=new Ld;return p.scale=o||1,p.fontStack=l,p}static forImage(o){const l=new Ld;return l.imageName=o,l}}class Nd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,l){const p=new Nd;for(let y=0;y<o.sections.length;y++){const w=o.sections[y];w.image?p.addImageSection(w):p.addTextSection(w,l)}return p}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(o){this.text=function(l,p){let y="";for(let w=0;w<l.length;w++){const E=l.charCodeAt(w+1)||null,M=l.charCodeAt(w-1)||null;y+=!p&&(E&&G(E)&&!vm[l[w+1]]||M&&G(M)&&!vm[l[w-1]])||!vm[l[w]]?l[w]:vm[l[w]]}return y}(this.text,o)}trim(){let o=0;for(let p=0;p<this.text.length&&au[this.text.charCodeAt(p)];p++)o++;let l=this.text.length;for(let p=this.text.length-1;p>=0&&p>=o&&au[this.text.charCodeAt(p)];p--)l--;this.text=this.text.substring(o,l),this.sectionIndex=this.sectionIndex.slice(o,l)}substring(o,l){const p=new Nd;return p.text=this.text.substring(o,l),p.sectionIndex=this.sectionIndex.slice(o,l),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,l)=>Math.max(o,this.sections[l].scale),0)}addTextSection(o,l){this.text+=o.text,this.sections.push(Ld.forText(o.scale,o.fontStack||l));const p=this.sections.length-1;for(let y=0;y<o.text.length;++y)this.sectionIndex.push(p)}addImageSection(o){const l=o.image?o.image.name:"";if(0===l.length)return void Ai("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(Ld.forImage(l)),this.sectionIndex.push(this.sections.length-1)):Ai("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function xs(a,o,l,p,y,w,E,M,k,F,U,W,V,Q,ie){const se=Nd.fromFeature(a,y);W===ll.vertical&&se.verticalizePunctuation(V);let te=[];const we=function(Re,lt,tt,wt,jt,ht){if(!Re)return[];const Tt=[],At=function(tn,Yn,mn,Dn,ln,kn){let Li=0;for(let Di=0;Di<tn.length();Di++){const Pi=tn.getSection(Di);Li+=qT(tn.getCharCode(Di),Pi,Dn,ln,Yn,kn)}return Li/Math.max(1,Math.ceil(Li/mn))}(Re,lt,tt,wt,jt,ht),Et=Re.text.indexOf("\u200b")>=0;let Vt=0;for(let tn=0;tn<Re.length();tn++){const Yn=Re.getSection(tn),mn=Re.getCharCode(tn);if(au[mn]||(Vt+=qT(mn,Yn,wt,jt,lt,ht)),tn<Re.length()-1){const Dn=!((ot=mn)<11904||!(Of(ot)||ro(ot)||v(ot)||Sd(ot)||Kc(ot)||$p(ot)||fa(ot)||Oa(ot)||Gp(ot)||Xc(ot)||pa(ot)||C(ot)||xh(ot)||bh(ot)||rg(ot)||Ch(ot)||wh(ot)||Mi(ot)||Eh(ot)||Nu(ot)));(dy[mn]||Dn||Yn.imageName)&&Tt.push(Dg(tn+1,Vt,At,Tt,hy(mn,Re.getCharCode(tn+1),Dn&&Et),!1))}}var ot;return Ag(Dg(Re.length(),Vt,At,Tt,0,!0))}(se,F,w,o,p,Q),{processBidirectionalText:Oe,processStyledBidirectionalText:me}=Ue;if(Oe&&1===se.sections.length){const Re=Oe(se.toString(),we);for(const lt of Re){const tt=new Nd;tt.text=lt,tt.sections=se.sections;for(let wt=0;wt<lt.length;wt++)tt.sectionIndex.push(0);te.push(tt)}}else if(me){const Re=me(se.text,se.sectionIndex,we);for(const lt of Re){const tt=new Nd;tt.text=lt[0],tt.sectionIndex=lt[1],tt.sections=se.sections,te.push(tt)}}else te=function(Re,lt){const tt=[],wt=Re.text;let jt=0;for(const ht of lt)tt.push(Re.substring(jt,ht)),jt=ht;return jt<wt.length&&tt.push(Re.substring(jt,wt.length)),tt}(se,we);const Ae=[],Ee={positionedLines:Ae,text:se.toString(),top:U[1],bottom:U[1],left:U[0],right:U[0],writingMode:W,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Re,lt,tt,wt,jt,ht,Tt,At,Et,Vt,ot,tn){let Yn=0,mn=0,Dn=0;const ln="right"===At?1:"left"===At?0:.5;let kn=!1;for(const ei of jt){const ki=ei.getSections();for(const Ir of ki){if(Ir.imageName)continue;const Vr=lt[Ir.fontStack];if(Vr&&(kn=void 0!==Vr.ascender&&void 0!==Vr.descender,!kn))break}if(!kn)break}let Li=0;for(const ei of jt){ei.trim();const ki=ei.getMaxScale(),Ir=(ki-1)*Kr,Vr={positionedGlyphs:[],lineOffset:0};Re.positionedLines[Li]=Vr;const _r=Vr.positionedGlyphs;let Lr=0;if(!ei.length()){mn+=ht,++Li;continue}let Nr=0,vo=0;for(let yr=0;yr<ei.length();yr++){const Mo=ei.getSection(yr),Do=ei.getSectionIndex(yr),nr=ei.getCharCode(yr);let Ur=Mo.scale,ts=null,wr=null,oo=null,Fs=Kr,ws=0;const zo=!(Et===ll.horizontal||!ot&&!z(nr)||ot&&(au[nr]||(Di=nr,Lu(Di)||vh(Di)||ig(Di)||Hp(Di)||g(Di))));if(Mo.imageName){const ea=wt[Mo.imageName];if(!ea)continue;oo=Mo.imageName,Re.iconsInText=Re.iconsInText||!0,wr=ea.paddedRect;const Bo=ea.displaySize;Ur=Ur*Kr/tn,ts={width:Bo[0],height:Bo[1],left:1,top:-3,advance:zo?Bo[1]:Bo[0],localGlyph:!1},ws=kn?-ts.height*Ur:ki*Kr-17-Bo[1]*Ur,Fs=ts.advance;const cu=(zo?Bo[0]:Bo[1])*Ur-Kr*ki;cu>0&&cu>Lr&&(Lr=cu)}else{const ea=tt[Mo.fontStack];if(!ea)continue;ea[nr]&&(wr=ea[nr]);const Bo=lt[Mo.fontStack];if(!Bo)continue;const cu=Bo.glyphs[nr];if(!cu)continue;if(ts=cu.metrics,Fs=8203!==nr?Kr:0,kn){const up=void 0!==Bo.ascender?Math.abs(Bo.ascender):0,cl=void 0!==Bo.descender?Math.abs(Bo.descender):0,dp=(up+cl)*Ur;Nr<dp&&(Nr=dp,vo=(up-cl)/2*Ur),ws=-up*Ur}else ws=(ki-Ur)*Kr-17}zo?(Re.verticalizable=!0,_r.push({glyph:nr,imageName:oo,x:Yn,y:mn+ws,vertical:zo,scale:Ur,localGlyph:ts.localGlyph,fontStack:Mo.fontStack,sectionIndex:Do,metrics:ts,rect:wr}),Yn+=Fs*Ur+Vt):(_r.push({glyph:nr,imageName:oo,x:Yn,y:mn+ws,vertical:zo,scale:Ur,localGlyph:ts.localGlyph,fontStack:Mo.fontStack,sectionIndex:Do,metrics:ts,rect:wr}),Yn+=ts.advance*Ur+Vt)}0!==_r.length&&(Dn=Math.max(Yn-Vt,Dn),kn?Xu(_r,ln,Lr,vo,ht*ki/2):Xu(_r,ln,Lr,0,ht/2)),Yn=0;const Rs=ht*ki+Lr;Vr.lineOffset=Math.max(Lr,Ir),mn+=Rs,++Li}var Di;const Pi=mn,{horizontalAlign:ni,verticalAlign:mr}=Gh(Tt);(function(ei,ki,Ir,Vr,_r,Lr){const Nr=(ki-Ir)*_r,vo=-Lr*Vr;for(const Rs of ei)for(const yr of Rs.positionedGlyphs)yr.x+=Nr,yr.y+=vo})(Re.positionedLines,ln,ni,mr,Dn,Pi),Re.top+=-mr*Pi,Re.bottom=Re.top+Pi,Re.left+=-ni*Dn,Re.right=Re.left+Dn,Re.hasBaseline=kn}(Ee,o,l,p,te,E,M,k,W,F,V,ie),!function(Re){for(const lt of Re)if(0!==lt.positionedGlyphs.length)return!1;return!0}(Ae)&&Ee}const au={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},dy={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function qT(a,o,l,p,y,w){if(o.imageName){const E=p[o.imageName];return E?E.displaySize[0]*o.scale*Kr/w+y:0}{const E=l[o.fontStack],M=E&&E.glyphs[a];return M?M.metrics.advance*o.scale+y:0}}function Bx(a,o,l,p){const y=Math.pow(a-o,2);return p?a<o?y/2:2*y:y+Math.abs(l)*l}function hy(a,o,l){let p=0;return 10===a&&(p-=1e4),l&&(p+=150),40!==a&&65288!==a||(p+=50),41!==o&&65289!==o||(p+=50),p}function Dg(a,o,l,p,y,w){let E=null,M=Bx(o,l,y,w);for(const k of p){const F=Bx(o-k.x,l,y,w)+k.badness;F<=M&&(E=k,M=F)}return{index:a,x:o,priorBreak:E,badness:M}}function Ag(a){return a?Ag(a.priorBreak).concat(a.index):[]}function Gh(a){let o=.5,l=.5;switch(a){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:o,verticalAlign:l}}function Xu(a,o,l,p,y){if(!(o||l||p||y))return;const w=a.length-1,E=a[w],M=(E.x+E.metrics.advance*E.scale)*o;for(let k=0;k<=w;k++)a[k].x-=M,a[k].y+=l+p+y}function wm(a,o,l){const{horizontalAlign:p,verticalAlign:y}=Gh(l),w=o[0]-a.displaySize[0]*p,E=o[1]-a.displaySize[1]*y;return{image:a,top:E,bottom:E+a.displaySize[1],left:w,right:w+a.displaySize[0]}}function Pg(a,o,l,p,y,w){const E=a.image;let M;if(E.content){const te=E.content,we=E.pixelRatio||1;M=[te[0]/we,te[1]/we,E.displaySize[0]-te[2]/we,E.displaySize[1]-te[3]/we]}const k=o.left*w,F=o.right*w;let U,W,V,Q;"width"===l||"both"===l?(Q=y[0]+k-p[3],W=y[0]+F+p[1]):(Q=y[0]+(k+F-E.displaySize[0])/2,W=Q+E.displaySize[0]);const ie=o.top*w,se=o.bottom*w;return"height"===l||"both"===l?(U=y[1]+ie-p[0],V=y[1]+se+p[2]):(U=y[1]+(ie+se-E.displaySize[1])/2,V=U+E.displaySize[1]),{image:E,top:U,right:W,bottom:V,left:Q,collisionPadding:M}}class yc extends Ye{constructor(o,l,p,y,w){super(o,l),this.angle=y,this.z=p,void 0!==w&&(this.segment=w)}clone(){return new yc(this.x,this.y,this.z,this.angle,this.segment)}}function sC(a,o,l,p,y){if(void 0===o.segment)return!0;let w=o,E=o.segment+1,M=0;for(;M>-l/2;){if(E--,E<0)return!1;M-=a[E].dist(w),w=a[E]}M+=a[E].dist(a[E+1]),E++;const k=[];let F=0;for(;M<l/2;){const U=a[E],W=a[E+1];if(!W)return!1;let V=a[E-1].angleTo(U)-U.angleTo(W);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:M,angleDelta:V}),F+=V;M-k[0].distance>p;)F-=k.shift().angleDelta;if(F>y)return!1;E++,M+=U.dist(W)}return!0}function Vx(a){let o=0;for(let l=0;l<a.length-1;l++)o+=a[l].dist(a[l+1]);return o}function Ux(a,o,l){return a?.6*o*l:0}function aC(a,o){return Math.max(a?a.right-a.left:0,o?o.right-o.left:0)}function ZT(a,o,l,p,y,w){const E=Ux(l,y,w),M=aC(l,p)*w;let k=0;const F=Vx(a)/2;for(let U=0;U<a.length-1;U++){const W=a[U],V=a[U+1],Q=W.dist(V);if(k+Q>F){const ie=(F-k)/Q,se=di(W.x,V.x,ie),te=di(W.y,V.y,ie),we=new yc(se,te,0,V.angleTo(W),U);return!E||sC(a,we,M,E,o)?we:void 0}k+=Q}}function fy(a,o,l,p,y,w,E,M,k){const F=Ux(p,w,E),U=aC(p,y),W=U*E,V=0===a[0].x||a[0].x===k||0===a[0].y||a[0].y===k;return o-W<o/4&&(o=W+o/4),jx(a,V?o/2*M%o:(U/2+2*w)*E*M%o,o,F,l,W,V,!1,k)}function jx(a,o,l,p,y,w,E,M,k){const F=w/2,U=Vx(a);let W=0,V=o-l,Q=[];for(let ie=0;ie<a.length-1;ie++){const se=a[ie],te=a[ie+1],we=se.dist(te),Oe=te.angleTo(se);for(;V+l<W+we;){V+=l;const me=(V-W)/we,Ae=di(se.x,te.x,me),Ee=di(se.y,te.y,me);if(Ae>=0&&Ae<k&&Ee>=0&&Ee<k&&V-F>=0&&V+F<=U){const Re=new yc(Ae,Ee,0,Oe,ie);Re._round(),p&&!sC(a,Re,w,p,y)||Q.push(Re)}}W+=we}return M||Q.length||E||(Q=jx(a,W/2,l,p,y,w,E,!0,k)),Q}function $x(a,o,l,p,y){const w=[];for(let E=0;E<a.length;E++){const M=a[E];let k;for(let F=0;F<M.length-1;F++){let U=M[F],W=M[F+1];U.x<o&&W.x<o||(U.x<o?U=new Ye(o,U.y+(o-U.x)/(W.x-U.x)*(W.y-U.y))._round():W.x<o&&(W=new Ye(o,U.y+(o-U.x)/(W.x-U.x)*(W.y-U.y))._round()),U.y<l&&W.y<l||(U.y<l?U=new Ye(U.x+(l-U.y)/(W.y-U.y)*(W.x-U.x),l)._round():W.y<l&&(W=new Ye(U.x+(l-U.y)/(W.y-U.y)*(W.x-U.x),l)._round()),U.x>=p&&W.x>=p||(U.x>=p?U=new Ye(p,U.y+(p-U.x)/(W.x-U.x)*(W.y-U.y))._round():W.x>=p&&(W=new Ye(p,U.y+(p-U.x)/(W.x-U.x)*(W.y-U.y))._round()),U.y>=y&&W.y>=y||(U.y>=y?U=new Ye(U.x+(y-U.y)/(W.y-U.y)*(W.x-U.x),y)._round():W.y>=y&&(W=new Ye(U.x+(y-U.y)/(W.y-U.y)*(W.x-U.x),y)._round()),k&&U.equals(k[k.length-1])||(k=[U],w.push(k)),k.push(W)))))}}return w}gn(yc,"Anchor");const Og=1e20;function Gx(a,o,l,p,y,w,E,M,k){for(let F=o;F<o+p;F++)Hx(a,l*w+F,w,y,E,M,k);for(let F=l;F<l+y;F++)Hx(a,F*w+o,1,p,E,M,k)}function Hx(a,o,l,p,y,w,E){w[0]=0,E[0]=-Og,E[1]=Og,y[0]=a[o];for(let M=1,k=0,F=0;M<p;M++){y[M]=a[o+M*l];const U=M*M;do{const W=w[k];F=(y[M]-y[W]+U-W*W)/(M-W)/2}while(F<=E[k]&&--k>-1);k++,w[k]=M,E[k]=F,E[k+1]=Og}for(let M=0,k=0;M<p;M++){for(;E[k+1]<M;)k++;const F=w[k],U=M-F;a[o+M*l]=y[F]+U*U}}const kg={none:0,ideographs:1,all:2};class Qu{constructor(o,l,p){this.requestManager=o,this.localGlyphMode=l,this.localFontFamily=p,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o){this.url=o}getGlyphs(o,l){const p=[];for(const y in o)for(const w of o[y])p.push({stack:y,id:w});On(p,({stack:y,id:w},E)=>{let M=this.entries[y];M||(M=this.entries[y]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let k=M.glyphs[w];if(void 0!==k)return void E(null,{stack:y,id:w,glyph:k});if(k=this._tinySDF(M,y,w),k)return M.glyphs[w]=k,void E(null,{stack:y,id:w,glyph:k});const F=Math.floor(w/256);if(256*F>65535)return void E(new Error("glyphs > 65535 not supported"));if(M.ranges[F])return void E(null,{stack:y,id:w,glyph:k});let U=M.requests[F];U||(U=M.requests[F]=[],Qu.loadGlyphRange(y,F,this.url,this.requestManager,(W,V)=>{if(V){M.ascender=V.ascender,M.descender=V.descender;for(const Q in V.glyphs)this._doesCharSupportLocalGlyph(+Q)||(M.glyphs[+Q]=V.glyphs[+Q]);M.ranges[F]=!0}for(const Q of U)Q(W,V);delete M.requests[F]})),U.push((W,V)=>{W?E(W):V&&E(null,{stack:y,id:w,glyph:V.glyphs[w]||null})})},(y,w)=>{if(y)l(y);else if(w){const E={};for(const{stack:M,id:k,glyph:F}of w)void 0===E[M]&&(E[M]={}),void 0===E[M].glyphs&&(E[M].glyphs={}),E[M].glyphs[k]=F&&{id:F.id,bitmap:F.bitmap.clone(),metrics:F.metrics},E[M].ascender=this.entries[M].ascender,E[M].descender=this.entries[M].descender;l(null,E)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==kg.none&&(this.localGlyphMode===kg.all?!!this.localFontFamily:!!this.localFontFamily&&(Xc(o)||og(o)||xh(o)||wh(o)||Oa(o)))}_tinySDF(o,l,p){const y=this.localFontFamily;if(!y||!this._doesCharSupportLocalGlyph(p))return;let w=o.tinySDF;if(!w){let se="400";/bold/i.test(l)?se="900":/medium/i.test(l)?se="500":/light/i.test(l)&&(se="200"),w=o.tinySDF=new Qu.TinySDF({fontFamily:y,fontWeight:se,fontSize:48,buffer:6,radius:16}),w.fontWeight=se}if(this.localGlyphs[w.fontWeight][p])return this.localGlyphs[w.fontWeight][p];const E=String.fromCharCode(p),{data:M,width:k,height:F,glyphWidth:U,glyphHeight:W,glyphLeft:V,glyphTop:Q,glyphAdvance:ie}=w.draw(E);return this.localGlyphs[w.fontWeight][p]={id:p,bitmap:new Qs({width:k,height:F},M),metrics:{width:U/2,height:W/2,left:V/2,top:Q/2-27,advance:ie/2,localGlyph:!0}}}}function Rg(a,o,l,p){const y=[],w=a.image,E=w.pixelRatio,M=w.paddedRect.w-2,k=w.paddedRect.h-2,F=a.right-a.left,U=a.bottom-a.top,W=w.stretchX||[[0,M]],V=w.stretchY||[[0,k]],Q=(ht,Tt)=>ht+Tt[1]-Tt[0],ie=W.reduce(Q,0),se=V.reduce(Q,0),te=M-ie,we=k-se;let Oe=0,me=ie,Ae=0,Ee=se,Re=0,lt=te,tt=0,wt=we;if(w.content&&p){const ht=w.content;Oe=zd(W,0,ht[0]),Ae=zd(V,0,ht[1]),me=zd(W,ht[0],ht[2]),Ee=zd(V,ht[1],ht[3]),Re=ht[0]-Oe,tt=ht[1]-Ae,lt=ht[2]-ht[0]-me,wt=ht[3]-ht[1]-Ee}const jt=(ht,Tt,At,Et)=>{const Vt=Hh(ht.stretch-Oe,me,F,a.left),ot=py(ht.fixed-Re,lt,ht.stretch,ie),tn=Hh(Tt.stretch-Ae,Ee,U,a.top),Yn=py(Tt.fixed-tt,wt,Tt.stretch,se),mn=Hh(At.stretch-Oe,me,F,a.left),Dn=py(At.fixed-Re,lt,At.stretch,ie),ln=Hh(Et.stretch-Ae,Ee,U,a.top),kn=py(Et.fixed-tt,wt,Et.stretch,se),Li=new Ye(Vt,tn),Di=new Ye(mn,tn),Pi=new Ye(mn,ln),ni=new Ye(Vt,ln),mr=new Ye(ot/E,Yn/E),ei=new Ye(Dn/E,kn/E),ki=o*Math.PI/180;if(ki){const _r=Math.sin(ki),Lr=Math.cos(ki),Nr=[Lr,-_r,_r,Lr];Li._matMult(Nr),Di._matMult(Nr),ni._matMult(Nr),Pi._matMult(Nr)}const Ir=ht.stretch+ht.fixed,Vr=Tt.stretch+Tt.fixed;return{tl:Li,tr:Di,bl:ni,br:Pi,tex:{x:w.paddedRect.x+1+Ir,y:w.paddedRect.y+1+Vr,w:At.stretch+At.fixed-Ir,h:Et.stretch+Et.fixed-Vr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:mr,pixelOffsetBR:ei,minFontScaleX:lt/E/F,minFontScaleY:wt/E/U,isSDF:l}};if(p&&(w.stretchX||w.stretchY)){const ht=ip(W,te,ie),Tt=ip(V,we,se);for(let At=0;At<ht.length-1;At++){const Et=ht[At],Vt=ht[At+1];for(let ot=0;ot<Tt.length-1;ot++)y.push(jt(Et,Tt[ot],Vt,Tt[ot+1]))}}else y.push(jt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:k+1}));return y}function zd(a,o,l){let p=0;for(const y of a)p+=Math.max(o,Math.min(l,y[1]))-Math.max(o,Math.min(l,y[0]));return p}function ip(a,o,l){const p=[{fixed:-1,stretch:0}];for(const[y,w]of a){const E=p[p.length-1];p.push({fixed:y-E.stretch,stretch:E.stretch}),p.push({fixed:y-E.stretch,stretch:E.stretch+(w-y)})}return p.push({fixed:o+1,stretch:l}),p}function Hh(a,o,l,p){return a/o*l+p}function py(a,o,l,p){return a-o*l/p}function Fg(a,o,l,p){const y=o+a.positionedLines[p].lineOffset;return 0===p?l+y/2:l+(y+(o+a.positionedLines[p-1].lineOffset))/2}Qu.loadGlyphRange=function(a,o,l,p,y){const w=256*o,E=w+255,M=p.transformRequest(p.normalizeGlyphsURL(l).replace("{fontstack}",a).replace("{range}",`${w}-${E}`),jn.Glyphs);Jr(M,(k,F)=>{if(k)y(k);else if(F){const U={},W=new Ar(F).readFields(cy,{});for(const V of W.glyphs)U[V.id]=V;y(null,{glyphs:U,ascender:W.ascender,descender:W.descender})}})},Qu.TinySDF=class{constructor({fontSize:a=24,buffer:o=3,radius:l=8,cutoff:p=.25,fontFamily:y="sans-serif",fontWeight:w="normal",fontStyle:E="normal"}={}){this.buffer=o,this.cutoff=p,this.radius=l;const M=this.size=a+4*o,k=this._createCanvas(M),F=this.ctx=k.getContext("2d",{willReadFrequently:!0});F.font=`${E} ${w} ${a}px ${y}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(a){const o=document.createElement("canvas");return o.width=o.height=a,o}draw(a){const{width:o,actualBoundingBoxAscent:l,actualBoundingBoxDescent:p,actualBoundingBoxLeft:y,actualBoundingBoxRight:w}=this.ctx.measureText(a),E=Math.ceil(l),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-y))),k=Math.min(this.size-this.buffer,E+Math.ceil(p)),F=M+2*this.buffer,U=k+2*this.buffer,W=Math.max(F*U,0),V=new Uint8ClampedArray(W),Q={data:V,width:F,height:U,glyphWidth:M,glyphHeight:k,glyphTop:E,glyphLeft:0,glyphAdvance:o};if(0===M||0===k)return Q;const{ctx:ie,buffer:se,gridInner:te,gridOuter:we}=this;ie.clearRect(se,se,M,k),ie.fillText(a,se,se+E);const Oe=ie.getImageData(se,se,M,k);we.fill(Og,0,W),te.fill(0,0,W);for(let me=0;me<k;me++)for(let Ae=0;Ae<M;Ae++){const Ee=Oe.data[4*(me*M+Ae)+3]/255;if(0===Ee)continue;const Re=(me+se)*F+Ae+se;if(1===Ee)we[Re]=0,te[Re]=Og;else{const lt=.5-Ee;we[Re]=lt>0?lt*lt:0,te[Re]=lt<0?lt*lt:0}}Gx(we,0,0,F,U,F,this.f,this.v,this.z),Gx(te,se,se,M,k,F,this.f,this.v,this.z);for(let me=0;me<W;me++){const Ae=Math.sqrt(we[me])-Math.sqrt(te[me]);V[me]=Math.round(255-255*(Ae/this.radius+this.cutoff))}return Q}};class lC{constructor(o=[],l=my){if(this.data=o,this.length=this.data.length,this.compare=l,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const o=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:l,compare:p}=this,y=l[o];for(;o>0;){const w=o-1>>1,E=l[w];if(p(y,E)>=0)break;l[o]=E,o=w}l[o]=y}_down(o){const{data:l,compare:p}=this,y=this.length>>1,w=l[o];for(;o<y;){let E=1+(o<<1),M=l[E];const k=E+1;if(k<this.length&&p(l[k],M)<0&&(E=k,M=l[k]),p(M,w)>=0)break;l[o]=M,o=E}l[o]=w}}function my(a,o){return a<o?-1:a>o?1:0}function qx(a,o=1,l=!1){let p=1/0,y=1/0,w=-1/0,E=-1/0;const M=a[0];for(let Q=0;Q<M.length;Q++){const ie=M[Q];(!Q||ie.x<p)&&(p=ie.x),(!Q||ie.y<y)&&(y=ie.y),(!Q||ie.x>w)&&(w=ie.x),(!Q||ie.y>E)&&(E=ie.y)}const k=Math.min(w-p,E-y);let F=k/2;const U=new lC([],Zx);if(0===k)return new Ye(p,y);for(let Q=p;Q<w;Q+=k)for(let ie=y;ie<E;ie+=k)U.push(new Bd(Q+F,ie+F,F,a));let W=function(Q){let ie=0,se=0,te=0;const we=Q[0];for(let Oe=0,me=we.length,Ae=me-1;Oe<me;Ae=Oe++){const Ee=we[Oe],Re=we[Ae],lt=Ee.x*Re.y-Re.x*Ee.y;se+=(Ee.x+Re.x)*lt,te+=(Ee.y+Re.y)*lt,ie+=3*lt}return new Bd(se/ie,te/ie,0,Q)}(a),V=U.length;for(;U.length;){const Q=U.pop();(Q.d>W.d||!W.d)&&(W=Q,l&&console.log("found best %d after %d probes",Math.round(1e4*Q.d)/1e4,V)),Q.max-W.d<=o||(F=Q.h/2,U.push(new Bd(Q.p.x-F,Q.p.y-F,F,a)),U.push(new Bd(Q.p.x+F,Q.p.y-F,F,a)),U.push(new Bd(Q.p.x-F,Q.p.y+F,F,a)),U.push(new Bd(Q.p.x+F,Q.p.y+F,F,a)),V+=4)}return l&&(console.log(`num probes: ${V}`),console.log(`best distance: ${W.d}`)),W.p}function Zx(a,o){return o.max-a.max}function Bd(a,o,l,p){this.p=new Ye(a,o),this.h=l,this.d=function(y,w){let E=!1,M=1/0;for(let k=0;k<w.length;k++){const F=w[k];for(let U=0,W=F.length,V=W-1;U<W;V=U++){const Q=F[U],ie=F[V];Q.y>y.y!=ie.y>y.y&&y.x<(ie.x-Q.x)*(y.y-Q.y)/(ie.y-Q.y)+Q.x&&(E=!E),M=Math.min(M,Bh(y,Q,ie))}}return(E?1:-1)*Math.sqrt(M)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}const rp=Number.POSITIVE_INFINITY,WT=Math.sqrt(2);function Wx(a,[o,l]){let p=0,y=0;if(l===rp){o<0&&(o=0);const w=o/WT;switch(a){case"top-right":case"top-left":y=w-7;break;case"bottom-right":case"bottom-left":y=7-w;break;case"bottom":y=7-o;break;case"top":y=o-7}switch(a){case"top-right":case"bottom-right":p=-w;break;case"top-left":case"bottom-left":p=w;break;case"left":p=o;break;case"right":p=-o}}else{switch(o=Math.abs(o),l=Math.abs(l),a){case"top-right":case"top-left":case"top":y=l-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-l}switch(a){case"top-right":case"bottom-right":case"right":p=-o;break;case"top-left":case"bottom-left":case"left":p=o}}return[p,y]}function l0(a,o,l,p,y,w,E,M,k,F){a.createArrays(),a.tilePixelRatio=Jn/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const U=a.layers[0].layout,W=a.layers[0]._unevaluatedLayout._values,V={};if("composite"===a.textSizeData.kind){const{minZoom:se,maxZoom:te}=a.textSizeData;V.compositeTextSizes=[W["text-size"].possiblyEvaluate(new We(se),M),W["text-size"].possiblyEvaluate(new We(te),M)]}if("composite"===a.iconSizeData.kind){const{minZoom:se,maxZoom:te}=a.iconSizeData;V.compositeIconSizes=[W["icon-size"].possiblyEvaluate(new We(se),M),W["icon-size"].possiblyEvaluate(new We(te),M)]}V.layoutTextSize=W["text-size"].possiblyEvaluate(new We(k+1),M),V.layoutIconSize=W["icon-size"].possiblyEvaluate(new We(k+1),M),V.textMaxSize=W["text-size"].possiblyEvaluate(new We(18),M);const Q="map"===U.get("text-rotation-alignment")&&"point"!==U.get("symbol-placement"),ie=U.get("text-size");for(const se of a.features){const te=U.get("text-font").evaluate(se,{},M).join(","),we=ie.evaluate(se,{},M),Oe=V.layoutTextSize.evaluate(se,{},M),me=(V.layoutIconSize.evaluate(se,{},M),{horizontal:{},vertical:void 0}),Ae=se.text;let Ee,Re=[0,0];if(Ae){const wt=Ae.toString(),jt=U.get("text-letter-spacing").evaluate(se,{},M)*Kr,ht=U.get("text-line-height").evaluate(se,{},M)*Kr,Tt=D(wt)?jt:0,At=U.get("text-anchor").evaluate(se,{},M),Et=U.get("text-variable-anchor");if(!Et){const mn=U.get("text-radial-offset").evaluate(se,{},M);Re=mn?Wx(At,[mn*Kr,rp]):U.get("text-offset").evaluate(se,{},M).map(Dn=>Dn*Kr)}let Vt=Q?"center":U.get("text-justify").evaluate(se,{},M);const ot="point"===U.get("symbol-placement"),tn=ot?U.get("text-max-width").evaluate(se,{},M)*Kr:1/0,Yn=mn=>{a.allowVerticalPlacement&&S(wt)&&(me.vertical=xs(Ae,o,l,y,te,tn,ht,At,mn,Tt,Re,ll.vertical,!0,Oe,we))};if(!Q&&Et){const mn="auto"===Vt?Et.map(ln=>Yx(ln)):[Vt];let Dn=!1;for(let ln=0;ln<mn.length;ln++){const kn=mn[ln];if(!me.horizontal[kn])if(Dn)me.horizontal[kn]=me.horizontal[0];else{const Li=xs(Ae,o,l,y,te,tn,ht,"center",kn,Tt,Re,ll.horizontal,!1,Oe,we);Li&&(me.horizontal[kn]=Li,Dn=1===Li.positionedLines.length)}}Yn("left")}else{if("auto"===Vt&&(Vt=Yx(At)),ot||U.get("text-writing-mode").indexOf("horizontal")>=0||!S(wt)){const mn=xs(Ae,o,l,y,te,tn,ht,At,Vt,Tt,Re,ll.horizontal,!1,Oe,we);mn&&(me.horizontal[Vt]=mn)}Yn(ot?"left":Vt)}}let lt=!1;if(se.icon&&se.icon.name){const wt=p[se.icon.name];wt&&(Ee=wm(y[se.icon.name],U.get("icon-offset").evaluate(se,{},M),U.get("icon-anchor").evaluate(se,{},M)),lt=wt.sdf,void 0===a.sdfIcons?a.sdfIcons=wt.sdf:a.sdfIcons!==wt.sdf&&Ai("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(wt.pixelRatio!==a.pixelRatio||0!==U.get("icon-rotate").constantOr(1))&&(a.iconsNeedLinear=!0))}const tt=Vd(me.horizontal)||me.vertical;a.iconsInText||(a.iconsInText=!!tt&&tt.iconsInText),(tt||Ee)&&Cm(a,se,me,Ee,p,V,Oe,0,Re,lt,E,M,F)}w&&a.generateCollisionDebugBuffers(k,a.collisionBoxArray)}function Yx(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Cm(a,o,l,p,y,w,E,M,k,F,U,W,V){let Q=w.textMaxSize.evaluate(o,{},W);void 0===Q&&(Q=E);const ie=a.layers[0].layout,se=ie.get("icon-offset").evaluate(o,{},W),te=Vd(l.horizontal)||l.vertical,we="globe"===V.name,Oe=E/24,me=a.tilePixelRatio*Q/24,Ae=(Tt=a.overscaling,a.zoom>18&&Tt>2&&(Tt>>=1),Math.max(Jn/(512*Tt),1)*ie.get("symbol-spacing")),Ee=ie.get("text-padding")*a.tilePixelRatio,Re=ie.get("icon-padding")*a.tilePixelRatio,lt=xt(ie.get("text-max-angle")),tt="map"===ie.get("text-rotation-alignment")&&"point"!==ie.get("symbol-placement"),wt="map"===ie.get("icon-rotation-alignment")&&"point"!==ie.get("symbol-placement"),jt=ie.get("symbol-placement"),ht=Ae/2;var Tt;const At=ie.get("icon-text-fit");let Et;p&&"none"!==At&&(a.allowVerticalPlacement&&l.vertical&&(Et=Pg(p,l.vertical,At,ie.get("icon-text-fit-padding"),se,Oe)),te&&(p=Pg(p,te,At,ie.get("icon-text-fit-padding"),se,Oe)));const Vt=(ot,tn,Yn)=>{if(tn.x<0||tn.x>=Jn||tn.y<0||tn.y>=Jn)return;let mn=null;if(we){const{x:Dn,y:ln,z:kn}=V.projectTilePoint(tn.x,tn.y,Yn);mn={anchor:new yc(Dn,ln,kn,0,void 0),up:V.upVector(Yn,tn.x,tn.y)}}!function(Dn,ln,kn,Li,Di,Pi,ni,mr,ei,ki,Ir,Vr,_r,Lr,Nr,vo,Rs,yr,Mo,Do,nr,Ur,ts,wr,oo){const Fs=Dn.addToLineVertexArray(ln,Li);let ws,zo,ea,Bo,cu,up,cl,dp=0,I0=0,Jh=0,ow=0,ef=-1,Ay=-1;const Bl={};let Zg=Pl("");const tf=kn?kn.anchor:ln;let fi=0,Py=0;if(void 0===ei._unevaluatedLayout.getValue("text-radial-offset")?[fi,Py]=ei.layout.get("text-offset").evaluate(nr,{},oo).map(xa=>xa*Kr):(fi=ei.layout.get("text-radial-offset").evaluate(nr,{},oo)*Kr,Py=rp),Dn.allowVerticalPlacement&&Di.vertical){const xa=Di.vertical;if(Nr)up=Em(xa),mr&&(cl=Em(mr));else{const Hs=ei.layout.get("text-rotate").evaluate(nr,{},oo)+90;ea=op(ki,tf,ln,Ir,Vr,_r,xa,Lr,Hs,vo),mr&&(Bo=op(ki,tf,ln,Ir,Vr,_r,mr,yr,Hs))}}if(Pi){const xa=ei.layout.get("icon-rotate").evaluate(nr,{},oo),Hs="none"!==ei.layout.get("icon-text-fit"),rf=Rg(Pi,xa,ts,Hs),bo=mr?Rg(mr,xa,ts,Hs):void 0;zo=op(ki,tf,ln,Ir,Vr,_r,Pi,yr,xa),dp=4*rf.length;const S0=Dn.iconSizeData;let ed=null;"source"===S0.kind?(ed=[_c*ei.layout.get("icon-size").evaluate(nr,{},oo)],ed[0]>Ll&&Ai(`${Dn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===S0.kind&&(ed=[_c*Ur.compositeIconSizes[0].evaluate(nr,{},oo),_c*Ur.compositeIconSizes[1].evaluate(nr,{},oo)],(ed[0]>Ll||ed[1]>Ll)&&Ai(`${Dn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Dn.addSymbols(Dn.icon,rf,ed,Do,Mo,nr,!1,kn,ln,Fs.lineStartIndex,Fs.lineLength,-1,wr,oo),ef=Dn.icon.placedSymbolArray.length-1,bo&&(I0=4*bo.length,Dn.addSymbols(Dn.icon,bo,ed,Do,Mo,nr,ll.vertical,kn,ln,Fs.lineStartIndex,Fs.lineLength,-1,wr,oo),Ay=Dn.icon.placedSymbolArray.length-1)}for(const xa in Di.horizontal){const Hs=Di.horizontal[xa];ws||(Zg=Pl(Hs.text),Nr?cu=Em(Hs):ws=op(ki,tf,ln,Ir,Vr,_r,Hs,Lr,ei.layout.get("text-rotate").evaluate(nr,{},oo),vo));const rf=1===Hs.positionedLines.length;if(Jh+=gy(Dn,kn,ln,Hs,ni,ei,Nr,nr,vo,Fs,Di.vertical?ll.horizontal:ll.horizontalOnly,rf?Object.keys(Di.horizontal):[xa],Bl,ef,Ur,wr,oo),rf)break}Di.vertical&&(ow+=gy(Dn,kn,ln,Di.vertical,ni,ei,Nr,nr,vo,Fs,ll.vertical,["vertical"],Bl,Ay,Ur,wr,oo));let nf=-1;const Oy=(xa,Hs)=>xa?Math.max(xa,Hs):Hs;nf=Oy(cu,nf),nf=Oy(up,nf),nf=Oy(cl,nf);const hp=nf>-1?1:0;Dn.glyphOffsetArray.length>=Gd.MAX_GLYPHS&&Ai("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==nr.sortKey&&Dn.addToSortKeyRanges(Dn.symbolInstances.length,nr.sortKey),Dn.symbolInstances.emplaceBack(tf.x,tf.y,tf.z,ln.x,ln.y,Bl.right>=0?Bl.right:-1,Bl.center>=0?Bl.center:-1,Bl.left>=0?Bl.left:-1,Bl.vertical>=0?Bl.vertical:-1,ef,Ay,Zg,void 0!==ws?ws:Dn.collisionBoxArray.length,void 0!==ws?ws+1:Dn.collisionBoxArray.length,void 0!==ea?ea:Dn.collisionBoxArray.length,void 0!==ea?ea+1:Dn.collisionBoxArray.length,void 0!==zo?zo:Dn.collisionBoxArray.length,void 0!==zo?zo+1:Dn.collisionBoxArray.length,Bo||Dn.collisionBoxArray.length,Bo?Bo+1:Dn.collisionBoxArray.length,Ir,Jh,ow,dp,I0,hp,0,fi,Py,nf)}(a,tn,mn,ot,l,p,y,Et,a.layers[0],a.collisionBoxArray,o.index,o.sourceLayerIndex,a.index,Ee,tt,k,0,Re,wt,se,o,w,F,U,W)};if("line"===jt)for(const ot of $x(o.geometry,0,0,Jn,Jn)){const tn=fy(ot,Ae,lt,l.vertical||te,p,24,me,a.overscaling,Jn);for(const Yn of tn)te&&c0(a,te.text,ht,Yn)||Vt(ot,Yn,W)}else if("line-center"===jt){for(const ot of o.geometry)if(ot.length>1){const tn=ZT(ot,lt,l.vertical||te,p,24,me);tn&&Vt(ot,tn,W)}}else if("Polygon"===o.type)for(const ot of q_(o.geometry,0)){const tn=qx(ot,16);Vt(ot[0],new yc(tn.x,tn.y,0,0,void 0),W)}else if("LineString"===o.type)for(const ot of o.geometry)Vt(ot,new yc(ot[0].x,ot[0].y,0,0,void 0),W);else if("Point"===o.type)for(const ot of o.geometry)for(const tn of ot)Vt([tn],new yc(tn.x,tn.y,0,0,void 0),W)}const Ll=32640;function gy(a,o,l,p,y,w,E,M,k,F,U,W,V,Q,ie,se,te){const we=function(Ae,Ee,Re,lt,tt,wt,jt,ht){const Tt=[];if(0===Ee.positionedLines.length)return Tt;const At=lt.layout.get("text-rotate").evaluate(wt,{})*Math.PI/180,Et=function(mn){const Dn=mn[0],ln=mn[1],kn=Dn*ln;return kn>0?[Dn,-ln]:kn<0?[-Dn,ln]:0===Dn?[ln,Dn]:[ln,-Dn]}(Re);let Vt=Math.abs(Ee.top-Ee.bottom);for(const mn of Ee.positionedLines)Vt-=mn.lineOffset;const ot=Ee.positionedLines.length,tn=Vt/ot;let Yn=Ee.top-Re[1];for(let mn=0;mn<ot;++mn){const Dn=Ee.positionedLines[mn];Yn=Fg(Ee,tn,Yn,mn);for(const ln of Dn.positionedGlyphs){if(!ln.rect)continue;const kn=ln.rect||{};let Li=4,Di=!0,Pi=1,ni=0;if(ln.imageName){const wr=jt[ln.imageName];if(!wr)continue;if(wr.sdf){Ai("SDF images are not supported in formatted text and will be ignored.");continue}Di=!1,Pi=wr.pixelRatio,Li=1/Pi}const mr=(tt||ht)&&ln.vertical,ei=ln.metrics.advance*ln.scale/2,ki=ln.metrics,Ir=ln.rect;if(null===Ir)continue;ht&&Ee.verticalizable&&(ni=ln.imageName?ei-ln.metrics.width*ln.scale/2:0);const Vr=tt?[ln.x+ei,ln.y]:[0,0];let _r=[0,0],Lr=[0,0],Nr=!1;tt||(mr?(Lr=[ln.x+ei+Et[0],ln.y+Et[1]-ni],Nr=!0):_r=[ln.x+ei+Re[0],ln.y+Re[1]-ni]);const vo=Ir.w*ln.scale/(Pi*(ln.localGlyph?2:1)),Rs=Ir.h*ln.scale/(Pi*(ln.localGlyph?2:1));let yr,Mo,Do,nr;if(mr){const wr=ln.y-Yn,oo=new Ye(-ei,ei-wr),Fs=-Math.PI/2,ws=new Ye(...Lr);yr=new Ye(-ei+_r[0],_r[1]),yr._rotateAround(Fs,oo)._add(ws),yr.x+=-wr+ei,yr.y-=(ki.left-Li)*ln.scale;const zo=ln.imageName?ki.advance*ln.scale:Kr*ln.scale,ea=String.fromCharCode(ln.glyph);jh(ea)?yr.x+=(1-Li)*ln.scale:Dx(ea)?yr.x+=zo-ki.height*ln.scale+(-Li-1)*ln.scale:yr.x+=ln.imageName||ki.width+2*Li===Ir.w&&ki.height+2*Li===Ir.h?(zo-Rs)/2:(zo-(ki.height+2*Li)*ln.scale)/2,Mo=new Ye(yr.x,yr.y-vo),Do=new Ye(yr.x+Rs,yr.y),nr=new Ye(yr.x+Rs,yr.y-vo)}else{const wr=(ki.left-Li)*ln.scale-ei+_r[0],oo=(-ki.top-Li)*ln.scale+_r[1],Fs=wr+vo,ws=oo+Rs;yr=new Ye(wr,oo),Mo=new Ye(Fs,oo),Do=new Ye(wr,ws),nr=new Ye(Fs,ws)}if(At){let wr;wr=tt?new Ye(0,0):Nr?new Ye(Et[0],Et[1]):new Ye(Re[0],Re[1]),yr._rotateAround(At,wr),Mo._rotateAround(At,wr),Do._rotateAround(At,wr),nr._rotateAround(At,wr)}const Ur=new Ye(0,0),ts=new Ye(0,0);Tt.push({tl:yr,tr:Mo,bl:Do,br:nr,tex:kn,writingMode:Ee.writingMode,glyphOffset:Vr,sectionIndex:ln.sectionIndex,isSDF:Di,pixelOffsetTL:Ur,pixelOffsetBR:ts,minFontScaleX:0,minFontScaleY:0})}}return Tt}(0,p,k,w,E,M,y,a.allowVerticalPlacement),Oe=a.textSizeData;let me=null;"source"===Oe.kind?(me=[_c*w.layout.get("text-size").evaluate(M,{},te)],me[0]>Ll&&Ai(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===Oe.kind&&(me=[_c*ie.compositeTextSizes[0].evaluate(M,{},te),_c*ie.compositeTextSizes[1].evaluate(M,{},te)],(me[0]>Ll||me[1]>Ll)&&Ai(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,we,me,k,E,M,U,o,l,F.lineStartIndex,F.lineLength,Q,se,te);for(const Ae of W)V[Ae]=a.text.placedSymbolArray.length-1;return 4*we.length}function Vd(a){for(const o in a)return a[o];return null}function op(a,o,l,p,y,w,E,M,k,F){let U=E.top,W=E.bottom,V=E.left,Q=E.right;const ie=E.collisionPadding;if(ie&&(V-=ie[0],U-=ie[1],Q+=ie[2],W+=ie[3]),k){const se=new Ye(V,U),te=new Ye(Q,U),we=new Ye(V,W),Oe=new Ye(Q,W),me=xt(k);let Ae=new Ye(0,0);F&&(Ae=new Ye(F[0],F[1])),se._rotateAround(me,Ae),te._rotateAround(me,Ae),we._rotateAround(me,Ae),Oe._rotateAround(me,Ae),V=Math.min(se.x,te.x,we.x,Oe.x),Q=Math.max(se.x,te.x,we.x,Oe.x),U=Math.min(se.y,te.y,we.y,Oe.y),W=Math.max(se.y,te.y,we.y,Oe.y)}return a.emplaceBack(o.x,o.y,o.z,l.x,l.y,V,U,Q,W,M,p,y,w),a.length-1}function Em(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const o=a.bottom-a.top;return o>0?Math.max(10,o):null}function c0(a,o,l,p){const y=a.compareText;if(o in y){const w=y[o];for(let E=w.length-1;E>=0;E--)if(p.dist(w[E])<l)return!0}else y[o]=[];return y[o].push(p),!1}function _y(a,o){const l=a.fovAboveCenter,p=a.elevation?a.elevation.getMinElevationBelowMSL()*o:0,y=(a._camera.position[2]*a.worldSize-p)/Math.cos(a._pitch),w=Math.sin(l)*y/Math.sin(Math.max(Math.PI/2-a._pitch-l,.01)),E=Math.sin(a._pitch)*w+y;return Math.min(1.01*E,y*(1/a._horizonShift))}function ks(a,o){if(!o.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:o};const l=Math.pow(2,-a.z),p=a.x*l,y=(a.x+1)*l,w=a.y*l,E=(a.y+1)*l,M=za(p),k=za(y),F=Xs(w),U=Xs(E),W=o.project(M,F),V=o.project(k,F),Q=o.project(k,U),ie=o.project(M,U);let se=Math.min(W.x,V.x,Q.x,ie.x),te=Math.min(W.y,V.y,Q.y,ie.y),we=Math.max(W.x,V.x,Q.x,ie.x),Oe=Math.max(W.y,V.y,Q.y,ie.y);const me=l/16;function Ae(Re,lt,tt,wt,jt,ht){const Tt=(tt+jt)/2,At=(wt+ht)/2,Et=o.project(za(Tt),Xs(At)),Vt=Math.max(0,se-Et.x,te-Et.y,Et.x-we,Et.y-Oe);se=Math.min(se,Et.x),we=Math.max(we,Et.x),te=Math.min(te,Et.y),Oe=Math.max(Oe,Et.y),Vt>me&&(Ae(Re,Et,tt,wt,Tt,At),Ae(Et,lt,Tt,At,jt,ht))}Ae(W,V,p,w,y,w),Ae(V,Q,y,w,y,E),Ae(Q,ie,y,E,p,E),Ae(ie,W,p,E,p,w),se-=me,te-=me,we+=me,Oe+=me;const Ee=1/Math.max(we-se,Oe-te);return{scale:Ee,x:se*Ee,y:te*Ee,x2:we*Ee,y2:Oe*Ee,projection:o}}const Lg=dc(new Float32Array(16));class Ho{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,l){return{x:0,y:0,z:0}}unproject(o,l){return new tr(0,0)}projectTilePoint(o,l,p){return{x:o,y:l,z:0}}locationPoint(o,l,p=!0){return o._coordinatePoint(o.locationCoordinate(l),p)}pixelsPerMeter(o,l){return Fl(1,o)*l}pixelSpaceConversion(o,l,p){return 1}farthestPixelDistance(o){return _y(o,o.pixelsPerMeter)}pointCoordinate(o,l,p,y){const w=o.horizonLineFromTop(!1),E=new Ye(l,Math.max(w,p));return o.rayIntersectionCoordinate(o.pointRayIntersection(E,y))}pointCoordinate3D(o,l,p){const y=new Ye(l,p);if(o.elevation)return o.elevation.pointCoordinate(y);{const w=this.pointCoordinate(o,y.x,y.y,0);return[w.x,w.y,w.z]}}isPointAboveHorizon(o,l){if(o.elevation)return!this.pointCoordinate3D(o,l.x,l.y);const p=o.horizonLineFromTop();return l.y<p}createInversionMatrix(o,l){return Lg}createTileMatrix(o,l,p){let y,w,E;const M=p.canonical,k=dc(new Float64Array(16));if(this.isReprojectedInTileSpace){const F=ks(M,this);y=1,w=F.x+p.wrap*F.scale,E=F.y,hc(k,k,[y/F.scale,y/F.scale,o.pixelsPerMeter/l])}else y=l/o.zoomScale(M.z),w=(M.x+Math.pow(2,M.z)*p.wrap)*y,E=M.y*y;return Rh(k,k,[w,E,0]),hc(k,k,[y/Jn,y/Jn,1]),k}upVector(o,l,p){return[0,0,1]}upVectorScale(o,l,p){return{metersToTile:1}}}class qh extends Ho{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[l,p]=this.parallels=o.parallels||[29.5,45.5],y=Math.sin(xt(l));this.n=(y+Math.sin(xt(p)))/2,this.c=1+y*(2*this.n-y),this.r0=Math.sqrt(this.c)/this.n}project(o,l){const{n:p,c:y,r0:w}=this,E=xt(o-this.center[0]),M=xt(l),k=Math.sqrt(y-2*p*Math.sin(M))/p;return{x:k*Math.sin(E*p),y:k*Math.cos(E*p)-w,z:0}}unproject(o,l){const{n:p,c:y,r0:w}=this,E=w+l;let M=Math.atan2(o,Math.abs(E))*Math.sign(E);E*p<0&&(M-=Math.PI*Math.sign(o)*Math.sign(E));const k=xt(this.center[0])*p;M=si(M,-Math.PI-k,Math.PI-k);const F=zt(Pt(M/p)+this.center[0],-180,180),U=Math.asin(zt((y-(o*o+E*E)*p*p)/(2*p),-1,1)),W=zt(Pt(U),-So,So);return new tr(F,W)}}const Zh=1.340264,Js=-.081106,sp=893e-6,Ud=.003796,jd=Math.sqrt(3)/2;class Wh extends Ho{project(o,l){l=l/180*Math.PI,o=o/180*Math.PI;const p=Math.asin(jd*Math.sin(l)),y=p*p,w=y*y*y;return{x:.5*(o*Math.cos(p)/(jd*(Zh+3*Js*y+w*(7*sp+9*Ud*y)))/Math.PI+.5),y:1-.5*(p*(Zh+Js*y+w*(sp+Ud*y))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let p=l=(2*(1-l)-1)*Math.PI,y=p*p,w=y*y*y;for(let U,W,V,Q=0;Q<12&&(W=p*(Zh+Js*y+w*(sp+Ud*y))-l,V=Zh+3*Js*y+w*(7*sp+9*Ud*y),U=W/V,p=zt(p-U,-Math.PI/3,Math.PI/3),y=p*p,w=y*y*y,!(Math.abs(U)<1e-12));++Q);const E=jd*o*(Zh+3*Js*y+w*(7*sp+9*Ud*y))/Math.cos(p),M=Math.asin(Math.sin(p)/jd),k=zt(180*E/Math.PI,-180,180),F=zt(180*M/Math.PI,-So,So);return new tr(k,F)}}class Ng extends Ho{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){return{x:.5+o/360,y:.5-l/360,z:0}}unproject(o,l){const p=360*(o-.5),y=zt(360*(.5-l),-So,So);return new tr(p,y)}}const Ju=Math.PI/2;function lu(a){return Math.tan((Ju+a)/2)}class Tm extends Ho{constructor(o){super(o),this.center=o.center||[0,30];const[l,p]=this.parallels=o.parallels||[30,30];let y=xt(l),w=xt(p);this.southernCenter=y+w<0,this.southernCenter&&(y=-y,w=-w);const E=Math.cos(y),M=lu(y);this.n=y===w?Math.sin(y):Math.log(E/Math.cos(w))/Math.log(lu(w)/M),this.f=E*Math.pow(lu(y),this.n)/this.n}project(o,l){l=xt(l),this.southernCenter&&(l=-l),o=xt(o-this.center[0]);const p=1e-6,{n:y,f:w}=this;w>0?l<-Ju+p&&(l=-Ju+p):l>Ju-p&&(l=Ju-p);const E=w/Math.pow(lu(l),y);let M=E*Math.sin(y*o),k=w-E*Math.cos(y*o);return M=.5*(M/Math.PI+.5),k=.5*(k/Math.PI+.5),{x:M,y:this.southernCenter?k:1-k,z:0}}unproject(o,l){o=(2*o-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:p,f:y}=this,w=y-l,E=Math.sign(w),M=Math.sign(p)*Math.sqrt(o*o+w*w);let k=Math.atan2(o,Math.abs(w))*E;w*p<0&&(k-=Math.PI*Math.sign(o)*E);const F=zt(Pt(k/p)+this.center[0],-180,180),U=zt(Pt(2*Math.atan(Math.pow(y/M,1/p))-Ju),-So,So);return new tr(F,this.southernCenter?-U:U)}}class Yh extends Ho{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,l){return{x:Hu(o),y:qu(l),z:0}}unproject(o,l){const p=za(o),y=Xs(l);return new tr(p,y)}}const $d=xt(So);class Kx extends Ho{project(o,l){const p=(l=xt(l))*l,y=p*p;return{x:.5*((o=xt(o))*(.8707-.131979*p+y*(y*(.003971*p-.001529*y)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+p*(.015085+y*(.028874*p-.044475-.005916*y)))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let p=l=(2*(1-l)-1)*Math.PI,y=25,w=0,E=p*p;do{E=p*p;const F=E*E;w=(p*(1.007226+E*(.015085+F*(.028874*E-.044475-.005916*F)))-l)/(1.007226+E*(.045255+F*(.259866*E-.311325-.005916*11*F))),p=zt(p-w,-$d,$d)}while(Math.abs(w)>1e-6&&--y>0);E=p*p;const M=zt(Pt(o/(.8707+E*(E*(E*E*E*(.003971-.001529*E)-.013791)-.131979))),-180,180),k=Pt(p);return new tr(M,k)}}const Xx=xt(So);class Qx extends Ho{project(o,l){l=xt(l),o=xt(o);const p=Math.cos(l),y=2/Math.PI,w=Math.acos(p*Math.cos(o/2)),E=Math.sin(w)/w,M=.5*(o*y+2*p*Math.sin(o/2)/E)||0,k=.5*(l+Math.sin(l)/E)||0;return{x:.5*(M/Math.PI+.5),y:1-.5*(k/Math.PI+1),z:0}}unproject(o,l){let p=o=(2*o-.5)*Math.PI,y=l=(2*(1-l)-1)*Math.PI,w=25;const E=1e-6;let M=0,k=0;do{const F=Math.cos(y),U=Math.sin(y),W=2*U*F,V=U*U,Q=F*F,ie=Math.cos(p/2),se=Math.sin(p/2),te=2*ie*se,we=se*se,Oe=1-Q*ie*ie,me=Oe?1/Oe:0,Ae=Oe?Math.acos(F*ie)*Math.sqrt(1/Oe):0,Ee=.5*(2*Ae*F*se+2*p/Math.PI)-o,Re=.5*(Ae*U+y)-l,lt=.5*me*(Q*we+Ae*F*ie*V)+1/Math.PI,tt=me*(te*W/4-Ae*U*se),wt=.125*me*(W*se-Ae*U*Q*te),jt=.5*me*(V*ie+Ae*we*F)+.5,ht=tt*wt-jt*lt;M=(Re*tt-Ee*jt)/ht,k=(Ee*wt-Re*lt)/ht,p=zt(p-M,-Math.PI,Math.PI),y=zt(y-k,-Xx,Xx)}while((Math.abs(M)>E||Math.abs(k)>E)&&--w>0);return new tr(Pt(p),Pt(y))}}class ap extends Ho{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(xt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){const{scale:p,cosPhi:y}=this;return{x:xt(o)*y*p+.5,y:-Math.sin(xt(l))/y*p+.5,z:0}}unproject(o,l){const{scale:p,cosPhi:y}=this,w=-(l-.5)/p,E=zt(Pt((o-.5)/p)/y,-180,180),M=Math.asin(zt(w*y,-1,1)),k=zt(Pt(M),-So,So);return new tr(E,k)}}class zg extends Yh{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,l,p){const y=cg(o,l,p);return yo(y,y,om(Rl(p))),{x:y[0],y:y[1],z:y[2]}}locationPoint(o,l){const p=Gu(l.lat,l.lng),y=_a([],p),w=o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(l),o._centerAltitude):o._centerAltitude;lg(p,p,y,Fl(1,0)*Jn*w);const E=dc(new Float64Array(16));return Md(E,o.pixelMatrix,o.globeMatrix),yo(p,p,E),new Ye(p[0],p[1])}pixelsPerMeter(o,l){return Fl(1,0)*l}pixelSpaceConversion(o,l,p){const y=Fl(1,o)*l,w=di(Fl(1,45)*l,y,p);return this.pixelsPerMeter(o,l)/w}createTileMatrix(o,l,p){const y=Bv(Rl(p.canonical));return Md(new Float64Array(16),o.globeMatrix,y)}createInversionMatrix(o,l){const{center:p}=o,y=om(Rl(l));return Kp(y,y,xt(p.lng)),Dd(y,y,xt(p.lat)),hc(y,y,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(y)}pointCoordinate(o,l,p,y){return $u(o,l,p,!0)||new jf(0,0)}pointCoordinate3D(o,l,p){const y=this.pointCoordinate(o,l,p,0);return[y.x,y.y,y.z]}isPointAboveHorizon(o,l){return!$u(o,l.x,l.y,!1)}farthestPixelDistance(o){const l=function(y,w){const E=y.cameraToCenterDistance,M=y._centerAltitude*w,k=y._camera,F=y._camera.forward(),U=Na([],Gs([],F,-E),[0,0,M]),W=y.worldSize/(2*Math.PI),V=[0,0,-W],Q=y.width/y.height,ie=Math.tan(y.fovAboveCenter),se=Gs([],k.up(),ie),te=Gs([],k.right(),ie*Q),we=_a([],Na([],Na([],F,se),te)),Oe=[];let me;if(new zv(U,we).closestPointOnSphere(V,W,Oe)){const Ae=Na([],Oe,V),Ee=rl([],Ae,U);me=Math.cos(y.fovAboveCenter)*il(Ee)}else{const Ae=rl([],U,V),Ee=rl([],V,U);_a(Ee,Ee);const Re=il(Ae)-W;me=Math.sqrt(Re*(Re+2*W));const lt=Math.acos(me/(W+Re))-Math.acos(tu(F,Ee));me*=Math.cos(lt)}return 1.01*me}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),p=sm(o.zoom);if(p>0){const y=_y(o,Fl(1,o.center.lat)*o.worldSize),w=o.worldSize/(2*Math.PI),E=Math.max(o.width,o.height)/o.worldSize*Math.PI;return di(l,y+w*(1-Math.cos(E)),Math.pow(p,10))}return l}upVector(o,l,p){return cg(l,p,o,1)}upVectorScale(o){return{metersToTile:pc(L_(Rl(o)))}}}function yy(a){const o=a.parallels,l=!!o&&Math.abs(o[0]+o[1])<.01;switch(a.name){case"mercator":return new Yh(a);case"equirectangular":return new Ng(a);case"naturalEarth":return new Kx(a);case"equalEarth":return new Wh(a);case"winkelTripel":return new Qx(a);case"albers":return l?new ap(a):new qh(a);case"lambertConformalConic":return l?new ap(a):new Tm(a);case"globe":return new zg(a)}throw new Error(`Invalid projection name: ${a.name}`)}const u0=Qf.types,Im=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function vy(a,o,l,p,y,w,E,M,k,F,U,W,V){const Q=M?Math.min(Ll,Math.round(M[0])):0,ie=M?Math.min(Ll,Math.round(M[1])):0;a.emplaceBack(o,l,Math.round(32*p),Math.round(32*y),w,E,(Q<<1)+(k?1:0),ie,16*F,16*U,256*W,256*V)}function by(a,o,l,p,y,w,E){a.emplaceBack(o,l,p,y,w,E)}function Bg(a,o,l,p,y){a.emplaceBack(o,l,p,y),a.emplaceBack(o,l,p,y),a.emplaceBack(o,l,p,y),a.emplaceBack(o,l,p,y)}function cC(a){for(const o of a.sections)if(re(o.text))return!0;return!1}class Jx{constructor(o){this.layoutVertexArray=new ka,this.indexArray=new mo,this.programConfigurations=o,this.segments=new Yr,this.dynamicLayoutVertexArray=new vi,this.opacityVertexArray=new sr,this.placedSymbolArray=new qp,this.globeExtVertexArray=new Tr}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(o,l,p,y){this.isEmpty()||(p&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Ig.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,iy.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,Im,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,o0.members,!0)),this.opacityVertexBuffer.itemSize=1),(p||y)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}gn(Jx,"SymbolBuffers");class d0{constructor(o,l,p){this.layoutVertexArray=new o,this.layoutAttributes=l,this.indexArray=new p,this.segments=new Yr,this.collisionVertexArray=new Fi,this.collisionVertexArrayExt=new bs}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,Mx.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,ry.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}gn(d0,"CollisionBuffers");class Gd{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(E=>E.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=dc([]),this.placementViewportMatrix=dc([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=oy(this.zoom,l["text-size"]),this.iconSizeData=oy(this.zoom,l["icon-size"]);const p=this.layers[0].layout,y=p.get("symbol-sort-key"),w=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==w&&void 0!==y.constantOr(1),this.sortFeaturesByY=("viewport-y"===w||"auto"===w&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(E=>ll[E]),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=o.sourceID,this.projection=o.projection}createArrays(){this.text=new Jx(new cc(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new Jx(new cc(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new zu,this.lineVertexArray=new Ih,this.symbolInstances=new ds}calculateGlyphDependencies(o,l,p,y,w){for(let E=0;E<o.length;E++)if(l[o.charCodeAt(E)]=!0,y&&w){const M=vm[o.charAt(E)];M&&(l[M.charCodeAt(0)]=!0)}}populate(o,l,p,y){const w=this.layers[0],E=w.layout,M="globe"===this.projection.name,k=E.get("text-font"),F=E.get("text-field"),U=E.get("icon-image"),W=("constant"!==F.value.kind||F.value.value instanceof Eo&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&("constant"!==k.value.kind||k.value.value.length>0),V="constant"!==U.value.kind||!!U.value.value||Object.keys(U.parameters).length>0,Q=E.get("symbol-sort-key");if(this.features=[],!W&&!V)return;const ie=l.iconDependencies,se=l.glyphDependencies,te=l.availableImages,we=new We(this.zoom);for(const{feature:Oe,id:me,index:Ae,sourceLayerIndex:Ee}of o){const Re=w._featureFilter.needGeometry,lt=Gf(Oe,Re);if(!w._featureFilter.filter(we,lt,p))continue;if(Re||(lt.geometry=nu(Oe,p,y)),M&&1!==Oe.type&&p.z<=5){const ht=lt.geometry,Tt=.98078528056,At=(Et,Vt)=>tu(cg(Et.x,Et.y,p,1),cg(Vt.x,Vt.y,p,1))<Tt;for(let Et=0;Et<ht.length;Et++)ht[Et]=rx(ht[Et],At)}let tt,wt;if(W){const ht=w.getValueAndResolveTokens("text-field",lt,p,te),Tt=Eo.factory(ht);cC(Tt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Le()||this.hasRTLText&&Ue.isParsed())&&(tt=ym(Tt,w,lt))}if(V){const ht=w.getValueAndResolveTokens("icon-image",lt,p,te);wt=ht instanceof Er?ht:Er.fromString(ht)}if(!tt&&!wt)continue;const jt=this.sortFeaturesByKey?Q.evaluate(lt,{},p):void 0;if(this.features.push({id:me,text:tt,icon:wt,index:Ae,sourceLayerIndex:Ee,geometry:lt.geometry,properties:Oe.properties,type:u0[Oe.type],sortKey:jt}),wt&&(ie[wt.name]=!0),tt){const ht=k.evaluate(lt,{},p).join(","),Tt="map"===E.get("text-rotation-alignment")&&"point"!==E.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ll.vertical)>=0;for(const At of tt.sections)if(At.image)ie[At.image.name]=!0;else{const Et=S(tt.toString()),Vt=At.fontStack||ht,ot=se[Vt]=se[Vt]||{};this.calculateGlyphDependencies(At.text,ot,Tt,this.allowVerticalPlacement,Et)}}}"line"===E.get("symbol-placement")&&(this.features=function(Oe){const me={},Ae={},Ee=[];let Re=0;function lt(ht){Ee.push(Oe[ht]),Re++}function tt(ht,Tt,At){const Et=Ae[ht];return delete Ae[ht],Ae[Tt]=Et,Ee[Et].geometry[0].pop(),Ee[Et].geometry[0]=Ee[Et].geometry[0].concat(At[0]),Et}function wt(ht,Tt,At){const Et=me[Tt];return delete me[Tt],me[ht]=Et,Ee[Et].geometry[0].shift(),Ee[Et].geometry[0]=At[0].concat(Ee[Et].geometry[0]),Et}function jt(ht,Tt,At){const Et=At?Tt[0][Tt[0].length-1]:Tt[0][0];return`${ht}:${Et.x}:${Et.y}`}for(let ht=0;ht<Oe.length;ht++){const Tt=Oe[ht],At=Tt.geometry,Et=Tt.text?Tt.text.toString():null;if(!Et){lt(ht);continue}const Vt=jt(Et,At),ot=jt(Et,At,!0);if(Vt in Ae&&ot in me&&Ae[Vt]!==me[ot]){const tn=wt(Vt,ot,At),Yn=tt(Vt,ot,Ee[tn].geometry);delete me[Vt],delete Ae[ot],Ae[jt(Et,Ee[Yn].geometry,!0)]=Yn,Ee[tn].geometry=null}else Vt in Ae?tt(Vt,ot,At):ot in me?wt(Vt,ot,At):(lt(ht),me[Vt]=Re-1,Ae[ot]=Re-1)}return Ee.filter(ht=>ht.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Oe,me)=>Oe.sortKey-me.sortKey)}update(o,l,p,y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,l,this.layers,p,y),this.icon.programConfigurations.updatePaintArrays(o,l,this.layers,p,y))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=yy(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,l){const p=this.lineVertexArray.length;if(void 0!==o.segment)for(const{x:y,y:w}of l)this.lineVertexArray.emplaceBack(y,w);return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(o,l,p,y,w,E,M,k,F,U,W,V,Q,ie){const se=o.indexArray,te=o.layoutVertexArray,we=o.globeExtVertexArray,Oe=o.segments.prepareSegment(4*l.length,te,se,this.canOverlap?E.sortKey:void 0),me=this.glyphOffsetArray.length,Ae=Oe.vertexLength,Ee=this.allowVerticalPlacement&&M===ll.vertical?Math.PI/2:0,Re=E.text&&E.text.sections;for(let tt=0;tt<l.length;tt++){const{tl:wt,tr:jt,bl:ht,br:Tt,tex:At,pixelOffsetTL:Et,pixelOffsetBR:Vt,minFontScaleX:ot,minFontScaleY:tn,glyphOffset:Yn,isSDF:mn,sectionIndex:Dn}=l[tt],ln=Oe.vertexLength,kn=Yn[1];if(vy(te,F.x,F.y,wt.x,kn+wt.y,At.x,At.y,p,mn,Et.x,Et.y,ot,tn),vy(te,F.x,F.y,jt.x,kn+jt.y,At.x+At.w,At.y,p,mn,Vt.x,Et.y,ot,tn),vy(te,F.x,F.y,ht.x,kn+ht.y,At.x,At.y+At.h,p,mn,Et.x,Vt.y,ot,tn),vy(te,F.x,F.y,Tt.x,kn+Tt.y,At.x+At.w,At.y+At.h,p,mn,Vt.x,Vt.y,ot,tn),k){const{x:Li,y:Di,z:Pi}=k.anchor,[ni,mr,ei]=k.up;by(we,Li,Di,Pi,ni,mr,ei),by(we,Li,Di,Pi,ni,mr,ei),by(we,Li,Di,Pi,ni,mr,ei),by(we,Li,Di,Pi,ni,mr,ei),Bg(o.dynamicLayoutVertexArray,Li,Di,Pi,Ee)}else Bg(o.dynamicLayoutVertexArray,F.x,F.y,F.z,Ee);se.emplaceBack(ln,ln+1,ln+2),se.emplaceBack(ln+1,ln+2,ln+3),Oe.vertexLength+=4,Oe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Yn[0]),tt!==l.length-1&&Dn===l[tt+1].sectionIndex||o.programConfigurations.populatePaintArrays(te.length,E,E.index,{},Q,ie,Re&&Re[Dn])}const lt=k?k.anchor:F;o.placedSymbolArray.emplaceBack(lt.x,lt.y,lt.z,F.x,F.y,me,this.glyphOffsetArray.length-me,Ae,U,W,F.segment,p?p[0]:0,p?p[1]:0,y[0],y[1],M,0,!1,0,V,0)}_commitLayoutVertex(o,l,p,y,w,E,M){o.emplaceBack(l,p,y,w,E,Math.round(M.x),Math.round(M.y))}_addCollisionDebugVertices(o,l,p,y,w,E,M){const k=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),F=k.vertexLength,U=M.tileAnchorX,W=M.tileAnchorY;for(let Q=0;Q<4;Q++)p.collisionVertexArray.emplaceBack(0,0,0,0);p.collisionVertexArrayExt.emplaceBack(l,-o.padding,-o.padding),p.collisionVertexArrayExt.emplaceBack(l,o.padding,-o.padding),p.collisionVertexArrayExt.emplaceBack(l,o.padding,o.padding),p.collisionVertexArrayExt.emplaceBack(l,-o.padding,o.padding),this._commitLayoutVertex(p.layoutVertexArray,y,w,E,U,W,new Ye(o.x1,o.y1)),this._commitLayoutVertex(p.layoutVertexArray,y,w,E,U,W,new Ye(o.x2,o.y1)),this._commitLayoutVertex(p.layoutVertexArray,y,w,E,U,W,new Ye(o.x2,o.y2)),this._commitLayoutVertex(p.layoutVertexArray,y,w,E,U,W,new Ye(o.x1,o.y2)),k.vertexLength+=4;const V=p.indexArray;V.emplaceBack(F,F+1),V.emplaceBack(F+1,F+2),V.emplaceBack(F+2,F+3),V.emplaceBack(F+3,F),k.primitiveLength+=4}_addTextDebugCollisionBoxes(o,l,p,y,w,E){for(let M=y;M<w;M++){const k=p.get(M),F=this.getSymbolInstanceTextSize(o,E,l,M);this._addCollisionDebugVertices(k,F,this.textCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,E)}}_addIconDebugCollisionBoxes(o,l,p,y,w,E){for(let M=y;M<w;M++){const k=p.get(M),F=this.getSymbolInstanceIconSize(o,l,E.placedIconSymbolIndex);this._addCollisionDebugVertices(k,F,this.iconCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,E)}}generateCollisionDebugBuffers(o,l){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new d0(Fr,Sg.members,Al),this.iconCollisionBox=new d0(Fr,Sg.members,Al);const p=Jf(this.iconSizeData,o),y=Jf(this.textSizeData,o);for(let w=0;w<this.symbolInstances.length;w++){const E=this.symbolInstances.get(w);this._addTextDebugCollisionBoxes(y,o,l,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(y,o,l,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(p,o,l,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(p,o,l,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(o,l,p,y){const w=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:y),E=sy(this.textSizeData,o,w)/Kr;return this.tilePixelRatio*E}getSymbolInstanceIconSize(o,l,p){const y=this.icon.placedSymbolArray.get(p),w=sy(this.iconSizeData,o,y);return this.tilePixelRatio*w}_commitDebugCollisionVertexUpdate(o,l,p){o.emplaceBack(l,-p,-p),o.emplaceBack(l,p,-p),o.emplaceBack(l,p,p),o.emplaceBack(l,-p,p)}_updateTextDebugCollisionBoxes(o,l,p,y,w,E){for(let M=y;M<w;M++){const k=p.get(M),F=this.getSymbolInstanceTextSize(o,E,l,M);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,F,k.padding)}}_updateIconDebugCollisionBoxes(o,l,p,y,w,E){for(let M=y;M<w;M++){const k=p.get(M),F=this.getSymbolInstanceIconSize(o,l,E);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,F,k.padding)}}updateCollisionDebugBuffers(o,l){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const p=Jf(this.iconSizeData,o),y=Jf(this.textSizeData,o);for(let w=0;w<this.symbolInstances.length;w++){const E=this.symbolInstances.get(w);this._updateTextDebugCollisionBoxes(y,o,l,E.textBoxStartIndex,E.textBoxEndIndex,E),this._updateTextDebugCollisionBoxes(y,o,l,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._updateIconDebugCollisionBoxes(p,o,l,E.iconBoxStartIndex,E.iconBoxEndIndex,E.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(p,o,l,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,l,p,y,w,E,M,k,F){const U={};if(l<p){const{x1:W,y1:V,x2:Q,y2:ie,padding:se,projectedAnchorX:te,projectedAnchorY:we,projectedAnchorZ:Oe,tileAnchorX:me,tileAnchorY:Ae,featureIndex:Ee}=o.get(l);U.textBox={x1:W,y1:V,x2:Q,y2:ie,padding:se,projectedAnchorX:te,projectedAnchorY:we,projectedAnchorZ:Oe,tileAnchorX:me,tileAnchorY:Ae},U.textFeatureIndex=Ee}if(y<w){const{x1:W,y1:V,x2:Q,y2:ie,padding:se,projectedAnchorX:te,projectedAnchorY:we,projectedAnchorZ:Oe,tileAnchorX:me,tileAnchorY:Ae,featureIndex:Ee}=o.get(y);U.verticalTextBox={x1:W,y1:V,x2:Q,y2:ie,padding:se,projectedAnchorX:te,projectedAnchorY:we,projectedAnchorZ:Oe,tileAnchorX:me,tileAnchorY:Ae},U.verticalTextFeatureIndex=Ee}if(E<M){const{x1:W,y1:V,x2:Q,y2:ie,padding:se,projectedAnchorX:te,projectedAnchorY:we,projectedAnchorZ:Oe,tileAnchorX:me,tileAnchorY:Ae,featureIndex:Ee}=o.get(E);U.iconBox={x1:W,y1:V,x2:Q,y2:ie,padding:se,projectedAnchorX:te,projectedAnchorY:we,projectedAnchorZ:Oe,tileAnchorX:me,tileAnchorY:Ae},U.iconFeatureIndex=Ee}if(k<F){const{x1:W,y1:V,x2:Q,y2:ie,padding:se,projectedAnchorX:te,projectedAnchorY:we,projectedAnchorZ:Oe,tileAnchorX:me,tileAnchorY:Ae,featureIndex:Ee}=o.get(k);U.verticalIconBox={x1:W,y1:V,x2:Q,y2:ie,padding:se,projectedAnchorX:te,projectedAnchorY:we,projectedAnchorZ:Oe,tileAnchorX:me,tileAnchorY:Ae},U.verticalIconFeatureIndex=Ee}return U}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const p=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,l){const p=o.placedSymbolArray.get(l),y=p.vertexStartIndex+4*p.numGlyphs;for(let w=p.vertexStartIndex;w<y;w+=4)o.indexArray.emplaceBack(w,w+1,w+2),o.indexArray.emplaceBack(w+1,w+2,w+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const l=Math.sin(o),p=Math.cos(o),y=[],w=[],E=[];for(let M=0;M<this.symbolInstances.length;++M){E.push(M);const k=this.symbolInstances.get(M);y.push(0|Math.round(l*k.tileAnchorX+p*k.tileAnchorY)),w.push(k.featureIndex)}return E.sort((M,k)=>y[M]-y[k]||w[k]-w[M]),E}addToSortKeyRanges(o,l){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===l?p.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const p=this.symbolInstances.get(l);this.featureSortOrder.push(p.featureIndex);const{rightJustifiedTextSymbolIndex:y,centerJustifiedTextSymbolIndex:w,leftJustifiedTextSymbolIndex:E,verticalPlacedTextSymbolIndex:M,placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:F}=p;y>=0&&this.addIndicesForPlacedSymbol(this.text,y),w>=0&&w!==y&&this.addIndicesForPlacedSymbol(this.text,w),E>=0&&E!==w&&E!==y&&this.addIndicesForPlacedSymbol(this.text,E),M>=0&&this.addIndicesForPlacedSymbol(this.text,M),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k),F>=0&&this.addIndicesForPlacedSymbol(this.icon,F)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}gn(Gd,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Gd.MAX_GLYPHS=65535,Gd.addDynamicAttributes=Bg;const h0=new Rt({"symbol-placement":new qe(dt.layout_symbol["symbol-placement"]),"symbol-spacing":new qe(dt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new qe(dt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Xe(dt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new qe(dt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new qe(dt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new qe(dt.layout_symbol["icon-ignore-placement"]),"icon-optional":new qe(dt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new qe(dt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Xe(dt.layout_symbol["icon-size"]),"icon-text-fit":new qe(dt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new qe(dt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Xe(dt.layout_symbol["icon-image"]),"icon-rotate":new Xe(dt.layout_symbol["icon-rotate"]),"icon-padding":new qe(dt.layout_symbol["icon-padding"]),"icon-keep-upright":new qe(dt.layout_symbol["icon-keep-upright"]),"icon-offset":new Xe(dt.layout_symbol["icon-offset"]),"icon-anchor":new Xe(dt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new qe(dt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new qe(dt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new qe(dt.layout_symbol["text-rotation-alignment"]),"text-field":new Xe(dt.layout_symbol["text-field"]),"text-font":new Xe(dt.layout_symbol["text-font"]),"text-size":new Xe(dt.layout_symbol["text-size"]),"text-max-width":new Xe(dt.layout_symbol["text-max-width"]),"text-line-height":new Xe(dt.layout_symbol["text-line-height"]),"text-letter-spacing":new Xe(dt.layout_symbol["text-letter-spacing"]),"text-justify":new Xe(dt.layout_symbol["text-justify"]),"text-radial-offset":new Xe(dt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new qe(dt.layout_symbol["text-variable-anchor"]),"text-anchor":new Xe(dt.layout_symbol["text-anchor"]),"text-max-angle":new qe(dt.layout_symbol["text-max-angle"]),"text-writing-mode":new qe(dt.layout_symbol["text-writing-mode"]),"text-rotate":new Xe(dt.layout_symbol["text-rotate"]),"text-padding":new qe(dt.layout_symbol["text-padding"]),"text-keep-upright":new qe(dt.layout_symbol["text-keep-upright"]),"text-transform":new Xe(dt.layout_symbol["text-transform"]),"text-offset":new Xe(dt.layout_symbol["text-offset"]),"text-allow-overlap":new qe(dt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new qe(dt.layout_symbol["text-ignore-placement"]),"text-optional":new qe(dt.layout_symbol["text-optional"])});var xy={paint:new Rt({"icon-opacity":new Xe(dt.paint_symbol["icon-opacity"]),"icon-color":new Xe(dt.paint_symbol["icon-color"]),"icon-halo-color":new Xe(dt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Xe(dt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Xe(dt.paint_symbol["icon-halo-blur"]),"icon-translate":new qe(dt.paint_symbol["icon-translate"]),"icon-translate-anchor":new qe(dt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Xe(dt.paint_symbol["text-opacity"]),"text-color":new Xe(dt.paint_symbol["text-color"],{runtimeType:Qi,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Xe(dt.paint_symbol["text-halo-color"]),"text-halo-width":new Xe(dt.paint_symbol["text-halo-width"]),"text-halo-blur":new Xe(dt.paint_symbol["text-halo-blur"]),"text-translate":new qe(dt.paint_symbol["text-translate"]),"text-translate-anchor":new qe(dt.paint_symbol["text-translate-anchor"])}),layout:h0};class Vg{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:Ti,this.defaultValue=o}evaluate(o){if(o.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(o.formattedSection))return l.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}gn(Vg,"FormatSectionOverride",{omit:["defaultValue"]});class Kh extends Fa{constructor(o){super(o,xy)}recalculate(o,l){super.recalculate(o,l),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const y=[];for(const w of p)y.indexOf(w)<0&&y.push(w);this.layout._values["text-writing-mode"]=y}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(o,l,p,y){const w=this.layout.get(o).evaluate(l,{},p,y),E=this._unevaluatedLayout._values[o];return E.isDataDriven()||hh(E.value)||!w?w:(M=l.properties,w.replace(/{([^{}]+)}/g,(F,U)=>U in M?String(M[U]):""));var M}createBucket(o){return new Gd(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of xy.paint.overridableProperties){if(!Kh.hasPaintOverride(this.layout,o))continue;const l=this.paint.get(o),p=new Vg(l),y=new vd(p,l.property.specification);let w=null;w="constant"===l.value.kind||"source"===l.value.kind?new Vp("source",y):new Il("composite",y,l.value.zoomStops,l.value._interpolationType),this.paint._values[o]=new Ot(l.property,w,l.parameters)}}_handleOverridablePaintPropertyUpdate(o,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&Kh.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,l){const p=o.get("text-field"),y=xy.paint.properties[l];let w=!1;const E=M=>{for(const k of M)if(y.overrides&&y.overrides.hasOverride(k))return void(w=!0)};if("constant"===p.value.kind&&p.value.value instanceof Eo)E(p.value.value.sections);else if("source"===p.value.kind){const M=F=>{w||(F instanceof Us&&Ji(F.value)===_l?E(F.value.sections):F instanceof vl?E(F.sections):F.eachChild(M))},k=p.value;k._styleExpression&&M(k._styleExpression.expression)}return w}getProgramConfiguration(o){return new eu(this,o)}}var wy={paint:new Rt({"background-color":new qe(dt.paint_background["background-color"]),"background-pattern":new qe(dt.paint_background["background-pattern"]),"background-opacity":new qe(dt.paint_background["background-opacity"])})},f0={paint:new Rt({"raster-opacity":new qe(dt.paint_raster["raster-opacity"]),"raster-hue-rotate":new qe(dt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new qe(dt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new qe(dt.paint_raster["raster-brightness-max"]),"raster-saturation":new qe(dt.paint_raster["raster-saturation"]),"raster-contrast":new qe(dt.paint_raster["raster-contrast"]),"raster-resampling":new qe(dt.paint_raster["raster-resampling"]),"raster-fade-duration":new qe(dt.paint_raster["raster-fade-duration"])})};class Cy extends Fa{constructor(o){super(o,{}),this.implementation=o}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}var Ug={paint:new Rt({"sky-type":new qe(dt.paint_sky["sky-type"]),"sky-atmosphere-sun":new qe(dt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new qe(dt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new qe(dt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new qe(dt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Mt(dt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new qe(dt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new qe(dt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new qe(dt.paint_sky["sky-opacity"])})};function jg(a,o,l){const p=[0,0,1],y=Jb([]);return O_(y,y,l?-xt(a)+Math.PI:xt(a)),Fv(y,y,-xt(o)),Xb(p,p,y),_a(p,p)}const uC={circle:class extends Fa{constructor(a){super(a,Hv)}createBucket(a){return new lm(a)}queryRadius(a){const o=a;return Hf("circle-radius",this,o)+Hf("circle-stroke-width",this,o)+ru(this.paint.get("circle-translate"))}queryIntersectsFeature(a,o,l,p,y,w,E,M){const k=$_(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),w.angle,a.pixelToTileUnitsFactor),F=this.paint.get("circle-radius").evaluate(o,l)+this.paint.get("circle-stroke-width").evaluate(o,l);return ax(a,p,w,E,M,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),k,F)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new eu(this,a)}},heatmap:class extends Fa{createBucket(a){return new qv(a)}constructor(a){super(a,ux),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"heatmap-color"===a&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Zv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return Hf("heatmap-radius",this,a)}queryIntersectsFeature(a,o,l,p,y,w,E,M){const k=this.paint.get("heatmap-radius").evaluate(o,l);return ax(a,p,w,E,M,!0,!0,new Ye(0,0),k)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new eu(this,a)}},hillshade:class extends Fa{constructor(a){super(a,V1)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Fa{constructor(a){super(a,Y_)}getProgramIds(){const a=this.paint.get("fill-pattern"),o=a&&a.constantOr(1),l=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getProgramConfiguration(a){return new eu(this,a)}recalculate(a,o){super.recalculate(a,o);const l=this.paint._values["fill-outline-color"];"constant"===l.value.kind&&void 0===l.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new W_(a)}queryRadius(){return ru(this.paint.get("fill-translate"))}queryIntersectsFeature(a,o,l,p,y,w){return!a.queryGeometry.isAboveHorizon&&U_(Gv(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),w.angle,a.pixelToTileUnitsFactor),p)}isTileClipped(){return!0}},"fill-extrusion":class extends Fa{constructor(a){super(a,wx)}createBucket(a){return new pm(a)}queryRadius(){return ru(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new eu(this,a)}queryIntersectsFeature(a,o,l,p,y,w,E,M,k){const F=$_(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),w.angle,a.pixelToTileUnitsFactor),U=this.paint.get("fill-extrusion-height").evaluate(o,l),W=this.paint.get("fill-extrusion-base").evaluate(o,l),V=[0,0],Q=M&&w.elevation,ie=w.elevation?w.elevation.exaggeration():1,se=a.tile.getBucket(this);if(Q&&se instanceof pm){const Ae=se.centroidVertexArray,Ee=k+1;Ee<Ae.length&&(V[0]=Ae.geta_centroid_pos0(Ee),V[1]=Ae.geta_centroid_pos1(Ee))}if(0===V[0]&&1===V[1])return!1;"globe"===w.projection.name&&(p=xx([p],[new Ye(0,0),new Ye(Jn,Jn)],a.tileID.canonical).map(Ae=>Ae.polygon).flat());const te=Q?M:null,[we,Oe]=(Ee=p,Re=W,lt=U,tt=F,wt=E,jt=te,ht=V,Tt=ie,At=w.center.lat,"globe"===(Ae=w).projection.name?function(Vt,ot,tn,Yn,mn,Dn,ln,kn,Li,Di,Pi){const ni=[],mr=[],ei=Vt.projection.upVectorScale(Pi,Vt.center.lat,Vt.worldSize).metersToTile,ki=[0,0,0,1],Ir=[0,0,0,1],Vr=(Lr,Nr,vo,Rs)=>{Lr[0]=Nr,Lr[1]=vo,Lr[2]=Rs,Lr[3]=1},_r=n0();tn>0&&(tn+=_r),Yn+=_r;for(const Lr of ot){const Nr=[],vo=[];for(const Rs of Lr){const yr=Rs.x+mn.x,Mo=Rs.y+mn.y,Do=Vt.projection.projectTilePoint(yr,Mo,Pi),nr=Vt.projection.upVector(Pi,Rs.x,Rs.y);let Ur=tn,ts=Yn;if(ln){const wr=ty(yr,Mo,tn,Yn,ln,kn,Li,Di);Ur+=wr.base,ts+=wr.top}0!==tn?Vr(ki,Do.x+nr[0]*ei*Ur,Do.y+nr[1]*ei*Ur,Do.z+nr[2]*ei*Ur):Vr(ki,Do.x,Do.y,Do.z),Vr(Ir,Do.x+nr[0]*ei*ts,Do.y+nr[1]*ei*ts,Do.z+nr[2]*ei*ts),yo(ki,ki,Dn),yo(Ir,Ir,Dn),Nr.push(new gm(ki[0],ki[1],ki[2])),vo.push(new gm(Ir[0],Ir[1],Ir[2]))}ni.push(Nr),mr.push(vo)}return[ni,mr]}(Ae,Ee,Re,lt,tt,wt,jt,ht,Tt,At,a.tileID.canonical):jt?function(Vt,ot,tn,Yn,mn,Dn,ln,kn,Li){const Di=[],Pi=[],ni=[0,0,0,1];for(const mr of Vt){const ei=[],ki=[];for(const Ir of mr){const Vr=Ir.x+Yn.x,_r=Ir.y+Yn.y,Lr=ty(Vr,_r,ot,tn,Dn,ln,kn,Li);ni[0]=Vr,ni[1]=_r,ni[2]=Lr.base,ni[3]=1,Ol(ni,ni,mn),ni[3]=Math.max(ni[3],1e-5);const Nr=new gm(ni[0]/ni[3],ni[1]/ni[3],ni[2]/ni[3]);ni[0]=Vr,ni[1]=_r,ni[2]=Lr.top,ni[3]=1,Ol(ni,ni,mn),ni[3]=Math.max(ni[3],1e-5);const vo=new gm(ni[0]/ni[3],ni[1]/ni[3],ni[2]/ni[3]);ei.push(Nr),ki.push(vo)}Di.push(ei),Pi.push(ki)}return[Di,Pi]}(Ee,Re,lt,tt,wt,jt,ht,Tt,At):function(Vt,ot,tn,Yn,mn){const Dn=[],ln=[],kn=mn[8]*ot,Li=mn[9]*ot,Di=mn[10]*ot,Pi=mn[11]*ot,ni=mn[8]*tn,mr=mn[9]*tn,ei=mn[10]*tn,ki=mn[11]*tn;for(const Ir of Vt){const Vr=[],_r=[];for(const Lr of Ir){const Nr=Lr.x+Yn.x,vo=Lr.y+Yn.y,Rs=mn[0]*Nr+mn[4]*vo+mn[12],yr=mn[1]*Nr+mn[5]*vo+mn[13],Mo=mn[2]*Nr+mn[6]*vo+mn[14],Do=mn[3]*Nr+mn[7]*vo+mn[15],nr=Rs+kn,Ur=yr+Li,ts=Mo+Di,wr=Math.max(Do+Pi,1e-5),oo=Rs+ni,Fs=yr+mr,ws=Mo+ei,zo=Math.max(Do+ki,1e-5);Vr.push(new gm(nr/wr,Ur/wr,ts/wr)),_r.push(new gm(oo/zo,Fs/zo,ws/zo))}Dn.push(Vr),ln.push(_r)}return[Dn,ln]}(Ee,Re,lt,tt,wt)),me=a.queryGeometry;var Ae,Ee,Re,lt,tt,wt,jt,ht,Tt,At;return function(Ae,Ee,Re){let lt=1/0;U_(Re,Ee)&&(lt=tC(Re,Ee[0]));for(let tt=0;tt<Ee.length;tt++){const wt=Ee[tt],jt=Ae[tt];for(let ht=0;ht<wt.length-1;ht++){const Tt=wt[ht],At=[Tt,wt[ht+1],jt[ht+1],jt[ht],Tt];iu(Re,At)&&(lt=Math.min(lt,tC(Re,At)))}}return lt!==1/0&&lt}(we,Oe,me.isPointQuery()?me.screenBounds:me.screenGeometry)}},line:class extends Fa{constructor(a){super(a,ny),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if("line-gradient"===a){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof la,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,o){super.recalculate(a,o),this.paint._values["line-floorwidth"]=gc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new Eg(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new eu(this,a)}queryRadius(a){const o=a,l=Tg(Hf("line-width",this,o),Hf("line-gap-width",this,o)),p=Hf("line-offset",this,o);return l/2+Math.abs(p)+ru(this.paint.get("line-translate"))}queryIntersectsFeature(a,o,l,p,y,w){if(a.queryGeometry.isAboveHorizon)return!1;const E=Gv(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),w.angle,a.pixelToTileUnitsFactor),M=a.pixelToTileUnitsFactor/2*Tg(this.paint.get("line-width").evaluate(o,l),this.paint.get("line-gap-width").evaluate(o,l)),k=this.paint.get("line-offset").evaluate(o,l);return k&&(p=function(F,U){const W=[],V=new Ye(0,0);for(let Q=0;Q<F.length;Q++){const ie=F[Q],se=[];for(let te=0;te<ie.length;te++){const Oe=ie[te],me=ie[te+1],Ae=0===te?V:Oe.sub(ie[te-1])._unit()._perp(),Ee=te===ie.length-1?V:me.sub(Oe)._unit()._perp(),Re=Ae._add(Ee)._unit();Re._mult(1/(Re.x*Ee.x+Re.y*Ee.y)),se.push(Re._mult(U)._add(Oe))}W.push(se)}return W}(p,k*a.pixelToTileUnitsFactor)),function(F,U,W){for(let V=0;V<U.length;V++){const Q=U[V];if(F.length>=3)for(let ie=0;ie<Q.length;ie++)if(Pd(F,Q[ie]))return!0;if(j_(F,Q,W))return!0}return!1}(E,p,M)}isTileClipped(){return!0}},symbol:Kh,background:class extends Fa{constructor(a){super(a,wy)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Fa{constructor(a){super(a,f0)}getProgramIds(){return["raster"]}},sky:class extends Fa{constructor(a){super(a,Ug),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"sky-gradient"===a?this._updateColorRamp():"sky-atmosphere-sun"!==a&&"sky-atmosphere-halo-color"!==a&&"sky-atmosphere-color"!==a&&"sky-atmosphere-sun-intensity"!==a||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Zv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(a,o){if("atmosphere"===this.paint.get("sky-type")){const p=this.paint.get("sky-atmosphere-sun"),y=!p,w=a.style.light,E=w.properties.get("position");return y&&"viewport"===w.properties.get("anchor")&&Ai("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),y?jg(E.azimuthal,90-E.polar,o):jg(p[0],90-p[1],o)}const l=this.paint.get("sky-gradient-center");return jg(l[0],90-l[1],o)}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return"atmosphere"===a?["skyboxCapture","skybox"]:"gradient"===a?["skyboxGradient"]:null}}};class Xh{constructor(o,l,p,y){this.context=o,this.format=p,this.texture=o.gl.createTexture(),this.update(l,y)}update(o,l,p){const{width:y,height:w}=o,{context:E}=this,{gl:M}=E,{HTMLImageElement:k,HTMLCanvasElement:F,HTMLVideoElement:U,ImageData:W,ImageBitmap:V}=$e;if(M.bindTexture(M.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!l||!1!==l.premultiply)),p||this.size&&this.size[0]===y&&this.size[1]===w){const{x:Q,y:ie}=p||{x:0,y:0};o instanceof k||o instanceof F||o instanceof U||o instanceof W||V&&o instanceof V?M.texSubImage2D(M.TEXTURE_2D,0,Q,ie,M.RGBA,M.UNSIGNED_BYTE,o):M.texSubImage2D(M.TEXTURE_2D,0,Q,ie,y,w,M.RGBA,M.UNSIGNED_BYTE,o.data)}else this.size=[y,w],o instanceof k||o instanceof F||o instanceof U||o instanceof W||V&&o instanceof V?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,o):M.texImage2D(M.TEXTURE_2D,0,this.format,y,w,0,this.format,M.UNSIGNED_BYTE,o.data);this.useMipmap=Boolean(l&&l.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&M.generateMipmap(M.TEXTURE_2D)}bind(o,l){const{context:p}=this,{gl:y}=p;y.bindTexture(y.TEXTURE_2D,this.texture),o!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,o),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,this.useMipmap?o===y.NEAREST?y.NEAREST_MIPMAP_NEAREST:y.LINEAR_MIPMAP_NEAREST:o),this.filter=o),l!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,l),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class ew{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class p0{constructor(){this.tasks={},this.taskQueue=[],Cn(["process"],this),this.invoker=new ew(this.process),this.nextId=0}add(o,l){const p=this.nextId++,y=function({type:w,isSymbolTile:E,zoom:M}){return M=M||0,"message"===w?0:"maybePrepare"!==w||E?"parseTile"!==w||E?"parseTile"===w&&E?300-M:"maybePrepare"===w&&E?400-M:500:200-M:100-M}(l);if(0===y){kr();try{o()}finally{}return{cancel:()=>{}}}return this.tasks[p]={fn:o,metadata:l,priority:y,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){kr();try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const o=this.pick();if(null===o)return;const l=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let o=null,l=1/0;for(let y=0;y<this.taskQueue.length;y++){const w=this.tasks[this.taskQueue[y]];w.priority<l&&(l=w.priority,o=y)}if(null===o)return null;const p=this.taskQueue[o];return this.taskQueue.splice(o,1),p}remove(){this.invoker.remove()}}class Ey{constructor(o){this._stringToNumber={},this._numberToString=[];for(let l=0;l<o.length;l++){const p=o[l];this._stringToNumber[p]=l,this._numberToString[l]=p}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const m0=["tile","layer","source","sourceLayer","state"];class Ty{constructor(o,l,p,y,w){this.type="Feature",this._vectorTileFeature=o,this._z=l,this._x=p,this._y=y,this.properties=o.properties,this.id=w}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(o.id=this.id);for(const l of m0)void 0!==this[l]&&(o[l]=this[l]);return o}}const Nl=32,vc=33,Hd=new Uint16Array(8184);for(let a=0;a<2046;a++){let o=a+2,l=0,p=0,y=0,w=0,E=0,M=0;for(1&o?y=w=E=Nl:l=p=M=Nl;(o>>=1)>1;){const F=l+y>>1,U=p+w>>1;1&o?(y=l,w=p,l=E,p=M):(l=y,p=w,y=E,w=M),E=F,M=U}const k=4*a;Hd[k+0]=l,Hd[k+1]=p,Hd[k+2]=y,Hd[k+3]=w}const ba=new Uint16Array(2178),Qh=new Uint8Array(1089),lp=new Uint16Array(1089);function g0(a){return 0===a?-.03125:32===a?.03125:0}var Sm=yn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const $g={type:2,extent:Jn,loadGeometry:()=>[[new Ye(0,0),new Ye(8193,0),new Ye(8193,8193),new Ye(0,8193),new Ye(0,0)]]};class Iy{constructor(o,l,p,y,w){this.tileID=o,this.uid=Ht(),this.uses=0,this.tileSize=l,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=w,this.expiredRequestCount=0,this.state="loading",y&&y.transform&&(this.projection=y.transform.projection)}registerFadeDuration(o){const l=o+this.timeAdded;l<mi.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=ks(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,l,p){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(y,w){const E={};if(!w)return E;for(const M of y){const k=M.layerIds.map(F=>w.getLayer(F)).filter(Boolean);if(0!==k.length){M.layers=k,M.stateDependentLayerIds&&(M.stateDependentLayers=M.stateDependentLayerIds.map(F=>k.filter(U=>U.id===F)[0]));for(const F of k)E[F.id]=M}}return E}(o.buckets,l.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const w=this.buckets[y];if(w instanceof Gd){if(this.hasSymbolBuckets=!0,!p)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const w=this.buckets[y];if(w instanceof Gd&&w.hasRTLText){this.hasRTLText=!0,Ue.isLoading()||Ue.isLoaded()||"deferred"!==Le()||Fe();break}}this.queryPadding=0;for(const y in this.buckets){const w=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(y).queryRadius(w))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas)}else this.collisionBoxArray=new us}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(o){return this.buckets[o.id]}upload(o){for(const p in this.buckets){const y=this.buckets[p];y.uploadPending()&&y.upload(o)}const l=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Xh(o,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Xh(o,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Xh(o,this.lineAtlas.image,l.ALPHA),this.lineAtlas.uploaded=!0)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,l,p,y,w,E,M,k){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:y,pixelPosMatrix:M,transform:E,params:w,tileTransform:this.tileTransform},o,l,p):{}}querySourceFeatures(o,l){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const y=p.loadVTLayers(),w=l?l.sourceLayer:"",E=y._geojsonTileLayer||y[w];if(!E)return;const M=qc(l&&l.filter),{z:k,x:F,y:U}=this.tileID.canonical,W={z:k,x:F,y:U};for(let V=0;V<E.length;V++){const Q=E.feature(V);if(M.needGeometry){const te=Gf(Q,!0);if(!M.filter(new We(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!M.filter(new We(this.tileID.overscaledZ),Q))continue;const ie=p.getId(Q,w),se=new Ty(Q,k,F,U,ie);se.tile=W,o.push(se)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const l=this.expirationTime;if(o.cacheControl){const p=lo(o.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const p=Date.now();let y=!1;if(this.expirationTime>p)y=!1;else if(l)if(this.expirationTime<l)y=!0;else{const w=this.expirationTime-l;w?this.expirationTime=p+Math.max(w,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(o,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(o).length||!l)return;const p=this.latestFeatureIndex.loadVTLayers(),y=l.style.listImages();for(const w in this.buckets){if(!l.style.hasLayer(w))continue;const E=this.buckets[w],M=E.layers[0].sourceLayer||"_geojsonTileLayer",k=p[M],F=o[M];if(!k||!F||0===Object.keys(F).length)continue;if(E.update(F,k,y,this.imageAtlas&&this.imageAtlas.patternPositions||{}),E instanceof Eg||E instanceof W_){const W=l.style._getSourceCache(E.layers[0].source);l._terrain&&l._terrain.enabled&&W&&E.programConfigurations.needsUpload&&l._terrain._clearRenderCacheForTile(W.id,this.tileID)}const U=l&&l.style&&l.style.getLayer(w);U&&(this.queryPadding=Math.max(this.queryPadding,U.queryRadius(E)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<mi.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=mi.now()+o}setTexture(o,l){const p=l.context,y=p.gl;this.texture=this.texture||l.getTileTexture(o.width),this.texture?this.texture.update(o,{useMipmap:!0}):(this.texture=new Xh(p,o,y.RGBA,{useMipmap:!0}),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE),p.extTextureFilterAnisotropic&&y.texParameterf(y.TEXTURE_2D,p.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,p.extTextureFilterAnisotropicMax))}setDependencies(o,l){const p={};for(const y of l)p[y]=!0;this.dependencies[o]=p}hasDependency(o,l){for(const p of o){const y=this.dependencies[p];if(y)for(const w of l)if(y[w])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,l){if(!l||"mercator"===l.name||this._tileDebugBuffer)return;const p=nu($g,this.tileID.canonical,this.tileTransform)[0],y=new Vn,w=new el;for(let E=0;E<p.length;E++){const{x:M,y:k}=p[E];y.emplaceBack(M,k),w.emplaceBack(E)}w.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(w),this._tileDebugBuffer=o.createVertexBuffer(y,tm.members),this._tileDebugSegments=Yr.simpleSegment(0,0,y.length,w.length)}_makeTileBoundsBuffers(o,l){if(this._tileBoundsBuffer||!l||"mercator"===l.name)return;const p=nu($g,this.tileID.canonical,this.tileTransform)[0];let y,w;if(this.isRaster){const E=function(M,k){const F=ks(M,k),U=Math.pow(2,M.z);for(let te=0;te<vc;te++)for(let we=0;we<vc;we++){const Oe=za((M.x+(we+g0(we))/Nl)/U),me=Xs((M.y+(te+g0(te))/Nl)/U),Ae=k.project(Oe,me),Ee=te*vc+we;ba[2*Ee+0]=Math.round((Ae.x*F.scale-F.x)*Jn),ba[2*Ee+1]=Math.round((Ae.y*F.scale-F.y)*Jn)}Qh.fill(0),lp.fill(0);for(let te=2045;te>=0;te--){const we=4*te,Oe=Hd[we+0],me=Hd[we+1],Ae=Hd[we+2],Ee=Hd[we+3],Re=Oe+Ae>>1,lt=me+Ee>>1,tt=Re+lt-me,wt=lt+Oe-Re,jt=me*vc+Oe,ht=Ee*vc+Ae,Tt=lt*vc+Re,At=Math.hypot((ba[2*jt+0]+ba[2*ht+0])/2-ba[2*Tt+0],(ba[2*jt+1]+ba[2*ht+1])/2-ba[2*Tt+1])>=16;Qh[Tt]=Qh[Tt]||(At?1:0),te<1022&&(Qh[Tt]=Qh[Tt]||Qh[(me+wt>>1)*vc+(Oe+tt>>1)]||Qh[(Ee+wt>>1)*vc+(Ae+tt>>1)])}const W=new Ri,V=new mo;let Q=0;function ie(te,we){const Oe=we*vc+te;return 0===lp[Oe]&&(W.emplaceBack(ba[2*Oe+0],ba[2*Oe+1],te*Jn/Nl,we*Jn/Nl),lp[Oe]=++Q),lp[Oe]-1}function se(te,we,Oe,me,Ae,Ee){const Re=te+Oe>>1,lt=we+me>>1;if(Math.abs(te-Ae)+Math.abs(we-Ee)>1&&Qh[lt*vc+Re])se(Ae,Ee,te,we,Re,lt),se(Oe,me,Ae,Ee,Re,lt);else{const tt=ie(te,we),wt=ie(Oe,me),jt=ie(Ae,Ee);V.emplaceBack(tt,wt,jt)}}return se(0,0,Nl,Nl,Nl,0),se(Nl,Nl,0,0,0,Nl),{vertices:W,indices:V}}(this.tileID.canonical,l);y=E.vertices,w=E.indices}else{y=new Ri,w=new mo;for(const{x:M,y:k}of p)y.emplaceBack(M,k,0,0);const E=Vh(y.int16,void 0,4);for(let M=0;M<E.length;M+=3)w.emplaceBack(E[M],E[M+1],E[M+2])}this._tileBoundsBuffer=o.createVertexBuffer(y,Sm.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(w),this._tileBoundsSegments=Yr.simpleSegment(0,0,y.length,w.length)}_makeGlobeTileDebugBuffers(o,l){const p=l.projection;if(!p||"globe"!==p.name||l.freezeTileCoverage)return;const y=this.tileID.canonical,w=om(tx(y,l)),E=sm(l.zoom);let M;E>0&&(M=ag(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,y,l,w,M,E),this._makeGlobeTileDebugTextBuffer(o,y,l,w,M,E)}_globePoint(o,l,p,y,w,E,M){let k=cg(o,l,p);if(E){const F=1<<p.z,U=Hu(y.center.lng),W=qu(y.center.lat),V=(p.x+.5)/F-U;let Q=0;V>.5?Q=-1:V<-.5&&(Q=1);let ie=(o/Jn+p.x)/F+Q,se=(l/Jn+p.y)/F;ie=(ie-U)*y._pixelsPerMercatorPixel+U,se=(se-W)*y._pixelsPerMercatorPixel+W;const te=[ie*y.worldSize,se*y.worldSize,0];yo(te,te,E),k=Bf(k,te,M)}return yo(k,k,w)}_makeGlobeTileDebugBorderBuffer(o,l,p,y,w,E){const M=new Vn,k=new el,F=new er,U=(V,Q,ie,se,te)=>{const we=(ie-V)/(te-1),Oe=(se-Q)/(te-1),me=M.length;for(let Ae=0;Ae<te;Ae++){const Ee=V+Ae*we,Re=Q+Ae*Oe;M.emplaceBack(Ee,Re);const lt=this._globePoint(Ee,Re,l,p,y,w,E);F.emplaceBack(lt[0],lt[1],lt[2]),k.emplaceBack(me+Ae)}},W=Jn;U(0,0,W,0,16),U(W,0,W,W,16),U(W,W,0,W,16),U(0,W,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(k),this._tileDebugBuffer=o.createVertexBuffer(M,tm.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(F,Nv.members),this._tileDebugSegments=Yr.simpleSegment(0,0,M.length,k.length)}_makeGlobeTileDebugTextBuffer(o,l,p,y,w,E){const M=new Vn,k=new mo,F=new er,U=25;k.reserve(32),M.reserve(U),F.reserve(U);const W=(V,Q)=>U*V+Q;for(let V=0;V<U;V++){const Q=2048*V;for(let ie=0;ie<U;ie++){const se=2048*ie;M.emplaceBack(se,Q);const te=this._globePoint(se,Q,l,p,y,w,E);F.emplaceBack(te[0],te[1],te[2])}}for(let V=0;V<4;V++)for(let Q=0;Q<4;Q++){const ie=W(V,Q),se=W(V,Q+1),te=W(V+1,Q),we=W(V+1,Q+1);k.emplaceBack(ie,se,te),k.emplaceBack(te,se,we)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(k),this._tileDebugTextBuffer=o.createVertexBuffer(M,tm.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(F,Nv.members),this._tileDebugTextSegments=Yr.simpleSegment(0,0,U,32)}}class Gg{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,l,p){const y=String(l);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][y]=this.stateChanges[o][y]||{},gt(this.stateChanges[o][y],p),null===this.deletedStates[o]){this.deletedStates[o]={};for(const w in this.state[o])w!==y&&(this.deletedStates[o][w]=null)}else if(this.deletedStates[o]&&null===this.deletedStates[o][y]){this.deletedStates[o][y]={};for(const w in this.state[o][y])p[w]||(this.deletedStates[o][y][w]=null)}else for(const w in p)this.deletedStates[o]&&this.deletedStates[o][y]&&null===this.deletedStates[o][y][w]&&delete this.deletedStates[o][y][w]}removeFeatureState(o,l,p){if(null===this.deletedStates[o])return;const y=String(l);if(this.deletedStates[o]=this.deletedStates[o]||{},p&&void 0!==l)null!==this.deletedStates[o][y]&&(this.deletedStates[o][y]=this.deletedStates[o][y]||{},this.deletedStates[o][y][p]=null);else if(void 0!==l)if(this.stateChanges[o]&&this.stateChanges[o][y])for(p in this.deletedStates[o][y]={},this.stateChanges[o][y])this.deletedStates[o][y][p]=null;else this.deletedStates[o][y]=null;else this.deletedStates[o]=null}getState(o,l){const p=String(l),y=gt({},(this.state[o]||{})[p],(this.stateChanges[o]||{})[p]);if(null===this.deletedStates[o])return{};if(this.deletedStates[o]){const w=this.deletedStates[o][l];if(null===w)return{};for(const E in w)delete y[E]}return y}initializeTileState(o,l){o.setFeatureState(this.state,l)}coalesceChanges(o,l){const p={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const w={};for(const E in this.stateChanges[y])this.state[y][E]||(this.state[y][E]={}),gt(this.state[y][E],this.stateChanges[y][E]),w[E]=this.state[y][E];p[y]=w}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const w={};if(null===this.deletedStates[y])for(const E in this.state[y])w[E]={},this.state[y][E]={};else for(const E in this.deletedStates[y]){if(null===this.deletedStates[y][E])this.state[y][E]={};else if(this.state[y][E])for(const M of Object.keys(this.deletedStates[y][E]))delete this.state[y][E][M];w[E]=this.state[y][E]}p[y]=p[y]||{},gt(p[y],w)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(p).length)for(const y in o)o[y].setFeatureState(p,l)}}class _0{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,l){const p=this.toIdx(o,l);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(o,l){return this.leaves[this.toIdx(o,l)]}toIdx(o,l){return l*this.size+o}}function Sy(a,o,l,p){let y=0,w=Number.MAX_VALUE;for(let E=0;E<3;E++)if(Math.abs(p[E])<1e-15){if(l[E]<a[E]||l[E]>o[E])return null}else{const M=1/p[E];let k=(a[E]-l[E])*M,F=(o[E]-l[E])*M;if(k>F){const U=k;k=F,F=U}if(k>y&&(y=k),F<w&&(w=F),y>w)return null}return y}function y0(a,o,l,p,y,w,E,M,k,F,U){const W=p-a,V=y-o,Q=w-l,ie=E-a,se=M-o,te=k-l,we=U[1]*te-U[2]*se,Oe=U[2]*ie-U[0]*te,me=U[0]*se-U[1]*ie,Ae=W*we+V*Oe+Q*me;if(Math.abs(Ae)<1e-15)return null;const Ee=1/Ae,Re=F[0]-a,lt=F[1]-o,tt=F[2]-l,wt=(Re*we+lt*Oe+tt*me)*Ee;if(wt<0||wt>1)return null;const jt=lt*Q-tt*V,ht=tt*W-Re*Q,Tt=Re*V-lt*W,At=(U[0]*jt+U[1]*ht+U[2]*Tt)*Ee;return At<0||wt+At>1?null:(ie*jt+se*ht+te*Tt)*Ee}function Hg(a,o,l){return(a-o)/(l-o)}function v0(a,o,l,p,y,w,E,M,k){const F=1<<l,U=w-p,W=E-y,V=(a+1)/F*U+p,Q=(o+0)/F*W+y,ie=(o+1)/F*W+y;M[0]=(a+0)/F*U+p,M[1]=Q,k[0]=V,k[1]=ie}class b0{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(w){const E=Math.ceil(Math.log2(w.dim/8)),M=[];let k=Math.ceil(Math.pow(2,E));const F=1/k,U=(Q,ie,se,te,we)=>{const Oe=te?1:0,me=(Q+1)*se-Oe,Ae=ie*se,Ee=(ie+1)*se-Oe;we[0]=Q*se,we[1]=Ae,we[2]=me,we[3]=Ee};let W=new _0(k);const V=[];for(let Q=0;Q<k*k;Q++){U(Q%k,Math.floor(Q/k),F,!1,V);const ie=ja(V[0],V[1],w),se=ja(V[2],V[1],w),te=ja(V[2],V[3],w),we=ja(V[0],V[3],w);W.minimums.push(Math.min(ie,se,te,we)),W.maximums.push(Math.max(ie,se,te,we)),W.leaves.push(1)}for(M.push(W),k/=2;k>=1;k/=2){const Q=M[M.length-1];W=new _0(k);for(let ie=0;ie<k*k;ie++){U(ie%k,Math.floor(ie/k),2,!0,V);const se=Q.getElevation(V[0],V[1]),te=Q.getElevation(V[2],V[1]),we=Q.getElevation(V[2],V[3]),Oe=Q.getElevation(V[0],V[3]),me=Q.isLeaf(V[0],V[1]),Ae=Q.isLeaf(V[2],V[1]),Ee=Q.isLeaf(V[2],V[3]),Re=Q.isLeaf(V[0],V[3]),lt=Math.min(se.min,te.min,we.min,Oe.min),tt=Math.max(se.max,te.max,we.max,Oe.max),wt=me&&Ae&&Ee&&Re;W.maximums.push(tt),W.minimums.push(lt),W.leaves.push(tt-lt<=5&&wt?1:0)}M.push(W)}return M}(this.dem),p=l.length-1,y=l[p];this._addNode(y.minimums[0],y.maximums[0],y.leaves[0]),this._construct(l,0,0,p,0)}raycastRoot(o,l,p,y,w,E,M=1){return Sy([o,l,-100],[p,y,this.maximums[0]*M],w,E)}raycast(o,l,p,y,w,E,M=1){if(!this.nodeCount)return null;const k=this.raycastRoot(o,l,p,y,w,E,M);if(null==k)return null;const F=[],U=[],W=[],V=[],Q=[{idx:0,t:k,nodex:0,nodey:0,depth:0}];for(;Q.length>0;){const{idx:ie,t:se,nodex:te,nodey:we,depth:Oe}=Q.pop();if(this.leaves[ie]){v0(te,we,Oe,o,l,p,y,W,V);const Ae=1<<Oe,Ee=(te+0)/Ae,Re=(te+1)/Ae,lt=(we+0)/Ae,tt=(we+1)/Ae,wt=ja(Ee,lt,this.dem)*M,jt=ja(Re,lt,this.dem)*M,ht=ja(Re,tt,this.dem)*M,Tt=ja(Ee,tt,this.dem)*M,At=y0(W[0],W[1],wt,V[0],W[1],jt,V[0],V[1],ht,w,E),Et=y0(V[0],V[1],ht,W[0],V[1],Tt,W[0],W[1],wt,w,E),Vt=Math.min(null!==At?At:Number.MAX_VALUE,null!==Et?Et:Number.MAX_VALUE);if(Vt!==Number.MAX_VALUE)return Vt;{const ot=lg([],w,E,se);if(Mm(wt,jt,Tt,ht,Hg(ot[0],W[0],V[0]),Hg(ot[1],W[1],V[1]))>=ot[2])return se}continue}let me=0;for(let Ae=0;Ae<this._siblingOffset.length;Ae++){v0((te<<1)+this._siblingOffset[Ae][0],(we<<1)+this._siblingOffset[Ae][1],Oe+1,o,l,p,y,W,V),W[2]=-100,V[2]=this.maximums[this.childOffsets[ie]+Ae]*M;const Ee=Sy(W,V,w,E);if(null!=Ee){const Re=Ee;F[Ae]=Re;let lt=!1;for(let tt=0;tt<me&&!lt;tt++)Re>=F[U[tt]]&&(U.splice(tt,0,Ae),lt=!0);lt||(U[me]=Ae),me++}}for(let Ae=0;Ae<me;Ae++){const Ee=U[Ae];Q.push({idx:this.childOffsets[ie]+Ee,t:F[Ee],nodex:(te<<1)+this._siblingOffset[Ee][0],nodey:(we<<1)+this._siblingOffset[Ee][1],depth:Oe+1})}}return null}_addNode(o,l,p){return this.minimums.push(o),this.maximums.push(l),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(o,l,p,y,w){if(1===o[y].isLeaf(l,p))return;this.childOffsets[w]||(this.childOffsets[w]=this.nodeCount);const E=y-1,M=o[E];let k=0,F=0;for(let U=0;U<this._siblingOffset.length;U++){const W=2*l+this._siblingOffset[U][0],V=2*p+this._siblingOffset[U][1],Q=M.getElevation(W,V),ie=M.isLeaf(W,V),se=this._addNode(Q.min,Q.max,ie);ie&&(k|=1<<U),F||(F=se)}for(let U=0;U<this._siblingOffset.length;U++)k&1<<U||this._construct(o,2*l+this._siblingOffset[U][0],2*p+this._siblingOffset[U][1],E,F+U)}}function Mm(a,o,l,p,y,w){return di(di(a,l,w),di(o,p,w),y)}function ja(a,o,l){const p=l.dim,y=zt(a*p-.5,0,p-1),w=zt(o*p-.5,0,p-1),E=Math.floor(y),M=Math.floor(w),k=Math.min(E+1,p-1),F=Math.min(M+1,p-1);return Mm(l.get(E,M),l.get(k,M),l.get(E,F),l.get(k,F),y-E,w-M)}const dC={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Dm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,l,p,y=!1,w=!1){if(this.uid=o,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(p&&"mapbox"!==p&&"terrarium"!==p)return Ai(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const E=this.dim=l.height-2,M=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.encoding=p||"mapbox",this.borderReady=y,!y){for(let k=0;k<E;k++)M[this._idx(-1,k)]=M[this._idx(0,k)],M[this._idx(E,k)]=M[this._idx(E-1,k)],M[this._idx(k,-1)]=M[this._idx(k,0)],M[this._idx(k,E)]=M[this._idx(k,E-1)];M[this._idx(-1,-1)]=M[this._idx(0,0)],M[this._idx(E,-1)]=M[this._idx(E-1,0)],M[this._idx(-1,E)]=M[this._idx(0,E-1)],M[this._idx(E,E)]=M[this._idx(E-1,E-1)],w&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new b0(this)}get(o,l,p=!1){p&&(o=zt(o,-1,this.dim),l=zt(l,-1,this.dim));const y=4*this._idx(o,l);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[y],this.pixels[y+1],this.pixels[y+2])}static getUnpackVector(o){return dC[o]}get unpackVector(){return dC[this.encoding]}_idx(o,l){if(o<-1||o>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(o+1)}_unpackMapbox(o,l,p){return(256*o*256+256*l+p)/10-1e4}_unpackTerrarium(o,l,p){return 256*o+l+p/256-32768}static pack(o,l){const p=[0,0,0,0],y=Dm.getUnpackVector(l);let w=Math.floor((o+y[3])/y[2]);return p[2]=w%256,w=Math.floor(w/256),p[1]=w%256,w=Math.floor(w/256),p[0]=w,p}getPixels(){return new Ba({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,l,p){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let y=l*this.dim,w=l*this.dim+this.dim,E=p*this.dim,M=p*this.dim+this.dim;switch(l){case-1:y=w-1;break;case 1:w=y+1}switch(p){case-1:E=M-1;break;case 1:M=E+1}const k=-l*this.dim,F=-p*this.dim;for(let U=E;U<M;U++)for(let W=y;W<w;W++){const V=4*this._idx(W,U),Q=4*this._idx(W+k,U+F);this.pixels[V+0]=o.pixels[Q+0],this.pixels[V+1]=o.pixels[Q+1],this.pixels[V+2]=o.pixels[Q+2],this.pixels[V+3]=o.pixels[Q+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}gn(Dm,"DEMData"),gn(b0,"DemMinMaxQuadTree",{omit:["dem"]});class x0{constructor(o,l){this.max=o,this.onRemove=l,this.reset()}reset(){for(const o in this.data)for(const l of this.data[o])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(o,l,p){const y=o.wrapped().key;void 0===this.data[y]&&(this.data[y]=[]);const w={value:l,timeout:void 0};if(void 0!==p&&(w.timeout=setTimeout(()=>{this.remove(o,w)},p)),this.data[y].push(w),this.order.push(y),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const l=this.data[o].shift();return l.timeout&&clearTimeout(l.timeout),0===this.data[o].length&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),l.value}getByKey(o){const l=this.data[o];return l?l[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,l){if(!this.has(o))return this;const p=o.wrapped().key,y=void 0===l?0:this.data[p].indexOf(l),w=this.data[p][y];return this.data[p].splice(y,1),w.timeout&&clearTimeout(w.timeout),0===this.data[p].length&&delete this.data[p],this.onRemove(w.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(o){const l=[];for(const p in this.data)for(const y of this.data[p])o(y.value)||l.push(y);for(const p of l)this.remove(p.value.tileID,p)}}class zl{constructor(o,l,p){this.func=o,this.mask=l,this.range=p}}zl.ReadOnly=!1,zl.ReadWrite=!0,zl.disabled=new zl(519,zl.ReadOnly,[0,1]);class qd{constructor(o,l,p,y,w,E){this.test=o,this.ref=l,this.mask=p,this.fail=y,this.depthFail=w,this.pass=E}}qd.disabled=new qd({func:519,mask:0},0,0,7680,7680,7680);class bc{constructor(o,l,p){this.blendFunction=o,this.blendColor=l,this.mask=p}}bc.Replace=[1,0],bc.disabled=new bc(bc.Replace,to.transparent,[!1,!1,!1,!1]),bc.unblended=new bc(bc.Replace,to.transparent,[!0,!0,!0,!0]),bc.alphaBlended=new bc([1,771],to.transparent,[!0,!0,!0,!0]);class xc{constructor(o,l,p){this.enable=o,this.mode=l,this.frontFace=p}}xc.disabled=new xc(!1,1029,2305),xc.backCCW=new xc(!0,1029,2305),xc.backCW=new xc(!0,1029,2304),xc.frontCW=new xc(!0,1028,2304),xc.frontCCW=new xc(!0,1028,2305);class cp extends Rr{constructor(o,l,p){super(),this.id=o,this._onlySymbols=p,l.on("data",y=>{"source"===y.dataType&&"metadata"===y.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===y.dataType&&"content"===y.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new x0(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Gg,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(o){this.map=o,this._minTileCacheSize=void 0===this._minTileCacheSize&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const l=this._tiles[o];if("loaded"!==l.state&&"errored"!==l.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,l){return o.isSymbolTile=this._onlySymbols,this._source.loadTile(o,l)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o,()=>{})}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const p=this._tiles[l];p.upload(o),p.prepare(this.map.style.imageManager)}}getIds(){return mt(this._tiles).map(o=>o.tileID).sort(C0).map(o=>o.key)}getRenderableIds(o){const l=[];for(const p in this._tiles)this._isIdRenderable(+p,o)&&l.push(this._tiles[p]);return o?l.sort((p,y)=>{const w=p.tileID,E=y.tileID,M=new Ye(w.canonical.x,w.canonical.y)._rotate(this.transform.angle),k=new Ye(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return w.overscaledZ-E.overscaledZ||k.y-M.y||k.x-M.x}).map(p=>p.tileID.key):l.map(p=>p.tileID).sort(C0).map(p=>p.key)}hasRenderableParent(o){const l=this.findLoadedParent(o,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(o,l){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(l||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(+o,"reloading")}}_reloadTile(o,l){const p=this._tiles[o];p&&("loading"!==p.state&&(p.state=l),this._loadTile(p,this._tileLoaded.bind(this,p,o,l)))}_tileLoaded(o,l,p,y){if(y)if(o.state="errored",404!==y.status)this._source.fire(new Zi(y,{tile:o}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const w=this.map.painter.terrain;this.update(this.transform,w.getScaledDemTileSize(),!0),w.resetTileLookupCache(this.id)}else this.update(this.transform);else o.timeAdded=mi.now(),"expired"===p&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(l,o),"raster-dem"===this._source.type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new fr("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const l=this.getRenderableIds();for(let y=0;y<l.length;y++){const w=l[y];if(o.neighboringTiles&&o.neighboringTiles[w]){const E=this.getTileByID(w);p(o,E),p(E,o)}}function p(y,w){if(!y.dem||y.dem.borderReady)return;y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0;let E=w.tileID.canonical.x-y.tileID.canonical.x;const M=w.tileID.canonical.y-y.tileID.canonical.y,k=Math.pow(2,y.tileID.canonical.z),F=w.tileID.key;0===E&&0===M||Math.abs(M)>1||(Math.abs(E)>1&&(1===Math.abs(E+k)?E+=k:1===Math.abs(E-k)&&(E-=k)),w.dem&&y.dem&&(y.dem.backfillBorder(w.dem,E,M),y.neighboringTiles&&y.neighboringTiles[F]&&(y.neighboringTiles[F].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,l,p,y){for(const w in this._tiles){let E=this._tiles[w];if(y[w]||!E.hasData()||E.tileID.overscaledZ<=l||E.tileID.overscaledZ>p)continue;let M=E.tileID;for(;E&&E.tileID.overscaledZ>l+1;){const F=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[F.key],E&&E.hasData()&&(M=F)}let k=M;for(;k.overscaledZ>l;)if(k=k.scaledTo(k.overscaledZ-1),o[k.key]){y[M.key]=M;break}}}findLoadedParent(o,l){if(o.key in this._loadedParentTiles){const p=this._loadedParentTiles[o.key];return p&&p.tileID.overscaledZ>=l?p:null}for(let p=o.overscaledZ-1;p>=l;p--){const y=o.scaledTo(p),w=this._getLoadedTile(y);if(w)return w}}_getLoadedTile(o){const l=this._tiles[o.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,l){l=l||this._source.tileSize;const p=Math.ceil(o.width/l)+1,y=Math.ceil(o.height/l)+1,w=Math.floor(p*y*5),E="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,w):w,M="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(M)}handleWrapJump(o){const l=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,l){const p={};for(const y in this._tiles){const w=this._tiles[y];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+l),p[w.tileID.key]=w}this._tiles=p;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(+y,this._tiles[y])}}update(o,l,p){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;let y;this.updateCacheSize(o,l),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?y=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new Ua(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(y=o.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(y=y.filter(M=>this._source.hasTile(M)))):y=[];const w=this._updateRetainedTiles(y);if(My(this._source.type)&&0!==y.length){const M={},k={},F=Object.keys(w);for(const W of F){const V=w[W],Q=this._tiles[W];if(!Q||Q.fadeEndTime&&Q.fadeEndTime<=mi.now())continue;const ie=this.findLoadedParent(V,Math.max(V.overscaledZ-cp.maxOverzooming,this._source.minzoom));ie&&(this._addTile(ie.tileID),M[ie.tileID.key]=ie.tileID),k[W]=V}const U=y[y.length-1].overscaledZ;for(const W in this._tiles){const V=this._tiles[W];if(w[W]||!V.hasData())continue;let Q=V.tileID;for(;Q.overscaledZ>U;){Q=Q.scaledTo(Q.overscaledZ-1);const ie=this._tiles[Q.key];if(ie&&ie.hasData()&&k[Q.key]){w[W]=V.tileID;break}}}for(const W in M)w[W]||(this._coveredTiles[W]=!0,w[W]=M[W])}for(const M in w)this._tiles[M].clearFadeHold();const E=function(M,k){const F=[];for(const U in M)U in k||F.push(U);return F}(this._tiles,w);for(const M of E){const k=this._tiles[M];k.hasSymbolBuckets&&!k.holdingForFade()?k.setHoldDuration(this.map._fadeDuration):k.hasSymbolBuckets&&!k.symbolFadeFinished()||this._removeTile(+M)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const l={};if(0===o.length)return l;const p={},y=o.reduce((F,U)=>Math.min(F,U.overscaledZ),1/0),w=o[0].overscaledZ,E=Math.max(w-cp.maxOverzooming,this._source.minzoom),M=Math.max(w+cp.maxUnderzooming,this._source.minzoom),k={};for(const F of o){const U=this._addTile(F);l[F.key]=F,U.hasData()||y<this._source.maxzoom&&(k[F.key]=F)}this._retainLoadedChildren(k,y,M,l);for(const F of o){let U=this._tiles[F.key];if(U.hasData())continue;if(F.canonical.z>=this._source.maxzoom){const V=F.children(this._source.maxzoom)[0],Q=this.getTile(V);if(Q&&Q.hasData()){l[V.key]=V;continue}}else{const V=F.children(this._source.maxzoom);if(l[V[0].key]&&l[V[1].key]&&l[V[2].key]&&l[V[3].key])continue}let W=U.wasRequested();for(let V=F.overscaledZ-1;V>=E;--V){const Q=F.scaledTo(V);if(p[Q.key]||(p[Q.key]=!0,U=this.getTile(Q),!U&&W&&(U=this._addTile(Q)),U&&(l[Q.key]=Q,W=U.wasRequested(),U.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const l=[];let p,y=this._tiles[o].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){p=this._loadedParentTiles[y.key];break}l.push(y.key);const w=y.scaledTo(y.overscaledZ-1);if(p=this._getLoadedTile(w),p)break;y=w}for(const w of l)this._loadedParentTiles[w]=p}}_addTile(o){let l=this._tiles[o.key];if(l)return l;l=this._cache.getAndRemove(o),l&&(this._setTileReloadTimer(o.key,l),l.tileID=o,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,l)));const p=Boolean(l);if(!p){const y=this.map?this.map.painter:null;l=new Iy(o,this._source.tileSize*o.overscaleFactor(),this.transform.tileZoom,y,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,o.key,l.state))}return l?(l.uses++,this._tiles[o.key]=l,p||this._source.fire(new fr("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(o,l){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const p=l.getExpiryTimeout();p&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},p))}_removeTile(o){const l=this._tiles[o];l&&(l.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),l.uses>0||(l.hasData()&&"reloading"!==l.state?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,l,p){const y=[],w=this.transform;if(!w)return y;const E="globe"===w.projection.name,M=Hu(w.center.lng);for(const k in this._tiles){const F=this._tiles[k];if(p&&F.clearQueryDebugViz(),F.holdingForFade())continue;let U;if(E){const W=F.tileID.canonical;if(0===W.z){const V=[Math.abs(zt(M,...No(W,-1))-M),Math.abs(zt(M,...No(W,1))-M)];U=[0,2*V.indexOf(Math.min(...V))-1]}else{const V=[Math.abs(zt(M,...No(W,-1))-M),Math.abs(zt(M,...No(W,0))-M),Math.abs(zt(M,...No(W,1))-M)];U=[V.indexOf(Math.min(...V))-1]}}else U=[0];for(const W of U){const V=o.containsTile(F,w,l,W);V&&y.push(V)}}return y}getVisibleCoordinates(o){const l=this.getRenderableIds(o).map(p=>this._tiles[p].tileID);for(const p of l)p.projMatrix=this.transform.calculateProjMatrix(p.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(My(this._source.type))for(const o in this._tiles){const l=this._tiles[o];if(void 0!==l.fadeEndTime&&l.fadeEndTime>=mi.now())return!0}return!1}setFeatureState(o,l,p){this._state.updateState(o=o||"_geojsonTileLayer",l,p)}removeFeatureState(o,l,p){this._state.removeFeatureState(o=o||"_geojsonTileLayer",l,p)}getFeatureState(o,l){return this._state.getState(o=o||"_geojsonTileLayer",l)}setDependencies(o,l,p){const y=this._tiles[o];y&&y.setDependencies(l,p)}reloadTilesForDependencies(o,l){for(const p in this._tiles)this._tiles[p].hasDependency(o,l)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(o,l))}_preloadTiles(o,l){const p=new Map,y=Array.isArray(o)?o:[o],w=this.map.painter.terrain,E=this.usedForTerrain&&w?w.getScaledDemTileSize():this._source.tileSize;for(const M of y){const k=M.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const F of k)p.set(F.key,F);this.usedForTerrain&&M.updateElevation(!1)}On(Array.from(p.values()),(M,k)=>{const F=new Iy(M,this._source.tileSize*M.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(F,U=>{"raster-dem"===this._source.type&&F.dem&&this._backfillDEM(F),k(U,F)})},l)}}function C0(a,o){const l=Math.abs(2*a.wrap)-+(a.wrap<0),p=Math.abs(2*o.wrap)-+(o.wrap<0);return a.overscaledZ-o.overscaledZ||p-l||o.canonical.y-a.canonical.y||o.canonical.x-a.canonical.x}function My(a){return"raster"===a||"image"===a||"video"===a||"custom"===a}function No(a,o){const l=1<<a.z;return[a.x/l+o,(a.x+1)/l+o]}cp.maxOverzooming=10,cp.maxUnderzooming=3;class qg{constructor(o,l,p){this._demTile=o,this._dem=this._demTile.dem,this._scale=l,this._offset=p}static create(o,l,p){const y=p||o.findDEMTileFor(l);if(!y||!y.dem)return;const w=y.dem,E=y.tileID,M=1<<l.canonical.z-E.canonical.z;return new qg(y,y.tileSize/Jn/M,[(l.canonical.x/M-E.canonical.x)*w.dim,(l.canonical.y/M-E.canonical.y)*w.dim])}tileCoordToPixel(o,l){const p=l*this._scale+this._offset[1],y=Math.floor(o*this._scale+this._offset[0]),w=Math.floor(p);return new Ye(y,w)}getElevationAt(o,l,p,y){const w=o*this._scale+this._offset[0],E=l*this._scale+this._offset[1],M=Math.floor(w),k=Math.floor(E),F=this._dem;return y=!!y,p?di(di(F.get(M,k,y),F.get(M,k+1,y),E-k),di(F.get(M+1,k,y),F.get(M+1,k+1,y),E-k),w-M):F.get(M,k,y)}getElevationAtPixel(o,l,p){return this._dem.get(o,l,!!p)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*Fl(1,o)*this._dem.stride}}class E0{constructor(o,l){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new Pa(Jn,16,0),this.featureIndexArray=new Wp,this.promoteId=l}insert(o,l,p,y,w,E=0){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,y,w,E);const k=this.grid;for(let F=0;F<l.length;F++){const U=l[F],W=[1/0,1/0,-1/0,-1/0];for(let V=0;V<U.length;V++){const Q=U[V];W[0]=Math.min(W[0],Q.x),W[1]=Math.min(W[1],Q.y),W[2]=Math.max(W[2],Q.x),W[3]=Math.max(W[3],Q.y)}W[0]<Jn&&W[1]<Jn&&W[2]>=0&&W[3]>=0&&k.insert(M,W[0],W[1],W[2],W[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Xf(new Ar(this.rawTileData)).layers,this.sourceLayerCoder=new Ey(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,l,p,y){this.loadVTLayers();const w=o.params||{},E=qc(w.filter),M=o.tileResult,k=o.transform,F=M.bufferedTilespaceBounds,U=this.grid.query(F.min.x,F.min.y,F.max.x,F.max.y,(ie,se,te,we)=>ox(M.bufferedTilespaceGeometry,ie,se,te,we));U.sort(T0);let W=null;k.elevation&&U.length>0&&(W=qg.create(k.elevation,this.tileID));const V={};let Q;for(let ie=0;ie<U.length;ie++){const se=U[ie];if(se===Q)continue;Q=se;const te=this.featureIndexArray.get(se);let we=null;this.loadMatchingFeature(V,te,E,w.layers,w.availableImages,l,p,y,(Oe,me,Ae,Ee=0)=>(we||(we=nu(Oe,this.tileID.canonical,o.tileTransform)),me.queryIntersectsFeature(M,Oe,Ae,we,this.z,o.transform,o.pixelPosMatrix,W,Ee)))}return V}loadMatchingFeature(o,l,p,y,w,E,M,k,F){const{featureIndex:U,bucketIndex:W,sourceLayerIndex:V,layoutVertexArrayOffset:Q}=l,ie=this.bucketLayerIDs[W];if(y&&!function(Oe,me){for(let Ae=0;Ae<Oe.length;Ae++)if(me.indexOf(Oe[Ae])>=0)return!0;return!1}(y,ie))return;const se=this.sourceLayerCoder.decode(V),te=this.vtLayers[se].feature(U);if(p.needGeometry){const Oe=Gf(te,!0);if(!p.filter(new We(this.tileID.overscaledZ),Oe,this.tileID.canonical))return}else if(!p.filter(new We(this.tileID.overscaledZ),te))return;const we=this.getId(te,se);for(let Oe=0;Oe<ie.length;Oe++){const me=ie[Oe];if(y&&y.indexOf(me)<0)continue;const Ae=E[me];if(!Ae)continue;let Ee={};void 0!==we&&k&&(Ee=k.getState(Ae.sourceLayer||"_geojsonTileLayer",we));const Re=gt({},M[me]);Re.paint=nw(Re.paint,Ae.paint,te,Ee,w),Re.layout=nw(Re.layout,Ae.layout,te,Ee,w);const lt=!F||F(te,Ae,Ee,Q);if(!lt)continue;const tt=new Ty(te,this.z,this.x,this.y,we);tt.layer=Re;let wt=o[me];void 0===wt&&(wt=o[me]=[]),wt.push({featureIndex:U,feature:tt,intersectionZ:lt})}}lookupSymbolFeatures(o,l,p,y,w,E,M,k){const F={};this.loadVTLayers();const U=qc(w);for(const W of o)this.loadMatchingFeature(F,{bucketIndex:p,sourceLayerIndex:y,featureIndex:W,layoutVertexArrayOffset:0},U,E,M,k,l);return F}loadFeature(o){const{featureIndex:l,sourceLayerIndex:p}=o;this.loadVTLayers();const y=this.sourceLayerCoder.decode(p),w=this.vtFeatures[y];if(w[l])return w[l];const E=this.vtLayers[y].feature(l);return w[l]=E,E}hasLayer(o){for(const l of this.bucketLayerIDs)for(const p of l)if(o===p)return!0;return!1}getId(o,l){let p=o.id;if(this.promoteId){const y="string"==typeof this.promoteId?this.promoteId:this.promoteId[l];null!=y&&(p=o.properties[y]),"boolean"==typeof p&&(p=Number(p))}return p}}function nw(a,o,l,p,y){return qn(a,(w,E)=>{const M=o instanceof et?o.get(E):null;return M&&M.evaluate?M.evaluate(l,p,y):M})}function T0(a,o){return o-a}gn(E0,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class iw{constructor(o,l){this.width=o,this.height=l,this.nextRow=0,this.image=new Qs({width:o,height:l}),this.positions={},this.uploaded=!1}getDash(o,l){const p=this.getKey(o,l);return this.positions[p]}trim(){const o=this.width,l=this.height=en(this.nextRow);this.image.resize({width:o,height:l})}getKey(o,l){return o.join(",")+l}getDashRanges(o,l,p){const y=[];let w=o.length%2==1?-o[o.length-1]*p:0,E=o[0]*p,M=!0;y.push({left:w,right:E,isDash:M,zeroLength:0===o[0]});let k=o[0];for(let F=1;F<o.length;F++){M=!M;const U=o[F];w=k*p,k+=U,E=k*p,y.push({left:w,right:E,isDash:M,zeroLength:0===U})}return y}addRoundDash(o,l,p){const y=l/2;for(let w=-p;w<=p;w++){const E=this.width*(this.nextRow+p+w);let M=0,k=o[M];for(let F=0;F<this.width;F++){F/k.right>1&&(k=o[++M]);const U=Math.abs(F-k.left),W=Math.abs(F-k.right),V=Math.min(U,W);let Q;const ie=w/p*(y+1);if(k.isDash){const se=y-Math.abs(ie);Q=Math.sqrt(V*V+se*se)}else Q=y-Math.sqrt(V*V+ie*ie);this.image.data[E+F]=Math.max(0,Math.min(255,Q+128))}}}addRegularDash(o,l){for(let k=o.length-1;k>=0;--k){const F=o[k],U=o[k+1];F.zeroLength?o.splice(k,1):U&&U.isDash===F.isDash&&(U.left=F.left,o.splice(k,1))}const p=o[0],y=o[o.length-1];p.isDash===y.isDash&&(p.left=y.left-this.width,y.right=p.right+this.width);const w=this.width*this.nextRow;let E=0,M=o[E];for(let k=0;k<this.width;k++){k/M.right>1&&(M=o[++E]);const F=Math.abs(k-M.left),U=Math.abs(k-M.right),W=Math.min(F,U);this.image.data[w+k]=Math.max(0,Math.min(255,(M.isDash?W:-W)+l+128))}}addDash(o,l){const p=this.getKey(o,l);if(this.positions[p])return this.positions[p];const y="round"===l,w=y?7:0,E=2*w+1;if(this.nextRow+E>this.height)return Ai("LineAtlas out of space"),null;0===o.length&&o.push(1);let M=0;for(let U=0;U<o.length;U++)o[U]<0&&(Ai("Negative value is found in line dasharray, replacing values with 0"),o[U]=0),M+=o[U];if(0!==M){const U=this.width/M,W=this.getDashRanges(o,this.width,U);y?this.addRoundDash(W,U,w):this.addRegularDash(W,"square"===l?.5*U:0)}const k=this.nextRow+w;this.nextRow+=E;const F={tl:[k,w],br:[M,0]};return this.positions[p]=F,F}}gn(iw,"LineAtlas");class Dy{constructor(o){const l={},p=[];for(const M in o){const k=o[M],F=l[M]={};for(const U in k.glyphs){const W=k.glyphs[+U];if(!W||0===W.bitmap.width||0===W.bitmap.height)continue;const V=W.metrics.localGlyph?2:1,Q={x:0,y:0,w:W.bitmap.width+2*V,h:W.bitmap.height+2*V};p.push(Q),F[U]=Q}}const{w:y,h:w}=uy(p),E=new Qs({width:y||1,height:w||1});for(const M in o){const k=o[M];for(const F in k.glyphs){const U=k.glyphs[+F];if(!U||0===U.bitmap.width||0===U.bitmap.height)continue;const W=l[M][F],V=U.metrics.localGlyph?2:1;Qs.copy(U.bitmap,E,{x:0,y:0},{x:W.x+V,y:W.y+V},U.bitmap)}}this.image=E,this.positions=l}}gn(Dy,"GlyphAtlas");class rw{constructor(o){this.tileID=new Ua(o.tileID.overscaledZ,o.tileID.wrap,o.tileID.canonical.z,o.tileID.canonical.x,o.tileID.canonical.y),this.tileZoom=o.tileZoom,this.uid=o.uid,this.zoom=o.zoom,this.canonical=o.tileID.canonical,this.pixelRatio=o.pixelRatio,this.tileSize=o.tileSize,this.source=o.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=o.showCollisionBoxes,this.collectResourceTiming=!!o.collectResourceTiming,this.returnDependencies=!!o.returnDependencies,this.promoteId=o.promoteId,this.enableTerrain=!!o.enableTerrain,this.isSymbolTile=o.isSymbolTile,this.tileTransform=ks(o.tileID.canonical,o.projection),this.projection=o.projection}parse(o,l,p,y,w){this.status="parsing",this.data=o,this.collisionBoxArray=new us;const E=new Ey(Object.keys(o.layers).sort()),M=new E0(this.tileID,this.promoteId);M.bucketLayerIDs=[];const k={},F=new iw(256,256),U={featureIndex:M,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:F,availableImages:p},W=l.familiesBySource[this.source];for(const Ee in W){const Re=o.layers[Ee];if(!Re)continue;let lt=!1,tt=!1;for(const ht of W[Ee])"symbol"===ht[0].type?lt=!0:tt=!0;if(!0===this.isSymbolTile&&!lt||!1===this.isSymbolTile&&!tt)continue;1===Re.version&&Ai(`Vector tile source "${this.source}" layer "${Ee}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const wt=E.encode(Ee),jt=[];for(let ht=0;ht<Re.length;ht++){const Tt=Re.feature(ht),At=M.getId(Tt,Ee);jt.push({feature:Tt,id:At,index:ht,sourceLayerIndex:wt})}for(const ht of W[Ee]){const Tt=ht[0];void 0!==this.isSymbolTile&&"symbol"===Tt.type!==this.isSymbolTile||Tt.minzoom&&this.zoom<Math.floor(Tt.minzoom)||Tt.maxzoom&&this.zoom>=Tt.maxzoom||"none"!==Tt.visibility&&(Zd(ht,this.zoom,p),(k[Tt.id]=Tt.createBucket({index:M.bucketLayerIDs.length,layers:ht,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:wt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:p})).populate(jt,U,this.tileID.canonical,this.tileTransform),M.bucketLayerIDs.push(ht.map(At=>At.id)))}}let V,Q,ie,se;F.trim();const te={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},we=qn(U.glyphDependencies,Ee=>Object.keys(Ee).map(Number));Object.keys(we).length?y.send("getGlyphs",{uid:this.uid,stacks:we},(Ee,Re)=>{V||(V=Ee,Q=Re,Ae.call(this))},void 0,!1,te):Q={};const Oe=Object.keys(U.iconDependencies);Oe.length?y.send("getImages",{icons:Oe,source:this.source,tileID:this.tileID,type:"icons"},(Ee,Re)=>{V||(V=Ee,ie=Re,Ae.call(this))},void 0,!1,te):ie={};const me=Object.keys(U.patternDependencies);function Ae(){if(V)return w(V);if(Q&&ie&&se){const Ee=new Dy(Q),Re=new Mg(ie,se);for(const lt in k){const tt=k[lt];tt instanceof Gd?(Zd(tt.layers,this.zoom,p),l0(tt,Q,Ee.positions,ie,Re.iconPositions,this.showCollisionBoxes,p,this.tileID.canonical,this.tileZoom,this.projection)):tt.hasPattern&&(tt instanceof Eg||tt instanceof W_||tt instanceof pm)&&(Zd(tt.layers,this.zoom,p),tt.addFeatures(U,this.tileID.canonical,Re.patternPositions,p,this.tileTransform))}this.status="done",w(null,{buckets:mt(k).filter(lt=>!lt.isEmpty()),featureIndex:M,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ee.image,lineAtlas:F,imageAtlas:Re,glyphMap:this.returnDependencies?Q:null,iconMap:this.returnDependencies?ie:null,glyphPositions:this.returnDependencies?Ee.positions:null})}}me.length?y.send("getImages",{icons:me,source:this.source,tileID:this.tileID,type:"patterns"},(Ee,Re)=>{V||(V=Ee,se=Re,Ae.call(this))},void 0,!1,te):se={},Ae.call(this)}}function Zd(a,o,l){const p=new We(o);for(const y of a)y.recalculate(p,l)}class hC{constructor(o){this.entries={},this.scheduler=o}request(o,l,p,y){const w=this.entries[o]=this.entries[o]||{callbacks:[]};if(w.result){const[E,M]=w.result;return this.scheduler?this.scheduler.add(()=>{y(E,M)},l):y(E,M),()=>{}}return w.callbacks.push(y),w.cancel||(w.cancel=p((E,M)=>{w.result=[E,M];for(const k of w.callbacks)this.scheduler?this.scheduler.add(()=>{k(E,M)},l):k(E,M);setTimeout(()=>delete this.entries[o],3e3)})),()=>{w.result||(w.callbacks=w.callbacks.filter(E=>E!==y),w.callbacks.length||(w.cancel(),delete this.entries[o]))}}}function fC(a,o,l){const p=JSON.stringify(a.request);return a.data&&(this.deduped.entries[p]={result:[null,a.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},y=>{const w=Jr(a.request,(E,M,k,F)=>{E?y(E):M&&y(null,{vectorTile:l?void 0:new Xf(new Ar(M)),rawData:M,cacheControl:k,expires:F})});return()=>{w.cancel(),y()}},o)}_.ARRAY_TYPE=La,_.AUTH_ERR_MSG=Ei,_.Aabb=ya,_.Actor=class{constructor(a,o,l){this.target=a,this.parent=o,this.mapId=l,this.callbacks={},this.cancelCallbacks={},Cn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=kr()?a:$e,this.scheduler=new p0}send(a,o,l,p,y=!1,w){const E=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=w,this.callbacks[E]=l);const M=co(this.globalScope)?void 0:[];return this.target.postMessage({id:E,type:a,hasCallback:!!l,targetMapId:p,mustQueue:y,sourceMapId:this.mapId,data:xr(o,M)},M),{cancel:()=>{l&&delete this.callbacks[E],this.target.postMessage({id:E,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(a){const o=a.data,l=o.id;if(l&&(!o.targetMapId||this.mapId===o.targetMapId))if("<cancel>"===o.type){const p=this.cancelCallbacks[l];delete this.cancelCallbacks[l],p&&p.cancel()}else if(o.mustQueue||kr()){const p=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,o),p&&p.metadata||{type:"message"})}else this.processTask(l,o)}processTask(a,o){if("<response>"===o.type){const l=this.callbacks[a];delete this.callbacks[a],l&&(o.error?l(Fu(o.error)):l(null,Fu(o.data)))}else{const l=co(this.globalScope)?void 0:[],p=o.hasCallback?(w,E)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:w?xr(w):null,data:xr(E,l)},l)}:w=>{},y=Fu(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,y,p);else if(this.parent.getWorkerSource){const w=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,w[0],y.source)[w[1]](y,p)}else p(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},_.CanonicalTileID=r0,_.Color=to,_.ColorMode=bc,_.CullFaceMode=xc,_.DEMData=Dm,_.DataConstantProperty=qe,_.DedupedRequest=hC,_.DepthMode=zl,_.EXTENT=Jn,_.Elevation=class{isDataAvailableAtPoint(a){const o=this._source();if(this.isUsingMockSource()||!o||a.y<0||a.y>1)return!1;const l=o.getSource().maxzoom,p=1<<l,y=Math.floor(a.x),w=Math.floor((a.x-y)*p),E=Math.floor(a.y*p),M=this.findDEMTileFor(new Ua(l,y,l,w,E));return!(!M||!M.dem)}getAtPointOrZero(a,o=0){return this.getAtPoint(a,o)||0}getAtPoint(a,o,l=!0){if(this.isUsingMockSource())return null;null==o&&(o=null);const p=this._source();if(!p||a.y<0||a.y>1)return o;const y=p.getSource().maxzoom,w=1<<y,E=Math.floor(a.x),M=a.x-E,k=new Ua(y,E,y,Math.floor(M*w),Math.floor(a.y*w)),F=this.findDEMTileFor(k);if(!F||!F.dem)return o;const U=F.dem,W=1<<F.tileID.canonical.z,V=(M*W-F.tileID.canonical.x)*U.dim,Q=(a.y*W-F.tileID.canonical.y)*U.dim,ie=Math.floor(V),se=Math.floor(Q);return(l?this.exaggeration():1)*di(di(U.get(ie,se),U.get(ie,se+1),Q-se),di(U.get(ie+1,se),U.get(ie+1,se+1),Q-se),V-ie)}getAtTileOffset(a,o,l){const p=1<<a.canonical.z;return this.getAtPointOrZero(new jf(a.wrap+(a.canonical.x+o/Jn)/p,(a.canonical.y+l/Jn)/p))}getAtTileOffsetFunc(a,o,l,p){return y=>{const w=this.getAtTileOffset(a,y.x,y.y),E=p.upVector(a.canonical,y.x,y.y);return Gs(E,E,w*p.upVectorScale(a.canonical,o,l).metersToTile),E}}getForTilePoints(a,o,l,p){if(this.isUsingMockSource())return!1;const y=qg.create(this,a,p);return!!y&&(o.forEach(w=>{w[2]=this.exaggeration()*y.getElevationAt(w[0],w[1],l)}),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(a);if(!o||!o.dem)return null;const l=o.dem.tree,p=o.tileID,y=1<<a.canonical.z-p.canonical.z;let w=a.canonical.x/y-p.canonical.x,E=a.canonical.y/y-p.canonical.y,M=0;for(let k=0;k<a.canonical.z-p.canonical.z&&!l.leaves[M];k++){w*=2,E*=2;const F=2*Math.floor(E)+Math.floor(w);M=l.childOffsets[M]+F,w%=1,E%=1}return{min:this.exaggeration()*l.minimums[M],max:this.exaggeration()*l.maximums[M]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,o,l){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},_.ErrorEvent=Zi,_.EvaluationParameters=We,_.Event=fr,_.Evented=Rr,_.FillExtrusionBucket=pm,_.Frustum=k_,_.FrustumCorners=Lh,_.GLOBE_RADIUS=ol,_.GLOBE_SCALE_MATCH_LATITUDE=45,_.GLOBE_ZOOM_THRESHOLD_MAX=6,_.GLOBE_ZOOM_THRESHOLD_MIN=5,_.GlobeSharedBuffers=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const a of this._wireframeSegments)a.destroy()}}_fillGridMeshWithLods(a,o){const l=new Vn,p=new mo,y=[],w=a+1+2,E=o[0]+1,M=o[0]+1+(1+o.length),k=(F,U,W)=>{let V=F===w-1?F-2:0===F?F:F-1;return V+=W?24575:0,[V,U]};for(let F=0;F<w;++F)l.emplaceBack(...k(F,0,!0));for(let F=0;F<E;++F)for(let U=0;U<w;++U)l.emplaceBack(...k(U,F,(0===U||U===w-1)&&!0));for(let F=0;F<o.length;++F){const U=o[F];for(let W=0;W<w;++W)l.emplaceBack(...k(W,U,!0))}for(let F=0;F<o.length;++F){const U=p.length,W=o[F]+1+2,V=new mo;for(let se=0;se<W-1;se++){const te=se===W-2,we=te?w*(M-o.length+F-se):w;for(let Oe=0;Oe<w-1;Oe++){const me=se*w+Oe;0===se||te||0===Oe||Oe===w-2?(V.emplaceBack(me+1,me,me+we),V.emplaceBack(me+we,me+we+1,me+1)):(p.emplaceBack(me+1,me,me+we),p.emplaceBack(me+we,me+we+1,me+1))}}const Q=Yr.simpleSegment(0,U,l.length,p.length-U);for(let se=0;se<V.uint16.length;se+=3)p.emplaceBack(V.uint16[se],V.uint16[se+1],V.uint16[se+2]);const ie=Yr.simpleSegment(0,U,l.length,p.length-U);y.push({withoutSkirts:Q,withSkirts:ie})}return{vertices:l,indices:p,segments:y}}_createGrid(a){const o=this._fillGridMeshWithLods(64,zf);this._gridSegments=o.segments,this._gridBuffer=a.createVertexBuffer(o.vertices,tm.members),this._gridIndexBuffer=a.createIndexBuffer(o.indices,!0)}_createPoles(a){const o=new mo;for(let y=0;y<=64;y++)o.emplaceBack(0,y+1,y+2);this._poleIndexBuffer=a.createIndexBuffer(o,!0);const l=new Ys,p=new Ys;this._poleSegments=[];for(let y=0,w=0;y<5;y++){const E=360/(1<<y);l.emplaceBack(0,-ol,0,.5,0),p.emplaceBack(0,-ol,0,.5,1);for(let M=0;M<=64;M++){const k=M/64,F=di(0,E,k),[U,W,V]=zh(ix,z1,F,ol);l.emplaceBack(U,W,V,k,0),p.emplaceBack(U,W,V,k,1)}this._poleSegments.push(Yr.simpleSegment(w,0,66,64)),w+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(l,fc,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(p,fc,!1)}getGridBuffers(a,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}getWirefameBuffers(a,o){if(!this._wireframeSegments){const l=new Al,p=64,y=p+1+2,w=1;this._wireframeSegments=[];for(let E=0,M=0;E<zf.length;E++){const k=zf[E];for(let U=w;U<k+w;U++)for(let W=w;W<p+w;W++){const V=U*y+W;l.emplaceBack(V,V+1),l.emplaceBack(V,V+y),l.emplaceBack(V,V+y+1)}const F=k*p*3;this._wireframeSegments.push(Yr.simpleSegment(0,M,(k+1)*y,F)),M+=F}this._wireframeIndexBuffer=a.createIndexBuffer(l)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[o]]}},_.GlyphManager=Qu,_.ImagePosition=np,_.LivePerformanceUtils=rt,_.LngLat=tr,_.LngLatBounds=uc,_.LocalGlyphMode=kg,_.MAX_MERCATOR_LATITUDE=So,_.MercatorCoordinate=jf,_.ONE_EM=Kr,_.OverscaledTileID=Ua,_.PerformanceMarkers=He,_.Properties=Rt,_.RGBAImage=Ba,_.Ray=zv,_.RequestManager=class{constructor(a,o,l){this._transformRequestFn=a,this._customAccessToken=o,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const a=function(){let o="";for(let l=0;l<10;l++)o+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",bn,o].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,o){return this._transformRequestFn&&this._transformRequestFn(a,o)||{url:a}}normalizeStyleURL(a,o){if(!ho(a))return a;const l=ti(a);return l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||o)}normalizeGlyphsURL(a,o){if(!ho(a))return a;const l=ti(a);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||o)}normalizeSourceURL(a,o,l,p){if(!ho(a))return a;const y=ti(a);return y.path=`/v4/${y.authority}.json`,y.params.push("secure"),l&&y.params.push(`language=${l}`),p&&y.params.push(`worldview=${p}`),this._makeAPIURL(y,this._customAccessToken||o)}normalizeSpriteURL(a,o,l,p){const y=ti(a);return ho(a)?(y.path=`/styles/v1${y.path}/sprite${o}${l}`,this._makeAPIURL(y,this._customAccessToken||p)):(y.path+=`${o}${l}`,Oi(y))}normalizeTileURL(a,o,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!ho(a))return a;const p=ti(a);p.path=p.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${o||l&&"raster"!==p.authority&&512===l?"@2x":""}${It.supported?".webp":"$1"}`),"raster"===p.authority?p.path=`/${yt.RASTER_URL_PREFIX}${p.path}`:(p.path=p.path.replace(/^.+\/v4\//,"/"),p.path=`/${yt.TILE_URL_VERSION}${p.path}`);const y=this._customAccessToken||function(w){for(const E of w){const M=E.match(/^access_token=(.*)$/);if(M)return M[1]}return null}(p.params)||yt.ACCESS_TOKEN;return yt.REQUIRE_ACCESS_TOKEN&&y&&this._skuToken&&p.params.push(`sku=${this._skuToken}`),this._makeAPIURL(p,y)}canonicalizeTileURL(a,o){const l=ti(a);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return a;let p="mapbox://";l.path.match(/^\/raster\/v1\//)?p+=`raster/${l.path.replace(`/${yt.RASTER_URL_PREFIX}/`,"")}`:p+=`tiles/${l.path.replace(`/${yt.TILE_URL_VERSION}/`,"")}`;let y=l.params;return o&&(y=y.filter(w=>!w.match(/^access_token=/))),y.length&&(p+=`?${y.join("&")}`),p}canonicalizeTileset(a,o){const l=!!o&&ho(o),p=[];for(const y of a.tiles||[])qr(y)?p.push(this.canonicalizeTileURL(y,l)):p.push(y);return p}_makeAPIURL(a,o){const l="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",p=ti(yt.API_URL);if(a.protocol=p.protocol,a.authority=p.authority,"http"===a.protocol){const y=a.params.indexOf("secure");y>=0&&a.params.splice(y,1)}if("/"!==p.path&&(a.path=`${p.path}${a.path}`),!yt.REQUIRE_ACCESS_TOKEN)return Oi(a);if(o=o||yt.ACCESS_TOKEN,!this._silenceAuthErrors){if(!o)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if("s"===o[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return a.params=a.params.filter(y=>-1===y.indexOf("access_token")),a.params.push(`access_token=${o||""}`),Oi(a)}},_.ResourceType=jn,_.SegmentVector=Yr,_.SourceCache=cp,_.StencilMode=qd,_.StructArrayLayout1ui2=el,_.StructArrayLayout2f1f2i16=Qn,_.StructArrayLayout2i4=Vn,_.StructArrayLayout2ui4=Al,_.StructArrayLayout3f12=bs,_.StructArrayLayout3ui6=mo,_.StructArrayLayout4i8=Ri,_.StructArrayLayout5f20=Ys,_.Texture=Xh,_.Tile=Iy,_.Transitionable=Ut,_.Uniform1f=ct,_.Uniform1i=class extends ye{constructor(a){super(a),this.current=0}set(a,o,l){this.fetchUniformLocation(a,o)&&this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},_.Uniform2f=class extends ye{constructor(a){super(a),this.current=[0,0]}set(a,o,l){this.fetchUniformLocation(a,o)&&(l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1])))}},_.Uniform3f=class extends ye{constructor(a){super(a),this.current=[0,0,0]}set(a,o,l){this.fetchUniformLocation(a,o)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2])))}},_.Uniform4f=Gt,_.UniformColor=Tn,_.UniformMatrix2f=class extends ye{constructor(a){super(a),this.current=_o}set(a,o,l){if(this.fetchUniformLocation(a,o))for(let p=0;p<4;p++)if(l[p]!==this.current[p]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}},_.UniformMatrix3f=class extends ye{constructor(a){super(a),this.current=zi}set(a,o,l){if(this.fetchUniformLocation(a,o))for(let p=0;p<9;p++)if(l[p]!==this.current[p]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}},_.UniformMatrix4f=class extends ye{constructor(a){super(a),this.current=ri}set(a,o,l){if(this.fetchUniformLocation(a,o)){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let p=1;p<16;p++)if(l[p]!==this.current[p]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}}},_.UnwrappedTileID=Ex,_.ValidationError=fn,_.VectorTileFeature=Qf,_.VectorTileWorkerSource=class extends Rr{constructor(a,o,l,p,y){super(),this.actor=a,this.layerIndex=o,this.availableImages=l,this.loadVectorData=y||fC,this.loading={},this.loaded={},this.deduped=new hC(a.scheduler),this.isSpriteLoaded=p,this.scheduler=a.scheduler}loadTile(a,o){const l=a.uid,p=a&&a.request,y=p&&p.collectResourceTiming,w=this.loading[l]=new rw(a);w.abort=this.loadVectorData(a,(E,M)=>{const k=!this.loading[l];if(delete this.loading[l],k||E||!M)return w.status="done",k||(this.loaded[l]=w),o(E);const F=M.rawData,U={};M.expires&&(U.expires=M.expires),M.cacheControl&&(U.cacheControl=M.cacheControl),w.vectorTile=M.vectorTile||new Xf(new Ar(F));const W=()=>{w.parse(w.vectorTile,this.layerIndex,this.availableImages,this.actor,(V,Q)=>{if(V||!Q)return o(V);const ie={};if(y){const se=En(p);se.length>0&&(ie.resourceTiming=JSON.parse(JSON.stringify(se)))}o(null,gt({rawTileData:F.slice(0)},Q,U,ie))})};this.isSpriteLoaded?W():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(W,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):W()}),this.loaded=this.loaded||{},this.loaded[l]=w})}reloadTile(a,o){const l=this.loaded,p=a.uid,y=this;if(l&&l[p]){const w=l[p];w.showCollisionBoxes=a.showCollisionBoxes,w.enableTerrain=!!a.enableTerrain,w.projection=a.projection,w.tileTransform=ks(a.tileID.canonical,a.projection);const E=(M,k)=>{const F=w.reloadCallback;F&&(delete w.reloadCallback,w.parse(w.vectorTile,y.layerIndex,this.availableImages,y.actor,F)),o(M,k)};"parsing"===w.status?w.reloadCallback=E:"done"===w.status&&(w.vectorTile?w.parse(w.vectorTile,this.layerIndex,this.availableImages,this.actor,E):E())}}abortTile(a,o){const l=a.uid,p=this.loading[l];p&&(p.abort&&p.abort(),delete this.loading[l]),o()}removeTile(a,o){const l=this.loaded,p=a.uid;l&&l[p]&&delete l[p],o()}},_.WritingMode=ll,_.ZoomDependentExpression=Il,_.add=Na,_.addDynamicAttributes=Bg,_.adjoint=function(a,o){var l=o[0],p=o[1],y=o[2],w=o[3],E=o[4],M=o[5],k=o[6],F=o[7],U=o[8];return a[0]=E*U-M*F,a[1]=y*F-p*U,a[2]=p*M-y*E,a[3]=M*k-w*U,a[4]=l*U-y*k,a[5]=y*w-l*M,a[6]=w*F-E*k,a[7]=p*k-l*F,a[8]=l*E-p*w,a},_.asyncAll=On,_.bezier=pt,_.bindAll=Cn,_.boundsAttributes=Sm,_.bufferConvexPolygon=function(a,o){const l=[];for(let p=0;p<a.length;p++){const y=si(p-1,-1,a.length-1),w=si(p+1,-1,a.length-1),E=a[p],M=a[w],k=a[y].sub(E).unit(),F=M.sub(E).unit(),U=F.angleWithSep(k.x,k.y),W=k.add(F).unit().mult(-1*o/Math.sin(U/2));l.push(E.add(W))}return l},_.cacheEntryPossiblyAdded=function(a){hi++,hi>ss&&(a.getActor().send("enforceCacheSizeLimit",Uo),hi=0)},_.calculateGlobeLabelMatrix=function(a,o){const{x:l,y:p}=a.point,y=N_(l,p,a.worldSize/a._pixelsPerMercatorPixel,0,0);return Md(y,y,Bv(Rl(o)))},_.calculateGlobeMatrix=function(a){const{x:o,y:l}=a.point,{lng:p,lat:y}=a._center;return N_(o,l,a.worldSize,p,y)},_.calculateGlobeMercatorMatrix=function(a){const o=a.pixelsPerMeter,l=o/Fl(1,a.center.lat),p=dc(new Float64Array(16));return Rh(p,p,[a.point.x,a.point.y,0]),hc(p,p,[l,l,o]),Float32Array.from(p)},_.circumferenceAtLatitude=Vf,_.clamp=zt,_.clearTileCache=function(a){if(!wo())return;const o=$e.caches.delete(Sr);a&&o.catch(a).then(()=>a())},_.clipLine=$x,_.clone=function(a){var o=new La(16);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],o[4]=a[4],o[5]=a[5],o[6]=a[6],o[7]=a[7],o[8]=a[8],o[9]=a[9],o[10]=a[10],o[11]=a[11],o[12]=a[12],o[13]=a[13],o[14]=a[14],o[15]=a[15],o},_.clone$1=vn,_.collisionCircleLayout=Fd,_.config=yt,_.conjugate=function(a,o){return a[0]=-o[0],a[1]=-o[1],a[2]=-o[2],a[3]=o[3],a},_.create=function(){var a=new La(16);return La!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},_.create$1=M_,_.createExpression=Tl,_.createLayout=yn,_.createStyleLayer=function(a){return"custom"===a.type?new Cy(a):new uC[a.type](a)},_.cross=Pv,_.degToRad=xt,_.distance=function(a,o){return Math.hypot(o[0]-a[0],o[1]-a[1],o[2]-a[2])},_.div=function(a,o,l){return a[0]=o[0]/l[0],a[1]=o[1]/l[1],a[2]=o[2]/l[2],a},_.dot=tu,_.earthRadius=Ad,_.ease=Nt,_.easeCubicInOut=nt,_.ecefToLatLng=function([a,o,l]){const p=Math.hypot(a,o,l),y=Math.atan2(a,l),w=.5*Math.PI-Math.acos(-o/p);return new tr(Pt(y),Pt(w))},_.emitValidationErrors=ku,_.endsWith=ir,_.enforceCacheSizeLimit=function(a){Gr(),$r&&$r.then(o=>{o.keys().then(l=>{for(let p=0;p<l.length-a;p++)o.delete(l[p])})})},_.evaluateSizeForFeature=sy,_.evaluateSizeForZoom=Jf,_.evaluateVariableOffset=Wx,_.evented=Me,_.exactEquals=function(a,o){return a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]&&a[3]===o[3]},_.exactEquals$1=function(a,o){return a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]},_.exported=mi,_.exported$1=It,_.extend=gt,_.extend$1=ko,_.fillExtrusionHeightLift=n0,_.filterObject=Bn,_.fromMat4=function(a,o){return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[4],a[4]=o[5],a[5]=o[6],a[6]=o[8],a[7]=o[9],a[8]=o[10],a},_.fromQuat=function(a,o){var l=o[0],p=o[1],y=o[2],w=o[3],E=l+l,M=p+p,k=y+y,F=l*E,U=p*E,W=p*M,V=y*E,Q=y*M,ie=y*k,se=w*E,te=w*M,we=w*k;return a[0]=1-W-ie,a[1]=U+we,a[2]=V-te,a[3]=0,a[4]=U-we,a[5]=1-F-ie,a[6]=Q+se,a[7]=0,a[8]=V+te,a[9]=Q-se,a[10]=1-F-W,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},_.fromRotation=function(a,o){var l=Math.sin(o),p=Math.cos(o);return a[0]=p,a[1]=l,a[2]=0,a[3]=-l,a[4]=p,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},_.fromScaling=Xp,_.furthestTileCorner=function(a){const o=Math.round((a+45+360)%360/90)%4;return un[o]},_.getAABBPointSquareDist=function(a,o,l){let p=0;for(let y=0;y<2;++y){const w=l?l[y]:0;a[y]>w&&(p+=(a[y]-w)*(a[y]-w)),o[y]<w&&(p+=(w-o[y])*(w-o[y]))}return p},_.getAnchorAlignment=Gh,_.getAnchorJustification=Yx,_.getBounds=function(a){let o=1/0,l=1/0,p=-1/0,y=-1/0;for(const w of a)o=Math.min(o,w.x),l=Math.min(l,w.y),p=Math.max(p,w.x),y=Math.max(y,w.y);return{min:new Ye(o,l),max:new Ye(p,y)}},_.getColumn=gs,_.getGridMatrix=function(a,o,l,p){const y=o.getNorth(),w=o.getSouth(),E=o.getWest(),M=o.getEast(),k=1<<a.z,F=M-E,U=y-w,W=F/64,V=-U/zf[l],Q=[0,W,0,V,0,0,y,E,0];if(a.z>0){const ie=180/p;kh(Q,Q,[ie/F+1,0,0,0,ie/U+1,0,-.5*ie/W,.5*ie/V,1])}return Q[2]=k,Q[5]=a.x,Q[8]=a.y,Q},_.getImage=Bs,_.getJSON=function(a,o){return Mr(gt(a,{type:"json"}),o)},_.getLatitudinalLod=function(a){const o=So-5;a=zt(a,-o,o)/o*90;const l=Math.pow(Math.abs(Math.sin(xt(a))),3);return Math.round(l*(zf.length-1))},_.getMapSessionAPI=Be,_.getPerformanceMeasurement=En,_.getProjection=yy,_.getRTLTextPluginStatus=Le,_.getReferrer=zr,_.getTilePoint=function(a,{x:o,y:l},p=0){return new Ye(((o-p)*a.scale-a.x)*Jn,(l*a.scale-a.y)*Jn)},_.getTileVec3=function(a,o,l=0){return Fh(((o.x-l)*a.scale-a.x)*Jn,(o.y*a.scale-a.y)*Jn,am(o.z,o.y))},_.getVideo=function(a,o){const l=$e.document.createElement("video");l.muted=!0,l.onloadstart=function(){o(null,l)};for(let p=0;p<a.length;p++){const y=$e.document.createElement("source");Oo(a[p])||(l.crossOrigin="Anonymous"),y.src=a[p],l.appendChild(y)}return{cancel:()=>{}}},_.globeCenterToScreenPoint=function(a){const o=[0,0,0],l=dc(new Float64Array(16));return Md(l,a.pixelMatrix,a.globeMatrix),yo(o,o,l),new Ye(o[0],o[1])},_.globeDenormalizeECEF=Bv,_.globeECEFOrigin=function(a,o){const l=[0,0,0];return yo(l,l,om(Rl(o.canonical))),yo(l,l,a),l},_.globeMetersToEcef=pc,_.globeNormalizeECEF=om,_.globePixelsToTileUnits=function(a,o){return Jn/(512*Math.pow(2,a))*L_(Rl(o))},_.globePoleMatrixForTile=function(a,o,l){const p=dc(new Float64Array(16)),y=(o/(1<<a)-.5)*Math.PI*2;return Kp(p,l.globeMatrix,y),Float32Array.from(p)},_.globeTileBounds=Rl,_.globeTiltAtLngLat=Vv,_.globeToMercatorTransition=sm,_.globeUseCustomAntiAliasing=function(a,o,l){const p=sm(l.zoom),y=a.style.map._antialias,w=!!o.extStandardDerivatives,E=o.extStandardDerivativesForceOff||a.terrain&&a.terrain.exaggeration()>0;return 0===p&&!y&&!E&&w},_.identity=dc,_.identity$1=Jb,_.invert=ag,_.isFullscreen=function(){return!!$e.document.fullscreenElement||!!$e.document.webkitFullscreenElement},_.isLngLatBehindGlobe=dg,_.isMapAuthenticated=function(a){return Pe.has(a)},_.isMapboxURL=ho,_.isSafariWithAntialiasingBug=function(a){const o=a.navigator?a.navigator.userAgent:null;return!!co(a)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},_.latFromMercatorY=Xs,_.latLngToECEF=Gu,_.len=Ov,_.length=il,_.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},_.lngFromMercatorX=za,_.loadVectorTile=fC,_.makeRequest=Mr,_.mapValue=function(a,o,l,p,y){return zt((a-o)/(l-o)*(y-p)+p,p,y)},_.mercatorScale=Uf,_.mercatorXfromLng=Hu,_.mercatorYfromLat=qu,_.mercatorZfromAltitude=Fl,_.mul=Qp,_.mul$1=P_,_.multiply=Md,_.multiply$1=kh,_.multiply$2=Jp,_.nextPowerOfTwo=en,_.normalize=_a,_.normalize$1=Lv,_.normalize$2=Rv,_.number=di,_.ortho=function(a,o,l,p,y,w,E){var M=1/(o-l),k=1/(p-y),F=1/(w-E);return a[0]=-2*M,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*k,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*F,a[11]=0,a[12]=(o+l)*M,a[13]=(y+p)*k,a[14]=(E+w)*F,a[15]=1,a},_.pbf=Ar,_.perspective=function(a,o,l,p,y){var w,E=1/Math.tan(o/2);return a[0]=E/l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=E,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=y&&y!==1/0?(a[10]=(y+p)*(w=1/(p-y)),a[14]=2*y*p*w):(a[10]=-1,a[14]=-2*p),a},_.pick=function(a,o){const l={};for(let p=0;p<o.length;p++){const y=o[p];y in a&&(l[y]=a[y])}return l},_.plugin=Ue,_.pointGeometry=Ye,_.polesInViewport=function(a){const o=dc(new Float64Array(16));Md(o,a.pixelMatrix,a.globeMatrix);const l=[0,kl,0],p=[0,sl,0];return yo(l,l,o),yo(p,p,o),[l[0]>0&&l[0]<=a.width&&l[1]>0&&l[1]<=a.height&&!dg(a,new tr(a.center.lat,90)),p[0]>0&&p[0]<=a.width&&p[1]>0&&p[1]<=a.height&&!dg(a,new tr(a.center.lat,-90))]},_.polygonContainsPoint=Pd,_.polygonIntersectsBox=ox,_.polygonIntersectsPolygon=iu,_.polygonizeBounds=function(a,o,l=0,p=!0){const y=new Ye(l,l),w=a.sub(y),E=o.add(y),M=[w,new Ye(E.x,w.y),E,new Ye(w.x,E.y)];return p&&M.push(w.clone()),M},_.posAttributes=tm,_.postMapLoadEvent=Y,_.postPerformanceEvent=pe,_.postTurnstileEvent=$,_.potpack=uy,_.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},_.radToDeg=Pt,_.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],_.registerForPluginStateChange=function(a){return a({pluginStatus:xe,pluginURL:ue}),Me.on("pluginStateChange",a),a},_.removeAuthState=function(a){Pe.delete(a)},_.renderColorRamp=Zv,_.resample=hg,_.rotateX=Dd,_.rotateX$1=Fv,_.rotateY=Kp,_.rotateY$1=O_,_.rotateZ=function(a,o,l){var p=Math.sin(l),y=Math.cos(l),w=o[0],E=o[1],M=o[2],k=o[3],F=o[4],U=o[5],W=o[6],V=o[7];return o!==a&&(a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=w*y+F*p,a[1]=E*y+U*p,a[2]=M*y+W*p,a[3]=k*y+V*p,a[4]=F*y-w*p,a[5]=U*y-E*p,a[6]=W*y-M*p,a[7]=V*y-k*p,a},_.rotateZ$1=function(a,o,l){l*=.5;var p=o[0],y=o[1],w=o[2],E=o[3],M=Math.sin(l),k=Math.cos(l);return a[0]=p*k+y*M,a[1]=y*k-p*M,a[2]=w*k+E*M,a[3]=E*k-w*M,a},_.scale=hc,_.scale$1=kv,_.scale$2=Gs,_.scaleAndAdd=lg,_.set=function(a,o,l,p){return a[0]=o,a[1]=l,a[2]=p,a},_.setCacheLimits=function(a,o){Uo=a,ss=o},_.setColumn=function(a,o,l){a[4*o+0]=l[0],a[4*o+1]=l[1],a[4*o+2]=l[2],a[4*o+3]=l[3]},_.setRTLTextPlugin=function(a,o,l=!1){if(xe===fe||xe===_e||xe===de)throw new Error("setRTLTextPlugin cannot be called multiple times.");ue=mi.resolveURL(a),xe=fe,ve=o,be(),l||Fe()},_.smoothstep=an,_.spec=dt,_.squaredLength=function(a){var o=a[0],l=a[1],p=a[2];return o*o+l*l+p*p},_.storeAuthState=function(a,o){o?Pe.add(a):Pe.delete(a)},_.sub=rl,_.subtract=Lf,_.symbolSize=rC,_.tileAABB=function(a,o,l,p,y,w,E,M,k){if("globe"===k.name)return function F_(a,o,l){const p=o/a.worldSize,y=a.globeMatrix;if(l.z<=1){const tt=Rl(l).getCorners();return nx(tt,y,p),ya.fromPoints(tt)}const w=im(l),E=rm(w);nx(E,y,p);const M=Number.MAX_VALUE,k=[-M,-M,-M],F=[M,M,M];if(w.contains(a.center)){for(const jt of E)ju(F,F,jt),Nf(k,k,jt);k[2]=0;const tt=a.point,wt=[tt.x*p,tt.y*p,0];return ju(F,F,wt),Nf(k,k,wt),new ya(F,k)}const U=[y[12]*p,y[13]*p,y[14]*p],W=w.getCenter(),V=zt(a.center.lat,-So,So),Q=zt(W.lat,-So,So),ie=Hu(a.center.lng),se=qu(V);let te=ie-Hu(W.lng);const we=se-qu(Q);te>.5?te-=1:te<-.5&&(te+=1);let Oe=0;Math.abs(te)>Math.abs(we)?Oe=te>=0?1:3:(Oe=we>=0?0:2,lg(U,U,[y[4]*p,y[5]*p,y[6]*p],-Math.sin(xt(we>=0?w.getSouth():w.getNorth()))*ol));const me=E[Oe],Ae=E[(Oe+1)%4],Ee=new ex(me,Ae,U),Re=[R_(Ee,0)||me[0],R_(Ee,1)||me[1],R_(Ee,2)||me[2]],lt=sm(a.zoom);if(lt>0){const tt=function({x:jt,y:ht,z:Tt},At,Et,Vt,ot){const tn=1/(1<<Tt);let Yn=jt*tn,mn=Yn+tn,Dn=ht*tn,ln=Dn+tn,kn=0;const Li=(Yn+mn)/2-Vt;return Li>.5?kn=-1:Li<-.5&&(kn=1),Yn=((Yn+kn)*At-(Vt*=At))*Et+Vt,mn=((mn+kn)*At-Vt)*Et+Vt,Dn=(Dn*At-(ot*=At))*Et+ot,ln=(ln*At-ot)*Et+ot,[[Yn,ln,0],[mn,ln,0],[mn,Dn,0],[Yn,Dn,0]]}(l,o,a._pixelsPerMercatorPixel,ie,se);for(let jt=0;jt<E.length;jt++)Bf(E[jt],tt[jt],lt);const wt=Na([],tt[Oe],tt[(Oe+1)%4]);Gs(wt,wt,.5),Bf(Re,wt,lt)}for(const tt of E)ju(F,F,tt),Nf(k,k,tt);return F[2]=Math.min(me[2],Ae[2]),ju(F,F,Re),Nf(k,k,Re),new ya(F,k)}(a,o,new r0(l,p,y));const F=ks({z:l,x:p,y},k);return new ya([(w+F.x/F.scale)*o,o*(F.y/F.scale),E],[(w+F.x2/F.scale)*o,o*(F.y2/F.scale),M])},_.tileCornersToBounds=im,_.tileTransform=ks,_.transformMat3=function(a,o,l){var p=o[0],y=o[1],w=o[2];return a[0]=p*l[0]+y*l[3]+w*l[6],a[1]=p*l[1]+y*l[4]+w*l[7],a[2]=p*l[2]+y*l[5]+w*l[8],a},_.transformMat4=yo,_.transformMat4$1=Ol,_.transformQuat=Xb,_.transitionTileAABBinECEF=tx,_.translate=Rh,_.transpose=function(a,o){if(a===o){var l=o[1],p=o[2],y=o[5];a[1]=o[3],a[2]=o[6],a[3]=l,a[5]=o[7],a[6]=p,a[7]=y}else a[0]=o[0],a[1]=o[3],a[2]=o[6],a[3]=o[1],a[4]=o[4],a[5]=o[7],a[6]=o[2],a[7]=o[5],a[8]=o[8];return a},_.triggerPluginCompletionEvent=Ce,_.uniqueId=Ht,_.updateGlobeVertexNormal=function(a,o,l,p,y){const w=5*o+2;a.float32[w+0]=l,a.float32[w+1]=p,a.float32[w+2]=y},_.validateCustomStyleLayer=function(a){const o=[],l=a.id;return void 0===l&&o.push({message:`layers.${l}: missing required property "id"`}),void 0===a.render&&o.push({message:`layers.${l}: missing required method "render"`}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&o.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),o},_.validateFilter=a=>Os(Pu(a)),_.validateFog=a=>Os(Wc(a)),_.validateLayer=a=>Os(_h(a)),_.validateLight=a=>Os(Mf(a)),_.validateSource=a=>Os(da(a)),_.validateStyle=Af,_.validateTerrain=a=>Os(Id(a)),_.values=mt,_.vectorTile=X_,_.version=ft,_.warnOnce=Ai,_.window=$e,_.wrap=si}),Ne(0,function(_){function $e(ne){if("number"==typeof ne||"boolean"==typeof ne||"string"==typeof ne||null==ne)return JSON.stringify(ne);if(Array.isArray(ne)){let H="[";for(const Y of ne)H+=`${$e(Y)},`;return`${H}]`}let $="{";for(const H of Object.keys(ne).sort())$+=`${H}:${$e(ne[H])},`;return`${$}}`}function ft(ne){let $="";for(const H of _.refProperties)$+=`/${$e(ne[H])}`;return $}class on{constructor($){this.keyCache={},$&&this.replace($)}replace($){this._layerConfigs={},this._layers={},this.update($,[])}update($,H){for(const ae of $)this._layerConfigs[ae.id]=ae,(this._layers[ae.id]=_.createStyleLayer(ae)).compileFilter(),this.keyCache[ae.id]&&delete this.keyCache[ae.id];for(const ae of H)delete this.keyCache[ae],delete this._layerConfigs[ae],delete this._layers[ae];this.familiesBySource={};const Y=function(ae,pe){const ke={};for(let Pe=0;Pe<ae.length;Pe++){const He=pe&&pe[ae[Pe].id]||ft(ae[Pe]);pe&&(pe[ae[Pe].id]=He);let rt=ke[He];rt||(rt=ke[He]=[]),rt.push(ae[Pe])}const Be=[];for(const Pe in ke)Be.push(ke[Pe]);return Be}(_.values(this._layerConfigs),this.keyCache);for(const ae of Y){const pe=ae.map($t=>this._layers[$t.id]),ke=pe[0];if("none"===ke.visibility)continue;const Be=ke.source||"";let Pe=this.familiesBySource[Be];Pe||(Pe=this.familiesBySource[Be]={});const He=ke.sourceLayer||"_geojsonTileLayer";let rt=Pe[He];rt||(rt=Pe[He]=[]),rt.push(pe)}}}class yt{loadTile($,H){const{uid:Y,encoding:ae,rawImageData:pe,padding:ke,buildQuadTree:Be}=$,Pe=_.window.ImageBitmap&&pe instanceof _.window.ImageBitmap?this.getImageData(pe,ke):pe;H(null,new _.DEMData(Y,Pe,ae,ke<1,Be))}getImageData($,H){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas($.width,$.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=$.width,this.offscreenCanvas.height=$.height,this.offscreenCanvasContext.drawImage($,0,0,$.width,$.height);const Y=this.offscreenCanvasContext.getImageData(-H,-H,$.width+2*H,$.height+2*H);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Y}}var It=function ne($,H){var Y,ae=$&&$.type;if("FeatureCollection"===ae)for(Y=0;Y<$.features.length;Y++)ne($.features[Y],H);else if("GeometryCollection"===ae)for(Y=0;Y<$.geometries.length;Y++)ne($.geometries[Y],H);else if("Feature"===ae)ne($.geometry,H);else if("Polygon"===ae)Ve($.coordinates,H);else if("MultiPolygon"===ae)for(Y=0;Y<$.coordinates.length;Y++)Ve($.coordinates[Y],H);return $};function Ve(ne,$){if(0!==ne.length){je(ne[0],$);for(var H=1;H<ne.length;H++)je(ne[H],!$)}}function je(ne,$){for(var H=0,Y=0,ae=0,pe=ne.length,ke=pe-1;ae<pe;ke=ae++){var Be=(ne[ae][0]-ne[ke][0])*(ne[ke][1]+ne[ae][1]),Pe=H+Be;Y+=Math.abs(H)>=Math.abs(Be)?H-Pe+Be:Be-Pe+H,H=Pe}H+Y>=0!=!!$&&ne.reverse()}const Ke=_.VectorTileFeature.prototype.toGeoJSON;class pn{constructor($){this._feature=$,this.extent=_.EXTENT,this.type=$.type,this.properties=$.tags,"id"in $&&!isNaN($.id)&&(this.id=parseInt($.id,10))}loadGeometry(){if(1===this._feature.type){const $=[];for(const H of this._feature.geometry)$.push([new _.pointGeometry(H[0],H[1])]);return $}{const $=[];for(const H of this._feature.geometry){const Y=[];for(const ae of H)Y.push(new _.pointGeometry(ae[0],ae[1]));$.push(Y)}return $}}toGeoJSON($,H,Y){return Ke.call(this,$,H,Y)}}class nn{constructor($){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=_.EXTENT,this.length=$.length,this._features=$}feature($){return new pn(this._features[$])}}var bn={},An={get exports(){return bn},set exports(ne){bn=ne}},vt=_.pointGeometry,Ye=_.vectorTile.VectorTileFeature,kt=Jt;function Jt(ne,$){this.options=$||{},this.features=ne,this.length=ne.length}function Xt(ne,$){this.id="number"==typeof ne.id?ne.id:void 0,this.type=ne.type,this.rawGeometry=1===ne.type?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=$||4096}Jt.prototype.feature=function(ne){return new Xt(this.features[ne],this.options.extent)},Xt.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var $=0;$<ne.length;$++){for(var H=ne[$],Y=[],ae=0;ae<H.length;ae++)Y.push(new vt(H[ae][0],H[ae][1]));this.geometry.push(Y)}return this.geometry},Xt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,$=1/0,H=-1/0,Y=1/0,ae=-1/0,pe=0;pe<ne.length;pe++)for(var ke=ne[pe],Be=0;Be<ke.length;Be++){var Pe=ke[Be];$=Math.min($,Pe.x),H=Math.max(H,Pe.x),Y=Math.min(Y,Pe.y),ae=Math.max(ae,Pe.y)}return[$,Y,H,ae]},Xt.prototype.toGeoJSON=Ye.prototype.toGeoJSON;var xt=_.pbf,Pt=kt;function un(ne){var $=new xt;return function(H,Y){for(var ae in H.layers)Y.writeMessage(3,nt,H.layers[ae])}(ne,$),$.finish()}function nt(ne,$){var H;$.writeVarintField(15,ne.version||1),$.writeStringField(1,ne.name||""),$.writeVarintField(5,ne.extent||4096);var Y={keys:[],values:[],keycache:{},valuecache:{}};for(H=0;H<ne.length;H++)Y.feature=ne.feature(H),$.writeMessage(2,pt,Y);var ae=Y.keys;for(H=0;H<ae.length;H++)$.writeStringField(3,ae[H]);var pe=Y.values;for(H=0;H<pe.length;H++)$.writeMessage(4,On,pe[H])}function pt(ne,$){var H=ne.feature;void 0!==H.id&&$.writeVarintField(1,H.id),$.writeMessage(2,Nt,ne),$.writeVarintField(3,H.type),$.writeMessage(4,si,H)}function Nt(ne,$){var H=ne.feature,Y=ne.keys,ae=ne.values,pe=ne.keycache,ke=ne.valuecache;for(var Be in H.properties){var Pe=H.properties[Be],He=pe[Be];if(null!==Pe){void 0===He&&(Y.push(Be),pe[Be]=He=Y.length-1),$.writeVarint(He);var rt=typeof Pe;"string"!==rt&&"boolean"!==rt&&"number"!==rt&&(Pe=JSON.stringify(Pe));var $t=rt+":"+Pe,_t=ke[$t];void 0===_t&&(ae.push(Pe),ke[$t]=_t=ae.length-1),$.writeVarint(_t)}}}function zt(ne,$){return($<<3)+(7&ne)}function an(ne){return ne<<1^ne>>31}function si(ne,$){for(var H=ne.loadGeometry(),Y=ne.type,ae=0,pe=0,ke=H.length,Be=0;Be<ke;Be++){var Pe=H[Be],He=1;1===Y&&(He=Pe.length),$.writeVarint(zt(1,He));for(var rt=3===Y?Pe.length-1:Pe.length,$t=0;$t<rt;$t++){1===$t&&1!==Y&&$.writeVarint(zt(2,rt-1));var _t=Pe[$t].x-ae,En=Pe[$t].y-pe;$.writeVarint(an(_t)),$.writeVarint(an(En)),ae+=_t,pe+=En}3===Y&&$.writeVarint(zt(7,1))}}function On(ne,$){var H=typeof ne;"string"===H?$.writeStringField(1,ne):"boolean"===H?$.writeBooleanField(7,ne):"number"===H&&(ne%1!=0?$.writeDoubleField(3,ne):ne<0?$.writeSVarintField(6,ne):$.writeVarintField(5,ne))}function mt(ne,$,H,Y,ae,pe){if(ae-Y<=H)return;const ke=Y+ae>>1;gt(ne,$,ke,Y,ae,pe%2),mt(ne,$,H,Y,ke-1,pe+1),mt(ne,$,H,ke+1,ae,pe+1)}function gt(ne,$,H,Y,ae,pe){for(;ae>Y;){if(ae-Y>600){const He=ae-Y+1,rt=H-Y+1,$t=Math.log(He),_t=.5*Math.exp(2*$t/3),En=.5*Math.sqrt($t*_t*(He-_t)/He)*(rt-He/2<0?-1:1);gt(ne,$,H,Math.max(Y,Math.floor(H-rt*_t/He+En)),Math.min(ae,Math.floor(H+(He-rt)*_t/He+En)),pe)}const ke=$[2*H+pe];let Be=Y,Pe=ae;for(Dt(ne,$,Y,H),$[2*ae+pe]>ke&&Dt(ne,$,Y,ae);Be<Pe;){for(Dt(ne,$,Be,Pe),Be++,Pe--;$[2*Be+pe]<ke;)Be++;for(;$[2*Pe+pe]>ke;)Pe--}$[2*Y+pe]===ke?Dt(ne,$,Y,Pe):(Pe++,Dt(ne,$,Pe,ae)),Pe<=H&&(Y=Pe+1),H<=Pe&&(ae=Pe-1)}}function Dt(ne,$,H,Y){Ht(ne,H,Y),Ht($,2*H,2*Y),Ht($,2*H+1,2*Y+1)}function Ht(ne,$,H){const Y=ne[$];ne[$]=ne[H],ne[H]=Y}function rn(ne,$,H,Y){const ae=ne-H,pe=$-Y;return ae*ae+pe*pe}An.exports=un,bn.fromVectorTileJs=un,bn.fromGeojsonVt=function(ne,$){$=$||{};var H={};for(var Y in ne)H[Y]=new Pt(ne[Y].features,$),H[Y].name=Y,H[Y].version=$.version,H[Y].extent=$.extent;return un({layers:H})},bn.GeoJSONWrapper=Pt;const en=ne=>ne[0],wn=ne=>ne[1];class Cn{constructor($,H=en,Y=wn,ae=64,pe=Float64Array){this.nodeSize=ae,this.points=$;const ke=$.length<65536?Uint16Array:Uint32Array,Be=this.ids=new ke($.length),Pe=this.coords=new pe(2*$.length);for(let He=0;He<$.length;He++)Be[He]=He,Pe[2*He]=H($[He]),Pe[2*He+1]=Y($[He]);mt(Be,Pe,ae,0,Be.length-1,0)}range($,H,Y,ae){return function(pe,ke,Be,Pe,He,rt,$t){const _t=[0,pe.length-1,0],En=[];let Nn,Ln;for(;_t.length;){const ii=_t.pop(),Ci=_t.pop(),mi=_t.pop();if(Ci-mi<=$t){for(let fr=mi;fr<=Ci;fr++)Nn=ke[2*fr],Ln=ke[2*fr+1],Nn>=Be&&Nn<=He&&Ln>=Pe&&Ln<=rt&&En.push(pe[fr]);continue}const $n=Math.floor((mi+Ci)/2);Nn=ke[2*$n],Ln=ke[2*$n+1],Nn>=Be&&Nn<=He&&Ln>=Pe&&Ln<=rt&&En.push(pe[$n]);const hr=(ii+1)%2;(0===ii?Be<=Nn:Pe<=Ln)&&(_t.push(mi),_t.push($n-1),_t.push(hr)),(0===ii?He>=Nn:rt>=Ln)&&(_t.push($n+1),_t.push(Ci),_t.push(hr))}return En}(this.ids,this.coords,$,H,Y,ae,this.nodeSize)}within($,H,Y){return function(ae,pe,ke,Be,Pe,He){const rt=[0,ae.length-1,0],$t=[],_t=Pe*Pe;for(;rt.length;){const En=rt.pop(),Nn=rt.pop(),Ln=rt.pop();if(Nn-Ln<=He){for(let hr=Ln;hr<=Nn;hr++)rn(pe[2*hr],pe[2*hr+1],ke,Be)<=_t&&$t.push(ae[hr]);continue}const ii=Math.floor((Ln+Nn)/2),Ci=pe[2*ii],mi=pe[2*ii+1];rn(Ci,mi,ke,Be)<=_t&&$t.push(ae[ii]);const $n=(En+1)%2;(0===En?ke-Pe<=Ci:Be-Pe<=mi)&&(rt.push(Ln),rt.push(ii-1),rt.push($n)),(0===En?ke+Pe>=Ci:Be+Pe>=mi)&&(rt.push(ii+1),rt.push(Nn),rt.push($n))}return $t}(this.ids,this.coords,$,H,Y,this.nodeSize)}}const ir={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ne=>ne},qn=Math.fround||(Bn=new Float32Array(1),ne=>(Bn[0]=+ne,Bn[0]));var Bn;class vn{constructor($){this.options=co(Object.create(ir),$),this.trees=new Array(this.options.maxZoom+1)}load($){const{log:H,minZoom:Y,maxZoom:ae,nodeSize:pe}=this.options;H&&console.time("total time");const ke=`prepare ${$.length} points`;H&&console.time(ke),this.points=$;let Be=[];for(let Pe=0;Pe<$.length;Pe++)$[Pe].geometry&&Be.push(Ai($[Pe],Pe));this.trees[ae+1]=new Cn(Be,Ss,gs,pe,Float32Array),H&&console.timeEnd(ke);for(let Pe=ae;Pe>=Y;Pe--){const He=+Date.now();Be=this._cluster(Be,Pe),this.trees[Pe]=new Cn(Be,Ss,gs,pe,Float32Array),H&&console.log("z%d: %d clusters in %dms",Pe,Be.length,+Date.now()-He)}return H&&console.timeEnd("total time"),this}getClusters($,H){let Y=(($[0]+180)%360+360)%360-180;const ae=Math.max(-90,Math.min(90,$[1]));let pe=180===$[2]?180:(($[2]+180)%360+360)%360-180;const ke=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)Y=-180,pe=180;else if(Y>pe){const rt=this.getClusters([Y,ae,180,ke],H),$t=this.getClusters([-180,ae,pe,ke],H);return rt.concat($t)}const Be=this.trees[this._limitZoom(H)],Pe=Be.range(kr(Y),lo(ke),kr(pe),lo(ae)),He=[];for(const rt of Pe){const $t=Be.points[rt];He.push($t.numPoints?dr($t):this.points[$t.index])}return He}getChildren($){const H=this._getOriginId($),Y=this._getOriginZoom($),ae="No cluster with the specified id.",pe=this.trees[Y];if(!pe)throw new Error(ae);const ke=pe.points[H];if(!ke)throw new Error(ae);const Be=this.options.radius/(this.options.extent*Math.pow(2,Y-1)),Pe=pe.within(ke.x,ke.y,Be),He=[];for(const rt of Pe){const $t=pe.points[rt];$t.parentId===$&&He.push($t.numPoints?dr($t):this.points[$t.index])}if(0===He.length)throw new Error(ae);return He}getLeaves($,H,Y){const ae=[];return this._appendLeaves(ae,$,H=H||10,Y=Y||0,0),ae}getTile($,H,Y){const ae=this.trees[this._limitZoom($)],pe=Math.pow(2,$),{extent:ke,radius:Be}=this.options,Pe=Be/ke,He=(Y-Pe)/pe,rt=(Y+1+Pe)/pe,$t={features:[]};return this._addTileFeatures(ae.range((H-Pe)/pe,He,(H+1+Pe)/pe,rt),ae.points,H,Y,pe,$t),0===H&&this._addTileFeatures(ae.range(1-Pe/pe,He,1,rt),ae.points,pe,Y,pe,$t),H===pe-1&&this._addTileFeatures(ae.range(0,He,Pe/pe,rt),ae.points,-1,Y,pe,$t),$t.features.length?$t:null}getClusterExpansionZoom($){let H=this._getOriginZoom($)-1;for(;H<=this.options.maxZoom;){const Y=this.getChildren($);if(H++,1!==Y.length)break;$=Y[0].properties.cluster_id}return H}_appendLeaves($,H,Y,ae,pe){const ke=this.getChildren(H);for(const Be of ke){const Pe=Be.properties;if(Pe&&Pe.cluster?pe+Pe.point_count<=ae?pe+=Pe.point_count:pe=this._appendLeaves($,Pe.cluster_id,Y,ae,pe):pe<ae?pe++:$.push(Be),$.length===Y)break}return pe}_addTileFeatures($,H,Y,ae,pe,ke){for(const Be of $){const Pe=H[Be],He=Pe.numPoints;let rt,$t,_t;if(He)rt=Un(Pe),$t=Pe.x,_t=Pe.y;else{const Ln=this.points[Pe.index];rt=Ln.properties,$t=kr(Ln.geometry.coordinates[0]),_t=lo(Ln.geometry.coordinates[1])}const En={type:1,geometry:[[Math.round(this.options.extent*($t*pe-Y)),Math.round(this.options.extent*(_t*pe-ae))]],tags:rt};let Nn;He?Nn=Pe.id:this.options.generateId?Nn=Pe.index:this.points[Pe.index].id&&(Nn=this.points[Pe.index].id),void 0!==Nn&&(En.id=Nn),ke.features.push(En)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,H){const Y=[],{radius:ae,extent:pe,reduce:ke,minPoints:Be}=this.options,Pe=ae/(pe*Math.pow(2,H));for(let He=0;He<$.length;He++){const rt=$[He];if(rt.zoom<=H)continue;rt.zoom=H;const $t=this.trees[H+1],_t=$t.within(rt.x,rt.y,Pe),En=rt.numPoints||1;let Nn=En;for(const Ln of _t){const ii=$t.points[Ln];ii.zoom>H&&(Nn+=ii.numPoints||1)}if(Nn>En&&Nn>=Be){let Ln=rt.x*En,ii=rt.y*En,Ci=ke&&En>1?this._map(rt,!0):null;const mi=(He<<5)+(H+1)+this.points.length;for(const $n of _t){const hr=$t.points[$n];if(hr.zoom<=H)continue;hr.zoom=H;const fr=hr.numPoints||1;Ln+=hr.x*fr,ii+=hr.y*fr,hr.parentId=mi,ke&&(Ci||(Ci=this._map(rt,!0)),ke(Ci,this._map(hr)))}rt.parentId=mi,Y.push(Xi(Ln/Nn,ii/Nn,mi,Nn,Ci))}else if(Y.push(rt),Nn>1)for(const Ln of _t){const ii=$t.points[Ln];ii.zoom<=H||(ii.zoom=H,Y.push(ii))}}return Y}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,H){if($.numPoints)return H?co({},$.properties):$.properties;const Y=this.points[$.index].properties,ae=this.options.map(Y);return H&&ae===Y?co({},ae):ae}}function Xi(ne,$,H,Y,ae){return{x:qn(ne),y:qn($),zoom:1/0,id:H,parentId:-1,numPoints:Y,properties:ae}}function Ai(ne,$){const[H,Y]=ne.geometry.coordinates;return{x:qn(kr(H)),y:qn(lo(Y)),zoom:1/0,index:$,parentId:-1}}function dr(ne){return{type:"Feature",id:ne.id,properties:Un(ne),geometry:{type:"Point",coordinates:[($=ne.x,360*($-.5)),Is(ne.y)]}};var $}function Un(ne){const $=ne.numPoints,H=$>=1e4?`${Math.round($/1e3)}k`:$>=1e3?Math.round($/100)/10+"k":$;return co(co({},ne.properties),{cluster:!0,cluster_id:ne.id,point_count:$,point_count_abbreviated:H})}function kr(ne){return ne/360+.5}function lo(ne){const $=Math.sin(ne*Math.PI/180),H=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return H<0?0:H>1?1:H}function Is(ne){const $=(180-360*ne)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function co(ne,$){for(const H in $)ne[H]=$[H];return ne}function Ss(ne){return ne.x}function gs(ne){return ne.y}function Sr(ne,$,H,Y){for(var ae,pe=Y,ke=H-$>>1,Be=H-$,Pe=ne[$],He=ne[$+1],rt=ne[H],$t=ne[H+1],_t=$+3;_t<H;_t+=3){var En=$r(ne[_t],ne[_t+1],Pe,He,rt,$t);if(En>pe)ae=_t,pe=En;else if(En===pe){var Nn=Math.abs(_t-ke);Nn<Be&&(ae=_t,Be=Nn)}}pe>Y&&(ae-$>3&&Sr(ne,$,ae,Y),ne[ae+2]=pe,H-ae>3&&Sr(ne,ae,H,Y))}function $r(ne,$,H,Y,ae,pe){var ke=ae-H,Be=pe-Y;if(0!==ke||0!==Be){var Pe=((ne-H)*ke+($-Y)*Be)/(ke*ke+Be*Be);Pe>1?(H=ae,Y=pe):Pe>0&&(H+=ke*Pe,Y+=Be*Pe)}return(ke=ne-H)*ke+(Be=$-Y)*Be}function In(ne,$,H,Y){var ae={id:void 0===ne?null:ne,type:$,geometry:H,tags:Y,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(pe){var ke=pe.geometry,Be=pe.type;if("Point"===Be||"MultiPoint"===Be||"LineString"===Be)Uo(pe,ke);else if("Polygon"===Be||"MultiLineString"===Be)for(var Pe=0;Pe<ke.length;Pe++)Uo(pe,ke[Pe]);else if("MultiPolygon"===Be)for(Pe=0;Pe<ke.length;Pe++)for(var He=0;He<ke[Pe].length;He++)Uo(pe,ke[Pe][He])}(ae),ae}function Uo(ne,$){for(var H=0;H<$.length;H+=3)ne.minX=Math.min(ne.minX,$[H]),ne.minY=Math.min(ne.minY,$[H+1]),ne.maxX=Math.max(ne.maxX,$[H]),ne.maxY=Math.max(ne.maxY,$[H+1])}function ss(ne,$,H,Y){if($.geometry){var ae=$.geometry.coordinates,pe=$.geometry.type,ke=Math.pow(H.tolerance/((1<<H.maxZoom)*H.extent),2),Be=[],Pe=$.id;if(H.promoteId?Pe=$.properties[H.promoteId]:H.generateId&&(Pe=Y||0),"Point"===pe)wo(ae,Be);else if("MultiPoint"===pe)for(var He=0;He<ae.length;He++)wo(ae[He],Be);else if("LineString"===pe)Gr(ae,Be,ke,!1);else if("MultiLineString"===pe){if(H.lineMetrics){for(He=0;He<ae.length;He++)Gr(ae[He],Be=[],ke,!1),ne.push(In(Pe,"LineString",Be,$.properties));return}as(ae,Be,ke,!1)}else if("Polygon"===pe)as(ae,Be,ke,!0);else{if("MultiPolygon"!==pe){if("GeometryCollection"===pe){for(He=0;He<$.geometry.geometries.length;He++)ss(ne,{id:Pe,geometry:$.geometry.geometries[He],properties:$.properties},H,Y);return}throw new Error("Input data is not a valid GeoJSON object.")}for(He=0;He<ae.length;He++){var rt=[];as(ae[He],rt,ke,!0),Be.push(rt)}}ne.push(In(Pe,pe,Be,$.properties))}}function wo(ne,$){$.push(hi(ne[0])),$.push(jn(ne[1])),$.push(0)}function Gr(ne,$,H,Y){for(var ae,pe,ke=0,Be=0;Be<ne.length;Be++){var Pe=hi(ne[Be][0]),He=jn(ne[Be][1]);$.push(Pe),$.push(He),$.push(0),Be>0&&(ke+=Y?(ae*He-Pe*pe)/2:Math.sqrt(Math.pow(Pe-ae,2)+Math.pow(He-pe,2))),ae=Pe,pe=He}var rt=$.length-3;$[2]=1,Sr($,0,rt,H),$[rt+2]=1,$.size=Math.abs(ke),$.start=0,$.end=$.size}function as(ne,$,H,Y){for(var ae=0;ae<ne.length;ae++){var pe=[];Gr(ne[ae],pe,H,Y),$.push(pe)}}function hi(ne){return ne/360+.5}function jn(ne){var $=Math.sin(ne*Math.PI/180),H=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return H<0?0:H>1?1:H}function Xn(ne,$,H,Y,ae,pe,ke,Be){if(Y/=$,pe>=(H/=$)&&ke<Y)return ne;if(ke<H||pe>=Y)return null;for(var Pe=[],He=0;He<ne.length;He++){var rt=ne[He],$t=rt.geometry,_t=rt.type,En=0===ae?rt.minX:rt.minY,Nn=0===ae?rt.maxX:rt.maxY;if(En>=H&&Nn<Y)Pe.push(rt);else if(!(Nn<H||En>=Y)){var Ln=[];if("Point"===_t||"MultiPoint"===_t)zr($t,Ln,H,Y,ae);else if("LineString"===_t)Mr($t,Ln,H,Y,ae,!1,Be.lineMetrics);else if("MultiLineString"===_t)Oo($t,Ln,H,Y,ae,!1);else if("Polygon"===_t)Oo($t,Ln,H,Y,ae,!0);else if("MultiPolygon"===_t)for(var ii=0;ii<$t.length;ii++){var Ci=[];Oo($t[ii],Ci,H,Y,ae,!0),Ci.length&&Ln.push(Ci)}if(Ln.length){if(Be.lineMetrics&&"LineString"===_t){for(ii=0;ii<Ln.length;ii++)Pe.push(In(rt.id,_t,Ln[ii],rt.tags));continue}"LineString"!==_t&&"MultiLineString"!==_t||(1===Ln.length?(_t="LineString",Ln=Ln[0]):_t="MultiLineString"),"Point"!==_t&&"MultiPoint"!==_t||(_t=3===Ln.length?"Point":"MultiPoint"),Pe.push(In(rt.id,_t,Ln,rt.tags))}}}return Pe.length?Pe:null}function zr(ne,$,H,Y,ae){for(var pe=0;pe<ne.length;pe+=3){var ke=ne[pe+ae];ke>=H&&ke<=Y&&($.push(ne[pe]),$.push(ne[pe+1]),$.push(ne[pe+2]))}}function Mr(ne,$,H,Y,ae,pe,ke){for(var Be,Pe,He=Jr(ne),rt=0===ae?_s:wi,$t=ne.start,_t=0;_t<ne.length-3;_t+=3){var En=ne[_t],Nn=ne[_t+1],Ln=ne[_t+2],ii=ne[_t+3],Ci=ne[_t+4],mi=0===ae?En:Nn,$n=0===ae?ii:Ci,hr=!1;ke&&(Be=Math.sqrt(Math.pow(En-ii,2)+Math.pow(Nn-Ci,2))),mi<H?$n>H&&(Pe=rt(He,En,Nn,ii,Ci,H),ke&&(He.start=$t+Be*Pe)):mi>Y?$n<Y&&(Pe=rt(He,En,Nn,ii,Ci,Y),ke&&(He.start=$t+Be*Pe)):uo(He,En,Nn,Ln),$n<H&&mi>=H&&(Pe=rt(He,En,Nn,ii,Ci,H),hr=!0),$n>Y&&mi<=Y&&(Pe=rt(He,En,Nn,ii,Ci,Y),hr=!0),!pe&&hr&&(ke&&(He.end=$t+Be*Pe),$.push(He),He=Jr(ne)),ke&&($t+=Be)}var fr=ne.length-3;En=ne[fr],Nn=ne[fr+1],Ln=ne[fr+2],(mi=0===ae?En:Nn)>=H&&mi<=Y&&uo(He,En,Nn,Ln),fr=He.length-3,pe&&fr>=3&&(He[fr]!==He[0]||He[fr+1]!==He[1])&&uo(He,He[0],He[1],He[2]),He.length&&$.push(He)}function Jr(ne){var $=[];return $.size=ne.size,$.start=ne.start,$.end=ne.end,$}function Oo(ne,$,H,Y,ae,pe){for(var ke=0;ke<ne.length;ke++)Mr(ne[ke],$,H,Y,ae,pe,!1)}function uo(ne,$,H,Y){ne.push($),ne.push(H),ne.push(Y)}function _s(ne,$,H,Y,ae,pe){var ke=(pe-$)/(Y-$);return ne.push(pe),ne.push(H+(ae-H)*ke),ne.push(1),ke}function wi(ne,$,H,Y,ae,pe){var ke=(pe-H)/(ae-H);return ne.push($+(Y-$)*ke),ne.push(pe),ne.push(1),ke}function Bs(ne,$){for(var H=[],Y=0;Y<ne.length;Y++){var ae,pe=ne[Y],ke=pe.type;if("Point"===ke||"MultiPoint"===ke||"LineString"===ke)ae=Ei(pe.geometry,$);else if("MultiLineString"===ke||"Polygon"===ke){ae=[];for(var Be=0;Be<pe.geometry.length;Be++)ae.push(Ei(pe.geometry[Be],$))}else if("MultiPolygon"===ke)for(ae=[],Be=0;Be<pe.geometry.length;Be++){for(var Pe=[],He=0;He<pe.geometry[Be].length;He++)Pe.push(Ei(pe.geometry[Be][He],$));ae.push(Pe)}H.push(In(pe.id,ke,ae,pe.tags))}return H}function Ei(ne,$){var H=[];H.size=ne.size,void 0!==ne.start&&(H.start=ne.start,H.end=ne.end);for(var Y=0;Y<ne.length;Y+=3)H.push(ne[Y]+$,ne[Y+1],ne[Y+2]);return H}function ho(ne,$){if(ne.transformed)return ne;var H,Y,ae,pe=1<<ne.z,ke=ne.x,Be=ne.y;for(H=0;H<ne.features.length;H++){var Pe=ne.features[H],He=Pe.geometry,rt=Pe.type;if(Pe.geometry=[],1===rt)for(Y=0;Y<He.length;Y+=2)Pe.geometry.push(qr(He[Y],He[Y+1],$,pe,ke,Be));else for(Y=0;Y<He.length;Y++){var $t=[];for(ae=0;ae<He[Y].length;ae+=2)$t.push(qr(He[Y][ae],He[Y][ae+1],$,pe,ke,Be));Pe.geometry.push($t)}}return ne.transformed=!0,ne}function qr(ne,$,H,Y,ae,pe){return[Math.round(H*(ne*Y-ae)),Math.round(H*($*Y-pe))]}function cn(ne,$,H,Y,ae){for(var pe=$===ae.maxZoom?0:ae.tolerance/((1<<$)*ae.extent),ke={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:H,y:Y,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Be=0;Be<ne.length;Be++){ke.numFeatures++,Bt(ke,ne[Be],pe,ae);var Pe=ne[Be].minX,He=ne[Be].minY,rt=ne[Be].maxX,$t=ne[Be].maxY;Pe<ke.minX&&(ke.minX=Pe),He<ke.minY&&(ke.minY=He),rt>ke.maxX&&(ke.maxX=rt),$t>ke.maxY&&(ke.maxY=$t)}return ke}function Bt(ne,$,H,Y){var ae=$.geometry,pe=$.type,ke=[];if("Point"===pe||"MultiPoint"===pe)for(var Be=0;Be<ae.length;Be+=3)ke.push(ae[Be]),ke.push(ae[Be+1]),ne.numPoints++,ne.numSimplified++;else if("LineString"===pe)Sn(ke,ae,ne,H,!1,!1);else if("MultiLineString"===pe||"Polygon"===pe)for(Be=0;Be<ae.length;Be++)Sn(ke,ae[Be],ne,H,"Polygon"===pe,0===Be);else if("MultiPolygon"===pe)for(var Pe=0;Pe<ae.length;Pe++){var He=ae[Pe];for(Be=0;Be<He.length;Be++)Sn(ke,He[Be],ne,H,!0,0===Be)}if(ke.length){var rt=$.tags||null;if("LineString"===pe&&Y.lineMetrics){for(var $t in rt={},$.tags)rt[$t]=$.tags[$t];rt.mapbox_clip_start=ae.start/ae.size,rt.mapbox_clip_end=ae.end/ae.size}var _t={geometry:ke,type:"Polygon"===pe||"MultiPolygon"===pe?3:"LineString"===pe||"MultiLineString"===pe?2:1,tags:rt};null!==$.id&&(_t.id=$.id),ne.features.push(_t)}}function Sn(ne,$,H,Y,ae,pe){var ke=Y*Y;if(Y>0&&$.size<(ae?ke:Y))H.numPoints+=$.length/3;else{for(var Be=[],Pe=0;Pe<$.length;Pe+=3)(0===Y||$[Pe+2]>ke)&&(H.numSimplified++,Be.push($[Pe]),Be.push($[Pe+1])),H.numPoints++;ae&&function(He,rt){for(var $t=0,_t=0,En=He.length,Nn=En-2;_t<En;Nn=_t,_t+=2)$t+=(He[_t]-He[Nn])*(He[_t+1]+He[Nn+1]);if($t>0===rt)for(_t=0,En=He.length;_t<En/2;_t+=2){var Ln=He[_t],ii=He[_t+1];He[_t]=He[En-2-_t],He[_t+1]=He[En-1-_t],He[En-2-_t]=Ln,He[En-1-_t]=ii}}(Be,pe),ne.push(Be)}}function Zn(ne,$){var H=($=this.options=function(ae,pe){for(var ke in pe)ae[ke]=pe[ke];return ae}(Object.create(this.options),$)).debug;if(H&&console.time("preprocess data"),$.maxZoom<0||$.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if($.promoteId&&$.generateId)throw new Error("promoteId and generateId cannot be used together.");var ae,pe,ke,Be,Pe,He,Y=function(ae,pe){var ke=[];if("FeatureCollection"===ae.type)for(var Be=0;Be<ae.features.length;Be++)ss(ke,ae.features[Be],pe,Be);else ss(ke,"Feature"===ae.type?ae:{geometry:ae},pe);return ke}(ne,$);this.tiles={},this.tileCoords=[],H&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",$.indexMaxZoom,$.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Be=ae=Y,Pe=Xn(ae,1,-1-(ke=(pe=$).buffer/pe.extent),ke,0,-1,2,pe),He=Xn(ae,1,1-ke,2+ke,0,-1,2,pe),(Pe||He)&&(Be=Xn(ae,1,-ke,1+ke,0,-1,2,pe)||[],Pe&&(Be=Bs(Pe,1).concat(Be)),He&&(Be=Be.concat(Bs(He,-1)))),(Y=Be).length&&this.splitTile(Y,0,0,0),H&&(Y.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ti(ne,$,H){return 32*((1<<ne)*H+$)+ne}function Oi(ne,$){const H=ne.tileID.canonical;if(!this._geoJSONIndex)return $(null,null);const Y=this._geoJSONIndex.getTile(H.z,H.x,H.y);if(!Y)return $(null,null);const ae=new nn(Y.features);let pe=bn(ae);0===pe.byteOffset&&pe.byteLength===pe.buffer.byteLength||(pe=new Uint8Array(pe)),$(null,{vectorTile:ae,rawData:pe.buffer})}Zn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Zn.prototype.splitTile=function(ne,$,H,Y,ae,pe,ke){for(var Be=[ne,$,H,Y],Pe=this.options,He=Pe.debug;Be.length;){Y=Be.pop(),H=Be.pop(),$=Be.pop(),ne=Be.pop();var rt=1<<$,$t=ti($,H,Y),_t=this.tiles[$t];if(!_t&&(He>1&&console.time("creation"),_t=this.tiles[$t]=cn(ne,$,H,Y,Pe),this.tileCoords.push({z:$,x:H,y:Y}),He)){He>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",$,H,Y,_t.numFeatures,_t.numPoints,_t.numSimplified),console.timeEnd("creation"));var En="z"+$;this.stats[En]=(this.stats[En]||0)+1,this.total++}if(_t.source=ne,ae){if($===Pe.maxZoom||$===ae)continue;var Nn=1<<ae-$;if(H!==Math.floor(pe/Nn)||Y!==Math.floor(ke/Nn))continue}else if($===Pe.indexMaxZoom||_t.numPoints<=Pe.indexMaxPoints)continue;if(_t.source=null,0!==ne.length){He>1&&console.time("clipping");var Ln,ii,Ci,mi,$n,hr,fr=.5*Pe.buffer/Pe.extent,Zi=.5-fr,Rr=.5+fr,dt=1+fr;Ln=ii=Ci=mi=null,$n=Xn(ne,rt,H-fr,H+Rr,0,_t.minX,_t.maxX,Pe),hr=Xn(ne,rt,H+Zi,H+dt,0,_t.minX,_t.maxX,Pe),ne=null,$n&&(Ln=Xn($n,rt,Y-fr,Y+Rr,1,_t.minY,_t.maxY,Pe),ii=Xn($n,rt,Y+Zi,Y+dt,1,_t.minY,_t.maxY,Pe),$n=null),hr&&(Ci=Xn(hr,rt,Y-fr,Y+Rr,1,_t.minY,_t.maxY,Pe),mi=Xn(hr,rt,Y+Zi,Y+dt,1,_t.minY,_t.maxY,Pe),hr=null),He>1&&console.timeEnd("clipping"),Be.push(Ln||[],$+1,2*H,2*Y),Be.push(ii||[],$+1,2*H,2*Y+1),Be.push(Ci||[],$+1,2*H+1,2*Y),Be.push(mi||[],$+1,2*H+1,2*Y+1)}}},Zn.prototype.getTile=function(ne,$,H){var Y=this.options,ae=Y.extent,pe=Y.debug;if(ne<0||ne>24)return null;var ke=1<<ne,Be=ti(ne,$=($%ke+ke)%ke,H);if(this.tiles[Be])return ho(this.tiles[Be],ae);pe>1&&console.log("drilling down to z%d-%d-%d",ne,$,H);for(var Pe,He=ne,rt=$,$t=H;!Pe&&He>0;)He--,rt=Math.floor(rt/2),$t=Math.floor($t/2),Pe=this.tiles[ti(He,rt,$t)];return Pe&&Pe.source?(pe>1&&console.log("found parent tile z%d-%d-%d",He,rt,$t),pe>1&&console.time("drilling down"),this.splitTile(Pe.source,He,rt,$t,ne,$,H),pe>1&&console.timeEnd("drilling down"),this.tiles[Be]?ho(this.tiles[Be],ae):null):null};class eo extends _.VectorTileWorkerSource{constructor($,H,Y,ae,pe){super($,H,Y,ae,Oi),pe&&(this.loadGeoJSON=pe)}loadData($,H){const Y=$&&$.request,ae=Y&&Y.collectResourceTiming;this.loadGeoJSON($,(pe,ke)=>{if(pe||!ke)return H(pe);if("object"!=typeof ke)return H(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));{It(ke,!0);try{if($.filter){const Pe=_.createExpression($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Pe.result)throw new Error(Pe.value.map(rt=>`${rt.key}: ${rt.message}`).join(", "));ke={type:"FeatureCollection",features:ke.features.filter(rt=>Pe.value.evaluate({zoom:0},rt))}}this._geoJSONIndex=$.cluster?new vn(function({superclusterOptions:Pe,clusterProperties:He}){if(!He||!Pe)return Pe;const rt={},$t={},_t={accumulated:null,zoom:0},En={properties:null},Nn=Object.keys(He);for(const Ln of Nn){const[ii,Ci]=He[Ln],mi=_.createExpression(Ci),$n=_.createExpression("string"==typeof ii?[ii,["accumulated"],["get",Ln]]:ii);rt[Ln]=mi.value,$t[Ln]=$n.value}return Pe.map=Ln=>{En.properties=Ln;const ii={};for(const Ci of Nn)ii[Ci]=rt[Ci].evaluate(_t,En);return ii},Pe.reduce=(Ln,ii)=>{En.properties=ii;for(const Ci of Nn)_t.accumulated=Ln[Ci],Ln[Ci]=$t[Ci].evaluate(_t,En)},Pe}($)).load(ke.features):new Zn(Pe=ke,$.geojsonVtOptions)}catch(Pe){return H(Pe)}this.loaded={};const Be={};if(ae){const Pe=_.getPerformanceMeasurement(Y);Pe&&(Be.resourceTiming={},Be.resourceTiming[$.source]=JSON.parse(JSON.stringify(Pe)))}H(null,Be)}var Pe})}reloadTile($,H){const Y=this.loaded;return Y&&Y[$.uid]?super.reloadTile($,H):this.loadTile($,H)}loadGeoJSON($,H){if($.request)_.getJSON($.request,H);else{if("string"!=typeof $.data)return H(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`));try{return H(null,JSON.parse($.data))}catch{return H(new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom($,H){try{H(null,this._geoJSONIndex.getClusterExpansionZoom($.clusterId))}catch(Y){H(Y)}}getClusterChildren($,H){try{H(null,this._geoJSONIndex.getChildren($.clusterId))}catch(Y){H(Y)}}getClusterLeaves($,H){try{H(null,this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset))}catch(Y){H(Y)}}}class ze{constructor($){this.self=$,this.actor=new _.Actor($,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=_.getProjection({name:"mercator"}),this.workerSourceTypes={vector:_.VectorTileWorkerSource,geojson:eo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(H,Y)=>{if(this.workerSourceTypes[H])throw new Error(`Worker source with name "${H}" already registered.`);this.workerSourceTypes[H]=Y},this.self.registerRTLTextPlugin=H=>{if(_.plugin.isParsed())throw new Error("RTL text plugin already registered.");_.plugin.applyArabicShaping=H.applyArabicShaping,_.plugin.processBidirectionalText=H.processBidirectionalText,_.plugin.processStyledBidirectionalText=H.processStyledBidirectionalText}}clearCaches($,H,Y){delete this.layerIndexes[$],delete this.availableImages[$],delete this.workerSources[$],delete this.demWorkerSources[$],Y()}checkIfReady($,H,Y){Y()}setReferrer($,H){this.referrer=H}spriteLoaded($,H){this.isSpriteLoaded[$]=H;for(const Y in this.workerSources[$]){const ae=this.workerSources[$][Y];for(const pe in ae)ae[pe]instanceof _.VectorTileWorkerSource&&(ae[pe].isSpriteLoaded=H,ae[pe].fire(new _.Event("isSpriteLoaded")))}}setImages($,H,Y){this.availableImages[$]=H;for(const ae in this.workerSources[$]){const pe=this.workerSources[$][ae];for(const ke in pe)pe[ke].availableImages=H}Y()}enableTerrain($,H,Y){this.terrain=H,Y()}setProjection($,H){this.projections[$]=_.getProjection(H)}setLayers($,H,Y){this.getLayerIndex($).replace(H),Y()}updateLayers($,H,Y){this.getLayerIndex($).update(H.layers,H.removedIds),Y()}loadTile($,H,Y){const ae=this.enableTerrain?_.extend({enableTerrain:this.terrain},H):H;ae.projection=this.projections[$]||this.defaultProjection,this.getWorkerSource($,H.type,H.source).loadTile(ae,Y)}loadDEMTile($,H,Y){const ae=this.enableTerrain?_.extend({buildQuadTree:this.terrain},H):H;this.getDEMWorkerSource($,H.source).loadTile(ae,Y)}reloadTile($,H,Y){const ae=this.enableTerrain?_.extend({enableTerrain:this.terrain},H):H;ae.projection=this.projections[$]||this.defaultProjection,this.getWorkerSource($,H.type,H.source).reloadTile(ae,Y)}abortTile($,H,Y){this.getWorkerSource($,H.type,H.source).abortTile(H,Y)}removeTile($,H,Y){this.getWorkerSource($,H.type,H.source).removeTile(H,Y)}removeSource($,H,Y){if(!this.workerSources[$]||!this.workerSources[$][H.type]||!this.workerSources[$][H.type][H.source])return;const ae=this.workerSources[$][H.type][H.source];delete this.workerSources[$][H.type][H.source],void 0!==ae.removeSource?ae.removeSource(H,Y):Y()}loadWorkerSource($,H,Y){try{this.self.importScripts(H.url),Y()}catch(ae){Y(ae.toString())}}syncRTLPluginState($,H,Y){try{_.plugin.setState(H);const ae=_.plugin.getPluginURL();if(_.plugin.isLoaded()&&!_.plugin.isParsed()&&null!=ae){this.self.importScripts(ae);const pe=_.plugin.isParsed();Y(pe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ae}`),pe)}}catch(ae){Y(ae.toString())}}getAvailableImages($){let H=this.availableImages[$];return H||(H=[]),H}getLayerIndex($){let H=this.layerIndexes[$];return H||(H=this.layerIndexes[$]=new on),H}getWorkerSource($,H,Y){return this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][H]||(this.workerSources[$][H]={}),this.workerSources[$][H][Y]||(this.workerSources[$][H][Y]=new this.workerSourceTypes[H]({send:(pe,ke,Be,Pe,He,rt)=>{this.actor.send(pe,ke,Be,$,He,rt)},scheduler:this.actor.scheduler},this.getLayerIndex($),this.getAvailableImages($),this.isSpriteLoaded[$])),this.workerSources[$][H][Y]}getDEMWorkerSource($,H){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][H]||(this.demWorkerSources[$][H]=new yt),this.demWorkerSources[$][H]}enforceCacheSizeLimit($,H){_.enforceCacheSizeLimit(H)}getWorkerPerformanceMetrics($,H,Y){Y(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new ze(self)),ze}),Ne(0,function(_){function $e(v,c){if(Array.isArray(v)){if(!Array.isArray(c)||v.length!==c.length)return!1;for(let g=0;g<v.length;g++)if(!$e(v[g],c[g]))return!1;return!0}if("object"==typeof v&&null!==v&&null!==c){if("object"!=typeof c||Object.keys(v).length!==Object.keys(c).length)return!1;for(const g in v)if(!$e(v[g],c[g]))return!1;return!0}return v===c}var ft=on;function on(v){return c=v,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var C,S,D=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(D);try{S=new Worker(L),C=!0}catch{C=!1}return S&&S.terminate(),URL.revokeObjectURL(L),C}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var C=document.createElement("canvas");C.width=C.height=1;var S=C.getContext("2d");if(!S)return!1;var D=S.getImageData(0,0,1,1);return D&&D.width===C.width}()||(void 0===yt[g=c&&c.failIfMajorPerformanceCaveat]&&(yt[g]=function(C){var S,L,z,G,D=(L=C,z=document.createElement("canvas"),(G=Object.create(on.webGLContextAttributes)).failIfMajorPerformanceCaveat=L,z.getContext("webgl",G)||z.getContext("experimental-webgl",G));if(!D)return!1;try{S=D.createShader(D.VERTEX_SHADER)}catch{return!1}return!(!S||D.isContextLost())&&(D.shaderSource(S,"void main() {}"),D.compileShader(S),!0===D.getShaderParameter(S,D.COMPILE_STATUS))}(g)),!yt[g]||document.documentMode));var c,g}var yt={};function It(v,c,g){const C=_.window.document.createElement(v);return void 0!==c&&(C.className=c),g&&g.appendChild(C),C}function Ve(v,c,g){const C=_.window.document.createElementNS("http://www.w3.org/2000/svg",v);for(const S of Object.keys(c))C.setAttributeNS(null,S,c[S]);return g&&g.appendChild(C),C}on.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const je=_.window.document&&_.window.document.documentElement.style,Ke=je&&void 0!==je.userSelect?"userSelect":"WebkitUserSelect";let pn;function nn(){je&&Ke&&(pn=je[Ke],je[Ke]="none")}function bn(){je&&Ke&&(je[Ke]=pn)}function An(v){v.preventDefault(),v.stopPropagation(),_.window.removeEventListener("click",An,!0)}function vt(){_.window.addEventListener("click",An,!0),_.window.setTimeout(()=>{_.window.removeEventListener("click",An,!0)},0)}function Ye(v,c){const g=v.getBoundingClientRect();return Xt(v,g,c)}function kt(v,c){const g=v.getBoundingClientRect(),C=[];for(let S=0;S<c.length;S++)C.push(Xt(v,g,c[S]));return C}function Jt(v){return void 0!==_.window.InstallTrigger&&2===v.button&&v.ctrlKey&&_.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:v.button}function Xt(v,c,g){const C=v.offsetWidth===c.width?1:v.offsetWidth/c.width;return new _.pointGeometry((g.clientX-c.left)*C,(g.clientY-c.top)*C)}function xt(v,c){var g=c[0],C=c[1],S=c[2],D=c[3],L=g*D-S*C;return L?(v[0]=D*(L=1/L),v[1]=-C*L,v[2]=-S*L,v[3]=g*L,v):null}function Pt(v){const{userImage:c}=v;return!!(c&&c.render&&c.render())&&(v.data.replace(new Uint8Array(c.data.buffer)),!0)}class un extends _.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new _.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:g,callback:C}of this.requestors)this._notify(g,C);this.requestors=[]}}hasImage(c){return!!this.getImage(c)}getImage(c){return this.images[c]}addImage(c,g){this._validate(c,g)&&(this.images[c]=g)}_validate(c,g){let C=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new _.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),C=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new _.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),C=!1),this._validateContent(g.content,g)||(this.fire(new _.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),C=!1),C}_validateStretch(c,g){if(!c)return!0;let C=0;for(const S of c){if(S[0]<C||S[1]<S[0]||g<S[1])return!1;C=S[1]}return!0}_validateContent(c,g){return!(c&&(4!==c.length||c[0]<0||g.data.width<c[0]||c[1]<0||g.data.height<c[1]||c[2]<0||g.data.width<c[2]||c[3]<0||g.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,g){g.version=this.images[c].version+1,this.images[c]=g,this.updatedImages[c]=!0}removeImage(c){const g=this.images[c];delete this.images[c],delete this.patterns[c],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,g){let C=!0;if(!this.isLoaded())for(const S of c)this.images[S]||(C=!1);this.isLoaded()||C?this._notify(c,g):this.requestors.push({ids:c,callback:g})}_notify(c,g){const C={};for(const S of c){this.images[S]||this.fire(new _.Event("styleimagemissing",{id:S}));const D=this.images[S];D?C[S]={data:D.data.clone(),pixelRatio:D.pixelRatio,sdf:D.sdf,version:D.version,stretchX:D.stretchX,stretchY:D.stretchY,content:D.content,hasRenderCallback:Boolean(D.userImage&&D.userImage.render)}:_.warnOnce(`Image "${S}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}g(null,C)}getPixelSize(){const{width:c,height:g}=this.atlasImage;return{width:c,height:g}}getPattern(c){const g=this.patterns[c],C=this.getImage(c);if(!C)return null;if(g&&g.position.version===C.version)return g.position;if(g)g.position.version=C.version;else{const S={w:C.data.width+2,h:C.data.height+2,x:0,y:0},D=new _.ImagePosition(S,C);this.patterns[c]={bin:S,position:D}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const g=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new _.Texture(c,this.atlasImage,g.RGBA),this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const D in this.patterns)c.push(this.patterns[D].bin);const{w:g,h:C}=_.potpack(c),S=this.atlasImage;S.resize({width:g||1,height:C||1});for(const D in this.patterns){const{bin:L}=this.patterns[D],z=L.x+1,G=L.y+1,J=this.images[D].data,ee=J.width,re=J.height;_.RGBAImage.copy(J,S,{x:0,y:0},{x:z,y:G},{width:ee,height:re}),_.RGBAImage.copy(J,S,{x:0,y:re-1},{x:z,y:G-1},{width:ee,height:1}),_.RGBAImage.copy(J,S,{x:0,y:0},{x:z,y:G+re},{width:ee,height:1}),_.RGBAImage.copy(J,S,{x:ee-1,y:0},{x:z-1,y:G},{width:1,height:re}),_.RGBAImage.copy(J,S,{x:0,y:0},{x:z+ee,y:G},{width:1,height:re})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const g of c){if(this.callbackDispatchedThisFrame[g])continue;this.callbackDispatchedThisFrame[g]=!0;const C=this.images[g];Pt(C)&&this.updateImage(g,C)}}}const nt=new _.Properties({anchor:new _.DataConstantProperty(_.spec.light.anchor),position:new class{constructor(){this.specification=_.spec.light.position}possiblyEvaluate(v,c){return function([g,C,S]){const D=_.degToRad(C+90),L=_.degToRad(S);return{x:g*Math.cos(D)*Math.sin(L),y:g*Math.sin(D)*Math.sin(L),z:g*Math.cos(L),azimuthal:C,polar:S}}(v.expression.evaluate(c))}interpolate(v,c,g){return{x:_.number(v.x,c.x,g),y:_.number(v.y,c.y,g),z:_.number(v.z,c.z,g),azimuthal:_.number(v.azimuthal,c.azimuthal,g),polar:_.number(v.polar,c.polar,g)}}},color:new _.DataConstantProperty(_.spec.light.color),intensity:new _.DataConstantProperty(_.spec.light.intensity)}),pt="-transition";class Nt extends _.Evented{constructor(c){super(),this._transitionable=new _.Transitionable(nt),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,g={}){if(!this._validate(_.validateLight,c,g))for(const C in c){const S=c[C];_.endsWith(C,pt)?this._transitionable.setTransition(C.slice(0,-pt.length),S):this._transitionable.setValue(C,S)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,g,C){return(!C||!1!==C.validate)&&_.emitValidationErrors(this,c.call(_.validateStyle,_.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:_.spec})))}}const zt=new _.Properties({source:new _.DataConstantProperty(_.spec.terrain.source),exaggeration:new _.DataConstantProperty(_.spec.terrain.exaggeration)}),an="-transition";class si extends _.Evented{constructor(c,g){super(),this._transitionable=new _.Transitionable(zt),this.set(c),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=g}get(){return this._transitionable.serialize()}set(c){for(const g in c){const C=c[g];_.endsWith(g,an)?this._transitionable.setTransition(g.slice(0,-an.length),C):this._transitionable.setValue(g,C)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}}function On(v,c,g,C){const S=_.smoothstep(45,65,g),[D,L]=mt(v,C),z=_.length(c);let G=1-Math.min(1,Math.exp((z-D)/(L-D)*-6));return G*=G*G,G=Math.min(1,1.00747*G),G*S*v.alpha}function mt(v,c){const g=.5/Math.tan(.5*c);return[v.range[0]+g,v.range[1]+g]}const gt=new _.Properties({range:new _.DataConstantProperty(_.spec.fog.range),color:new _.DataConstantProperty(_.spec.fog.color),"high-color":new _.DataConstantProperty(_.spec.fog["high-color"]),"space-color":new _.DataConstantProperty(_.spec.fog["space-color"]),"horizon-blend":new _.DataConstantProperty(_.spec.fog["horizon-blend"]),"star-intensity":new _.DataConstantProperty(_.spec.fog["star-intensity"])}),Dt="-transition";class Ht extends _.Evented{constructor(c,g){super(),this._transitionable=new _.Transitionable(gt),this.set(c),this._transitioning=this._transitionable.untransitioned(),this._transform=g}get state(){const c=this._transform,g="globe"===c.projection.name,C=_.globeToMercatorTransition(c.zoom),S=this.properties.get("range"),D=[.5,3];return{range:g?[_.number(D[0],S[0],C),_.number(D[1],S[1],C)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(c,g={}){if(!this._validate(_.validateFog,c,g)){for(const C of Object.keys(_.spec.fog))c&&void 0===c[C]&&(c[C]=_.spec.fog[C].default);for(const C in c){const S=c[C];_.endsWith(C,Dt)?this._transitionable.setTransition(C.slice(0,-Dt.length),S):this._transitionable.setValue(C,S)}}}getOpacity(c){if(!this._transform.projection.supportsFog)return 0;const g=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:_.smoothstep(45,65,c))*g.a}getOpacityAtLatLng(c,g){return this._transform.projection.supportsFog?function(C,S,D){const L=_.MercatorCoordinate.fromLngLat(S),z=D.elevation?D.elevation.getAtPointOrZero(L):0,G=[L.x,L.y,z];return _.transformMat4(G,G,D.mercatorFogMatrix),On(C,G,D.pitch,D._fov)}(this.state,c,g):0}getFovAdjustedRange(c){return this._transform.projection.supportsFog?mt(this.state,c):[0,1]}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,g,C){return(!C||!1!==C.validate)&&_.emitValidationErrors(this,c.call(_.validateStyle,_.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:_.spec})))}}class rn{constructor(c,g){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=_.uniqueId();const C=this.workerPool.acquire(this.id);for(let S=0;S<C.length;S++){const D=new rn.Actor(C[S],g,this.id);D.name=`Worker ${S}`,this.actors.push(D)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(c,g,C){_.asyncAll(this.actors,(S,D)=>{S.send(c,g,D)},C=C||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function en(v,c,g){return c*(_.EXTENT/(v.tileSize*Math.pow(2,g-v.tileID.overscaledZ)))}rn.Actor=_.Actor;class wn{constructor(c,g,C,S){this.screenBounds=c,this.cameraPoint=g,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=C,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(c,g){let C,S;if(c instanceof _.pointGeometry||"number"==typeof c[0]){const D=_.pointGeometry.convert(c);C=[D],S=g.isPointAboveHorizon(D)}else{const D=_.pointGeometry.convert(c[0]),L=_.pointGeometry.convert(c[1]);C=[D,L],S=_.polygonizeBounds(D,L).every(z=>g.isPointAboveHorizon(z))}return new wn(C,g.getCameraPoint(),S,g)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(c){return _.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],c)}bufferedCameraGeometry(c){const g=this.screenBounds[0],C=1===this.screenBounds.length?this.screenBounds[0].add(new _.pointGeometry(1,1)):this.screenBounds[1],S=_.polygonizeBounds(g,C,0,!1);return this.cameraPoint.y>C.y&&(this.cameraPoint.x>g.x&&this.cameraPoint.x<C.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=C.x?S[2]=this.cameraPoint:this.cameraPoint.x<=g.x&&(S[3]=this.cameraPoint)),_.bufferConvexPolygon(S,c)}bufferedCameraGeometryGlobe(c){const g=this.screenBounds[0],C=1===this.screenBounds.length?this.screenBounds[0].add(new _.pointGeometry(1,1)):this.screenBounds[1],S=_.polygonizeBounds(g,C,c),D=this.cameraPoint.clone();switch(3*((D.y>g.y)+(D.y>C.y))+((D.x>g.x)+(D.x>C.x))){case 0:S[0]=D,S[4]=D.clone();break;case 1:S.splice(1,0,D);break;case 2:S[1]=D;break;case 3:S.splice(4,0,D);break;case 5:S.splice(2,0,D);break;case 6:S[3]=D;break;case 7:S.splice(3,0,D);break;case 8:S[2]=D}return S}containsTile(c,g,C,S=0){const D=c.queryPadding/g._pixelsPerMercatorPixel+1,L=C?this._bufferedCameraMercator(D,g):this._bufferedScreenMercator(D,g);let z=c.tileID.wrap+(L.unwrapped?S:0);const G=L.polygon.map(xe=>_.getTilePoint(c.tileTransform,xe,z));if(!_.polygonIntersectsBox(G,0,0,_.EXTENT,_.EXTENT))return;z=c.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const J=this.screenGeometryMercator.polygon.map(xe=>_.getTileVec3(c.tileTransform,xe,z)),ee=J.map(xe=>new _.pointGeometry(xe[0],xe[1])),re=g.getFreeCameraOptions().position||new _.MercatorCoordinate(0,0,0),fe=_.getTileVec3(c.tileTransform,re,z),_e=J.map(xe=>{const ue=_.sub(xe,xe,fe);return _.normalize(ue,ue),new _.Ray(fe,ue)}),de=en(c,1,g.zoom)*g._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:ee,tilespaceRays:_e,bufferedTilespaceGeometry:G,bufferedTilespaceBounds:(ve=_.getBounds(G),ve.min.x=_.clamp(ve.min.x,0,_.EXTENT),ve.min.y=_.clamp(ve.min.y,0,_.EXTENT),ve.max.x=_.clamp(ve.max.x,0,_.EXTENT),ve.max.y=_.clamp(ve.max.y,0,_.EXTENT),ve),tile:c,tileID:c.tileID,pixelToTileUnitsFactor:de};var ve}_bufferedScreenMercator(c,g){const C=qn(c);if(this._screenRaycastCache[C])return this._screenRaycastCache[C];{let S;return S="globe"===g.projection.name?this._projectAndResample(this.bufferedScreenGeometry(c),g):{polygon:this.bufferedScreenGeometry(c).map(D=>g.pointCoordinate3D(D)),unwrapped:!0},this._screenRaycastCache[C]=S,S}}_bufferedCameraMercator(c,g){const C=qn(c);if(this._cameraRaycastCache[C])return this._cameraRaycastCache[C];{let S;return S="globe"===g.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(c),g):{polygon:this.bufferedCameraGeometry(c).map(D=>g.pointCoordinate3D(D)),unwrapped:!0},this._cameraRaycastCache[C]=S,S}}_projectAndResample(c,g){const C=function(D,L){const z=_.multiply([],L.pixelMatrix,L.globeMatrix),G=[0,-_.GLOBE_RADIUS,0,1],J=[0,_.GLOBE_RADIUS,0,1],ee=[0,0,0,1];_.transformMat4$1(G,G,z),_.transformMat4$1(J,J,z),_.transformMat4$1(ee,ee,z);const re=new _.pointGeometry(G[0]/G[3],G[1]/G[3]),fe=new _.pointGeometry(J[0]/J[3],J[1]/J[3]),_e=_.polygonContainsPoint(D,re)&&G[3]<ee[3],de=_.polygonContainsPoint(D,fe)&&J[3]<ee[3];if(!_e&&!de)return null;const ve=function(Ue,We,it){for(let st=1;st<Ue.length;st++){const Ut=ir(We.pointCoordinate3D(Ue[st-1]).x),Qe=ir(We.pointCoordinate3D(Ue[st]).x);if(it<0){if(Ut<Qe)return{idx:st,t:-Ut/(Qe-1-Ut)}}else if(Qe<Ut)return{idx:st,t:(1-Ut)/(Qe+1-Ut)}}return null}(D,L,_e?-1:1);if(!ve)return null;const{idx:xe,t:ue}=ve;let Ce=xe>1?Cn(D.slice(0,xe),L):[],be=xe<D.length?Cn(D.slice(xe),L):[];Ce=Ce.map(Ue=>new _.pointGeometry(ir(Ue.x),Ue.y)),be=be.map(Ue=>new _.pointGeometry(ir(Ue.x),Ue.y));const Me=[...Ce];0===Me.length&&Me.push(be[be.length-1]);const Le=_.number(Me[Me.length-1].y,(0===be.length?Ce[0]:be[0]).y,ue);let Fe;return Fe=_e?[new _.pointGeometry(0,Le),new _.pointGeometry(0,0),new _.pointGeometry(1,0),new _.pointGeometry(1,Le)]:[new _.pointGeometry(1,Le),new _.pointGeometry(1,1),new _.pointGeometry(0,1),new _.pointGeometry(0,Le)],Me.push(...Fe),0===be.length?Me.push(Ce[0]):Me.push(...be),{polygon:Me.map(Ue=>new _.MercatorCoordinate(Ue.x,Ue.y)),unwrapped:!1}}(c,g);if(C)return C;const S=function(D,L){let z=!1,G=-1/0,J=0;for(let re=0;re<D.length-1;re++)D[re].x>G&&(G=D[re].x,J=re);for(let re=0;re<D.length-1;re++){const fe=(J+re)%(D.length-1),_e=D[fe],de=D[fe+1];Math.abs(_e.x-de.x)>.5&&(_e.x<de.x?(_e.x+=1,0===fe&&(D[D.length-1].x+=1)):(de.x+=1,fe+1===D.length-1&&(D[0].x+=1)),z=!0)}const ee=_.mercatorXfromLng(L.center.lng);return z&&ee<Math.abs(ee-1)&&D.forEach(re=>{re.x-=1}),{polygon:D,unwrapped:z}}(Cn(c,g).map(D=>new _.pointGeometry(ir(D.x),D.y)),g);return{polygon:S.polygon.map(D=>new _.MercatorCoordinate(D.x,D.y)),unwrapped:S.unwrapped}}}function Cn(v,c){return _.resample(v,g=>{const C=c.pointCoordinate3D(g);g.x=C.x,g.y=C.y},1/256)}function ir(v){return v<0?1+v%1:v%1}function qn(v){return 100*v|0}function Bn(v,c,g,C,S){const D=function(L,z){if(L)return S(L);if(z){v.url&&z.tiles&&v.tiles&&delete v.tiles;const G=_.pick(_.extend(z,v),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);z.vector_layers&&(G.vectorLayers=z.vector_layers,G.vectorLayerIds=G.vectorLayers.map(J=>J.id)),G.tiles=c.canonicalizeTileset(G,v.url),S(null,G)}};return v.url?_.getJSON(c.transformRequest(c.normalizeSourceURL(v.url,null,g,C),_.ResourceType.Source),D):_.exported.frame(()=>D(null,v))}class vn{constructor(c,g,C){this.bounds=_.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=g||0,this.maxzoom=C||24}validateBounds(c){return Array.isArray(c)&&4===c.length?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const g=Math.pow(2,c.z),C=Math.floor(_.mercatorXfromLng(this.bounds.getWest())*g),S=Math.floor(_.mercatorYfromLat(this.bounds.getNorth())*g),D=Math.ceil(_.mercatorXfromLng(this.bounds.getEast())*g),L=Math.ceil(_.mercatorYfromLat(this.bounds.getSouth())*g);return c.x>=C&&c.x<D&&c.y>=S&&c.y<L}}class Xi{constructor(c,g,C){this.context=c;const S=c.gl;this.buffer=S.createBuffer(),this.dynamicDraw=Boolean(C),this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||g.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const g=this.context.gl;this.context.unbindVAO(),this.bind(),g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ai={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class dr{constructor(c,g,C,S){this.length=g.length,this.attributes=C,this.itemSize=g.bytesPerElement,this.dynamicDraw=S,this.context=c;const D=c.gl;this.buffer=D.createBuffer(),c.bindVertexBuffer.set(this.buffer),D.bufferData(D.ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||g.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){const g=this.context.gl;this.bind(),g.bufferSubData(g.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,g){for(let C=0;C<this.attributes.length;C++){const S=g.attributes[this.attributes[C].name];void 0!==S&&c.enableVertexAttribArray(S)}}setVertexAttribPointers(c,g,C){for(let S=0;S<this.attributes.length;S++){const D=this.attributes[S],L=g.attributes[D.name];void 0!==L&&c.vertexAttribPointer(L,D.components,c[Ai[D.type]],!1,this.itemSize,D.offset+this.itemSize*(C||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Un{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class kr extends Un{getDefault(){return _.Color.transparent}set(c){const g=this.current;(c.r!==g.r||c.g!==g.g||c.b!==g.b||c.a!==g.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class lo extends Un{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class Is extends Un{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class co extends Un{getDefault(){return[!0,!0,!0,!0]}set(c){const g=this.current;(c[0]!==g[0]||c[1]!==g[1]||c[2]!==g[2]||c[3]!==g[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Ss extends Un{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class gs extends Un{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Sr extends Un{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const g=this.current;(c.func!==g.func||c.ref!==g.ref||c.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class $r extends Un{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const g=this.current;(c[0]!==g[0]||c[1]!==g[1]||c[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class In extends Un{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;c?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=c,this.dirty=!1}}class Uo extends Un{getDefault(){return[0,1]}set(c){const g=this.current;(c[0]!==g[0]||c[1]!==g[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class ss extends Un{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;c?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=c,this.dirty=!1}}class wo extends Un{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class Gr extends Un{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;c?g.enable(g.BLEND):g.disable(g.BLEND),this.current=c,this.dirty=!1}}class as extends Un{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const g=this.current;(c[0]!==g[0]||c[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class hi extends Un{getDefault(){return _.Color.transparent}set(c){const g=this.current;(c.r!==g.r||c.g!==g.g||c.b!==g.b||c.a!==g.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class jn extends Un{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class Xn extends Un{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;c?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=c,this.dirty=!1}}class zr extends Un{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class Mr extends Un{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class Jr extends Un{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class Oo extends Un{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class uo extends Un{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const g=this.current;(c[0]!==g[0]||c[1]!==g[1]||c[2]!==g[2]||c[3]!==g[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class _s extends Un{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class wi extends Un{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Bs extends Un{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.bindTexture(g.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class Ei extends Un{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class ho extends Un{getDefault(){return null}set(c){const g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class qr extends Un{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class cn extends Un{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class Bt extends Un{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class Sn extends Un{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class Zn extends Un{constructor(c,g){super(c),this.context=c,this.parent=g}getDefault(){return null}}class ti extends Zn{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class Oi extends Zn{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,this.attachment(),g.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class eo extends Oi{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ze{constructor(c,g,C,S){this.context=c,this.width=g,this.height=C;const D=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new ti(c,D),S&&(this.depthAttachment=new Oi(c,D))}destroy(){const c=this.context.gl,g=this.colorAttachment.get();if(g&&c.deleteTexture(g),this.depthAttachment){const C=this.depthAttachment.get();C&&c.deleteRenderbuffer(C)}c.deleteFramebuffer(this.framebuffer)}}class ne{constructor(c,g=!1){if(this.gl=c,this.isWebGL2=g,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),g){const C=c;this.extVertexArrayObject={createVertexArrayOES:C.createVertexArray.bind(c),deleteVertexArrayOES:C.deleteVertexArray.bind(c),bindVertexArrayOES:C.bindVertexArray.bind(c)}}this.clearColor=new kr(this),this.clearDepth=new lo(this),this.clearStencil=new Is(this),this.colorMask=new co(this),this.depthMask=new Ss(this),this.stencilMask=new gs(this),this.stencilFunc=new Sr(this),this.stencilOp=new $r(this),this.stencilTest=new In(this),this.depthRange=new Uo(this),this.depthTest=new ss(this),this.depthFunc=new wo(this),this.blend=new Gr(this),this.blendFunc=new as(this),this.blendColor=new hi(this),this.blendEquation=new jn(this),this.cullFace=new Xn(this),this.cullFaceSide=new zr(this),this.frontFace=new Mr(this),this.program=new Jr(this),this.activeTexture=new Oo(this),this.viewport=new uo(this),this.bindFramebuffer=new _s(this),this.bindRenderbuffer=new wi(this),this.bindTexture=new Bs(this),this.bindVertexBuffer=new Ei(this),this.bindElementBuffer=new ho(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new qr(this),this.pixelStoreUnpack=new cn(this),this.pixelStoreUnpackPremultiplyAlpha=new Bt(this),this.pixelStoreUnpackFlipY=new Sn(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=c.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=c.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=c.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),g||(this.extTextureHalfFloat=c.getExtension("OES_texture_half_float")),(g||this.extTextureHalfFloat&&c.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=g||c.getExtension("OES_standard_derivatives"),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,g){return new Xi(this,c,g)}createVertexBuffer(c,g,C){return new dr(this,c,g,C)}createRenderbuffer(c,g,C){const S=this.gl,D=S.createRenderbuffer();return this.bindRenderbuffer.set(D),S.renderbufferStorage(S.RENDERBUFFER,c,g,C),this.bindRenderbuffer.set(null),D}createFramebuffer(c,g,C){return new ze(this,c,g,C)}clear({color:c,depth:g,stencil:C}){const S=this.gl;let D=0;c&&(D|=S.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),void 0!==g&&(D|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(g),this.depthMask.set(!0)),void 0!==C&&(D|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(C),this.stencilMask.set(255)),S.clear(D)}setCullFace(c){!1===c.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){$e(c.blendFunction,_.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class $ extends _.Evented{constructor(c,g,C,S){if(super(),this.id=c,this.dispatcher=C,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,_.extend(this,_.pick(g,["url","scheme","tileSize","promoteId"])),this._options=_.extend({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new _.DedupedRequest}load(c){this._loaded=!1,this.fire(new _.Event("dataloading",{dataType:"source"}));const g=Array.isArray(this.map._language)?this.map._language.join():this.map._language,C=this.map._worldview;this._tileJSONRequest=Bn(this._options,this.map._requestManager,g,C,(S,D)=>{this._tileJSONRequest=null,this._loaded=!0,S?(g&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${g}`),C&&2!==C.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${C}`),this.fire(new _.ErrorEvent(S))):D&&(_.extend(this,D),D.bounds&&(this.tileBounds=new vn(D.bounds,this.minzoom,this.maxzoom)),_.postTurnstileEvent(D.tiles,this.map._requestManager._customAccessToken),this.fire(new _.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(S)})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return _.extend({},this._options)}loadTile(c,g){const C=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(C,_.ResourceType.Tile),data:void 0,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:_.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:c.isSymbolTile};if(S.request.collectResourceTiming=this._collectResourceTiming,c.actor&&"expired"!==c.state)"loading"===c.state?c.reloadCallback=g:c.request=c.actor.send("reloadTile",S,D.bind(this));else if(c.actor=this._tileWorkers[C]=this._tileWorkers[C]||this.dispatcher.getActor(),this.dispatcher.ready)c.request=c.actor.send("loadTile",S,D.bind(this),void 0,!0);else{const L=_.loadVectorTile.call({deduped:this._deduped},S,(z,G)=>{z||!G?D.call(this,z):(S.data={cacheControl:G.cacheControl,expires:G.expires,rawData:G.rawData.slice(0)},c.actor&&c.actor.send("loadTile",S,D.bind(this),void 0,!0))},!0);c.request={cancel:L}}function D(L,z){return delete c.request,c.aborted?g(null):L&&404!==L.status?g(L):(z&&z.resourceTiming&&(c.resourceTiming=z.resourceTiming),this.map._refreshExpiredTiles&&z&&c.setExpiryData(z),c.loadVectorData(z,this.map.painter),_.cacheEntryPossiblyAdded(this.dispatcher),g(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id})}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class H extends _.Evented{constructor(c,g,C,S){super(),this.id=c,this.dispatcher=C,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=_.extend({type:"raster"},g),_.extend(this,_.pick(g,["url","scheme","tileSize"]))}load(c){this._loaded=!1,this.fire(new _.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Bn(this._options,this.map._requestManager,null,null,(g,C)=>{this._tileJSONRequest=null,this._loaded=!0,g?this.fire(new _.ErrorEvent(g)):C&&(_.extend(this,C),C.bounds&&(this.tileBounds=new vn(C.bounds,this.minzoom,this.maxzoom)),_.postTurnstileEvent(C.tiles),this.fire(new _.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(g)})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return _.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,g){const C=_.exported.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),C,this.tileSize);c.request=_.getImage(this.map._requestManager.transformRequest(S,_.ResourceType.Tile),(D,L,z,G)=>(delete c.request,c.aborted?(c.state="unloaded",g(null)):D?(c.state="errored",g(D)):L?(this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:z,expires:G}),c.setTexture(L,this.map.painter),c.state="loaded",_.cacheEntryPossiblyAdded(this.dispatcher),void g(null)):g(null)))}static loadTileData(c,g,C){c.setTexture(g,C)}static unloadTileData(c,g){c.texture&&g.saveTileTexture(c.texture)}abortTile(c,g){c.request&&(c.request.cancel(),delete c.request),g()}unloadTile(c,g){c.texture&&this.map.painter.saveTileTexture(c.texture),g()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let Y;function ae(v,c,g,C,S,D,L,z){const G=[v,g,S,c,C,D,1,1,1],J=[L,z,1],ee=_.adjoint([],G),[re,fe,_e]=_.transformMat3(J,J,_.transpose(ee,ee));return _.multiply$1(G,[re,0,0,0,fe,0,0,0,_e],G)}class pe extends _.Evented{constructor(c,g,C,S){super(),this.id=c,this.dispatcher=C,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(S),this.options=g,this._dirty=!1}load(c,g){this._loaded=g||!1,this.fire(new _.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=_.getImage(this.map._requestManager.transformRequest(this.url,_.ResourceType.Image),(C,S)=>{if(this._imageRequest=null,this._loaded=!0,C)this.fire(new _.ErrorEvent(C));else if(S){const{HTMLImageElement:D}=_.window;this.image=S instanceof D?_.exported.getImageData(S):S,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,c&&(this.coordinates=c),this._finishLoading()}})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this._imageRequest&&c.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=c.url,this.load(c.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new _.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(c){this.coordinates=c,this._boundsArray=void 0;const g=c.map(_.MercatorCoordinate.fromLngLat);return this.tileID=function(C){let S=1/0,D=1/0,L=-1/0,z=-1/0;for(const re of C)S=Math.min(S,re.x),D=Math.min(D,re.y),L=Math.max(L,re.x),z=Math.max(z,re.y);const G=Math.max(L-S,z-D),J=Math.max(0,Math.floor(-Math.log(G)/Math.LN2)),ee=Math.pow(2,J);return new _.CanonicalTileID(J,Math.floor((S+L)/2*ee),Math.floor((D+z)/2*ee))}(g),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new _.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(c){for(const G in this.tiles){const J=this.tiles[G];"loaded"!==J.state&&(J.state="loaded",J.texture=this.texture)}if(this._boundsArray)return;const g=_.tileTransform(this.tileID,this.map.transform.projection),[C,S,D,L]=this.coordinates.map(G=>{const J=g.projection.project(G[0],G[1]);return _.getTilePoint(g,J)._round()});this.perspectiveTransform=function(G,J,ee,re,fe,_e,de,ve,xe,ue){const Ce=ae(0,0,G,0,0,J,G,J),be=ae(ee,re,fe,_e,de,ve,xe,ue);return _.multiply$1(be,_.adjoint(Ce,Ce),be),[be[6]/be[8]*G/_.EXTENT,be[7]/be[8]*J/_.EXTENT]}(this.width,this.height,C.x,C.y,S.x,S.y,L.x,L.y,D.x,D.y);const z=this._boundsArray=new _.StructArrayLayout4i8;z.emplaceBack(C.x,C.y,0,0),z.emplaceBack(S.x,S.y,_.EXTENT,0),z.emplaceBack(L.x,L.y,0,_.EXTENT),z.emplaceBack(D.x,D.y,_.EXTENT,_.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=c.createVertexBuffer(z,_.boundsAttributes.members),this.boundsSegments=_.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const c=this.map.painter.context,g=c.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new _.Texture(c,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(c)}loadTile(c,g){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},g(null)):(c.state="errored",g(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const ke={vector:$,raster:H,"raster-dem":class extends H{constructor(v,c,g,C){super(v,c,g,C),this.type="raster-dem",this.maxzoom=22,this._options=_.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}loadTile(v,c){const g=this.map._requestManager.normalizeTileURL(v.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function C(S,D){S&&(v.state="errored",c(S)),D&&(v.dem=D,v.dem.onDeserialize(),v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0,v.state="loaded",c(null))}v.request=_.getImage(this.map._requestManager.transformRequest(g,_.ResourceType.Tile),function(S,D,L,z){if(delete v.request,v.aborted)v.state="unloaded",c(null);else if(S)v.state="errored",c(S);else if(D){this.map._refreshExpiredTiles&&v.setExpiryData({cacheControl:L,expires:z});const G=_.window.ImageBitmap&&D instanceof _.window.ImageBitmap&&(null==Y&&(Y=_.window.OffscreenCanvas&&new _.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof _.window.createImageBitmap),Y),J=1-(D.width-_.prevPowerOfTwo(D.width))/2;J<1||v.neighboringTiles||(v.neighboringTiles=this._getNeighboringTiles(v.tileID));const ee=G?D:_.exported.getImageData(D,J),re={uid:v.uid,coord:v.tileID,source:this.id,rawImageData:ee,encoding:this.encoding,padding:J};v.actor&&"expired"!==v.state||(v.actor=this.dispatcher.getActor(),v.actor.send("loadDEMTile",re,C.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(v){const c=v.canonical,g=Math.pow(2,c.z),C=(c.x-1+g)%g,S=0===c.x?v.wrap-1:v.wrap,D=(c.x+1+g)%g,L=c.x+1===g?v.wrap+1:v.wrap,z={};return z[new _.OverscaledTileID(v.overscaledZ,S,c.z,C,c.y).key]={backfilled:!1},z[new _.OverscaledTileID(v.overscaledZ,L,c.z,D,c.y).key]={backfilled:!1},c.y>0&&(z[new _.OverscaledTileID(v.overscaledZ,S,c.z,C,c.y-1).key]={backfilled:!1},z[new _.OverscaledTileID(v.overscaledZ,v.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},z[new _.OverscaledTileID(v.overscaledZ,L,c.z,D,c.y-1).key]={backfilled:!1}),c.y+1<g&&(z[new _.OverscaledTileID(v.overscaledZ,S,c.z,C,c.y+1).key]={backfilled:!1},z[new _.OverscaledTileID(v.overscaledZ,v.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},z[new _.OverscaledTileID(v.overscaledZ,L,c.z,D,c.y+1).key]={backfilled:!1}),z}unloadTile(v){v.demTexture&&this.map.painter.saveTileTexture(v.demTexture),v.fbo&&(v.fbo.destroy(),delete v.fbo),v.dem&&delete v.dem,delete v.neighboringTiles,v.state="unloaded"}},geojson:class extends _.Evented{constructor(v,c,g,C){super(),this.id=v,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=g.getActor(),this.setEventedParent(C),this._data=c.data,this._options=_.extend({},c),this._collectResourceTiming=c.collectResourceTiming,void 0!==c.maxzoom&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const S=_.EXTENT/this.tileSize;this.workerOptions=_.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(void 0!==c.buffer?c.buffer:128)*S,tolerance:(void 0!==c.tolerance?c.tolerance:.375)*S,extent:_.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:void 0!==c.clusterMaxZoom?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:_.EXTENT,radius:(void 0!==c.clusterRadius?c.clusterRadius:50)*S,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}onAdd(v){this.map=v,this.setData(this._data)}setData(v){return this._data=v,this._updateWorkerData(),this}getClusterExpansionZoom(v,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:v,source:this.id},c),this}getClusterChildren(v,c){return this.actor.send("geojson.getClusterChildren",{clusterId:v,source:this.id},c),this}getClusterLeaves(v,c,g,C){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:v,limit:c,offset:g},C),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new _.Event("dataloading",{dataType:"source"})),this._loaded=!1;const v=_.extend({},this.workerOptions),c=this._data;"string"==typeof c?(v.request=this.map._requestManager.transformRequest(_.exported.resolveURL(c),_.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,v,(g,C)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new _.ErrorEvent(g));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&C&&C.resourceTiming&&C.resourceTiming[this.id]&&(S.resourceTiming=C.resourceTiming[this.id]),this.fire(new _.Event("data",S)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(v,c){const g=v.actor?"reloadTile":"loadTile";v.actor=this.actor,v.request=this.actor.send(g,{type:this.type,uid:v.uid,tileID:v.tileID,tileZoom:v.tileZoom,zoom:v.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:_.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(C,S)=>(delete v.request,v.unloadVectorData(),v.aborted?c(null):C?c(C):(v.loadVectorData(S,this.map.painter,"reloadTile"===g),c(null))),void 0,"loadTile"===g)}abortTile(v){v.request&&(v.request.cancel(),delete v.request),v.aborted=!0}unloadTile(v){v.unloadVectorData(),this.actor.send("removeTile",{uid:v.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return _.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends pe{constructor(v,c,g,C){super(v,c,g,C),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const v=this.options;this.urls=[];for(const c of v.urls)this.urls.push(this.map._requestManager.transformRequest(c,_.ResourceType.Source).url);_.getVideo(this.urls,(c,g)=>{this._loaded=!0,c?this.fire(new _.ErrorEvent(c)):g&&(this.video=g,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(v){if(this.video){const c=this.video.seekable;v<c.start(0)||v>c.end(0)?this.fire(new _.ErrorEvent(new _.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=v}}getVideo(){return this.video}onAdd(v){this.map||(this.map=v,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const v=this.map.painter.context,c=v.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new _.Texture(v,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(v)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:pe,canvas:class extends pe{constructor(v,c,g,C){super(v,c,g,C),c.coordinates?Array.isArray(c.coordinates)&&4===c.coordinates.length&&!c.coordinates.some(S=>!Array.isArray(S)||2!==S.length||S.some(D=>"number"!=typeof D))||this.fire(new _.ErrorEvent(new _.ValidationError(`sources.${v}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new _.ErrorEvent(new _.ValidationError(`sources.${v}`,null,'missing required property "coordinates"'))),c.animate&&"boolean"!=typeof c.animate&&this.fire(new _.ErrorEvent(new _.ValidationError(`sources.${v}`,null,'optional "animate" property must be a boolean value'))),c.canvas?"string"==typeof c.canvas||c.canvas instanceof _.window.HTMLCanvasElement||this.fire(new _.ErrorEvent(new _.ValidationError(`sources.${v}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new _.ErrorEvent(new _.ValidationError(`sources.${v}`,null,'missing required property "canvas"'))),this.options=c,this.animate=void 0===c.animate||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof _.window.HTMLCanvasElement?this.options.canvas:_.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new _.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(v){this.map=v,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let v=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,v=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,v=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const c=this.map.painter.context;this.texture?(v||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new _.Texture(c,this.canvas,c.gl.RGBA,{premultiply:!0}),this._prepareData(c)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const v of[this.canvas.width,this.canvas.height])if(isNaN(v)||v<=0)return!0;return!1}},custom:class extends _.Evented{constructor(v,c,g,C){super(),this.id=v,this.type="custom",this._dataType="raster",this._dispatcher=g,this._implementation=c,this.setEventedParent(C),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new _.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new _.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new vn(this._implementation.bounds,this.minzoom,this.maxzoom)),c.update=this._update.bind(this),c.clearTiles=this._clearTiles.bind(this),c.coveringTiles=this._coveringTiles.bind(this),_.extend(this,_.pick(c,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return _.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new _.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(v){this._map=v,this._loaded=!1,this.fire(new _.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(v),this.load()}onRemove(v){this._implementation.onRemove&&this._implementation.onRemove(v)}hasTile(v){if(this._implementation.hasTile){const{x:c,y:g,z:C}=v.canonical;return this._implementation.hasTile({x:c,y:g,z:C})}return!this.tileBounds||this.tileBounds.contains(v.canonical)}loadTile(v,c){const{x:g,y:C,z:S}=v.tileID.canonical,D=new _.window.AbortController;v.request=Promise.resolve(this._implementation.loadTile({x:g,y:C,z:S},{signal:D.signal})).then(function(L){return delete v.request,v.aborted?(v.state="unloaded",c(null)):void 0===L?(v.state="errored",c(null)):null===L?(this.loadTileData(v,{width:this.tileSize,height:this.tileSize,data:null}),v.state="loaded",c(null)):(z=L)instanceof _.window.ImageData||z instanceof _.window.HTMLCanvasElement||z instanceof _.window.ImageBitmap||z instanceof _.window.HTMLImageElement?(this.loadTileData(v,L),v.state="loaded",void c(null)):(v.state="errored",c(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var z}.bind(this)).catch(L=>{20!==L.code&&(v.state="errored",c(L))}),v.request.cancel=()=>D.abort()}loadTileData(v,c){H.loadTileData(v,c,this._map.painter)}unloadTileData(v){H.unloadTileData(v,this._map.painter)}unloadTile(v,c){if(this.unloadTileData(v),this._implementation.unloadTile){const{x:g,y:C,z:S}=v.tileID.canonical;this._implementation.unloadTile({x:g,y:C,z:S})}c()}abortTile(v,c){v.request&&v.request.cancel&&(v.request.cancel(),delete v.request),c()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(v=>({x:v.canonical.x,y:v.canonical.y,z:v.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new _.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Be=function(v,c,g,C){const S=new ke[c.type](v,c,g,C);if(S.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${S.id}`);return _.bindAll(["load","abort","unload","serialize","prepare"],S),S};function Pe(v,c){const g=_.identity([]);return _.scale(g,g,[.5*v.width,.5*-v.height,1]),_.translate(g,g,[1,-1,0]),_.multiply(g,g,v.calculateProjMatrix(c.toUnwrapped())),Float32Array.from(g)}function He(v,c,g,C,S,D,L,z=!1){const G=v.tilesIn(C,L,z);G.sort($t);const J=[];for(const re of G)J.push({wrappedTileID:re.tile.tileID.wrapped().key,queryResults:re.tile.queryRenderedFeatures(c,g,v._state,re,S,D,Pe(v.transform,re.tile.tileID),z)});const ee=function(re){const fe={},_e={};for(const de of re){const ve=de.queryResults,xe=de.wrappedTileID,ue=_e[xe]=_e[xe]||{};for(const Ce in ve){const be=ve[Ce],Me=ue[Ce]=ue[Ce]||{},Le=fe[Ce]=fe[Ce]||[];for(const Fe of be)Me[Fe.featureIndex]||(Me[Fe.featureIndex]=!0,Le.push(Fe))}}return fe}(J);for(const re in ee)ee[re].forEach(fe=>{const _e=fe.feature,de=_e.layer;de&&"background"!==de.type&&"sky"!==de.type&&(_e.source=de.source,de["source-layer"]&&(_e.sourceLayer=de["source-layer"]),_e.state=void 0!==_e.id?v.getFeatureState(de["source-layer"],_e.id):{})});return ee}function rt(v,c){const g=v.getRenderableIds().map(D=>v.getTileByID(D)),C=[],S={};for(let D=0;D<g.length;D++){const L=g[D],z=L.tileID.canonical.key;S[z]||(S[z]=!0,L.querySourceFeatures(C,c))}return C}function $t(v,c){const g=v.tileID,C=c.tileID;return g.overscaledZ-C.overscaledZ||g.canonical.y-C.canonical.y||g.wrap-C.wrap||g.canonical.x-C.canonical.x}function _t(){return null!=Mi.workerClass?new Mi.workerClass:new _.window.Worker(Mi.workerUrl)}const En="mapboxgl_preloaded_worker_pool";class Nn{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<Nn.workerCount;)this.workers.push(new _t);return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],0===this.numActive()&&(this.workers.forEach(g=>{g.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[En]}numActive(){return Object.keys(this.active).length}}let Ln;function ii(){return Ln||(Ln=new Nn),Ln}function Ci(v,c){const g={};for(const C in v)"ref"!==C&&(g[C]=v[C]);return _.refProperties.forEach(C=>{C in c&&(g[C]=c[C])}),g}function mi(v){v=v.slice();const c=Object.create(null);for(let g=0;g<v.length;g++)c[v[g].id]=v[g];for(let g=0;g<v.length;g++)"ref"in v[g]&&(v[g]=Ci(v[g],c[v[g].ref]));return v}Nn.workerCount=2;const $n={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function hr(v,c,g){g.push({command:$n.addSource,args:[v,c[v]]})}function fr(v,c,g){c.push({command:$n.removeSource,args:[v]}),g[v]=!0}function Zi(v,c,g,C){fr(v,g,C),hr(v,c,g)}function Rr(v,c,g){let C;for(C in v[g])if(v[g].hasOwnProperty(C)&&"data"!==C&&!$e(v[g][C],c[g][C]))return!1;for(C in c[g])if(c[g].hasOwnProperty(C)&&"data"!==C&&!$e(v[g][C],c[g][C]))return!1;return!0}function dt(v,c,g,C,S,D){let L;for(L in c=c||{},v=v||{})v.hasOwnProperty(L)&&($e(v[L],c[L])||g.push({command:D,args:[C,L,c[L],S]}));for(L in c)c.hasOwnProperty(L)&&!v.hasOwnProperty(L)&&($e(v[L],c[L])||g.push({command:D,args:[C,L,c[L],S]}))}function ko(v){return v.id}function ur(v,c){return v[c.id]=c,v}class qa{constructor(c,g){this.reset(c,g)}reset(c,g){this.points=c||[],this._distances=[0];for(let C=1;C<this.points.length;C++)this._distances[C]=this._distances[C-1]+this.points[C].dist(this.points[C-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(g||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(1===this.points.length)return this.points[0];c=_.clamp(c,0,1);let g=1,C=this._distances[g];const S=c*this.paddedLength+this.padding;for(;C<S&&g<this._distances.length;)C=this._distances[++g];const D=g-1,L=this._distances[D],z=C-L,G=z>0?(S-L)/z:0;return this.points[D].mult(1-G).add(this.points[g].mult(G))}}class rh{constructor(c,g,C){const S=this.boxCells=[],D=this.circleCells=[];this.xCellCount=Math.ceil(c/C),this.yCellCount=Math.ceil(g/C);for(let L=0;L<this.xCellCount*this.yCellCount;L++)S.push([]),D.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=g,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/g,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,g,C,S,D){this._forEachCell(g,C,S,D,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(g),this.bboxes.push(C),this.bboxes.push(S),this.bboxes.push(D)}insertCircle(c,g,C,S){this._forEachCell(g-S,C-S,g+S,C+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(g),this.circles.push(C),this.circles.push(S)}_insertBoxCell(c,g,C,S,D,L){this.boxCells[D].push(L)}_insertCircleCell(c,g,C,S,D,L){this.circleCells[D].push(L)}_query(c,g,C,S,D,L){if(C<0||c>this.width||S<0||g>this.height)return!D&&[];const z=[];if(c<=0&&g<=0&&this.width<=C&&this.height<=S){if(D)return!0;for(let G=0;G<this.boxKeys.length;G++)z.push({key:this.boxKeys[G],x1:this.bboxes[4*G],y1:this.bboxes[4*G+1],x2:this.bboxes[4*G+2],y2:this.bboxes[4*G+3]});for(let G=0;G<this.circleKeys.length;G++){const J=this.circles[3*G],ee=this.circles[3*G+1],re=this.circles[3*G+2];z.push({key:this.circleKeys[G],x1:J-re,y1:ee-re,x2:J+re,y2:ee+re})}return L?z.filter(L):z}return this._forEachCell(c,g,C,S,this._queryCell,z,{hitTest:D,seenUids:{box:{},circle:{}}},L),D?z.length>0:z}_queryCircle(c,g,C,S,D){const L=c-C,z=c+C,G=g-C,J=g+C;if(z<0||L>this.width||J<0||G>this.height)return!S&&[];const ee=[];return this._forEachCell(L,G,z,J,this._queryCellCircle,ee,{hitTest:S,circle:{x:c,y:g,radius:C},seenUids:{box:{},circle:{}}},D),S?ee.length>0:ee}query(c,g,C,S,D){return this._query(c,g,C,S,!1,D)}hitTest(c,g,C,S,D){return this._query(c,g,C,S,!0,D)}hitTestCircle(c,g,C,S){return this._queryCircle(c,g,C,!0,S)}_queryCell(c,g,C,S,D,L,z,G){const J=z.seenUids,ee=this.boxCells[D];if(null!==ee){const fe=this.bboxes;for(const _e of ee)if(!J.box[_e]){J.box[_e]=!0;const de=4*_e;if(c<=fe[de+2]&&g<=fe[de+3]&&C>=fe[de+0]&&S>=fe[de+1]&&(!G||G(this.boxKeys[_e]))){if(z.hitTest)return L.push(!0),!0;L.push({key:this.boxKeys[_e],x1:fe[de],y1:fe[de+1],x2:fe[de+2],y2:fe[de+3]})}}}const re=this.circleCells[D];if(null!==re){const fe=this.circles;for(const _e of re)if(!J.circle[_e]){J.circle[_e]=!0;const de=3*_e;if(this._circleAndRectCollide(fe[de],fe[de+1],fe[de+2],c,g,C,S)&&(!G||G(this.circleKeys[_e]))){if(z.hitTest)return L.push(!0),!0;{const ve=fe[de],xe=fe[de+1],ue=fe[de+2];L.push({key:this.circleKeys[_e],x1:ve-ue,y1:xe-ue,x2:ve+ue,y2:xe+ue})}}}}}_queryCellCircle(c,g,C,S,D,L,z,G){const J=z.circle,ee=z.seenUids,re=this.boxCells[D];if(null!==re){const _e=this.bboxes;for(const de of re)if(!ee.box[de]){ee.box[de]=!0;const ve=4*de;if(this._circleAndRectCollide(J.x,J.y,J.radius,_e[ve+0],_e[ve+1],_e[ve+2],_e[ve+3])&&(!G||G(this.boxKeys[de])))return L.push(!0),!0}}const fe=this.circleCells[D];if(null!==fe){const _e=this.circles;for(const de of fe)if(!ee.circle[de]){ee.circle[de]=!0;const ve=3*de;if(this._circlesCollide(_e[ve],_e[ve+1],_e[ve+2],J.x,J.y,J.radius)&&(!G||G(this.circleKeys[de])))return L.push(!0),!0}}}_forEachCell(c,g,C,S,D,L,z,G){const J=this._convertToXCellCoord(c),ee=this._convertToYCellCoord(g),re=this._convertToXCellCoord(C),fe=this._convertToYCellCoord(S);for(let _e=J;_e<=re;_e++)for(let de=ee;de<=fe;de++)if(D.call(this,c,g,C,S,this.xCellCount*de+_e,L,z,G))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,g,C,S,D,L){const z=S-c,G=D-g,J=C+L;return J*J>z*z+G*G}_circleAndRectCollide(c,g,C,S,D,L,z){const G=(L-S)/2,J=Math.abs(c-(S+G));if(J>G+C)return!1;const ee=(z-D)/2,re=Math.abs(g-(D+ee));if(re>ee+C)return!1;if(J<=G||re<=ee)return!0;const fe=J-G,_e=re-ee;return fe*fe+_e*_e<=C*C}}const ls=Math.tan(85*Math.PI/180);function Ms(v,c,g,C,S,D,L){const z=_.create();if(g)if("globe"===D.name){const G=_.calculateGlobeLabelMatrix(S,c);_.multiply(z,z,G)}else{const G=xt([],L);z[0]=G[0],z[1]=G[1],z[4]=G[2],z[5]=G[3],C||_.rotateZ(z,z,S.angle)}else _.multiply(z,S.labelPlaneMatrix,v);return z}function Mn(v,c,g,C,S,D,L){const z=Ms(v,c,g,C,S,D,L);return"globe"===D.name&&g||(z[2]=z[6]=z[10]=z[14]=0),z}function Ti(v,c,g,C,S,D,L){if(g){if("globe"===D.name){const z=Ms(v,c,g,C,S,D,L);return _.invert(z,z),_.multiply(z,v,z),z}{const z=_.clone(v),G=_.identity([]);return G[0]=L[0],G[1]=L[1],G[4]=L[2],G[5]=L[3],_.multiply(z,z,G),C||_.rotateZ(z,z,-S.angle),z}}return S.glCoordMatrix}function Ft(v,c,g,C){const S=[v,c,g,1];g?_.transformMat4$1(S,S,C):cd(S,S,C);const D=S[3];return S[0]/=D,S[1]/=D,S[2]/=D,S}function oi(v,c){return Math.min(.5+v/c*.5,1.5)}function gi(v,c){const g=v[0]/v[3],C=v[1]/v[3];return g>=-c[0]&&g<=c[0]&&C>=-c[1]&&C<=c[1]}function Qi(v,c,g,C,S,D,L,z,G,J){const ee=g.transform,re=C?v.textSizeData:v.iconSizeData,fe=_.evaluateSizeForZoom(re,g.transform.zoom),_e="globe"===ee.projection.name,de=[256/g.width*2+1,256/g.height*2+1],ve=C?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;ve.clear();let xe=null;_e&&(xe=C?v.text.globeExtVertexArray:v.icon.globeExtVertexArray);const ue=v.lineVertexArray,Ce=C?v.text.placedSymbolArray:v.icon.placedSymbolArray,be=g.transform.width/g.transform.height;let Me,Le=!1;for(let Fe=0;Fe<Ce.length;Fe++){const Ue=Ce.get(Fe),{numGlyphs:We,writingMode:it}=Ue;if(it!==_.WritingMode.vertical||Le||Me===_.WritingMode.horizontal||(Le=!0),Me=it,(Ue.hidden||it===_.WritingMode.vertical)&&!Le){Ui(We,ve);continue}Le=!1;const st=new _.pointGeometry(Ue.tileAnchorX,Ue.tileAnchorY);let{x:Ut,y:Qe,z:St}=ee.projection.projectTilePoint(st.x,st.y,J.canonical);if(G){const[Wn,_n,Yt]=G(st);Ut+=Wn,Qe+=_n,St+=Yt}const at=[Ut,Qe,St,1];if(_.transformMat4$1(at,at,c),!gi(at,de)){Ui(We,ve);continue}const Ot=oi(g.transform.cameraToCenterDistance,at[3]),et=_.evaluateSizeForFeature(re,fe,Ue),qe=L?et/Ot:et*Ot,Xe=Ft(Ut,Qe,St,S);if(Xe[3]<=0){Ui(We,ve);continue}let Mt={};const Rt=L?null:G,dn=Ro(Ue,qe,!1,z,c,S,D,v.glyphOffsetArray,ue,ve,xe,Xe,st,Mt,be,Rt,ee.projection,J,L);Le=dn.useVertical,Rt&&dn.needsFlipping&&(Mt={}),(dn.notEnoughRoom||Le||dn.needsFlipping&&Ro(Ue,qe,!0,z,c,S,D,v.glyphOffsetArray,ue,ve,xe,Xe,st,Mt,be,Rt,ee.projection,J,L).notEnoughRoom)&&Ui(We,ve)}C?(v.text.dynamicLayoutVertexBuffer.updateData(ve),xe&&v.text.globeExtVertexBuffer.updateData(xe)):(v.icon.dynamicLayoutVertexBuffer.updateData(ve),xe&&v.icon.globeExtVertexBuffer.updateData(xe))}function Ds(v,c,g,C,S,D,L,z,G,J,ee,re,fe,_e,de,ve){const{lineStartIndex:xe,glyphStartIndex:ue,segment:Ce}=z,be=ue+z.numGlyphs,Me=xe+z.lineLength,Le=c.getoffsetX(ue),Fe=c.getoffsetX(be-1),Ue=jo(v*Le,g,C,S,D,L,Ce,xe,Me,G,J,ee,re,fe,!0,_e,de,ve);if(!Ue)return null;const We=jo(v*Fe,g,C,S,D,L,Ce,xe,Me,G,J,ee,re,fe,!0,_e,de,ve);return We?{first:Ue,last:We}:null}function Gn(v,c,g,C){return v===_.WritingMode.horizontal&&Math.abs(C)>Math.abs(g)?{useVertical:!0}:v===_.WritingMode.vertical?C>0?{needsFlipping:!0}:null:0!==c&&(0===(S=g)||Math.abs(C/S)>ls)?1===c?{needsFlipping:!0}:null:g<0?{needsFlipping:!0}:null;var S}function Ro(v,c,g,C,S,D,L,z,G,J,ee,re,fe,_e,de,ve,xe,ue,Ce){const be=c/24,Me=v.lineOffsetX*be,Le=v.lineOffsetY*be,{lineStartIndex:Fe,glyphStartIndex:Ue,numGlyphs:We,segment:it,writingMode:st,flipState:Ut}=v,Qe=Fe+v.lineLength,St=at=>{if(ee){const[Xe,Mt,Rt]=at.up,dn=J.length;_.updateGlobeVertexNormal(ee,dn+0,Xe,Mt,Rt),_.updateGlobeVertexNormal(ee,dn+1,Xe,Mt,Rt),_.updateGlobeVertexNormal(ee,dn+2,Xe,Mt,Rt),_.updateGlobeVertexNormal(ee,dn+3,Xe,Mt,Rt)}const[Ot,et,qe]=at.point;_.addDynamicAttributes(J,Ot,et,qe,at.angle)};if(We>1){const at=Ds(be,z,Me,Le,g,re,fe,v,G,D,_e,ve,!1,xe,ue,Ce);if(!at)return{notEnoughRoom:!0};if(C&&!g){let[Ot,et,qe]=at.first.point,[Xe,Mt,Rt]=at.last.point;[Ot,et]=Ft(Ot,et,qe,L),[Xe,Mt]=Ft(Xe,Mt,Rt,L);const dn=Gn(st,Ut,(Xe-Ot)*de,Mt-et);if(v.flipState=dn&&dn.needsFlipping?1:2,dn)return dn}St(at.first);for(let Ot=Ue+1;Ot<Ue+We-1;Ot++){const et=jo(be*z.getoffsetX(Ot),Me,Le,g,re,fe,it,Fe,Qe,G,D,_e,ve,!1,!1,xe,ue,Ce);if(!et)return J.length-=4*(Ot-Ue),{notEnoughRoom:!0};St(et)}St(at.last)}else{if(C&&!g){const Ot=Ft(fe.x,fe.y,0,S),et=Fe+it+1,qe=new _.pointGeometry(G.getx(et),G.gety(et)),Xe=Ft(qe.x,qe.y,0,S),Mt=Xe[3]>0?Xe:bi(fe,qe,Ot,1,S,void 0,xe,ue.canonical),Rt=Gn(st,Ut,(Mt[0]-Ot[0])*de,Mt[1]-Ot[1]);if(v.flipState=Rt&&Rt.needsFlipping?1:2,Rt)return Rt}const at=jo(be*z.getoffsetX(Ue),Me,Le,g,re,fe,it,Fe,Qe,G,D,_e,ve,!1,!1,xe,ue,Ce);if(!at)return{notEnoughRoom:!0};St(at)}return{}}function _l(v,c,g,C,S){const{x:D,y:L,z}=C.projectTilePoint(v.x,v.y,c);if(!S)return Ft(D,L,z,g);const[G,J,ee]=S(v);return Ft(D+G,L+J,z+ee,g)}function bi(v,c,g,C,S,D,L,z){const G=_l(v.sub(c)._unit()._add(v),z,S,L,D);return _.sub(G,g,G),_.normalize(G,G),_.scaleAndAdd(G,g,G,C)}function jo(v,c,g,C,S,D,L,z,G,J,ee,re,fe,_e,de,ve,xe,ue){const Ce=C?v-c:v+c;let be=Ce>0?1:-1,Me=0;C&&(be*=-1,Me=Math.PI),be<0&&(Me+=Math.PI);let Le=z+L+(be>0?0:1)|0,Fe=S,Ue=S,We=0,it=0;const st=Math.abs(Ce),Ut=[],Qe=[];let St=D,at=St;const Ot=()=>bi(at,St,Ue,st-We+1,ee,fe,ve,xe.canonical);for(;We+it<=st;){if(Le+=be,Le<z||Le>=G)return null;if(Ue=Fe,at=St,Ut.push(Ue),_e&&Qe.push(at),St=new _.pointGeometry(J.getx(Le),J.gety(Le)),Fe=re[Le],!Fe){const Yt=_l(St,xe.canonical,ee,ve,fe);Fe=Yt[3]>0?re[Le]=Yt:Ot()}We+=it,it=_.distance(Ue,Fe)}de&&fe&&(re[Le]&&(Fe=Ot(),it=_.distance(Ue,Fe)),re[Le]=Fe);const et=(st-We)/it,qe=St.sub(at)._mult(et)._add(at),Xe=_.sub([],Fe,Ue),Mt=_.scaleAndAdd([],Ue,Xe,et);let Rt=[0,0,1],dn=Xe[0],Wn=Xe[1];if(ue&&(Rt=ve.upVector(xe.canonical,qe.x,qe.y),0!==Rt[0]||0!==Rt[1]||1!==Rt[2])){const Yt=[Rt[2],0,-Rt[0]],yn=_.cross([],Rt,Yt);_.normalize(Yt,Yt),_.normalize(yn,yn),dn=_.dot(Xe,Yt),Wn=_.dot(Xe,yn)}if(g){const Yt=_.cross([],Rt,Xe);_.normalize(Yt,Yt),_.scaleAndAdd(Mt,Mt,Yt,g*be)}const _n=Me+Math.atan2(Wn,dn);return Ut.push(Mt),_e&&Qe.push(qe),{point:Mt,angle:_n,path:Ut,tilePath:Qe,up:Rt}}function Ui(v,c){const g=c.length,C=g+4*v;c.resize(C),c.float32.fill(-1/0,4*g,4*C)}function cd(v,c,g){const C=c[0],S=c[1];return v[0]=g[0]*C+g[4]*S+g[12],v[1]=g[1]*C+g[5]*S+g[13],v[3]=g[3]*C+g[7]*S+g[15],v}const fo=100;class cs{constructor(c,g,C=new rh(c.width+200,c.height+200,25),S=new rh(c.width+200,c.height+200,25)){this.transform=c,this.grid=C,this.ignoredGrid=S,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+fo,this.screenBottomBoundary=c.height+fo,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.fogState=g}placeCollisionBox(c,g,C,S,D,L,z,G){let J=C.projectedAnchorX,ee=C.projectedAnchorY,re=C.projectedAnchorZ;const fe=C.elevation,_e=C.tileID,de=c.getProjection();if(fe&&_e){const[Fe,Ue,We]=de.upVector(_e.canonical,C.tileAnchorX,C.tileAnchorY),it=de.upVectorScale(_e.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;J+=Fe*fe*it,ee+=Ue*fe*it,re+=We*fe*it}const ve=this.projectAndGetPerspectiveRatio(z,J,ee,re,C.tileID,"globe"===de.name||!!fe||this.transform.pitch>0,de),xe=L*ve.perspectiveRatio,ue=(C.x1*g+S.x-C.padding)*xe+ve.point.x,Ce=(C.y1*g+S.y-C.padding)*xe+ve.point.y,be=(C.x2*g+S.x+C.padding)*xe+ve.point.x,Me=(C.y2*g+S.y+C.padding)*xe+ve.point.y,Le=ve.perspectiveRatio<=.55||ve.occluded;return!this.isInsideGrid(ue,Ce,be,Me)||!D&&this.grid.hitTest(ue,Ce,be,Me,G)||Le?{box:[],offscreen:!1,occluded:ve.occluded}:{box:[ue,Ce,be,Me],offscreen:this.isOffscreen(ue,Ce,be,Me),occluded:!1}}placeCollisionCircles(c,g,C,S,D,L,z,G,J,ee,re,fe,_e,de,ve){const xe=[],ue=this.transform.elevation,Ce=c.getProjection(),be=ue?ue.getAtTileOffsetFunc(ve,this.transform.center.lat,this.transform.worldSize,Ce):null,Me=new _.pointGeometry(C.tileAnchorX,C.tileAnchorY);let{x:Le,y:Fe,z:Ue}=Ce.projectTilePoint(Me.x,Me.y,ve.canonical);if(be){const[qe,Xe,Mt]=be(Me);Le+=qe,Fe+=Xe,Ue+=Mt}const We="globe"===Ce.name,it=this.projectAndGetPerspectiveRatio(z,Le,Fe,Ue,ve,We||!!ue||this.transform.pitch>0,Ce),{perspectiveRatio:st}=it,Ut=(re?L/st:L*st)/_.ONE_EM,Qe=Ft(Le,Fe,Ue,G),St=it.signedDistanceFromCamera>0?Ds(Ut,D,C.lineOffsetX*Ut,C.lineOffsetY*Ut,!1,Qe,Me,C,S,G,{},ue&&!re?be:null,re&&!!ue,Ce,ve,re):null;let at=!1,Ot=!1,et=!0;if(St&&!it.occluded){const qe=.5*_e*st+de,Xe=new _.pointGeometry(-100,-100),Mt=new _.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Rt=new qa,{first:dn,last:Wn}=St,_n=dn.path.length;let Yt=[];for(let Vn=_n-1;Vn>=1;Vn--)Yt.push(dn.path[Vn]);for(let Vn=1;Vn<Wn.path.length;Vn++)Yt.push(Wn.path[Vn]);const yn=2.5*qe;J&&(Yt=Yt.map(([Vn,er,Ri],or)=>(be&&!We&&(Ri=be(or<_n-1?dn.tilePath[_n-1-or]:Wn.tilePath[or-_n+2])[2]),Ft(Vn,er,Ri,J))),Yt.some(Vn=>Vn[3]<=0)&&(Yt=[]));let xi=[];if(Yt.length>0){let Vn=1/0,er=-1/0,Ri=1/0,or=-1/0;for(const vi of Yt)Vn=Math.min(Vn,vi[0]),Ri=Math.min(Ri,vi[1]),er=Math.max(er,vi[0]),or=Math.max(or,vi[1]);er>=Xe.x&&Vn<=Mt.x&&or>=Xe.y&&Ri<=Mt.y&&(xi=[Yt.map(vi=>new _.pointGeometry(vi[0],vi[1]))],(Vn<Xe.x||er>Mt.x||Ri<Xe.y||or>Mt.y)&&(xi=_.clipLine(xi,Xe.x,Xe.y,Mt.x,Mt.y)))}for(const Vn of xi){Rt.reset(Vn,.25*qe);let er=0;er=Rt.length<=.5*qe?1:Math.ceil(Rt.paddedLength/yn)+1;for(let Ri=0;Ri<er;Ri++){const or=Ri/Math.max(er-1,1),vi=Rt.lerp(or),Dr=vi.x+fo,Ws=vi.y+fo;xe.push(Dr,Ws,qe,0);const $s=Dr-qe,ka=Ws-qe,Tr=Dr+qe,sr=Ws+qe;if(et=et&&this.isOffscreen($s,ka,Tr,sr),Ot=Ot||this.isInsideGrid($s,ka,Tr,sr),!g&&this.grid.hitTestCircle(Dr,Ws,qe,fe)&&(at=!0,!ee))return{circles:[],offscreen:!1,collisionDetected:at,occluded:!1}}}}return{circles:!ee&&at||!Ot?[]:xe,offscreen:et,collisionDetected:at,occluded:it.occluded}}queryRenderedSymbols(c){if(0===c.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const g=[];let C=1/0,S=1/0,D=-1/0,L=-1/0;for(const ee of c){const re=new _.pointGeometry(ee.x+fo,ee.y+fo);C=Math.min(C,re.x),S=Math.min(S,re.y),D=Math.max(D,re.x),L=Math.max(L,re.y),g.push(re)}const z=this.grid.query(C,S,D,L).concat(this.ignoredGrid.query(C,S,D,L)),G={},J={};for(const ee of z){const re=ee.key;if(void 0===G[re.bucketInstanceId]&&(G[re.bucketInstanceId]={}),G[re.bucketInstanceId][re.featureIndex])continue;const fe=[new _.pointGeometry(ee.x1,ee.y1),new _.pointGeometry(ee.x2,ee.y1),new _.pointGeometry(ee.x2,ee.y2),new _.pointGeometry(ee.x1,ee.y2)];_.polygonIntersectsPolygon(g,fe)&&(G[re.bucketInstanceId][re.featureIndex]=!0,void 0===J[re.bucketInstanceId]&&(J[re.bucketInstanceId]=[]),J[re.bucketInstanceId].push(re.featureIndex))}return J}insertCollisionBox(c,g,C,S,D){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:S,collisionGroupID:D},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,g,C,S,D){const L=g?this.ignoredGrid:this.grid,z={bucketInstanceId:C,featureIndex:S,collisionGroupID:D};for(let G=0;G<c.length;G+=4)L.insertCircle(z,c[G],c[G+1],c[G+2])}projectAndGetPerspectiveRatio(c,g,C,S,D,L,z){const G=[g,C,S,1];let J=!1;S||this.transform.pitch>0?(_.transformMat4$1(G,G,c),this.fogState&&D&&"globe"!==z.name&&(J=function(_e,de,ve,xe,ue,Ce){const be=Ce.calculateFogTileMatrix(ue),Me=[de,ve,xe];return _.transformMat4(Me,Me,be),On(_e,Me,Ce.pitch,Ce._fov)}(this.fogState,g,C,S,D.toUnwrapped(),this.transform)>.9)):cd(G,G,c);const ee=G[3];return{point:new _.pointGeometry((G[0]/ee+1)/2*this.transform.width+fo,(-G[1]/ee+1)/2*this.transform.height+fo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(z)/ee*.5,1.5),signedDistanceFromCamera:ee,occluded:L&&G[2]>ee||J}}isOffscreen(c,g,C,S){return C<fo||c>=this.screenRightBoundary||S<fo||g>this.screenBottomBoundary}isInsideGrid(c,g,C,S){return C>=0&&c<this.gridRightBoundary&&S>=0&&g<this.gridBottomBoundary}getViewportMatrix(){const c=_.identity([]);return _.translate(c,c,[-100,-100,0]),c}}function Vs(v,c,g){const C=c.createTileMatrix(v,v.worldSize,g.toUnwrapped());return _.multiply(new Float32Array(16),v.projMatrix,C)}function sa(v,c,g){if(c.projection.name===g.projection.name)return v.projMatrix;const C=g.clone();return C.setProjection(c.projection),Vs(C,c.getProjection(),v)}function Co(v,c,g){return c.name===g.projection.name?v.projMatrix:Vs(g,c,v)}class aa{constructor(c,g,C,S){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?g:-g))):S&&C?1:0,this.placed=C}isHidden(){return 0===this.opacity&&!this.placed}}class Ac{constructor(c,g,C,S,D,L=!1){this.text=new aa(c?c.text:null,g,C,D),this.icon=new aa(c?c.icon:null,g,S,D),this.clipped=L}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class yi{constructor(c,g,C,S=!1){this.text=c,this.icon=g,this.skipFade=C,this.clipped=S}}class Mp{constructor(){this.invProjMatrix=_.create(),this.viewportMatrix=_.create(),this.circles=[]}}class Ko{constructor(c,g,C,S,D){this.bucketInstanceId=c,this.featureIndex=g,this.sourceLayerIndex=C,this.bucketIndex=S,this.tileID=D}}class to{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const g=++this.maxGroupID;this.collisionGroups[c]={ID:g,predicate:C=>C.collisionGroupID===g}}return this.collisionGroups[c]}}function yl(v,c,g,C,S){const{horizontalAlign:D,verticalAlign:L}=_.getAnchorAlignment(v),z=-(D-.5)*c,G=-(L-.5)*g,J=_.evaluateVariableOffset(v,C);return new _.pointGeometry(z+J[0]*S,G+J[1]*S)}function Kl(v,c,g,C,S){const D=new _.pointGeometry(v,c);return g&&D._rotate(C?S:-S),D}class Eo{constructor(c,g,C,S,D){this.transform=c.clone(),this.projection=c.projection.name,this.collisionIndex=new cs(this.transform,D),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new to(C),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,g,C,S){const D=C.getBucket(g),L=C.latestFeatureIndex;if(!D||!L||g.id!==D.layerIds[0])return;const z=D.layers[0].layout,G=C.collisionBoxArray,J=Math.pow(2,this.transform.zoom-C.tileID.overscaledZ),ee=C.tileSize/_.EXTENT,re=C.tileID.toUnwrapped();this.transform.setProjection(D.projection);const fe=(_e=C.tileID,de=D.getProjection(),ve=this.transform,de.name===this.projection?ve.calculateProjMatrix(_e.toUnwrapped()):Vs(ve,de,_e));var _e,de,ve;const xe="map"===z.get("text-pitch-alignment"),ue="map"===z.get("text-rotation-alignment");g.compileFilter();const Ce=g.dynamicFilter(),be=g.dynamicFilterNeedsFeature(),Me=this.transform.calculatePixelsToTileUnitsMatrix(C),Le=Mn(fe,C.tileID.canonical,xe,ue,this.transform,D.getProjection(),Me);let Fe=null;if(xe){const it=Ti(fe,C.tileID.canonical,xe,ue,this.transform,D.getProjection(),Me);Fe=_.multiply([],this.transform.labelPlaneMatrix,it)}let Ue=null;Ce&&C.latestFeatureIndex&&(Ue={unwrappedTileID:re,dynamicFilter:Ce,dynamicFilterNeedsFeature:be,featureIndex:C.latestFeatureIndex}),this.retainedQueryData[D.bucketInstanceId]=new Ko(D.bucketInstanceId,L,D.sourceLayerIndex,D.index,C.tileID);const We={bucket:D,layout:z,posMatrix:fe,textLabelPlaneMatrix:Le,labelToScreenMatrix:Fe,clippingData:Ue,scale:J,textPixelRatio:ee,holdingForFade:C.holdingForFade(),collisionBoxArray:G,partiallyEvaluatedTextSize:_.evaluateSizeForZoom(D.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:_.evaluateSizeForZoom(D.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(D.sourceID)};if(S)for(const it of D.sortKeyRanges){const{sortKey:st,symbolInstanceStart:Ut,symbolInstanceEnd:Qe}=it;c.push({sortKey:st,symbolInstanceStart:Ut,symbolInstanceEnd:Qe,parameters:We})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:D.symbolInstances.length,parameters:We})}attemptAnchorPlacement(c,g,C,S,D,L,z,G,J,ee,re,fe,_e,de,ve,xe,ue,Ce){const{textOffset0:be,textOffset1:Me,crossTileID:Le}=fe,Fe=[be,Me],Ue=yl(c,C,S,Fe,D),We=this.collisionIndex.placeCollisionBox(de,D,g,Kl(Ue.x,Ue.y,L,z,this.transform.angle),re,G,J,ee.predicate);if(xe){const it=de.getSymbolInstanceIconSize(Ce,this.transform.zoom,fe.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(de,it,xe,Kl(Ue.x,Ue.y,L,z,this.transform.angle),re,G,J,ee.predicate).box.length)return}if(We.box.length>0){let it;return this.prevPlacement&&this.prevPlacement.variableOffsets[Le]&&this.prevPlacement.placements[Le]&&this.prevPlacement.placements[Le].text&&(it=this.prevPlacement.variableOffsets[Le].anchor),this.variableOffsets[Le]={textOffset:Fe,width:C,height:S,anchor:c,textScale:D,prevAnchor:it},this.markUsedJustification(de,c,fe,ve),de.allowVerticalPlacement&&(this.markUsedOrientation(de,ve,fe),this.placedOrientations[Le]=ve),{shift:Ue,placedGlyphBoxes:We}}}placeLayerBucketPart(c,g,C,S){const{bucket:D,layout:L,posMatrix:z,textLabelPlaneMatrix:G,labelToScreenMatrix:J,clippingData:ee,textPixelRatio:re,holdingForFade:fe,collisionBoxArray:_e,partiallyEvaluatedTextSize:de,partiallyEvaluatedIconSize:ve,collisionGroup:xe}=c.parameters,ue=L.get("text-optional"),Ce=L.get("icon-optional"),be=L.get("text-allow-overlap"),Me=L.get("icon-allow-overlap"),Le="map"===L.get("text-rotation-alignment"),Fe="map"===L.get("text-pitch-alignment"),Ue="none"!==L.get("icon-text-fit"),We="viewport-y"===L.get("symbol-z-order");this.transform.setProjection(D.projection);let it=be&&(Me||!D.hasIconData()||Ce),st=Me&&(be||!D.hasTextData()||ue);!D.collisionArrays&&_e&&D.deserializeCollisionBoxes(_e),C&&S&&D.updateCollisionDebugBuffers(this.transform.zoom,_e);const Ut=(Qe,St,at)=>{const{crossTileID:Ot,numVerticalGlyphVertices:et}=Qe;if(ee){const Tr={zoom:this.transform.zoom,pitch:this.transform.pitch};let sr=null;if(ee.dynamicFilterNeedsFeature){const Yi=this.retainedQueryData[D.bucketInstanceId];sr=ee.featureIndex.loadFeature({featureIndex:Qe.featureIndex,bucketIndex:Yi.bucketIndex,sourceLayerIndex:Yi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,ee.dynamicFilter)(Tr,sr,this.retainedQueryData[D.bucketInstanceId].tileID.canonical,new _.pointGeometry(Qe.tileAnchorX,Qe.tileAnchorY),this.transform.calculateDistanceTileData(ee.unwrappedTileID)))return this.placements[Ot]=new yi(!1,!1,!1,!0),void(g[Ot]=!0)}if(g[Ot])return;if(fe)return void(this.placements[Ot]=new yi(!1,!1,!1));let qe=!1,Xe=!1,Mt=!0,Rt=!1,dn=!1,Wn=null,_n={box:null,offscreen:null,occluded:null},Yt={box:null,offscreen:null,occluded:null},yn=null,xi=null,Vn=null,er=0,Ri=0,or=0;at.textFeatureIndex?er=at.textFeatureIndex:Qe.useRuntimeCollisionCircles&&(er=Qe.featureIndex),at.verticalTextFeatureIndex&&(Ri=at.verticalTextFeatureIndex);const vi=Tr=>{Tr.tileID=this.retainedQueryData[D.bucketInstanceId].tileID;const sr=this.transform.elevation;(sr||Tr.elevation)&&(Tr.elevation=sr?sr.getAtTileOffset(Tr.tileID,Tr.tileAnchorX,Tr.tileAnchorY):0)},Dr=at.textBox;if(Dr){vi(Dr);const Tr=Yi=>{let Fr=_.WritingMode.horizontal;if(D.allowVerticalPlacement&&!Yi&&this.prevPlacement){const Qn=this.prevPlacement.placedOrientations[Ot];Qn&&(this.placedOrientations[Ot]=Qn,Fr=Qn,this.markUsedOrientation(D,Fr,Qe))}return Fr},sr=(Yi,Fr)=>{if(D.allowVerticalPlacement&&et>0&&at.verticalTextBox){for(const Qn of D.writingModes)if(Qn===_.WritingMode.vertical?(_n=Fr(),Yt=_n):_n=Yi(),_n&&_n.box&&_n.box.length)break}else _n=Yi()};if(L.get("text-variable-anchor")){let Yi=L.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ot]){const Fi=this.prevPlacement.variableOffsets[Ot];Yi.indexOf(Fi.anchor)>0&&(Yi=Yi.filter(bs=>bs!==Fi.anchor),Yi.unshift(Fi.anchor))}const Fr=(Fi,bs,mo)=>{const oc=D.getSymbolInstanceTextSize(de,Qe,this.transform.zoom,St),Qc=(Fi.x2-Fi.x1)*oc+2*Fi.padding,Wr=(Fi.y2-Fi.y1)*oc+2*Fi.padding,Ys=Ue&&!Me?bs:null;Ys&&vi(Ys);let ma={box:[],offscreen:!1,occluded:!1};const Al=be?2*Yi.length:Yi.length;for(let el=0;el<Al;++el){const go=this.attemptAnchorPlacement(Yi[el%Yi.length],Fi,Qc,Wr,oc,Le,Fe,re,z,xe,el>=Yi.length,Qe,St,D,mo,Ys,de,ve);if(go&&(ma=go.placedGlyphBoxes,ma&&ma.box&&ma.box.length)){qe=!0,Wn=go.shift;break}}return ma};sr(()=>Fr(Dr,at.iconBox,_.WritingMode.horizontal),()=>{const Fi=at.verticalTextBox;return Fi&&vi(Fi),D.allowVerticalPlacement&&!(_n&&_n.box&&_n.box.length)&&et>0&&Fi?Fr(Fi,at.verticalIconBox,_.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),_n&&(qe=_n.box,Mt=_n.offscreen,Rt=_n.occluded);const Qn=Tr(_n&&_n.box);if(!qe&&this.prevPlacement){const Fi=this.prevPlacement.variableOffsets[Ot];Fi&&(this.variableOffsets[Ot]=Fi,this.markUsedJustification(D,Fi.anchor,Qe,Qn))}}else{const Yi=(Fr,Qn)=>{const Fi=D.getSymbolInstanceTextSize(de,Qe,this.transform.zoom,St),bs=this.collisionIndex.placeCollisionBox(D,Fi,Fr,new _.pointGeometry(0,0),be,re,z,xe.predicate);return bs&&bs.box&&bs.box.length&&(this.markUsedOrientation(D,Qn,Qe),this.placedOrientations[Ot]=Qn),bs};sr(()=>Yi(Dr,_.WritingMode.horizontal),()=>{const Fr=at.verticalTextBox;return D.allowVerticalPlacement&&et>0&&Fr?(vi(Fr),Yi(Fr,_.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Tr(_n&&_n.box&&_n.box.length)}}if(yn=_n,qe=yn&&yn.box&&yn.box.length>0,Mt=yn&&yn.offscreen,Rt=yn&&yn.occluded,Qe.useRuntimeCollisionCircles){const Tr=D.text.placedSymbolArray.get(Qe.centerJustifiedTextSymbolIndex>=0?Qe.centerJustifiedTextSymbolIndex:Qe.verticalPlacedTextSymbolIndex),sr=_.evaluateSizeForFeature(D.textSizeData,de,Tr),Yi=L.get("text-padding");xi=this.collisionIndex.placeCollisionCircles(D,be,Tr,D.lineVertexArray,D.glyphOffsetArray,sr,z,G,J,C,Fe,xe.predicate,Qe.collisionCircleDiameter*sr/_.ONE_EM,Yi,this.retainedQueryData[D.bucketInstanceId].tileID),qe=be||xi.circles.length>0&&!xi.collisionDetected,Mt=Mt&&xi.offscreen,Rt=xi.occluded}if(at.iconFeatureIndex&&(or=at.iconFeatureIndex),at.iconBox){const Tr=sr=>{vi(sr);const Yi=Ue&&Wn?Kl(Wn.x,Wn.y,Le,Fe,this.transform.angle):new _.pointGeometry(0,0),Fr=D.getSymbolInstanceIconSize(ve,this.transform.zoom,Qe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(D,Fr,sr,Yi,Me,re,z,xe.predicate)};Yt&&Yt.box&&Yt.box.length&&at.verticalIconBox?(Vn=Tr(at.verticalIconBox),Xe=Vn.box.length>0):(Vn=Tr(at.iconBox),Xe=Vn.box.length>0),Mt=Mt&&Vn.offscreen,dn=Vn.occluded}const Ws=ue||0===Qe.numHorizontalGlyphVertices&&0===et,$s=Ce||0===Qe.numIconVertices;if(Ws||$s?$s?Ws||(Xe=Xe&&qe):qe=Xe&&qe:Xe=qe=Xe&&qe,qe&&yn&&yn.box&&this.collisionIndex.insertCollisionBox(yn.box,L.get("text-ignore-placement"),D.bucketInstanceId,Yt&&Yt.box&&Ri?Ri:er,xe.ID),Xe&&Vn&&this.collisionIndex.insertCollisionBox(Vn.box,L.get("icon-ignore-placement"),D.bucketInstanceId,or,xe.ID),xi&&(qe&&this.collisionIndex.insertCollisionCircles(xi.circles,L.get("text-ignore-placement"),D.bucketInstanceId,er,xe.ID),C)){const Tr=D.bucketInstanceId;let sr=this.collisionCircleArrays[Tr];void 0===sr&&(sr=this.collisionCircleArrays[Tr]=new Mp);for(let Yi=0;Yi<xi.circles.length;Yi+=4)sr.circles.push(xi.circles[Yi+0]),sr.circles.push(xi.circles[Yi+1]),sr.circles.push(xi.circles[Yi+2]),sr.circles.push(xi.collisionDetected?1:0)}const ka="globe"!==D.projection.name;it=it&&(ka||!Rt),st=st&&(ka||!dn),this.placements[Ot]=new yi(qe||it,Xe||st,Mt||D.justReloaded),g[Ot]=!0};if(We){const Qe=D.getSortedSymbolIndexes(this.transform.angle);for(let St=Qe.length-1;St>=0;--St){const at=Qe[St];Ut(D.symbolInstances.get(at),at,D.collisionArrays[at])}}else for(let Qe=c.symbolInstanceStart;Qe<c.symbolInstanceEnd;Qe++)Ut(D.symbolInstances.get(Qe),Qe,D.collisionArrays[Qe]);if(C&&D.bucketInstanceId in this.collisionCircleArrays){const Qe=this.collisionCircleArrays[D.bucketInstanceId];_.invert(Qe.invProjMatrix,z),Qe.viewportMatrix=this.collisionIndex.getViewportMatrix()}D.justReloaded=!1}markUsedJustification(c,g,C,S){const{leftJustifiedTextSymbolIndex:D,centerJustifiedTextSymbolIndex:L,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:G,crossTileID:J}=C,ee=_.getAnchorJustification(g),re=S===_.WritingMode.vertical?G:"left"===ee?D:"center"===ee?L:"right"===ee?z:-1;D>=0&&(c.text.placedSymbolArray.get(D).crossTileID=re>=0&&D!==re?0:J),L>=0&&(c.text.placedSymbolArray.get(L).crossTileID=re>=0&&L!==re?0:J),z>=0&&(c.text.placedSymbolArray.get(z).crossTileID=re>=0&&z!==re?0:J),G>=0&&(c.text.placedSymbolArray.get(G).crossTileID=re>=0&&G!==re?0:J)}markUsedOrientation(c,g,C){const S=g===_.WritingMode.horizontal||g===_.WritingMode.horizontalOnly?g:0,D=g===_.WritingMode.vertical?g:0,{leftJustifiedTextSymbolIndex:L,centerJustifiedTextSymbolIndex:z,rightJustifiedTextSymbolIndex:G,verticalPlacedTextSymbolIndex:J}=C,ee=c.text.placedSymbolArray;L>=0&&(ee.get(L).placedOrientation=S),z>=0&&(ee.get(z).placedOrientation=S),G>=0&&(ee.get(G).placedOrientation=S),J>=0&&(ee.get(J).placedOrientation=D)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const g=this.prevPlacement;let C=!1;this.prevZoomAdjustment=g?g.zoomAdjustment(this.transform.zoom):0;const S=g?g.symbolFadeChange(c):1,D=g?g.opacities:{},L=g?g.variableOffsets:{},z=g?g.placedOrientations:{};for(const G in this.placements){const J=this.placements[G],ee=D[G];ee?(this.opacities[G]=new Ac(ee,S,J.text,J.icon,null,J.clipped),C=C||J.text!==ee.text.placed||J.icon!==ee.icon.placed):(this.opacities[G]=new Ac(null,S,J.text,J.icon,J.skipFade,J.clipped),C=C||J.text||J.icon)}for(const G in D){const J=D[G];if(!this.opacities[G]){const ee=new Ac(J,S,!1,!1);ee.isHidden()||(this.opacities[G]=ee,C=C||J.text.placed||J.icon.placed)}}for(const G in L)this.variableOffsets[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.variableOffsets[G]=L[G]);for(const G in z)this.placedOrientations[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.placedOrientations[G]=z[G]);C?this.lastPlacementChangeTime=c:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=g?g.lastPlacementChangeTime:c)}updateLayerOpacities(c,g){const C={};for(const S of g){const D=S.getBucket(c);D&&S.latestFeatureIndex&&c.id===D.layerIds[0]&&this.updateBucketOpacities(D,C,S.collisionBoxArray)}}updateBucketOpacities(c,g,C){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const S=c.layers[0].layout,D=!!c.layers[0].dynamicFilter(),L=new Ac(null,0,!1,!1,!0),z=S.get("text-allow-overlap"),G=S.get("icon-allow-overlap"),J=S.get("text-variable-anchor"),ee="map"===S.get("text-rotation-alignment"),re="map"===S.get("text-pitch-alignment"),fe="none"!==S.get("icon-text-fit"),_e=new Ac(null,0,z&&(G||!c.hasIconData()||S.get("icon-optional")),G&&(z||!c.hasTextData()||S.get("text-optional")),!0);!c.collisionArrays&&C&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(C);const de=(xe,ue,Ce)=>{for(let be=0;be<ue/4;be++)xe.opacityVertexArray.emplaceBack(Ce)};let ve=0;for(let xe=0;xe<c.symbolInstances.length;xe++){const ue=c.symbolInstances.get(xe),{numHorizontalGlyphVertices:Ce,numVerticalGlyphVertices:be,crossTileID:Me,numIconVertices:Le}=ue;let Fe=this.opacities[Me];g[Me]?Fe=L:Fe||(Fe=_e,this.opacities[Me]=Fe),g[Me]=!0;const Ue=Ce>0||be>0,We=Le>0,it=this.placedOrientations[Me],st=it===_.WritingMode.vertical,Ut=it===_.WritingMode.horizontal||it===_.WritingMode.horizontalOnly;if(!Ue&&!We||Fe.isHidden()||ve++,Ue){const Qe=gu(Fe.text);de(c.text,Ce,st?Zs:Qe),de(c.text,be,Ut?Zs:Qe);const St=Fe.text.isHidden(),{leftJustifiedTextSymbolIndex:at,centerJustifiedTextSymbolIndex:Ot,rightJustifiedTextSymbolIndex:et,verticalPlacedTextSymbolIndex:qe}=ue,Xe=c.text.placedSymbolArray,Mt=St||st?1:0;at>=0&&(Xe.get(at).hidden=Mt),Ot>=0&&(Xe.get(Ot).hidden=Mt),et>=0&&(Xe.get(et).hidden=Mt),qe>=0&&(Xe.get(qe).hidden=St||Ut?1:0);const Rt=this.variableOffsets[Me];Rt&&this.markUsedJustification(c,Rt.anchor,ue,it);const dn=this.placedOrientations[Me];dn&&(this.markUsedJustification(c,"left",ue,dn),this.markUsedOrientation(c,dn,ue))}if(We){const Qe=gu(Fe.icon),{placedIconSymbolIndex:St,verticalPlacedIconSymbolIndex:at}=ue,Ot=c.icon.placedSymbolArray,et=Fe.icon.isHidden()?1:0;St>=0&&(de(c.icon,Le,st?Zs:Qe),Ot.get(St).hidden=et),at>=0&&(de(c.icon,ue.numVerticalIconVertices,Ut?Zs:Qe),Ot.get(at).hidden=et)}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const Qe=c.collisionArrays[xe];if(Qe){let St=new _.pointGeometry(0,0),at=!0;if(Qe.textBox||Qe.verticalTextBox){if(J){const et=this.variableOffsets[Me];et?(St=yl(et.anchor,et.width,et.height,et.textOffset,et.textScale),ee&&St._rotate(re?this.transform.angle:-this.transform.angle)):at=!1}D&&(at=!Fe.clipped),Qe.textBox&&Er(c.textCollisionBox.collisionVertexArray,Fe.text.placed,!at||st,St.x,St.y),Qe.verticalTextBox&&Er(c.textCollisionBox.collisionVertexArray,Fe.text.placed,!at||Ut,St.x,St.y)}const Ot=at&&Boolean(!Ut&&Qe.verticalIconBox);Qe.iconBox&&Er(c.iconCollisionBox.collisionVertexArray,Fe.icon.placed,Ot,fe?St.x:0,fe?St.y:0),Qe.verticalIconBox&&Er(c.iconCollisionBox.collisionVertexArray,Fe.icon.placed,!Ot,fe?St.x:0,fe?St.y:0)}}}if(c.fullyClipped=0===ve,c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){const xe=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=xe.invProjMatrix,c.placementViewportMatrix=xe.viewportMatrix,c.collisionCircleArray=xe.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return 0===this.fadeDuration?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,g){const C=this.zoomAtLastRecencyCheck===g?1-this.zoomAdjustment(g):1;return this.zoomAtLastRecencyCheck=g,this.commitTime+this.fadeDuration*C>c}setStale(){this.stale=!0}}function Er(v,c,g,C,S){v.emplaceBack(c?1:0,g?1:0,C||0,S||0),v.emplaceBack(c?1:0,g?1:0,C||0,S||0),v.emplaceBack(c?1:0,g?1:0,C||0,S||0),v.emplaceBack(c?1:0,g?1:0,C||0,S||0)}const Xm=Math.pow(2,25),Xo=Math.pow(2,24),Ji=Math.pow(2,17),Pc=Math.pow(2,16),Oc=Math.pow(2,9),Us=Math.pow(2,8),Br=Math.pow(2,1);function gu(v){if(0===v.opacity&&!v.placed)return 0;if(1===v.opacity&&v.placed)return 4294967295;const c=v.placed?1:0,g=Math.floor(127*v.opacity);return g*Xm+c*Xo+g*Ji+c*Pc+g*Oc+c*Us+g*Br+c}const Zs=0;class js{constructor(c){this._sortAcrossTiles="viewport-y"!==c.layout.get("symbol-z-order")&&void 0!==c.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,g,C,S,D){const L=this._bucketParts;for(;this._currentTileIndex<c.length;)if(g.getBucketParts(L,S,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,D())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((z,G)=>z.sortKey-G.sortKey));this._currentPartIndex<L.length;){const z=L[this._currentPartIndex];if(g.placeLayerBucketPart(z,this._seenCrossTileIDs,C,0===z.symbolInstanceStart),this._currentPartIndex++,D())return!0}return!1}}class vl{constructor(c,g,C,S,D,L,z,G){this.placement=new Eo(c,D,L,z,G),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(c,g,C){const S=_.exported.now(),D=()=>{const L=_.exported.now()-S;return!this._forceFullPlacement&&L>2};for(;this._currentPlacementIndex>=0;){const L=g[c[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if("symbol"===L.type&&(!L.minzoom||L.minzoom<=z)&&(!L.maxzoom||L.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new js(L)),this._inProgressLayer.continuePlacement(C[L.source],this.placement,this._showCollisionBoxes,L,D))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const _f=512/_.EXTENT/2;class Qm{constructor(c,g,C){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=C;for(let S=0;S<g.length;S++){const D=g.get(S),L=D.key;this.indexedSymbolInstances[L]||(this.indexedSymbolInstances[L]=[]),this.indexedSymbolInstances[L].push({crossTileID:D.crossTileID,coord:this.getScaledCoordinates(D,c)})}}getScaledCoordinates(c,g){const C=_f/Math.pow(2,g.canonical.z-this.tileID.canonical.z);return{x:Math.floor((g.canonical.x*_.EXTENT+c.tileAnchorX)*C),y:Math.floor((g.canonical.y*_.EXTENT+c.tileAnchorY)*C)}}findMatches(c,g,C){const S=this.tileID.canonical.z<g.canonical.z?1:Math.pow(2,this.tileID.canonical.z-g.canonical.z);for(let D=0;D<c.length;D++){const L=c.get(D);if(L.crossTileID)continue;const z=this.indexedSymbolInstances[L.key];if(!z)continue;const G=this.getScaledCoordinates(L,g);for(const J of z)if(Math.abs(J.coord.x-G.x)<=S&&Math.abs(J.coord.y-G.y)<=S&&!C[J.crossTileID]){C[J.crossTileID]=!0,L.crossTileID=J.crossTileID;break}}}}class Dp{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ud{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const g=Math.round((c-this.lng)/360);if(0!==g)for(const C in this.indexes){const S=this.indexes[C],D={};for(const L in S){const z=S[L];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+g),D[z.tileID.key]=z}this.indexes[C]=D}this.lng=c}addBucket(c,g,C){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===g.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let D=0;D<g.symbolInstances.length;D++)g.symbolInstances.get(D).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const S=this.usedCrossTileIDs[c.overscaledZ];for(const D in this.indexes){const L=this.indexes[D];if(Number(D)>c.overscaledZ)for(const z in L){const G=L[z];G.tileID.isChildOf(c)&&G.findMatches(g.symbolInstances,c,S)}else{const z=L[c.scaledTo(Number(D)).key];z&&z.findMatches(g.symbolInstances,c,S)}}for(let D=0;D<g.symbolInstances.length;D++){const L=g.symbolInstances.get(D);L.crossTileID||(L.crossTileID=C.generate(),S[L.crossTileID]=!0)}return void 0===this.indexes[c.overscaledZ]&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Qm(c,g.symbolInstances,g.bucketInstanceId),!0}removeBucketCrossTileIDs(c,g){for(const C in g.indexedSymbolInstances)for(const S of g.indexedSymbolInstances[C])delete this.usedCrossTileIDs[c][S.crossTileID]}removeStaleBuckets(c){let g=!1;for(const C in this.indexes){const S=this.indexes[C];for(const D in S)c[S[D].bucketInstanceId]||(this.removeBucketCrossTileIDs(C,S[D]),delete S[D],g=!0)}return g}}class _u{constructor(){this.layerIndexes={},this.crossTileIDs=new Dp,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,g,C,S){let D=this.layerIndexes[c.id];void 0===D&&(D=this.layerIndexes[c.id]=new ud);let L=!1;const z={};"globe"!==S.name&&D.handleWrapJump(C);for(const G of g){const J=G.getBucket(c);J&&c.id===J.layerIds[0]&&(J.bucketInstanceId||(J.bucketInstanceId=++this.maxBucketInstanceId),D.addBucket(G.tileID,J,this.crossTileIDs)&&(L=!0),z[J.bucketInstanceId]=!0)}return D.removeStaleBuckets(z)&&(L=!0),L}pruneUnusedLayers(c){const g={};c.forEach(C=>{g[C]=!0});for(const C in this.layerIndexes)g[C]||delete this.layerIndexes[C]}}const yu=(v,c)=>_.emitValidationErrors(v,c&&c.filter(g=>"source.canvas"!==g.identifier)),Za=_.pick($n,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),vu=_.pick($n,["setCenter","setZoom","setBearing","setPitch"]),yf={version:8,layers:[],sources:{}},ys={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class no extends _.Evented{constructor(c,g={}){super(),this.map=c,this.dispatcher=new rn(ii(),this),this.imageManager=new un,this.imageManager.setEventedParent(this),this.glyphManager=new _.GlyphManager(c._requestManager,g.localFontFamily?_.LocalGlyphMode.all:g.localIdeographFontFamily?_.LocalGlyphMode.ideographs:_.LocalGlyphMode.none,g.localFontFamily||g.localIdeographFontFamily),this.crossTileSymbolIndex=new _u,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",_.getReferrer());const C=this;this._rtlTextPluginCallback=no.registerForPluginStateChange(S=>{C.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(D,L)=>{if(_.triggerPluginCompletionEvent(D),L&&L.every(z=>z))for(const z in C._sourceCaches){const G=C._sourceCaches[z],J=G.getSource().type;"vector"!==J&&"geojson"!==J||G.reload()}})}),this.on("data",S=>{if("source"!==S.dataType||"metadata"!==S.sourceDataType)return;const D=this.getSource(S.sourceId);if(D&&D.vectorLayerIds)for(const L in this._layers){const z=this._layers[L];z.source===D.id&&this._validateLayer(z)}})}loadURL(c,g={}){this.fire(new _.Event("dataloading",{dataType:"style"}));const C="boolean"==typeof g.validate?g.validate:!_.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,g.accessToken);const S=this.map._requestManager.transformRequest(c,_.ResourceType.Style);this._request=_.getJSON(S,(D,L)=>{this._request=null,D?this.fire(new _.ErrorEvent(D)):L&&this._load(L,C)})}loadJSON(c,g={}){this.fire(new _.Event("dataloading",{dataType:"style"})),this._request=_.exported.frame(()=>{this._request=null,this._load(c,!1!==g.validate)})}loadEmpty(){this.fire(new _.Event("dataloading",{dataType:"style"})),this._load(yf,!1)}_updateLayerCount(c,g){const C=g?1:-1;c.is3D()&&(this._num3DLayers+=C),"circle"===c.type&&(this._numCircleLayers+=C),"symbol"===c.type&&(this._numSymbolLayers+=C)}_load(c,g){if(g&&yu(this,_.validateStyle(c)))return;this._loaded=!0,this.stylesheet=_.clone$1(c),this._updateMapProjection();for(const S in c.sources)this.addSource(S,c.sources[S],{validate:!1});this._changed=!1,c.sprite?this._loadSprite(c.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(c.glyphs);const C=mi(this.stylesheet.layers);this._order=C.map(S=>S.id),this._layers={},this._serializedLayers={};for(let S of C)S=_.createStyleLayer(S),S.setEventedParent(this,{layer:{id:S.id}}),this._layers[S.id]=S,this._serializedLayers[S.id]=S.serialize(),this._updateLayerCount(S,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Nt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new _.Event("data",{dataType:"style"})),this.fire(new _.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(c){c?this.stylesheet.projection=c:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(c){this._spriteRequest=function(g,C,S){let D,L,z;const G=_.exported.devicePixelRatio>1?"@2x":"";let J=_.getJSON(C.transformRequest(C.normalizeSpriteURL(g,G,".json"),_.ResourceType.SpriteJSON),(fe,_e)=>{J=null,z||(z=fe,D=_e,re())}),ee=_.getImage(C.transformRequest(C.normalizeSpriteURL(g,G,".png"),_.ResourceType.SpriteImage),(fe,_e)=>{ee=null,z||(z=fe,L=_e,re())});function re(){if(z)S(z);else if(D&&L){const fe=_.exported.getImageData(L),_e={};for(const de in D){const{width:ve,height:xe,x:ue,y:Ce,sdf:be,pixelRatio:Me,stretchX:Le,stretchY:Fe,content:Ue}=D[de],We=new _.RGBAImage({width:ve,height:xe});_.RGBAImage.copy(fe,We,{x:ue,y:Ce},{x:0,y:0},{width:ve,height:xe}),_e[de]={data:We,pixelRatio:Me,sdf:be,stretchX:Le,stretchY:Fe,content:Ue}}S(null,_e)}}return{cancel(){J&&(J.cancel(),J=null),ee&&(ee.cancel(),ee=null)}}}(c,this.map._requestManager,(g,C)=>{if(this._spriteRequest=null,g)this.fire(new _.ErrorEvent(g));else if(C)for(const S in C)this.imageManager.addImage(S,C[S]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new _.Event("data",{dataType:"style"}))})}_validateLayer(c){const g=this.getSource(c.source);if(!g)return;const C=c.sourceLayer;C&&("geojson"===g.type||g.vectorLayerIds&&-1===g.vectorLayerIds.indexOf(C))&&this.fire(new _.ErrorEvent(new Error(`Source layer "${C}" does not exist on source "${g.id}" as specified by style layer "${c.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this._sourceCaches)if(!this._sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const g=[];for(const C of c){const S=this._layers[C];"custom"!==S.type&&g.push(S.serialize())}return g}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const c in this._sourceCaches)if(this._sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(c){return!!this.terrain&&("function"==typeof c.isLayerDraped?c.isLayerDraped():ys[c.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(c){if(!this._loaded)return;const g=this._changed;if(this._changed){const S=Object.keys(this._updatedLayers),D=Object.keys(this._removedLayers);(S.length||D.length)&&this._updateWorkerLayers(S,D);for(const L in this._updatedSources){const z=this._updatedSources[L];"reload"===z?this._reloadSource(L):"clear"===z&&this._clearSource(L)}this._updateTilesForChangedImages();for(const L in this._updatedPaintProps)this._layers[L].updateTransitions(c);this.light.updateTransitions(c),this.fog&&this.fog.updateTransitions(c),this._resetUpdates()}const C={};for(const S in this._sourceCaches){const D=this._sourceCaches[S];C[S]=D.used,D.used=!1}for(const S of this._order){const D=this._layers[S];if(D.recalculate(c,this._availableImages),!D.isHidden(c.zoom)){const z=this._getLayerSourceCache(D);z&&(z.used=!0)}const L=this.map.painter;if(L){const z=D.getProgramIds();if(!z)continue;const G=D.getProgramConfiguration(c.zoom);for(const J of z)L.useProgram(J,G)}}for(const S in C){const D=this._sourceCaches[S];C[S]!==D.used&&D.getSource().fire(new _.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light.recalculate(c),this.terrain&&this.terrain.recalculate(c),this.fog&&this.fog.recalculate(c),this.z=c.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),g&&this.fire(new _.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const g in this._sourceCaches)this._sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,g){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:g})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(c){if(this._checkLoaded(),yu(this,_.validateStyle(c)))return!1;(c=_.clone$1(c)).layers=mi(c.layers);const g=function(S,D){if(!S)return[{command:$n.setStyle,args:[D]}];let L=[];try{if(!$e(S.version,D.version))return[{command:$n.setStyle,args:[D]}];$e(S.center,D.center)||L.push({command:$n.setCenter,args:[D.center]}),$e(S.zoom,D.zoom)||L.push({command:$n.setZoom,args:[D.zoom]}),$e(S.bearing,D.bearing)||L.push({command:$n.setBearing,args:[D.bearing]}),$e(S.pitch,D.pitch)||L.push({command:$n.setPitch,args:[D.pitch]}),$e(S.sprite,D.sprite)||L.push({command:$n.setSprite,args:[D.sprite]}),$e(S.glyphs,D.glyphs)||L.push({command:$n.setGlyphs,args:[D.glyphs]}),$e(S.transition,D.transition)||L.push({command:$n.setTransition,args:[D.transition]}),$e(S.light,D.light)||L.push({command:$n.setLight,args:[D.light]}),$e(S.fog,D.fog)||L.push({command:$n.setFog,args:[D.fog]}),$e(S.projection,D.projection)||L.push({command:$n.setProjection,args:[D.projection]});const z={},G=[];!function(re,fe,_e,de){let ve;for(ve in fe=fe||{},re=re||{})re.hasOwnProperty(ve)&&(fe.hasOwnProperty(ve)||fr(ve,_e,de));for(ve in fe)fe.hasOwnProperty(ve)&&(re.hasOwnProperty(ve)?$e(re[ve],fe[ve])||("geojson"===re[ve].type&&"geojson"===fe[ve].type&&Rr(re,fe,ve)?_e.push({command:$n.setGeoJSONSourceData,args:[ve,fe[ve].data]}):Zi(ve,fe,_e,de)):hr(ve,fe,_e))}(S.sources,D.sources,G,z);const J=[];S.layers&&S.layers.forEach(re=>{re.source&&z[re.source]?L.push({command:$n.removeLayer,args:[re.id]}):J.push(re)});let ee=S.terrain;ee&&z[ee.source]&&(L.push({command:$n.setTerrain,args:[void 0]}),ee=void 0),L=L.concat(G),$e(ee,D.terrain)||L.push({command:$n.setTerrain,args:[D.terrain]}),function(re,fe,_e){fe=fe||[];const de=(re=re||[]).map(ko),ve=fe.map(ko),xe=re.reduce(ur,{}),ue=fe.reduce(ur,{}),Ce=de.slice(),be=Object.create(null);let Me,Le,Fe,Ue,We,it,st;for(Me=0,Le=0;Me<de.length;Me++)Fe=de[Me],ue.hasOwnProperty(Fe)?Le++:(_e.push({command:$n.removeLayer,args:[Fe]}),Ce.splice(Ce.indexOf(Fe,Le),1));for(Me=0,Le=0;Me<ve.length;Me++)Fe=ve[ve.length-1-Me],Ce[Ce.length-1-Me]!==Fe&&(xe.hasOwnProperty(Fe)?(_e.push({command:$n.removeLayer,args:[Fe]}),Ce.splice(Ce.lastIndexOf(Fe,Ce.length-Le),1)):Le++,it=Ce[Ce.length-Me],_e.push({command:$n.addLayer,args:[ue[Fe],it]}),Ce.splice(Ce.length-Me,0,Fe),be[Fe]=!0);for(Me=0;Me<ve.length;Me++)if(Fe=ve[Me],Ue=xe[Fe],We=ue[Fe],!be[Fe]&&!$e(Ue,We))if($e(Ue.source,We.source)&&$e(Ue["source-layer"],We["source-layer"])&&$e(Ue.type,We.type)){for(st in dt(Ue.layout,We.layout,_e,Fe,null,$n.setLayoutProperty),dt(Ue.paint,We.paint,_e,Fe,null,$n.setPaintProperty),$e(Ue.filter,We.filter)||_e.push({command:$n.setFilter,args:[Fe,We.filter]}),$e(Ue.minzoom,We.minzoom)&&$e(Ue.maxzoom,We.maxzoom)||_e.push({command:$n.setLayerZoomRange,args:[Fe,We.minzoom,We.maxzoom]}),Ue)Ue.hasOwnProperty(st)&&"layout"!==st&&"paint"!==st&&"filter"!==st&&"metadata"!==st&&"minzoom"!==st&&"maxzoom"!==st&&(0===st.indexOf("paint.")?dt(Ue[st],We[st],_e,Fe,st.slice(6),$n.setPaintProperty):$e(Ue[st],We[st])||_e.push({command:$n.setLayerProperty,args:[Fe,st,We[st]]}));for(st in We)We.hasOwnProperty(st)&&!Ue.hasOwnProperty(st)&&"layout"!==st&&"paint"!==st&&"filter"!==st&&"metadata"!==st&&"minzoom"!==st&&"maxzoom"!==st&&(0===st.indexOf("paint.")?dt(Ue[st],We[st],_e,Fe,st.slice(6),$n.setPaintProperty):$e(Ue[st],We[st])||_e.push({command:$n.setLayerProperty,args:[Fe,st,We[st]]}))}else _e.push({command:$n.removeLayer,args:[Fe]}),it=Ce[Ce.lastIndexOf(Fe)+1],_e.push({command:$n.addLayer,args:[We,it]})}(J,D.layers,L)}catch(z){console.warn("Unable to compute style diff:",z),L=[{command:$n.setStyle,args:[D]}]}return L}(this.serialize(),c).filter(S=>!(S.command in vu));if(0===g.length)return!1;const C=g.filter(S=>!(S.command in Za));if(C.length>0)throw new Error(`Unimplemented: ${C.map(S=>S.command).join(", ")}.`);return g.forEach(S=>{"setTransition"!==S.command&&"setProjection"!==S.command&&this[S.command].apply(this,S.args)}),this.stylesheet=c,this._updateMapProjection(),!0}addImage(c,g){return this.getImage(c)?this.fire(new _.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(c,g),this._afterImageUpdated(c),this)}updateImage(c,g){this.imageManager.updateImage(c,g)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){return this.getImage(c)?(this.imageManager.removeImage(c),this._afterImageUpdated(c),this):this.fire(new _.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new _.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(c,g,C={}){if(this._checkLoaded(),void 0!==this.getSource(c))throw new Error("There is already a source with this ID");if(!g.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(g).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(_.validateSource,`sources.${c}`,g,null,C))return;this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);const S=Be(c,g,this.dispatcher,this);S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(c),source:S.serialize(),sourceId:c}));const D=L=>{const z=(L?"symbol:":"other:")+c,G=this._sourceCaches[z]=new _.SourceCache(z,S,L);(L?this._symbolSourceCaches:this._otherSourceCaches)[c]=G,G.style=this,G.onAdd(this.map)};D(!1),"vector"!==g.type&&"geojson"!==g.type||D(!0),S.onAdd&&S.onAdd(this.map),this._changed=!0}removeSource(c){this._checkLoaded();const g=this.getSource(c);if(!g)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===c)return this.fire(new _.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.get().source===c)return this.fire(new _.ErrorEvent(new Error(`Source "${c}" cannot be removed while terrain is using it.`)));const C=this._getSourceCaches(c);for(const S of C)delete this._sourceCaches[S.id],delete this._updatedSources[S.id],S.fire(new _.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles();return delete this._otherSourceCaches[c],delete this._symbolSourceCaches[c],g.setEventedParent(null),g.onRemove&&g.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(c,g){this._checkLoaded(),this.getSource(c).setData(g),this._changed=!0}getSource(c){const g=this._getSourceCache(c);return g&&g.getSource()}_getSources(){const c=[];for(const g in this._otherSourceCaches){const C=this._getSourceCache(g);C&&c.push(C.getSource())}return c}addLayer(c,g,C={}){this._checkLoaded();const S=c.id;if(this.getLayer(S))return void this.fire(new _.ErrorEvent(new Error(`Layer with id "${S}" already exists on this map`)));let D;if("custom"===c.type){if(yu(this,_.validateCustomStyleLayer(c)))return;D=_.createStyleLayer(c)}else{if("object"==typeof c.source&&(this.addSource(S,c.source),c=_.clone$1(c),c=_.extend(c,{source:S})),this._validate(_.validateLayer,`layers.${S}`,c,{arrayIndex:-1},C))return;D=_.createStyleLayer(c),this._validateLayer(D),D.setEventedParent(this,{layer:{id:S}}),this._serializedLayers[D.id]=D.serialize(),this._updateLayerCount(D,!0)}const L=g?this._order.indexOf(g):this._order.length;if(g&&-1===L)return void this.fire(new _.ErrorEvent(new Error(`Layer with id "${g}" does not exist on this map.`)));this._order.splice(L,0,S),this._layerOrderChanged=!0,this._layers[S]=D;const z=this._getLayerSourceCache(D);if(this._removedLayers[S]&&D.source&&z&&"custom"!==D.type){const G=this._removedLayers[S];delete this._removedLayers[S],G.type!==D.type?this._updatedSources[D.source]="clear":(this._updatedSources[D.source]="reload",z.pause())}this._updateLayer(D),D.onAdd&&D.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(c,g){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===g)return;const C=this._order.indexOf(c);this._order.splice(C,1);const S=g?this._order.indexOf(g):this._order.length;g&&-1===S?this.fire(new _.ErrorEvent(new Error(`Layer with id "${g}" does not exist on this map.`))):(this._order.splice(S,0,c),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(c){this._checkLoaded();const g=this._layers[c];if(!g)return void this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be removed.`)));g.setEventedParent(null),this._updateLayerCount(g,!1);const C=this._order.indexOf(c);this._order.splice(C,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=g,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],g.onRemove&&g.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}hasLayerType(c){for(const g in this._layers)if(this._layers[g].type===c)return!0;return!1}setLayerZoomRange(c,g,C){this._checkLoaded();const S=this.getLayer(c);S?S.minzoom===g&&S.maxzoom===C||(null!=g&&(S.minzoom=g),null!=C&&(S.maxzoom=C),this._updateLayer(S)):this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(c,g,C={}){this._checkLoaded();const S=this.getLayer(c);if(S){if(!$e(S.filter,g))return null==g?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(_.validateFilter,`layers.${S.id}.filter`,g,{layerType:S.type},C)||(S.filter=_.clone$1(g),this._updateLayer(S)))}else this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be filtered.`)))}getFilter(c){const g=this.getLayer(c);return g&&_.clone$1(g.filter)}setLayoutProperty(c,g,C,S={}){this._checkLoaded();const D=this.getLayer(c);D?$e(D.getLayoutProperty(g),C)||(D.setLayoutProperty(g,C,S),this._updateLayer(D)):this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(c,g){const C=this.getLayer(c);if(C)return C.getLayoutProperty(g);this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style.`)))}setPaintProperty(c,g,C,S={}){this._checkLoaded();const D=this.getLayer(c);D?$e(D.getPaintProperty(g),C)||(D.setPaintProperty(g,C,S)&&this._updateLayer(D),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new _.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(c,g){const C=this.getLayer(c);return C&&C.getPaintProperty(g)}setFeatureState(c,g){this._checkLoaded();const C=c.source,S=c.sourceLayer,D=this.getSource(C);if(!D)return void this.fire(new _.ErrorEvent(new Error(`The source '${C}' does not exist in the map's style.`)));const L=D.type;if("geojson"===L&&S)return void this.fire(new _.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===L&&!S)return void this.fire(new _.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===c.id&&this.fire(new _.ErrorEvent(new Error("The feature id parameter must be provided.")));const z=this._getSourceCaches(C);for(const G of z)G.setFeatureState(S,c.id,g)}removeFeatureState(c,g){this._checkLoaded();const C=c.source,S=this.getSource(C);if(!S)return void this.fire(new _.ErrorEvent(new Error(`The source '${C}' does not exist in the map's style.`)));const D=S.type,L="vector"===D?c.sourceLayer:void 0;if("vector"===D&&!L)return void this.fire(new _.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(g&&"string"!=typeof c.id&&"number"!=typeof c.id)return void this.fire(new _.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const z=this._getSourceCaches(C);for(const G of z)G.removeFeatureState(L,c.id,g)}getFeatureState(c){this._checkLoaded();const g=c.source,C=c.sourceLayer,S=this.getSource(g);if(S){if("vector"!==S.type||C)return void 0===c.id&&this.fire(new _.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(g)[0].getFeatureState(C,c.id);this.fire(new _.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new _.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)))}getTransition(){return _.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const c={};for(const g in this._sourceCaches){const C=this._sourceCaches[g].getSource();c[C.id]||(c[C.id]=C.serialize())}return _.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:c,layers:this._serializeLayers(this._order)},g=>void 0!==g)}_updateLayer(c){this._updatedLayers[c.id]=!0;const g=this._getLayerSourceCache(c);c.source&&!this._updatedSources[c.source]&&g&&"raster"!==g.getSource().type&&(this._updatedSources[c.source]="reload",g.pause()),this._changed=!0,c.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(c){const g=L=>"fill-extrusion"===this._layers[L].type,C={},S=[];for(let L=this._order.length-1;L>=0;L--){const z=this._order[L];if(g(z)){C[z]=L;for(const G of c){const J=G[z];if(J)for(const ee of J)S.push(ee)}}}S.sort((L,z)=>z.intersectionZ-L.intersectionZ);const D=[];for(let L=this._order.length-1;L>=0;L--){const z=this._order[L];if(g(z))for(let G=S.length-1;G>=0;G--){const J=S[G].feature;if(C[J.layer.id]<L)break;D.push(J),S.pop()}else for(const G of c){const J=G[z];if(J)for(const ee of J)D.push(ee.feature)}}return D}queryRenderedFeatures(c,g,C){g&&g.filter&&this._validate(_.validateFilter,"queryRenderedFeatures.filter",g.filter,null,g);const S={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new _.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const G of g.layers){const J=this._layers[G];if(!J)return this.fire(new _.ErrorEvent(new Error(`The layer '${G}' does not exist in the map's style and cannot be queried for features.`))),[];S[J.source]=!0}}const D=[];g.availableImages=this._availableImages;const L=g&&g.layers?g.layers.some(G=>{const J=this.getLayer(G);return J&&J.is3D()}):this.has3DLayers(),z=wn.createFromScreenPoints(c,C);for(const G in this._sourceCaches){const J=this._sourceCaches[G].getSource().id;g.layers&&!S[J]||D.push(He(this._sourceCaches[G],this._layers,this._serializedLayers,z,g,C,L,!!this.map._showQueryGeometry))}return this.placement&&D.push(function(G,J,ee,re,fe,_e,de){const ve={},xe=_e.queryRenderedSymbols(re),ue=[];for(const Ce of Object.keys(xe).map(Number))ue.push(de[Ce]);ue.sort($t);for(const Ce of ue){const be=Ce.featureIndex.lookupSymbolFeatures(xe[Ce.bucketInstanceId],J,Ce.bucketIndex,Ce.sourceLayerIndex,fe.filter,fe.layers,fe.availableImages,G);for(const Me in be){const Le=ve[Me]=ve[Me]||[],Fe=be[Me];Fe.sort((Ue,We)=>{const it=Ce.featureSortOrder;if(it){const st=it.indexOf(Ue.featureIndex);return it.indexOf(We.featureIndex)-st}return We.featureIndex-Ue.featureIndex});for(const Ue of Fe)Le.push(Ue)}}for(const Ce in ve)ve[Ce].forEach(be=>{const Me=be.feature,Le=ee(G[Ce]).getFeatureState(Me.layer["source-layer"],Me.id);Me.source=Me.layer.source,Me.layer["source-layer"]&&(Me.sourceLayer=Me.layer["source-layer"]),Me.state=Le});return ve}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),z.screenGeometry,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(D)}querySourceFeatures(c,g){g&&g.filter&&this._validate(_.validateFilter,"querySourceFeatures.filter",g.filter,null,g);const C=this._getSourceCaches(c);let S=[];for(const D of C)S=S.concat(rt(D,g));return S}addSourceType(c,g,C){return no.getSourceType(c)?C(new Error(`A source type called "${c}" already exists.`)):(no.setSourceType(c,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:g.workerSourceURL},C):C(null,null))}getLight(){return this.light.getLight()}setLight(c,g={}){this._checkLoaded();const C=this.light.getLight();let S=!1;for(const L in c)if(!$e(c[L],C[L])){S=!0;break}if(!S)return;const D=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(c,g),this.light.updateTransitions(D)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(c,g=1){if(this._checkLoaded(),!c)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===g){if("object"==typeof c.source){const C="terrain-dem-src";this.addSource(C,c.source),c=_.clone$1(c),c=_.extend(c,{source:C})}if(this._validate(_.validateTerrain,"terrain",c))return}if(!this.terrain||this.terrain&&g!==this.terrain.drapeRenderMode)this._createTerrain(c,g);else{const C=this.terrain,S=C.get();for(const D of Object.keys(_.spec.terrain))!c.hasOwnProperty(D)&&_.spec.terrain[D].default&&(c[D]=_.spec.terrain[D].default);for(const D in c)if(!$e(c[D],S[D])){C.set(c),this.stylesheet.terrain=c;const L=this._setTransitionParameters({duration:0});C.updateTransitions(L);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(c){const g=this.fog=new Ht(c,this.map.transform);this.stylesheet.fog=c;const C=this._setTransitionParameters({duration:0});g.updateTransitions(C)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const c of this.map._markers)c._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(c){if(this._checkLoaded(),!c)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const g=this.fog,C=g.get();0===Object.keys(c).length&&g.set(c);for(const S in c)if(!$e(c[S],C[S])){g.set(c),this.stylesheet.fog=c;const D=this._setTransitionParameters({duration:0});g.updateTransitions(D);break}}else this._createFog(c);this._markersNeedUpdate=!0}_setTransitionParameters(c){return{now:_.exported.now(),transition:_.extend(c,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const c=this._order.filter(C=>this.isLayerDraped(this._layers[C])),g=this._order.filter(C=>!this.isLayerDraped(this._layers[C]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...c),this._drapedFirstOrder.push(...g)}_createTerrain(c,g){const C=this.terrain=new si(c,g);this.stylesheet.terrain=c,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const S=this._setTransitionParameters({duration:0});C.updateTransitions(S)}_force3DLayerUpdate(){for(const c in this._layers){const g=this._layers[c];"fill-extrusion"===g.type&&this._updateLayer(g)}}_forceSymbolLayerUpdate(){for(const c in this._layers){const g=this._layers[c];"symbol"===g.type&&this._updateLayer(g)}}_validate(c,g,C,S,D={}){return(!D||!1!==D.validate)&&yu(this,c.call(_.validateStyle,_.extend({key:g,style:this.serialize(),value:C,styleSpec:_.spec},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),_.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this._sourceCaches)this._sourceCaches[c].clearTiles(),this._sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){const g=this._getSourceCaches(c);for(const C of g)C.clearTiles()}_reloadSource(c){const g=this._getSourceCaches(c);for(const C of g)C.resume(),C.reload()}_reloadSources(){for(const c of this._getSources())c.reload&&c.reload()}_updateSources(c){for(const g in this._sourceCaches)this._sourceCaches[g].update(c)}_generateCollisionBoxes(){for(const c in this._sourceCaches){const g=this._sourceCaches[c];g.resume(),g.reload()}}_updatePlacement(c,g,C,S,D=!1){let L=!1,z=!1;const G={};for(const J of this._order){const ee=this._layers[J];if("symbol"!==ee.type)continue;if(!G[ee.source]){const fe=this._getLayerSourceCache(ee);if(!fe)continue;G[ee.source]=fe.getRenderableIds(!0).map(_e=>fe.getTileByID(_e)).sort((_e,de)=>de.tileID.overscaledZ-_e.tileID.overscaledZ||(_e.tileID.isLessThan(de.tileID)?-1:1))}const re=this.crossTileSymbolIndex.addLayer(ee,G[ee.source],c.center.lng,c.projection);L=L||re}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),D=D||this._layerOrderChanged||0===C,this._layerOrderChanged&&this.fire(new _.Event("neworder")),(D||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(_.exported.now(),c.zoom))&&(this.pauseablePlacement=new vl(c,this._order,D,g,C,S,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,G),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(_.exported.now()),z=!0),L&&this.pauseablePlacement.placement.setStale()),z||L)for(const J of this._order){const ee=this._layers[J];"symbol"===ee.type&&this.placement.updateLayerOpacities(ee,G[ee.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(_.exported.now())}_releaseSymbolFadeTiles(){for(const c in this._sourceCaches)this._sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,g,C){this.imageManager.getImages(g.icons,C),this._updateTilesForChangedImages();const S=D=>{D&&D.setDependencies(g.tileID.key,g.type,g.icons)};S(this._otherSourceCaches[g.source]),S(this._symbolSourceCaches[g.source])}getGlyphs(c,g,C){this.glyphManager.getGlyphs(g.stacks,C)}getResource(c,g,C){return _.makeRequest(g,C)}_getSourceCache(c){return this._otherSourceCaches[c]}_getLayerSourceCache(c){return"symbol"===c.type?this._symbolSourceCaches[c.source]:this._otherSourceCaches[c.source]}_getSourceCaches(c){const g=[];return this._otherSourceCaches[c]&&g.push(this._otherSourceCaches[c]),this._symbolSourceCaches[c]&&g.push(this._symbolSourceCaches[c]),g}_isSourceCacheLoaded(c){const g=this._getSourceCaches(c);return 0===g.length?(this.fire(new _.ErrorEvent(new Error(`There is no source with ID '${c}'`))),!1):g.every(C=>C.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}no.getSourceType=function(v){return ke[v]},no.setSourceType=function(v,c){ke[v]=c},no.registerForPluginStateChange=_.registerForPluginStateChange;var dd="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",vf="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",hd="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",bu="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",bf="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Ap={},Xl={};const kc=[];Jl(dd,kc),Jl(hd,kc),Jl(bu,kc),Jl(bf,kc),Ap=Wi("",hd),Xl=Wi(bf,bu);const xu=Wi("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),Rc=dd,Ql="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var fd={background:Wi("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Wi("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Wi("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Wi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Wi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Wi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Wi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Wi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Wi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:Wi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Wi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Wi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Wi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Wi("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Wi("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Wi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Wi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Wi("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Wi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Wi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Wi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Wi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Wi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Wi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:Wi("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Wi("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",vf),skyboxGradient:Wi("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",vf),skyboxCapture:Wi("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Wi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:Wi("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function Jl(v,c){const g=v.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let C of g)if(C=C.trim(),"#"===C[0]&&C.includes("if")&&!C.includes("endif")){C=C.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=C.split(" ");for(const D of S)c.includes(D)||c.push(D)}}function Wi(v,c){const g=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,C=c.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),S={},D=[...kc];return Jl(v,D),Jl(c,D),{fragmentSource:v=v.replace(g,(L,z,G,J,ee)=>(S[ee]=!0,"define"===z?`\n#ifndef HAS_UNIFORM_u_${ee}\nvarying ${G} ${J} ${ee};\n#else\nuniform ${G} ${J} u_${ee};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${ee}\n    ${G} ${J} ${ee} = u_${ee};\n#endif\n`)),vertexSource:c=c.replace(g,(L,z,G,J,ee)=>{const re="float"===J?"vec2":"vec4",fe=ee.match(/color/)?"color":re;return S[ee]?"define"===z?`\n#ifndef HAS_UNIFORM_u_${ee}\nuniform lowp float u_${ee}_t;\nattribute ${G} ${re} a_${ee};\nvarying ${G} ${J} ${ee};\n#else\nuniform ${G} ${J} u_${ee};\n#endif\n`:"vec4"===fe?`\n#ifndef HAS_UNIFORM_u_${ee}\n    ${ee} = a_${ee};\n#else\n    ${G} ${J} ${ee} = u_${ee};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${ee}\n    ${ee} = unpack_mix_${fe}(a_${ee}, u_${ee}_t);\n#else\n    ${G} ${J} ${ee} = u_${ee};\n#endif\n`:"define"===z?`\n#ifndef HAS_UNIFORM_u_${ee}\nuniform lowp float u_${ee}_t;\nattribute ${G} ${re} a_${ee};\n#else\nuniform ${G} ${J} u_${ee};\n#endif\n`:"vec4"===fe?`\n#ifndef HAS_UNIFORM_u_${ee}\n    ${G} ${J} ${ee} = a_${ee};\n#else\n    ${G} ${J} ${ee} = u_${ee};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${ee}\n    ${G} ${J} ${ee} = unpack_mix_${fe}(a_${ee}, u_${ee}_t);\n#else\n    ${G} ${J} ${ee} = u_${ee};\n#endif\n`}),staticAttributes:C,usedDefines:D}}class pd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(c,g,C,S,D,L,z){this.context=c;let G=this.boundPaintVertexBuffers.length!==S.length;for(let ee=0;!G&&ee<S.length;ee++)this.boundPaintVertexBuffers[ee]!==S[ee]&&(G=!0);let J=this.boundDynamicVertexBuffers.length!==z.length;for(let ee=0;!J&&ee<z.length;ee++)this.boundDynamicVertexBuffers[ee]!==z[ee]&&(J=!0);if(!c.extVertexArrayObject||!this.vao||this.boundProgram!==g||this.boundLayoutVertexBuffer!==C||G||J||this.boundIndexBuffer!==D||this.boundVertexOffset!==L)this.freshBind(g,C,S,D,L,z);else{c.bindVertexArrayOES.set(this.vao);for(const ee of z)ee&&ee.bind();D&&D.dynamicDraw&&D.bind()}}freshBind(c,g,C,S,D,L){let z;const G=c.numAttributes,J=this.context,ee=J.gl;if(J.extVertexArrayObject)this.vao&&this.destroy(),this.vao=J.extVertexArrayObject.createVertexArrayOES(),J.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=c,this.boundLayoutVertexBuffer=g,this.boundPaintVertexBuffers=C,this.boundIndexBuffer=S,this.boundVertexOffset=D,this.boundDynamicVertexBuffers=L;else{z=J.currentNumAttributes||0;for(let re=G;re<z;re++)ee.disableVertexAttribArray(re)}g.enableAttributes(ee,c),g.bind(),g.setVertexAttribPointers(ee,c,D);for(const re of C)re.enableAttributes(ee,c),re.bind(),re.setVertexAttribPointers(ee,c,D);for(const re of L)re&&(re.enableAttributes(ee,c),re.bind(),re.setVertexAttribPointers(ee,c,D));S&&S.bind(),J.currentNumAttributes=G}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function bl(v,c){const g=Math.pow(2,c.canonical.z),C=c.canonical.y;return[new _.MercatorCoordinate(0,C/g).toLngLat().lat,new _.MercatorCoordinate(0,(C+1)/g).toLngLat().lat]}function Fc(v,c,g,C,S,D,L){const z=v.context,G=z.gl,J=g.fbo;if(!J)return;v.prepareDrawTile();const ee=v.useProgram("hillshade");z.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,J.colorAttachment.get());const re=((ve,xe,ue,Ce)=>{const be=ue.paint.get("hillshade-shadow-color"),Me=ue.paint.get("hillshade-highlight-color"),Le=ue.paint.get("hillshade-accent-color");let Fe=ue.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ue.paint.get("hillshade-illumination-anchor")&&(Fe-=ve.transform.angle);const Ue=!ve.options.moving;return{u_matrix:Ce||ve.transform.calculateProjMatrix(xe.tileID.toUnwrapped(),Ue),u_image:0,u_latrange:bl(0,xe.tileID),u_light:[ue.paint.get("hillshade-exaggeration"),Fe],u_shadow:be,u_highlight:Me,u_accent:Le}})(v,g,C,v.terrain?c.projMatrix:null);v.prepareDrawProgram(z,ee,c.toUnwrapped());const{tileBoundsBuffer:fe,tileBoundsIndexBuffer:_e,tileBoundsSegments:de}=v.getTileBoundsBuffers(g);ee.draw(z,G.TRIANGLES,S,D,L,_.CullFaceMode.disabled,re,C.id,fe,_e,de)}function Qo(v,c,g){if(!c.needsDEMTextureUpload)return;const C=v.context,S=C.gl;C.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||v.getTileTexture(g.stride);const D=g.getPixels();c.demTexture?c.demTexture.update(D,{premultiply:!1}):c.demTexture=new _.Texture(C,D,S.RGBA,{premultiply:!1}),c.needsDEMTextureUpload=!1}function wu(v,c,g,C,S,D){const L=v.context,z=L.gl;if(!c.dem)return;const G=c.dem;if(L.activeTexture.set(z.TEXTURE1),Qo(v,c,G),!c.demTexture)return;c.demTexture.bind(z.NEAREST,z.CLAMP_TO_EDGE);const J=G.dim;L.activeTexture.set(z.TEXTURE0);let ee=c.fbo;if(!ee){const de=new _.Texture(L,{width:J,height:J,data:null},z.RGBA);de.bind(z.LINEAR,z.CLAMP_TO_EDGE),ee=c.fbo=L.createFramebuffer(J,J,!0),ee.colorAttachment.set(de.texture)}L.bindFramebuffer.set(ee.framebuffer),L.viewport.set([0,0,J,J]);const{tileBoundsBuffer:re,tileBoundsIndexBuffer:fe,tileBoundsSegments:_e}=v.getMercatorTileBoundsBuffers();v.useProgram("hillshadePrepare").draw(L,z.TRIANGLES,C,S,D,_.CullFaceMode.disabled,((de,ve)=>{const xe=ve.stride,ue=_.create();return _.ortho(ue,0,_.EXTENT,-_.EXTENT,0,0,1),_.translate(ue,ue,[0,-_.EXTENT,0]),{u_matrix:ue,u_image:1,u_dimension:[xe,xe],u_zoom:de.overscaledZ,u_unpack:ve.unpackVector}})(c.tileID,G),g.id,re,fe,_e),c.needsHillshadePrepare=!1}const Lc=v=>({u_matrix:new _.UniformMatrix4f(v),u_image0:new _.Uniform1i(v),u_skirt_height:new _.Uniform1f(v)}),io=(v,c)=>({u_matrix:v,u_image0:0,u_skirt_height:c}),Cu=(v,c,g,C,S,D,L,z,G,J,ee,re,fe,_e,de)=>({u_proj_matrix:Float32Array.from(v),u_globe_matrix:c,u_normalize_matrix:Float32Array.from(C),u_merc_matrix:g,u_zoom_transition:S,u_merc_center:D,u_image0:0,u_frustum_tl:L,u_frustum_tr:z,u_frustum_br:G,u_frustum_bl:J,u_globe_pos:ee,u_globe_radius:re,u_viewport:fe,u_grid_matrix:de?Float32Array.from(de):new Float32Array(9),u_skirt_height:_e});function xl(v,c){return null!=v&&null!=c&&!(!v.hasData()||!c.hasData())&&null!=v.demTexture&&null!=c.demTexture&&v.tileID.key!==c.tileID.key}const po=new class{constructor(){this.operations={}}newMorphing(v,c,g,C,S){if(v in this.operations){const D=this.operations[v];D.to.tileID.key!==g.tileID.key&&(D.queued=g)}else this.operations[v]={startTime:C,phase:0,duration:S,from:c,to:g,queued:null}}getMorphValuesForProxy(v){if(!(v in this.operations))return null;const c=this.operations[v];return{from:c.from,to:c.to,phase:c.phase}}update(v){for(const c in this.operations){const g=this.operations[c];for(g.phase=(v-g.startTime)/g.duration;g.phase>=1||!this._validOp(g);)if(!this._nextOp(g,v)){delete this.operations[c];break}}}_nextOp(v,c){return!!v.queued&&(v.from=v.to,v.to=v.queued,v.queued=null,v.phase=0,v.startTime=c,!0)}_validOp(v){return v.from.hasData()&&v.to.hasData()}},Nc={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Eu(v){return 6*Math.pow(1.5,22-v)}function la(v,c){const g=1<<v.z;return!c&&(0===v.x||v.x===g-1)||0===v.y||v.y===g-1}const di=v=>({u_matrix:v});function zc(v,c,g,C,S){if(S>0){const D=_.exported.now(),L=(D-v.timeAdded)/S,z=c?(D-c.timeAdded)/S:-1,G=g.getSource(),J=C.coveringZoomLevel({tileSize:G.tileSize,roundZoom:G.roundZoom}),ee=!c||Math.abs(c.tileID.overscaledZ-J)>Math.abs(v.tileID.overscaledZ-J),re=ee&&v.refreshedUponExpiration?1:_.clamp(ee?L:1-z,0,1);return v.refreshedUponExpiration&&L>=1&&(v.refreshedUponExpiration=!1),c?{opacity:1,mix:1-re}:{opacity:re,mix:0}}return{opacity:1,mix:0}}class ec extends _.SourceCache{constructor(c){const g={type:"raster-dem",maxzoom:c.transform.maxZoom},C=new rn(ii(),null),S=Be("mock-dem",g,C,c.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(c,g){c.state="loaded",g(null)}}class Jm extends _.SourceCache{constructor(c){const g=Be("proxy",{type:"geojson",maxzoom:c.transform.maxZoom},new rn(ii(),null),c.style);super("proxy",g,!1),g.setEventedParent(this),this.map=this.getSource().map=c,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(c,g,C){if(c.freezeTileCoverage)return;this.transform=c;const S=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((D,L)=>{if(D[L.key]="",!this._tiles[L.key]){const z=new _.Tile(L,this._source.tileSize*L.overscaleFactor(),c.tileZoom);z.state="loaded",this._tiles[L.key]=z}return D},{});for(const D in this._tiles)D in S||(this.freeFBO(D),this._tiles[D].unloadVectorData(),delete this._tiles[D])}freeFBO(c){const g=this.proxyCachedFBO[c];if(void 0!==g){const C=Object.values(g);this.renderCachePool.push(...C),delete this.proxyCachedFBO[c]}}deallocRenderCache(){this.renderCache.forEach(c=>c.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ca extends _.OverscaledTileID{constructor(c,g,C){super(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y),this.proxyTileKey=g,this.projMatrix=C}}class oh extends _.Elevation{constructor(c,g){super(),this.painter=c,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[C,S,D]=function(G){const J=new _.StructArrayLayout2i4,ee=new _.StructArrayLayout3ui6;J.reserve(17161),ee.reserve(33800);const fe=_.EXTENT/128,_e=_.EXTENT+fe/2,de=_e+fe;for(let xe=-fe;xe<de;xe+=fe)for(let ue=-fe;ue<de;ue+=fe){const Ce=ue<0||ue>_e||xe<0||xe>_e?24575:0,be=_.clamp(Math.round(ue),0,_.EXTENT),Me=_.clamp(Math.round(xe),0,_.EXTENT);J.emplaceBack(be+Ce,Me)}const ve=(xe,ue)=>{const Ce=131*ue+xe;ee.emplaceBack(Ce+1,Ce,Ce+131),ee.emplaceBack(Ce+131,Ce+131+1,Ce+1)};for(let xe=1;xe<129;xe++)for(let ue=1;ue<129;ue++)ve(ue,xe);return[0,129].forEach(xe=>{for(let ue=0;ue<130;ue++)ve(ue,xe),ve(xe,ue)}),[J,ee,32768]}(),L=c.context;this.gridBuffer=L.createVertexBuffer(C,_.posAttributes.members),this.gridIndexBuffer=L.createIndexBuffer(S),this.gridSegments=_.SegmentVector.simpleSegment(0,0,C.length,S.length),this.gridNoSkirtSegments=_.SegmentVector.simpleSegment(0,0,C.length,D),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Jm(g.map),this.orthoMatrix=_.create(),_.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,_.EXTENT,0,_.EXTENT,0,1);const z=L.gl;this._overlapStencilMode=new _.StencilMode({func:z.GEQUAL,mask:255},0,255,z.KEEP,z.KEEP,z.REPLACE),this._previousZoom=c.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=g,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ec(g.map)}set style(c){c.on("data",this._onStyleDataEvent.bind(this)),c.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=c,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(c,g,C){if(c&&c.terrain){this._style!==c&&(this.style=c),this.enabled=!0;const S=c.terrain.properties;this.sourceCache=0===c.terrain.drapeRenderMode?this._mockSourceCache:c._getSourceCache(S.get("source")),this._exaggeration=S.get("exaggeration");const D=()=>{this.sourceCache.used&&_.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const L=this.getScaledDemTileSize();this.sourceCache.update(g,L,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,D(),this._initializing=!0),D(),g.updateElevation(!0,C),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(g),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(c){this._findCoveringTileCache[c]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const c=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==c.efficiency&&_.warnOnce(`Terrain render cache efficiency is not optimal (${c.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${c.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(c){c.coord&&"source"===c.dataType?this._clearRenderCacheForTile(c.sourceCacheId,c.coord):"style"===c.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const c in this._style._sourceCaches)this._style._sourceCaches[c].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(c=>c.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const c=2*this.proxySourceCache.getSource().tileSize;return[c,c]}set useVertexMorphing(c){this._useVertexMorphing=c}updateTileBinding(c){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const g=this.proxySourceCache,C=this.painter.transform;this._initializing&&(this._initializing=0===C._centerAltitude&&-1===this.getAtPointOrZero(_.MercatorCoordinate.fromLngLat(C.center),-1),this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=g.getIds().map(G=>{const J=g.getTileByID(G).tileID;return J.projMatrix=C.calculateProjMatrix(J.toUnwrapped()),J});(function(G,J){const ee=J.transform.pointCoordinate(J.transform.getCameraPoint()),re=new _.pointGeometry(ee.x,ee.y);G.sort((fe,_e)=>{if(_e.overscaledZ-fe.overscaledZ)return _e.overscaledZ-fe.overscaledZ;const de=new _.pointGeometry(fe.canonical.x+(1<<fe.canonical.z)*fe.wrap,fe.canonical.y),ve=new _.pointGeometry(_e.canonical.x+(1<<_e.canonical.z)*_e.wrap,_e.canonical.y),xe=re.mult(1<<fe.canonical.z);return xe.x-=.5,xe.y-=.5,xe.distSqr(de)-xe.distSqr(ve)})})(S,this.painter),this._previousZoom=C.zoom;const D=this.proxyToSource||{};this.proxyToSource={},S.forEach(G=>{this.proxyToSource[G.key]={}}),this.terrainTileForTile={};const L=this._style._sourceCaches;for(const G in L){const J=L[G];if(!J.used||(J!==this.sourceCache&&this.resetTileLookupCache(J.id),this._setupProxiedCoordsForOrtho(J,c[G],D),J.usedForTerrain))continue;const ee=c[G];J.getSource().reparseOverscaled&&this._assignTerrainTiles(ee)}this.proxiedCoords[g.id]=S.map(G=>new ca(G,G.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(D),this.renderingToTexture=!1,this._updateTimestamp=_.exported.now();const z={};this._visibleDemTiles=[];for(const G of this.proxyCoords){const J=this.terrainTileForTile[G.key];if(!J)continue;const ee=J.tileID.key;ee in z||(this._visibleDemTiles.push(J),z[ee]=ee)}}_assignTerrainTiles(c){this._initializing||c.forEach(g=>{if(this.terrainTileForTile[g.key])return;const C=this._findTileCoveringTileID(g,this.sourceCache);C&&(this.terrainTileForTile[g.key]=C)})}_prepareDEMTextures(){const c=this.painter.context,g=c.gl;for(const C in this.terrainTileForTile){const S=this.terrainTileForTile[C],D=S.dem;!D||S.demTexture&&!S.needsDEMTextureUpload||(c.activeTexture.set(g.TEXTURE1),Qo(this.painter,S,D))}}_prepareDemTileUniforms(c,g,C,S){if(!g||null==g.demTexture)return!1;const D=c.tileID.canonical,L=Math.pow(2,g.tileID.canonical.z-D.z),z=S||"";return C[`u_dem_tl${z}`]=[D.x*L%1,D.y*L%1],C[`u_dem_scale${z}`]=L,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const c=this.painter.context,g=c.gl;if(!this._emptyDepthBufferTexture){const C=new _.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new _.Texture(c,C,g.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let c=0;const g=this._visibleDemTiles.reduce((C,S)=>{if(!S.dem)return C;const D=S.dem.tree.minimums[0];return D>0&&c++,C+D},0);return c?g/c:0}_updateEmptyDEMTexture(){const c=this.painter.context,g=c.gl;c.activeTexture.set(g.TEXTURE2);const C=this._getLoadedAreaMinimum(),S=new _.RGBAImage({width:1,height:1},new Uint8Array(_.DEMData.pack(C,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let D=this._emptyDEMTexture;return D?D.update(S,{premultiply:!1}):D=this._emptyDEMTexture=new _.Texture(c,S,g.RGBA,{premultiply:!1}),D}setupElevationDraw(c,g,C){const S=this.painter.context,D=S.gl,L=(z=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:_.DEMData.getUnpackVector(z),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var z;L.u_dem_size=this.sourceCache.getSource().tileSize,L.u_exaggeration=this.exaggeration();let G=null,J=null,ee=1;if(C&&C.morphing&&this._useVertexMorphing){const re=C.morphing.srcDemTile,fe=C.morphing.dstDemTile;ee=C.morphing.phase,re&&fe&&(this._prepareDemTileUniforms(c,re,L,"_prev")&&(J=re),this._prepareDemTileUniforms(c,fe,L)&&(G=fe))}if(J&&G?(S.activeTexture.set(D.TEXTURE2),G.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE,D.NEAREST),S.activeTexture.set(D.TEXTURE4),J.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE,D.NEAREST),L.u_dem_lerp=ee):(G=this.terrainTileForTile[c.tileID.key],S.activeTexture.set(D.TEXTURE2),(this._prepareDemTileUniforms(c,G,L)?G.demTexture:this.emptyDEMTexture).bind(D.NEAREST,D.CLAMP_TO_EDGE)),S.activeTexture.set(D.TEXTURE3),C&&C.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE),this._depthFBO&&(L.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE),L.u_depth_size_inv=[1,1]),C&&C.useMeterToDem&&G){const re=(1<<G.tileID.canonical.z)*_.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;L.u_meter_to_dem=re}if(C&&C.labelPlaneMatrixInv&&(L.u_label_plane_matrix_inv=C.labelPlaneMatrixInv),g.setTerrainUniformValues(S,L),"globe"===this.painter.transform.projection.name){const re=this.globeUniformValues(this.painter.transform,c.tileID.canonical,C&&C.useDenormalizedUpVectorScale);g.setGlobeUniformValues(S,re)}}globeUniformValues(c,g,C){const S=c.projection;return{u_tile_tl_up:S.upVector(g,0,0),u_tile_tr_up:S.upVector(g,_.EXTENT,0),u_tile_br_up:S.upVector(g,_.EXTENT,_.EXTENT),u_tile_bl_up:S.upVector(g,0,_.EXTENT),u_tile_up_scale:C?_.globeMetersToEcef(1):S.upVectorScale(g,c.center.lat,c.worldSize).metersToTile}}renderToBackBuffer(c){const g=this.painter,C=this.painter.context;0!==c.length&&(C.bindFramebuffer.set(null),C.viewport.set([0,0,g.width,g.height]),g.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,D,L,z,G){if("globe"===S.transform.projection.name)!function(J,ee,re,fe,_e){const de=J.context,ve=de.gl;let xe,ue;const Ce=J.options.showTerrainWireframe?2:0,be=J.transform,Me=_.globeUseCustomAntiAliasing(J,de,be),Le=(Ot,et)=>{if(ue===Ot)return;const qe=[Nc[Ot],"PROJECTION_GLOBE_VIEW"];Me&&qe.push("CUSTOM_ANTIALIASING"),et&&qe.push(Nc[Ce]),xe=J.useProgram("globeRaster",null,qe),ue=Ot},Fe=J.colorModeForRenderPass(),Ue=new _.DepthMode(ve.LEQUAL,_.DepthMode.ReadWrite,J.depthRangeFor3D);po.update(_e);const We=_.calculateGlobeMercatorMatrix(be),it=[_.mercatorXfromLng(be.center.lng),_.mercatorYfromLat(be.center.lat)],st=Ce?[!1,!0]:[!1],Ut=J.globeSharedBuffers,Qe=[be.width*_.exported.devicePixelRatio,be.height*_.exported.devicePixelRatio],St=Float32Array.from(be.globeMatrix),at={useDenormalizedUpVectorScale:!0};if(st.forEach(Ot=>{const et=J.transform,qe=Eu(et.zoom)*ee.exaggeration();ue=-1;const Xe=Ot?ve.LINES:ve.TRIANGLES;for(const Mt of fe){const Rt=re.getTile(Mt),dn=_.StencilMode.disabled,Wn=ee.prevTerrainTileForTile[Mt.key],_n=ee.terrainTileForTile[Mt.key];xl(Wn,_n)&&po.newMorphing(Mt.key,Wn,_n,_e,250),de.activeTexture.set(ve.TEXTURE0),Rt.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE);const Yt=po.getMorphValuesForProxy(Mt.key),yn=Yt?1:0;Yt&&_.extend$1(at,{morphing:{srcDemTile:Yt.from,dstDemTile:Yt.to,phase:_.easeCubicInOut(Yt.phase)}});const xi=_.tileCornersToBounds(Mt.canonical),Vn=_.getLatitudinalLod(xi.getCenter().lat),er=_.getGridMatrix(Mt.canonical,xi,Vn,et.worldSize/et._pixelsPerMercatorPixel),Ri=_.globeNormalizeECEF(_.globeTileBounds(Mt.canonical)),or=Cu(et.projMatrix,St,We,Ri,_.globeToMercatorTransition(et.zoom),it,et.frustumCorners.TL,et.frustumCorners.TR,et.frustumCorners.BR,et.frustumCorners.BL,et.globeCenterInViewSpace,et.globeRadius,Qe,qe,er);if(Le(yn,Ot),ee.setupElevationDraw(Rt,xe,at),J.prepareDrawProgram(de,xe,Mt.toUnwrapped()),Ut){const[vi,Dr,Ws]=Ot?Ut.getWirefameBuffers(J.context,Vn):Ut.getGridBuffers(Vn,0!==qe);xe.draw(de,Xe,Ue,dn,Fe,_.CullFaceMode.backCCW,or,"globe_raster",vi,Dr,Ws)}}}),Ut){const Ot=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Me&&Ot.push("CUSTOM_ANTIALIASING"),xe=J.useProgram("globeRaster",null,Ot);for(const et of fe){const{x:qe,y:Xe,z:Mt}=et.canonical,Rt=0===Xe,dn=Xe===(1<<Mt)-1,[Wn,_n,Yt,yn]=Ut.getPoleBuffers(Mt);if(yn&&(Rt||dn)){const xi=re.getTile(et);de.activeTexture.set(ve.TEXTURE0),xi.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE);let Vn=_.globePoleMatrixForTile(Mt,qe,be);const er=_.globeNormalizeECEF(_.globeTileBounds(et.canonical)),Ri=(or,vi)=>or.draw(de,ve.TRIANGLES,Ue,_.StencilMode.disabled,Fe,_.CullFaceMode.disabled,Cu(be.projMatrix,Vn,Vn,er,0,it,be.frustumCorners.TL,be.frustumCorners.TR,be.frustumCorners.BR,be.frustumCorners.BL,be.globeCenterInViewSpace,be.globeRadius,Qe,0),"globe_pole_raster",vi,Yt,yn);ee.setupElevationDraw(xi,xe,at),J.prepareDrawProgram(de,xe,et.toUnwrapped()),Rt&&Ri(xe,Wn),dn&&(Vn=_.scale(_.create(),Vn,[1,-1,1]),Ri(xe,_n))}}}}(S,D,L,z,G);else{const J=S.context,ee=J.gl;let re,fe;const _e=S.options.showTerrainWireframe?2:0,de=(be,Me)=>{if(fe===be)return;const Le=[Nc[be]];Me&&Le.push(Nc[_e]),re=S.useProgram("terrainRaster",null,Le),fe=be},ve=S.colorModeForRenderPass(),xe=new _.DepthMode(ee.LEQUAL,_.DepthMode.ReadWrite,S.depthRangeFor3D);po.update(G);const ue=S.transform,Ce=Eu(ue.zoom)*D.exaggeration();(_e?[!1,!0]:[!1]).forEach(be=>{fe=-1;const Me=be?ee.LINES:ee.TRIANGLES,[Le,Fe]=be?D.getWirefameBuffer():[D.gridIndexBuffer,D.gridSegments];for(const Ue of z){const We=L.getTile(Ue),it=_.StencilMode.disabled,st=D.prevTerrainTileForTile[Ue.key],Ut=D.terrainTileForTile[Ue.key];xl(st,Ut)&&po.newMorphing(Ue.key,st,Ut,G,250),J.activeTexture.set(ee.TEXTURE0),We.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE,ee.LINEAR_MIPMAP_NEAREST);const Qe=po.getMorphValuesForProxy(Ue.key),St=Qe?1:0;let at;Qe&&(at={morphing:{srcDemTile:Qe.from,dstDemTile:Qe.to,phase:_.easeCubicInOut(Qe.phase)}});const Ot=io(Ue.projMatrix,la(Ue.canonical,ue.renderWorldCopies)?Ce/10:Ce);de(St,be),D.setupElevationDraw(We,re,at),S.prepareDrawProgram(J,re,Ue.toUnwrapped()),re.draw(J,Me,xe,it,ve,_.CullFaceMode.backCCW,Ot,"terrain_raster",D.gridBuffer,Le,Fe)}})}}(g,this,this.proxySourceCache,c,this._updateTimestamp),this.renderingToTexture=!0,g.gpuTimingDeferredRenderEnd(),c.splice(0,c.length))}renderBatch(c){if(0===this._drapedRenderBatches.length)return c+1;this.renderingToTexture=!0;const g=this.painter,C=this.painter.context,S=this.proxySourceCache,D=this.proxiedCoords[S.id],L=this._drapedRenderBatches.shift(),z=[],G=g.style.order;let J=0;for(const ee of D){const re=S.getTileByID(ee.proxyTileKey),fe=S.proxyCachedFBO[ee.key]?S.proxyCachedFBO[ee.key][c]:void 0,_e=void 0!==fe?S.renderCache[fe]:this.pool[J++],de=void 0!==fe;if(re.texture=_e.tex,de&&!_e.dirty){z.push(re.tileID);continue}let ve;C.bindFramebuffer.set(_e.fb.framebuffer),this.renderedToTile=!1,_e.dirty&&(C.clear({color:_.Color.transparent,stencil:0}),_e.dirty=!1);for(let xe=L.start;xe<=L.end;++xe){const ue=g.style._layers[G[xe]];if(ue.isHidden(g.transform.zoom))continue;const Ce=g.style._getLayerSourceCache(ue),be=Ce?this.proxyToSource[ee.key][Ce.id]:[ee];if(!be)continue;const Me=be;C.viewport.set([0,0,_e.fb.width,_e.fb.height]),ve!==(Ce?Ce.id:null)&&(this._setupStencil(_e,be,ue,Ce),ve=Ce?Ce.id:null),g.renderLayer(g,Ce,ue,Me)}this.renderedToTile?(_e.dirty=!0,z.push(re.tileID)):de||--J,5===J&&(J=0,this.renderToBackBuffer(z))}return this.renderToBackBuffer(z),this.renderingToTexture=!1,C.bindFramebuffer.set(null),C.viewport.set([0,0,g.width,g.height]),L.end+1}postRender(){}renderCacheEfficiency(c){const g=c.order.length;if(0===g)return{efficiency:100};let C,S=0,D=0,L=!1;for(let z=0;z<g;++z){const G=c._layers[c.order[z]];this._style.isLayerDraped(G)?(L&&++S,++D):L||(L=!0,C=G.id)}return 0===D?{efficiency:100}:{efficiency:100*(1-S/D),firstUndrapedLayer:C}}getMinElevationBelowMSL(){let c=0;return this._visibleDemTiles.filter(g=>g.dem).forEach(g=>{c=Math.min(c,g.dem.tree.minimums[0])}),0===c?c:(c-30)*this._exaggeration}raycast(c,g,C){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(D=>D.dem).map(D=>{const L=D.tileID,z=1<<L.overscaledZ,{x:G,y:J}=L.canonical,ee=G/z,re=(G+1)/z,fe=J/z,_e=(J+1)/z;return{minx:ee,miny:fe,maxx:re,maxy:_e,t:D.dem.tree.raycastRoot(ee,fe,re,_e,c,g,C),tile:D}});S.sort((D,L)=>(null!==D.t?D.t:Number.MAX_VALUE)-(null!==L.t?L.t:Number.MAX_VALUE));for(const D of S){if(null==D.t)return null;const L=D.tile.dem.tree.raycast(D.minx,D.miny,D.maxx,D.maxy,c,g,C);if(null!=L)return L}return null}_createFBO(){const c=this.painter.context,g=c.gl,C=this.drapeBufferSize;c.activeTexture.set(g.TEXTURE0);const S=new _.Texture(c,{width:C[0],height:C[1],data:null},g.RGBA);S.bind(g.LINEAR,g.CLAMP_TO_EDGE);const D=c.createFramebuffer(C[0],C[1],!1);return D.colorAttachment.set(S.texture),D.depthAttachment=new eo(c,D.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=c.createRenderbuffer(c.gl.DEPTH_STENCIL,C[0],C[1]),this._stencilRef=0,D.depthAttachment.set(this._sharedDepthStencil),c.clear({stencil:0})):D.depthAttachment.set(this._sharedDepthStencil),c.extTextureFilterAnisotropic&&!c.extTextureFilterAnisotropicForceOff&&g.texParameterf(g.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax),{fb:D,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c].hasTransition())return!0;return this._style.order.some(c=>{const g=this._style._layers[c],C=g.isHidden(this.painter.transform.zoom);return"custom"===g.type?!C&&g.shouldRedrape():!C&&g.hasTransition()})}_clearLineLayersFromRenderCache(){let c=!1;for(const C of this._style._getSources())if(C instanceof $){c=!0;break}if(!c)return;const g={};for(let C=0;C<this._style.order.length;++C){const S=this._style._layers[this._style.order[C]],D=this._style._getLayerSourceCache(S);if(D&&!g[D.id]&&!S.isHidden(this.painter.transform.zoom)&&"line"===S.type&&S.widthExpression()instanceof _.ZoomDependentExpression){g[D.id]=!0;for(const L of this.proxyCoords){const z=this.proxyToSource[L.key][D.id];if(z)for(const G of z)this._clearRenderCacheForTile(D.id,G)}}}}_clearRasterLayersFromRenderCache(){let c=!1;for(const C in this._style._sourceCaches)if(this._style._sourceCaches[C]._source instanceof H){c=!0;break}if(!c)return;const g={};for(let C=0;C<this._style.order.length;++C){const S=this._style._layers[this._style.order[C]],D=this._style._getLayerSourceCache(S);if(!D||g[D.id]||S.isHidden(this.painter.transform.zoom)||"raster"!==S.type)continue;const L=S.paint.get("raster-fade-duration");for(const z of this.proxyCoords){const G=this.proxyToSource[z.key][D.id];if(G)for(const J of G){const ee=zc(D.getTile(J),D.findLoadedParent(J,0),D,this.painter.transform,L);(1!==ee.opacity||0!==ee.mix)&&this._clearRenderCacheForTile(D.id,J)}}}}_setupDrapedRenderBatches(){const c=this._style.order,g=c.length;if(0===g)return;const C=[];let S,D=0,L=this._style._layers[c[D]];for(;!this._style.isLayerDraped(L)&&L.isHidden(this.painter.transform.zoom)&&++D<g;)L=this._style._layers[c[D]];for(;D<g;++D){const z=this._style._layers[c[D]];z.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(z)?void 0===S&&(S=D):void 0!==S&&(C.push({start:S,end:D-1}),S=void 0))}void 0!==S&&C.push({start:S,end:D-1}),this._drapedRenderBatches=C}_setupRenderCache(c){const g=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,g.renderCache.length>g.renderCachePool.length){const L=Object.values(g.proxyCachedFBO);g.proxyCachedFBO={};for(let z=0;z<L.length;++z){const G=Object.values(L[z]);g.renderCachePool.push(...G)}}return}this._clearRasterLayersFromRenderCache();const C=this.proxyCoords,S=this._tilesDirty;for(let L=C.length-1;L>=0;L--){const z=C[L];if(g.getTileByID(z.key),void 0!==g.proxyCachedFBO[z.key]){const G=c[z.key],J=this.proxyToSource[z.key];let ee=0;for(const re in J){const fe=J[re],_e=G[re];if(!_e||_e.length!==fe.length||fe.some((de,ve)=>de!==_e[ve]||S[re]&&S[re].hasOwnProperty(de.key))){ee=-1;break}++ee}for(const re in g.proxyCachedFBO[z.key])g.renderCache[g.proxyCachedFBO[z.key][re]].dirty=ee<0||ee!==Object.values(G).length}}const D=[...this._drapedRenderBatches];D.sort((L,z)=>z.end-z.start-(L.end-L.start));for(const L of D)for(const z of C){if(g.proxyCachedFBO[z.key])continue;let G=g.renderCachePool.pop();void 0===G&&g.renderCache.length<50&&(G=g.renderCache.length,g.renderCache.push(this._createFBO())),void 0!==G&&(g.proxyCachedFBO[z.key]={},g.proxyCachedFBO[z.key][L.start]=G,g.renderCache[G].dirty=!0)}this._tilesDirty={}}_setupStencil(c,g,C,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const D=this.painter.context,L=D.gl;if(g.length<=1)return void(this._overlapStencilType=!1);let z;if(C.isTileClipped())z=g.length,this._overlapStencilMode.test={func:L.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(g[0].overscaledZ>g[g.length-1].overscaledZ))return void(this._overlapStencilType=!1);z=1,this._overlapStencilMode.test={func:L.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+z>255&&(D.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=z,this._overlapStencilMode.ref=this._stencilRef,C.isTileClipped()&&this._renderTileClippingMasks(g,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(c){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[c.key]),this._overlapStencilMode):_.StencilMode.disabled}_renderTileClippingMasks(c,g){const C=this.painter,S=this.painter.context,D=S.gl;C._tileClippingMaskIDs={},S.setColorMode(_.ColorMode.disabled),S.setDepthMode(_.DepthMode.disabled);const L=C.useProgram("clippingMask");for(const z of c){const G=C._tileClippingMaskIDs[z.key]=--g;L.draw(S,D.TRIANGLES,_.DepthMode.disabled,new _.StencilMode({func:D.ALWAYS,mask:0},G,255,D.KEEP,D.KEEP,D.REPLACE),_.ColorMode.disabled,_.CullFaceMode.disabled,di(z.projMatrix),"$clipping",C.tileExtentBuffer,C.quadTriangleIndexBuffer,C.tileExtentSegments)}}pointCoordinate(c){const g=this.painter.transform;if(c.x<0||c.x>g.width||c.y<0||c.y>g.height)return null;const C=[c.x,c.y,1,1];_.transformMat4$1(C,C,g.pixelMatrixInverse),_.scale$1(C,C,1/C[3]),C[0]/=g.worldSize,C[1]/=g.worldSize;const S=g._camera.position,D=_.mercatorZfromAltitude(1,g.center.lat),L=[S[0],S[1],S[2]/D,0],z=_.subtract([],C.slice(0,3),L);_.normalize(z,z);const G=this.raycast(L,z,this._exaggeration);return null!==G&&G?(_.scaleAndAdd(L,L,z,G),L[3]=L[2],L[2]*=D,L):null}drawDepth(){const c=this.painter,g=c.context,C=this.proxySourceCache,S=Math.ceil(c.width),D=Math.ceil(c.height);if(!this._depthFBO||this._depthFBO.width===S&&this._depthFBO.height===D||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const L=g.gl,z=g.createFramebuffer(S,D,!0);g.activeTexture.set(L.TEXTURE0);const G=new _.Texture(g,{width:S,height:D,data:null},L.RGBA);G.bind(L.NEAREST,L.CLAMP_TO_EDGE),z.colorAttachment.set(G.texture);const J=g.createRenderbuffer(g.gl.DEPTH_COMPONENT16,S,D);z.depthAttachment.set(J),this._depthFBO=z,this._depthTexture=G}g.bindFramebuffer.set(this._depthFBO.framebuffer),g.viewport.set([0,0,S,D]),function(L,z,G,J){if("globe"===L.transform.projection.name)return;const ee=L.context,re=ee.gl;ee.clear({depth:1});const fe=L.useProgram("terrainDepth"),_e=new _.DepthMode(re.LESS,_.DepthMode.ReadWrite,L.depthRangeFor3D);for(const de of J){const ve=G.getTile(de),xe=io(de.projMatrix,0);z.setupElevationDraw(ve,fe),fe.draw(ee,re.TRIANGLES,_e,_.StencilMode.disabled,_.ColorMode.unblended,_.CullFaceMode.backCCW,xe,"terrain_depth",z.gridBuffer,z.gridIndexBuffer,z.gridNoSkirtSegments)}}(c,this,C,this.proxyCoords)}_setupProxiedCoordsForOrtho(c,g,C){if(c.getSource()instanceof pe)return this._setupProxiedCoordsForImageSource(c,g,C);this._findCoveringTileCache[c.id]=this._findCoveringTileCache[c.id]||{};const S=this.proxiedCoords[c.id]=[],D=this.proxyCoords;for(let z=0;z<D.length;z++){const G=D[z],J=this._findTileCoveringTileID(G,c);if(J){const ee=this._createProxiedId(G,J,C[G.key]&&C[G.key][c.id]);S.push(ee),this.proxyToSource[G.key][c.id]=[ee]}}let L=!1;for(let z=0;z<g.length;z++){const G=c.getTile(g[z]);if(!G||!G.hasData())continue;const J=this._findTileCoveringTileID(G.tileID,this.proxySourceCache);if(J&&J.tileID.canonical.z!==G.tileID.canonical.z){const ee=this.proxyToSource[J.tileID.key][c.id],re=this._createProxiedId(J.tileID,G,C[J.tileID.key]&&C[J.tileID.key][c.id]);ee?ee.splice(ee.length-1,0,re):this.proxyToSource[J.tileID.key][c.id]=[re],S.push(re),L=!0}}this._sourceTilesOverlap[c.id]=L}_setupProxiedCoordsForImageSource(c,g,C){if(!c.getSource().loaded())return;const S=this.proxiedCoords[c.id]=[],D=this.proxyCoords,L=c.getSource(),z=new _.pointGeometry(L.tileID.x,L.tileID.y)._div(1<<L.tileID.z),G=L.coordinates.map(_.MercatorCoordinate.fromLngLat).reduce((ee,re)=>(ee.min.x=Math.min(ee.min.x,re.x-z.x),ee.min.y=Math.min(ee.min.y,re.y-z.y),ee.max.x=Math.max(ee.max.x,re.x-z.x),ee.max.y=Math.max(ee.max.y,re.y-z.y),ee),{min:new _.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new _.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),J=(ee,re)=>{const fe=ee.wrap+ee.canonical.x/(1<<ee.canonical.z),_e=ee.canonical.y/(1<<ee.canonical.z),de=_.EXTENT/(1<<ee.canonical.z),ve=re.wrap+re.canonical.x/(1<<re.canonical.z),xe=re.canonical.y/(1<<re.canonical.z);return fe+de<ve+G.min.x||fe>ve+G.max.x||_e+de<xe+G.min.y||_e>xe+G.max.y};for(let ee=0;ee<D.length;ee++){const re=D[ee];for(let fe=0;fe<g.length;fe++){const _e=c.getTile(g[fe]);if(!_e||!_e.hasData()||J(re,_e.tileID))continue;const de=this._createProxiedId(re,_e,C[re.key]&&C[re.key][c.id]),ve=this.proxyToSource[re.key][c.id];ve?ve.push(de):this.proxyToSource[re.key][c.id]=[de],S.push(de)}}}_createProxiedId(c,g,C){let S=this.orthoMatrix;if(C){const D=C.find(L=>L.key===g.tileID.key);if(D)return D}if(g.tileID.key!==c.key){const D=c.canonical.z-g.tileID.canonical.z;let L,z,G;S=_.create();const J=g.tileID.wrap-c.wrap<<c.overscaledZ;D>0?(L=_.EXTENT>>D,z=L*((g.tileID.canonical.x<<D)-c.canonical.x+J),G=L*((g.tileID.canonical.y<<D)-c.canonical.y)):(L=_.EXTENT<<-D,z=_.EXTENT*(g.tileID.canonical.x-(c.canonical.x+J<<-D)),G=_.EXTENT*(g.tileID.canonical.y-(c.canonical.y<<-D))),_.ortho(S,0,L,0,L,0,1),_.translate(S,S,[z,G,0])}return new ca(g.tileID,c.key,S)}_findTileCoveringTileID(c,g){let C=g.getTile(c);if(C&&C.hasData())return C;const S=this._findCoveringTileCache[g.id],D=S[c.key];if(C=D?g.getTileByID(D):null,C&&C.hasData()||null===D)return C;let L=C?C.tileID:c,z=L.overscaledZ;const G=g.getSource().minzoom,J=[];if(!D){const re=g.getSource().maxzoom;if(c.canonical.z>=re){const fe=c.canonical.z-re;g.getSource().reparseOverscaled?(z=Math.max(c.canonical.z+2,g.transform.tileZoom),L=new _.OverscaledTileID(z,c.wrap,re,c.canonical.x>>fe,c.canonical.y>>fe)):0!==fe&&(z=re,L=new _.OverscaledTileID(z,c.wrap,re,c.canonical.x>>fe,c.canonical.y>>fe))}L.key!==c.key&&(J.push(L.key),C=g.getTile(L))}const ee=re=>{J.forEach(fe=>{S[fe]=re}),J.length=0};for(z-=1;z>=G&&(!C||!C.hasData());z--){C&&ee(C.tileID.key);const re=L.calculateScaledKey(z);if(C=g.getTileByID(re),C&&C.hasData())break;const fe=S[re];if(null===fe)break;void 0===fe?J.push(re):C=g.getTileByID(fe)}return ee(C?C.tileID.key:null),C&&C.hasData()?C:null}findDEMTileFor(c){return this.enabled?this._findTileCoveringTileID(c,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(c,g){let C=this._tilesDirty[c];C||(C=this._tilesDirty[c]={}),C[g.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const c=function(g){let C=0;const S=new _.StructArrayLayout2ui4,D=131;for(let L=1;L<129;L++){for(let z=1;z<129;z++)C=L*D+z,S.emplaceBack(C,C+1),S.emplaceBack(C,C+D),S.emplaceBack(C+1,C+D),128===L&&S.emplaceBack(C+D,C+D+1);S.emplaceBack(C+1,C+1+D)}return S}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(c),this.wireframeSegments=_.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,c.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Bc{static cacheKey(c,g,C,S){let D=`${g}${S?S.cacheKey:""}`;for(const L of C)c.usedDefines.includes(L)&&(D+=`/${L}`);return D}constructor(c,g,C,S,D,L){const z=c.gl;this.program=z.createProgram();const G=function(ue){const Ce=[];for(let be=0;be<ue.length;be++){if(null===ue[be])continue;const Me=ue[be].split(" ");Ce.push(Me.pop())}return Ce}(C.staticAttributes),J=S?S.getBinderAttributes():[],ee=G.concat(J);let re=S?S.defines():[];re=re.concat(L.map(ue=>`#define ${ue}`));const fe=c.isWebGL2?"#version 300 es\n":"",_e=fe+re.concat(c.extStandardDerivatives&&0===fe.length?"#extension GL_OES_standard_derivatives : enable\n".concat(Ql):Ql,Ql,Rc,xu.fragmentSource,Xl.fragmentSource,C.fragmentSource).join("\n"),de=fe+re.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",Rc,xu.vertexSource,Xl.vertexSource,Ap.vertexSource,C.vertexSource).join("\n"),ve=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);z.shaderSource(ve,_e),z.compileShader(ve),z.attachShader(this.program,ve);const xe=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())this.failedToCreate=!0;else{z.shaderSource(xe,de),z.compileShader(xe),z.attachShader(this.program,xe),this.attributes={},this.numAttributes=ee.length;for(let ue=0;ue<this.numAttributes;ue++)ee[ue]&&(z.bindAttribLocation(this.program,ue,ee[ue]),this.attributes[ee[ue]]=ue);z.linkProgram(this.program),z.deleteShader(xe),z.deleteShader(ve),this.fixedUniforms=D(c),this.binderUniforms=S?S.getUniforms(c):[],L.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new _.Uniform1i(ue=c),u_dem_prev:new _.Uniform1i(ue),u_dem_unpack:new _.Uniform4f(ue),u_dem_tl:new _.Uniform2f(ue),u_dem_scale:new _.Uniform1f(ue),u_dem_tl_prev:new _.Uniform2f(ue),u_dem_scale_prev:new _.Uniform1f(ue),u_dem_size:new _.Uniform1f(ue),u_dem_lerp:new _.Uniform1f(ue),u_exaggeration:new _.Uniform1f(ue),u_depth:new _.Uniform1i(ue),u_depth_size_inv:new _.Uniform2f(ue),u_meter_to_dem:new _.Uniform1f(ue),u_label_plane_matrix_inv:new _.UniformMatrix4f(ue)}),L.includes("GLOBE")&&(this.globeUniforms=(ue=>({u_tile_tl_up:new _.Uniform3f(ue),u_tile_tr_up:new _.Uniform3f(ue),u_tile_br_up:new _.Uniform3f(ue),u_tile_bl_up:new _.Uniform3f(ue),u_tile_up_scale:new _.Uniform1f(ue)}))(c)),L.includes("FOG")&&(this.fogUniforms=(ue=>({u_fog_matrix:new _.UniformMatrix4f(ue),u_fog_range:new _.Uniform2f(ue),u_fog_color:new _.Uniform4f(ue),u_fog_horizon_blend:new _.Uniform1f(ue),u_fog_temporal_offset:new _.Uniform1f(ue),u_frustum_tl:new _.Uniform3f(ue),u_frustum_tr:new _.Uniform3f(ue),u_frustum_br:new _.Uniform3f(ue),u_frustum_bl:new _.Uniform3f(ue),u_globe_pos:new _.Uniform3f(ue),u_globe_radius:new _.Uniform1f(ue),u_globe_transition:new _.Uniform1f(ue),u_is_globe:new _.Uniform1i(ue),u_viewport:new _.Uniform2f(ue)}))(c))}var ue}setTerrainUniformValues(c,g){if(!this.terrainUniforms)return;const C=this.terrainUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const S in g)C[S]&&C[S].set(this.program,S,g[S])}}setGlobeUniformValues(c,g){if(!this.globeUniforms)return;const C=this.globeUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const S in g)C[S]&&C[S].set(this.program,S,g[S])}}setFogUniformValues(c,g){if(!this.fogUniforms)return;const C=this.fogUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const S in g)C[S].set(this.program,S,g[S])}}draw(c,g,C,S,D,L,z,G,J,ee,re,fe,_e,de,ve){const xe=c.gl;if(this.failedToCreate)return;c.program.set(this.program),c.setDepthMode(C),c.setStencilMode(S),c.setColorMode(D),c.setCullFace(L);for(const Ce of Object.keys(this.fixedUniforms))this.fixedUniforms[Ce].set(this.program,Ce,z[Ce]);de&&de.setUniforms(this.program,c,this.binderUniforms,fe,{zoom:_e});const ue={[xe.LINES]:2,[xe.TRIANGLES]:3,[xe.LINE_STRIP]:1}[g];for(const Ce of re.get()){const be=Ce.vaos||(Ce.vaos={});(be[G]||(be[G]=new pd)).bind(c,this,J,de?de.getPaintVertexBuffers():[],ee,Ce.vertexOffset,ve||[]),xe.drawElements(g,Ce.primitiveLength*ue,xe.UNSIGNED_SHORT,Ce.primitiveOffset*ue*2)}}}function Ii(v,c){const g=Math.pow(2,c.tileID.overscaledZ),C=c.tileSize*Math.pow(2,v.transform.tileZoom)/g,S=C*(c.tileID.canonical.x+c.tileID.wrap*g),D=C*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_tile_units_to_pixels:1/en(c,1,v.transform.tileZoom),u_pixel_coord_upper:[S>>16,D>>16],u_pixel_coord_lower:[65535&S,65535&D]}}const xf=_.create(),sh=(v,c,g,C,S,D,L,z,G,J,ee)=>{const re=c.style.light,fe=re.properties.get("position"),_e=[fe.x,fe.y,fe.z],de=_.create$1();"viewport"===re.properties.get("anchor")&&(_.fromRotation(de,-c.transform.angle),_.transformMat3(_e,_e,de));const ve=re.properties.get("color"),xe=c.transform,ue={u_matrix:v,u_lightpos:_e,u_lightintensity:re.properties.get("intensity"),u_lightcolor:[ve.r,ve.g,ve.b],u_vertical_gradient:+g,u_opacity:C,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:xf,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:S,u_edge_radius:D};return"globe"===xe.projection.name&&(ue.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],ue.u_zoom_transition=G,ue.u_inv_rot_matrix=ee,ue.u_merc_center=J,ue.u_up_dir=xe.projection.upVector(new _.CanonicalTileID(0,0,0),J[0]*_.EXTENT,J[1]*_.EXTENT),ue.u_height_lift=z),ue},md=(v,c,g,C,S,D,L,z,G,J,ee,re)=>{const fe=sh(v,c,g,C,S,D,L,G,J,ee,re),_e={u_height_factor:-Math.pow(2,L.overscaledZ)/z.tileSize/8};return _.extend(fe,Ii(c,z),_e)},ah=v=>({u_matrix:v}),Tu=(v,c,g)=>_.extend(ah(v),Ii(c,g)),Pp=(v,c)=>({u_matrix:v,u_world:c}),lh=(v,c,g,C)=>_.extend(Tu(v,c,g),{u_world:C}),To=_.create(),qt=(v,c,g,C,S,D)=>{const L=v.transform,z="globe"===L.projection.name;let G;if("map"===D.paint.get("circle-pitch-alignment"))if(z){const ee=_.globePixelsToTileUnits(L.zoom,c.canonical)*L._pixelsPerMercatorPixel;G=Float32Array.from([ee,0,0,ee])}else G=L.calculatePixelsToTileUnitsMatrix(g);else G=new Float32Array([L.pixelsToGLUnits[0],0,0,L.pixelsToGLUnits[1]]);const J={u_camera_to_center_distance:L.cameraToCenterDistance,u_matrix:v.translatePosMatrix(c.projMatrix,g,D.paint.get("circle-translate"),D.paint.get("circle-translate-anchor")),u_device_pixel_ratio:_.exported.devicePixelRatio,u_extrude_scale:G,u_inv_rot_matrix:To,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){J.u_inv_rot_matrix=C,J.u_merc_center=S,J.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],J.u_zoom_transition=_.globeToMercatorTransition(L.zoom);const ee=S[0]*_.EXTENT,re=S[1]*_.EXTENT;J.u_up_dir=L.projection.upVector(new _.CanonicalTileID(0,0,0),ee,re)}return J},ji=v=>{const c=[];return"map"===v.paint.get("circle-pitch-alignment")&&c.push("PITCH_WITH_MAP"),"map"===v.paint.get("circle-pitch-scale")&&c.push("SCALE_WITH_MAP"),c},Op=(v,c,g,C)=>{const S=_.EXTENT/g.tileSize;return{u_matrix:v,u_camera_to_center_distance:c.getCameraToCenterDistance(C),u_extrude_scale:[c.pixelsToGLUnits[0]/S,c.pixelsToGLUnits[1]/S]}},gd=(v,c,g=1)=>({u_matrix:v,u_color:c,u_overlay:0,u_overlay_scale:g}),Fo=_.create(),Wa=(v,c,g,C,S,D,L)=>{const z=v.transform,G="globe"===z.projection.name,J=G?_.globePixelsToTileUnits(z.zoom,c.canonical)*z._pixelsPerMercatorPixel:en(g,1,D),ee={u_matrix:c.projMatrix,u_extrude_scale:J,u_intensity:L,u_inv_rot_matrix:Fo,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(G){ee.u_inv_rot_matrix=C,ee.u_merc_center=S,ee.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],ee.u_zoom_transition=_.globeToMercatorTransition(z.zoom);const re=S[0]*_.EXTENT,fe=S[1]*_.EXTENT;ee.u_up_dir=z.projection.upVector(new _.CanonicalTileID(0,0,0),re,fe)}return ee},wl=(v,c,g,C,S,D,L)=>{const z=v.transform,G=z.calculatePixelsToTileUnitsMatrix(c);return{u_matrix:ch(v,c,g,C),u_pixels_to_tile_units:G,u_device_pixel_ratio:D,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:S,u_texsize:Uc(g)?c.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Vc(c,v.transform),u_alpha_discard_threshold:0,u_trim_offset:L}},Ya=(v,c,g,C,S)=>{const D=v.transform;return{u_matrix:ch(v,c,g,C),u_texsize:c.imageAtlasTexture.size,u_pixels_to_tile_units:D.calculatePixelsToTileUnitsMatrix(c),u_device_pixel_ratio:S,u_image:0,u_tile_units_to_pixels:Vc(c,D),u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Vc(v,c){return 1/en(v,1,c.tileZoom)}function ch(v,c,g,C){return v.translatePosMatrix(C||c.tileID.projMatrix,c,g.paint.get("line-translate"),g.paint.get("line-translate-anchor"))}function Uc(v){const c=v.paint.get("line-dasharray").value;return c.value||"constant"!==c.kind}const T_=(v,c,g,C,S,D)=>{return{u_matrix:v,u_tl_parent:c,u_scale_parent:g,u_fade_t:C.mix,u_opacity:C.opacity*S.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:S.paint.get("raster-brightness-min"),u_brightness_high:S.paint.get("raster-brightness-max"),u_saturation_factor:(z=S.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(L=S.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:Iu(S.paint.get("raster-hue-rotate")),u_perspective_transform:D};var L,z};function Iu(v){v*=Math.PI/180;const c=Math.sin(v),g=Math.cos(v);return[(2*g+1)/3,(-Math.sqrt(3)*c-g+1)/3,(Math.sqrt(3)*c-g+1)/3]}const Jo=_.create(),$o=(v,c,g,C,S,D,L,z,G,J,ee,re,fe,_e,de,ve)=>{const xe=S.transform,ue={u_is_size_zoom_constant:+("constant"===v||"source"===v),u_is_size_feature_constant:+("constant"===v||"camera"===v),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:xe.cameraToCenterDistance,u_rotate_symbol:+g,u_aspect_ratio:xe.width/xe.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:L,u_coord_matrix:z,u_is_text:+G,u_pitch_with_map:+C,u_texsize:J,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Jo,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Jo,u_up_vector:[0,-1,0]};return"globe"===ve.name&&(ue.u_tile_id=[ee.canonical.x,ee.canonical.y,1<<ee.canonical.z],ue.u_zoom_transition=re,ue.u_inv_rot_matrix=_e,ue.u_merc_center=fe,ue.u_camera_forward=xe._camera.forward(),ue.u_ecef_origin=_.globeECEFOrigin(xe.globeMatrix,ee.toUnwrapped()),ue.u_tile_matrix=Float32Array.from(xe.globeMatrix),ue.u_up_vector=de),ue},kp=(v,c,g,C,S,D,L,z,G,J,ee,re,fe,_e,de,ve,xe)=>_.extend($o(v,c,g,C,S,D,L,z,G,J,re,fe,_e,de,ve,xe),{u_gamma_scale:C?S.transform.cameraToCenterDistance*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:_.exported.devicePixelRatio,u_is_halo:+ee}),Cl=(v,c,g,C,S,D,L,z,G,J,ee,re,fe,_e,de,ve)=>_.extend(kp(v,c,g,C,S,D,L,z,!0,G,!0,ee,re,fe,_e,de,ve),{u_texsize_icon:J,u_texture_icon:1}),Ka=(v,c,g)=>({u_matrix:v,u_opacity:c,u_color:g}),uh=(v,c,g,C,S)=>_.extend(function(D,L,z){const G=L.imageManager.getPattern(D.toString()),{width:J,height:ee}=L.imageManager.getPixelSize(),re=Math.pow(2,z.tileID.overscaledZ),fe=z.tileSize*Math.pow(2,L.transform.tileZoom)/re,_e=fe*(z.tileID.canonical.x+z.tileID.wrap*re),de=fe*z.tileID.canonical.y;return{u_image:0,u_pattern_tl:G.tl,u_pattern_br:G.br,u_texsize:[J,ee],u_pattern_size:G.displaySize,u_tile_units_to_pixels:1/en(z,1,L.transform.tileZoom),u_pixel_coord_upper:[_e>>16,de>>16],u_pixel_coord_lower:[65535&_e,65535&de]}}(C,g,S),{u_matrix:v,u_opacity:c}),Rp={fillExtrusion:v=>({u_matrix:new _.UniformMatrix4f(v),u_lightpos:new _.Uniform3f(v),u_lightintensity:new _.Uniform1f(v),u_lightcolor:new _.Uniform3f(v),u_vertical_gradient:new _.Uniform1f(v),u_opacity:new _.Uniform1f(v),u_edge_radius:new _.Uniform1f(v),u_ao:new _.Uniform2f(v),u_tile_id:new _.Uniform3f(v),u_zoom_transition:new _.Uniform1f(v),u_inv_rot_matrix:new _.UniformMatrix4f(v),u_merc_center:new _.Uniform2f(v),u_up_dir:new _.Uniform3f(v),u_height_lift:new _.Uniform1f(v)}),fillExtrusionPattern:v=>({u_matrix:new _.UniformMatrix4f(v),u_lightpos:new _.Uniform3f(v),u_lightintensity:new _.Uniform1f(v),u_lightcolor:new _.Uniform3f(v),u_vertical_gradient:new _.Uniform1f(v),u_height_factor:new _.Uniform1f(v),u_edge_radius:new _.Uniform1f(v),u_ao:new _.Uniform2f(v),u_tile_id:new _.Uniform3f(v),u_zoom_transition:new _.Uniform1f(v),u_inv_rot_matrix:new _.UniformMatrix4f(v),u_merc_center:new _.Uniform2f(v),u_up_dir:new _.Uniform3f(v),u_height_lift:new _.Uniform1f(v),u_image:new _.Uniform1i(v),u_texsize:new _.Uniform2f(v),u_pixel_coord_upper:new _.Uniform2f(v),u_pixel_coord_lower:new _.Uniform2f(v),u_tile_units_to_pixels:new _.Uniform1f(v),u_opacity:new _.Uniform1f(v)}),fill:v=>({u_matrix:new _.UniformMatrix4f(v)}),fillPattern:v=>({u_matrix:new _.UniformMatrix4f(v),u_image:new _.Uniform1i(v),u_texsize:new _.Uniform2f(v),u_pixel_coord_upper:new _.Uniform2f(v),u_pixel_coord_lower:new _.Uniform2f(v),u_tile_units_to_pixels:new _.Uniform1f(v)}),fillOutline:v=>({u_matrix:new _.UniformMatrix4f(v),u_world:new _.Uniform2f(v)}),fillOutlinePattern:v=>({u_matrix:new _.UniformMatrix4f(v),u_world:new _.Uniform2f(v),u_image:new _.Uniform1i(v),u_texsize:new _.Uniform2f(v),u_pixel_coord_upper:new _.Uniform2f(v),u_pixel_coord_lower:new _.Uniform2f(v),u_tile_units_to_pixels:new _.Uniform1f(v)}),circle:v=>({u_camera_to_center_distance:new _.Uniform1f(v),u_extrude_scale:new _.UniformMatrix2f(v),u_device_pixel_ratio:new _.Uniform1f(v),u_matrix:new _.UniformMatrix4f(v),u_inv_rot_matrix:new _.UniformMatrix4f(v),u_merc_center:new _.Uniform2f(v),u_tile_id:new _.Uniform3f(v),u_zoom_transition:new _.Uniform1f(v),u_up_dir:new _.Uniform3f(v)}),collisionBox:v=>({u_matrix:new _.UniformMatrix4f(v),u_camera_to_center_distance:new _.Uniform1f(v),u_extrude_scale:new _.Uniform2f(v)}),collisionCircle:v=>({u_matrix:new _.UniformMatrix4f(v),u_inv_matrix:new _.UniformMatrix4f(v),u_camera_to_center_distance:new _.Uniform1f(v),u_viewport_size:new _.Uniform2f(v)}),debug:v=>({u_color:new _.UniformColor(v),u_matrix:new _.UniformMatrix4f(v),u_overlay:new _.Uniform1i(v),u_overlay_scale:new _.Uniform1f(v)}),clippingMask:v=>({u_matrix:new _.UniformMatrix4f(v)}),heatmap:v=>({u_extrude_scale:new _.Uniform1f(v),u_intensity:new _.Uniform1f(v),u_matrix:new _.UniformMatrix4f(v),u_inv_rot_matrix:new _.UniformMatrix4f(v),u_merc_center:new _.Uniform2f(v),u_tile_id:new _.Uniform3f(v),u_zoom_transition:new _.Uniform1f(v),u_up_dir:new _.Uniform3f(v)}),heatmapTexture:v=>({u_image:new _.Uniform1i(v),u_color_ramp:new _.Uniform1i(v),u_opacity:new _.Uniform1f(v)}),hillshade:v=>({u_matrix:new _.UniformMatrix4f(v),u_image:new _.Uniform1i(v),u_latrange:new _.Uniform2f(v),u_light:new _.Uniform2f(v),u_shadow:new _.UniformColor(v),u_highlight:new _.UniformColor(v),u_accent:new _.UniformColor(v)}),hillshadePrepare:v=>({u_matrix:new _.UniformMatrix4f(v),u_image:new _.Uniform1i(v),u_dimension:new _.Uniform2f(v),u_zoom:new _.Uniform1f(v),u_unpack:new _.Uniform4f(v)}),line:v=>({u_matrix:new _.UniformMatrix4f(v),u_pixels_to_tile_units:new _.UniformMatrix2f(v),u_device_pixel_ratio:new _.Uniform1f(v),u_units_to_pixels:new _.Uniform2f(v),u_dash_image:new _.Uniform1i(v),u_gradient_image:new _.Uniform1i(v),u_image_height:new _.Uniform1f(v),u_texsize:new _.Uniform2f(v),u_tile_units_to_pixels:new _.Uniform1f(v),u_alpha_discard_threshold:new _.Uniform1f(v),u_trim_offset:new _.Uniform2f(v)}),linePattern:v=>({u_matrix:new _.UniformMatrix4f(v),u_texsize:new _.Uniform2f(v),u_pixels_to_tile_units:new _.UniformMatrix2f(v),u_device_pixel_ratio:new _.Uniform1f(v),u_image:new _.Uniform1i(v),u_units_to_pixels:new _.Uniform2f(v),u_tile_units_to_pixels:new _.Uniform1f(v),u_alpha_discard_threshold:new _.Uniform1f(v)}),raster:v=>({u_matrix:new _.UniformMatrix4f(v),u_tl_parent:new _.Uniform2f(v),u_scale_parent:new _.Uniform1f(v),u_fade_t:new _.Uniform1f(v),u_opacity:new _.Uniform1f(v),u_image0:new _.Uniform1i(v),u_image1:new _.Uniform1i(v),u_brightness_low:new _.Uniform1f(v),u_brightness_high:new _.Uniform1f(v),u_saturation_factor:new _.Uniform1f(v),u_contrast_factor:new _.Uniform1f(v),u_spin_weights:new _.Uniform3f(v),u_perspective_transform:new _.Uniform2f(v)}),symbolIcon:v=>({u_is_size_zoom_constant:new _.Uniform1i(v),u_is_size_feature_constant:new _.Uniform1i(v),u_size_t:new _.Uniform1f(v),u_size:new _.Uniform1f(v),u_camera_to_center_distance:new _.Uniform1f(v),u_rotate_symbol:new _.Uniform1i(v),u_aspect_ratio:new _.Uniform1f(v),u_fade_change:new _.Uniform1f(v),u_matrix:new _.UniformMatrix4f(v),u_label_plane_matrix:new _.UniformMatrix4f(v),u_coord_matrix:new _.UniformMatrix4f(v),u_is_text:new _.Uniform1i(v),u_pitch_with_map:new _.Uniform1i(v),u_texsize:new _.Uniform2f(v),u_tile_id:new _.Uniform3f(v),u_zoom_transition:new _.Uniform1f(v),u_inv_rot_matrix:new _.UniformMatrix4f(v),u_merc_center:new _.Uniform2f(v),u_camera_forward:new _.Uniform3f(v),u_tile_matrix:new _.UniformMatrix4f(v),u_up_vector:new _.Uniform3f(v),u_ecef_origin:new _.Uniform3f(v),u_texture:new _.Uniform1i(v)}),symbolSDF:v=>({u_is_size_zoom_constant:new _.Uniform1i(v),u_is_size_feature_constant:new _.Uniform1i(v),u_size_t:new _.Uniform1f(v),u_size:new _.Uniform1f(v),u_camera_to_center_distance:new _.Uniform1f(v),u_rotate_symbol:new _.Uniform1i(v),u_aspect_ratio:new _.Uniform1f(v),u_fade_change:new _.Uniform1f(v),u_matrix:new _.UniformMatrix4f(v),u_label_plane_matrix:new _.UniformMatrix4f(v),u_coord_matrix:new _.UniformMatrix4f(v),u_is_text:new _.Uniform1i(v),u_pitch_with_map:new _.Uniform1i(v),u_texsize:new _.Uniform2f(v),u_texture:new _.Uniform1i(v),u_gamma_scale:new _.Uniform1f(v),u_device_pixel_ratio:new _.Uniform1f(v),u_tile_id:new _.Uniform3f(v),u_zoom_transition:new _.Uniform1f(v),u_inv_rot_matrix:new _.UniformMatrix4f(v),u_merc_center:new _.Uniform2f(v),u_camera_forward:new _.Uniform3f(v),u_tile_matrix:new _.UniformMatrix4f(v),u_up_vector:new _.Uniform3f(v),u_ecef_origin:new _.Uniform3f(v),u_is_halo:new _.Uniform1i(v)}),symbolTextAndIcon:v=>({u_is_size_zoom_constant:new _.Uniform1i(v),u_is_size_feature_constant:new _.Uniform1i(v),u_size_t:new _.Uniform1f(v),u_size:new _.Uniform1f(v),u_camera_to_center_distance:new _.Uniform1f(v),u_rotate_symbol:new _.Uniform1i(v),u_aspect_ratio:new _.Uniform1f(v),u_fade_change:new _.Uniform1f(v),u_matrix:new _.UniformMatrix4f(v),u_label_plane_matrix:new _.UniformMatrix4f(v),u_coord_matrix:new _.UniformMatrix4f(v),u_is_text:new _.Uniform1i(v),u_pitch_with_map:new _.Uniform1i(v),u_texsize:new _.Uniform2f(v),u_texsize_icon:new _.Uniform2f(v),u_texture:new _.Uniform1i(v),u_texture_icon:new _.Uniform1i(v),u_gamma_scale:new _.Uniform1f(v),u_device_pixel_ratio:new _.Uniform1f(v),u_is_halo:new _.Uniform1i(v)}),background:v=>({u_matrix:new _.UniformMatrix4f(v),u_opacity:new _.Uniform1f(v),u_color:new _.UniformColor(v)}),backgroundPattern:v=>({u_matrix:new _.UniformMatrix4f(v),u_opacity:new _.Uniform1f(v),u_image:new _.Uniform1i(v),u_pattern_tl:new _.Uniform2f(v),u_pattern_br:new _.Uniform2f(v),u_texsize:new _.Uniform2f(v),u_pattern_size:new _.Uniform2f(v),u_pixel_coord_upper:new _.Uniform2f(v),u_pixel_coord_lower:new _.Uniform2f(v),u_tile_units_to_pixels:new _.Uniform1f(v)}),terrainRaster:Lc,terrainDepth:Lc,skybox:v=>({u_matrix:new _.UniformMatrix4f(v),u_sun_direction:new _.Uniform3f(v),u_cubemap:new _.Uniform1i(v),u_opacity:new _.Uniform1f(v),u_temporal_offset:new _.Uniform1f(v)}),skyboxGradient:v=>({u_matrix:new _.UniformMatrix4f(v),u_color_ramp:new _.Uniform1i(v),u_center_direction:new _.Uniform3f(v),u_radius:new _.Uniform1f(v),u_opacity:new _.Uniform1f(v),u_temporal_offset:new _.Uniform1f(v)}),skyboxCapture:v=>({u_matrix_3f:new _.UniformMatrix3f(v),u_sun_direction:new _.Uniform3f(v),u_sun_intensity:new _.Uniform1f(v),u_color_tint_r:new _.Uniform4f(v),u_color_tint_m:new _.Uniform4f(v),u_luminance:new _.Uniform1f(v)}),globeRaster:v=>({u_proj_matrix:new _.UniformMatrix4f(v),u_globe_matrix:new _.UniformMatrix4f(v),u_normalize_matrix:new _.UniformMatrix4f(v),u_merc_matrix:new _.UniformMatrix4f(v),u_zoom_transition:new _.Uniform1f(v),u_merc_center:new _.Uniform2f(v),u_image0:new _.Uniform1i(v),u_grid_matrix:new _.UniformMatrix3f(v),u_skirt_height:new _.Uniform1f(v),u_frustum_tl:new _.Uniform3f(v),u_frustum_tr:new _.Uniform3f(v),u_frustum_br:new _.Uniform3f(v),u_frustum_bl:new _.Uniform3f(v),u_globe_pos:new _.Uniform3f(v),u_globe_radius:new _.Uniform1f(v),u_viewport:new _.Uniform2f(v)}),globeAtmosphere:v=>({u_frustum_tl:new _.Uniform3f(v),u_frustum_tr:new _.Uniform3f(v),u_frustum_br:new _.Uniform3f(v),u_frustum_bl:new _.Uniform3f(v),u_horizon:new _.Uniform1f(v),u_transition:new _.Uniform1f(v),u_fadeout_range:new _.Uniform1f(v),u_color:new _.Uniform4f(v),u_high_color:new _.Uniform4f(v),u_space_color:new _.Uniform4f(v),u_star_intensity:new _.Uniform1f(v),u_star_density:new _.Uniform1f(v),u_star_size:new _.Uniform1f(v),u_temporal_offset:new _.Uniform1f(v),u_horizon_angle:new _.Uniform1f(v),u_rotation_matrix:new _.UniformMatrix4f(v)})};let tc;function Fp(v,c,g,C,S,D,L){const z=v.context,G=z.gl,J=v.transform,ee=v.useProgram("collisionBox"),re=[];let fe=0,_e=0;for(let Me=0;Me<C.length;Me++){const Le=C[Me],Fe=c.getTile(Le),Ue=Fe.getBucket(g);if(!Ue)continue;const We=sa(Le,Ue,J);let it=We;0===S[0]&&0===S[1]||(it=v.translatePosMatrix(We,Fe,S,D));const st=L?Ue.textCollisionBox:Ue.iconCollisionBox,Ut=Ue.collisionCircleArray;if(Ut.length>0){const Qe=_.create(),St=it;_.mul(Qe,Ue.placementInvProjMatrix,J.glCoordMatrix),_.mul(Qe,Qe,Ue.placementViewportMatrix),re.push({circleArray:Ut,circleOffset:_e,transform:St,invTransform:Qe,projection:Ue.getProjection()}),fe+=Ut.length/4,_e=fe}st&&(v.terrain&&v.terrain.setupElevationDraw(Fe,ee),ee.draw(z,G.LINES,_.DepthMode.disabled,_.StencilMode.disabled,v.colorModeForRenderPass(),_.CullFaceMode.disabled,Op(it,J,Fe,Ue.getProjection()),g.id,st.layoutVertexBuffer,st.indexBuffer,st.segments,null,J.zoom,null,[st.collisionVertexBuffer,st.collisionVertexBufferExt]))}if(!L||!re.length)return;const de=v.useProgram("collisionCircle"),ve=new _.StructArrayLayout2f1f2i16;ve.resize(4*fe),ve._trim();let xe=0;for(const Me of re)for(let Le=0;Le<Me.circleArray.length/4;Le++){const Fe=4*Le,Ue=Me.circleArray[Fe+0],We=Me.circleArray[Fe+1],it=Me.circleArray[Fe+2],st=Me.circleArray[Fe+3];ve.emplace(xe++,Ue,We,it,st,0),ve.emplace(xe++,Ue,We,it,st,1),ve.emplace(xe++,Ue,We,it,st,2),ve.emplace(xe++,Ue,We,it,st,3)}(!tc||tc.length<2*fe)&&(tc=function(Me){const Le=2*Me,Fe=new _.StructArrayLayout3ui6;Fe.resize(Le),Fe._trim();for(let Ue=0;Ue<Le;Ue++){const We=6*Ue;Fe.uint16[We+0]=4*Ue+0,Fe.uint16[We+1]=4*Ue+1,Fe.uint16[We+2]=4*Ue+2,Fe.uint16[We+3]=4*Ue+2,Fe.uint16[We+4]=4*Ue+3,Fe.uint16[We+5]=4*Ue+0}return Fe}(fe));const ue=z.createIndexBuffer(tc,!0),Ce=z.createVertexBuffer(ve,_.collisionCircleLayout.members,!0);for(const Me of re){const Le={u_matrix:Me.transform,u_inv_matrix:Me.invTransform,u_camera_to_center_distance:(be=J).getCameraToCenterDistance(Me.projection),u_viewport_size:[be.width,be.height]};de.draw(z,G.TRIANGLES,_.DepthMode.disabled,_.StencilMode.disabled,v.colorModeForRenderPass(),_.CullFaceMode.disabled,Le,g.id,Ce,ue,_.SegmentVector.simpleSegment(0,2*Me.circleOffset,Me.circleArray.length,Me.circleArray.length/2),null,J.zoom)}var be;Ce.destroy(),ue.destroy()}const Ia=_.create();function dh({width:v,height:c,anchor:g,textOffset:C,textScale:S},D){const{horizontalAlign:L,verticalAlign:z}=_.getAnchorAlignment(g),G=-(L-.5)*v,J=-(z-.5)*c,ee=_.evaluateVariableOffset(g,C);return new _.pointGeometry((G/S+ee[0])*D,(J/S+ee[1])*D)}function Su(v,c,g,C,S,D,L,z,G,J,ee){const re=v.text.placedSymbolArray,fe=v.text.dynamicLayoutVertexArray,_e=v.icon.dynamicLayoutVertexArray,de={},ve=v.getProjection(),xe=Co(z,ve,D),ue=D.elevation,Ce=ve.upVectorScale(z.canonical,D.center.lat,D.worldSize).metersToTile;fe.clear();for(let be=0;be<re.length;be++){const Me=re.get(be),{tileAnchorX:Le,tileAnchorY:Fe,numGlyphs:Ue}=Me,it=Me.hidden||!Me.crossTileID||v.allowVerticalPlacement&&!Me.placedOrientation?null:C[Me.crossTileID];if(it){let st=0,Ut=0,Qe=0;if(ue){const dn=ue?ue.getAtTileOffset(z,Le,Fe):0,[Wn,_n,Yt]=ve.upVector(z.canonical,Le,Fe);st=dn*Wn*Ce,Ut=dn*_n*Ce,Qe=dn*Yt*Ce}let[St,at,Ot,et]=Ft(Me.projectedAnchorX+st,Me.projectedAnchorY+Ut,Me.projectedAnchorZ+Qe,g?xe:L);const qe=oi(D.getCameraToCenterDistance(ve),et);let Xe=S.evaluateSizeForFeature(v.textSizeData,J,Me)*qe/_.ONE_EM;g&&(Xe*=v.tilePixelRatio/G);const Mt=dh(it,Xe);g?(({x:St,y:at,z:Ot}=ve.projectTilePoint(Le+Mt.x,Fe+Mt.y,z.canonical)),[St,at,Ot]=Ft(St+st,at+Ut,Ot+Qe,L)):(c&&Mt._rotate(-D.angle),St+=Mt.x,at+=Mt.y,Ot=0);const Rt=v.allowVerticalPlacement&&Me.placedOrientation===_.WritingMode.vertical?Math.PI/2:0;for(let dn=0;dn<Ue;dn++)_.addDynamicAttributes(fe,St,at,Ot,Rt);ee&&Me.associatedIconIndex>=0&&(de[Me.associatedIconIndex]={x:St,y:at,z:Ot,angle:Rt})}else Ui(Ue,fe)}if(ee){_e.clear();const be=v.icon.placedSymbolArray;for(let Me=0;Me<be.length;Me++){const Le=be.get(Me),{numGlyphs:Fe}=Le,Ue=de[Me];if(Le.hidden||!Ue)Ui(Fe,_e);else{const{x:We,y:it,z:st,angle:Ut}=Ue;for(let Qe=0;Qe<Fe;Qe++)_.addDynamicAttributes(_e,We,it,st,Ut)}}v.icon.dynamicLayoutVertexBuffer.updateData(_e)}v.text.dynamicLayoutVertexBuffer.updateData(fe)}function Lp(v,c,g){return g.iconsInText&&c?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function eg(v,c,g,C,S,D,L,z,G,J,ee,re){const fe=v.context,_e=fe.gl,de=v.transform,ve="map"===z,xe="map"===G,ue=ve&&"point"!==g.layout.get("symbol-placement"),Ce=ve&&!xe&&!ue,be=void 0!==g.layout.get("symbol-sort-key").constantOr(1);let Me=!1;const Le=v.depthModeForSublayer(0,_.DepthMode.ReadOnly),Fe=[_.mercatorXfromLng(de.center.lng),_.mercatorYfromLat(de.center.lat)],Ue=g.layout.get("text-variable-anchor"),We="globe"===de.projection.name,it=[],st=[0,-1,0];let Ut=st;!We&&!de.mercatorFromTransition||ve||(Ut=function(Qe){const St=Qe._camera.getWorldToCamera(Qe.worldSize,1),at=_.multiply([],St,Qe.globeMatrix);_.invert(at,at);const Ot=[0,0,0],et=[0,1,0,0];return _.transformMat4$1(et,et,at),Ot[0]=et[0],Ot[1]=et[1],Ot[2]=et[2],_.normalize(Ot,Ot),Ot}(de));for(const Qe of C){const St=c.getTile(Qe),at=St.getBucket(g);if(!at||"mercator"===at.projection.name&&We)continue;const Ot=S?at.text:at.icon;if(!Ot||at.fullyClipped||!Ot.segments.get().length)continue;const et=Ot.programConfigurations.get(g.id),qe=S||at.sdfIcons,Xe=S?at.textSizeData:at.iconSizeData,Mt=xe||0!==de.pitch,Rt=_.evaluateSizeForZoom(Xe,de.zoom);let dn,Wn,_n,Yt,yn=[0,0],xi=null;if(S)Wn=St.glyphAtlasTexture,_n=_e.LINEAR,dn=St.glyphAtlasTexture.size,at.iconsInText&&(yn=St.imageAtlasTexture.size,xi=St.imageAtlasTexture,Yt=Mt||v.options.rotating||v.options.zooming||"composite"===Xe.kind||"camera"===Xe.kind?_e.LINEAR:_e.NEAREST);else{const Wr=1!==g.layout.get("icon-size").constantOr(0)||at.iconsNeedLinear;Wn=St.imageAtlasTexture,_n=qe||v.options.rotating||v.options.zooming||Wr||Mt?_e.LINEAR:_e.NEAREST,dn=St.imageAtlasTexture.size}const Vn="globe"===at.projection.name,er=Vn?Ut:st,Ri=Vn?_.globeToMercatorTransition(de.zoom):0,or=Co(Qe,at.getProjection(),de),vi=de.calculatePixelsToTileUnitsMatrix(St),Dr=Ms(or,St.tileID.canonical,xe,ve,de,at.getProjection(),vi),Ws=v.terrain&&xe&&ue?_.invert(_.create(),Dr):Ia,$s=Ti(or,St.tileID.canonical,xe,ve,de,at.getProjection(),vi),ka=Ue&&at.hasTextData(),Tr="none"!==g.layout.get("icon-text-fit")&&ka&&at.hasIconData();if(ue){const Wr=de.elevation,Ys=Wr?Wr.getAtTileOffsetFunc(Qe,de.center.lat,de.worldSize,at.getProjection()):null,ma=Mn(or,St.tileID.canonical,xe,ve,de,at.getProjection(),vi);Qi(at,or,v,S,ma,$s,xe,J,Ys,Qe)}const sr=ue||S&&Ue||Tr,Yi=v.translatePosMatrix(or,St,D,L),Fr=sr?Ia:Dr,Qn=v.translatePosMatrix($s,St,D,L,!0),Fi=at.getProjection().createInversionMatrix(de,Qe.canonical),bs=[];v.terrainRenderModeElevated()&&xe&&bs.push("PITCH_WITH_MAP_TERRAIN"),Vn&&bs.push("PROJECTION_GLOBE_VIEW"),sr&&bs.push("PROJECTED_POS_ON_VIEWPORT");const mo=qe&&0!==g.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1);let oc;oc=qe?at.iconsInText?Cl(Xe.kind,Rt,Ce,xe,v,Yi,Fr,Qn,dn,yn,Qe,Ri,Fe,Fi,er,at.getProjection()):kp(Xe.kind,Rt,Ce,xe,v,Yi,Fr,Qn,S,dn,!0,Qe,Ri,Fe,Fi,er,at.getProjection()):$o(Xe.kind,Rt,Ce,xe,v,Yi,Fr,Qn,S,dn,Qe,Ri,Fe,Fi,er,at.getProjection());const Qc={program:v.useProgram(Lp(qe,S,at),et,bs),buffers:Ot,uniformValues:oc,atlasTexture:Wn,atlasTextureIcon:xi,atlasInterpolation:_n,atlasInterpolationIcon:Yt,isSDF:qe,hasHalo:mo,tile:St,labelPlaneMatrixInv:Ws};if(be&&at.canOverlap){Me=!0;const Wr=Ot.segments.get();for(const Ys of Wr)it.push({segments:new _.SegmentVector([Ys]),sortKey:Ys.sortKey,state:Qc})}else it.push({segments:Ot.segments,sortKey:0,state:Qc})}Me&&it.sort((Qe,St)=>Qe.sortKey-St.sortKey);for(const Qe of it){const St=Qe.state;if(v.terrain&&v.terrain.setupElevationDraw(St.tile,St.program,{useDepthForOcclusion:!We,labelPlaneMatrixInv:St.labelPlaneMatrixInv}),fe.activeTexture.set(_e.TEXTURE0),St.atlasTexture.bind(St.atlasInterpolation,_e.CLAMP_TO_EDGE),St.atlasTextureIcon&&(fe.activeTexture.set(_e.TEXTURE1),St.atlasTextureIcon&&St.atlasTextureIcon.bind(St.atlasInterpolationIcon,_e.CLAMP_TO_EDGE)),St.isSDF){const at=St.uniformValues;St.hasHalo&&(at.u_is_halo=1,Np(St.buffers,Qe.segments,g,v,St.program,Le,ee,re,at)),at.u_is_halo=0}Np(St.buffers,Qe.segments,g,v,St.program,Le,ee,re,St.uniformValues)}}function Np(v,c,g,C,S,D,L,z,G){const J=C.context,ee=[v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer,v.globeExtVertexBuffer];S.draw(J,J.gl.TRIANGLES,D,L,z,_.CullFaceMode.disabled,G,g.id,v.layoutVertexBuffer,v.indexBuffer,c,g.paint,C.transform.zoom,v.programConfigurations.get(g.id),ee)}function wf(v,c,g,C,S,D,L){const z=v.context.gl,G=g.paint.get("fill-pattern"),J=G&&G.constantOr(1);let ee,re,fe,_e,de;L?(re=J&&!g.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ee=z.LINES):(re=J?"fillPattern":"fill",ee=z.TRIANGLES);for(const ve of C){const xe=c.getTile(ve);if(J&&!xe.patternsLoaded())continue;const ue=xe.getBucket(g);if(!ue)continue;v.prepareDrawTile();const Ce=ue.programConfigurations.get(g.id),be=v.useProgram(re,Ce);J&&(v.context.activeTexture.set(z.TEXTURE0),xe.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),Ce.updatePaintBuffers());const Me=G.constantOr(null);if(Me&&xe.imageAtlas){const Fe=xe.imageAtlas.patternPositions[Me.toString()];Fe&&Ce.setConstantPatternPositions(Fe)}const Le=v.translatePosMatrix(ve.projMatrix,xe,g.paint.get("fill-translate"),g.paint.get("fill-translate-anchor"));if(L){_e=ue.indexBuffer2,de=ue.segments2;const Fe=v.terrain&&v.terrain.renderingToTexture?v.terrain.drapeBufferSize:[z.drawingBufferWidth,z.drawingBufferHeight];fe="fillOutlinePattern"===re&&J?lh(Le,v,xe,Fe):Pp(Le,Fe)}else _e=ue.indexBuffer,de=ue.segments,fe=J?Tu(Le,v,xe):ah(Le);v.prepareDrawProgram(v.context,be,ve.toUnwrapped()),be.draw(v.context,ee,S,v.stencilModeForClipping(ve),D,_.CullFaceMode.disabled,fe,g.id,ue.layoutVertexBuffer,_e,de,g.paint,v.transform.zoom,Ce)}}function zp(v,c,g,C,S,D,L){const z=v.context,G=z.gl,J=v.transform,ee=g.paint.get("fill-extrusion-pattern"),re=ee.constantOr(1),fe=g.paint.get("fill-extrusion-opacity"),_e=[g.paint.get("fill-extrusion-ambient-occlusion-intensity"),g.paint.get("fill-extrusion-ambient-occlusion-radius")],de=g.layout.get("fill-extrusion-edge-radius"),ve="globe"===J.projection.name?_.fillExtrusionHeightLift():0,xe="globe"===J.projection.name,ue=xe?_.globeToMercatorTransition(J.zoom):0,Ce=[_.mercatorXfromLng(J.center.lng),_.mercatorYfromLat(J.center.lat)],be=[];xe&&be.push("PROJECTION_GLOBE_VIEW"),_e[0]>0&&be.push("FAUX_AO");for(const Me of C){const Le=c.getTile(Me),Fe=Le.getBucket(g);if(!Fe||Fe.projection.name!==J.projection.name)continue;const Ue=Fe.programConfigurations.get(g.id),We=v.useProgram(re?"fillExtrusionPattern":"fillExtrusion",Ue,be);if(v.terrain){const Ot=v.terrain;if(v.style.terrainSetForDrapingOnly())Ot.setupElevationDraw(Le,We,{useMeterToDem:!0});else{if(!Fe.enableTerrain)continue;if(Ot.setupElevationDraw(Le,We,{useMeterToDem:!0}),tg(z,c,Me,Fe,g,Ot),!Fe.centroidVertexBuffer){const et=We.attributes.a_centroid_pos;void 0!==et&&G.vertexAttrib2f(et,0,0)}}}re&&(v.context.activeTexture.set(G.TEXTURE0),Le.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),Ue.updatePaintBuffers());const it=ee.constantOr(null);if(it&&Le.imageAtlas){const Ot=Le.imageAtlas.patternPositions[it.toString()];Ot&&Ue.setConstantPatternPositions(Ot)}const st=v.translatePosMatrix(Me.projMatrix,Le,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),Ut=J.projection.createInversionMatrix(J,Me.canonical),Qe=g.paint.get("fill-extrusion-vertical-gradient"),St=re?md(st,v,Qe,fe,_e,de,Me,Le,ve,ue,Ce,Ut):sh(st,v,Qe,fe,_e,de,Me,ve,ue,Ce,Ut);v.prepareDrawProgram(z,We,Me.toUnwrapped());const at=[];v.terrain&&at.push(Fe.centroidVertexBuffer),xe&&at.push(Fe.layoutVertexExtBuffer),We.draw(z,z.gl.TRIANGLES,S,D,L,_.CullFaceMode.backCCW,St,g.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,g.paint,v.transform.zoom,Ue,at)}}function tg(v,c,g,C,S,D){const L=[ue=>{let Ce=ue.canonical.x-1,be=ue.wrap;return Ce<0&&(Ce=(1<<ue.canonical.z)-1,be--),new _.OverscaledTileID(ue.overscaledZ,be,ue.canonical.z,Ce,ue.canonical.y)},ue=>{let Ce=ue.canonical.x+1,be=ue.wrap;return Ce===1<<ue.canonical.z&&(Ce=0,be++),new _.OverscaledTileID(ue.overscaledZ,be,ue.canonical.z,Ce,ue.canonical.y)},ue=>new _.OverscaledTileID(ue.overscaledZ,ue.wrap,ue.canonical.z,ue.canonical.x,(0===ue.canonical.y?1<<ue.canonical.z:ue.canonical.y)-1),ue=>new _.OverscaledTileID(ue.overscaledZ,ue.wrap,ue.canonical.z,ue.canonical.x,ue.canonical.y===(1<<ue.canonical.z)-1?0:ue.canonical.y+1)],z=ue=>{const Ce=c.getSource().minzoom,be=Le=>{const Fe=c.getTileByID(Le);if(Fe&&Fe.hasData())return Fe.getBucket(S)},Me=[0,-1,1];for(const Le of Me){if(ue.overscaledZ+Le<Ce)continue;const Fe=be(ue.calculateScaledKey(ue.overscaledZ+Le));if(Fe)return Fe}},G=[0,0,0],J=(ue,Ce)=>(G[0]=Math.min(ue.min.y,Ce.min.y),G[1]=Math.max(ue.max.y,Ce.max.y),G[2]=_.EXTENT-Ce.min.x>ue.max.x?Ce.min.x-_.EXTENT:ue.max.x,G),ee=(ue,Ce)=>(G[0]=Math.min(ue.min.x,Ce.min.x),G[1]=Math.max(ue.max.x,Ce.max.x),G[2]=_.EXTENT-Ce.min.y>ue.max.y?Ce.min.y-_.EXTENT:ue.max.y,G),re=[(ue,Ce)=>J(ue,Ce),(ue,Ce)=>J(Ce,ue),(ue,Ce)=>ee(ue,Ce),(ue,Ce)=>ee(Ce,ue)],fe=new _.pointGeometry(0,0);let _e,de,ve;const xe=(ue,Ce,be,Me,Le)=>{const Fe=[[Me?be:ue,Me?ue:be,0],[Me?be:Ce,Me?Ce:be,0]],Ue=Le<0?_.EXTENT+Le:Le,We=[Me?Ue:(ue+Ce)/2,Me?(ue+Ce)/2:Ue,0];return 0===be&&Le<0||0!==be&&Le>0?D.getForTilePoints(ve,[We],!0,de):Fe.push(We),D.getForTilePoints(g,Fe,!0,_e),Math.max(Fe[0][2],Fe[1][2],We[2])/D.exaggeration()};for(let ue=0;ue<4;ue++){const Ce=(ue<2?1:5)-ue,be=C.borders[ue];if(0===be.length)continue;const Me=ve=L[ue](g),Le=z(Me);if(!(Le&&Le instanceof _.FillExtrusionBucket&&Le.enableTerrain)||C.borderDoneWithNeighborZ[ue]===Le.canonical.z&&Le.borderDoneWithNeighborZ[Ce]===C.canonical.z||(de=D.findDEMTileFor(Me),!de||!de.dem))continue;if(!_e){const it=D.findDEMTileFor(g);if(!it||!it.dem)return;_e=it}const Fe=Le.borders[Ce];let Ue=0;const We=Le.borderDoneWithNeighborZ[Ce]!==C.canonical.z;if(C.canonical.z===Le.canonical.z){for(let it=0;it<be.length;it++){const st=C.featuresOnBorder[be[it]],Ut=st.borders[ue];let Qe;for(;Ue<Fe.length&&(Qe=Le.featuresOnBorder[Fe[Ue]],!(Qe.borders[Ce][1]>Ut[0]+3));)We&&Le.encodeCentroid(void 0,Qe,!1),Ue++;if(Qe&&Ue<Fe.length){const St=Ue;let at=0;for(;!(Qe.borders[Ce][0]>Ut[1]-3)&&(at++,++Ue!==Fe.length);)Qe=Le.featuresOnBorder[Fe[Ue]];if(Qe=Le.featuresOnBorder[Fe[St]],st.intersectsCount()>1||Qe.intersectsCount()>1||1!==at){1!==at&&(Ue=St),C.encodeCentroid(void 0,st,!1),We&&Le.encodeCentroid(void 0,Qe,!1);continue}const Ot=re[ue](st,Qe),et=ue%2?_.EXTENT-1:0;fe.x=xe(Ot[0],Math.min(_.EXTENT-1,Ot[1]),et,ue<2,Ot[2]),fe.y=0,C.encodeCentroid(fe,st,!1),We&&Le.encodeCentroid(fe,Qe,!1)}else C.encodeCentroid(void 0,st,!1)}C.borderDoneWithNeighborZ[ue]=Le.canonical.z,C.needsCentroidUpdate=!0,We&&(Le.borderDoneWithNeighborZ[Ce]=C.canonical.z,Le.needsCentroidUpdate=!0)}else{for(const it of be)C.encodeCentroid(void 0,C.featuresOnBorder[it],!1);if(We){for(const it of Fe)Le.encodeCentroid(void 0,Le.featuresOnBorder[it],!1);Le.borderDoneWithNeighborZ[Ce]=C.canonical.z,Le.needsCentroidUpdate=!0}C.borderDoneWithNeighborZ[ue]=Le.canonical.z,C.needsCentroidUpdate=!0}}(C.needsCentroidUpdate||!C.centroidVertexBuffer&&0!==C.centroidVertexArray.length)&&C.uploadCentroid(v)}const Cf=new _.Color(1,0,0,1),Ef=new _.Color(0,1,0,1),Tf=new _.Color(0,0,1,1),I_=new _.Color(1,0,1,1),ng=new _.Color(0,1,1,1);function vs(v,c,g){const C=v.context,S=v.transform,D=C.gl,L="globe"===S.projection.name,z=L?["PROJECTION_GLOBE_VIEW"]:null;let G=g.projMatrix;if(L&&_.globeToMercatorTransition(S.zoom)>0){const st=_.transitionTileAABBinECEF(g.canonical,S),Ut=_.globeDenormalizeECEF(st);G=_.multiply(new Float32Array(16),S.globeMatrix,Ut),_.multiply(G,S.projMatrix,G)}const J=v.useProgram("debug",null,z),ee=c.getTileByID(g.key);v.terrain&&v.terrain.setupElevationDraw(ee,J);const re=_.DepthMode.disabled,fe=_.StencilMode.disabled,_e=v.colorModeForRenderPass();C.activeTexture.set(D.TEXTURE0),v.emptyTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),L?ee._makeGlobeTileDebugBuffers(v.context,S):ee._makeDebugTileBoundsBuffers(v.context,S.projection);const ve=ee._tileDebugBuffer||v.debugBuffer,xe=ee._tileDebugIndexBuffer||v.debugIndexBuffer,ue=ee._tileDebugSegments||v.debugSegments;J.draw(C,D.LINE_STRIP,re,fe,_e,_.CullFaceMode.disabled,gd(G,_.Color.red),"$debug",ve,xe,ue,null,null,null,[ee._globeTileDebugBorderBuffer]);const Ce=ee.latestRawTileData,be=Math.floor((Ce&&Ce.byteLength||0)/1024),Me=c.getTile(g).tileSize,Le=512/Math.min(Me,512)*(g.overscaledZ/S.zoom)*.5;let Fe=g.canonical.toString();g.overscaledZ!==g.canonical.z&&(Fe+=` => ${g.overscaledZ}`),Fe+=` ${be}kb`,function(st,Ut){st.initDebugOverlayCanvas();const Qe=st.debugOverlayCanvas,St=st.context.gl,at=st.debugOverlayCanvas.getContext("2d");at.clearRect(0,0,Qe.width,Qe.height),at.shadowColor="white",at.shadowBlur=2,at.lineWidth=1.5,at.strokeStyle="white",at.textBaseline="top",at.font="bold 36px Open Sans, sans-serif",at.fillText(Ut,5,5),at.strokeText(Ut,5,5),st.debugOverlayTexture.update(Qe),st.debugOverlayTexture.bind(St.LINEAR,St.CLAMP_TO_EDGE)}(v,Fe);const Ue=ee._tileDebugTextBuffer||v.debugBuffer,We=ee._tileDebugTextIndexBuffer||v.quadTriangleIndexBuffer,it=ee._tileDebugTextSegments||v.debugSegments;J.draw(C,D.TRIANGLES,re,fe,_.ColorMode.alphaBlended,_.CullFaceMode.disabled,gd(G,_.Color.transparent,Le),"$debug",Ue,We,it,null,null,null,[ee._globeTileDebugTextBuffer])}function As(v,c,g,C){jc(v,0,c+g/2,v.transform.width,g,C)}function pr(v,c,g,C){jc(v,c-g/2,0,g,v.transform.height,C)}function jc(v,c,g,C,S,D){const L=v.context,z=L.gl;z.enable(z.SCISSOR_TEST),z.scissor(c*_.exported.devicePixelRatio,g*_.exported.devicePixelRatio,C*_.exported.devicePixelRatio,S*_.exported.devicePixelRatio),L.clear({color:D}),z.disable(z.SCISSOR_TEST)}const _d=_.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Mu}=_d;function nc(v,c,g,C){v.emplaceBack(c,g,C)}class Bp{constructor(c){this.vertexArray=new _.StructArrayLayout3f12,this.indices=new _.StructArrayLayout3ui6,nc(this.vertexArray,-1,-1,1),nc(this.vertexArray,1,-1,1),nc(this.vertexArray,-1,1,1),nc(this.vertexArray,1,1,1),nc(this.vertexArray,-1,-1,-1),nc(this.vertexArray,1,-1,-1),nc(this.vertexArray,-1,1,-1),nc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=c.createVertexBuffer(this.vertexArray,Mu),this.indexBuffer=c.createIndexBuffer(this.indices),this.segment=_.SegmentVector.simpleSegment(0,0,36,12)}}function Hi(v,c,g,C,S,D){const L=v.gl,z=c.paint.get("sky-atmosphere-color"),G=c.paint.get("sky-atmosphere-halo-color"),J=c.paint.get("sky-atmosphere-sun-intensity"),ee={u_matrix_3f:_.fromMat4(_.create$1(),C),u_sun_direction:S,u_sun_intensity:J,u_color_tint_r:[(de=z).r,de.g,de.b,de.a],u_color_tint_m:[(ve=G).r,ve.g,ve.b,ve.a],u_luminance:5e-5};var de,ve;L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_CUBE_MAP_POSITIVE_X+D,c.skyboxTexture,0),g.draw(v,L.TRIANGLES,_.DepthMode.disabled,_.StencilMode.disabled,_.ColorMode.unblended,_.CullFaceMode.frontCW,ee,"skyboxCapture",c.skyboxGeometry.vertexBuffer,c.skyboxGeometry.indexBuffer,c.skyboxGeometry.segment)}const Du=_.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class yd{constructor(c){const g=new _.StructArrayLayout5f20;g.emplaceBack(-1,1,1,0,0),g.emplaceBack(1,1,1,1,0),g.emplaceBack(1,-1,1,1,1),g.emplaceBack(-1,-1,1,0,1);const C=new _.StructArrayLayout3ui6;C.emplaceBack(0,1,2),C.emplaceBack(2,3,0),this.vertexBuffer=c.createVertexBuffer(g,Du.members),this.indexBuffer=c.createIndexBuffer(C),this.segments=_.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ic={symbol:function(v,c,g,C,S){if("translucent"!==v.renderPass)return;const D=_.StencilMode.disabled,L=v.colorModeForRenderPass();g.layout.get("text-variable-anchor")&&function(z,G,J,ee,re,fe,_e){const de=G.transform,ve="map"===re,xe="map"===fe;for(const ue of z){const Ce=ee.getTile(ue),be=Ce.getBucket(J);if(!be||!be.text||!be.text.segments.get().length)continue;const Me=_.evaluateSizeForZoom(be.textSizeData,de.zoom),Le=Co(ue,be.getProjection(),de),Fe=de.calculatePixelsToTileUnitsMatrix(Ce),Ue=Ms(Le,Ce.tileID.canonical,xe,ve,de,be.getProjection(),Fe),We="none"!==J.layout.get("icon-text-fit")&&be.hasIconData();if(Me){const it=Math.pow(2,de.zoom-Ce.tileID.overscaledZ);Su(be,ve,xe,_e,_.symbolSize,de,Ue,ue,it,Me,We)}}}(C,v,g,c,g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),S),0!==g.paint.get("icon-opacity").constantOr(1)&&eg(v,c,g,C,!1,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),g.layout.get("icon-rotation-alignment"),g.layout.get("icon-pitch-alignment"),g.layout.get("icon-keep-upright"),D,L),0!==g.paint.get("text-opacity").constantOr(1)&&eg(v,c,g,C,!0,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),g.layout.get("text-keep-upright"),D,L),c.map.showCollisionBoxes&&(Fp(v,c,g,C,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),!0),Fp(v,c,g,C,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),!1))},circle:function(v,c,g,C){if("translucent"!==v.renderPass)return;const S=g.paint.get("circle-opacity"),D=g.paint.get("circle-stroke-width"),L=g.paint.get("circle-stroke-opacity"),z=void 0!==g.layout.get("circle-sort-key").constantOr(1);if(0===S.constantOr(1)&&(0===D.constantOr(1)||0===L.constantOr(1)))return;const G=v.context,J=G.gl,ee=v.transform,re=v.depthModeForSublayer(0,_.DepthMode.ReadOnly),fe=_.StencilMode.disabled,_e=v.colorModeForRenderPass(),de="globe"===ee.projection.name,ve=[_.mercatorXfromLng(ee.center.lng),_.mercatorYfromLat(ee.center.lat)],xe=[];for(let Ce=0;Ce<C.length;Ce++){const be=C[Ce],Me=c.getTile(be),Le=Me.getBucket(g);if(!Le||Le.projection.name!==ee.projection.name)continue;const Fe=Le.programConfigurations.get(g.id),Ue=ji(g);de&&Ue.push("PROJECTION_GLOBE_VIEW");const We=v.useProgram("circle",Fe,Ue),it=Le.layoutVertexBuffer,st=Le.globeExtVertexBuffer,Ut=Le.indexBuffer,Qe=ee.projection.createInversionMatrix(ee,be.canonical),St={programConfiguration:Fe,program:We,layoutVertexBuffer:it,globeExtVertexBuffer:st,indexBuffer:Ut,uniformValues:qt(v,be,Me,Qe,ve,g),tile:Me};if(z){const at=Le.segments.get();for(const Ot of at)xe.push({segments:new _.SegmentVector([Ot]),sortKey:Ot.sortKey,state:St})}else xe.push({segments:Le.segments,sortKey:0,state:St})}z&&xe.sort((Ce,be)=>Ce.sortKey-be.sortKey);const ue={useDepthForOcclusion:!de};for(const Ce of xe){const{programConfiguration:be,program:Me,layoutVertexBuffer:Le,globeExtVertexBuffer:Fe,indexBuffer:Ue,uniformValues:We,tile:it}=Ce.state,st=Ce.segments;v.terrain&&v.terrain.setupElevationDraw(it,Me,ue),v.prepareDrawProgram(G,Me,it.tileID.toUnwrapped()),Me.draw(G,J.TRIANGLES,re,fe,_e,_.CullFaceMode.disabled,We,g.id,Le,Ue,st,g.paint,ee.zoom,be,[Fe])}},heatmap:function(v,c,g,C){if(0!==g.paint.get("heatmap-opacity"))if("offscreen"===v.renderPass){const S=v.context,D=S.gl,L=_.StencilMode.disabled,z=new _.ColorMode([D.ONE,D.ONE],_.Color.transparent,[!0,!0,!0,!0]);(function(_e,de,ve,xe){const ue=_e.gl,Ce=de.width*xe,be=de.height*xe;_e.activeTexture.set(ue.TEXTURE1),_e.viewport.set([0,0,Ce,be]);let Me=ve.heatmapFbo;if(!Me||Me&&(Me.width!==Ce||Me.height!==be)){Me&&Me.destroy();const Le=ue.createTexture();ue.bindTexture(ue.TEXTURE_2D,Le),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MAG_FILTER,ue.LINEAR),Me=ve.heatmapFbo=_e.createFramebuffer(Ce,be,!1),function(Fe,Ue,We,it,st,Ut){const Qe=Fe.gl;Qe.texImage2D(Qe.TEXTURE_2D,0,Fe.isWebGL2&&Fe.extRenderToTextureHalfFloat?Qe.RGBA16F:Qe.RGBA,st,Ut,0,Qe.RGBA,Fe.extRenderToTextureHalfFloat?Fe.isWebGL2?Qe.HALF_FLOAT:Fe.extTextureHalfFloat.HALF_FLOAT_OES:Qe.UNSIGNED_BYTE,null),it.colorAttachment.set(We)}(_e,0,Le,Me,Ce,be)}else ue.bindTexture(ue.TEXTURE_2D,Me.colorAttachment.get()),_e.bindFramebuffer.set(Me.framebuffer)})(S,v,g,"globe"===v.transform.projection.name?.5:.25),S.clear({color:_.Color.transparent});const G=v.transform,J="globe"===G.projection.name,ee=J?["PROJECTION_GLOBE_VIEW"]:null,re=J?_.CullFaceMode.frontCCW:_.CullFaceMode.disabled,fe=[_.mercatorXfromLng(G.center.lng),_.mercatorYfromLat(G.center.lat)];for(let _e=0;_e<C.length;_e++){const de=C[_e];if(c.hasRenderableParent(de))continue;const ve=c.getTile(de),xe=ve.getBucket(g);if(!xe||xe.projection.name!==G.projection.name)continue;const ue=xe.programConfigurations.get(g.id),Ce=v.useProgram("heatmap",ue,ee),{zoom:be}=v.transform;v.terrain&&v.terrain.setupElevationDraw(ve,Ce),v.prepareDrawProgram(S,Ce,de.toUnwrapped());const Me=G.projection.createInversionMatrix(G,de.canonical);Ce.draw(S,D.TRIANGLES,_.DepthMode.disabled,L,z,re,Wa(v,de,ve,Me,fe,be,g.paint.get("heatmap-intensity")),g.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,g.paint,v.transform.zoom,ue,J?[xe.globeExtVertexBuffer]:null)}S.viewport.set([0,0,v.width,v.height])}else"translucent"===v.renderPass&&(v.context.setColorMode(v.colorModeForRenderPass()),function(S,D){const L=S.context,z=L.gl,G=D.heatmapFbo;if(!G)return;L.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,G.colorAttachment.get()),L.activeTexture.set(z.TEXTURE1);let J=D.colorRampTexture;J||(J=D.colorRampTexture=new _.Texture(L,D.colorRamp,z.RGBA)),J.bind(z.LINEAR,z.CLAMP_TO_EDGE),S.useProgram("heatmapTexture").draw(L,z.TRIANGLES,_.DepthMode.disabled,_.StencilMode.disabled,S.colorModeForRenderPass(),_.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:D.paint.get("heatmap-opacity")},D.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,D.paint,S.transform.zoom)}(v,g))},line:function(v,c,g,C){if("translucent"!==v.renderPass)return;const S=g.paint.get("line-opacity"),D=g.paint.get("line-width");if(0===S.constantOr(1)||0===D.constantOr(1))return;const L=v.depthModeForSublayer(0,_.DepthMode.ReadOnly),z=v.colorModeForRenderPass(),G=v.terrain&&v.terrain.renderingToTexture?1:_.exported.devicePixelRatio,J=g.paint.get("line-dasharray"),ee=J.constantOr(1),re=g.layout.get("line-cap"),fe=g.paint.get("line-pattern"),_e=fe.constantOr(1),de=g.paint.get("line-gradient"),ve=_e?"linePattern":"line",xe=v.context,ue=xe.gl,Ce=(Me=>{const Le=[];Uc(Me)&&Le.push("RENDER_LINE_DASH"),Me.paint.get("line-gradient")&&Le.push("RENDER_LINE_GRADIENT");const Fe=Me.paint.get("line-trim-offset");0===Fe[0]&&0===Fe[1]||Le.push("RENDER_LINE_TRIM_OFFSET");const Ue=Me.paint.get("line-pattern").constantOr(1),We=1!==Me.paint.get("line-opacity").constantOr(1);return!Ue&&We&&Le.push("RENDER_LINE_ALPHA_DISCARD"),Le})(g);let be=Ce.includes("RENDER_LINE_ALPHA_DISCARD");v.terrain&&v.terrain.clipOrMaskOverlapStencilType()&&(be=!1);for(const Me of C){const Le=c.getTile(Me);if(_e&&!Le.patternsLoaded())continue;const Fe=Le.getBucket(g);if(!Fe)continue;v.prepareDrawTile();const Ue=Fe.programConfigurations.get(g.id),We=v.useProgram(ve,Ue,Ce),it=fe.constantOr(null);if(it&&Le.imageAtlas){const qe=Le.imageAtlas.patternPositions[it.toString()];qe&&Ue.setConstantPatternPositions(qe)}const st=J.constantOr(null),Ut=re.constantOr(null);if(!_e&&st&&Ut&&Le.lineAtlas){const qe=Le.lineAtlas.getDash(st,Ut);qe&&Ue.setConstantPatternPositions(qe)}let[Qe,St]=g.paint.get("line-trim-offset");("round"===Ut||"square"===Ut)&&Qe!==St&&(0===Qe&&(Qe-=1),1===St&&(St+=1));const at=v.terrain?Me.projMatrix:null,Ot=_e?Ya(v,Le,g,at,G):wl(v,Le,g,at,Fe.lineClipsArray.length,G,[Qe,St]);if(de){const qe=Fe.gradients[g.id];let Xe=qe.texture;if(g.gradientVersion!==qe.version){let Mt=256;if(g.stepInterpolant){const Rt=c.getSource().maxzoom,dn=Me.canonical.z===Rt?Math.ceil(1<<v.transform.maxZoom-Me.canonical.z):1;Mt=_.clamp(_.nextPowerOfTwo(Fe.maxLineLength/_.EXTENT*1024*dn),256,xe.maxTextureSize)}qe.gradient=_.renderColorRamp({expression:g.gradientExpression(),evaluationKey:"lineProgress",resolution:Mt,image:qe.gradient||void 0,clips:Fe.lineClipsArray}),qe.texture?qe.texture.update(qe.gradient):qe.texture=new _.Texture(xe,qe.gradient,ue.RGBA),qe.version=g.gradientVersion,Xe=qe.texture}xe.activeTexture.set(ue.TEXTURE1),Xe.bind(g.stepInterpolant?ue.NEAREST:ue.LINEAR,ue.CLAMP_TO_EDGE)}ee&&(xe.activeTexture.set(ue.TEXTURE0),Le.lineAtlasTexture.bind(ue.LINEAR,ue.REPEAT),Ue.updatePaintBuffers()),_e&&(xe.activeTexture.set(ue.TEXTURE0),Le.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),Ue.updatePaintBuffers()),v.prepareDrawProgram(xe,We,Me.toUnwrapped());const et=qe=>{We.draw(xe,ue.TRIANGLES,L,qe,z,_.CullFaceMode.disabled,Ot,g.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,g.paint,v.transform.zoom,Ue,[Fe.layoutVertexBuffer2])};if(be){const qe=v.stencilModeForClipping(Me).ref;0===qe&&v.terrain&&xe.clear({stencil:0});const Xe={func:ue.EQUAL,mask:255};Ot.u_alpha_discard_threshold=.8,et(new _.StencilMode(Xe,qe,255,ue.KEEP,ue.KEEP,ue.INVERT)),Ot.u_alpha_discard_threshold=0,et(new _.StencilMode(Xe,qe,255,ue.KEEP,ue.KEEP,ue.KEEP))}else et(v.stencilModeForClipping(Me))}be&&(v.resetStencilClippingMasks(),v.terrain&&xe.clear({stencil:0}))},fill:function(v,c,g,C){const S=g.paint.get("fill-color"),D=g.paint.get("fill-opacity");if(0===D.constantOr(1))return;const L=v.colorModeForRenderPass(),z=g.paint.get("fill-pattern"),G=v.opaquePassEnabledForLayer()&&!z.constantOr(1)&&1===S.constantOr(_.Color.transparent).a&&1===D.constantOr(0)?"opaque":"translucent";if(v.renderPass===G){const J=v.depthModeForSublayer(1,"opaque"===v.renderPass?_.DepthMode.ReadWrite:_.DepthMode.ReadOnly);wf(v,c,g,C,J,L,!1)}if("translucent"===v.renderPass&&g.paint.get("fill-antialias")){const J=v.depthModeForSublayer(g.getPaintProperty("fill-outline-color")?2:0,_.DepthMode.ReadOnly);wf(v,c,g,C,J,L,!0)}},"fill-extrusion":function(v,c,g,C){const S=g.paint.get("fill-extrusion-opacity");if(0!==S&&"translucent"===v.renderPass){const D=new _.DepthMode(v.context.gl.LEQUAL,_.DepthMode.ReadWrite,v.depthRangeFor3D);if(1!==S||g.paint.get("fill-extrusion-pattern").constantOr(1))zp(v,c,g,C,D,_.StencilMode.disabled,_.ColorMode.disabled),zp(v,c,g,C,D,v.stencilModeFor3D(),v.colorModeForRenderPass()),v.resetStencilClippingMasks();else{const L=v.colorModeForRenderPass();zp(v,c,g,C,D,_.StencilMode.disabled,L)}}},hillshade:function(v,c,g,C){if("offscreen"!==v.renderPass&&"translucent"!==v.renderPass)return;const S=v.context,D=v.depthModeForSublayer(0,_.DepthMode.ReadOnly),L=v.colorModeForRenderPass(),z=v.terrain&&v.terrain.renderingToTexture,[G,J]="translucent"!==v.renderPass||z?[{},C]:v.stencilConfigForOverlap(C);for(const ee of J){const re=c.getTile(ee);if(re.needsHillshadePrepare&&"offscreen"===v.renderPass)wu(v,re,g,D,_.StencilMode.disabled,L);else if("translucent"===v.renderPass){const fe=z&&v.terrain?v.terrain.stencilModeForRTTOverlap(ee):G[ee.overscaledZ];Fc(v,ee,re,g,D,fe,L)}}S.viewport.set([0,0,v.width,v.height]),v.resetStencilClippingMasks()},raster:function(v,c,g,C,S,D){if("translucent"!==v.renderPass||0===g.paint.get("raster-opacity")||!C.length)return;const L=v.context,z=L.gl,G=c.getSource(),J=v.useProgram("raster"),ee=v.colorModeForRenderPass(),re=v.terrain&&v.terrain.renderingToTexture,[fe,_e]=G instanceof pe||re?[{},C]:v.stencilConfigForOverlap(C),de=_e[_e.length-1].overscaledZ,ve=!v.options.moving;for(const xe of _e){const ue=re?_.DepthMode.disabled:v.depthModeForSublayer(xe.overscaledZ-de,1===g.paint.get("raster-opacity")?_.DepthMode.ReadWrite:_.DepthMode.ReadOnly,z.LESS),Ce=xe.toUnwrapped(),be=c.getTile(xe);if(re&&(!be||!be.hasData()))continue;const Me=re?xe.projMatrix:v.transform.calculateProjMatrix(Ce,ve),Le=v.terrain&&re?v.terrain.stencilModeForRTTOverlap(xe):fe[xe.overscaledZ],Fe=D?0:g.paint.get("raster-fade-duration");be.registerFadeDuration(Fe);const Ue=c.findLoadedParent(xe,0),We=zc(be,Ue,c,v.transform,Fe);let it,st;v.terrain&&v.terrain.prepareDrawTile();const Ut="nearest"===g.paint.get("raster-resampling")?z.NEAREST:z.LINEAR;L.activeTexture.set(z.TEXTURE0),be.texture.bind(Ut,z.CLAMP_TO_EDGE),L.activeTexture.set(z.TEXTURE1),Ue?(Ue.texture.bind(Ut,z.CLAMP_TO_EDGE),it=Math.pow(2,Ue.tileID.overscaledZ-be.tileID.overscaledZ),st=[be.tileID.canonical.x*it%1,be.tileID.canonical.y*it%1]):be.texture.bind(Ut,z.CLAMP_TO_EDGE);const Qe=T_(Me,st||[0,0],it||1,We,g,G instanceof pe?G.perspectiveTransform:[0,0]);if(v.prepareDrawProgram(L,J,Ce),G instanceof pe)G.boundsBuffer&&G.boundsSegments&&J.draw(L,z.TRIANGLES,ue,_.StencilMode.disabled,ee,_.CullFaceMode.disabled,Qe,g.id,G.boundsBuffer,v.quadTriangleIndexBuffer,G.boundsSegments);else{const{tileBoundsBuffer:St,tileBoundsIndexBuffer:at,tileBoundsSegments:Ot}=v.getTileBoundsBuffers(be);J.draw(L,z.TRIANGLES,ue,Le,ee,_.CullFaceMode.disabled,Qe,g.id,St,at,Ot)}}v.resetStencilClippingMasks()},background:function(v,c,g,C){const S=g.paint.get("background-color"),D=g.paint.get("background-opacity");if(0===D)return;const L=v.context,z=L.gl,G=v.transform,J=G.tileSize,ee=g.paint.get("background-pattern");if(v.isPatternMissing(ee))return;const re=!ee&&1===S.a&&1===D&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==re)return;const fe=_.StencilMode.disabled,_e=v.depthModeForSublayer(0,"opaque"===re?_.DepthMode.ReadWrite:_.DepthMode.ReadOnly),de=v.colorModeForRenderPass(),ve=v.useProgram(ee?"backgroundPattern":"background");let xe,ue=C;ue||(xe=v.getBackgroundTiles(),ue=Object.values(xe).map(Ce=>Ce.tileID)),ee&&(L.activeTexture.set(z.TEXTURE0),v.imageManager.bind(v.context));for(const Ce of ue){const be=Ce.toUnwrapped(),Me=C?Ce.projMatrix:v.transform.calculateProjMatrix(be);v.prepareDrawTile();const Le=c?c.getTile(Ce):xe?xe[Ce.key]:new _.Tile(Ce,J,G.zoom,v),Fe=ee?uh(Me,D,v,ee,{tileID:Ce,tileSize:J}):Ka(Me,D,S);v.prepareDrawProgram(L,ve,be);const{tileBoundsBuffer:Ue,tileBoundsIndexBuffer:We,tileBoundsSegments:it}=v.getTileBoundsBuffers(Le);ve.draw(L,z.TRIANGLES,_e,fe,de,_.CullFaceMode.disabled,Fe,g.id,Ue,We,it)}},sky:function(v,c,g){const C=v.transform,S="mercator"===C.projection.name||"globe"===C.projection.name?1:_.smoothstep(7,8,C.zoom),D=g.paint.get("sky-opacity")*S;if(0===D)return;const L=v.context,z=g.paint.get("sky-type"),G=new _.DepthMode(L.gl.LEQUAL,_.DepthMode.ReadOnly,[0,1]),J=v.frameCounter/1e3%1;"atmosphere"===z?"offscreen"===v.renderPass?g.needsSkyboxCapture(v)&&(function(ee,re,fe,_e){const de=ee.context,ve=de.gl;let xe=re.skyboxFbo;if(!xe){xe=re.skyboxFbo=de.createFramebuffer(32,32,!1),re.skyboxGeometry=new Bp(de),re.skyboxTexture=de.gl.createTexture(),ve.bindTexture(ve.TEXTURE_CUBE_MAP,re.skyboxTexture),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_S,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_T,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MAG_FILTER,ve.LINEAR);for(let Me=0;Me<6;++Me)ve.texImage2D(ve.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,ve.RGBA,32,32,0,ve.RGBA,ve.UNSIGNED_BYTE,null)}de.bindFramebuffer.set(xe.framebuffer),de.viewport.set([0,0,32,32]);const ue=re.getCenter(ee,!0),Ce=ee.useProgram("skyboxCapture"),be=new Float64Array(16);_.identity(be),_.rotateY(be,be,.5*-Math.PI),Hi(de,re,Ce,be,ue,0),_.identity(be),_.rotateY(be,be,.5*Math.PI),Hi(de,re,Ce,be,ue,1),_.identity(be),_.rotateX(be,be,.5*-Math.PI),Hi(de,re,Ce,be,ue,2),_.identity(be),_.rotateX(be,be,.5*Math.PI),Hi(de,re,Ce,be,ue,3),_.identity(be),Hi(de,re,Ce,be,ue,4),_.identity(be),_.rotateY(be,be,Math.PI),Hi(de,re,Ce,be,ue,5),de.viewport.set([0,0,ee.width,ee.height])}(v,g),g.markSkyboxValid(v)):"sky"===v.renderPass&&function(ee,re,fe,_e,de){const ve=ee.context,xe=ve.gl,ue=ee.transform,Ce=ee.useProgram("skybox");ve.activeTexture.set(xe.TEXTURE0),xe.bindTexture(xe.TEXTURE_CUBE_MAP,re.skyboxTexture);const be={u_matrix:ue.skyboxMatrix,u_sun_direction:re.getCenter(ee,!1),u_cubemap:0,u_opacity:_e,u_temporal_offset:de};ee.prepareDrawProgram(ve,Ce),Ce.draw(ve,xe.TRIANGLES,fe,_.StencilMode.disabled,ee.colorModeForRenderPass(),_.CullFaceMode.backCW,be,"skybox",re.skyboxGeometry.vertexBuffer,re.skyboxGeometry.indexBuffer,re.skyboxGeometry.segment)}(v,g,G,D,J):"gradient"===z&&"sky"===v.renderPass&&function(ee,re,fe,_e,de){const ve=ee.context,xe=ve.gl,ue=ee.transform,Ce=ee.useProgram("skyboxGradient");re.skyboxGeometry||(re.skyboxGeometry=new Bp(ve)),ve.activeTexture.set(xe.TEXTURE0);let be=re.colorRampTexture;be||(be=re.colorRampTexture=new _.Texture(ve,re.colorRamp,xe.RGBA)),be.bind(xe.LINEAR,xe.CLAMP_TO_EDGE);const Me=(Le=ue.skyboxMatrix,Fe=re.getCenter(ee,!1),Ue=re.paint.get("sky-gradient-radius"),We=_e,it=de,{u_matrix:Le,u_color_ramp:0,u_center_direction:Fe,u_radius:_.degToRad(Ue),u_opacity:We,u_temporal_offset:it});var Le,Fe,Ue,We,it;ee.prepareDrawProgram(ve,Ce),Ce.draw(ve,xe.TRIANGLES,fe,_.StencilMode.disabled,ee.colorModeForRenderPass(),_.CullFaceMode.backCW,Me,"skyboxGradient",re.skyboxGeometry.vertexBuffer,re.skyboxGeometry.indexBuffer,re.skyboxGeometry.segment)}(v,g,G,D,J)},debug:function(v,c,g){for(let C=0;C<g.length;C++)vs(v,c,g[C])},custom:function(v,c,g,C){const S=v.context,D=g.implementation;if(!v.transform.projection.unsupportedLayers||!v.transform.projection.unsupportedLayers.includes("custom")||v.terrain&&(v.terrain.renderingToTexture||"offscreen"===v.renderPass)&&g.isLayerDraped()){if("offscreen"===v.renderPass){const L=D.prerender;if(L){if(v.setCustomLayerDefaults(),S.setColorMode(v.colorModeForRenderPass()),"globe"===v.transform.projection.name){const z=v.transform.pointMerc;L.call(D,S.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),_.globeToMercatorTransition(v.transform.zoom),[z.x,z.y],v.transform.pixelsPerMeterRatio)}else L.call(D,S.gl,v.transform.customLayerMatrix());S.setDirty(),v.setBaseState()}}else if("translucent"===v.renderPass){if(v.terrain&&v.terrain.renderingToTexture){const z=D.renderToTile;if(z){const G=C[0].canonical,J=new _.MercatorCoordinate(G.x+C[0].wrap*(1<<G.z),G.y,G.z);S.setDepthMode(_.DepthMode.disabled),S.setStencilMode(_.StencilMode.disabled),S.setColorMode(v.colorModeForRenderPass()),v.setCustomLayerDefaults(),z.call(D,S.gl,J),S.setDirty(),v.setBaseState()}return}v.setCustomLayerDefaults(),S.setColorMode(v.colorModeForRenderPass()),S.setStencilMode(_.StencilMode.disabled);const L="3d"===D.renderingMode?new _.DepthMode(v.context.gl.LEQUAL,_.DepthMode.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,_.DepthMode.ReadOnly);if(S.setDepthMode(L),"globe"===v.transform.projection.name){const z=v.transform.pointMerc;D.render(S.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),_.globeToMercatorTransition(v.transform.zoom),[z.x,z.y],v.transform.pixelsPerMeterRatio)}else D.render(S.gl,v.transform.customLayerMatrix());S.setDirty(),v.setBaseState(),S.bindFramebuffer.set(null)}}else _.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class El{constructor(c,g,C=!1){this.context=new ne(c,C),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=_.SourceCache.maxUnderzooming+_.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _u,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(c,g){const C=!!c&&!!c.terrain&&this.transform.projection.supportsTerrain;if(!(C||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new oh(this,c));const S=this._terrain;this.transform.elevation=C?S:null,S.update(c,this.transform,g)}_updateFog(c){const g=c.fog;if(!g||"globe"===this.transform.projection.name||g.getOpacity(this.transform.pitch)<1||g.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[C,S]=g.getFovAdjustedRange(this.transform._fov);if(C>S)return void(this.transform.fogCullDistSq=null);const D=C+.78*(S-C);this.transform.fogCullDistSq=D*D}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(c,g){if(this.width=c*_.exported.devicePixelRatio,this.height=g*_.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const C of this.style.order)this.style._layers[C].resize()}setup(){const c=this.context,g=new _.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(_.EXTENT,0),g.emplaceBack(0,_.EXTENT),g.emplaceBack(_.EXTENT,_.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(g,_.posAttributes.members),this.tileExtentSegments=_.SegmentVector.simpleSegment(0,0,4,2);const C=new _.StructArrayLayout2i4;C.emplaceBack(0,0),C.emplaceBack(_.EXTENT,0),C.emplaceBack(0,_.EXTENT),C.emplaceBack(_.EXTENT,_.EXTENT),this.debugBuffer=c.createVertexBuffer(C,_.posAttributes.members),this.debugSegments=_.SegmentVector.simpleSegment(0,0,4,5);const S=new _.StructArrayLayout2i4;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(S,_.posAttributes.members),this.viewportSegments=_.SegmentVector.simpleSegment(0,0,4,2);const D=new _.StructArrayLayout4i8;D.emplaceBack(0,0,0,0),D.emplaceBack(_.EXTENT,0,_.EXTENT,0),D.emplaceBack(0,_.EXTENT,0,_.EXTENT),D.emplaceBack(_.EXTENT,_.EXTENT,_.EXTENT,_.EXTENT),this.mercatorBoundsBuffer=c.createVertexBuffer(D,_.boundsAttributes.members),this.mercatorBoundsSegments=_.SegmentVector.simpleSegment(0,0,4,2);const L=new _.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(L);const z=new _.StructArrayLayout1ui2;for(const J of[0,1,3,2,0])z.emplaceBack(J);this.debugIndexBuffer=c.createIndexBuffer(z),this.emptyTexture=new _.Texture(c,new _.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),c.gl.RGBA),this.identityMat=_.create();const G=this.context.gl;this.stencilClearMode=new _.StencilMode({func:G.ALWAYS,mask:0},0,255,G.ZERO,G.ZERO,G.ZERO),this.loadTimeStamps.push(_.window.performance.now()),this.atmosphereBuffer=new yd(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(c){return c._makeTileBoundsBuffers(this.context,this.transform.projection),c._tileBoundsBuffer?{tileBoundsBuffer:c._tileBoundsBuffer,tileBoundsIndexBuffer:c._tileBoundsIndexBuffer,tileBoundsSegments:c._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const c=this.context,g=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(c,g.TRIANGLES,_.DepthMode.disabled,this.stencilClearMode,_.ColorMode.disabled,_.CullFaceMode.disabled,di(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(c,g,C){if(!g||this.currentStencilSource===g.id||!c.isTileClipped()||!C||0===C.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let z=!1;for(const G of C)if(void 0===this._tileClippingMaskIDs[G.key]){z=!0;break}if(!z)return}this.currentStencilSource=g.id;const S=this.context,D=S.gl;this.nextStencilID+C.length>256&&this.clearStencil(),S.setColorMode(_.ColorMode.disabled),S.setDepthMode(_.DepthMode.disabled);const L=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of C){const G=g.getTile(z),J=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,{tileBoundsBuffer:ee,tileBoundsIndexBuffer:re,tileBoundsSegments:fe}=this.getTileBoundsBuffers(G);L.draw(S,D.TRIANGLES,_.DepthMode.disabled,new _.StencilMode({func:D.ALWAYS,mask:0},J,255,D.KEEP,D.KEEP,D.REPLACE),_.ColorMode.disabled,_.CullFaceMode.disabled,di(z.projMatrix),"$clipping",ee,re,fe)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,g=this.context.gl;return new _.StencilMode({func:g.NOTEQUAL,mask:255},c,255,g.KEEP,g.KEEP,g.REPLACE)}stencilModeForClipping(c){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(c);const g=this.context.gl;return new _.StencilMode({func:g.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,g.KEEP,g.KEEP,g.REPLACE)}stencilConfigForOverlap(c){const g=this.context.gl,C=c.sort((L,z)=>z.overscaledZ-L.overscaledZ),S=C[C.length-1].overscaledZ,D=C[0].overscaledZ-S+1;if(D>1){this.currentStencilSource=void 0,this.nextStencilID+D>256&&this.clearStencil();const L={};for(let z=0;z<D;z++)L[z+S]=new _.StencilMode({func:g.GEQUAL,mask:255},z+this.nextStencilID,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID+=D,[L,C]}return[{[S]:_.StencilMode.disabled},C]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new _.ColorMode([c.CONSTANT_COLOR,c.ONE],new _.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?_.ColorMode.unblended:_.ColorMode.alphaBlended}depthModeForSublayer(c,g,C){if(!this.opaquePassEnabledForLayer())return _.DepthMode.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new _.DepthMode(C||this.context.gl.LEQUAL,g,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,g){this.style=c,this.options=g,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(_.exported.now()),this.imageManager.beginFrame();const C=this.style.order,S=this.style._sourceCaches;for(const G in S){const J=S[G];J.used&&J.prepare(this.context)}const D={},L={},z={};for(const G in S){const J=S[G];D[G]=J.getVisibleCoordinates(),L[G]=D[G].slice().reverse(),z[G]=J.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<C.length;G++)if(this.style._layers[C[G]].is3D()){this.opaquePassCutoff=G;break}if(this.terrain&&(this.terrain.updateTileBinding(z),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new _.GlobeSharedBuffers(this.context)),_.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const G of C){const J=this.style._layers[G],ee=c._getLayerSourceCache(J);if(!J.hasOffscreenPass()||J.isHidden(this.transform.zoom))continue;const re=ee?L[ee.id]:void 0;("custom"===J.type||J.isSky()||re&&re.length)&&this.renderLayer(this,ee,J,re)}if(this.depthRangeFor3D=[0,1-(c.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:g.showOverdrawInspector?_.Color.black:_.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=g.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=C.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[C[this.currentLayer]],J=c._getLayerSourceCache(G);if(G.isSky())continue;const ee=J?L[J.id]:void 0;this._renderTileClippingMasks(G,J,ee),this.renderLayer(this,J,G,ee)}if(this.style.fog&&this.transform.projection.supportsFog&&function(G,J){const ee=G.context,re=ee.gl,fe=G.transform,_e=new _.DepthMode(re.LEQUAL,_.DepthMode.ReadOnly,[0,1]),de=G.useProgram("globeAtmosphere",null,"globe"===fe.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ve=_.globeToMercatorTransition(fe.zoom),xe=J.properties.get("color").toArray01(),ue=J.properties.get("high-color").toArray01(),Ce=J.properties.get("space-color").toArray01PremultipliedAlpha(),be=_.identity$1([]);_.rotateY$1(be,be,-_.degToRad(fe._center.lng)),_.rotateX$1(be,be,_.degToRad(fe._center.lat)),_.rotateZ$1(be,be,fe.angle),_.rotateX$1(be,be,-fe._pitch);const Me=_.fromQuat(new Float32Array(16),be),Le=_.mapValue(J.properties.get("star-intensity"),0,1,0,.25),Ue=_.mapValue(J.properties.get("horizon-blend"),0,1,5e-4,.25),We=_.globeUseCustomAntiAliasing(G,ee,fe)&&5e-4===Ue?fe.worldSize/(2*Math.PI*1.025)-1:fe.globeRadius,it=G.frameCounter/1e3%1,st=_.length(fe.globeCenterInViewSpace),Ut=Math.sqrt(Math.pow(st,2)-Math.pow(We,2)),Qe=Math.acos(Ut/st),St={u_frustum_tl:fe.frustumCorners.TL,u_frustum_tr:fe.frustumCorners.TR,u_frustum_br:fe.frustumCorners.BR,u_frustum_bl:fe.frustumCorners.BL,u_horizon:fe.frustumCorners.horizon,u_transition:ve,u_fadeout_range:Ue,u_color:xe,u_high_color:ue,u_space_color:Ce,u_star_intensity:Le,u_star_size:5*_.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:it,u_horizon_angle:Qe,u_rotation_matrix:Me};G.prepareDrawProgram(ee,de);const at=G.atmosphereBuffer;at&&de.draw(ee,re.TRIANGLES,_e,_.StencilMode.disabled,_.ColorMode.alphaBlended,_.CullFaceMode.backCW,St,"skybox",at.vertexBuffer,at.indexBuffer,at.segments)}(this,this.style.fog),this.renderPass="sky",(_.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<C.length;this.currentLayer++){const G=this.style._layers[C[this.currentLayer]],J=c._getLayerSourceCache(G);G.isSky()&&this.renderLayer(this,J,G,J?L[J.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<C.length;){const G=this.style._layers[C[this.currentLayer]],J=c._getLayerSourceCache(G);if(G.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(G)){if(G.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const ee=J?("symbol"===G.type?z:L)[J.id]:void 0;this._renderTileClippingMasks(G,J,J?D[J.id]:void 0),this.renderLayer(this,J,G,ee),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let G=null;_.values(this.style._layers).forEach(J=>{const ee=c._getLayerSourceCache(J);ee&&!J.isHidden(this.transform.zoom)&&(!G||G.getSource().maxzoom<ee.getSource().maxzoom)&&(G=ee)}),G&&this.options.showTileBoundaries&&ic.debug(this,G,G.getVisibleCoordinates())}this.options.showPadding&&function(G){const J=G.transform.padding;As(G,G.transform.height-(J.top||0),3,Cf),As(G,J.bottom||0,3,Ef),pr(G,J.left||0,3,Tf),pr(G,G.transform.width-(J.right||0),3,I_);const ee=G.transform.centerPoint;var re,fe,_e,de;jc(re=G,(fe=ee.x)-1,(_e=G.transform.height-ee.y)-10,2,20,de=ng),jc(re,fe-10,_e-1,20,2,de)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(_.window.performance.now()),this.saveCanvasCopy())}}renderLayer(c,g,C,S){C.isHidden(this.transform.zoom)||("background"===C.type||"sky"===C.type||"custom"===C.type||S&&S.length)&&(this.id=C.id,this.gpuTimingStart(C),(!c.transform.projection.unsupportedLayers||!c.transform.projection.unsupportedLayers.includes(C.type)||c.terrain&&"custom"===C.type)&&ic[C.type](c,g,C,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const g=this.context.extTimerQuery;let C=this.gpuTimers[c.id];C||(C=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:g.createQueryEXT()}),C.calls++,g.beginQueryEXT(g.TIME_ELAPSED_EXT,C.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const c=this.context.extTimerQuery,g=c.createQueryEXT();this.deferredRenderGpuTimeQueries.push(g),c.beginQueryEXT(c.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}collectDeferredRenderGpuQueries(){const c=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],c}queryGpuTimers(c){const g={};for(const C in c){const S=c[C],D=this.context.extTimerQuery,L=D.getQueryObjectEXT(S.query,D.QUERY_RESULT_EXT)/1e6;D.deleteQueryEXT(S.query),g[C]=L}return g}queryGpuTimeDeferredRender(c){if(!this.options.gpuTimingDeferredRender)return 0;const g=this.context.extTimerQuery;let C=0;for(const S of c)C+=g.getQueryObjectEXT(S,g.QUERY_RESULT_EXT)/1e6,g.deleteQueryEXT(S);return C}translatePosMatrix(c,g,C,S,D){if(!C[0]&&!C[1])return c;const L=D?"map"===S?this.transform.angle:0:"viewport"===S?-this.transform.angle:0;if(L){const J=Math.sin(L),ee=Math.cos(L);C=[C[0]*ee-C[1]*J,C[0]*J+C[1]*ee]}const z=[D?C[0]:en(g,C[0],this.transform.zoom),D?C[1]:en(g,C[1],this.transform.zoom),0],G=new Float32Array(16);return _.translate(G,c,z),G}saveTileTexture(c){const g=this._tileTextures[c.size[0]];g?g.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const g=this._tileTextures[c];return g&&g.length>0?g.pop():null}isPatternMissing(c){return null===c||void 0!==c&&!this.imageManager.getPattern(c.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const c=this.terrain&&this.terrain.renderingToTexture,g=this.terrain&&0===this.terrain.exaggeration(),C=this.style&&this.style.fog,S=[];return this.terrainRenderModeElevated()&&S.push("TERRAIN"),"globe"===this.transform.projection.name&&S.push("GLOBE"),g&&S.push("ZERO_EXAGGERATION"),C&&!c&&0!==C.getOpacity(this.transform.pitch)&&S.push("FOG"),c&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}useProgram(c,g,C){this.cache=this.cache||{};const S=C||[],D=this.currentGlobalDefines().concat(S),L=Bc.cacheKey(fd[c],c,D,g);return this.cache[L]||(this.cache[L]=new Bc(this.context,c,fd[c],g,Rp[c],D)),this.cache[L]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=_.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new _.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(c,g,C){if(this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const D=S.getOpacity(this.transform.pitch),L=((z,G,J,ee,re,fe,_e,de,ve,xe,ue)=>{const Ce=z.transform,be=G.properties.get("color").toArray01();be[3]=ee;const Me=z.frameCounter/1e3%1;return{u_fog_matrix:J?Ce.calculateFogTileMatrix(J):z.identityMat,u_fog_range:G.getFovAdjustedRange(Ce._fov),u_fog_color:be,u_fog_horizon_blend:G.properties.get("horizon-blend"),u_fog_temporal_offset:Me,u_frustum_tl:re,u_frustum_tr:fe,u_frustum_br:_e,u_frustum_bl:de,u_globe_pos:ve,u_globe_radius:xe,u_viewport:ue,u_globe_transition:_.globeToMercatorTransition(Ce.zoom),u_is_globe:+("globe"===Ce.projection.name)}})(this,S,C,D,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*_.exported.devicePixelRatio,this.transform.height*_.exported.devicePixelRatio]);g.setFogUniformValues(c,L)}}setTileLoadedFlag(c){this.tileLoaded=c}saveCanvasCopy(){const c=this.canvasCopy();c&&(this.frameCopies.push(c),this.tileLoaded=!1)}canvasCopy(){const c=this.context.gl,g=c.createTexture();return c.bindTexture(c.TEXTURE_2D,g),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,c.drawingBufferWidth,c.drawingBufferHeight,0),g}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const c=this.style&&this.style.fog;return!!c&&0!==c.getOpacity(this.transform.pitch)}getBackgroundTiles(){const c=this._backgroundTiles,g=this._backgroundTiles={},C=this.transform.coveringTiles({tileSize:512});for(const S of C)g[S.key]=c[S.key]||new _.Tile(S,512,this.transform.tileZoom,this);return g}clearBackgroundTiles(){this._backgroundTiles={}}}class Sa{constructor(c=0,g=0,C=0,S=0){if(isNaN(c)||c<0||isNaN(g)||g<0||isNaN(C)||C<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=g,this.left=C,this.right=S}interpolate(c,g,C){return null!=g.top&&null!=c.top&&(this.top=_.number(c.top,g.top,C)),null!=g.bottom&&null!=c.bottom&&(this.bottom=_.number(c.bottom,g.bottom,C)),null!=g.left&&null!=c.left&&(this.left=_.number(c.left,g.left,C)),null!=g.right&&null!=c.right&&(this.right=_.number(c.right,g.right,C)),this}getCenter(c,g){const C=_.clamp((this.left+c-this.right)/2,0,c),S=_.clamp((this.top+g-this.bottom)/2,0,g);return new _.pointGeometry(C,S)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Sa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function If(v,c){const g=_.getColumn(v,3);_.fromQuat(v,c),_.setColumn(v,3,g)}function ua(v,c){const g=_.identity$1([]);return _.rotateZ$1(g,g,-c),_.rotateX$1(g,g,-v),g}function Au(v,c){const g=[v[0],v[1],0],C=[c[0],c[1],0];if(_.length(g)>=1e-15){const L=_.normalize([],g);_.scale$2(C,L,_.dot(C,L)),c[0]=C[0],c[1]=C[1]}const S=_.cross([],c,v);if(_.len(S)<1e-15)return null;const D=Math.atan2(-S[1],S[0]);return ua(Math.atan2(Math.sqrt(v[0]*v[0]+v[1]*v[1]),-v[2]),D)}class vd{constructor(c,g){this.position=c,this.orientation=g}get position(){return this._position}set position(c){if(c){const g=c instanceof _.MercatorCoordinate?c:new _.MercatorCoordinate(c[0],c[1],c[2]);this._renderWorldCopies&&(g.x=_.wrap(g.x,0,1)),this._position=g}else this._position=null}lookAtPoint(c,g){if(this.orientation=null,!this.position)return;const C=this._elevation?this._elevation.getAtPointOrZero(_.MercatorCoordinate.fromLngLat(c)):0,S=this.position,D=_.MercatorCoordinate.fromLngLat(c,C),L=[D.x-S.x,D.y-S.y,D.z-S.z];g||(g=[0,0,1]),g[2]=Math.abs(g[2]),this.orientation=Au(L,g)}setPitchBearing(c,g){this.orientation=ua(_.degToRad(c),_.degToRad(-g))}}class hh{constructor(c,g){this._transform=_.identity([]),this.orientation=g,this.position=c}get mercatorPosition(){const c=this.position;return new _.MercatorCoordinate(c[0],c[1],c[2])}get position(){const c=_.getColumn(this._transform,3);return[c[0],c[1],c[2]]}set position(c){var g;c&&_.setColumn(this._transform,3,[(g=c)[0],g[1],g[2],1])}get orientation(){return this._orientation}set orientation(c){this._orientation=c||_.identity$1([]),c&&If(this._transform,this._orientation)}getPitchBearing(){const c=this.forward(),g=this.right();return{bearing:Math.atan2(-g[1],g[0]),pitch:Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2])}}setPitchBearing(c,g){this._orientation=ua(c,g),If(this._transform,this._orientation)}forward(){const c=_.getColumn(this._transform,2);return[-c[0],-c[1],-c[2]]}up(){const c=_.getColumn(this._transform,1);return[-c[0],-c[1],-c[2]]}right(){const c=_.getColumn(this._transform,0);return[c[0],c[1],c[2]]}getCameraToWorld(c,g){const C=new Float64Array(16);return _.invert(C,this.getWorldToCamera(c,g)),C}getWorldToCameraPosition(c,g,C){const S=this.position;_.scale$2(S,S,-c);const D=new Float64Array(16);return _.fromScaling(D,[C,C,C]),_.translate(D,D,S),D[10]*=g,D}getWorldToCamera(c,g){const C=new Float64Array(16),S=new Float64Array(4),D=this.position;return _.conjugate(S,this._orientation),_.scale$2(D,D,-c),_.fromQuat(C,S),_.translate(C,C,D),C[1]*=-1,C[5]*=-1,C[9]*=-1,C[13]*=-1,C[8]*=g,C[9]*=g,C[10]*=g,C[11]*=g,C}getCameraToClipPerspective(c,g,C,S){const D=new Float64Array(16);return _.perspective(D,c,g,C,S),D}getDistanceToElevation(c,g=!1){const C=0===c?0:_.mercatorZfromAltitude(c,g?_.latFromMercatorY(this.position[1]):this.position[1]),S=this.forward();return(C-this.position[2])/S[2]}clone(){return new hh([...this.position],[...this.orientation])}}function Tl(v,c){const g=Il(v.projection,v.zoom,v.width,v.height),C=function(D,L,z,G,J){const ee=new _.LngLat(z.lng-180*Xa,z.lat),re=new _.LngLat(z.lng+180*Xa,z.lat),fe=D.project(ee.lng,ee.lat),_e=D.project(re.lng,re.lat),de=-Math.atan2(_e.y-fe.y,_e.x-fe.x),ve=_.MercatorCoordinate.fromLngLat(z);ve.y=_.clamp(ve.y,-.999975,.999975);const xe=ve.toLngLat(),ue=D.project(xe.lng,xe.lat),Ce=_.MercatorCoordinate.fromLngLat(xe);Ce.x+=Xa;const be=Ce.toLngLat(),Me=D.project(be.lng,be.lat),Le=Sl(Me.x-ue.x,Me.y-ue.y,de),Fe=_.MercatorCoordinate.fromLngLat(xe);Fe.y+=Xa;const Ue=Fe.toLngLat(),We=D.project(Ue.lng,Ue.lat),it=Sl(We.x-ue.x,We.y-ue.y,de),st=Math.abs(Le.x)/Math.abs(it.y),Ut=_.identity([]);_.rotateZ(Ut,Ut,-de*(1-(J?0:G)));const Qe=_.identity([]);return _.scale(Qe,Qe,[1,1-(1-st)*G,1]),Qe[4]=-it.x/it.y*G,_.rotateZ(Qe,Qe,de),_.multiply(Qe,Ut,Qe),Qe}(v.projection,0,v.center,g,c),S=Vp(v);return _.scale(C,C,[S,S,1]),C}function Vp(v){const c=v.projection,g=Il(v.projection,v.zoom,v.width,v.height),C=$c(c,v.center),S=$c(c,_.LngLat.convert(c.center));return Math.pow(2,C*g+(1-g)*S)}function Il(v,c,g,C,S=1/0){const D=v.range;if(!D)return 0;const L=Math.min(S,Math.max(g,C)),z=Math.log(L/1024)/Math.LN2;return _.smoothstep(D[0]+z,D[1]+z,c)}const Xa=1/4e4;function $c(v,c){const g=_.clamp(c.lat,-_.MAX_MERCATOR_LATITUDE,_.MAX_MERCATOR_LATITUDE),C=new _.LngLat(c.lng-180*Xa,g),S=new _.LngLat(c.lng+180*Xa,g),D=v.project(C.lng,g),L=v.project(S.lng,g),z=_.MercatorCoordinate.fromLngLat(C),G=_.MercatorCoordinate.fromLngLat(S),J=L.x-D.x,ee=L.y-D.y,re=G.x-z.x,fe=G.y-z.y,_e=Math.sqrt((re*re+fe*fe)/(J*J+ee*ee));return Math.log(_e)/Math.LN2}function Sl(v,c,g){const C=Math.cos(g),S=Math.sin(g);return{x:v*C-c*S,y:v*S+c*C}}class fn{constructor(c,g,C,S,D,L,z){this.tileSize=512,this._renderWorldCopies=void 0===D||D,this._minZoom=c||0,this._maxZoom=g||22,this._minPitch=C??0,this._maxPitch=S??60,this.setProjection(L),this.setMaxBounds(z),this.width=0,this.height=0,this._center=new _.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Sa,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new hh,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const c=new fn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return c._elevation=this._elevation,c._centerAltitude=this._centerAltitude,c._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,c.tileSize=this.tileSize,c.mercatorFromTransition=this.mercatorFromTransition,c.width=this.width,c.height=this.height,c.cameraElevationReference=this.cameraElevationReference,c._center=this._center,c._setZoom(this.zoom),c._seaLevelZoom=this._seaLevelZoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._nearZ=this._nearZ,c._farZ=this._farZ,c._averageElevation=this._averageElevation,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._camera=this._camera.clone(),c._calcMatrices(),c.freezeTileCoverage=this.freezeTileCoverage,c.frustumCorners=this.frustumCorners,c}get elevation(){return this._elevation}set elevation(c){this._elevation!==c&&(this._elevation=c,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(c,g=!1){const C=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||C)&&this._updateCameraOnTerrain(),(c||C)&&this._constrainCamera(g),this._calcMatrices()}getProjection(){return _.pick(this.projection,["name","center","parallels"])}setProjection(c){this.projectionOptions=c||{name:"mercator"};const g=this.projection?this.getProjection():void 0;this.projection=_.getProjection(this.projectionOptions);const C=!$e(g,this.getProjection());return C&&this._calcMatrices(),this.mercatorFromTransition=!1,C}setMercatorFromTransition(){const c=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=_.getProjection({name:"mercator"});const g=c!==this.projection.name;return g&&this._calcMatrices(),g}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(c){void 0===c?c=!0:null===c&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get cameraWorldSize(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return _.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new _.pointGeometry(this.width,this.height)}get bearing(){return _.wrap(this.rotation,-180,180)}set bearing(c){this.rotation=c}get rotation(){return-this.angle/Math.PI*180}set rotation(c){const g=-c*Math.PI/180;var C,S,D,L,z,G,J,ee,re,fe;this.angle!==g&&(this._unmodified=!1,this.angle=g,this._calcMatrices(),this.rotationMatrix=(C=new _.ARRAY_TYPE(4),_.ARRAY_TYPE!=Float32Array&&(C[1]=0,C[2]=0),C[0]=1,C[3]=1,C),S=this.rotationMatrix,L=this.angle,z=(D=this.rotationMatrix)[0],G=D[1],J=D[2],ee=D[3],re=Math.sin(L),fe=Math.cos(L),S[0]=z*fe+J*re,S[1]=G*fe+ee*re,S[2]=z*-re+J*fe,S[3]=G*-re+ee*fe)}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const g=_.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==g&&(this._unmodified=!1,this._pitch=g,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const c=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/c)}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=_.degToRad(c),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(c){this._averageElevation=c,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(c){const g=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==g&&(this._unmodified=!1,this._setZoom(g),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(c){this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const c=this._elevation;this._centerAltitude=c.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=c.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const c=this._elevation,g=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],C=this.horizonLineFromTop();let S=0,D=0;for(let L=0;L<g.length;L++){const z=new _.pointGeometry(g[L][0]*this.width,C+g[L][1]*(this.height-C)),G=c.pointCoordinate(z);if(!G)continue;const J=1/Math.hypot(G[0]-this._camera.position[0],G[1]-this._camera.position[1]);S+=G[3]*J,D+=J}return 0===D?NaN:S/D}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const c=this._seaLevelZoom,g=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),C=this.pixelsPerMeter/this.worldSize*g,S=this._mercatorZfromZoom(c),D=this._mercatorZfromZoom(this._maxZoom),L=Math.max(S-C,D);this._setZoom(this._zoomFromMercatorZ(L))}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}computeZoomRelativeTo(c){const g=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,c.toAltitude()));let C;C=c.z<this._camera.position[2]?[g.x,g.y,g.z]:[c.x,c.y,c.z];const S=_.length(_.sub([],this._camera.position,C));return _.clamp(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(c){if(!this.height||!c.position&&!c.orientation)return;this._updateCameraState();let g=!1;if(c.orientation&&!_.exactEquals(c.orientation,this._camera.orientation)&&(g=this._setCameraOrientation(c.orientation)),c.position){const C=[c.position.x,c.position.y,c.position.z];_.exactEquals$1(C,this._camera.position)||(this._setCameraPosition(C),g=!0)}g&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const c=this._camera.position,g=new vd;return g.position=new _.MercatorCoordinate(c[0],c[1],c[2]),g.orientation=this._camera.orientation,g._elevation=this.elevation,g._renderWorldCopies=this.renderWorldCopies,g}_setCameraOrientation(c){if(!_.length$1(c))return!1;_.normalize$1(c,c);const g=_.transformQuat([],[0,0,-1],c),C=_.transformQuat([],[0,-1,0],c);if(C[2]<0)return!1;const S=Au(g,C);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(c){const g=this.zoomScale(this.minZoom)*this.tileSize,C=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;c[2]=_.clamp(c[2],S/C,S/g),this._camera.position=c}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,g,C){this._unmodified=!1,this._edgeInsets.interpolate(c,g,C),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const g=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,g)}getVisibleUnwrappedCoordinates(c){const g=[new _.UnwrappedTileID(0,c)];if(this.renderWorldCopies){const C=this.pointCoordinate(new _.pointGeometry(0,0)),S=this.pointCoordinate(new _.pointGeometry(this.width,0)),D=this.pointCoordinate(new _.pointGeometry(this.width,this.height)),L=this.pointCoordinate(new _.pointGeometry(0,this.height)),z=Math.floor(Math.min(C.x,S.x,D.x,L.x)),G=Math.floor(Math.max(C.x,S.x,D.x,L.x)),J=1;for(let ee=z-J;ee<=G+J;ee++)0!==ee&&g.push(new _.UnwrappedTileID(ee,c))}return g}coveringTiles(c){let g=this.coveringZoomLevel(c);const C=g,S=this.elevation&&!c.isTerrainDEM,D="mercator"===this.projection.name;if(void 0!==c.minzoom&&g<c.minzoom)return[];void 0!==c.maxzoom&&g>c.maxzoom&&(g=c.maxzoom);const L=this.locationCoordinate(this.center),z=this.center.lat,G=1<<g,J=[G*L.x,G*L.y,0],ee="globe"===this.projection.name,re=!ee,fe=_.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,g,re),_e=ee?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),de=G*_.mercatorZfromAltitude(1,this.center.lat),ve=this._camera.position[2]/_.mercatorZfromAltitude(1,this.center.lat),xe=[G*_e.x,G*_e.y,ve*(re?1:de)],ue=this.cameraToCenterDistance/c.tileSize*(c.roundZoom?1:.502),Ce=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?g:0,be=c.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Me=c.isTerrainDEM?-be:this._elevation?this._elevation.getMinElevationBelowMSL():0,Le=this.projection.isReprojectedInTileSpace?Vp(this):1,Fe=et=>{const Xe=new _.MercatorCoordinate(et.x+25e-6,et.y,et.z),Mt=new _.MercatorCoordinate(et.x,et.y+25e-6,et.z),Rt=et.toLngLat(),dn=Xe.toLngLat(),Wn=Mt.toLngLat(),_n=this.locationCoordinate(Rt),Yt=this.locationCoordinate(dn),yn=this.locationCoordinate(Wn),xi=Math.hypot(Yt.x-_n.x,Yt.y-_n.y),Vn=Math.hypot(yn.x-_n.x,yn.y-_n.y);return Math.sqrt(xi*Vn)*Le/25e-6},Ue=et=>{const qe=be,Xe=Me;return{aabb:_.tileAABB(this,G,0,0,0,et,Xe,qe,this.projection),zoom:0,x:0,y:0,minZ:Xe,maxZ:qe,wrap:et,fullyVisible:!1}},We=[];let it=[];const st=g,Ut=c.reparseOverscaled?C:g,Qe=et=>et*et,St=Qe((ve-this._centerAltitude)*de),at=et=>{if(!this._elevation||!et.tileID||!D)return;const qe=this._elevation.getMinMaxForTile(et.tileID),Xe=et.aabb;qe?(Xe.min[2]=qe.min,Xe.max[2]=qe.max,Xe.center[2]=(Xe.min[2]+Xe.max[2])/2):(et.shouldSplit=Ot(et),et.shouldSplit||(Xe.min[2]=Xe.max[2]=Xe.center[2]=this._centerAltitude))},Ot=et=>{if(et.zoom<Ce)return!0;if(et.zoom===st)return!1;if(null!=et.shouldSplit)return et.shouldSplit;const qe=et.aabb.distanceX(xe),Xe=et.aabb.distanceY(xe);let Mt=St,Rt=1;if(ee){Mt=Qe(et.aabb.distanceZ(xe));const _n=Math.pow(2,et.zoom),Yt=_.latFromMercatorY((et.y+1)/_n),yn=_.latFromMercatorY(et.y/_n),xi=Math.min(Math.max(z,Yt),yn),Vn=_.circumferenceAtLatitude(xi)/_.circumferenceAtLatitude(z);if(Rt=xi===z?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Vn/this._mercatorScaleRatio),this.zoom<=_.GLOBE_ZOOM_THRESHOLD_MIN&&et.zoom===st-1&&Vn>=.9)return!0}else if(S&&(Mt=Qe(et.aabb.distanceZ(xe)*de)),this.projection.isReprojectedInTileSpace&&C<=5){const _n=Math.pow(2,et.zoom),Yt=Fe(new _.MercatorCoordinate((et.x+.5)/_n,(et.y+.5)/_n));Rt=Yt>.85?1:Yt}const dn=qe*qe+Xe*Xe+Mt;return dn<Qe((1<<st-et.zoom)*ue*Rt*((_n,Yt)=>{if(Yt*Qe(.707)<_n)return 1;const yn=Math.sqrt(Yt/_n);return yn/(1.4144271570014144+(Math.pow(1.1,yn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Mt,St),dn))};if(this.renderWorldCopies)for(let et=1;et<=3;et++)We.push(Ue(-et)),We.push(Ue(et));for(We.push(Ue(0));We.length>0;){const et=We.pop(),qe=et.x,Xe=et.y;let Mt=et.fullyVisible;if(!Mt){const Rt=et.aabb.intersects(fe);if(0===Rt)continue;Mt=2===Rt}if(et.zoom!==st&&Ot(et))for(let Rt=0;Rt<4;Rt++){const dn=(qe<<1)+Rt%2,Wn=(Xe<<1)+(Rt>>1),_n={aabb:D?et.aabb.quadrant(Rt):_.tileAABB(this,G,et.zoom+1,dn,Wn,et.wrap,et.minZ,et.maxZ,this.projection),zoom:et.zoom+1,x:dn,y:Wn,wrap:et.wrap,fullyVisible:Mt,tileID:void 0,shouldSplit:void 0,minZ:et.minZ,maxZ:et.maxZ};S&&!ee&&(_n.tileID=new _.OverscaledTileID(et.zoom+1===st?Ut:et.zoom+1,et.wrap,et.zoom+1,dn,Wn),at(_n)),We.push(_n)}else{const Rt=et.zoom===st?Ut:et.zoom;if(c.minzoom&&c.minzoom>Rt)continue;const dn=J[0]-(.5+qe+(et.wrap<<et.zoom))*(1<<g-et.zoom),Wn=J[1]-.5-Xe,_n=et.tileID?et.tileID:new _.OverscaledTileID(Rt,et.wrap,et.zoom,qe,Xe);it.push({tileID:_n,distanceSq:dn*dn+Wn*Wn})}}if(this.fogCullDistSq){const et=this.fogCullDistSq,qe=this.horizonLineFromTop();it=it.filter(Xe=>{const Mt=[0,0,0,1],Rt=[_.EXTENT,_.EXTENT,0,1],dn=this.calculateFogTileMatrix(Xe.tileID.toUnwrapped());_.transformMat4$1(Mt,Mt,dn),_.transformMat4$1(Rt,Rt,dn);const Wn=_.getAABBPointSquareDist(Mt,Rt);if(0===Wn)return!0;let _n=!1;const Yt=this._elevation;if(Yt&&Wn>et&&0!==qe){const yn=this.calculateProjMatrix(Xe.tileID.toUnwrapped());let xi;c.isTerrainDEM||(xi=Yt.getMinMaxForTile(Xe.tileID)),xi||(xi={min:Me,max:be});const Vn=_.furthestTileCorner(this.rotation),er=[Vn[0]*_.EXTENT,Vn[1]*_.EXTENT,xi.max];_.transformMat4(er,er,yn),_n=(1-er[1])*this.height*.5<qe}return Wn<et||_n})}return it.sort((et,qe)=>et.distanceSq-qe.distanceSq).map(et=>et.tileID)}resize(c,g){this.width=c,this.height=g,this.pixelsToGLUnits=[2/c,-2/g],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const g=_.clamp(c.lat,-_.MAX_MERCATOR_LATITUDE,_.MAX_MERCATOR_LATITUDE),C=this.projection.project(c.lng,g);return new _.pointGeometry(C.x*this.worldSize,C.y*this.worldSize)}unproject(c){return this.projection.unproject(c.x/this.worldSize,c.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/_.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(c,g){let C,S;const D=this.centerPoint;if("globe"===this.projection.name){const z=this.worldSize;C=(g.x-D.x)/z,S=(g.y-D.y)/z}else{const z=this.pointCoordinate(g),G=this.pointCoordinate(D);C=z.x-G.x,S=z.y-G.y}const L=this.locationCoordinate(c);this.setLocation(new _.MercatorCoordinate(L.x-C,L.y-S))}setLocation(c){this.center=this.coordinateLocation(c),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(c){return this.projection.locationPoint(this,c)}locationPoint3D(c){return this.projection.locationPoint(this,c,!0)}pointLocation(c){return this.coordinateLocation(this.pointCoordinate(c))}pointLocation3D(c){return this.coordinateLocation(this.pointCoordinate3D(c))}locationCoordinate(c,g){const C=g?_.mercatorZfromAltitude(g,c.lat):void 0,S=this.projection.project(c.lng,c.lat);return new _.MercatorCoordinate(S.x,S.y,C)}coordinateLocation(c){return this.projection.unproject(c.x,c.y)}pointRayIntersection(c,g){const C=g??this._centerAltitude,S=[c.x,c.y,0,1],D=[c.x,c.y,1,1];_.transformMat4$1(S,S,this.pixelMatrixInverse),_.transformMat4$1(D,D,this.pixelMatrixInverse);const L=D[3];_.scale$1(S,S,1/S[3]),_.scale$1(D,D,1/L);const z=S[2],G=D[2];return{p0:S,p1:D,t:z===G?0:(C-z)/(G-z)}}screenPointToMercatorRay(c){const g=[c.x,c.y,0,1],C=[c.x,c.y,1,1];return _.transformMat4$1(g,g,this.pixelMatrixInverse),_.transformMat4$1(C,C,this.pixelMatrixInverse),_.scale$1(g,g,1/g[3]),_.scale$1(C,C,1/C[3]),g[2]=_.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,C[2]=_.mercatorZfromAltitude(C[2],this._center.lat)*this.worldSize,_.scale$1(g,g,1/this.worldSize),_.scale$1(C,C,1/this.worldSize),new _.Ray([g[0],g[1],g[2]],_.normalize([],_.sub([],C,g)))}rayIntersectionCoordinate(c){const{p0:g,p1:C,t:S}=c,D=_.mercatorZfromAltitude(g[2],this._center.lat),L=_.mercatorZfromAltitude(C[2],this._center.lat);return new _.MercatorCoordinate(_.number(g[0],C[0],S)/this.worldSize,_.number(g[1],C[1],S)/this.worldSize,_.number(D,L,S))}pointCoordinate(c,g=this._centerAltitude){return this.projection.pointCoordinate(this,c.x,c.y,g)}pointCoordinate3D(c){if(!this.elevation)return this.pointCoordinate(c);let g=this.projection.pointCoordinate3D(this,c.x,c.y);if(g)return new _.MercatorCoordinate(g[0],g[1],g[2]);let C=0,S=this.horizonLineFromTop();if(c.y>S)return this.pointCoordinate(c);const D=.02*S,L=c.clone();for(let z=0;z<10&&S-C>D;z++){L.y=_.number(C,S,.66);const G=this.projection.pointCoordinate3D(this,L.x,L.y);G?(S=L.y,g=G):C=L.y}return g?new _.MercatorCoordinate(g[0],g[1],g[2]):this.pointCoordinate(c)}isPointAboveHorizon(c){return this.projection.isPointAboveHorizon(this,c)}_coordinatePoint(c,g){const C=g&&this.elevation?this.elevation.getAtPointOrZero(c,this._centerAltitude):this._centerAltitude,S=[c.x*this.worldSize,c.y*this.worldSize,C+c.toAltitude(),1];return _.transformMat4$1(S,S,this.pixelMatrix),S[3]>0?new _.pointGeometry(S[0]/S[3],S[1]/S[3]):new _.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:c,left:g}=this._edgeInsets,C=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,D=this.pointLocation3D(new _.pointGeometry(g,c)),L=this.pointLocation3D(new _.pointGeometry(S,c)),z=this.pointLocation3D(new _.pointGeometry(S,C)),G=this.pointLocation3D(new _.pointGeometry(g,C));let J=Math.min(D.lng,L.lng,z.lng,G.lng),ee=Math.max(D.lng,L.lng,z.lng,G.lng),re=Math.min(D.lat,L.lat,z.lat,G.lat),fe=Math.max(D.lat,L.lat,z.lat,G.lat);const _e=Math.pow(2,-this.zoom)/16*270,de="globe"===this.projection.name?1:4,ve=(xe,ue,Ce,be,Me)=>{const Le=(xe+Ce)/2,Fe=(ue+be)/2,Ue=new _.pointGeometry(Le,Fe),{lng:We,lat:it}=this.pointLocation3D(Ue),st=Math.max(0,J-We,re-it,We-ee,it-fe);J=Math.min(J,We),ee=Math.max(ee,We),re=Math.min(re,it),fe=Math.max(fe,it),(Me<de||st>_e)&&(ve(xe,ue,Le,Fe,Me+1),ve(Le,Fe,Ce,be,Me+1))};if(ve(g,c,S,c,1),ve(S,c,S,C,1),ve(S,C,g,C,1),ve(g,C,g,c,1),"globe"===this.projection.name){const[xe,ue]=_.polesInViewport(this);xe?(fe=90,ee=180,J=-180):ue&&(re=-90,ee=180,J=-180)}return new _.LngLatBounds(new _.LngLat(J,re),new _.LngLat(ee,fe))}_getBoundsRectangular(c,g){const{top:C,left:S}=this._edgeInsets,D=this.height-this._edgeInsets.bottom,L=this.width-this._edgeInsets.right,z=new _.pointGeometry(S,C),G=new _.pointGeometry(L,C),J=new _.pointGeometry(L,D),ee=new _.pointGeometry(S,D);let re=this.pointCoordinate(z,c),fe=this.pointCoordinate(G,c);const _e=this.pointCoordinate(J,g),de=this.pointCoordinate(ee,g),ve=(xe,ue)=>(ue.y-xe.y)/(ue.x-xe.x);return re.y>1&&fe.y>=0?re=new _.MercatorCoordinate((1-de.y)/ve(de,re)+de.x,1):re.y<0&&fe.y<=1&&(re=new _.MercatorCoordinate(-de.y/ve(de,re)+de.x,0)),fe.y>1&&re.y>=0?fe=new _.MercatorCoordinate((1-_e.y)/ve(_e,fe)+_e.x,1):fe.y<0&&re.y<=1&&(fe=new _.MercatorCoordinate(-_e.y/ve(_e,fe)+_e.x,0)),(new _.LngLatBounds).extend(this.coordinateLocation(re)).extend(this.coordinateLocation(fe)).extend(this.coordinateLocation(de)).extend(this.coordinateLocation(_e))}_getBoundsRectangularTerrain(){const c=this.elevation;if(!c.visibleDemTiles.length||c.isUsingMockSource())return this._getBoundsRectangular(0,0);const g=c.visibleDemTiles.reduce((C,S)=>{if(S.dem){const D=S.dem.tree;C.min=Math.min(C.min,D.minimums[0]),C.max=Math.max(C.max,D.maximums[0])}return C},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(g.min*c.exaggeration(),g.max*c.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(c=!0){const g=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,C=this.height/2-g*(1-this._horizonShift);return c?Math.max(0,C):C}getMaxBounds(){return this.maxBounds}setMaxBounds(c){this.maxBounds=c,this.minLat=-_.MAX_MERCATOR_LATITUDE,this.maxLat=_.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,c&&(this.minLat=c.getSouth(),this.maxLat=c.getNorth(),this.minLng=c.getWest(),this.maxLng=c.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=_.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=_.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=_.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=_.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(c,g){return this.projection.createTileMatrix(this,g,c)}calculateDistanceTileData(c){const g=c.key,C=this._distanceTileDataCache;if(C[g])return C[g];const S=c.canonical,D=1/this.height,L=this.cameraWorldSize,z=L/this.zoomScale(S.z),G=(S.x+Math.pow(2,S.z)*c.wrap)*z,J=S.y*z,ee=this.point;ee.x*=L/this.worldSize,ee.y*=L/this.worldSize;const re=this.angle,fe=Math.sin(-re),_e=-Math.cos(-re);return C[g]={bearing:[fe,_e],center:[(ee.x-G)*D,(ee.y-J)*D],scale:z/_.EXTENT*D},C[g]}calculateFogTileMatrix(c){const g=c.key,C=this._fogTileMatrixCache;if(C[g])return C[g];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,c);return _.multiply(S,this.worldToFogMatrix,S),C[g]=new Float32Array(S),C[g]}calculateProjMatrix(c,g=!1){const C=c.key,S=g?this._alignedProjMatrixCache:this._projMatrixCache;if(S[C])return S[C];const D=this.calculatePosMatrix(c,this.worldSize);return _.multiply(D,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.alignedProjMatrix:this.projMatrix,D),S[C]=new Float32Array(D),S[C]}calculatePixelsToTileUnitsMatrix(c){const g=c.tileID.key,C=this._pixelsToTileUnitsCache;if(C[g])return C[g];const S=function(D,L){const{scale:z}=D.tileTransform,G=z*_.EXTENT/(D.tileSize*Math.pow(2,L.zoom-D.tileID.overscaledZ+D.tileID.canonical.z));return J=new Float32Array(4),fe=(ee=L.inverseAdjustmentMatrix)[1],_e=ee[2],de=ee[3],xe=(re=[G,G])[1],J[0]=ee[0]*(ve=re[0]),J[1]=fe*ve,J[2]=_e*xe,J[3]=de*xe,J;var J,ee,re,fe,_e,de,ve,xe}(c,this);return C[g]=S,C[g]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const c=1/this.worldSize,g=_.fromScaling([],[c,c,c]);return _.multiply(g,g,this.globeMatrix),g}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const c=this._elevation;this._updateCameraState();const g=_.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,C=this._computeCameraPosition(g),S=this._camera.forward(),D=_.mercatorZfromAltitude(1,this._center.lat);C[2]/=D,S[2]/=D,_.normalize(S,S);const L=c.raycast(C,S,c.exaggeration());if(L){const z=_.scaleAndAdd([],C,S,L),G=new _.MercatorCoordinate(z[0],z[1],_.mercatorZfromAltitude(z[2],_.latFromMercatorY(z[1]))),J=(G.z+_.length([G.x-C[0],G.y-C[1],G.z-C[2]*D]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(J),this._centerAltitude=G.toAltitude(),this._center=this.coordinateLocation(G),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(c=!1){if(!this._elevation)return;const g=this._elevation,C=_.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(C),D=g.getAtPointOrZero(new _.MercatorCoordinate(...S)),L=this.pixelsPerMeter/this.worldSize*D,z=this._minimumHeightOverTerrain(),G=S[2]-L;if(G<=z)if(G<0||c){const J=this.locationCoordinate(this._center,this._centerAltitude),ee=[S[0],S[1],J.z-S[2]],re=_.length(ee);ee[2]-=(z-G)/this._pixelsPerMercatorPixel;const fe=_.length(ee);if(0===fe)return;_.scale$2(ee,ee,re/fe*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],J.z*this._pixelsPerMercatorPixel-ee[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const c="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||c){const fe=this.center;return fe.lat=_.clamp(fe.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!c)&&(fe.lng=_.clamp(fe.lng,this.minLng,this.maxLng)),this.center=fe,void(this._constraining=!1)}const g=this._unmodified,{x:C,y:S}=this.point;let D=0,L=C,z=S;const G=this.width/2,J=this.height/2,ee=this.worldMinY*this.scale,re=this.worldMaxY*this.scale;if(S-J<ee&&(z=ee+J),S+J>re&&(z=re-J),re-ee<this.height&&(D=Math.max(D,this.height/(re-ee)),z=(re+ee)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const fe=this.worldMinX*this.scale,_e=this.worldMaxX*this.scale,de=this.worldSize/2-(fe+_e)/2;L=(C+de+this.worldSize)%this.worldSize-de,L-G<fe&&(L=fe+G),L+G>_e&&(L=_e-G),_e-fe<this.width&&(D=Math.max(D,this.width/(_e-fe)),L=(_e+fe)/2)}L===C&&z===S||(this.center=this.unproject(new _.pointGeometry(L,z))),D&&(this.zoom+=this.scaleZoom(D)),this._constrainCamera(),this._unmodified=g,this._constraining=!1}_minZoomForBounds(){let c=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(c=Math.max(c,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),c}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,g=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=_.mercatorZfromAltitude(1,this.center.lat)/_.mercatorZfromAltitude(1,_.GLOBE_SCALE_MATCH_LATITUDE));const C=Il(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,C),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S="meters"===this.projection.zAxisUnit?g:1,D=this._camera.getWorldToCamera(this.worldSize,S),L=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);L[8]=2*-c.x/this.width,L[9]=2*c.y/this.height;let z=_.mul([],L,D);if(this.projection.isReprojectedInTileSpace){const Fe=this.locationCoordinate(this.center),Ue=_.identity([]);_.translate(Ue,Ue,[Fe.x*this.worldSize,Fe.y*this.worldSize,0]),_.multiply(Ue,Ue,Tl(this)),_.translate(Ue,Ue,[-Fe.x*this.worldSize,-Fe.y*this.worldSize,0]),_.multiply(z,z,Ue),this.inverseAdjustmentMatrix=function(We){const it=Tl(We,!0);return xt([],[it[0],it[1],it[4],it[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=_.scale([],z,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=z,this.invProjMatrix=_.invert(new Float64Array(16),this.projMatrix);const G=_.invert([],L);this.frustumCorners=_.FrustumCorners.fromInvProjectionMatrix(G,this.horizonLineFromTop(),this.height);const J=new Float32Array(16);_.identity(J),_.scale(J,J,[1,-1,1]),_.rotateX(J,J,this._pitch),_.rotateZ(J,J,this.angle);const ee=_.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),re=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ee[8]=2*-c.x/this.width,ee[9]=2*(c.y+re)/this.height,this.skyboxMatrix=_.multiply(J,ee,J);const fe=this.point,_e=fe.x,de=fe.y,ve=this.width%2/2,xe=this.height%2/2,ue=Math.cos(this.angle),Ce=Math.sin(this.angle),be=_e-Math.round(_e)+ue*ve+Ce*xe,Me=de-Math.round(de)+ue*xe+Ce*ve,Le=new Float64Array(z);if(_.translate(Le,Le,[be>.5?be-1:be,Me>.5?Me-1:Me,0]),this.alignedProjMatrix=Le,z=_.create(),_.scale(z,z,[this.width/2,-this.height/2,1]),_.translate(z,z,[1,-1,0]),this.labelPlaneMatrix=z,z=_.create(),_.scale(z,z,[1,-1,1]),_.translate(z,z,[-1,-1,0]),_.scale(z,z,[2/this.width,2/this.height,1]),this.glCoordMatrix=z,this.pixelMatrix=_.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},z=_.invert(new Float64Array(16),this.pixelMatrix),!z)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=z,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=_.calculateGlobeMatrix(this);const Fe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=_.transformMat4(Fe,Fe,D),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=z;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const c=this.cameraWorldSizeForFog,g=this.cameraPixelsPerMeter,C=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,D=[c,c,g];_.scale$2(D,D,S),_.scale$2(C,C,-1),_.multiply$2(C,C,D);const L=_.create();_.translate(L,L,C),_.scale(L,L,D),this.mercatorFogMatrix=L,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(c,g,S)}_computeCameraPosition(c){const g=(c=c||this.pixelsPerMeter)/this.pixelsPerMeter,C=this._camera.forward(),S=this.point,D=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*g-c/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-C[0]*D,S.y/this.worldSize-C[1]*D,c/this.worldSize*this._centerAltitude-C[2]*D]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(c){const g=this._maxCameraBoundsDistance()*Math.cos(this._pitch),C=this._camera.position[2],S=c[2];let D=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(D=Math.min((g-C)/S,1)),this._camera.position=_.scaleAndAdd([],this._camera.position,c,D),this._updateStateFromCamera()}_updateStateFromCamera(){const c=this._camera.position,g=this._camera.forward(),{pitch:C,bearing:S}=this._camera.getPitchBearing(),D=_.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,L=this._mercatorZfromZoom(this._maxZoom)*Math.cos(_.degToRad(this._maxPitch)),z=Math.max((c[2]-D)/Math.cos(C),L),G=this._zoomFromMercatorZ(z);_.scaleAndAdd(c,c,g,z),this._pitch=_.clamp(C,_.degToRad(this.minPitch),_.degToRad(this.maxPitch)),this.angle=_.wrap(S,-Math.PI,Math.PI),this._setZoom(_.clamp(G,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new _.MercatorCoordinate(c[0],c[1],c[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(c){return Math.pow(2,c)*this.tileSize}_mercatorZfromZoom(c){return this.cameraToCenterDistance/this._worldSizeFromZoom(c)}_minimumHeightOverTerrain(){const c=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(c)}_zoomFromMercatorZ(c){return this.scaleZoom(this.cameraToCenterDistance/(c*this.tileSize))}zoomFromMercatorZAdjusted(c){let g=0,C=_.GLOBE_ZOOM_THRESHOLD_MAX,S=0,D=1/0;for(;C-g>1e-6&&C>g;){const L=g+.5*(C-g),z=this.tileSize*Math.pow(2,L),G=this.getCameraToCenterDistance(this.projection,L,z),J=this.scaleZoom(G/(c*this.tileSize)),ee=Math.abs(L-J);ee<D&&(D=ee,S=L),L<J?g=L:C=L}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(_.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(c,g){const C=Math.min(c.x,g.x),S=Math.max(c.x,g.x),D=Math.min(c.y,g.y),L=Math.max(c.y,g.y);if(D<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const z=[new _.pointGeometry(C,D),new _.pointGeometry(S,L),new _.pointGeometry(C,L),new _.pointGeometry(S,D)],G=this.renderWorldCopies?-3:0,J=this.renderWorldCopies?4:1;for(const ee of z){const re=this.pointRayIntersection(ee);if(re.t<0)return!0;const fe=this.rayIntersectionCoordinate(re);if(fe.x<G||fe.y<0||fe.x>J||fe.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+_.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new _.pointGeometry(0,0),new _.pointGeometry(this.width,this.height))}zoomDeltaToMovement(c,g){const C=_.length(_.sub([],this._camera.position,c)),S=this._zoomFromMercatorZ(C)+g;return C-this._mercatorZfromZoom(S)}getCameraPoint(){if("globe"===this.projection.name){const c=function([g,C,S],D){const L=[g,C,S,1];_.transformMat4$1(L,L,D);const z=L[3]=Math.max(L[3],1e-6);return L[0]/=z,L[1]/=z,L[2]/=z,L}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new _.pointGeometry(c[0],c[1])}{const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new _.pointGeometry(0,c))}}getCameraToCenterDistance(c,g=this.zoom,C=this.worldSize){const S=Il(c,g,this.width,this.height,1024),D=c.pixelSpaceConversion(this.center.lat,C,S);return.5/Math.tan(.5*this._fov)*this.height*D}getWorldToCameraMatrix(){const c=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&_.multiply(c,c,this.globeMatrix),c}}function rr(v,c){let g=!1,C=null;const S=()=>{C=null,g&&(v(),C=setTimeout(S,c),g=!1)};return()=>(g=!0,C||S(),C)}class bd{constructor(c){this._hashName=c&&encodeURIComponent(c),_.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=rr(this._updateHashUnthrottled.bind(this),300)}addTo(c){return this._map=c,_.window.addEventListener("hashchange",this._onHashChange,!1),c.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),_.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const c=this._map;if(!c)return"";const g=Ma(c);if(this._hashName){const C=this._hashName;let S=!1;const D=_.window.location.hash.slice(1).split("&").map(L=>{const z=L.split("=")[0];return z===C?(S=!0,`${z}=${g}`):L}).filter(L=>L);return S||D.push(`${C}=${g}`),`#${D.join("&")}`}return`#${g}`}_getCurrentHash(){const c=_.window.location.hash.replace("#","");if(this._hashName){let g;return c.split("&").map(C=>C.split("=")).forEach(C=>{C[0]===this._hashName&&(g=C)}),(g&&g[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._map;if(!c)return!1;const g=this._getCurrentHash();if(g.length>=3&&!g.some(C=>isNaN(C))){const C=c.dragRotate.isEnabled()&&c.touchZoomRotate.isEnabled()?+(g[3]||0):c.getBearing();return c.jumpTo({center:[+g[2],+g[1]],zoom:+g[0],bearing:C,pitch:+(g[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=_.window.location.href.replace(/(#.+)?$/,this.getHashString());_.window.history.replaceState(_.window.history.state,null,c)}}function Ma(v,c){const g=v.getCenter(),C=Math.round(100*v.getZoom())/100,S=Math.ceil((C*Math.LN2+Math.log(512/360/.5))/Math.LN10),D=Math.pow(10,S),L=Math.round(g.lng*D)/D,z=Math.round(g.lat*D)/D,G=v.getBearing(),J=v.getPitch();let ee=c?`/${L}/${z}/${C}`:`${C}/${z}/${L}`;return(G||J)&&(ee+="/"+Math.round(10*G)/10),J&&(ee+=`/${Math.round(J)}`),ee}const Gc={linearity:.3,easing:_.bezier(0,0,.3,1)},Qa=_.extend({deceleration:2500,maxSpeed:1400},Gc),xd=_.extend({deceleration:20,maxSpeed:1400},Gc),fh=_.extend({deceleration:1e3,maxSpeed:360},Gc),Hc=_.extend({deceleration:1e3,maxSpeed:90},Gc);class qc{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:_.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,g=_.exported.now();for(;c.length>0&&g-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const g={zoom:0,bearing:0,pitch:0,pan:new _.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:D}of this._inertiaBuffer)g.zoom+=D.zoomDelta||0,g.bearing+=D.bearingDelta||0,g.pitch+=D.pitchDelta||0,D.panDelta&&g.pan._add(D.panDelta),D.around&&(g.around=D.around),D.pinchAround&&(g.pinchAround=D.pinchAround);const C=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(g.pan.mag()){const D=wd(g.pan.mag(),C,_.extend({},Qa,c||{}));S.offset=g.pan.mult(D.amount/g.pan.mag()),S.center=this._map.transform.center,Da(S,D)}if(g.zoom){const D=wd(g.zoom,C,xd);S.zoom=this._map.transform.zoom+D.amount,Da(S,D)}if(g.bearing){const D=wd(g.bearing,C,fh);S.bearing=this._map.transform.bearing+_.clamp(D.amount,-179,179),Da(S,D)}if(g.pitch){const D=wd(g.pitch,C,Hc);S.pitch=this._map.transform.pitch+D.amount,Da(S,D)}if(S.zoom||S.bearing){const D=void 0===g.pinchAround?g.around:g.pinchAround;S.around=D?this._map.unproject(D):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function Da(v,c){(!v.duration||v.duration<c.duration)&&(v.duration=c.duration,v.easing=c.easing)}function wd(v,c,g){const{maxSpeed:C,linearity:S,deceleration:D}=g,L=_.clamp(v*S/(c/1e3),-C,C),z=Math.abs(L)/(D*S);return{easing:g.easing,duration:1e3*z,amount:L*(z/2)}}class Zr extends _.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,g,C,S={}){const D=Ye(g.getCanvasContainer(),C),L=g.unproject(D);super(c,_.extend({point:D,lngLat:L,originalEvent:C},S)),this._defaultPrevented=!1,this.target=g}}class Ml extends _.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,g,C){const S="touchend"===c?C.changedTouches:C.touches,D=kt(g.getCanvasContainer(),S),L=D.map(G=>g.unproject(G)),z=D.reduce((G,J,ee,re)=>G.add(J.div(re.length)),new _.pointGeometry(0,0));super(c,{points:D,point:z,lngLats:L,lngLat:g.unproject(z),originalEvent:C}),this._defaultPrevented=!1}}class ph extends _.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,g,C){super(c,{originalEvent:C}),this._defaultPrevented=!1}}class Ps{constructor(c,g){this._map=c,this._clickTolerance=g.clickTolerance}reset(){this._mousedownPos=void 0}wheel(c){return this._firePreventable(new ph(c.type,this._map,c))}mousedown(c,g){return this._mousedownPos=g,this._firePreventable(new Zr(c.type,this._map,c))}mouseup(c){this._map.fire(new Zr(c.type,this._map,c))}preclick(c){const g=_.extend({},c);g.type="preclick",this._map.fire(new Zr(g.type,this._map,g))}click(c,g){this._mousedownPos&&this._mousedownPos.dist(g)>=this._clickTolerance||(this.preclick(c),this._map.fire(new Zr(c.type,this._map,c)))}dblclick(c){return this._firePreventable(new Zr(c.type,this._map,c))}mouseover(c){this._map.fire(new Zr(c.type,this._map,c))}mouseout(c){this._map.fire(new Zr(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Ml(c.type,this._map,c))}touchmove(c){this._map.fire(new Ml(c.type,this._map,c))}touchend(c){this._map.fire(new Ml(c.type,this._map,c))}touchcancel(c){this._map.fire(new Ml(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Cd{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(c){this._map.fire(new Zr(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Zr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new Zr(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Dl{constructor(c,g){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=g.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,g){this.isEnabled()&&c.shiftKey&&0===c.button&&(nn(),this._startPos=this._lastPos=g,this._active=!0)}mousemoveWindow(c,g){if(!this._active)return;const C=g,S=this._startPos,D=this._lastPos;if(!S||!D||D.equals(C)||!this._box&&C.dist(S)<this._clickTolerance)return;this._lastPos=C,this._box||(this._box=It("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const L=Math.min(S.x,C.x),z=Math.max(S.x,C.x),G=Math.min(S.y,C.y),J=Math.max(S.y,C.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${L}px,${G}px)`,this._box.style.width=z-L+"px",this._box.style.height=J-G+"px")})}mouseupWindow(c,g){if(!this._active)return;const C=this._startPos,S=g;if(C&&0===c.button){if(this.reset(),vt(),C.x!==S.x||C.y!==S.y)return this._map.fire(new _.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:D=>D.fitScreenCoordinates(C,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",c)}}keydown(c){this._active&&27===c.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",c))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),bn(),delete this._startPos,delete this._lastPos}_fireEvent(c,g){return this._map.fire(new _.Event(c,{originalEvent:g}))}}function Zc(v,c){const g={};for(let C=0;C<v.length;C++)g[v[C].identifier]=c[C];return g}class Ed{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(c,g,C){(this.centroid||C.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=c.timeStamp),C.length===this.numTouches&&(this.centroid=function(S){const D=new _.pointGeometry(0,0);for(const L of S)D._add(L);return D.div(S.length)}(g),this.touches=Zc(C,g)))}touchmove(c,g,C){if(this.aborted||!this.centroid)return;const S=Zc(C,g);for(const D in this.touches){const z=S[D];(!z||z.dist(this.touches[D])>30)&&(this.aborted=!0)}}touchend(c,g,C){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),0===C.length){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Aa{constructor(c){this.singleTap=new Ed(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(c,g,C){this.singleTap.touchstart(c,g,C)}touchmove(c,g,C){this.singleTap.touchmove(c,g,C)}touchend(c,g,C){const S=this.singleTap.touchend(c,g,C);if(S){const D=c.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(S)<30;if(D&&L||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class Pu{constructor(){this._zoomIn=new Aa({numTouches:1,numTaps:2}),this._zoomOut=new Aa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,g,C){this._zoomIn.touchstart(c,g,C),this._zoomOut.touchstart(c,g,C)}touchmove(c,g,C){this._zoomIn.touchmove(c,g,C),this._zoomOut.touchmove(c,g,C)}touchend(c,g,C){const S=this._zoomIn.touchend(c,g,C),D=this._zoomOut.touchend(c,g,C);return S?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()+1,around:L.unproject(S)},{originalEvent:c})}):D?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()-1,around:L.unproject(D)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Up={0:1,2:2};class Td{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(c,g){return!1}_move(c,g){return{}}mousedown(c,g){if(this._lastPoint)return;const C=Jt(c);this._correctButton(c,C)&&(this._lastPoint=g,this._eventButton=C)}mousemoveWindow(c,g){const C=this._lastPoint;if(C)if(c.preventDefault(),null!=this._eventButton&&function(S,D){const L=Up[D];return void 0===S.buttons||(S.buttons&L)!==L}(c,this._eventButton))this.reset();else if(this._moved||!(g.dist(C)<this._clickTolerance))return this._moved=!0,this._lastPoint=g,this._move(C,g)}mouseupWindow(c){this._lastPoint&&Jt(c)===this._eventButton&&(this._moved&&vt(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class mh extends Td{mousedown(c,g){super.mousedown(c,g),this._lastPoint&&(this._active=!0)}_correctButton(c,g){return 0===g&&!c.ctrlKey}_move(c,g){return{around:g,panDelta:g.sub(c)}}}class gh extends Td{_correctButton(c,g){return 0===g&&c.ctrlKey||2===g}_move(c,g){const C=.8*(g.x-c.x);if(C)return this._active=!0,{bearingDelta:C}}contextmenu(c){c.preventDefault()}}class _h extends Td{_correctButton(c,g){return 0===g&&c.ctrlKey||2===g}_move(c,g){const C=-.5*(g.y-c.y);if(C)return this._active=!0,{pitchDelta:C}}contextmenu(c){c.preventDefault()}}class rc{constructor(c,g){this._map=c,this._el=c.getCanvasContainer(),this._minTouches=1,this._clickTolerance=g.clickTolerance||1,this.reset(),_.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new _.pointGeometry(0,0)}touchstart(c,g,C){return this._calculateTransform(c,g,C)}touchmove(c,g,C){if(this._active&&!(C.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===C.length&&!_.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return c.cancelable&&c.preventDefault(),this._calculateTransform(c,g,C)}}touchend(c,g,C){this._calculateTransform(c,g,C),this._active&&C.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,g,C){C.length>0&&(this._active=!0);const S=Zc(C,g),D=new _.pointGeometry(0,0),L=new _.pointGeometry(0,0);let z=0;for(const J in S){const ee=S[J],re=this._touches[J];re&&(D._add(ee),L._add(ee.sub(re)),z++,S[J]=ee)}if(this._touches=S,z<this._minTouches||!L.mag())return;const G=L.div(z);return this._sum._add(G),this._sum.mag()<this._clickTolerance?void 0:{around:D.div(z),panDelta:G}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=It("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Ou{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(c){}_move(c,g,C){return{}}touchstart(c,g,C){this._firstTwoTouches||C.length<2||(this._firstTwoTouches=[C[0].identifier,C[1].identifier],this._start([g[0],g[1]]))}touchmove(c,g,C){const S=this._firstTwoTouches;if(!S)return;c.preventDefault();const[D,L]=S,z=da(C,g,D),G=da(C,g,L);if(!z||!G)return;const J=this._aroundCenter?null:z.add(G).div(2);return this._move([z,G],J,c)}touchend(c,g,C){if(!this._firstTwoTouches)return;const[S,D]=this._firstTwoTouches,L=da(C,g,S),z=da(C,g,D);L&&z||(this._active&&vt(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function da(v,c,g){for(let C=0;C<v.length;C++)if(v[C].identifier===g)return c[C]}function Sf(v,c){return Math.log(v/c)/Math.LN2}class Mf extends Ou{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,g){const C=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(Sf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Sf(this._distance,C),pinchAround:g}}}function Id(v,c){return 180*v.angleWith(c)/Math.PI}class Wc extends Ou{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,g){const C=this._vector;if(this._vector=c[0].sub(c[1]),C&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Id(this._vector,C),pinchAround:g}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const g=25/(Math.PI*this._minDiameter)*360,C=this._startVector;if(!C)return!1;const S=Id(c,C);return Math.abs(S)<g}}function yh(v){return Math.abs(v.y)>Math.abs(v.x)}class Io extends Ou{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(c){this._lastPoints=c,yh(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,g,C){const S=this._lastPoints;if(!S)return;const D=c[0].sub(S[0]),L=c[1].sub(S[1]);return this._map._cooperativeGestures&&!_.isFullscreen()&&C.touches.length<3||(this._valid=this.gestureBeginsVertically(D,L,C.timeStamp),!this._valid)?void 0:(this._lastPoints=c,this._active=!0,{pitchDelta:(D.y+L.y)/2*-.5})}gestureBeginsVertically(c,g,C){if(void 0!==this._valid)return this._valid;const S=c.mag()>=2,D=g.mag()>=2;if(!S&&!D)return;if(!S||!D)return null==this._firstMove&&(this._firstMove=C),C-this._firstMove<100&&void 0;const L=c.y>0==g.y>0;return yh(c)&&yh(g)&&L}}const Df={panStep:100,bearingStep:15,pitchStep:10};class Af{constructor(){const c=Df;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let g=0,C=0,S=0,D=0,L=0;switch(c.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:c.shiftKey?C=-1:(c.preventDefault(),D=-1);break;case 39:c.shiftKey?C=1:(c.preventDefault(),D=1);break;case 38:c.shiftKey?S=1:(c.preventDefault(),L=-1);break;case 40:c.shiftKey?S=-1:(c.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(C=0,S=0),{cameraAnimation:z=>{const G=z.getZoom();z.easeTo({duration:300,easeId:"keyboardHandler",easing:Pf,zoom:g?Math.round(G)+g*(c.shiftKey?2:1):G,bearing:z.getBearing()+C*this._bearingStep,pitch:z.getPitch()+S*this._pitchStep,offset:[-D*this._panStep,-L*this._panStep],center:z.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Pf(v){return v*(2-v)}const Yc=4.000244140625;class Os{constructor(c,g){this._map=c,this._el=c.getCanvasContainer(),this._handler=g,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,_.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(c.ctrlKey||c.metaKey||this.isZooming()||_.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let g=c.deltaMode===_.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const C=_.exported.now(),S=C-(this._lastWheelEventTime||0);this._lastWheelEventTime=C,0!==g&&g%Yc==0?this._type="wheel":0!==g&&Math.abs(g)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=g,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(S*g)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,g+=this._lastValue)),c.shiftKey&&g&&(g/=4),this._type&&(this._lastWheelEvent=c,this._delta-=g,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const g=Ye(this._el,c);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:g,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;"wheel"===this._type&&c.projection.wrap&&(c._center.lng>=180||c._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const g=()=>c._terrainEnabled()&&this._aroundCoord?c.computeZoomRelativeTo(this._aroundCoord):c.zoom;if(0!==this._delta){const G="wheel"===this._type&&Math.abs(this._delta)>Yc?this._wheelZoomRate:this._defaultZoomRate;let J=2/(1+Math.exp(-Math.abs(this._delta*G)));this._delta<0&&0!==J&&(J=1/J);const ee=g(),re=Math.pow(2,ee),fe="number"==typeof this._targetZoom?c.zoomScale(this._targetZoom):re;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(fe*J))),"wheel"===this._type&&(this._startZoom=ee,this._easing=this._smoothOutEasing(200)),this._delta=0}const C="number"==typeof this._targetZoom?this._targetZoom:g(),S=this._startZoom,D=this._easing;let L,z=!1;if("wheel"===this._type&&S&&D){const G=Math.min((_.exported.now()-this._lastWheelEventTime)/200,1),J=D(G);L=_.number(S,C,J),G<1?this._frameId||(this._frameId=!0):z=!0}else L=C,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!z,zoomDelta:L-g(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let g=_.ease;if(this._prevEase){const C=this._prevEase,S=(_.exported.now()-C.start)/C.duration,D=C.easing(S+.01)-C.easing(S),L=.27/Math.sqrt(D*D+1e-4)*.01,z=Math.sqrt(.0729-L*L);g=_.bezier(L,z,.25,1)}return this._prevEase={start:_.exported.now(),duration:c,easing:g},g}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=It("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(_.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class ku{constructor(c,g){this._clickZoom=c,this._tapZoom=g}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Pa{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(c,g){return c.preventDefault(),{cameraAnimation:C=>{C.easeTo({duration:300,zoom:C.getZoom()+(c.shiftKey?-1:1),around:C.unproject(g)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ja{constructor(){this._tap=new Aa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(c,g,C){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?C.length>0&&(this._swipePoint=g[0],this._swipeTouch=C[0].identifier):this._tap.touchstart(c,g,C))}touchmove(c,g,C){if(this._tapTime){if(this._swipePoint){if(C[0].identifier!==this._swipeTouch)return;const S=g[0],D=S.y-this._swipePoint.y;return this._swipePoint=S,c.preventDefault(),this._active=!0,{zoomDelta:D/128}}}else this._tap.touchmove(c,g,C)}touchend(c,g,C){this._tapTime?this._swipePoint&&0===C.length&&this.reset():this._tap.touchend(c,g,C)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ru{constructor(c,g,C){this._el=c,this._mousePan=g,this._touchPan=C}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class gn{constructor(c,g,C){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=g,this._mousePitch=C}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class jp{constructor(c,g,C,S){this._el=c,this._touchZoom=g,this._touchRotate=C,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ha=v=>v.zoom||v.drag||v.pitch||v.rotate;class xr extends _.Event{}class Fu{constructor(){this.constants=[1,1,.01],this.radius=0}setup(c,g){const C=_.sub([],g,c);this.radius=_.length(C[2]<0?_.div([],C,this.constants):[C[0],C[1],0])}projectRay(c){_.div(c,c,this.constants),_.normalize(c,c),_.mul$1(c,c,this.constants);const g=_.scale$2([],c,this.radius);if(g[2]>0){const C=_.scale$2([],[0,0,1],_.dot(g,[0,0,1])),S=_.scale$2([],_.normalize([],[g[0],g[1],0]),this.radius),D=_.add([],g,_.scale$2([],_.sub([],_.add([],S,C),g),2));g[0]=D[0],g[1]=D[1]}return g}}function Lu(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class vh{constructor(c,g){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new qc(c),this._bearingSnap=g.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Fu,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(g),_.bindAll(["handleEvent","handleWindowEvent"],this);const C=this._el;this._listeners=[[C,"touchstart",{passive:!0}],[C,"touchmove",{passive:!1}],[C,"touchend",void 0],[C,"touchcancel",void 0],[C,"mousedown",void 0],[C,"mousemove",void 0],[C,"mouseup",void 0],[_.window.document,"mousemove",{capture:!0}],[_.window.document,"mouseup",void 0],[C,"mouseover",void 0],[C,"mouseout",void 0],[C,"dblclick",void 0],[C,"click",void 0],[C,"keydown",{capture:!1}],[C,"keyup",void 0],[C,"wheel",{passive:!1}],[C,"contextmenu",void 0],[_.window,"blur",void 0]];for(const[S,D,L]of this._listeners)S.addEventListener(D,S===_.window.document?this.handleWindowEvent:this.handleEvent,L)}destroy(){for(const[c,g,C]of this._listeners)c.removeEventListener(g,c===_.window.document?this.handleWindowEvent:this.handleEvent,C)}_addDefaultHandlers(c){const g=this._map,C=g.getCanvasContainer();this._add("mapEvent",new Ps(g,c));const S=g.boxZoom=new Dl(g,c);this._add("boxZoom",S);const D=new Pu,L=new Pa;g.doubleClickZoom=new ku(L,D),this._add("tapZoom",D),this._add("clickZoom",L);const z=new Ja;this._add("tapDragZoom",z);const G=g.touchPitch=new Io(g);this._add("touchPitch",G);const J=new gh(c),ee=new _h(c);g.dragRotate=new gn(c,J,ee),this._add("mouseRotate",J,["mousePitch"]),this._add("mousePitch",ee,["mouseRotate"]);const re=new mh(c),fe=new rc(g,c);g.dragPan=new Ru(C,re,fe),this._add("mousePan",re),this._add("touchPan",fe,["touchZoom","touchRotate"]);const _e=new Wc,de=new Mf;g.touchZoomRotate=new jp(C,de,_e,z),this._add("touchRotate",_e,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Cd(g));const ve=g.scrollZoom=new Os(g,this);this._add("scrollZoom",ve,["mousePan"]);const xe=g.keyboard=new Af;this._add("keyboard",xe);for(const ue of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[ue]&&g[ue].enable(c[ue])}_add(c,g,C){this._handlers.push({handlerName:c,handler:g,allowed:C}),this._handlersById[c]=g}stop(c){if(!this._updatingCamera){for(const{handler:g}of this._handlers)g.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ha(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(c,g,C){for(const S in c)if(S!==C&&(!g||g.indexOf(S)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const g=[];for(const C of c)this._el.contains(C.target)&&g.push(C);return g}handleEvent(c,g){this._updatingCamera=!0;const C="renderFrame"===c.type,S=C?void 0:c,D={needsRenderFrame:!1},L={},z={},G=c.touches?this._getMapTouches(c.touches):void 0,J=G?kt(this._el,G):C?void 0:Ye(this._el,c);for(const{handlerName:fe,handler:_e,allowed:de}of this._handlers){if(!_e.isEnabled())continue;let ve;this._blockedByActive(z,de,fe)?_e.reset():_e[g||c.type]&&(ve=_e[g||c.type](c,J,G),this.mergeHandlerResult(D,L,ve,fe,S),ve&&ve.needsRenderFrame&&this._triggerRenderFrame()),(ve||_e.isActive())&&(z[fe]=_e)}const ee={};for(const fe in this._previousActiveHandlers)z[fe]||(ee[fe]=S);this._previousActiveHandlers=z,(Object.keys(ee).length||Lu(D))&&(this._changes.push([D,L,ee]),this._triggerRenderFrame()),(Object.keys(z).length||Lu(D))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:re}=D;re&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],re(this._map))}mergeHandlerResult(c,g,C,S,D){if(!C)return;_.extend(c,C);const L={handlerName:S,originalEvent:C.originalEvent||D};void 0!==C.zoomDelta&&(g.zoom=L),void 0!==C.panDelta&&(g.drag=L),void 0!==C.pitchDelta&&(g.pitch=L),void 0!==C.bearingDelta&&(g.rotate=L)}_applyChanges(){const c={},g={},C={};for(const[S,D,L]of this._changes)S.panDelta&&(c.panDelta=(c.panDelta||new _.pointGeometry(0,0))._add(S.panDelta)),S.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+S.pitchDelta),void 0!==S.around&&(c.around=S.around),void 0!==S.aroundCoord&&(c.aroundCoord=S.aroundCoord),void 0!==S.pinchAround&&(c.pinchAround=S.pinchAround),S.noInertia&&(c.noInertia=S.noInertia),_.extend(g,D),_.extend(C,L);this._updateMapTransform(c,g,C),this._changes=[]}_updateMapTransform(c,g,C){const S=this._map,D=S.transform,L=Ce=>[Ce.x,Ce.y,Ce.z];if((Ce=>{const be=this._eventsInProgress.drag;return be&&!this._handlersById[be.handlerName].isActive()})()&&!Lu(c)){const Ce=D.zoom;D.cameraElevationReference="sea",D.recenterOnTerrain(),D.cameraElevationReference="ground",Ce!==D.zoom&&this._map._update(!0)}if(D._isCameraConstrained&&S._stop(!0),!Lu(c))return void this._fireEvents(g,C,!0);let{panDelta:z,zoomDelta:G,bearingDelta:J,pitchDelta:ee,around:re,aroundCoord:fe,pinchAround:_e}=c;D._isCameraConstrained&&(G>0&&(G=0),D._isCameraConstrained=!1),void 0!==_e&&(re=_e),(G||(Ce=>g.drag&&!this._eventsInProgress.drag)())&&re&&(this._dragOrigin=L(D.pointCoordinate3D(re)),this._trackingEllipsoid.setup(D._camera.position,this._dragOrigin)),D.cameraElevationReference="sea",S._stop(!0),re=re||S.transform.centerPoint,J&&(D.bearing+=J),ee&&(D.pitch+=ee),D._updateCameraState();const de=[0,0,0];if(z)if("mercator"===D.projection.name){const Ce=this._trackingEllipsoid.projectRay(D.screenPointToMercatorRay(re).dir),be=this._trackingEllipsoid.projectRay(D.screenPointToMercatorRay(re.sub(z)).dir);de[0]=be[0]-Ce[0],de[1]=be[1]-Ce[1]}else{const Ce=D.pointCoordinate(re);if("globe"===D.projection.name){z=z.rotate(-D.angle);const be=D._pixelsPerMercatorPixel/D.worldSize;de[0]=-z.x*_.mercatorScale(_.latFromMercatorY(Ce.y))*be,de[1]=-z.y*_.mercatorScale(D.center.lat)*be}else{const be=D.pointCoordinate(re.sub(z));Ce&&be&&(de[0]=be.x-Ce.x,de[1]=be.y-Ce.y)}}const ve=D.zoom,xe=[0,0,0];if(G){const Ce=L(fe||D.pointCoordinate3D(re)),be={dir:_.normalize([],_.sub([],Ce,D._camera.position))};if(be.dir[2]<0){const Me=D.zoomDeltaToMovement(Ce,G);_.scale$2(xe,be.dir,Me)}}const ue=_.add(de,de,xe);D._translateCameraConstrained(ue),G&&Math.abs(D.zoom-ve)>1e-4&&D.recenterOnTerrain(),D.cameraElevationReference="ground",this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(g,C,!0)}_fireEvents(c,g,C){const S=ha(this._eventsInProgress),D=ha(c),L={};for(const ee in c){const{originalEvent:re}=c[ee];this._eventsInProgress[ee]||(L[`${ee}start`]=re),this._eventsInProgress[ee]=c[ee]}!S&&D&&this._fireEvent("movestart",D.originalEvent);for(const ee in L)this._fireEvent(ee,L[ee]);D&&this._fireEvent("move",D.originalEvent);for(const ee in c){const{originalEvent:re}=c[ee];this._fireEvent(ee,re)}const z={};let G;for(const ee in this._eventsInProgress){const{handlerName:re,originalEvent:fe}=this._eventsInProgress[ee];this._handlersById[re].isActive()||(delete this._eventsInProgress[ee],G=g[re]||fe,z[`${ee}end`]=G)}for(const ee in z)this._fireEvent(ee,z[ee]);const J=ha(this._eventsInProgress);if(C&&(S||D)&&!J){this._updatingCamera=!0;const ee=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),re=fe=>0!==fe&&-this._bearingSnap<fe&&fe<this._bearingSnap;ee?(re(ee.bearing||this._map.getBearing())&&(ee.bearing=0),this._map.easeTo(ee,{originalEvent:G})):(this._map.fire(new _.Event("moveend",{originalEvent:G})),re(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,g){this._map.fire(new _.Event(c,g?{originalEvent:g}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{this._frameId=void 0,this.handleEvent(new xr("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const ig="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class $p extends _.Evented{constructor(c,g){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=g.bearingSnap,_.bindAll(["_renderFrameCallback"],this)}getCenter(){return new _.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,g){return this.jumpTo({center:c},g)}panBy(c,g,C){return c=_.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,_.extend({offset:c},g),C)}panTo(c,g,C){return this.easeTo(_.extend({center:c},g),C)}getZoom(){return this.transform.zoom}setZoom(c,g){return this.jumpTo({zoom:c},g),this}zoomTo(c,g,C){return this.easeTo(_.extend({zoom:c},g),C)}zoomIn(c,g){return this.zoomTo(this.getZoom()+1,c,g),this}zoomOut(c,g){return this.zoomTo(this.getZoom()-1,c,g),this}getBearing(){return this.transform.bearing}setBearing(c,g){return this.jumpTo({bearing:c},g),this}getPadding(){return this.transform.padding}setPadding(c,g){return this.jumpTo({padding:c},g),this}rotateTo(c,g,C){return this.easeTo(_.extend({bearing:c},g),C)}resetNorth(c,g){return this.rotateTo(0,_.extend({duration:1e3},c),g),this}resetNorthPitch(c,g){return this.easeTo(_.extend({bearing:0,pitch:0,duration:1e3},c),g),this}snapToNorth(c,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,g):this}getPitch(){return this.transform.pitch}setPitch(c,g){return this.jumpTo({pitch:c},g),this}cameraForBounds(c,g){c=_.LngLatBounds.convert(c);const C=g&&g.bearing||0,S=g&&g.pitch||0,D=c.getNorthWest(),L=c.getSouthEast();return this._cameraForBounds(this.transform,D,L,C,S,g)}_extendCameraOptions(c){const g={top:0,bottom:0,right:0,left:0};if("number"==typeof(c=_.extend({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding){const C=c.padding;c.padding={top:C,bottom:C,right:C,left:C}}return c.padding=_.extend(g,c.padding),c}_minimumAABBFrustumDistance(c,g){const C=g.max[0]-g.min[0],S=g.max[1]-g.min[1];return C/S>c.aspect?C/(2*Math.tan(.5*c.fovX)*c.aspect):S/(2*Math.tan(.5*c.fovY)*c.aspect)}_cameraForBoundsOnGlobe(c,g,C,S,D,L){const z=c.clone(),G=this._extendCameraOptions(L);z.bearing=S,z.pitch=D;const J=_.LngLat.convert(g),ee=_.LngLat.convert(C),re=.5*(J.lat+ee.lat),fe=.5*(J.lng+ee.lng),_e=_.latLngToECEF(re,fe),de=_.normalize([],_e),ve=_.normalize([],_.cross([],de,[0,1,0])),xe=_.cross([],ve,de),ue=[ve[0],ve[1],ve[2],0,xe[0],xe[1],xe[2],0,de[0],de[1],de[2],0,0,0,0,1],Ce=[_e,_.latLngToECEF(J.lat,J.lng),_.latLngToECEF(ee.lat,J.lng),_.latLngToECEF(ee.lat,ee.lng),_.latLngToECEF(J.lat,ee.lng),_.latLngToECEF(re,J.lng),_.latLngToECEF(re,ee.lng),_.latLngToECEF(J.lat,fe),_.latLngToECEF(ee.lat,fe)];let be=_.Aabb.fromPoints(Ce.map(Mt=>[_.dot(ve,Mt),_.dot(xe,Mt),_.dot(de,Mt)]));const Me=_.transformMat4([],be.center,ue);0===_.squaredLength(Me)&&_.set(Me,0,0,1),_.normalize(Me,Me),_.scale$2(Me,Me,_.GLOBE_RADIUS),z.center=_.ecefToLatLng(Me);const Le=z.getWorldToCameraMatrix(),Fe=_.invert(new Float64Array(16),Le);be=_.Aabb.applyTransform(be,_.multiply([],Le,ue)),_.transformMat4(Me,Me,Le);const Ue=.5*(be.max[2]-be.min[2]),We=this._minimumAABBFrustumDistance(z,be),it=_.scale$2([],[0,0,1],Ue),st=_.add(it,Me,it),Ut=We+(0===z.pitch?0:_.distance(Me,st)),Qe=z.globeCenterInViewSpace,St=_.sub([],Me,[Qe[0],Qe[1],Qe[2]]);_.normalize(St,St),_.scale$2(St,St,Ut);const at=_.add([],Me,St);_.transformMat4(at,at,Fe);const Ot=_.earthRadius/_.GLOBE_RADIUS,et=_.length(at),qe=_.mercatorZfromAltitude(Math.max(et*Ot-_.earthRadius,Number.EPSILON),0),Xe=Math.min(z.zoomFromMercatorZAdjusted(qe),G.maxZoom);return Xe>.5*(_.GLOBE_ZOOM_THRESHOLD_MIN+_.GLOBE_ZOOM_THRESHOLD_MAX)?(z.setProjection({name:"mercator"}),z.zoom=Xe,this._cameraForBounds(z,g,C,S,D,L)):{center:z.center,zoom:Xe,bearing:S,pitch:D}}queryTerrainElevation(c,g){const C=this.transform.elevation;return C?(g=_.extend({},{exaggerated:!0},g),C.getAtPoint(_.MercatorCoordinate.fromLngLat(c),null,g.exaggerated)):null}_cameraForBounds(c,g,C,S,D,L){if("globe"===c.projection.name)return this._cameraForBoundsOnGlobe(c,g,C,S,D,L);const z=c.clone(),G=this._extendCameraOptions(L),J=z.padding;z.bearing=S,z.pitch=D;const ee=_.LngLat.convert(g),re=_.LngLat.convert(C),fe=new _.LngLat(ee.lng,re.lat),_e=new _.LngLat(re.lng,ee.lat),de=z.project(ee),ve=z.project(re),xe=this.queryTerrainElevation(ee),ue=this.queryTerrainElevation(re),Ce=this.queryTerrainElevation(fe),be=this.queryTerrainElevation(_e),Me=[[de.x,de.y,Math.min(xe||0,ue||0,Ce||0,be||0)],[ve.x,ve.y,Math.max(xe||0,ue||0,Ce||0,be||0)]];let Le=_.Aabb.fromPoints(Me);const Fe=z.getWorldToCameraMatrix(),Ue=_.invert(new Float64Array(16),Fe);Le=_.Aabb.applyTransform(Le,Fe);const We=_.sub([],Le.max,Le.min),it=J.left||0,st=J.right||0,Ut=J.bottom||0,Qe=J.top||0,{left:St,right:at,top:Ot,bottom:et}=G.padding,qe=.5*(it+st),Xe=.5*(Qe+Ut),Mt=Math.min(z.scaleZoom(z.scale*Math.min((z.width-(it+st+St+at))/We[0],(z.height-(Ut+Qe+et+Ot))/We[1])),G.maxZoom),Rt=z.scale/z.zoomScale(Mt);Le=new _.Aabb([Le.min[0]-(St+qe)*Rt,Le.min[1]-(et+Xe)*Rt,Le.min[2]],[Le.max[0]+(at+qe)*Rt,Le.max[1]+(Ot+Xe)*Rt,Le.max[2]]);const dn=.5*We[2],Wn=this._minimumAABBFrustumDistance(z,Le),_n=[0,0,1,0];_.transformMat4$1(_n,_n,Fe),_.normalize$2(_n,_n);const Yt=_.scale$2([],_n,Wn+dn),yn=_.add([],Le.center,Yt),xi=("number"==typeof G.offset.x&&"number"==typeof G.offset.y?new _.pointGeometry(G.offset.x,G.offset.y):_.pointGeometry.convert(G.offset)).rotate(-_.degToRad(S));Le.center[0]-=xi.x*Rt,Le.center[1]+=xi.y*Rt,_.transformMat4(Le.center,Le.center,Ue),_.transformMat4(yn,yn,Ue);const Vn=[Le.center[0],Le.center[1],yn[2]*z.pixelsPerMeter];_.scale$2(Vn,Vn,1/z.worldSize);const er=_.lngFromMercatorX(Vn[0]),Ri=_.latFromMercatorY(Vn[1]),or=Math.min(z._zoomFromMercatorZ(Vn[2]),G.maxZoom),vi=new _.LngLat(er,Ri);return z.mercatorFromTransition&&or<.5*(_.GLOBE_ZOOM_THRESHOLD_MIN+_.GLOBE_ZOOM_THRESHOLD_MAX)?(z.setProjection({name:"globe"}),z.zoom=or,this._cameraForBounds(z,g,C,S,D,L)):{center:vi,zoom:or,bearing:S,pitch:D}}fitBounds(c,g,C){const S=this.cameraForBounds(c,g);return this._fitInternal(S,g,C)}fitScreenCoordinates(c,g,C,S,D){const L=_.pointGeometry.convert(c),z=_.pointGeometry.convert(g),G=new _.pointGeometry(Math.min(L.x,z.x),Math.min(L.y,z.y)),J=new _.pointGeometry(Math.max(L.x,z.x),Math.max(L.y,z.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(L,z))return this;const ee=this.transform.pointLocation3D(G),re=this.transform.pointLocation3D(J),fe=this.transform.pointLocation3D(new _.pointGeometry(G.x,J.y)),_e=this.transform.pointLocation3D(new _.pointGeometry(J.x,G.y)),de=[Math.min(ee.lng,re.lng,fe.lng,_e.lng),Math.min(ee.lat,re.lat,fe.lat,_e.lat)],ve=[Math.max(ee.lng,re.lng,fe.lng,_e.lng),Math.max(ee.lat,re.lat,fe.lat,_e.lat)],xe=S&&S.pitch?S.pitch:this.getPitch(),ue=this._cameraForBounds(this.transform,de,ve,C,xe,S);return this._fitInternal(ue,S,D)}_fitInternal(c,g,C){return c?(delete(g=_.extend(c,g)).padding,g.linear?this.easeTo(g,C):this.flyTo(g,C)):this}jumpTo(c,g){this.stop();const C=c.preloadOnly?this.transform.clone():this.transform;let S=!1,D=!1,L=!1;return"zoom"in c&&C.zoom!==+c.zoom&&(S=!0,C.zoom=+c.zoom),void 0!==c.center&&(C.center=_.LngLat.convert(c.center)),"bearing"in c&&C.bearing!==+c.bearing&&(D=!0,C.bearing=+c.bearing),"pitch"in c&&C.pitch!==+c.pitch&&(L=!0,C.pitch=+c.pitch),null==c.padding||C.isPaddingEqual(c.padding)||(C.padding=c.padding),c.preloadOnly?(this._preloadTiles(C),this):(this.fire(new _.Event("movestart",g)).fire(new _.Event("move",g)),S&&this.fire(new _.Event("zoomstart",g)).fire(new _.Event("zoom",g)).fire(new _.Event("zoomend",g)),D&&this.fire(new _.Event("rotatestart",g)).fire(new _.Event("rotate",g)).fire(new _.Event("rotateend",g)),L&&this.fire(new _.Event("pitchstart",g)).fire(new _.Event("pitch",g)).fire(new _.Event("pitchend",g)),this.fire(new _.Event("moveend",g)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||_.warnOnce(ig),this.transform.getFreeCameraOptions()}setFreeCameraOptions(c,g){const C=this.transform;if(!C.projection.supportsFreeCamera)return _.warnOnce(ig),this;this.stop();const S=C.zoom,D=C.pitch,L=C.bearing;C.setFreeCameraOptions(c);const z=S!==C.zoom,G=D!==C.pitch,J=L!==C.bearing;return this.fire(new _.Event("movestart",g)).fire(new _.Event("move",g)),z&&this.fire(new _.Event("zoomstart",g)).fire(new _.Event("zoom",g)).fire(new _.Event("zoomend",g)),J&&this.fire(new _.Event("rotatestart",g)).fire(new _.Event("rotate",g)).fire(new _.Event("rotateend",g)),G&&this.fire(new _.Event("pitchstart",g)).fire(new _.Event("pitch",g)).fire(new _.Event("pitchend",g)),this.fire(new _.Event("moveend",g)),this}easeTo(c,g){this._stop(!1,c.easeId),(!1===(c=_.extend({offset:[0,0],duration:500,easing:_.ease},c)).animate||!c.essential&&_.exported.prefersReducedMotion)&&(c.duration=0);const C=this.transform,S=this.getZoom(),D=this.getBearing(),L=this.getPitch(),z=this.getPadding(),G="zoom"in c?+c.zoom:S,J="bearing"in c?this._normalizeBearing(c.bearing,D):D,ee="pitch"in c?+c.pitch:L,re="padding"in c?c.padding:C.padding,fe=_.pointGeometry.convert(c.offset);let _e,de,ve;if("globe"===C.projection.name){const it=_.MercatorCoordinate.fromLngLat(C.center),st=fe.rotate(-C.angle);it.x+=st.x/C.worldSize,it.y+=st.y/C.worldSize;const Ut=it.toLngLat(),Qe=_.LngLat.convert(c.center||Ut);this._normalizeCenter(Qe),_e=C.centerPoint.add(st),de=new _.pointGeometry(it.x,it.y).mult(C.worldSize),ve=new _.pointGeometry(_.mercatorXfromLng(Qe.lng),_.mercatorYfromLat(Qe.lat)).mult(C.worldSize).sub(de)}else{_e=C.centerPoint.add(fe);const it=C.pointLocation(_e),st=_.LngLat.convert(c.center||it);this._normalizeCenter(st),de=C.project(it),ve=C.project(st).sub(de)}const xe=C.zoomScale(G-S);let ue,Ce;c.around&&(ue=_.LngLat.convert(c.around),Ce=C.locationPoint(ue));const be=this._zooming||G!==S,Me=this._rotating||D!==J,Le=this._pitching||ee!==L,Fe=!C.isPaddingEqual(re),Ue=it=>st=>{if(be&&(it.zoom=_.number(S,G,st)),Me&&(it.bearing=_.number(D,J,st)),Le&&(it.pitch=_.number(L,ee,st)),Fe&&(it.interpolatePadding(z,re,st),_e=it.centerPoint.add(fe)),ue)it.setLocationAtPoint(ue,Ce);else{const Ut=it.zoomScale(it.zoom-S),Qe=G>S?Math.min(2,xe):Math.max(.5,xe),St=Math.pow(Qe,1-st),at=it.unproject(de.add(ve.mult(st*St)).mult(Ut));it.setLocationAtPoint(it.renderWorldCopies?at.wrap():at,_e)}return c.preloadOnly||this._fireMoveEvents(g),it};if(c.preloadOnly){const it=this._emulate(Ue,c.duration,C);return this._preloadTiles(it),this}const We={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=be,this._rotating=Me,this._pitching=Le,this._padding=Fe,this._easeId=c.easeId,this._prepareEase(g,c.noMoveStart,We),this._ease(Ue(C),it=>{C.recenterOnTerrain(),this._afterEase(g,it)},c),this}_prepareEase(c,g,C={}){this._moving=!0,this.transform.cameraElevationReference="sea",g||C.moving||this.fire(new _.Event("movestart",c)),this._zooming&&!C.zooming&&this.fire(new _.Event("zoomstart",c)),this._rotating&&!C.rotating&&this.fire(new _.Event("rotatestart",c)),this._pitching&&!C.pitching&&this.fire(new _.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new _.Event("move",c)),this._zooming&&this.fire(new _.Event("zoom",c)),this._rotating&&this.fire(new _.Event("rotate",c)),this._pitching&&this.fire(new _.Event("pitch",c))}_afterEase(c,g){if(this._easeId&&g&&this._easeId===g)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const C=this._zooming,S=this._rotating,D=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,C&&this.fire(new _.Event("zoomend",c)),S&&this.fire(new _.Event("rotateend",c)),D&&this.fire(new _.Event("pitchend",c)),this.fire(new _.Event("moveend",c))}flyTo(c,g){if(!c.essential&&_.exported.prefersReducedMotion){const Mt=_.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Mt,g)}this.stop(),c=_.extend({offset:[0,0],speed:1.2,curve:1.42,easing:_.ease},c);const C=this.transform,S=this.getZoom(),D=this.getBearing(),L=this.getPitch(),z=this.getPadding(),G="zoom"in c?_.clamp(+c.zoom,C.minZoom,C.maxZoom):S,J="bearing"in c?this._normalizeBearing(c.bearing,D):D,ee="pitch"in c?+c.pitch:L,re="padding"in c?c.padding:C.padding,fe=C.zoomScale(G-S),_e=_.pointGeometry.convert(c.offset);let de=C.centerPoint.add(_e);const ve=C.pointLocation(de),xe=_.LngLat.convert(c.center||ve);this._normalizeCenter(xe);const ue=C.project(ve),Ce=C.project(xe).sub(ue);let be=c.curve;const Me=Math.max(C.width,C.height),Le=Me/fe,Fe=Ce.mag();if("minZoom"in c){const Mt=_.clamp(Math.min(c.minZoom,S,G),C.minZoom,C.maxZoom),Rt=Me/C.zoomScale(Mt-S);be=Math.sqrt(Rt/Fe*2)}const Ue=be*be;function We(Mt){const Rt=(Le*Le-Me*Me+(Mt?-1:1)*Ue*Ue*Fe*Fe)/(2*(Mt?Le:Me)*Ue*Fe);return Math.log(Math.sqrt(Rt*Rt+1)-Rt)}function it(Mt){return(Math.exp(Mt)-Math.exp(-Mt))/2}function st(Mt){return(Math.exp(Mt)+Math.exp(-Mt))/2}const Ut=We(0);let Qe=function(Mt){return st(Ut)/st(Ut+be*Mt)},St=function(Mt){return Me*((st(Ut)*(it(Rt=Ut+be*Mt)/st(Rt))-it(Ut))/Ue)/Fe;var Rt},at=(We(1)-Ut)/be;if(Math.abs(Fe)<1e-6||!isFinite(at)){if(Math.abs(Me-Le)<1e-6)return this.easeTo(c,g);const Mt=Le<Me?-1:1;at=Math.abs(Math.log(Le/Me))/be,St=function(){return 0},Qe=function(Rt){return Math.exp(Mt*be*Rt)}}c.duration="duration"in c?+c.duration:1e3*at/("screenSpeed"in c?+c.screenSpeed/be:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0);const Ot=D!==J,et=ee!==L,qe=!C.isPaddingEqual(re),Xe=Mt=>Rt=>{const dn=Rt*at,Wn=1/Qe(dn);Mt.zoom=1===Rt?G:S+Mt.scaleZoom(Wn),Ot&&(Mt.bearing=_.number(D,J,Rt)),et&&(Mt.pitch=_.number(L,ee,Rt)),qe&&(Mt.interpolatePadding(z,re,Rt),de=Mt.centerPoint.add(_e));const _n=1===Rt?xe:Mt.unproject(ue.add(Ce.mult(St(dn))).mult(Wn));return Mt.setLocationAtPoint(Mt.renderWorldCopies?_n.wrap():_n,de),Mt._updateCameraOnTerrain(),c.preloadOnly||this._fireMoveEvents(g),Mt};if(c.preloadOnly){const Mt=this._emulate(Xe,c.duration,C);return this._preloadTiles(Mt),this}return this._zooming=!0,this._rotating=Ot,this._pitching=et,this._padding=qe,this._prepareEase(g,!1),this._ease(Xe(C),()=>this._afterEase(g),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const C=this._onEaseEnd;this._onEaseEnd=void 0,C.call(this,g)}if(!c){const C=this.handlers;C&&C.stop(!1)}return this}_ease(c,g,C){!1===C.animate||0===C.duration?(c(1),g()):(this._easeStart=_.exported.now(),this._easeOptions=C,this._onEaseFrame=c,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((_.exported.now()-this._easeStart)/this._easeOptions.duration,1),g=this._onEaseFrame;g&&g(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,g){c=_.wrap(c,-180,180);const C=Math.abs(c-g);return Math.abs(c-360-g)<C&&(c-=360),Math.abs(c+360-g)<C&&(c+=360),c}_normalizeCenter(c){const g=this.transform;if(!g.renderWorldCopies||g.maxBounds)return;const C=c.lng-g.center.lng;c.lng+=C>180?-360:C<-180?360:0}_emulate(c,g,C){const S=Math.ceil(15*g/1e3),D=[],L=c(C.clone());for(let z=0;z<=S;z++){const G=L(z/S);D.push(G.clone())}return D}}class rg{constructor(c={}){this.options=c,_.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){const g=this.options&&this.options.compact;return this._map=c,this._container=It("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=It("button","mapboxgl-ctrl-attrib-button",this._container),It("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=It("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),g&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===g&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(c,g){const C=this._map._getUIString(`AttributionControl.${g}`);c.setAttribute("aria-label",C),c.removeAttribute("title"),c.firstElementChild&&c.firstElementChild.setAttribute("title",C)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));const g=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||_.config.ACCESS_TOKEN}];if(c){const C=g.reduce((S,D,L)=>(D.value&&(S+=`${D.key}=${D.value}${L<g.length-1?"&":""}`),S),"?");c.href=`${_.config.FEEDBACK_URL}/${C}#${Ma(this._map,!0)}`,c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}}_updateData(c){!c||"metadata"!==c.sourceDataType&&"visibility"!==c.sourceDataType&&"style"!==c.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let c=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const g=this._map.style._sourceCaches;for(const S in g){const D=g[S];if(D.used){const L=D.getSource();L.attribution&&c.indexOf(L.attribution)<0&&c.push(L.attribution)}}c.sort((S,D)=>S.length-D.length),c=c.filter((S,D)=>{for(let L=D+1;L<c.length;L++)if(c[L].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=[...this.options.customAttribution,...c]:c.unshift(this.options.customAttribution));const C=c.join(" | ");C!==this._attribHTML&&(this._attribHTML=C,c.length?(this._innerContainer.innerHTML=C,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class bh{constructor(){_.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(c){this._map=c,this._container=It("div","mapboxgl-ctrl");const g=It("a","mapboxgl-ctrl-logo");return g.target="_blank",g.rel="noopener nofollow",g.href="https://www.mapbox.com/",g.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),g.setAttribute("rel","noopener nofollow"),this._container.appendChild(g),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(c){c&&"metadata"!==c.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const c=this._map.style._sourceCaches;if(0===Object.entries(c).length)return!0;for(const g in c){const C=c[g].getSource();if(C.hasOwnProperty("mapbox_logo")&&!C.mapbox_logo)return!1}return!0}_updateCompact(){const c=this._container.children;if(c.length){const g=c[0];this._map.getCanvasContainer().offsetWidth<250?g.classList.add("mapboxgl-compact"):g.classList.remove("mapboxgl-compact")}}}class Oa{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const g=++this._id;return this._queue.push({callback:c,id:g,cancelled:!1}),g}remove(c){const g=this._currentlyRunning,C=g?this._queue.concat(g):this._queue;for(const S of C)if(S.id===c)return void(S.cancelled=!0)}run(c=0){const g=this._currentlyRunning=this._queue;this._queue=[];for(const C of g)if(!C.cancelled&&(C.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function xh(v,c,g){if(v=new _.LngLat(v.lng,v.lat),c){const C=new _.LngLat(v.lng-360,v.lat),S=new _.LngLat(v.lng+360,v.lat),D=360*Math.ceil(Math.abs(v.lng-g.center.lng)/360),L=g.locationPoint(v).distSqr(c),z=c.x<0||c.y<0||c.x>g.width||c.y>g.height;g.locationPoint(C).distSqr(c)<L&&(z||Math.abs(C.lng-g.center.lng)<D)?v=C:g.locationPoint(S).distSqr(c)<L&&(z||Math.abs(S.lng-g.center.lng)<D)&&(v=S)}for(;Math.abs(v.lng-g.center.lng)>180;){const C=g.locationPoint(v);if(C.x>=0&&C.y>=0&&C.x<=g.width&&C.y<=g.height)break;v.lng>g.center.lng?v.lng-=360:v.lng+=360}return v}const wh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class ro extends _.Evented{constructor(c,g){if(super(),(c instanceof _.window.HTMLElement||g)&&(c=_.extend({element:c},g)),_.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=c&&c.occludedOpacity||.2,c&&c.element)this._element=c.element,this._offset=_.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=It("div");const S=41,D=27,L=Ve("svg",{display:"block",height:S*this._scale+"px",width:D*this._scale+"px",viewBox:`0 0 ${D} ${S}`},this._element),z=Ve("radialGradient",{id:"shadowGradient"},Ve("defs",{},L));Ve("stop",{offset:"10%","stop-opacity":.4},z),Ve("stop",{offset:"100%","stop-opacity":.05},z),Ve("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},L),Ve("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},L),Ve("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},L),Ve("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},L),this._offset=_.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const C=this._element.classList;for(const S in wh)C.remove(`mapboxgl-marker-anchor-${S}`);C.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(c){return c===this._map||(this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._updateMoving),c.on("moveend",this._update),c.on("remove",this._clearFadeTimer),c._addMarker(this),this.setDraggable(this._draggable),this._update(),c.on("click",this._onMapClick)),this}remove(){const c=this._map;return c&&(c.off("click",this._onMapClick),c.off("move",this._updateMoving),c.off("moveend",this._update),c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler),c.off("mouseup",this._onUp),c.off("touchend",this._onUp),c.off("mousemove",this._onMove),c.off("touchmove",this._onMove),c.off("remove",this._clearFadeTimer),c._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=_.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(24.6+S)],"bottom-right":[-S,-1*(24.6+S)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=c,c._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(c){const g=c.code,C=c.charCode||c.keyCode;"Space"!==g&&"Enter"!==g&&32!==C&&13!==C||this.togglePopup()}_onMapClick(c){const g=c.originalEvent.target,C=this._element;this._popup&&(g===C||C.contains(g))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?(c.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(c.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const c=this._map,g=this._pos;if(!c||!g)return!1;const C=c.unproject(g),S=c.getFreeCameraOptions();if(!S.position)return!1;const D=S.position.toLngLat();return D.distanceTo(C)<.9*D.distanceTo(this._lngLat)}_evaluateOpacity(){const c=this._map;if(!c)return;const g=this._pos;if(!g||g.x<0||g.x>c.transform.width||g.y<0||g.y>c.transform.height)return void this._clearFadeTimer();const C=c.unproject(g);let S;c._showingGlobe()&&_.isLngLatBehindGlobe(c.transform,this._lngLat)?S=0:(S=1-c._queryFogOpacity(C),c.transform._terrainEnabled()&&c.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const c=this._pos;if(!c||!this._map)return;const g=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${c.x}px,${c.y}px)\n            ${wh[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${g.x}px,${g.y}px)\n        `}_calculateXYTransform(){const c=this._pos,g=this._map,C=this.getPitchAlignment();if(!g||!c||"map"!==C)return"";if(!g._showingGlobe()){const G=g.getPitch();return G?`rotateX(${G}deg)`:""}const S=_.radToDeg(_.globeTiltAtLngLat(g.transform,this._lngLat)),D=c.sub(_.globeCenterToScreenPoint(g.transform)),L=Math.abs(D.x)+Math.abs(D.y);if(0===L)return"";const z=S/L;return`rotateX(${-D.y*z}deg) rotateY(${D.x*z}deg)`}_calculateZTransform(){const c=this._pos,g=this._map;if(!g||!c)return"";let C=0;const S=this.getRotationAlignment();if("map"===S)if(g._showingGlobe()){const D=g.project(new _.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),L=g.project(new _.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(D);C=_.radToDeg(Math.atan2(L.y,L.x))-90}else C=-g.getBearing();else if("horizon"===S){const D=_.smoothstep(4,6,g.getZoom()),L=_.globeCenterToScreenPoint(g.transform);L.y+=D*g.transform.height;const z=c.sub(L),G=_.radToDeg(Math.atan2(z.y,z.x));C=(G>90?G-270:G+90)*(1-D)}return C+=this._rotation,C?`rotateZ(${C}deg)`:""}_update(c){_.window.cancelAnimationFrame(this._updateFrameId);const g=this._map;g&&(g.transform.renderWorldCopies&&(this._lngLat=xh(this._lngLat,this._pos,g.transform)),this._pos=g.project(this._lngLat),!0===c?this._updateFrameId=_.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),g._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(g._showingGlobe()||g.getTerrain()||g.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(c){return this._offset=_.pointGeometry.convert(c),this._update(),this}_onMove(c){const g=this._map;if(!g)return;const C=this._pointerdownPos,S=this._positionDelta;if(C&&S){if(!this._isDragging){const D=this._clickTolerance||g._clickTolerance;if(c.point.dist(C)<D)return;this._isDragging=!0}this._pos=c.point.sub(S),this._lngLat=g.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new _.Event("dragstart"))),this.fire(new _.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const c=this._map;c&&(c.off("mousemove",this._onMove),c.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new _.Event("dragend")),this._state="inactive"}_addDragHandler(c){const g=this._map,C=this._pos;g&&C&&this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(C),this._pointerdownPos=c.point,this._state="pending",g.on("mousemove",this._onMove),g.on("touchmove",this._onMove),g.once("mouseup",this._onUp),g.once("touchend",this._onUp))}setDraggable(c){this._draggable=!!c;const g=this._map;return g&&(c?(g.on("mousedown",this._addDragHandler),g.on("touchstart",this._addDragHandler)):(g.off("mousedown",this._addDragHandler),g.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(c){return this._occludedOpacity=c||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Of={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},fa=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ch(v=new _.pointGeometry(0,0),c="bottom"){if("number"==typeof v){const g=Math.round(Math.sqrt(.5*Math.pow(v,2)));switch(c){case"top":return new _.pointGeometry(0,v);case"top-left":return new _.pointGeometry(g,g);case"top-right":return new _.pointGeometry(-g,g);case"bottom":return new _.pointGeometry(0,-v);case"bottom-left":return new _.pointGeometry(g,-g);case"bottom-right":return new _.pointGeometry(-g,-g);case"left":return new _.pointGeometry(v,0);case"right":return new _.pointGeometry(-v,0)}return new _.pointGeometry(0,0)}return v instanceof _.pointGeometry||Array.isArray(v)?_.pointGeometry.convert(v):_.pointGeometry.convert(v[c]||[0,0])}class pa{constructor(c){this.jumpTo(c)}getValue(c){if(c<=this._startTime)return this._start;if(c>=this._endTime)return this._end;const g=_.easeCubicInOut((c-this._startTime)/(this._endTime-this._startTime));return this._start*(1-g)+this._end*g}isEasing(c){return c>=this._startTime&&c<=this._endTime}jumpTo(c){this._startTime=-1/0,this._endTime=-1/0,this._start=c,this._end=c}easeTo(c,g,C){this._start=this.getValue(g),this._end=c,this._startTime=g,this._endTime=g+C}}const Kc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Gp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Xc={showCompass:!0,showZoom:!0,visualizePitch:!1};class Nu{constructor(c,g,C=!1){this._clickTolerance=10,this.element=g,this.mouseRotate=new gh({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,C&&(this.mousePitch=new _h({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),_.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),g.addEventListener("mousedown",this.mousedown),g.addEventListener("touchstart",this.touchstart,{passive:!1}),g.addEventListener("touchmove",this.touchmove),g.addEventListener("touchend",this.touchend),g.addEventListener("touchcancel",this.reset)}down(c,g){this.mouseRotate.mousedown(c,g),this.mousePitch&&this.mousePitch.mousedown(c,g),nn()}move(c,g){const C=this.map,S=this.mouseRotate.mousemoveWindow(c,g),D=S&&S.bearingDelta;if(D&&C.setBearing(C.getBearing()+D),this.mousePitch){const L=this.mousePitch.mousemoveWindow(c,g),z=L&&L.pitchDelta;z&&C.setPitch(C.getPitch()+z)}}off(){const c=this.element;c.removeEventListener("mousedown",this.mousedown),c.removeEventListener("touchstart",this.touchstart,{passive:!1}),c.removeEventListener("touchmove",this.touchmove),c.removeEventListener("touchend",this.touchend),c.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){bn(),_.window.removeEventListener("mousemove",this.mousemove),_.window.removeEventListener("mouseup",this.mouseup)}mousedown(c){this.down(_.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),Ye(this.element,c)),_.window.addEventListener("mousemove",this.mousemove),_.window.addEventListener("mouseup",this.mouseup)}mousemove(c){this.move(c,Ye(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){1!==c.targetTouches.length?this.reset():(this._startPos=this._lastPos=kt(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){1!==c.targetTouches.length?this.reset():(this._lastPos=kt(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){0===c.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Eh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},og={maxWidth:100,unit:"metric"};function Sd(v,c,g){const C=Hp(c),S=C/c,D={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[g];this._map._requestDomTask(()=>{this._container.style.width=v*S+"px",this._container.innerHTML=`${C}&nbsp;${D}`})}function Hp(v){const c=Math.pow(10,`${Math.floor(v)}`.length-1);let g=v/c;return g=g>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:function(C){const S=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*S)/S}(g),c*g}const Mi={version:_.version,supported:ft,setRTLTextPlugin:_.setRTLTextPlugin,getRTLTextPluginStatus:_.getRTLTextPluginStatus,Map:class extends $p{constructor(v){if(_.LivePerformanceUtils.mark(_.PerformanceMarkers.create),null!=(v=_.extend({},Gp,v)).minZoom&&null!=v.maxZoom&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=v.minPitch&&null!=v.maxPitch&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=v.minPitch&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=v.maxPitch&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(v.antialias&&_.isSafariWithAntialiasingBug(_.window)&&(v.antialias=!1,_.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new fn(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),v),this._interactive=v.interactive,this._minTileCacheSize=v.minTileCacheSize,this._maxTileCacheSize=v.maxTileCacheSize,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._useWebGL2=v.useWebGL2,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=v.crossSourceCollisions,this._collectResourceTiming=v.collectResourceTiming,this._optimizeForTerrain=v.optimizeForTerrain,this._language=this._parseLanguage(v.language),this._worldview=v.worldview,this._renderTaskQueue=new Oa,this._domRenderTaskQueue=new Oa,this._controls=[],this._markers=[],this._popups=[],this._mapId=_.uniqueId(),this._locale=_.extend({},Kc,v.locale),this._clickTolerance=v.clickTolerance,this._cooperativeGestures=v.cooperativeGestures,this._performanceMetricsCollection=v.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new pa(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new _.RequestManager(v.transformRequest,v.accessToken,v.testMode),this._silenceAuthErrors=!!v.testMode,"string"==typeof v.container){if(this._container=_.window.document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof _.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(this._container.childNodes.length>0&&_.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),v.maxBounds&&this.setMaxBounds(v.maxBounds),_.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==_.window&&(_.window.addEventListener("online",this._onWindowOnline,!1),_.window.addEventListener("resize",this._onWindowResize,!1),_.window.addEventListener("orientationchange",this._onWindowResize,!1),_.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),_.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new vh(this,v),this._localFontFamily=v.localFontFamily,this._localIdeographFontFamily=v.localIdeographFontFamily,v.style&&this.setStyle(v.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),v.projection&&this.setProjection(v.projection),this._hash=v.hash&&new bd("string"==typeof v.hash&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,_.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),v.attributionControl&&this.addControl(new rg({customAttribution:v.customAttribution})),this._logoControl=new bh,this.addControl(this._logoControl,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update("style"===c.dataType),this.fire(new _.Event(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new _.Event(`${c.dataType}dataloading`,c))})}_getMapId(){return this._mapId}addControl(v,c){if(void 0===c&&(c=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new _.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const g=v.onAdd(this);this._controls.push(v);const C=this._controlPositions[c];return-1!==c.indexOf("bottom")?C.insertBefore(g,C.firstChild):C.appendChild(g),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new _.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(v);return c>-1&&this._controls.splice(c,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(v){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const c=!this._moving;return c&&this.fire(new _.Event("movestart",v)).fire(new _.Event("move",v)),this.fire(new _.Event("resize",v)),c&&this.fire(new _.Event("moveend",v)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(v){return this.transform.setMaxBounds(_.LngLatBounds.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v?this.setZoom(v):this.fire(new _.Event("zoomstart")).fire(new _.Event("zoom")).fire(new _.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v?this.setZoom(v):this.fire(new _.Event("zoomstart")).fire(new _.Event("zoom")).fire(new _.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v?this.setPitch(v):this.fire(new _.Event("pitchstart")).fire(new _.Event("pitch")).fire(new _.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v?this.setPitch(v):this.fire(new _.Event("pitchstart")).fire(new _.Event("pitch")).fire(new _.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(v){return"auto"===v?_.window.navigator.language:Array.isArray(v)?0===v.length?void 0:v.map(c=>"auto"===c?_.window.navigator.language:c):v}setLanguage(v){const c=this._parseLanguage(v);if(!this.style||c===this._language)return this;this._language=c,this.style._reloadSources();for(const g of this._controls)g._setLanguage&&g._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(v){return this.style&&v!==this._worldview?(this._worldview=v,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(v){return this._lazyInitEmptyStyle(),v?"string"==typeof v&&(v={name:v}):v=null,this._useExplicitProjection=!!v,this._prioritizeAndUpdateProjection(v,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const v=this.transform,c=v.projection.name;let g;"globe"===c&&v.zoom>=_.GLOBE_ZOOM_THRESHOLD_MAX?(v.setMercatorFromTransition(),g=!0):"mercator"===c&&v.zoom<_.GLOBE_ZOOM_THRESHOLD_MAX&&(v.setProjection({name:"globe"}),g=!0),g&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(v,c){return this._updateProjection(v||c||{name:"mercator"})}_updateProjection(v){let c;if(c="globe"===v.name&&this.transform.zoom>=_.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(v),this.style.applyProjectionUpdate(),c){this.painter.clearBackgroundTiles();for(const g in this.style._sourceCaches)this.style._sourceCaches[g].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(v){return this.transform.locationPoint3D(_.LngLat.convert(v))}unproject(v){return this.transform.pointLocation3D(_.pointGeometry.convert(v))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(v,c,g){if("mouseenter"===v||"mouseover"===v){let C=!1;const S=L=>{const z=c.filter(J=>this.getLayer(J)),G=z.length?this.queryRenderedFeatures(L.point,{layers:z}):[];G.length?C||(C=!0,g.call(this,new Zr(v,this,L.originalEvent,{features:G}))):C=!1},D=()=>{C=!1};return{layers:new Set(c),listener:g,delegates:{mousemove:S,mouseout:D}}}if("mouseleave"===v||"mouseout"===v){let C=!1;const S=L=>{const z=c.filter(G=>this.getLayer(G));(z.length?this.queryRenderedFeatures(L.point,{layers:z}):[]).length?C=!0:C&&(C=!1,g.call(this,new Zr(v,this,L.originalEvent)))},D=L=>{C&&(C=!1,g.call(this,new Zr(v,this,L.originalEvent)))};return{layers:new Set(c),listener:g,delegates:{mousemove:S,mouseout:D}}}{const C=S=>{const D=c.filter(z=>this.getLayer(z)),L=D.length?this.queryRenderedFeatures(S.point,{layers:D}):[];L.length&&(S.features=L,g.call(this,S),delete S.features)};return{layers:new Set(c),listener:g,delegates:{[v]:C}}}}on(v,c,g){if(void 0===g)return super.on(v,c);Array.isArray(c)||(c=[c]);const C=this._createDelegatedListener(v,c,g);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(C);for(const S in C.delegates)this.on(S,C.delegates[S]);return this}once(v,c,g){if(void 0===g)return super.once(v,c);Array.isArray(c)||(c=[c]);const C=this._createDelegatedListener(v,c,g);for(const S in C.delegates)this.once(S,C.delegates[S]);return this}off(v,c,g){if(void 0===g)return super.off(v,c);c=new Set(Array.isArray(c)?c:[c]);const C=(D,L)=>{if(D.size!==L.size)return!1;for(const z of D)if(!L.has(z))return!1;return!0},S=this._delegatedListeners?this._delegatedListeners[v]:void 0;return S&&(D=>{for(let L=0;L<D.length;L++){const z=D[L];if(z.listener===g&&C(z.layers,c)){for(const G in z.delegates)this.off(G,z.delegates[G]);return D.splice(L,1),this}}})(S),this}queryRenderedFeatures(v,c){return this.style?(void 0!==c||void 0===v||v instanceof _.pointGeometry||Array.isArray(v)||(c=v,v=void 0),this.style.queryRenderedFeatures(v=v||[[0,0],[this.transform.width,this.transform.height]],c=c||{},this.transform)):[]}querySourceFeatures(v,c){return this.style.querySourceFeatures(v,c)}setStyle(v,c){return!1!==(c=_.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},c)).diff&&c.localIdeographFontFamily===this._localIdeographFontFamily&&c.localFontFamily===this._localFontFamily&&this.style&&v?(this._diffStyle(v,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._localFontFamily=c.localFontFamily,this._updateStyle(v,c))}_getUIString(v){const c=this._locale[v];if(null==c)throw new Error(`Missing UI string '${v}'`);return c}_updateStyle(v,c){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),v&&(this.style=new no(this,c||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof v?this.style.loadURL(v):this.style.loadJSON(v)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new no(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,c){if("string"==typeof v){const g=this._requestManager.normalizeStyleURL(v),C=this._requestManager.transformRequest(g,_.ResourceType.Style);_.getJSON(C,(S,D)=>{S?this.fire(new _.ErrorEvent(S)):D&&this._updateDiff(D,c)})}else"object"==typeof v&&this._updateDiff(v,c)}_updateDiff(v,c){try{this.style.setState(v)&&this._update(!0)}catch(g){_.warnOnce(`Unable to perform style diff: ${g.message||g.error||g}.  Rebuilding the style from scratch.`),this._updateStyle(v,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(_.warnOnce("There is no style added to the map."),!1)}addSource(v,c){return this._lazyInitEmptyStyle(),this.style.addSource(v,c),this._update(!0)}isSourceLoaded(v){return!!this.style&&this.style._isSourceCacheLoaded(v)}areTilesLoaded(){const v=this.style&&this.style._sourceCaches;for(const c in v){const g=v[c]._tiles;for(const C in g){const S=g[C];if("loaded"!==S.state&&"errored"!==S.state)return!1}}return!0}addSourceType(v,c,g){this._lazyInitEmptyStyle(),this.style.addSourceType(v,c,g)}removeSource(v){return this.style.removeSource(v),this._updateTerrain(),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,c,{pixelRatio:g=1,sdf:C=!1,stretchX:S,stretchY:D,content:L}={}){if(this._lazyInitEmptyStyle(),c instanceof _.window.HTMLImageElement||_.window.ImageBitmap&&c instanceof _.window.ImageBitmap){const{width:z,height:G,data:J}=_.exported.getImageData(c);this.style.addImage(v,{data:new _.RGBAImage({width:z,height:G},J),pixelRatio:g,stretchX:S,stretchY:D,content:L,sdf:C,version:0})}else if(void 0===c.width||void 0===c.height)this.fire(new _.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:z,height:G}=c,J=c;this.style.addImage(v,{data:new _.RGBAImage({width:z,height:G},new Uint8Array(J.data)),pixelRatio:g,stretchX:S,stretchY:D,content:L,sdf:C,version:0,userImage:J}),J.onAdd&&J.onAdd(this,v)}}updateImage(v,c){const g=this.style.getImage(v);if(!g)return void this.fire(new _.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const C=c instanceof _.window.HTMLImageElement||_.window.ImageBitmap&&c instanceof _.window.ImageBitmap?_.exported.getImageData(c):c,{width:S,height:D}=C;void 0!==S&&void 0!==D?S===g.data.width&&D===g.data.height?(g.data.replace(C.data,!(c instanceof _.window.HTMLImageElement||_.window.ImageBitmap&&c instanceof _.window.ImageBitmap)),this.style.updateImage(v,g)):this.fire(new _.ErrorEvent(new Error(`The width and height of the updated image (${S}, ${D})\n                must be that same as the previous version of the image\n                (${g.data.width}, ${g.data.height})`))):this.fire(new _.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new _.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,c){_.getImage(this._requestManager.transformRequest(v,_.ResourceType.Image),(g,C)=>{c(g,C instanceof _.window.HTMLImageElement?_.exported.getImageData(C):C)})}listImages(){return this.style.listImages()}addLayer(v,c){return this._lazyInitEmptyStyle(),this.style.addLayer(v,c),this._update(!0)}moveLayer(v,c){return this.style.moveLayer(v,c),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,c,g){return this.style.setLayerZoomRange(v,c,g),this._update(!0)}setFilter(v,c,g={}){return this.style.setFilter(v,c,g),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,c,g,C={}){return this.style.setPaintProperty(v,c,g,C),this._update(!0)}getPaintProperty(v,c){return this.style.getPaintProperty(v,c)}setLayoutProperty(v,c,g,C={}){return this.style.setLayoutProperty(v,c,g,C),this._update(!0)}getLayoutProperty(v,c){return this.style.getLayoutProperty(v,c)}setLight(v,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,c),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(v){return this._lazyInitEmptyStyle(),!v&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(v),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(v){return this._lazyInitEmptyStyle(),this.style.setFog(v),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(v){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(_.LngLat.convert(v),this.transform):0}setFeatureState(v,c){return this.style.setFeatureState(v,c),this._update()}removeFeatureState(v,c){return this.style.removeFeatureState(v,c),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}_updateContainerDimensions(){if(!this._container)return;const v=this._container.getBoundingClientRect().width||400,c=this._container.getBoundingClientRect().height||300;let g,C,S,D=this._container;for(;D&&(!C||!S);){const L=_.window.getComputedStyle(D).transform;L&&"none"!==L&&(g=L.match(/matrix.*\((.+)\)/)[1].split(", "),g[0]&&"0"!==g[0]&&"1"!==g[0]&&(C=g[0]),g[3]&&"0"!==g[3]&&"1"!==g[3]&&(S=g[3])),D=D.parentElement}this._containerWidth=C?Math.abs(v/C):v,this._containerHeight=S?Math.abs(c/S):c}_detectMissingCSS(){"rgb(250, 128, 114)"!==_.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&_.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const v=this._container;v.classList.add("mapboxgl-map"),(this._missingCSSCanary=It("div","mapboxgl-canary",v)).style.visibility="hidden",this._detectMissingCSS();const c=this._canvasContainer=It("div","mapboxgl-canvas-container",v);this._interactive&&c.classList.add("mapboxgl-interactive"),this._canvas=It("canvas","mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const g=this._controlContainer=It("div","mapboxgl-control-container",v),C=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{C[S]=It("div",`mapboxgl-ctrl-${S}`,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,c){const g=_.exported.devicePixelRatio||1;this._canvas.width=g*Math.ceil(v),this._canvas.height=g*Math.ceil(c),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${c}px`}_addMarker(v){this._markers.push(v)}_removeMarker(v){const c=this._markers.indexOf(v);-1!==c&&this._markers.splice(c,1)}_addPopup(v){this._popups.push(v)}_removePopup(v){const c=this._popups.indexOf(v);-1!==c&&this._popups.splice(c,1)}_setupPainter(){const v=_.extend({},ft.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._useWebGL2&&this._canvas.getContext("webgl2",v),g=c||this._canvas.getContext("webgl",v)||this._canvas.getContext("experimental-webgl",v);g?(this._useWebGL2&&!c&&_.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),_.storeAuthState(g,!0),this.painter=new El(g,this.transform,!!c),this.on("data",C=>{"source"===C.dataType&&this.painter.setTileLoadedFlag(!0)}),_.exported$1.testSupport(g)):this.fire(new _.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(v){v.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new _.Event("webglcontextlost",{originalEvent:v}))}_contextRestored(v){this._setupPainter(),this.resize(),this._update(),this.fire(new _.Event("webglcontextrestored",{originalEvent:v}))}_onMapScroll(v){if(v.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_requestDomTask(v){!this.loaded()||this.loaded()&&!this.isMoving()?v():this._domRenderTaskQueue.add(v)}_render(v){let c;const g=this.painter.context.extTimerQuery,C=_.exported.now();if(this.listens("gpu-timing-frame")&&(c=g.createQueryEXT(),g.beginQueryEXT(g.TIME_ELAPSED_EXT,c)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],_.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],_.window.performance.now())),this._renderTaskQueue.run(v),this._domRenderTaskQueue.run(v),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,G=this.transform.pitch,J=_.exported.now(),ee=new _.EvaluationParameters(z,{now:J,fadeDuration:S,pitch:G,transition:this.style.getTransition()});this.style.update(ee)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let D=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),D=this._updateAverageElevation(C),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):D=this._updateAverageElevation(C),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new _.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new _.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),c){const z=_.exported.now()-C;g.endQueryEXT(g.TIME_ELAPSED_EXT,c),setTimeout(()=>{const G=g.getQueryObjectEXT(c,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(c),this.fire(new _.Event("gpu-timing-frame",{cpuTime:z,gpuTime:G})),_.window.performance.mark("frame-gpu",{startTime:C,detail:{gpuTime:G}})},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const G=this.painter.queryGpuTimers(z);this.fire(new _.Event("gpu-timing-layer",{layerTimes:G}))},50)}if(this.listens("gpu-timing-deferred-render")){const z=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const G=this.painter.queryGpuTimeDeferredRender(z);this.fire(new _.Event("gpu-timing-deferred-render",{gpuTime:G}))},50)}const L=this._sourcesDirty||this._styleDirty||this._placementDirty||D;if(L||this._repaint)this.triggerRepaint();else{const z=!this.isMoving()&&this.loaded();if(z&&(D=this._updateAverageElevation(C,!0)),D)this.triggerRepaint();else if(this._triggerFrame(!1),z&&(this.fire(new _.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const G=this._calculateSpeedIndex();this.fire(new _.Event("speedindexcompleted",{speedIndex:G})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||L||(this._fullyLoaded=!0,_.LivePerformanceUtils.mark(_.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&_.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(v){for(const c of this._markers)v&&!this.getRenderWorldCopies()&&(c._lngLat=c._lngLat.wrap()),c._update();for(const c of this._popups)!v||this.getRenderWorldCopies()||c._trackPointer||(c._lngLat=c._lngLat.wrap()),c._update()}_updateAverageElevation(v,c=!1){const g=C=>(this.transform.averageElevation=C,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&g(0);if((c||v-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(v)){const C=this.transform.averageElevation;let S=this.transform.sampleAverageElevation(),D=!1;this.transform.elevation&&(D=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=v;const L=Math.abs(C-S);if(L>1){if(this._isInitialLoad||D)return this._averageElevation.jumpTo(S),g(S);this._averageElevation.easeTo(S,v,300)}else if(L>1e-4)return this._averageElevation.jumpTo(S),g(S)}return!!this._averageElevation.isEasing(v)&&g(this._averageElevation.getValue(v))}_authenticate(){_.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,v=>{if(v&&(v.message===_.AUTH_ERR_MSG||401===v.status)){const c=this.painter.context.gl;_.storeAuthState(c,!1),this._logoControl instanceof bh&&this._logoControl._updateLogo(),c&&c.clear(c.DEPTH_BUFFER_BIT|c.COLOR_BUFFER_BIT|c.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new _.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),_.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const v=this._isDragging();this.painter.updateTerrain(this.style,v)}_calculateSpeedIndex(){const v=this.painter.canvasCopy(),c=this.painter.getCanvasCopiesAndTimestamps();c.timeStamps.push(performance.now());const g=this.painter.context.gl,C=g.createFramebuffer();function S(D){g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,D,0);const L=new Uint8Array(g.drawingBufferWidth*g.drawingBufferHeight*4);return g.readPixels(0,0,g.drawingBufferWidth,g.drawingBufferHeight,g.RGBA,g.UNSIGNED_BYTE,L),L}return g.bindFramebuffer(g.FRAMEBUFFER,C),this._canvasPixelComparison(S(v),c.canvasCopies.map(S),c.timeStamps)}_canvasPixelComparison(v,c,g){let C=g[1]-g[0];const S=v.length/4;for(let D=0;D<c.length;D++){const L=c[D];let z=0;for(let G=0;G<L.length;G+=4)L[G]===v[G]&&L[G+1]===v[G+1]&&L[G+2]===v[G+2]&&L[G+3]===v[G+3]&&(z+=1);C+=(g[D+2]-g[D+1])*(1-z/S)}return C}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==_.window&&(_.window.removeEventListener("resize",this._onWindowResize,!1),_.window.removeEventListener("orientationchange",this._onWindowResize,!1),_.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),_.window.removeEventListener("online",this._onWindowOnline,!1),_.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const v=this.painter.context.gl.getExtension("WEBGL_lose_context");v&&v.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),_.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new _.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(v){this._renderNextFrame=this._renderNextFrame||v,this.style&&!this._frame&&(this._frame=_.exported.frame(c=>{const g=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,g&&this._render(c)}))}_preloadTiles(v){const c=this.style?Object.values(this.style._sourceCaches):[];return _.asyncAll(c,(g,C)=>g._preloadTiles(v,C),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(v){this._trackResize&&this.resize({originalEvent:v})._update()}_onVisibilityChange(){"hidden"===_.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(v){this._showTerrainWireframe!==v&&(this._showTerrainWireframe=v,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(v){this._speedIndexTiming!==v&&(this._speedIndexTiming=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(v){this._showTileAABBs!==v&&(this._showTileAABBs=v,v&&this._update())}_setCacheLimits(v,c){_.setCacheLimits(v,c)}get version(){return _.version}},NavigationControl:class{constructor(v){this.options=_.extend({},Xc,v),this._container=It("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(_.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",c=>{this._map&&this._map.zoomIn({},{originalEvent:c})}),It("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",c=>{this._map&&this._map.zoomOut({},{originalEvent:c})}),It("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(_.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",c=>{const g=this._map;g&&(this.options.visualizePitch?g.resetNorthPitch({},{originalEvent:c}):g.resetNorth({},{originalEvent:c}))}),this._compassIcon=It("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const v=this._map;if(!v)return;const c=v.getZoom(),g=c===v.getMaxZoom(),C=c===v.getMinZoom();this._zoomInButton.disabled=g,this._zoomOutButton.disabled=C,this._zoomInButton.setAttribute("aria-disabled",g.toString()),this._zoomOutButton.setAttribute("aria-disabled",C.toString())}_rotateCompassArrow(){const v=this._map;if(!v)return;const c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(v.transform.pitch*(Math.PI/180)),.5)}) rotateX(${v.transform.pitch}deg) rotateZ(${v.transform.angle*(180/Math.PI)}deg)`:`rotate(${v.transform.angle*(180/Math.PI)}deg)`;v._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=c)})}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),v.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&v.on("pitch",this._rotateCompassArrow),v.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Nu(v,this._compass,this.options.visualizePitch)),this._container}onRemove(){const v=this._map;v&&(this._container.remove(),this.options.showZoom&&v.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&v.off("pitch",this._rotateCompassArrow),v.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(v,c){const g=It("button",v,this._container);return g.type="button",g.addEventListener("click",c),g}_setButtonTitle(v,c){if(!this._map)return;const g=this._map._getUIString(`NavigationControl.${c}`);v.setAttribute("aria-label",g),v.firstElementChild&&v.firstElementChild.setAttribute("title",g)}},GeolocateControl:class extends _.Evented{constructor(v){super(),this.options=_.extend({geolocation:_.window.navigator.geolocation},Eh,v),_.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=rr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(v){return this._map=v,this._container=It("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(v){const c=(g=!!this.options.geolocation)=>{this._supportsGeolocation=g,v(g)};void 0!==this._supportsGeolocation?v(this._supportsGeolocation):void 0!==_.window.navigator.permissions?_.window.navigator.permissions.query({name:"geolocation"}).then(g=>c("denied"!==g.state)).catch(()=>c()):c()}_isOutOfMapMaxBounds(v){const c=this._map.getMaxBounds(),g=v.coords;return!!c&&(g.longitude<c.getWest()||g.longitude>c.getEast()||g.latitude<c.getSouth()||g.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(v){if(this._map){if(this._isOutOfMapMaxBounds(v))return this._setErrorState(),this.fire(new _.Event("outofmaxbounds",v)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=v,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(v),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(v),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new _.Event("geolocate",v)),this._finish()}}_updateCamera(v){const c=new _.LngLat(v.coords.longitude,v.coords.latitude),g=v.coords.accuracy,C=this._map.getBearing(),S=_.extend({bearing:C},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(g),S,{geolocateSource:!0})}_updateMarker(v){if(v){const c=new _.LngLat(v.coords.longitude,v.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=v.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const v=this._map.transform,c=_.mercatorZfromAltitude(1,v._center.lat)*v.worldSize,g=Math.ceil(2*this._accuracy*c);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(v){if(this._map){if(this.options.trackUserLocation)if(1===v.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===v.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new _.Event("error",v)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(v){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=It("button","mapboxgl-ctrl-geolocate",this._container),It("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===v){_.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=It("div","mapboxgl-user-location"),this._dotElement.appendChild(It("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(It("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ro({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=It("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ro({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||"ACTIVE_LOCK"!==this._watchState||c.originalEvent&&"resize"===c.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new _.Event("trackuserlocationend")))})}}_onDeviceOrientation(v){this._userLocationDotMarker&&(v.webkitCompassHeading?this._heading=v.webkitCompassHeading:!0===v.absolute&&(this._heading=-1*v.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return _.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new _.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new _.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new _.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let v;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(v={maximumAge:6e5,timeout:0},this._noTimeout=!0):(v=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,v),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const v=()=>{_.window.addEventListener("ondeviceorientationabsolute"in _.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==_.window.DeviceMotionEvent&&"function"==typeof _.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(c=>{"granted"===c&&v()}).catch(console.error):v()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),_.window.removeEventListener("deviceorientation",this._onDeviceOrientation),_.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:rg,ScaleControl:class{constructor(v){this.options=_.extend({},og,v),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Sd.bind(this)),_.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const v=this.options.maxWidth||100,c=this._map,g=c._containerHeight/2,C=c._containerWidth/2-v/2,S=c.unproject([C,g]),D=c.unproject([C+v,g]),L=S.distanceTo(D);if("imperial"===this.options.unit){const z=3.2808*L;z>5280?this._setScale(v,z/5280,"mile"):this._setScale(v,z,"foot")}else"nautical"===this.options.unit?this._setScale(v,L/1852,"nautical-mile"):L>=1e3?this._setScale(v,L/1e3,"kilometer"):this._setScale(v,L,"meter")}_setScale(v,c,g){const C=Hp(c),S=C/c;this._map._requestDomTask(()=>{this._container.style.width=v*S+"px",this._container.innerHTML="nautical-mile"!==g?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:g}).format(C):`${C}&nbsp;nm`})}onAdd(v){return this._map=v,this._language=v.getLanguage(),this._container=It("div","mapboxgl-ctrl mapboxgl-ctrl-scale",v.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(v){this._language=v,this._update()}setUnit(v){this.options.unit=v,this._update()}},FullscreenControl:class{constructor(v){this._fullscreen=!1,v&&v.container&&(v.container instanceof _.window.HTMLElement?this._container=v.container:_.warnOnce("Full screen control 'container' must be a DOM element.")),_.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in _.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in _.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=It("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",_.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,_.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!_.window.document.fullscreenEnabled&&!_.window.document.webkitFullscreenEnabled)}_setupUI(){const v=this._fullscreenButton=It("button","mapboxgl-ctrl-fullscreen",this._controlContainer);It("span","mapboxgl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),_.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",v)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(_.window.document.fullscreenElement||_.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?_.window.document.exitFullscreen?_.window.document.exitFullscreen():_.window.document.webkitCancelFullScreen&&_.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends _.Evented{constructor(v){super(),this.options=_.extend(Object.create(Of),v),_.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(v&&v.className?v.className.trim().split(/\s+/):[])}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&v.on("preclick",this._onClose),this.options.closeOnMove&&v.on("move",this._onClose),v.on("remove",this.remove),this._update(),v._addPopup(this),this._focusFirstElement(),this._trackPointer?(v.on("mousemove",this._onMouseEvent),v.on("mouseup",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")):v.on("move",this._update),this.fire(new _.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const v=this._map;return v&&(v.off("move",this._update),v.off("move",this._onClose),v.off("preclick",this._onClose),v.off("click",this._onClose),v.off("remove",this.remove),v.off("mousemove",this._onMouseEvent),v.off("mouseup",this._onMouseEvent),v.off("drag",this._onMouseEvent),v._canvasContainer&&v._canvasContainer.classList.remove("mapboxgl-track-pointer"),v._removePopup(this),this._map=void 0),this.fire(new _.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(v){this._lngLat=_.LngLat.convert(v),this._pos=null,this._trackPointer=!1,this._update();const c=this._map;return c&&(c.on("move",this._update),c.off("mousemove",this._onMouseEvent),c._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const v=this._map;return v&&(v.off("move",this._update),v.on("mousemove",this._onMouseEvent),v.on("drag",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(_.window.document.createTextNode(v))}setHTML(v){const c=_.window.document.createDocumentFragment(),g=_.window.document.createElement("body");let C;for(g.innerHTML=v;C=g.firstChild,C;)c.appendChild(C);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){let c=this._content;if(c)for(;c.hasChildNodes();)c.firstChild&&c.removeChild(c.firstChild);else c=this._content=It("div","mapboxgl-popup-content",this._container||void 0);if(c.appendChild(v),this.options.closeButton){const g=this._closeButton=It("button","mapboxgl-popup-close-button",c);g.type="button",g.setAttribute("aria-label","Close popup"),g.setAttribute("aria-hidden","true"),g.innerHTML="&#215;",g.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(v){return this._classList.add(v),this._updateClassList(),this}removeClassName(v){return this._classList.delete(v),this._updateClassList(),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){let c;return this._classList.delete(v)?c=!1:(this._classList.add(v),c=!0),this._updateClassList(),c}_onMouseEvent(v){this._update(v.point)}_getAnchor(v){if(this.options.anchor)return this.options.anchor;const c=this._map,g=this._container,C=this._pos;if(!c||!g||!C)return"bottom";const S=g.offsetWidth,D=g.offsetHeight,L=C.x<S/2,z=C.x>c.transform.width-S/2;if(C.y+v<D)return L?"top-left":z?"top-right":"top";if(C.y>c.transform.height-D){if(L)return"bottom-left";if(z)return"bottom-right"}return L?"left":z?"right":"bottom"}_updateClassList(){const v=this._container;if(!v)return;const c=[...this._classList];c.push("mapboxgl-popup"),this._anchor&&c.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&c.push("mapboxgl-popup-track-pointer"),v.className=c.join(" ")}_update(v){const c=this._map,g=this._content;if(!c||!this._lngLat&&!this._trackPointer||!g)return;let C=this._container;if(C||(C=this._container=It("div","mapboxgl-popup",c.getContainer()),this._tip=It("div","mapboxgl-popup-tip",C),C.appendChild(g)),this.options.maxWidth&&C.style.maxWidth!==this.options.maxWidth&&(C.style.maxWidth=this.options.maxWidth),c.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=xh(this._lngLat,this._pos,c.transform)),!this._trackPointer||v){const S=this._pos=this._trackPointer&&v?v:c.project(this._lngLat),D=Ch(this.options.offset),L=this._anchor=this._getAnchor(D.y),z=Ch(this.options.offset,L),G=S.add(z).round();c._requestDomTask(()=>{this._container&&L&&(this._container.style.transform=`${wh[L]} translate(${G.x}px,${G.y}px)`)})}if(!this._marker&&c._showingGlobe()){const S=_.isLngLatBehindGlobe(c.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(fa);v&&v.focus()}_onClose(){this.remove()}_setOpacity(v){this._container&&(this._container.style.opacity=`${v}`),this._content&&(this._content.style.pointerEvents=v?"auto":"none")}},Marker:ro,Style:no,LngLat:_.LngLat,LngLatBounds:_.LngLatBounds,Point:_.pointGeometry,MercatorCoordinate:_.MercatorCoordinate,FreeCameraOptions:vd,Evented:_.Evented,config:_.config,prewarm:function(){ii().acquire(En)},clearPrewarmedResources:function(){const v=Ln;v&&(v.isPreloaded()&&1===v.numActive()?(v.release(En),Ln=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return _.config.ACCESS_TOKEN},set accessToken(v){_.config.ACCESS_TOKEN=v},get baseApiUrl(){return _.config.API_URL},set baseApiUrl(v){_.config.API_URL=v},get workerCount(){return Nn.workerCount},set workerCount(v){Nn.workerCount=v},get maxParallelImageRequests(){return _.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(v){_.config.MAX_PARALLEL_IMAGE_REQUESTS=v},clearStorage(v){_.clearTileCache(v)},workerUrl:"",workerClass:null,setNow:_.exported.setNow,restoreNow:_.exported.restoreNow};return Mi}),u}()},9751:(ui,Kt,De)=>{"use strict";De.d(Kt,{y:()=>yt});var u=De(930),Ne=De(727),Se=De(8822),_=De(9635),$e=De(2416),ft=De(576),on=De(2806);let yt=(()=>{class Ke{constructor(nn){nn&&(this._subscribe=nn)}lift(nn){const bn=new Ke;return bn.source=this,bn.operator=nn,bn}subscribe(nn,bn,An){const vt=function je(Ke){return Ke&&Ke instanceof u.Lv||function Ve(Ke){return Ke&&(0,ft.m)(Ke.next)&&(0,ft.m)(Ke.error)&&(0,ft.m)(Ke.complete)}(Ke)&&(0,Ne.Nn)(Ke)}(nn)?nn:new u.Hp(nn,bn,An);return(0,on.x)(()=>{const{operator:Ye,source:kt}=this;vt.add(Ye?Ye.call(vt,kt):kt?this._subscribe(vt):this._trySubscribe(vt))}),vt}_trySubscribe(nn){try{return this._subscribe(nn)}catch(bn){nn.error(bn)}}forEach(nn,bn){return new(bn=It(bn))((An,vt)=>{const Ye=new u.Hp({next:kt=>{try{nn(kt)}catch(Jt){vt(Jt),Ye.unsubscribe()}},error:vt,complete:An});this.subscribe(Ye)})}_subscribe(nn){var bn;return null===(bn=this.source)||void 0===bn?void 0:bn.subscribe(nn)}[Se.L](){return this}pipe(...nn){return(0,_.U)(nn)(this)}toPromise(nn){return new(nn=It(nn))((bn,An)=>{let vt;this.subscribe(Ye=>vt=Ye,Ye=>An(Ye),()=>bn(vt))})}}return Ke.create=pn=>new Ke(pn),Ke})();function It(Ke){var pn;return null!==(pn=Ke??$e.v.Promise)&&void 0!==pn?pn:Promise}},7579:(ui,Kt,De)=>{"use strict";De.d(Kt,{x:()=>on});var u=De(9751),Ne=De(727);const _=(0,De(3888).d)(It=>function(){It(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var $e=De(8737),ft=De(2806);let on=(()=>{class It extends u.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(je){const Ke=new yt(this,this);return Ke.operator=je,Ke}_throwIfClosed(){if(this.closed)throw new _}next(je){(0,ft.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Ke of this.currentObservers)Ke.next(je)}})}error(je){(0,ft.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=je;const{observers:Ke}=this;for(;Ke.length;)Ke.shift().error(je)}})}complete(){(0,ft.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:je}=this;for(;je.length;)je.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var je;return(null===(je=this.observers)||void 0===je?void 0:je.length)>0}_trySubscribe(je){return this._throwIfClosed(),super._trySubscribe(je)}_subscribe(je){return this._throwIfClosed(),this._checkFinalizedStatuses(je),this._innerSubscribe(je)}_innerSubscribe(je){const{hasError:Ke,isStopped:pn,observers:nn}=this;return Ke||pn?Ne.Lc:(this.currentObservers=null,nn.push(je),new Ne.w0(()=>{this.currentObservers=null,(0,$e.P)(nn,je)}))}_checkFinalizedStatuses(je){const{hasError:Ke,thrownError:pn,isStopped:nn}=this;Ke?je.error(pn):nn&&je.complete()}asObservable(){const je=new u.y;return je.source=this,je}}return It.create=(Ve,je)=>new yt(Ve,je),It})();class yt extends on{constructor(Ve,je){super(),this.destination=Ve,this.source=je}next(Ve){var je,Ke;null===(Ke=null===(je=this.destination)||void 0===je?void 0:je.next)||void 0===Ke||Ke.call(je,Ve)}error(Ve){var je,Ke;null===(Ke=null===(je=this.destination)||void 0===je?void 0:je.error)||void 0===Ke||Ke.call(je,Ve)}complete(){var Ve,je;null===(je=null===(Ve=this.destination)||void 0===Ve?void 0:Ve.complete)||void 0===je||je.call(Ve)}_subscribe(Ve){var je,Ke;return null!==(Ke=null===(je=this.source)||void 0===je?void 0:je.subscribe(Ve))&&void 0!==Ke?Ke:Ne.Lc}}},930:(ui,Kt,De)=>{"use strict";De.d(Kt,{Hp:()=>An,Lv:()=>Ke});var u=De(576),Ne=De(727),Se=De(2416),_=De(7849),$e=De(5032);const ft=It("C",void 0,void 0);function It(Xt,xt,Pt){return{kind:Xt,value:xt,error:Pt}}var Ve=De(3410),je=De(2806);class Ke extends Ne.w0{constructor(xt){super(),this.isStopped=!1,xt?(this.destination=xt,(0,Ne.Nn)(xt)&&xt.add(this)):this.destination=Jt}static create(xt,Pt,un){return new An(xt,Pt,un)}next(xt){this.isStopped?kt(function yt(Xt){return It("N",Xt,void 0)}(xt),this):this._next(xt)}error(xt){this.isStopped?kt(function on(Xt){return It("E",void 0,Xt)}(xt),this):(this.isStopped=!0,this._error(xt))}complete(){this.isStopped?kt(ft,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(xt){this.destination.next(xt)}_error(xt){try{this.destination.error(xt)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const pn=Function.prototype.bind;function nn(Xt,xt){return pn.call(Xt,xt)}class bn{constructor(xt){this.partialObserver=xt}next(xt){const{partialObserver:Pt}=this;if(Pt.next)try{Pt.next(xt)}catch(un){vt(un)}}error(xt){const{partialObserver:Pt}=this;if(Pt.error)try{Pt.error(xt)}catch(un){vt(un)}else vt(xt)}complete(){const{partialObserver:xt}=this;if(xt.complete)try{xt.complete()}catch(Pt){vt(Pt)}}}class An extends Ke{constructor(xt,Pt,un){let nt;if(super(),(0,u.m)(xt)||!xt)nt={next:xt??void 0,error:Pt??void 0,complete:un??void 0};else{let pt;this&&Se.v.useDeprecatedNextContext?(pt=Object.create(xt),pt.unsubscribe=()=>this.unsubscribe(),nt={next:xt.next&&nn(xt.next,pt),error:xt.error&&nn(xt.error,pt),complete:xt.complete&&nn(xt.complete,pt)}):nt=xt}this.destination=new bn(nt)}}function vt(Xt){Se.v.useDeprecatedSynchronousErrorHandling?(0,je.O)(Xt):(0,_.h)(Xt)}function kt(Xt,xt){const{onStoppedNotification:Pt}=Se.v;Pt&&Ve.z.setTimeout(()=>Pt(Xt,xt))}const Jt={closed:!0,next:$e.Z,error:function Ye(Xt){throw Xt},complete:$e.Z}},727:(ui,Kt,De)=>{"use strict";De.d(Kt,{Lc:()=>ft,w0:()=>$e,Nn:()=>on});var u=De(576);const Se=(0,De(3888).d)(It=>function(je){It(this),this.message=je?`${je.length} errors occurred during unsubscription:\n${je.map((Ke,pn)=>`${pn+1}) ${Ke.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=je});var _=De(8737);class $e{constructor(Ve){this.initialTeardown=Ve,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Ve;if(!this.closed){this.closed=!0;const{_parentage:je}=this;if(je)if(this._parentage=null,Array.isArray(je))for(const nn of je)nn.remove(this);else je.remove(this);const{initialTeardown:Ke}=this;if((0,u.m)(Ke))try{Ke()}catch(nn){Ve=nn instanceof Se?nn.errors:[nn]}const{_finalizers:pn}=this;if(pn){this._finalizers=null;for(const nn of pn)try{yt(nn)}catch(bn){Ve=Ve??[],bn instanceof Se?Ve=[...Ve,...bn.errors]:Ve.push(bn)}}if(Ve)throw new Se(Ve)}}add(Ve){var je;if(Ve&&Ve!==this)if(this.closed)yt(Ve);else{if(Ve instanceof $e){if(Ve.closed||Ve._hasParent(this))return;Ve._addParent(this)}(this._finalizers=null!==(je=this._finalizers)&&void 0!==je?je:[]).push(Ve)}}_hasParent(Ve){const{_parentage:je}=this;return je===Ve||Array.isArray(je)&&je.includes(Ve)}_addParent(Ve){const{_parentage:je}=this;this._parentage=Array.isArray(je)?(je.push(Ve),je):je?[je,Ve]:Ve}_removeParent(Ve){const{_parentage:je}=this;je===Ve?this._parentage=null:Array.isArray(je)&&(0,_.P)(je,Ve)}remove(Ve){const{_finalizers:je}=this;je&&(0,_.P)(je,Ve),Ve instanceof $e&&Ve._removeParent(this)}}$e.EMPTY=(()=>{const It=new $e;return It.closed=!0,It})();const ft=$e.EMPTY;function on(It){return It instanceof $e||It&&"closed"in It&&(0,u.m)(It.remove)&&(0,u.m)(It.add)&&(0,u.m)(It.unsubscribe)}function yt(It){(0,u.m)(It)?It():It.unsubscribe()}},2416:(ui,Kt,De)=>{"use strict";De.d(Kt,{v:()=>u});const u={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(ui,Kt,De)=>{"use strict";De.d(Kt,{E:()=>Ne});const Ne=new(De(9751).y)($e=>$e.complete())},8996:(ui,Kt,De)=>{"use strict";De.d(Kt,{D:()=>xt});var u=De(8421),Ne=De(5363),Se=De(9468),ft=De(9751),yt=De(2202),It=De(576),Ve=De(9672);function Ke(Pt,un){if(!Pt)throw new Error("Iterable cannot be null");return new ft.y(nt=>{(0,Ve.f)(nt,un,()=>{const pt=Pt[Symbol.asyncIterator]();(0,Ve.f)(nt,un,()=>{pt.next().then(Nt=>{Nt.done?nt.complete():nt.next(Nt.value)})},0,!0)})})}var pn=De(3670),nn=De(8239),bn=De(1144),An=De(6495),vt=De(2206),Ye=De(4532),kt=De(3260);function xt(Pt,un){return un?function Xt(Pt,un){if(null!=Pt){if((0,pn.c)(Pt))return function _(Pt,un){return(0,u.Xf)(Pt).pipe((0,Se.R)(un),(0,Ne.Q)(un))}(Pt,un);if((0,bn.z)(Pt))return function on(Pt,un){return new ft.y(nt=>{let pt=0;return un.schedule(function(){pt===Pt.length?nt.complete():(nt.next(Pt[pt++]),nt.closed||this.schedule())})})}(Pt,un);if((0,nn.t)(Pt))return function $e(Pt,un){return(0,u.Xf)(Pt).pipe((0,Se.R)(un),(0,Ne.Q)(un))}(Pt,un);if((0,vt.D)(Pt))return Ke(Pt,un);if((0,An.T)(Pt))return function je(Pt,un){return new ft.y(nt=>{let pt;return(0,Ve.f)(nt,un,()=>{pt=Pt[yt.h](),(0,Ve.f)(nt,un,()=>{let Nt,zt;try{({value:Nt,done:zt}=pt.next())}catch(an){return void nt.error(an)}zt?nt.complete():nt.next(Nt)},0,!0)}),()=>(0,It.m)(pt?.return)&&pt.return()})}(Pt,un);if((0,kt.L)(Pt))return function Jt(Pt,un){return Ke((0,kt.Q)(Pt),un)}(Pt,un)}throw(0,Ye.z)(Pt)}(Pt,un):(0,u.Xf)(Pt)}},8421:(ui,Kt,De)=>{"use strict";De.d(Kt,{Xf:()=>pn});var u=De(655),Ne=De(1144),Se=De(8239),_=De(9751),$e=De(3670),ft=De(2206),on=De(4532),yt=De(6495),It=De(3260),Ve=De(576),je=De(7849),Ke=De(8822);function pn(Xt){if(Xt instanceof _.y)return Xt;if(null!=Xt){if((0,$e.c)(Xt))return function nn(Xt){return new _.y(xt=>{const Pt=Xt[Ke.L]();if((0,Ve.m)(Pt.subscribe))return Pt.subscribe(xt);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Xt);if((0,Ne.z)(Xt))return function bn(Xt){return new _.y(xt=>{for(let Pt=0;Pt<Xt.length&&!xt.closed;Pt++)xt.next(Xt[Pt]);xt.complete()})}(Xt);if((0,Se.t)(Xt))return function An(Xt){return new _.y(xt=>{Xt.then(Pt=>{xt.closed||(xt.next(Pt),xt.complete())},Pt=>xt.error(Pt)).then(null,je.h)})}(Xt);if((0,ft.D)(Xt))return Ye(Xt);if((0,yt.T)(Xt))return function vt(Xt){return new _.y(xt=>{for(const Pt of Xt)if(xt.next(Pt),xt.closed)return;xt.complete()})}(Xt);if((0,It.L)(Xt))return function kt(Xt){return Ye((0,It.Q)(Xt))}(Xt)}throw(0,on.z)(Xt)}function Ye(Xt){return new _.y(xt=>{(function Jt(Xt,xt){var Pt,un,nt,pt;return(0,u.mG)(this,void 0,void 0,function*(){try{for(Pt=(0,u.KL)(Xt);!(un=yield Pt.next()).done;)if(xt.next(un.value),xt.closed)return}catch(Nt){nt={error:Nt}}finally{try{un&&!un.done&&(pt=Pt.return)&&(yield pt.call(Pt))}finally{if(nt)throw nt.error}}xt.complete()})})(Xt,xt).catch(Pt=>xt.error(Pt))})}},6451:(ui,Kt,De)=>{"use strict";De.d(Kt,{T:()=>ft});var u=De(8189),Ne=De(8421),Se=De(515),_=De(3269),$e=De(8996);function ft(...on){const yt=(0,_.yG)(on),It=(0,_._6)(on,1/0),Ve=on;return Ve.length?1===Ve.length?(0,Ne.Xf)(Ve[0]):(0,u.J)(It)((0,$e.D)(Ve,yt)):Se.E}},5403:(ui,Kt,De)=>{"use strict";De.d(Kt,{Q:()=>Se,x:()=>Ne});var u=De(930);function Ne(_,$e,ft,on,yt){return new Se(_,$e,ft,on,yt)}class Se extends u.Lv{constructor($e,ft,on,yt,It,Ve){super($e),this.onFinalize=It,this.shouldUnsubscribe=Ve,this._next=ft?function(je){try{ft(je)}catch(Ke){$e.error(Ke)}}:super._next,this._error=yt?function(je){try{yt(je)}catch(Ke){$e.error(Ke)}finally{this.unsubscribe()}}:super._error,this._complete=on?function(){try{on()}catch(je){$e.error(je)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var $e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ft}=this;super.unsubscribe(),!ft&&(null===($e=this.onFinalize)||void 0===$e||$e.call(this))}}}},4004:(ui,Kt,De)=>{"use strict";De.d(Kt,{U:()=>Se});var u=De(4482),Ne=De(5403);function Se(_,$e){return(0,u.e)((ft,on)=>{let yt=0;ft.subscribe((0,Ne.x)(on,It=>{on.next(_.call($e,It,yt++))}))})}},8189:(ui,Kt,De)=>{"use strict";De.d(Kt,{J:()=>Se});var u=De(5577),Ne=De(4671);function Se(_=1/0){return(0,u.z)(Ne.y,_)}},5577:(ui,Kt,De)=>{"use strict";De.d(Kt,{z:()=>yt});var u=De(4004),Ne=De(8421),Se=De(4482),_=De(9672),$e=De(5403),on=De(576);function yt(It,Ve,je=1/0){return(0,on.m)(Ve)?yt((Ke,pn)=>(0,u.U)((nn,bn)=>Ve(Ke,nn,pn,bn))((0,Ne.Xf)(It(Ke,pn))),je):("number"==typeof Ve&&(je=Ve),(0,Se.e)((Ke,pn)=>function ft(It,Ve,je,Ke,pn,nn,bn,An){const vt=[];let Ye=0,kt=0,Jt=!1;const Xt=()=>{Jt&&!vt.length&&!Ye&&Ve.complete()},xt=un=>Ye<Ke?Pt(un):vt.push(un),Pt=un=>{nn&&Ve.next(un),Ye++;let nt=!1;(0,Ne.Xf)(je(un,kt++)).subscribe((0,$e.x)(Ve,pt=>{pn?.(pt),nn?xt(pt):Ve.next(pt)},()=>{nt=!0},void 0,()=>{if(nt)try{for(Ye--;vt.length&&Ye<Ke;){const pt=vt.shift();bn?(0,_.f)(Ve,bn,()=>Pt(pt)):Pt(pt)}Xt()}catch(pt){Ve.error(pt)}}))};return It.subscribe((0,$e.x)(Ve,xt,()=>{Jt=!0,Xt()})),()=>{An?.()}}(Ke,pn,It,je)))}},5363:(ui,Kt,De)=>{"use strict";De.d(Kt,{Q:()=>_});var u=De(9672),Ne=De(4482),Se=De(5403);function _($e,ft=0){return(0,Ne.e)((on,yt)=>{on.subscribe((0,Se.x)(yt,It=>(0,u.f)(yt,$e,()=>yt.next(It),ft),()=>(0,u.f)(yt,$e,()=>yt.complete(),ft),It=>(0,u.f)(yt,$e,()=>yt.error(It),ft)))})}},3099:(ui,Kt,De)=>{"use strict";De.d(Kt,{B:()=>$e});var u=De(8421),Ne=De(7579),Se=De(930),_=De(4482);function $e(on={}){const{connector:yt=(()=>new Ne.x),resetOnError:It=!0,resetOnComplete:Ve=!0,resetOnRefCountZero:je=!0}=on;return Ke=>{let pn,nn,bn,An=0,vt=!1,Ye=!1;const kt=()=>{nn?.unsubscribe(),nn=void 0},Jt=()=>{kt(),pn=bn=void 0,vt=Ye=!1},Xt=()=>{const xt=pn;Jt(),xt?.unsubscribe()};return(0,_.e)((xt,Pt)=>{An++,!Ye&&!vt&&kt();const un=bn=bn??yt();Pt.add(()=>{An--,0===An&&!Ye&&!vt&&(nn=ft(Xt,je))}),un.subscribe(Pt),!pn&&An>0&&(pn=new Se.Hp({next:nt=>un.next(nt),error:nt=>{Ye=!0,kt(),nn=ft(Jt,It,nt),un.error(nt)},complete:()=>{vt=!0,kt(),nn=ft(Jt,Ve),un.complete()}}),(0,u.Xf)(xt).subscribe(pn))})(Ke)}}function ft(on,yt,...It){if(!0===yt)return void on();if(!1===yt)return;const Ve=new Se.Hp({next:()=>{Ve.unsubscribe(),on()}});return(0,u.Xf)(yt(...It)).subscribe(Ve)}},9468:(ui,Kt,De)=>{"use strict";De.d(Kt,{R:()=>Ne});var u=De(4482);function Ne(Se,_=0){return(0,u.e)(($e,ft)=>{ft.add(Se.schedule(()=>$e.subscribe(ft),_))})}},3410:(ui,Kt,De)=>{"use strict";De.d(Kt,{z:()=>u});const u={setTimeout(Ne,Se,..._){const{delegate:$e}=u;return $e?.setTimeout?$e.setTimeout(Ne,Se,..._):setTimeout(Ne,Se,..._)},clearTimeout(Ne){const{delegate:Se}=u;return(Se?.clearTimeout||clearTimeout)(Ne)},delegate:void 0}},2202:(ui,Kt,De)=>{"use strict";De.d(Kt,{h:()=>Ne});const Ne=function u(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(ui,Kt,De)=>{"use strict";De.d(Kt,{L:()=>u});const u="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(ui,Kt,De)=>{"use strict";De.d(Kt,{_6:()=>ft,jO:()=>_,yG:()=>$e});var u=De(576),Ne=De(3532);function Se(on){return on[on.length-1]}function _(on){return(0,u.m)(Se(on))?on.pop():void 0}function $e(on){return(0,Ne.K)(Se(on))?on.pop():void 0}function ft(on,yt){return"number"==typeof Se(on)?on.pop():yt}},8737:(ui,Kt,De)=>{"use strict";function u(Ne,Se){if(Ne){const _=Ne.indexOf(Se);0<=_&&Ne.splice(_,1)}}De.d(Kt,{P:()=>u})},3888:(ui,Kt,De)=>{"use strict";function u(Ne){const _=Ne($e=>{Error.call($e),$e.stack=(new Error).stack});return _.prototype=Object.create(Error.prototype),_.prototype.constructor=_,_}De.d(Kt,{d:()=>u})},2806:(ui,Kt,De)=>{"use strict";De.d(Kt,{O:()=>_,x:()=>Se});var u=De(2416);let Ne=null;function Se($e){if(u.v.useDeprecatedSynchronousErrorHandling){const ft=!Ne;if(ft&&(Ne={errorThrown:!1,error:null}),$e(),ft){const{errorThrown:on,error:yt}=Ne;if(Ne=null,on)throw yt}}else $e()}function _($e){u.v.useDeprecatedSynchronousErrorHandling&&Ne&&(Ne.errorThrown=!0,Ne.error=$e)}},9672:(ui,Kt,De)=>{"use strict";function u(Ne,Se,_,$e=0,ft=!1){const on=Se.schedule(function(){_(),ft?Ne.add(this.schedule(null,$e)):this.unsubscribe()},$e);if(Ne.add(on),!ft)return on}De.d(Kt,{f:()=>u})},4671:(ui,Kt,De)=>{"use strict";function u(Ne){return Ne}De.d(Kt,{y:()=>u})},1144:(ui,Kt,De)=>{"use strict";De.d(Kt,{z:()=>u});const u=Ne=>Ne&&"number"==typeof Ne.length&&"function"!=typeof Ne},2206:(ui,Kt,De)=>{"use strict";De.d(Kt,{D:()=>Ne});var u=De(576);function Ne(Se){return Symbol.asyncIterator&&(0,u.m)(Se?.[Symbol.asyncIterator])}},576:(ui,Kt,De)=>{"use strict";function u(Ne){return"function"==typeof Ne}De.d(Kt,{m:()=>u})},3670:(ui,Kt,De)=>{"use strict";De.d(Kt,{c:()=>Se});var u=De(8822),Ne=De(576);function Se(_){return(0,Ne.m)(_[u.L])}},6495:(ui,Kt,De)=>{"use strict";De.d(Kt,{T:()=>Se});var u=De(2202),Ne=De(576);function Se(_){return(0,Ne.m)(_?.[u.h])}},8239:(ui,Kt,De)=>{"use strict";De.d(Kt,{t:()=>Ne});var u=De(576);function Ne(Se){return(0,u.m)(Se?.then)}},3260:(ui,Kt,De)=>{"use strict";De.d(Kt,{L:()=>_,Q:()=>Se});var u=De(655),Ne=De(576);function Se($e){return(0,u.FC)(this,arguments,function*(){const on=$e.getReader();try{for(;;){const{value:yt,done:It}=yield(0,u.qq)(on.read());if(It)return yield(0,u.qq)(void 0);yield yield(0,u.qq)(yt)}}finally{on.releaseLock()}})}function _($e){return(0,Ne.m)($e?.getReader)}},3532:(ui,Kt,De)=>{"use strict";De.d(Kt,{K:()=>Ne});var u=De(576);function Ne(Se){return Se&&(0,u.m)(Se.schedule)}},4482:(ui,Kt,De)=>{"use strict";De.d(Kt,{A:()=>Ne,e:()=>Se});var u=De(576);function Ne(_){return(0,u.m)(_?.lift)}function Se(_){return $e=>{if(Ne($e))return $e.lift(function(ft){try{return _(ft,this)}catch(on){this.error(on)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(ui,Kt,De)=>{"use strict";function u(){}De.d(Kt,{Z:()=>u})},9635:(ui,Kt,De)=>{"use strict";De.d(Kt,{U:()=>Se,z:()=>Ne});var u=De(4671);function Ne(..._){return Se(_)}function Se(_){return 0===_.length?u.y:1===_.length?_[0]:function(ft){return _.reduce((on,yt)=>yt(on),ft)}}},7849:(ui,Kt,De)=>{"use strict";De.d(Kt,{h:()=>Se});var u=De(2416),Ne=De(3410);function Se(_){Ne.z.setTimeout(()=>{const{onUnhandledError:$e}=u.v;if(!$e)throw _;$e(_)})}},4532:(ui,Kt,De)=>{"use strict";function u(Ne){return new TypeError(`You provided ${null!==Ne&&"object"==typeof Ne?"an invalid object":`'${Ne}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}De.d(Kt,{z:()=>u})},655:(ui,Kt,De)=>{"use strict";function _(mt,gt){var Dt={};for(var Ht in mt)Object.prototype.hasOwnProperty.call(mt,Ht)&&gt.indexOf(Ht)<0&&(Dt[Ht]=mt[Ht]);if(null!=mt&&"function"==typeof Object.getOwnPropertySymbols){var rn=0;for(Ht=Object.getOwnPropertySymbols(mt);rn<Ht.length;rn++)gt.indexOf(Ht[rn])<0&&Object.prototype.propertyIsEnumerable.call(mt,Ht[rn])&&(Dt[Ht[rn]]=mt[Ht[rn]])}return Dt}function Ke(mt,gt,Dt,Ht){return new(Dt||(Dt=Promise))(function(en,wn){function Cn(Bn){try{qn(Ht.next(Bn))}catch(vn){wn(vn)}}function ir(Bn){try{qn(Ht.throw(Bn))}catch(vn){wn(vn)}}function qn(Bn){Bn.done?en(Bn.value):function rn(en){return en instanceof Dt?en:new Dt(function(wn){wn(en)})}(Bn.value).then(Cn,ir)}qn((Ht=Ht.apply(mt,gt||[])).next())})}function Xt(mt){return this instanceof Xt?(this.v=mt,this):new Xt(mt)}function xt(mt,gt,Dt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var rn,Ht=Dt.apply(mt,gt||[]),en=[];return rn={},wn("next"),wn("throw"),wn("return"),rn[Symbol.asyncIterator]=function(){return this},rn;function wn(Xi){Ht[Xi]&&(rn[Xi]=function(Ai){return new Promise(function(dr,Un){en.push([Xi,Ai,dr,Un])>1||Cn(Xi,Ai)})})}function Cn(Xi,Ai){try{!function ir(Xi){Xi.value instanceof Xt?Promise.resolve(Xi.value.v).then(qn,Bn):vn(en[0][2],Xi)}(Ht[Xi](Ai))}catch(dr){vn(en[0][3],dr)}}function qn(Xi){Cn("next",Xi)}function Bn(Xi){Cn("throw",Xi)}function vn(Xi,Ai){Xi(Ai),en.shift(),en.length&&Cn(en[0][0],en[0][1])}}function un(mt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Dt,gt=mt[Symbol.asyncIterator];return gt?gt.call(mt):(mt=function An(mt){var gt="function"==typeof Symbol&&Symbol.iterator,Dt=gt&&mt[gt],Ht=0;if(Dt)return Dt.call(mt);if(mt&&"number"==typeof mt.length)return{next:function(){return mt&&Ht>=mt.length&&(mt=void 0),{value:mt&&mt[Ht++],done:!mt}}};throw new TypeError(gt?"Object is not iterable.":"Symbol.iterator is not defined.")}(mt),Dt={},Ht("next"),Ht("throw"),Ht("return"),Dt[Symbol.asyncIterator]=function(){return this},Dt);function Ht(en){Dt[en]=mt[en]&&function(wn){return new Promise(function(Cn,ir){!function rn(en,wn,Cn,ir){Promise.resolve(ir).then(function(qn){en({value:qn,done:Cn})},wn)}(Cn,ir,(wn=mt[en](wn)).done,wn.value)})}}}De.d(Kt,{FC:()=>xt,KL:()=>un,_T:()=>_,mG:()=>Ke,qq:()=>Xt})},4650:(ui,Kt,De)=>{"use strict";De.d(Kt,{$8M:()=>Yc,$WT:()=>ko,$Z:()=>Ix,AFp:()=>XI,ALo:()=>Gy,AaK:()=>yt,BQk:()=>Ug,CHM:()=>Op,CRH:()=>zI,CZH:()=>Mw,CqO:()=>p0,D6c:()=>$A,DdM:()=>kC,EJc:()=>tS,EiD:()=>sm,EpF:()=>uC,F$t:()=>lp,F4k:()=>ew,FYo:()=>ux,FiY:()=>_e,Gf:()=>Hn,GfV:()=>dx,GkF:()=>jg,Gpc:()=>je,Gre:()=>Li,Hsn:()=>g0,Ikx:()=>cu,JOm:()=>Fi,JVY:()=>tm,JZr:()=>An,Jf7:()=>Wv,KtG:()=>gd,L6k:()=>zv,LAX:()=>k_,LFG:()=>cn,LSH:()=>Ad,Lbi:()=>SA,Lck:()=>uA,MAs:()=>d0,MMx:()=>gw,NdJ:()=>Ey,O4$:()=>jc,OlP:()=>xr,Oqu:()=>At,P3R:()=>Fl,PXZ:()=>kw,Q6J:()=>Gd,QGY:()=>Xh,QbO:()=>MA,Qsj:()=>Zv,R0b:()=>id,RDi:()=>Xb,Rgc:()=>Om,SBq:()=>Qs,Sil:()=>t_,Suo:()=>ai,TTD:()=>xu,TgZ:()=>Vg,Udp:()=>y,VKq:()=>RC,W1O:()=>BI,X6Q:()=>iE,XFs:()=>In,Xpm:()=>En,Xts:()=>So,Y36:()=>_m,YKP:()=>MC,YNc:()=>cC,Yjl:()=>fr,Yz7:()=>vn,Z0I:()=>Un,ZZ4:()=>uf,_Bn:()=>_I,_UZ:()=>wy,_Vd:()=>Od,_c5:()=>ab,_uU:()=>Tt,aQg:()=>Bw,c2e:()=>eS,cJS:()=>Ai,cg1:()=>ef,dDg:()=>i_,dqk:()=>hi,eBb:()=>Lh,eFA:()=>eE,eJc:()=>GC,ekj:()=>w,eoX:()=>Yd,f3M:()=>Sn,g9A:()=>JI,h0i:()=>Uy,hGG:()=>jA,hij:()=>Et,iGM:()=>Tw,ifc:()=>Y,ip1:()=>KI,jDz:()=>_w,kL8:()=>Bl,kcU:()=>Mu,lG2:()=>hr,lqb:()=>Bh,lri:()=>vp,mCW:()=>nm,n5z:()=>Io,n_E:()=>Z0,oAB:()=>Ci,oJD:()=>ix,oxw:()=>ba,pB0:()=>ya,q3G:()=>es,q4F:()=>Vh,qLn:()=>_g,qOj:()=>Hh,qZA:()=>Kh,qzn:()=>fc,rWj:()=>J0,s9C:()=>Sm,sBO:()=>fS,s_b:()=>Cw,soG:()=>Q0,tBr:()=>fe,tb:()=>Ow,tp0:()=>ve,uIk:()=>sp,vHH:()=>vt,vpe:()=>Wd,wAp:()=>fi,xi3:()=>bw,xp6:()=>gx,ynx:()=>Cy,z2F:()=>ib,z3N:()=>Ks,zSh:()=>U_,zs3:()=>hm});var u=De(7579),Ne=De(727),Se=De(9751),_=De(6451),$e=De(3099);function ft(d){for(let h in d)if(d[h]===ft)return h;throw Error("Could not find renamed property on target object.")}function on(d,h){for(const m in h)h.hasOwnProperty(m)&&!d.hasOwnProperty(m)&&(d[m]=h[m])}function yt(d){if("string"==typeof d)return d;if(Array.isArray(d))return"["+d.map(yt).join(", ")+"]";if(null==d)return""+d;if(d.overriddenName)return`${d.overriddenName}`;if(d.name)return`${d.name}`;const h=d.toString();if(null==h)return""+h;const m=h.indexOf("\n");return-1===m?h:h.substring(0,m)}function It(d,h){return null==d||""===d?null===h?"":h:null==h||""===h?d:d+" "+h}const Ve=ft({__forward_ref__:ft});function je(d){return d.__forward_ref__=je,d.toString=function(){return yt(this())},d}function Ke(d){return pn(d)?d():d}function pn(d){return"function"==typeof d&&d.hasOwnProperty(Ve)&&d.__forward_ref__===je}function nn(d){return d&&!!d.\u0275providers}const An="https://g.co/ng/security#xss";class vt extends Error{constructor(h,m){super(Ye(h,m)),this.code=h}}function Ye(d,h){return`NG0${Math.abs(d)}${h?": "+h.trim():""}`}function kt(d){return"string"==typeof d?d:null==d?"":String(d)}function un(d,h){throw new vt(-201,!1)}function wn(d,h){null==d&&function Cn(d,h,m,x){throw new Error(`ASSERTION ERROR: ${d}`+(null==x?"":` [Expected=> ${m} ${x} ${h} <=Actual]`))}(h,d,null,"!=")}function vn(d){return{token:d.token,providedIn:d.providedIn||null,factory:d.factory,value:void 0}}function Ai(d){return{providers:d.providers||[],imports:d.imports||[]}}function dr(d){return kr(d,Ss)||kr(d,Sr)}function Un(d){return null!==dr(d)}function kr(d,h){return d.hasOwnProperty(h)?d[h]:null}function co(d){return d&&(d.hasOwnProperty(gs)||d.hasOwnProperty($r))?d[gs]:null}const Ss=ft({\u0275prov:ft}),gs=ft({\u0275inj:ft}),Sr=ft({ngInjectableDef:ft}),$r=ft({ngInjectorDef:ft});var In=(()=>((In=In||{})[In.Default=0]="Default",In[In.Host=1]="Host",In[In.Self=2]="Self",In[In.SkipSelf=4]="SkipSelf",In[In.Optional=8]="Optional",In))();let Uo;function wo(d){const h=Uo;return Uo=d,h}function Gr(d,h,m){const x=dr(d);return x&&"root"==x.providedIn?void 0===x.value?x.value=x.factory():x.value:m&In.Optional?null:void 0!==h?h:void un(yt(d))}const hi=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Mr={},Jr="__NG_DI_FLAG__",Oo="ngTempTokenPath",uo="ngTokenPath",_s=/\n/gm,wi="\u0275",Bs="__source";let Ei;function ho(d){const h=Ei;return Ei=d,h}function qr(d,h=In.Default){if(void 0===Ei)throw new vt(-203,!1);return null===Ei?Gr(d,void 0,h):Ei.get(d,h&In.Optional?null:void 0,h)}function cn(d,h=In.Default){return(function ss(){return Uo}()||qr)(Ke(d),h)}function Sn(d,h=In.Default){return cn(d,Zn(h))}function Zn(d){return typeof d>"u"||"number"==typeof d?d:0|(d.optional&&8)|(d.host&&1)|(d.self&&2)|(d.skipSelf&&4)}function ti(d){const h=[];for(let m=0;m<d.length;m++){const x=Ke(d[m]);if(Array.isArray(x)){if(0===x.length)throw new vt(900,!1);let T,A=In.Default;for(let N=0;N<x.length;N++){const Z=x[N],X=eo(Z);"number"==typeof X?-1===X?T=Z.token:A|=X:T=Z}h.push(cn(T,A))}else h.push(cn(x))}return h}function Oi(d,h){return d[Jr]=h,d.prototype[Jr]=h,d}function eo(d){return d[Jr]}function $(d){return{toString:d}.toString()}var H=(()=>((H=H||{})[H.OnPush=0]="OnPush",H[H.Default=1]="Default",H))(),Y=(()=>{return(d=Y||(Y={}))[d.Emulated=0]="Emulated",d[d.None=2]="None",d[d.ShadowDom=3]="ShadowDom",Y;var d})();const ae={},pe=[],ke=ft({\u0275cmp:ft}),Be=ft({\u0275dir:ft}),Pe=ft({\u0275pipe:ft}),He=ft({\u0275mod:ft}),rt=ft({\u0275fac:ft}),$t=ft({__NG_ELEMENT_ID__:ft});let _t=0;function En(d){return $(()=>{const h=qa(d),m={...h,decls:d.decls,vars:d.vars,template:d.template,consts:d.consts||null,ngContentSelectors:d.ngContentSelectors,onPush:d.changeDetection===H.OnPush,directiveDefs:null,pipeDefs:null,dependencies:h.standalone&&d.dependencies||null,getStandaloneInjector:null,data:d.data||{},encapsulation:d.encapsulation||Y.Emulated,id:"c"+_t++,styles:d.styles||pe,_:null,schemas:d.schemas||null,tView:null};rh(m);const x=d.dependencies;return m.directiveDefs=ls(x,!1),m.pipeDefs=ls(x,!0),m})}function Ln(d){return Zi(d)||Rr(d)}function ii(d){return null!==d}function Ci(d){return $(()=>({type:d.type,bootstrap:d.bootstrap||pe,declarations:d.declarations||pe,imports:d.imports||pe,exports:d.exports||pe,transitiveCompileScopes:null,schemas:d.schemas||null,id:d.id||null}))}function $n(d,h){if(null==d)return ae;const m={};for(const x in d)if(d.hasOwnProperty(x)){let T=d[x],A=T;Array.isArray(T)&&(A=T[1],T=T[0]),m[T]=x,h&&(h[T]=A)}return m}function hr(d){return $(()=>{const h=qa(d);return rh(h),h})}function fr(d){return{type:d.type,name:d.name,factory:null,pure:!1!==d.pure,standalone:!0===d.standalone,onDestroy:d.type.prototype.ngOnDestroy||null}}function Zi(d){return d[ke]||null}function Rr(d){return d[Be]||null}function dt(d){return d[Pe]||null}function ko(d){const h=Zi(d)||Rr(d)||dt(d);return null!==h&&h.standalone}function ur(d,h){const m=d[He]||null;if(!m&&!0===h)throw new Error(`Type ${yt(d)} does not have '\u0275mod' property.`);return m}function qa(d){const h={};return{type:d.type,providersResolver:null,factory:null,hostBindings:d.hostBindings||null,hostVars:d.hostVars||0,hostAttrs:d.hostAttrs||null,contentQueries:d.contentQueries||null,declaredInputs:h,exportAs:d.exportAs||null,standalone:!0===d.standalone,selectors:d.selectors||pe,viewQuery:d.viewQuery||null,features:d.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:$n(d.inputs,h),outputs:$n(d.outputs)}}function rh(d){d.features?.forEach(h=>h(d))}function ls(d,h){if(!d)return null;const m=h?dt:Ln;return()=>("function"==typeof d?d():d).map(x=>m(x)).filter(ii)}const Ms=0,Mn=1,Ti=2,Ft=3,oi=4,gi=5,Qi=6,Ds=7,Gn=8,Ro=9,_l=10,bi=11,jo=12,Ui=13,cd=14,fo=15,cs=16,Vs=17,sa=18,Co=19,aa=20,Ac=21,yi=22,Ko=1,to=2,yl=7,Kl=8,Eo=9,Er=10;function Xo(d){return Array.isArray(d)&&"object"==typeof d[Ko]}function Ji(d){return Array.isArray(d)&&!0===d[Ko]}function Pc(d){return 0!=(4&d.flags)}function Oc(d){return d.componentOffset>-1}function Us(d){return 1==(1&d.flags)}function Br(d){return!!d.template}function gu(d){return 0!=(256&d[Ti])}function Xl(d,h){return d.hasOwnProperty(rt)?d[rt]:null}class kc{constructor(h,m,x){this.previousValue=h,this.currentValue=m,this.firstChange=x}isFirstChange(){return this.firstChange}}function xu(){return Rc}function Rc(d){return d.type.prototype.ngOnChanges&&(d.setInput=fd),Ql}function Ql(){const d=Wi(this),h=d?.current;if(h){const m=d.previous;if(m===ae)d.previous=h;else for(let x in h)m[x]=h[x];d.current=null,this.ngOnChanges(h)}}function fd(d,h,m,x){const T=this.declaredInputs[m],A=Wi(d)||function pd(d,h){return d[Jl]=h}(d,{previous:ae,current:null}),N=A.current||(A.current={}),Z=A.previous,X=Z[T];N[T]=new kc(X&&X.currentValue,h,Z===ae),d[x]=h}xu.ngInherit=!0;const Jl="__ngSimpleChanges__";function Wi(d){return d[Jl]||null}const Qo=function(d,h,m){},wu="svg";function io(d){for(;Array.isArray(d);)d=d[Ms];return d}function xl(d,h){return io(h[d])}function po(d,h){return io(h[d.index])}function Eu(d,h){return d.data[h]}function la(d,h){return d[h]}function di(d,h){const m=h[d];return Xo(m)?m:m[Ms]}function ec(d){return 64==(64&d[Ti])}function ca(d,h){return null==h?null:d[h]}function oh(d){d[sa]=0}function Bc(d,h){d[gi]+=h;let m=d,x=d[Ft];for(;null!==x&&(1===h&&1===m[gi]||-1===h&&0===m[gi]);)x[gi]+=h,m=x,x=x[Ft]}const Ii={lFrame:tg(null),bindingsEnabled:!0};function Pp(){return Ii.bindingsEnabled}function qt(){return Ii.lFrame.lView}function ji(){return Ii.lFrame.tView}function Op(d){return Ii.lFrame.contextLView=d,d[Gn]}function gd(d){return Ii.lFrame.contextLView=null,d}function Fo(){let d=Wa();for(;null!==d&&64===d.type;)d=d.parent;return d}function Wa(){return Ii.lFrame.currentTNode}function Ya(d,h){const m=Ii.lFrame;m.currentTNode=d,m.isParent=h}function Vc(){return Ii.lFrame.isParent}function ch(){Ii.lFrame.isParent=!1}function Jo(){const d=Ii.lFrame;let h=d.bindingRootIndex;return-1===h&&(h=d.bindingRootIndex=d.tView.bindingStartIndex),h}function Cl(){return Ii.lFrame.bindingIndex++}function Ka(d){const h=Ii.lFrame,m=h.bindingIndex;return h.bindingIndex=h.bindingIndex+d,m}function tc(d,h){const m=Ii.lFrame;m.bindingIndex=m.bindingRootIndex=d,Ia(h)}function Ia(d){Ii.lFrame.currentDirectiveIndex=d}function Su(){return Ii.lFrame.currentQueryIndex}function Lp(d){Ii.lFrame.currentQueryIndex=d}function eg(d){const h=d[Mn];return 2===h.type?h.declTNode:1===h.type?d[Qi]:null}function Np(d,h,m){if(m&In.SkipSelf){let T=h,A=d;for(;!(T=T.parent,null!==T||m&In.Host||(T=eg(A),null===T||(A=A[fo],10&T.type))););if(null===T)return!1;h=T,d=A}const x=Ii.lFrame=zp();return x.currentTNode=h,x.lView=d,!0}function wf(d){const h=zp(),m=d[Mn];Ii.lFrame=h,h.currentTNode=m.firstChild,h.lView=d,h.tView=m,h.contextLView=d,h.bindingIndex=m.bindingStartIndex,h.inI18n=!1}function zp(){const d=Ii.lFrame,h=null===d?null:d.child;return null===h?tg(d):h}function tg(d){const h={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:d,child:null,inI18n:!1};return null!==d&&(d.child=h),h}function Cf(){const d=Ii.lFrame;return Ii.lFrame=d.parent,d.currentTNode=null,d.lView=null,d}const Ef=Cf;function Tf(){const d=Cf();d.isParent=!0,d.tView=null,d.selectedIndex=-1,d.contextLView=null,d.elementDepthCount=0,d.currentDirectiveIndex=-1,d.currentNamespace=null,d.bindingRootIndex=-1,d.bindingIndex=-1,d.currentQueryIndex=0}function vs(){return Ii.lFrame.selectedIndex}function As(d){Ii.lFrame.selectedIndex=d}function pr(){const d=Ii.lFrame;return Eu(d.tView,d.selectedIndex)}function jc(){Ii.lFrame.currentNamespace=wu}function Mu(){!function nc(){Ii.lFrame.currentNamespace=null}()}function Du(d,h){for(let m=h.directiveStart,x=h.directiveEnd;m<x;m++){const A=d.data[m].type.prototype,{ngAfterContentInit:N,ngAfterContentChecked:Z,ngAfterViewInit:X,ngAfterViewChecked:oe,ngOnDestroy:he}=A;N&&(d.contentHooks??(d.contentHooks=[])).push(-m,N),Z&&((d.contentHooks??(d.contentHooks=[])).push(m,Z),(d.contentCheckHooks??(d.contentCheckHooks=[])).push(m,Z)),X&&(d.viewHooks??(d.viewHooks=[])).push(-m,X),oe&&((d.viewHooks??(d.viewHooks=[])).push(m,oe),(d.viewCheckHooks??(d.viewCheckHooks=[])).push(m,oe)),null!=he&&(d.destroyHooks??(d.destroyHooks=[])).push(m,he)}}function yd(d,h,m){Sa(d,h,3,m)}function ic(d,h,m,x){(3&d[Ti])===m&&Sa(d,h,m,x)}function El(d,h){let m=d[Ti];(3&m)===h&&(m&=2047,m+=1,d[Ti]=m)}function Sa(d,h,m,x){const A=x??-1,N=h.length-1;let Z=0;for(let X=void 0!==x?65535&d[sa]:0;X<N;X++)if("number"==typeof h[X+1]){if(Z=h[X],null!=x&&Z>=x)break}else h[X]<0&&(d[sa]+=65536),(Z<A||-1==A)&&(If(d,m,h,X),d[sa]=(4294901760&d[sa])+X+2),X++}function If(d,h,m,x){const T=m[x]<0,A=m[x+1],Z=d[T?-m[x]:m[x]];if(T){if(d[Ti]>>11<d[sa]>>16&&(3&d[Ti])===h){d[Ti]+=2048,Qo(4,Z,A);try{A.call(Z)}finally{Qo(5,Z,A)}}}else{Qo(4,Z,A);try{A.call(Z)}finally{Qo(5,Z,A)}}}const ua=-1;class Au{constructor(h,m,x){this.factory=h,this.resolving=!1,this.canSeeViewProviders=m,this.injectImpl=x}}function fn(d,h,m){let x=0;for(;x<m.length;){const T=m[x];if("number"==typeof T){if(0!==T)break;x++;const A=m[x++],N=m[x++],Z=m[x++];d.setAttribute(h,N,Z,A)}else{const A=T,N=m[++x];bd(A)?d.setProperty(h,A,N):d.setAttribute(h,A,N),x++}}return x}function rr(d){return 3===d||4===d||6===d}function bd(d){return 64===d.charCodeAt(0)}function Ma(d,h){if(null!==h&&0!==h.length)if(null===d||0===d.length)d=h.slice();else{let m=-1;for(let x=0;x<h.length;x++){const T=h[x];"number"==typeof T?m=T:0===m||Gc(d,m,T,null,-1===m||2===m?h[++x]:null)}}return d}function Gc(d,h,m,x,T){let A=0,N=d.length;if(-1===h)N=-1;else for(;A<d.length;){const Z=d[A++];if("number"==typeof Z){if(Z===h){N=-1;break}if(Z>h){N=A-1;break}}}for(;A<d.length;){const Z=d[A];if("number"==typeof Z)break;if(Z===m){if(null===x)return void(null!==T&&(d[A+1]=T));if(x===d[A+1])return void(d[A+2]=T)}A++,null!==x&&A++,null!==T&&A++}-1!==N&&(d.splice(N,0,h),A=N+1),d.splice(A++,0,m),null!==x&&d.splice(A++,0,x),null!==T&&d.splice(A++,0,T)}function Qa(d){return d!==ua}function xd(d){return 32767&d}function Hc(d,h){let m=function fh(d){return d>>16}(d),x=h;for(;m>0;)x=x[fo],m--;return x}let qc=!0;function Da(d){const h=qc;return qc=d,h}const Zr=255,Ml=5;let ph=0;const Ps={};function Dl(d,h){const m=Ed(d,h);if(-1!==m)return m;const x=h[Mn];x.firstCreatePass&&(d.injectorIndex=h.length,Zc(x.data,d),Zc(h,null),Zc(x.blueprint,null));const T=Aa(d,h),A=d.injectorIndex;if(Qa(T)){const N=xd(T),Z=Hc(T,h),X=Z[Mn].data;for(let oe=0;oe<8;oe++)h[A+oe]=Z[N+oe]|X[N+oe]}return h[A+8]=T,A}function Zc(d,h){d.push(0,0,0,0,0,0,0,0,h)}function Ed(d,h){return-1===d.injectorIndex||d.parent&&d.parent.injectorIndex===d.injectorIndex||null===h[d.injectorIndex+8]?-1:d.injectorIndex}function Aa(d,h){if(d.parent&&-1!==d.parent.injectorIndex)return d.parent.injectorIndex;let m=0,x=null,T=h;for(;null!==T;){if(x=Pf(T),null===x)return ua;if(m++,T=T[fo],-1!==x.injectorIndex)return x.injectorIndex|m<<16}return ua}function Pu(d,h,m){!function Cd(d,h,m){let x;"string"==typeof m?x=m.charCodeAt(0)||0:m.hasOwnProperty($t)&&(x=m[$t]),null==x&&(x=m[$t]=ph++);const T=x&Zr;h.data[d+(T>>Ml)]|=1<<T}(d,h,m)}function Td(d,h,m){if(m&In.Optional||void 0!==d)return d;un()}function mh(d,h,m,x){if(m&In.Optional&&void 0===x&&(x=null),!(m&(In.Self|In.Host))){const T=d[Ro],A=wo(void 0);try{return T?T.get(h,x,m&In.Optional):Gr(h,x,m&In.Optional)}finally{wo(A)}}return Td(x,0,m)}function gh(d,h,m,x=In.Default,T){if(null!==d){if(1024&h[Ti]){const N=function Af(d,h,m,x,T){let A=d,N=h;for(;null!==A&&null!==N&&1024&N[Ti]&&!(256&N[Ti]);){const Z=_h(A,N,m,x|In.Self,Ps);if(Z!==Ps)return Z;let X=A.parent;if(!X){const oe=N[Ac];if(oe){const he=oe.get(m,Ps,x);if(he!==Ps)return he}X=Pf(N),N=N[fo]}A=X}return T}(d,h,m,x,Ps);if(N!==Ps)return N}const A=_h(d,h,m,x,Ps);if(A!==Ps)return A}return mh(h,m,x,T)}function _h(d,h,m,x,T){const A=function Sf(d){if("string"==typeof d)return d.charCodeAt(0)||0;const h=d.hasOwnProperty($t)?d[$t]:void 0;return"number"==typeof h?h>=0?h&Zr:yh:h}(m);if("function"==typeof A){if(!Np(h,d,x))return x&In.Host?Td(T,0,x):mh(h,m,x,T);try{const N=A(x);if(null!=N||x&In.Optional)return N;un()}finally{Ef()}}else if("number"==typeof A){let N=null,Z=Ed(d,h),X=ua,oe=x&In.Host?h[cs][Qi]:null;for((-1===Z||x&In.SkipSelf)&&(X=-1===Z?Aa(d,h):h[Z+8],X!==ua&&Id(x,!1)?(N=h[Mn],Z=xd(X),h=Hc(X,h)):Z=-1);-1!==Z;){const he=h[Mn];if(Mf(A,Z,he.data)){const Ie=rc(Z,h,m,N,x,oe);if(Ie!==Ps)return Ie}X=h[Z+8],X!==ua&&Id(x,h[Mn].data[Z+8]===oe)&&Mf(A,Z,h)?(N=he,Z=xd(X),h=Hc(X,h)):Z=-1}}return T}function rc(d,h,m,x,T,A){const N=h[Mn],Z=N.data[d+8],he=Ou(Z,N,m,null==x?Oc(Z)&&qc:x!=N&&0!=(3&Z.type),T&In.Host&&A===Z);return null!==he?da(h,N,he,Z):Ps}function Ou(d,h,m,x,T){const A=d.providerIndexes,N=h.data,Z=1048575&A,X=d.directiveStart,he=A>>20,Ze=T?Z+he:d.directiveEnd;for(let ut=x?Z:Z+he;ut<Ze;ut++){const Lt=N[ut];if(ut<X&&m===Lt||ut>=X&&Lt.type===m)return ut}if(T){const ut=N[X];if(ut&&Br(ut)&&ut.type===m)return X}return null}function da(d,h,m,x){let T=d[m];const A=h.data;if(function vd(d){return d instanceof Au}(T)){const N=T;N.resolving&&function Xt(d,h){const m=h?`. Dependency path: ${h.join(" > ")} > ${d}`:"";throw new vt(-200,`Circular dependency in DI detected for ${d}${m}`)}(function Jt(d){return"function"==typeof d?d.name||d.toString():"object"==typeof d&&null!=d&&"function"==typeof d.type?d.type.name||d.type.toString():kt(d)}(A[m]));const Z=Da(N.canSeeViewProviders);N.resolving=!0;const X=N.injectImpl?wo(N.injectImpl):null;Np(d,x,In.Default);try{T=d[m]=N.factory(void 0,A,d,x),h.firstCreatePass&&m>=x.directiveStart&&function Hi(d,h,m){const{ngOnChanges:x,ngOnInit:T,ngDoCheck:A}=h.type.prototype;if(x){const N=Rc(h);(m.preOrderHooks??(m.preOrderHooks=[])).push(d,N),(m.preOrderCheckHooks??(m.preOrderCheckHooks=[])).push(d,N)}T&&(m.preOrderHooks??(m.preOrderHooks=[])).push(0-d,T),A&&((m.preOrderHooks??(m.preOrderHooks=[])).push(d,A),(m.preOrderCheckHooks??(m.preOrderCheckHooks=[])).push(d,A))}(m,A[m],h)}finally{null!==X&&wo(X),Da(Z),N.resolving=!1,Ef()}}return T}function Mf(d,h,m){return!!(m[h+(d>>Ml)]&1<<d)}function Id(d,h){return!(d&In.Self||d&In.Host&&h)}class Wc{constructor(h,m){this._tNode=h,this._lView=m}get(h,m,x){return gh(this._tNode,this._lView,h,Zn(x),m)}}function yh(){return new Wc(Fo(),qt())}function Io(d){return $(()=>{const h=d.prototype.constructor,m=h[rt]||Df(h),x=Object.prototype;let T=Object.getPrototypeOf(d.prototype).constructor;for(;T&&T!==x;){const A=T[rt]||Df(T);if(A&&A!==m)return A;T=Object.getPrototypeOf(T)}return A=>new A})}function Df(d){return pn(d)?()=>{const h=Df(Ke(d));return h&&h()}:Xl(d)}function Pf(d){const h=d[Mn],m=h.type;return 2===m?h.declTNode:1===m?d[Qi]:null}function Yc(d){return function Up(d,h){if("class"===h)return d.classes;if("style"===h)return d.styles;const m=d.attrs;if(m){const x=m.length;let T=0;for(;T<x;){const A=m[T];if(rr(A))break;if(0===A)T+=2;else if("number"==typeof A)for(T++;T<x&&"string"==typeof m[T];)T++;else{if(A===h)return m[T+1];T+=2}}}return null}(Fo(),d)}const ku="__parameters__";function gn(d,h,m){return $(()=>{const x=function Ru(d){return function(...m){if(d){const x=d(...m);for(const T in x)this[T]=x[T]}}}(h);function T(...A){if(this instanceof T)return x.apply(this,A),this;const N=new T(...A);return Z.annotation=N,Z;function Z(X,oe,he){const Ie=X.hasOwnProperty(ku)?X[ku]:Object.defineProperty(X,ku,{value:[]})[ku];for(;Ie.length<=he;)Ie.push(null);return(Ie[he]=Ie[he]||[]).push(N),X}}return m&&(T.prototype=Object.create(m.prototype)),T.prototype.ngMetadataName=d,T.annotationCls=T,T})}class xr{constructor(h,m){this._desc=h,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof m?this.__NG_ELEMENT_ID__=m:void 0!==m&&(this.\u0275prov=vn({token:this,providedIn:m.providedIn||"root",factory:m.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Kc(d,h){d.forEach(m=>Array.isArray(m)?Kc(m,h):h(m))}function Gp(d,h,m){h>=d.length?d.push(m):d.splice(h,0,m)}function Xc(d,h){return h>=d.length-1?d.pop():d.splice(h,1)[0]}function Nu(d,h){const m=[];for(let x=0;x<d;x++)m.push(h);return m}function Mi(d,h,m){let x=c(d,h);return x>=0?d[1|x]=m:(x=~x,function Sd(d,h,m,x){let T=d.length;if(T==h)d.push(m,x);else if(1===T)d.push(x,d[0]),d[0]=m;else{for(T--,d.push(d[T-1],d[T]);T>h;)d[T]=d[T-2],T--;d[h]=m,d[h+1]=x}}(d,x,h,m)),x}function v(d,h){const m=c(d,h);if(m>=0)return d[1|m]}function c(d,h){return function C(d,h,m){let x=0,T=d.length>>m;for(;T!==x;){const A=x+(T-x>>1),N=d[A<<m];if(h===N)return A<<m;N>h?T=A:x=A+1}return~(T<<m)}(d,h,1)}const fe=Oi(gn("Inject",d=>({token:d})),-1),_e=Oi(gn("Optional"),8),ve=Oi(gn("SkipSelf"),4);var Fi=(()=>((Fi=Fi||{})[Fi.Important=1]="Important",Fi[Fi.DashCase=2]="DashCase",Fi))();const Wr=new Map;let Ys=0;const Zp="__ngContext__";function ds(d,h){Xo(h)?(d[Zp]=h[aa],function Al(d){Wr.set(d[aa],d)}(h)):d[Zp]=h}let Vu;function j(d,h){return Vu(d,h)}function R(d){const h=d[Ft];return Ji(h)?h[Ft]:h}function ye(d){return Gt(d[Ui])}function ct(d){return Gt(d[oi])}function Gt(d){for(;null!==d&&!Ji(d);)d=d[oi];return d}function Tn(d,h,m,x,T){if(null!=x){let A,N=!1;Ji(x)?A=x:Xo(x)&&(N=!0,x=x[Ms]);const Z=io(x);0===d&&null!==m?null==T?Kb(h,m,Z):Ph(h,m,Z,T||null,!0):1===d&&null!==m?Ph(h,m,Z,T||null,!0):2===d?function Xp(d,h,m){const x=Oh(d,h);x&&function Jn(d,h,m,x){d.removeChild(h,m,x)}(d,x,h,m)}(h,Z,N):3===d&&h.destroyNode(Z),null!=A&&function il(d,h,m,x,T){const A=m[yl];A!==io(m)&&Tn(h,d,x,A,T);for(let Z=Er;Z<m.length;Z++){const X=m[Z];Qp(X[Mn],X,d,h,x,A)}}(h,d,A,m,T)}}function ga(d,h,m){return d.createElement(h,m)}function cc(d,h){const m=d[Eo],x=m.indexOf(h),T=h[Ft];512&h[Ti]&&(h[Ti]&=-513,Bc(T,-1)),m.splice(x,1)}function Mh(d,h){if(d.length<=Er)return;const m=Er+h,x=d[m];if(x){const T=x[Vs];null!==T&&T!==d&&cc(T,x),h>0&&(d[m-1][oi]=x[oi]);const A=Xc(d,Er+h);!function tl(d,h){Qp(d,h,h[bi],2,null,null),h[Ms]=null,h[Qi]=null}(x[Mn],x);const N=A[Co];null!==N&&N.detachView(A[Mn]),x[Ft]=null,x[oi]=null,x[Ti]&=-65}return x}function Dh(d,h){if(!(128&h[Ti])){const m=h[bi];m.destroyNode&&Qp(d,h,m,3,null,null),function Ra(d){let h=d[Ui];if(!h)return Rf(d[Mn],d);for(;h;){let m=null;if(Xo(h))m=h[Ui];else{const x=h[Er];x&&(m=x)}if(!m){for(;h&&!h[oi]&&h!==d;)Xo(h)&&Rf(h[Mn],h),h=h[Ft];null===h&&(h=d),Xo(h)&&Rf(h[Mn],h),m=h&&h[oi]}h=m}}(h)}}function Rf(d,h){if(!(128&h[Ti])){h[Ti]&=-65,h[Ti]|=128,function Yp(d,h){let m;if(null!=d&&null!=(m=d.destroyHooks))for(let x=0;x<m.length;x+=2){const T=h[m[x]];if(!(T instanceof Au)){const A=m[x+1];if(Array.isArray(A))for(let N=0;N<A.length;N+=2){const Z=T[A[N]],X=A[N+1];Qo(4,Z,X);try{X.call(Z)}finally{Qo(5,Z,X)}}else{Qo(4,T,A);try{A.call(T)}finally{Qo(5,T,A)}}}}}(d,h),function Uu(d,h){const m=d.cleanup,x=h[Ds];let T=-1;if(null!==m)for(let A=0;A<m.length-1;A+=2)if("string"==typeof m[A]){const N=m[A+3];N>=0?x[T=N]():x[T=-N].unsubscribe(),A+=2}else{const N=x[T=m[A+1]];m[A].call(N)}if(null!==x){for(let A=T+1;A<x.length;A++)(0,x[A])();h[Ds]=null}}(d,h),1===h[Mn].type&&h[bi].destroy();const m=h[Vs];if(null!==m&&Ji(h[Ft])){m!==h[Ft]&&cc(m,h);const x=h[Co];null!==x&&x.detachView(d)}!function go(d){Wr.delete(d[aa])}(h)}}function Ah(d,h,m){return function Fa(d,h,m){let x=h;for(;null!==x&&40&x.type;)x=(h=x).parent;if(null===x)return m[Ms];{const{componentOffset:T}=x;if(T>-1){const{encapsulation:A}=d.data[x.directiveStart+T];if(A===Y.None||A===Y.Emulated)return null}return po(x,m)}}(d,h.parent,m)}function Ph(d,h,m,x,T){d.insertBefore(h,m,x,T)}function Kb(d,h,m){d.appendChild(h,m)}function Yr(d,h,m,x,T){null!==x?Ph(d,h,m,x,T):Kb(d,h,m)}function Oh(d,h){return d.parentNode(h)}function M_(d,h,m){return dc(d,h,m)}let ag,ju,yo,rl,dc=function kh(d,h,m){return 40&d.type?po(d,m):null};function Rh(d,h,m,x){const T=Ah(d,x,h),A=h[bi],Z=M_(x.parent||h[Qi],x,h);if(null!=T)if(Array.isArray(m))for(let X=0;X<m.length;X++)Yr(A,T,m[X],Z,!1);else Yr(A,T,m,Z,!1);void 0!==ag&&ag(A,x,h,m,T)}function hc(d,h){if(null!==h){const m=h.type;if(3&m)return po(h,d);if(4&m)return Kp(-1,d[h.index]);if(8&m){const x=h.child;if(null!==x)return hc(d,x);{const T=d[h.index];return Ji(T)?Kp(-1,T):io(T)}}if(32&m)return j(h,d)()||io(d[h.index]);{const x=Dd(d,h);return null!==x?Array.isArray(x)?x[0]:hc(R(d[cs]),x):hc(d,h.next)}}return null}function Dd(d,h){return null!==h?d[cs][Qi].projection[h.projection]:null}function Kp(d,h){const m=Er+d+1;if(m<h.length){const x=h[m],T=x[Mn].firstChild;if(null!==T)return hc(x,T)}return h[yl]}function D_(d,h,m,x,T,A,N){for(;null!=m;){const Z=x[m.index],X=m.type;if(N&&0===h&&(Z&&ds(io(Z),x),m.flags|=2),32!=(32&m.flags))if(8&X)D_(d,h,m.child,x,T,A,!1),Tn(h,d,T,Z,A);else if(32&X){const oe=j(m,x);let he;for(;he=oe();)Tn(h,d,T,he,A);Tn(h,d,T,Z,A)}else 16&X?Ff(d,h,x,m,T,A):Tn(h,d,T,Z,A);m=N?m.projectionNext:m.next}}function Qp(d,h,m,x,T,A){D_(m,x,d.firstChild,h,T,A,!1)}function Ff(d,h,m,x,T,A){const N=m[cs],X=N[Qi].projection[x.projection];if(Array.isArray(X))for(let oe=0;oe<X.length;oe++)Tn(h,d,T,X[oe],A);else D_(d,h,X,N[Ft],T,A,!0)}function Lf(d,h,m){""===m?d.removeAttribute(h,"class"):d.setAttribute(h,"class",m)}function Jp(d,h,m){const{mergedAttrs:x,classes:T,styles:A}=m;null!==x&&fn(d,h,x),null!==T&&Lf(d,h,T),null!==A&&function Na(d,h,m){d.setAttribute(h,"style",m)}(d,h,A)}function Gs(d){return function Nf(){if(void 0===ju&&(ju=null,hi.trustedTypes))try{ju=hi.trustedTypes.createPolicy("angular",{createHTML:d=>d,createScript:d=>d,createScriptURL:d=>d})}catch{}return ju}()?.createHTML(d)||d}function Xb(d){yo=d}function P_(){if(void 0===rl&&(rl=null,hi.trustedTypes))try{rl=hi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:d=>d,createScript:d=>d,createScriptURL:d=>d})}catch{}return rl}function Ov(d){return P_()?.createHTML(d)||d}function Rv(d){return P_()?.createScriptURL(d)||d}class Ol{constructor(h){this.changingThisBreaksApplicationSecurity=h}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${An})`}}class Qb extends Ol{getTypeName(){return"HTML"}}class Jb extends Ol{getTypeName(){return"Style"}}class Fv extends Ol{getTypeName(){return"Script"}}class O_ extends Ol{getTypeName(){return"URL"}}class Lv extends Ol{getTypeName(){return"ResourceURL"}}function Ks(d){return d instanceof Ol?d.changingThisBreaksApplicationSecurity:d}function fc(d,h){const m=function Nv(d){return d instanceof Ol&&d.getTypeName()||null}(d);if(null!=m&&m!==h){if("ResourceURL"===m&&"URL"===h)return!0;throw new Error(`Required a safe ${h}, got a ${m} (see ${An})`)}return m===h}function tm(d){return new Qb(d)}function zv(d){return new Jb(d)}function Lh(d){return new Fv(d)}function k_(d){return new O_(d)}function ya(d){return new Lv(d)}class Nh{constructor(h){this.inertDocumentHelper=h}getInertBodyElement(h){h="<body><remove></remove>"+h;try{const m=(new window.DOMParser).parseFromString(Gs(h),"text/html").body;return null===m?this.inertDocumentHelper.getInertBodyElement(h):(m.removeChild(m.firstChild),m)}catch{return null}}}class zf{constructor(h){this.defaultDoc=h,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(h){const m=this.inertDocument.createElement("template");return m.innerHTML=Gs(h),m}}const sl=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function nm(d){return(d=String(d)).match(sl)?d:"unsafe:"+d}function pc(d){const h={};for(const m of d.split(","))h[m]=!0;return h}function $u(...d){const h={};for(const m of d)for(const x in m)m.hasOwnProperty(x)&&(h[x]=!0);return h}const ex=pc("area,br,col,hr,img,wbr"),R_=pc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Rl=pc("rp,rt"),F_=$u(ex,$u(R_,pc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),$u(Rl,pc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),$u(Rl,R_)),im=pc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Gu=$u(im,pc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),pc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),cg=pc("script,style,template");class L_{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(h){let m=h.firstChild,x=!0;for(;m;)if(m.nodeType===Node.ELEMENT_NODE?x=this.startElement(m):m.nodeType===Node.TEXT_NODE?this.chars(m.nodeValue):this.sanitizedSomething=!0,x&&m.firstChild)m=m.firstChild;else for(;m;){m.nodeType===Node.ELEMENT_NODE&&this.endElement(m);let T=this.checkClobberedElement(m,m.nextSibling);if(T){m=T;break}m=this.checkClobberedElement(m,m.parentNode)}return this.buf.join("")}startElement(h){const m=h.nodeName.toLowerCase();if(!F_.hasOwnProperty(m))return this.sanitizedSomething=!0,!cg.hasOwnProperty(m);this.buf.push("<"),this.buf.push(m);const x=h.attributes;for(let T=0;T<x.length;T++){const A=x.item(T),N=A.name,Z=N.toLowerCase();if(!Gu.hasOwnProperty(Z)){this.sanitizedSomething=!0;continue}let X=A.value;im[Z]&&(X=nm(X)),this.buf.push(" ",N,'="',Bv(X),'"')}return this.buf.push(">"),!0}endElement(h){const m=h.nodeName.toLowerCase();F_.hasOwnProperty(m)&&!ex.hasOwnProperty(m)&&(this.buf.push("</"),this.buf.push(m),this.buf.push(">"))}chars(h){this.buf.push(Bv(h))}checkClobberedElement(h,m){if(m&&(h.compareDocumentPosition(m)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${h.outerHTML}`);return m}}const ug=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,om=/([^\#-~ |!])/g;function Bv(d){return d.replace(/&/g,"&amp;").replace(ug,function(h){return"&#"+(1024*(h.charCodeAt(0)-55296)+(h.charCodeAt(1)-56320)+65536)+";"}).replace(om,function(h){return"&#"+h.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let N_;function sm(d,h){let m=null;try{N_=N_||function ol(d){const h=new zf(d);return function kl(){try{return!!(new window.DOMParser).parseFromString(Gs(""),"text/html")}catch{return!1}}()?new Nh(h):h}(d);let x=h?String(h):"";m=N_.getInertBodyElement(x);let T=5,A=x;do{if(0===T)throw new Error("Failed to sanitize html because the input is unstable");T--,x=A,A=m.innerHTML,m=N_.getInertBodyElement(x)}while(x!==A);return Gs((new L_).sanitizeChildren(Vv(m)||m))}finally{if(m){const x=Vv(m)||m;for(;x.firstChild;)x.removeChild(x.firstChild)}}}function Vv(d){return"content"in d&&function dg(d){return d.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===d.nodeName}(d)?d.content:null}var es=(()=>((es=es||{})[es.NONE=0]="NONE",es[es.HTML=1]="HTML",es[es.STYLE=2]="STYLE",es[es.SCRIPT=3]="SCRIPT",es[es.URL=4]="URL",es[es.RESOURCE_URL=5]="RESOURCE_URL",es))();function ix(d){const h=am();return h?Ov(h.sanitize(es.HTML,d)||""):fc(d,"HTML")?Ov(Ks(d)):sm(function em(){return void 0!==yo?yo:typeof document<"u"?document:void 0}(),kt(d))}function Ad(d){const h=am();return h?h.sanitize(es.URL,d)||"":fc(d,"URL")?Ks(d):nm(kt(d))}function al(d){const h=am();if(h)return Rv(h.sanitize(es.RESOURCE_URL,d)||"");if(fc(d,"ResourceURL"))return Rv(Ks(d));throw new vt(904,!1)}function Fl(d,h,m){return function qu(d,h){return"src"===h&&("embed"===d||"frame"===d||"iframe"===d||"media"===d||"script"===d)||"href"===h&&("base"===d||"link"===d)?al:Ad}(h,m)(d)}function am(){const d=qt();return d&&d[jo]}const So=new xr("ENVIRONMENT_INITIALIZER"),Uf=new xr("INJECTOR",-1),jf=new xr("INJECTOR_DEF_TYPES");class z_{get(h,m=Mr){if(m===Mr){const x=new Error(`NullInjectorError: No provider for ${yt(h)}!`);throw x.name="NullInjectorError",x}return m}}function $f(...d){return{\u0275providers:rx(0,d),\u0275fromNgModule:!0}}function rx(d,...h){const m=[],x=new Set;let T;return Kc(h,A=>{const N=A;V_(N,m,[],x)&&(T||(T=[]),T.push(N))}),void 0!==T&&B_(T,m),m}function B_(d,h){for(let m=0;m<d.length;m++){const{providers:T}=d[m];nu(T,A=>{h.push(A)})}}function V_(d,h,m,x){if(!(d=Ke(d)))return!1;let T=null,A=co(d);const N=!A&&Zi(d);if(A||N){if(N&&!N.standalone)return!1;T=d}else{const X=d.ngModule;if(A=co(X),!A)return!1;T=X}const Z=x.has(T);if(N){if(Z)return!1;if(x.add(T),N.dependencies){const X="function"==typeof N.dependencies?N.dependencies():N.dependencies;for(const oe of X)V_(oe,h,m,x)}}else{if(!A)return!1;{if(null!=A.imports&&!Z){let oe;x.add(T);try{Kc(A.imports,he=>{V_(he,h,m,x)&&(oe||(oe=[]),oe.push(he))})}finally{}void 0!==oe&&B_(oe,h)}if(!Z){const oe=Xl(T)||(()=>new T);h.push({provide:T,useFactory:oe,deps:pe},{provide:jf,useValue:T,multi:!0},{provide:So,useValue:()=>cn(T),multi:!0})}const X=A.providers;null==X||Z||nu(X,he=>{h.push(he)})}}return T!==d&&void 0!==d.providers}function nu(d,h){for(let m of d)nn(m)&&(m=m.\u0275providers),Array.isArray(m)?nu(m,h):h(m)}const Gf=ft({provide:String,useValue:ft});function fg(d){return null!==d&&"object"==typeof d&&Gf in d}function iu(d){return"function"==typeof d}const U_=new xr("Set Injector scope."),j_={},Uv={};let jv;function um(){return void 0===jv&&(jv=new z_),jv}class Bh{}class $v extends Bh{get destroyed(){return this._destroyed}constructor(h,m,x,T){super(),this.parent=m,this.source=x,this.scopes=T,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Hv(h,N=>this.processProvider(N)),this.records.set(Uf,ru(void 0,this)),T.has("environment")&&this.records.set(Bh,ru(void 0,this));const A=this.records.get(U_);null!=A&&"string"==typeof A.value&&this.scopes.add(A.value),this.injectorDefTypes=new Set(this.get(jf.multi,pe,In.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const h of this._ngOnDestroyHooks)h.ngOnDestroy();for(const h of this._onDestroyHooks)h()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(h){this._onDestroyHooks.push(h)}runInContext(h){this.assertNotDestroyed();const m=ho(this),x=wo(void 0);try{return h()}finally{ho(m),wo(x)}}get(h,m=Mr,x=In.Default){this.assertNotDestroyed(),x=Zn(x);const T=ho(this),A=wo(void 0);try{if(!(x&In.SkipSelf)){let Z=this.records.get(h);if(void 0===Z){const X=function G_(d){return"function"==typeof d||"object"==typeof d&&d instanceof xr}(h)&&dr(h);Z=X&&this.injectableDefInScope(X)?ru(Pd(h),j_):null,this.records.set(h,Z)}if(null!=Z)return this.hydrate(h,Z)}return(x&In.Self?um():this.parent).get(h,m=x&In.Optional&&m===Mr?null:m)}catch(N){if("NullInjectorError"===N.name){if((N[Oo]=N[Oo]||[]).unshift(yt(h)),T)throw N;return function ze(d,h,m,x){const T=d[Oo];throw h[Bs]&&T.unshift(h[Bs]),d.message=function ne(d,h,m,x=null){d=d&&"\n"===d.charAt(0)&&d.charAt(1)==wi?d.slice(2):d;let T=yt(h);if(Array.isArray(h))T=h.map(yt).join(" -> ");else if("object"==typeof h){let A=[];for(let N in h)if(h.hasOwnProperty(N)){let Z=h[N];A.push(N+":"+("string"==typeof Z?JSON.stringify(Z):yt(Z)))}T=`{${A.join(", ")}}`}return`${m}${x?"("+x+")":""}[${T}]: ${d.replace(_s,"\n  ")}`}("\n"+d.message,T,m,x),d[uo]=T,d[Oo]=null,d}(N,h,"R3InjectorError",this.source)}throw N}finally{wo(A),ho(T)}}resolveInjectorInitializers(){const h=ho(this),m=wo(void 0);try{const x=this.get(So.multi,pe,In.Self);for(const T of x)T()}finally{ho(h),wo(m)}}toString(){const h=[],m=this.records;for(const x of m.keys())h.push(yt(x));return`R3Injector[${h.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new vt(205,!1)}processProvider(h){let m=iu(h=Ke(h))?h:Ke(h&&h.provide);const x=function sx(d){return fg(d)?ru(void 0,d.useValue):ru(Hf(d),j_)}(h);if(iu(h)||!0!==h.multi)this.records.get(m);else{let T=this.records.get(m);T||(T=ru(void 0,j_,!0),T.factory=()=>ti(T.multi),this.records.set(m,T)),m=h,T.multi.push(h)}this.records.set(m,x)}hydrate(h,m){return m.value===j_&&(m.value=Uv,m.value=m.factory()),"object"==typeof m.value&&m.value&&function $_(d){return null!==d&&"object"==typeof d&&"function"==typeof d.ngOnDestroy}(m.value)&&this._ngOnDestroyHooks.add(m.value),m.value}injectableDefInScope(h){if(!h.providedIn)return!1;const m=Ke(h.providedIn);return"string"==typeof m?"any"===m||this.scopes.has(m):this.injectorDefTypes.has(m)}}function Pd(d){const h=dr(d),m=null!==h?h.factory:Xl(d);if(null!==m)return m;if(d instanceof xr)throw new vt(204,!1);if(d instanceof Function)return function ox(d){const h=d.length;if(h>0)throw Nu(h,"?"),new vt(204,!1);const m=function lo(d){const h=d&&(d[Ss]||d[Sr]);return h?(function Is(d){if(d.hasOwnProperty("name"))return d.name;(""+d).match(/^function\s*([^\s(]+)/)}(d),h):null}(d);return null!==m?()=>m.factory(d):()=>new d}(d);throw new vt(204,!1)}function Hf(d,h,m){let x;if(iu(d)){const T=Ke(d);return Xl(T)||Pd(T)}if(fg(d))x=()=>Ke(d.useValue);else if(function lm(d){return!(!d||!d.useFactory)}(d))x=()=>d.useFactory(...ti(d.deps||[]));else if(function pg(d){return!(!d||!d.useExisting)}(d))x=()=>cn(Ke(d.useExisting));else{const T=Ke(d&&(d.useClass||d.provide));if(!function Gv(d){return!!d.deps}(d))return Xl(T)||Pd(T);x=()=>new T(...ti(d.deps))}return x}function ru(d,h,m=!1){return{factory:d,value:h,multi:m?[]:void 0}}function Hv(d,h){for(const m of d)Array.isArray(m)?Hv(m,h):m&&nn(m)?Hv(m.\u0275providers,h):h(m)}class ax{}class lx{}class qv{resolveComponentFactory(h){throw function cx(d){const h=Error(`No component factory found for ${yt(d)}. Did you add it to @NgModule.entryComponents?`);return h.ngComponent=d,h}(h)}}let Od=(()=>{class d{}return d.NULL=new qv,d})();function gg(){return kd(Fo(),qt())}function kd(d,h){return new Qs(po(d,h))}let Qs=(()=>{class d{constructor(m){this.nativeElement=m}}return d.__NG_ELEMENT_ID__=gg,d})();function Ba(d){return d instanceof Qs?d.nativeElement:d}class ux{}let Zv=(()=>{class d{}return d.__NG_ELEMENT_ID__=()=>function V1(){const d=qt(),m=di(Fo().index,d);return(Xo(m)?m:d)[bi]}(),d})(),U1=(()=>{class d{}return d.\u0275prov=vn({token:d,providedIn:"root",factory:()=>null}),d})();class dx{constructor(h){this.full=h,this.major=h.split(".")[0],this.minor=h.split(".")[1],this.patch=h.split(".").slice(2).join(".")}}const Vh=new dx("15.2.6"),dm={},H_="ngOriginalError";function Zf(d){return d[H_]}class _g{constructor(){this._console=console}handleError(h){const m=this._findOriginalError(h);this._console.error("ERROR",h),m&&this._console.error("ORIGINAL ERROR",m)}_findOriginalError(h){let m=h&&Zf(h);for(;m&&Zf(m);)m=Zf(m);return m||null}}function Wv(d){return d.ownerDocument.defaultView}function Va(d){return d instanceof Function?d():d}function Yf(d,h,m){let x=d.length;for(;;){const T=d.indexOf(h,m);if(-1===T)return T;if(0===T||d.charCodeAt(T-1)<=32){const A=h.length;if(T+A===x||d.charCodeAt(T+A)<=32)return T}m=T+1}}const vg="ng-template";function Xv(d,h,m){let x=0,T=!0;for(;x<d.length;){let A=d[x++];if("string"==typeof A&&T){const N=d[x++];if(m&&"class"===A&&-1!==Yf(N.toLowerCase(),h,0))return!0}else{if(1===A){for(;x<d.length&&"string"==typeof(A=d[x++]);)if(A.toLowerCase()===h)return!0;return!1}"number"==typeof A&&(T=!1)}}return!1}function ou(d){return 4===d.type&&d.value!==vg}function bg(d,h,m){return h===(4!==d.type||m?d.value:vg)}function Qv(d,h,m){let x=4;const T=d.attrs||[],A=function q_(d){for(let h=0;h<d.length;h++)if(rr(d[h]))return h;return d.length}(T);let N=!1;for(let Z=0;Z<h.length;Z++){const X=h[Z];if("number"!=typeof X){if(!N)if(4&x){if(x=2|1&x,""!==X&&!bg(d,X,m)||""===X&&1===h.length){if(mc(x))return!1;N=!0}}else{const oe=8&x?X:h[++Z];if(8&x&&null!==d.attrs){if(!Xv(d.attrs,oe,m)){if(mc(x))return!1;N=!0}continue}const Ie=xg(8&x?"class":X,T,ou(d),m);if(-1===Ie){if(mc(x))return!1;N=!0;continue}if(""!==oe){let Ze;Ze=Ie>A?"":T[Ie+1].toLowerCase();const ut=8&x?Ze:null;if(ut&&-1!==Yf(ut,oe,0)||2&x&&oe!==Ze){if(mc(x))return!1;N=!0}}}}else{if(!N&&!mc(x)&&!mc(X))return!1;if(N&&mc(X))continue;N=!1,x=X|1&x}}return mc(x)||N}function mc(d){return 0==(1&d)}function xg(d,h,m,x){if(null===h)return-1;let T=0;if(x||!m){let A=!1;for(;T<h.length;){const N=h[T];if(N===d)return T;if(3===N||6===N)A=!0;else{if(1===N||2===N){let Z=h[++T];for(;"string"==typeof Z;)Z=h[++T];continue}if(4===N)break;if(0===N){T+=4;continue}}T+=A?1:2}return-1}return function Z1(d,h){let m=d.indexOf(4);if(m>-1)for(m++;m<d.length;){const x=d[m];if("number"==typeof x)return-1;if(x===h)return m;m++}return-1}(h,d)}function Rd(d,h,m=!1){for(let x=0;x<h.length;x++)if(Qv(d,h[x],m))return!0;return!1}function Jv(d,h){e:for(let m=0;m<h.length;m++){const x=h[m];if(d.length===x.length){for(let T=0;T<d.length;T++)if(d[T]!==x[T])continue e;return!0}}return!1}function Z_(d,h){return d?":not("+h.trim()+")":h}function W_(d){let h=d[0],m=1,x=2,T="",A=!1;for(;m<d.length;){let N=d[m];if("string"==typeof N)if(2&x){const Z=d[++m];T+="["+N+(Z.length>0?'="'+Z+'"':"")+"]"}else 8&x?T+="."+N:4&x&&(T+=" "+N);else""!==T&&!mc(N)&&(h+=Z_(A,T),T=""),x=N,A=A||!mc(x);m++}return""!==T&&(h+=Z_(A,T)),h}const Bi={};function gx(d){K_(ji(),qt(),vs()+d,!1)}function K_(d,h,m,x){if(!x)if(3==(3&h[Ti])){const A=d.preOrderCheckHooks;null!==A&&yd(h,A,m)}else{const A=d.preOrderHooks;null!==A&&ic(h,A,0,m)}As(m)}function Q_(d,h=null,m=null,x){const T=X1(d,h,m,x);return T.resolveInjectorInitializers(),T}function X1(d,h=null,m=null,x,T=new Set){const A=[m||pe,$f(d)];return x=x||("object"==typeof d?void 0:yt(d)),new $v(A,h||um(),x||null,T)}let hm=(()=>{class d{static create(m,x){if(Array.isArray(m))return Q_({name:""},x,m,"");{const T=m.name??"";return Q_({name:T},m.parent,m.providers,T)}}}return d.THROW_IF_NOT_FOUND=Mr,d.NULL=new z_,d.\u0275prov=vn({token:d,providedIn:"any",factory:()=>cn(Uf)}),d.__NG_ELEMENT_ID__=-1,d})();function _m(d,h=In.Default){const m=qt();return null===m?cn(d,h):gh(Fo(),m,Ke(d),h)}function Ix(){throw new Error("invalid")}function Sx(d,h){const m=d.contentQueries;if(null!==m)for(let x=0;x<m.length;x+=2){const A=m[x+1];if(-1!==A){const N=d.data[A];Lp(m[x]),N.contentQueries(2,h[A],A)}}}function ny(d,h,m,x,T,A,N,Z,X,oe,he){const Ie=h.blueprint.slice();return Ie[Ms]=T,Ie[Ti]=76|x,(null!==he||d&&1024&d[Ti])&&(Ie[Ti]|=1024),oh(Ie),Ie[Ft]=Ie[fo]=d,Ie[Gn]=m,Ie[_l]=N||d&&d[_l],Ie[bi]=Z||d&&d[bi],Ie[jo]=X||d&&d[jo]||null,Ie[Ro]=oe||d&&d[Ro]||null,Ie[Qi]=A,Ie[aa]=function ma(){return Ys++}(),Ie[Ac]=he,Ie[cs]=2==h.type?d[cs]:Ie,Ie}function gc(d,h,m,x,T){let A=d.data[h];if(null===A)A=function Tg(d,h,m,x,T){const A=Wa(),N=Vc(),X=d.data[h]=function rC(d,h,m,x,T,A){return{type:m,index:x,insertBeforeIndex:null,injectorIndex:h?h.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:T,attrs:A,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:h,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,N?A:A&&A.parent,m,h,x,T);return null===d.firstChild&&(d.firstChild=X),null!==A&&(N?null==A.child&&null!==X.parent&&(A.child=X):null===A.next&&(A.next=X,X.prev=A)),X}(d,h,m,x,T),function uh(){return Ii.lFrame.inI18n}()&&(A.flags|=32);else if(64&A.type){A.type=m,A.value=x,A.attrs=T;const N=function wl(){const d=Ii.lFrame,h=d.currentTNode;return d.isParent?h:h.parent}();A.injectorIndex=null===N?-1:N.injectorIndex}return Ya(A,!0),A}function Ig(d,h,m,x){if(0===m)return-1;const T=h.length;for(let A=0;A<m;A++)h.push(x),d.blueprint.push(x),d.data.push(null);return T}function o0(d,h,m){wf(h);try{const x=d.viewQuery;null!==x&&dy(1,x,m);const T=d.template;null!==T&&Mx(d,h,T,1,m),d.firstCreatePass&&(d.firstCreatePass=!1),d.staticContentQueries&&Sx(d,h),d.staticViewQueries&&dy(2,d.viewQuery,m);const A=d.components;null!==A&&function iC(d,h){for(let m=0;m<h.length;m++)Mg(d,h[m])}(h,A)}catch(x){throw d.firstCreatePass&&(d.incompleteFirstPass=!0,d.firstCreatePass=!1),x}finally{h[Ti]&=-5,Tf()}}function iy(d,h,m,x){const T=h[Ti];if(128!=(128&T)){wf(h);try{oh(h),function kp(d){return Ii.lFrame.bindingIndex=d}(d.bindingStartIndex),null!==m&&Mx(d,h,m,2,x);const N=3==(3&T);if(N){const oe=d.preOrderCheckHooks;null!==oe&&yd(h,oe,null)}else{const oe=d.preOrderHooks;null!==oe&&ic(h,oe,0,null),El(h,0)}if(function zx(d){for(let h=ye(d);null!==h;h=ct(h)){if(!h[to])continue;const m=h[Eo];for(let x=0;x<m.length;x++){const T=m[x];512&T[Ti]||Bc(T[Ft],1),T[Ti]|=512}}}(h),function Nx(d){for(let h=ye(d);null!==h;h=ct(h))for(let m=Er;m<h.length;m++){const x=h[m],T=x[Mn];ec(x)&&iy(T,x,T.template,x[Gn])}}(h),null!==d.contentQueries&&Sx(d,h),N){const oe=d.contentCheckHooks;null!==oe&&yd(h,oe)}else{const oe=d.contentHooks;null!==oe&&ic(h,oe,1),El(h,1)}!function nC(d,h){const m=d.hostBindingOpCodes;if(null!==m)try{for(let x=0;x<m.length;x++){const T=m[x];if(T<0)As(~T);else{const A=T,N=m[++x],Z=m[++x];tc(N,A),Z(2,h[A])}}}finally{As(-1)}}(d,h);const Z=d.components;null!==Z&&function Eg(d,h){for(let m=0;m<h.length;m++)uy(d,h[m])}(h,Z);const X=d.viewQuery;if(null!==X&&dy(2,X,x),N){const oe=d.viewCheckHooks;null!==oe&&yd(h,oe)}else{const oe=d.viewHooks;null!==oe&&ic(h,oe,2),El(h,2)}!0===d.firstUpdatePass&&(d.firstUpdatePass=!1),h[Ti]&=-41,512&h[Ti]&&(h[Ti]&=-513,Bc(h[Ft],-1))}finally{Tf()}}}function Mx(d,h,m,x,T){const A=vs(),N=2&x;try{As(-1),N&&h.length>yi&&K_(d,h,yi,!1),Qo(N?2:0,T),m(x,T)}finally{As(A),Qo(N?3:1,T)}}function ry(d,h,m){if(Pc(h)){const T=h.directiveEnd;for(let A=h.directiveStart;A<T;A++){const N=d.data[A];N.contentQueries&&N.contentQueries(1,m[A],A)}}}function Sg(d,h,m){Pp()&&(function ep(d,h,m,x){const T=m.directiveStart,A=m.directiveEnd;Oc(m)&&function oC(d,h,m){const x=po(h,d),T=Kr(m),A=d[_l],N=Ld(d,ny(d,T,null,m.onPush?32:16,x,h,A,A.createRenderer(x,m),null,null,null));d[h.index]=N}(h,m,d.data[T+m.componentOffset]),d.firstCreatePass||Dl(m,h),ds(x,h);const N=m.initialInputs;for(let Z=T;Z<A;Z++){const X=d.data[Z],oe=da(h,d,Z,m);ds(oe,h),null!==N&&$h(0,Z-T,oe,X,0,N),Br(X)&&(di(m.index,h)[Gn]=da(h,d,Z,m))}}(d,h,m,po(m,h)),64==(64&m.flags)&&ly(d,h,m))}function Fd(d,h,m=po){const x=h.localNames;if(null!==x){let T=h.index+1;for(let A=0;A<x.length;A+=2){const N=x[A+1],Z=-1===N?m(h,d):d[N];d[T++]=Z}}}function Kr(d){const h=d.tView;return null===h||h.incompleteFirstPass?d.tView=_c(1,null,d.template,d.decls,d.vars,d.directiveDefs,d.pipeDefs,d.viewQuery,d.schemas,d.consts):h}function _c(d,h,m,x,T,A,N,Z,X,oe){const he=yi+x,Ie=he+T,Ze=function oy(d,h){const m=[];for(let x=0;x<h;x++)m.push(x<d?null:Bi);return m}(he,Ie),ut="function"==typeof oe?oe():oe;return Ze[Mn]={type:d,blueprint:Ze,template:m,queries:null,viewQuery:Z,declTNode:h,data:Ze.slice().fill(null,he),bindingStartIndex:he,expandoStartIndex:Ie,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof A?A():A,pipeRegistry:"function"==typeof N?N():N,firstChild:null,schemas:X,consts:ut,incompleteFirstPass:!1}}function Jf(d,h,m,x){const T=Bx(h);null===m?T.push(x):(T.push(m),d.firstCreatePass&&hy(d).push(x,T.length-1))}function ym(d,h,m,x){for(let T in d)if(d.hasOwnProperty(T)){m=null===m?{}:m;const A=d[T];null===x?vm(m,h,T,A):x.hasOwnProperty(T)&&vm(m,h,x[T],A)}return m}function vm(d,h,m,x){d.hasOwnProperty(m)?d[m].push(h,x):d[m]=[h,x]}function Ar(d,h,m,x,T,A,N,Z){const X=po(h,m);let he,oe=h.inputs;!Z&&null!=oe&&(he=oe[x])?(Gh(d,m,he,x,T),Oc(h)&&Yu(m,h.index)):3&h.type&&(x=function Dx(d){return"class"===d?"className":"for"===d?"htmlFor":"formaction"===d?"formAction":"innerHtml"===d?"innerHTML":"readonly"===d?"readOnly":"tabindex"===d?"tabIndex":d}(x),T=null!=N?N(T,h.value||"",x):T,A.setProperty(X,x,T))}function Yu(d,h){const m=di(h,d);16&m[Ti]||(m[Ti]|=32)}function bm(d,h,m,x){if(Pp()){const T=null===x?null:{"":-1},A=function Ox(d,h){const m=d.directiveRegistry;let x=null,T=null;if(m)for(let A=0;A<m.length;A++){const N=m[A];if(Rd(h,N.selectors,!1))if(x||(x=[]),Br(N))if(null!==N.findHostDirectiveDefs){const Z=[];T=T||new Map,N.findHostDirectiveDefs(N,Z,T),x.unshift(...Z,N),xm(d,h,Z.length)}else x.unshift(N),xm(d,h,0);else T=T||new Map,N.findHostDirectiveDefs?.(N,x,T),x.push(N)}return null===x?null:[x,T]}(d,m);let N,Z;null===A?N=Z=null:[N,Z]=A,null!==N&&ay(d,h,m,N,T,Z),T&&function kx(d,h,m){if(h){const x=d.localNames=[];for(let T=0;T<h.length;T+=2){const A=m[h[T+1]];if(null==A)throw new vt(-301,!1);x.push(h[T],A)}}}(m,x,T)}m.mergedAttrs=Ma(m.mergedAttrs,m.attrs)}function ay(d,h,m,x,T,A){for(let oe=0;oe<x.length;oe++)Pu(Dl(m,h),d,x[oe].type);!function Fx(d,h,m){d.flags|=1,d.directiveStart=h,d.directiveEnd=h+m,d.providerIndexes=h}(m,d.data.length,x.length);for(let oe=0;oe<x.length;oe++){const he=x[oe];he.providersResolver&&he.providersResolver(he)}let N=!1,Z=!1,X=Ig(d,h,x.length,null);for(let oe=0;oe<x.length;oe++){const he=x[oe];m.mergedAttrs=Ma(m.mergedAttrs,he.hostAttrs),Lx(d,m,h,X,he),Rx(X,he,T),null!==he.contentQueries&&(m.flags|=4),(null!==he.hostBindings||null!==he.hostAttrs||0!==he.hostVars)&&(m.flags|=64);const Ie=he.type.prototype;!N&&(Ie.ngOnChanges||Ie.ngOnInit||Ie.ngDoCheck)&&((d.preOrderHooks??(d.preOrderHooks=[])).push(m.index),N=!0),!Z&&(Ie.ngOnChanges||Ie.ngDoCheck)&&((d.preOrderCheckHooks??(d.preOrderCheckHooks=[])).push(m.index),Z=!0),X++}!function jh(d,h,m){const T=h.directiveEnd,A=d.data,N=h.attrs,Z=[];let X=null,oe=null;for(let he=h.directiveStart;he<T;he++){const Ie=A[he],Ze=m?m.get(Ie):null,Lt=Ze?Ze.outputs:null;X=ym(Ie.inputs,he,X,Ze?Ze.inputs:null),oe=ym(Ie.outputs,he,oe,Lt);const hn=null===X||null===N||ou(h)?null:a0(X,he,N);Z.push(hn)}null!==X&&(X.hasOwnProperty("class")&&(h.flags|=8),X.hasOwnProperty("style")&&(h.flags|=16)),h.initialInputs=Z,h.inputs=X,h.outputs=oe}(d,m,A)}function ly(d,h,m){const x=m.directiveStart,T=m.directiveEnd,A=m.index,N=function Fp(){return Ii.lFrame.currentDirectiveIndex}();try{As(A);for(let Z=x;Z<T;Z++){const X=d.data[Z],oe=h[Z];Ia(Z),(null!==X.hostBindings||0!==X.hostVars||null!==X.hostAttrs)&&Px(X,oe)}}finally{As(-1),Ia(N)}}function Px(d,h){null!==d.hostBindings&&d.hostBindings(1,h)}function xm(d,h,m){h.componentOffset=m,(d.components??(d.components=[])).push(h.index)}function Rx(d,h,m){if(m){if(h.exportAs)for(let x=0;x<h.exportAs.length;x++)m[h.exportAs[x]]=d;Br(h)&&(m[""]=d)}}function Lx(d,h,m,x,T){d.data[x]=T;const A=T.factory||(T.factory=Xl(T.type)),N=new Au(A,Br(T),_m);d.blueprint[x]=N,m[x]=N,function s0(d,h,m,x,T){const A=T.hostBindings;if(A){let N=d.hostBindingOpCodes;null===N&&(N=d.hostBindingOpCodes=[]);const Z=~h.index;(function Ku(d){let h=d.length;for(;h>0;){const m=d[--h];if("number"==typeof m&&m<0)return m}return 0})(N)!=Z&&N.push(Z),N.push(m,x,A)}}(d,h,x,Ig(d,m,T.hostVars,Bi),T)}function su(d,h,m,x,T,A){const N=po(d,h);!function tp(d,h,m,x,T,A,N){if(null==A)d.removeAttribute(h,T,m);else{const Z=null==N?kt(A):N(A,x||"",T);d.setAttribute(h,T,Z,m)}}(h[bi],N,A,d.value,m,x,T)}function $h(d,h,m,x,T,A){const N=A[h];if(null!==N){const Z=x.setInput;for(let X=0;X<N.length;){const oe=N[X++],he=N[X++],Ie=N[X++];null!==Z?x.setInput(m,Ie,oe,he):m[he]=Ie}}}function a0(d,h,m){let x=null,T=0;for(;T<m.length;){const A=m[T];if(0!==A)if(5!==A){if("number"==typeof A)break;if(d.hasOwnProperty(A)){null===x&&(x=[]);const N=d[A];for(let Z=0;Z<N.length;Z+=2)if(N[Z]===h){x.push(A,N[Z+1],m[T+1]);break}}T+=2}else T+=2;else T+=4}return x}function cy(d,h,m,x){return[d,!0,!1,h,null,0,x,m,null,null]}function uy(d,h){const m=di(h,d);if(ec(m)){const x=m[Mn];48&m[Ti]?iy(x,m,x.template,m[Gn]):m[gi]>0&&np(m)}}function np(d){for(let x=ye(d);null!==x;x=ct(x))for(let T=Er;T<x.length;T++){const A=x[T];if(ec(A))if(512&A[Ti]){const N=A[Mn];iy(N,A,N.template,A[Gn])}else A[gi]>0&&np(A)}const m=d[Mn].components;if(null!==m)for(let x=0;x<m.length;x++){const T=di(m[x],d);ec(T)&&T[gi]>0&&np(T)}}function Mg(d,h){const m=di(h,d),x=m[Mn];(function ll(d,h){for(let m=h.length;m<d.blueprint.length;m++)h.push(d.blueprint[m])})(x,m),o0(x,m,m[Gn])}function Ld(d,h){return d[Ui]?d[cd][oi]=h:d[Ui]=h,d[cd]=h,h}function Nd(d){for(;d;){d[Ti]|=32;const h=R(d);if(gu(d)&&!h)return d;d=h}return null}function xs(d,h,m,x=!0){const T=h[_l];T.begin&&T.begin();try{iy(d,h,d.template,m)}catch(N){throw x&&Ag(h,N),N}finally{T.end&&T.end()}}function dy(d,h,m){Lp(0),h(d,m)}function Bx(d){return d[Ds]||(d[Ds]=[])}function hy(d){return d.cleanup||(d.cleanup=[])}function Ag(d,h){const m=d[Ro],x=m?m.get(_g,null):null;x&&x.handleError(h)}function Gh(d,h,m,x,T){for(let A=0;A<m.length;){const N=m[A++],Z=m[A++],X=h[N],oe=d.data[N];null!==oe.setInput?oe.setInput(X,T,x,Z):X[Z]=T}}function wm(d,h,m){let x=m?d.styles:null,T=m?d.classes:null,A=0;if(null!==h)for(let N=0;N<h.length;N++){const Z=h[N];"number"==typeof Z?A=Z:1==A?T=It(T,Z):2==A&&(x=It(x,Z+": "+h[++N]+";"))}m?d.styles=x:d.stylesWithoutHost=x,m?d.classes=T:d.classesWithoutHost=T}function Pg(d,h,m,x,T=!1){for(;null!==m;){const A=h[m.index];if(null!==A&&x.push(io(A)),Ji(A))for(let Z=Er;Z<A.length;Z++){const X=A[Z],oe=X[Mn].firstChild;null!==oe&&Pg(X[Mn],X,oe,x)}const N=m.type;if(8&N)Pg(d,h,m.child,x);else if(32&N){const Z=j(m,h);let X;for(;X=Z();)x.push(X)}else if(16&N){const Z=Dd(h,m);if(Array.isArray(Z))x.push(...Z);else{const X=R(h[cs]);Pg(X[Mn],X,Z,x,!0)}}m=T?m.projectionNext:m.next}return x}class yc{get rootNodes(){const h=this._lView,m=h[Mn];return Pg(m,h,m.firstChild,[])}constructor(h,m){this._lView=h,this._cdRefInjectingView=m,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Gn]}set context(h){this._lView[Gn]=h}get destroyed(){return 128==(128&this._lView[Ti])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const h=this._lView[Ft];if(Ji(h)){const m=h[Kl],x=m?m.indexOf(this):-1;x>-1&&(Mh(h,x),Xc(m,x))}this._attachedToViewContainer=!1}Dh(this._lView[Mn],this._lView)}onDestroy(h){Jf(this._lView[Mn],this._lView,null,h)}markForCheck(){Nd(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ti]&=-65}reattach(){this._lView[Ti]|=64}detectChanges(){xs(this._lView[Mn],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new vt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function lc(d,h){Qp(d,h,h[bi],2,null,null)}(this._lView[Mn],this._lView)}attachToAppRef(h){if(this._attachedToViewContainer)throw new vt(902,!1);this._appRef=h}}class sC extends yc{constructor(h){super(h),this._view=h}detectChanges(){const h=this._view;xs(h[Mn],h,h[Gn],!1)}checkNoChanges(){}get context(){return null}}class Vx extends Od{constructor(h){super(),this.ngModule=h}resolveComponentFactory(h){const m=Zi(h);return new fy(m,this.ngModule)}}function Ux(d){const h=[];for(let m in d)d.hasOwnProperty(m)&&h.push({propName:d[m],templateName:m});return h}class ZT{constructor(h,m){this.injector=h,this.parentInjector=m}get(h,m,x){x=Zn(x);const T=this.injector.get(h,dm,x);return T!==dm||m===dm?T:this.parentInjector.get(h,m,x)}}class fy extends lx{get inputs(){return Ux(this.componentDef.inputs)}get outputs(){return Ux(this.componentDef.outputs)}constructor(h,m){super(),this.componentDef=h,this.ngModule=m,this.componentType=h.type,this.selector=function W1(d){return d.map(W_).join(",")}(h.selectors),this.ngContentSelectors=h.ngContentSelectors?h.ngContentSelectors:[],this.isBoundToModule=!!m}create(h,m,x,T){let A=(T=T||this.ngModule)instanceof Bh?T:T?.injector;A&&null!==this.componentDef.getStandaloneInjector&&(A=this.componentDef.getStandaloneInjector(A)||A);const N=A?new ZT(h,A):h,Z=N.get(ux,null);if(null===Z)throw new vt(407,!1);const X=N.get(U1,null),oe=Z.createRenderer(null,this.componentDef),he=this.componentDef.selectors[0][0]||"div",Ie=x?function sy(d,h,m){return d.selectRootElement(h,m===Y.ShadowDom)}(oe,x,this.componentDef.encapsulation):ga(oe,he,function aC(d){const h=d.toLowerCase();return"svg"===h?wu:"math"===h?"math":null}(he)),Ze=this.componentDef.onPush?288:272,ut=_c(0,null,null,1,0,null,null,null,null,null),Lt=ny(null,ut,null,Ze,null,null,Z,oe,X,N,null);let hn,Fn;wf(Lt);try{const Kn=this.componentDef;let _i,Zt=null;Kn.findHostDirectiveDefs?(_i=[],Zt=new Map,Kn.findHostDirectiveDefs(Kn,_i,Zt),_i.push(Kn)):_i=[Kn];const Vi=function Og(d,h){const m=d[Mn],x=yi;return d[x]=h,gc(m,x,2,"#host",null)}(Lt,Ie),Zo=function Gx(d,h,m,x,T,A,N,Z){const X=T[Mn];!function Hx(d,h,m,x){for(const T of d)h.mergedAttrs=Ma(h.mergedAttrs,T.hostAttrs);null!==h.mergedAttrs&&(wm(h,h.mergedAttrs,!0),null!==m&&Jp(x,m,h))}(x,d,h,N);const oe=A.createRenderer(h,m),he=ny(T,Kr(m),null,m.onPush?32:16,T[d.index],d,A,oe,Z||null,null,null);return X.firstCreatePass&&xm(X,d,x.length-1),Ld(T,he),T[d.index]=he}(Vi,Ie,Kn,_i,Lt,Z,oe);Fn=Eu(ut,yi),Ie&&function Qu(d,h,m,x){if(x)fn(d,m,["ng-version",Vh.full]);else{const{attrs:T,classes:A}=function Y_(d){const h=[],m=[];let x=1,T=2;for(;x<d.length;){let A=d[x];if("string"==typeof A)2===T?""!==A&&h.push(A,d[++x]):8===T&&m.push(A);else{if(!mc(T))break;T=A}x++}return{attrs:h,classes:m}}(h.selectors[0]);T&&fn(d,m,T),A&&A.length>0&&Lf(d,m,A.join(" "))}}(oe,Kn,Ie,x),void 0!==m&&function Rg(d,h,m){const x=d.projection=[];for(let T=0;T<h.length;T++){const A=m[T];x.push(null!=A?Array.from(A):null)}}(Fn,this.ngContentSelectors,m),hn=function kg(d,h,m,x,T,A){const N=Fo(),Z=T[Mn],X=po(N,T);ay(Z,T,N,m,null,x);for(let he=0;he<m.length;he++)ds(da(T,Z,N.directiveStart+he,N),T);ly(Z,T,N),X&&ds(X,T);const oe=da(T,Z,N.directiveStart+N.componentOffset,N);if(d[Gn]=T[Gn]=oe,null!==A)for(const he of A)he(oe,h);return ry(Z,N,d),oe}(Zo,Kn,_i,Zt,Lt,[zd]),o0(ut,Lt,null)}finally{Tf()}return new jx(this.componentType,hn,kd(Fn,Lt),Lt,Fn)}}class jx extends ax{constructor(h,m,x,T,A){super(),this.location=x,this._rootLView=T,this._tNode=A,this.instance=m,this.hostView=this.changeDetectorRef=new sC(T),this.componentType=h}setInput(h,m){const x=this._tNode.inputs;let T;if(null!==x&&(T=x[h])){const A=this._rootLView;Gh(A[Mn],A,T,h,m),Yu(A,this._tNode.index)}}get injector(){return new Wc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(h){this.hostView.onDestroy(h)}}function zd(){const d=Fo();Du(qt()[Mn],d)}function Hh(d){let h=function ip(d){return Object.getPrototypeOf(d.prototype).constructor}(d.type),m=!0;const x=[d];for(;h;){let T;if(Br(d))T=h.\u0275cmp||h.\u0275dir;else{if(h.\u0275cmp)throw new vt(903,!1);T=h.\u0275dir}if(T){if(m){x.push(T);const N=d;N.inputs=Fg(d.inputs),N.declaredInputs=Fg(d.declaredInputs),N.outputs=Fg(d.outputs);const Z=T.hostBindings;Z&&qx(d,Z);const X=T.viewQuery,oe=T.contentQueries;if(X&&lC(d,X),oe&&my(d,oe),on(d.inputs,T.inputs),on(d.declaredInputs,T.declaredInputs),on(d.outputs,T.outputs),Br(T)&&T.data.animation){const he=d.data;he.animation=(he.animation||[]).concat(T.data.animation)}}const A=T.features;if(A)for(let N=0;N<A.length;N++){const Z=A[N];Z&&Z.ngInherit&&Z(d),Z===Hh&&(m=!1)}}h=Object.getPrototypeOf(h)}!function py(d){let h=0,m=null;for(let x=d.length-1;x>=0;x--){const T=d[x];T.hostVars=h+=T.hostVars,T.hostAttrs=Ma(T.hostAttrs,m=Ma(m,T.hostAttrs))}}(x)}function Fg(d){return d===ae?{}:d===pe?[]:d}function lC(d,h){const m=d.viewQuery;d.viewQuery=m?(x,T)=>{h(x,T),m(x,T)}:h}function my(d,h){const m=d.contentQueries;d.contentQueries=m?(x,T,A)=>{h(x,T,A),m(x,T,A)}:h}function qx(d,h){const m=d.hostBindings;d.hostBindings=m?(x,T)=>{h(x,T),m(x,T)}:h}function Vd(d){return!!c0(d)&&(Array.isArray(d)||!(d instanceof Map)&&Symbol.iterator in d)}function c0(d){return null!==d&&("function"==typeof d||"object"==typeof d)}function ks(d,h,m){return d[h]=m}function Ho(d,h,m){return!Object.is(d[h],m)&&(d[h]=m,!0)}function sp(d,h,m,x){const T=qt();return Ho(T,Cl(),h)&&(ji(),su(pr(),T,d,h,m,x)),sp}function jd(d,h,m,x){return Ho(d,Cl(),m)?h+kt(m)+x:Bi}function cC(d,h,m,x,T,A,N,Z){const X=qt(),oe=ji(),he=d+yi,Ie=oe.firstCreatePass?function Bg(d,h,m,x,T,A,N,Z,X){const oe=h.consts,he=gc(h,d,4,N||null,ca(oe,Z));bm(h,m,he,ca(oe,X)),Du(h,he);const Ie=he.tView=_c(2,he,x,T,A,h.directiveRegistry,h.pipeRegistry,null,h.schemas,oe);return null!==h.queries&&(h.queries.template(h,he),Ie.queries=h.queries.embeddedTView(he)),he}(he,oe,X,h,m,x,T,A,N):oe.data[he];Ya(Ie,!1);const Ze=X[bi].createComment("");Rh(oe,X,Ze,Ie),ds(Ze,X),Ld(X,X[he]=cy(Ze,X,Ze,Ie)),Us(Ie)&&Sg(oe,X,Ie),null!=N&&Fd(X,Ie,Z)}function d0(d){return la(function Uc(){return Ii.lFrame.contextLView}(),yi+d)}function Gd(d,h,m){const x=qt();return Ho(x,Cl(),h)&&Ar(ji(),pr(),x,d,h,x[bi],m,!1),Gd}function h0(d,h,m,x,T){const N=T?"class":"style";Gh(d,m,h.inputs[N],N,x)}function Vg(d,h,m,x){const T=qt(),A=ji(),N=yi+d,Z=T[bi],X=A.firstCreatePass?function xy(d,h,m,x,T,A){const N=h.consts,X=gc(h,d,2,x,ca(N,T));return bm(h,m,X,ca(N,A)),null!==X.attrs&&wm(X,X.attrs,!1),null!==X.mergedAttrs&&wm(X,X.mergedAttrs,!0),null!==h.queries&&h.queries.elementStart(h,X),X}(N,A,T,h,m,x):A.data[N],oe=T[N]=ga(Z,h,function Bp(){return Ii.lFrame.currentNamespace}()),he=Us(X);return Ya(X,!0),Jp(Z,oe,X),32!=(32&X.flags)&&Rh(A,T,oe,X),0===function md(){return Ii.lFrame.elementDepthCount}()&&ds(oe,T),function ah(){Ii.lFrame.elementDepthCount++}(),he&&(Sg(A,T,X),ry(A,X,T)),null!==x&&Fd(T,X),Vg}function Kh(){let d=Fo();Vc()?ch():(d=d.parent,Ya(d,!1));const h=d;!function Tu(){Ii.lFrame.elementDepthCount--}();const m=ji();return m.firstCreatePass&&(Du(m,d),Pc(d)&&m.queries.elementEnd(d)),null!=h.classesWithoutHost&&function Il(d){return 0!=(8&d.flags)}(h)&&h0(m,h,qt(),h.classesWithoutHost,!0),null!=h.stylesWithoutHost&&function Xa(d){return 0!=(16&d.flags)}(h)&&h0(m,h,qt(),h.stylesWithoutHost,!1),Kh}function wy(d,h,m,x){return Vg(d,h,m,x),Kh(),wy}function Cy(d,h,m){const x=qt(),T=ji(),A=d+yi,N=T.firstCreatePass?function f0(d,h,m,x,T){const A=h.consts,N=ca(A,x),Z=gc(h,d,8,"ng-container",N);return null!==N&&wm(Z,N,!0),bm(h,m,Z,ca(A,T)),null!==h.queries&&h.queries.elementStart(h,Z),Z}(A,T,x,h,m):T.data[A];Ya(N,!0);const Z=x[A]=x[bi].createComment("");return Rh(T,x,Z,N),ds(Z,x),Us(N)&&(Sg(T,x,N),ry(T,N,x)),null!=m&&Fd(x,N),Cy}function Ug(){let d=Fo();const h=ji();return Vc()?ch():(d=d.parent,Ya(d,!1)),h.firstCreatePass&&(Du(h,d),Pc(d)&&h.queries.elementEnd(d)),Ug}function jg(d,h,m){return Cy(d,h,m),Ug(),jg}function uC(){return qt()}function Xh(d){return!!d&&"function"==typeof d.then}function ew(d){return!!d&&"function"==typeof d.subscribe}const p0=ew;function Ey(d,h,m,x){const T=qt(),A=ji(),N=Fo();return function Nl(d,h,m,x,T,A,N){const Z=Us(x),oe=d.firstCreatePass&&hy(d),he=h[Gn],Ie=Bx(h);let Ze=!0;if(3&x.type||N){const hn=po(x,h),Fn=N?N(hn):hn,Kn=Ie.length,_i=N?Vi=>N(io(Vi[x.index])):x.index;let Zt=null;if(!N&&Z&&(Zt=function Ty(d,h,m,x){const T=d.cleanup;if(null!=T)for(let A=0;A<T.length-1;A+=2){const N=T[A];if(N===m&&T[A+1]===x){const Z=h[Ds],X=T[A+2];return Z.length>X?Z[X]:null}"string"==typeof N&&(A+=2)}return null}(d,h,T,x.index)),null!==Zt)(Zt.__ngLastListenerFn__||Zt).__ngNextListenerFn__=A,Zt.__ngLastListenerFn__=A,Ze=!1;else{A=Hd(x,h,he,A,!1);const Vi=m.listen(Fn,T,A);Ie.push(A,Vi),oe&&oe.push(T,_i,Kn,Kn+1)}}else A=Hd(x,h,he,A,!1);const ut=x.outputs;let Lt;if(Ze&&null!==ut&&(Lt=ut[T])){const hn=Lt.length;if(hn)for(let Fn=0;Fn<hn;Fn+=2){const Zo=h[Lt[Fn]][Lt[Fn+1]].subscribe(A),Es=Ie.length;Ie.push(A,Zo),oe&&oe.push(T,x.index,Es,-(Es+1))}}}(A,T,T[bi],N,d,h,x),Ey}function vc(d,h,m,x){try{return Qo(6,h,m),!1!==m(x)}catch(T){return Ag(d,T),!1}finally{Qo(7,h,m)}}function Hd(d,h,m,x,T){return function A(N){if(N===Function)return x;Nd(d.componentOffset>-1?di(d.index,h):h);let X=vc(h,m,x,N),oe=A.__ngNextListenerFn__;for(;oe;)X=vc(h,m,oe,N)&&X,oe=oe.__ngNextListenerFn__;return T&&!1===X&&(N.preventDefault(),N.returnValue=!1),X}}function ba(d=1){return function I_(d){return(Ii.lFrame.contextLView=function ng(d,h){for(;d>0;)h=h[fo],d--;return h}(d,Ii.lFrame.contextLView))[Gn]}(d)}function Qh(d,h){let m=null;const x=function mx(d){const h=d.attrs;if(null!=h){const m=h.indexOf(5);if(!(1&m))return h[m+1]}return null}(d);for(let T=0;T<h.length;T++){const A=h[T];if("*"!==A){if(null===x?Rd(d,A,!0):Jv(x,A))return T}else m=T}return m}function lp(d){const h=qt()[cs][Qi];if(!h.projection){const x=h.projection=Nu(d?d.length:1,null),T=x.slice();let A=h.child;for(;null!==A;){const N=d?Qh(A,d):0;null!==N&&(T[N]?T[N].projectionNext=A:x[N]=A,T[N]=A),A=A.next}}}function g0(d,h=0,m){const x=qt(),T=ji(),A=gc(T,yi+d,16,null,m||null);null===A.projection&&(A.projection=h),ch(),32!=(32&A.flags)&&function A_(d,h,m){Ff(h[bi],0,h,m,Ah(d,m,h),M_(m.parent||h[Qi],m,h))}(T,x,A)}function Sm(d,h,m){return $g(d,"",h,"",m),Sm}function $g(d,h,m,x,T){const A=qt(),N=jd(A,h,m,x);return N!==Bi&&Ar(ji(),pr(),A,d,N,A[bi],T,!1),$g}function Mm(d,h){return d<<17|h<<2}function ja(d){return d>>17&32767}function x0(d){return 2|d}function zl(d){return(131068&d)>>2}function Am(d,h){return-131069&d|h<<2}function bc(d){return 1|d}function C0(d,h,m,x,T){const A=d[m+1],N=null===h;let Z=x?ja(A):zl(A),X=!1;for(;0!==Z&&(!1===X||N);){const he=d[Z+1];My(d[Z],h)&&(X=!0,d[Z+1]=x?bc(he):x0(he)),Z=x?ja(he):zl(he)}X&&(d[m+1]=x?x0(A):bc(A))}function My(d,h){return null===d||null==h||(Array.isArray(d)?d[1]:d)===h||!(!Array.isArray(d)||"string"!=typeof h)&&c(d,h)>=0}const No={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function qg(d){return d.substring(No.key,No.keyEnd)}function T0(d,h){const m=No.textEnd;return m===h?-1:(h=No.keyEnd=function hC(d,h,m){for(;h<m&&d.charCodeAt(h)>32;)h++;return h}(d,No.key=h,m),Zd(d,h,m))}function Zd(d,h,m){for(;h<m&&d.charCodeAt(h)<=32;)h++;return h}function y(d,h,m){return U(d,h,m,!1),y}function w(d,h){return U(d,h,null,!0),w}function F(d,h){for(let m=function nw(d){return function rw(d){No.key=0,No.keyEnd=0,No.value=0,No.valueEnd=0,No.textEnd=d.length}(d),T0(d,Zd(d,0,No.textEnd))}(h);m>=0;m=T0(h,m))Mi(d,qg(h),!0)}function U(d,h,m,x){const T=qt(),A=ji(),N=Ka(2);A.firstUpdatePass&&Q(A,d,N,x),h!==Bi&&Ho(T,N,h)&&lt(A,A.data[vs()],T,T[bi],d,T[N+1]=function jt(d,h){return null==d||""===d||("string"==typeof h?d+=h:"object"==typeof d&&(d=yt(Ks(d)))),d}(h,m),x,N)}function V(d,h){return h>=d.expandoStartIndex}function Q(d,h,m,x){const T=d.data;if(null===T[m+1]){const A=T[vs()],N=V(d,m);ht(A,x)&&null===h&&!N&&(h=!1),h=function ie(d,h,m,x){const T=function dh(d){const h=Ii.lFrame.currentDirectiveIndex;return-1===h?null:d[h]}(d);let A=x?h.residualClasses:h.residualStyles;if(null===T)0===(x?h.classBindings:h.styleBindings)&&(m=me(m=Oe(null,d,h,m,x),h.attrs,x),A=null);else{const N=h.directiveStylingLast;if(-1===N||d[N]!==T)if(m=Oe(T,d,h,m,x),null===A){let X=function se(d,h,m){const x=m?h.classBindings:h.styleBindings;if(0!==zl(x))return d[ja(x)]}(d,h,x);void 0!==X&&Array.isArray(X)&&(X=Oe(null,d,h,X[1],x),X=me(X,h.attrs,x),function te(d,h,m,x){d[ja(m?h.classBindings:h.styleBindings)]=x}(d,h,x,X))}else A=function we(d,h,m){let x;const T=h.directiveEnd;for(let A=1+h.directiveStylingLast;A<T;A++)x=me(x,d[A].hostAttrs,m);return me(x,h.attrs,m)}(d,h,x)}return void 0!==A&&(x?h.residualClasses=A:h.residualStyles=A),m}(T,A,h,x),function xc(d,h,m,x,T,A){let N=A?h.classBindings:h.styleBindings,Z=ja(N),X=zl(N);d[x]=m;let he,oe=!1;if(Array.isArray(m)?(he=m[1],(null===he||c(m,he)>0)&&(oe=!0)):he=m,T)if(0!==X){const Ze=ja(d[Z+1]);d[x+1]=Mm(Ze,Z),0!==Ze&&(d[Ze+1]=Am(d[Ze+1],x)),d[Z+1]=function Dm(d,h){return 131071&d|h<<17}(d[Z+1],x)}else d[x+1]=Mm(Z,0),0!==Z&&(d[Z+1]=Am(d[Z+1],x)),Z=x;else d[x+1]=Mm(X,0),0===Z?Z=x:d[X+1]=Am(d[X+1],x),X=x;oe&&(d[x+1]=x0(d[x+1])),C0(d,he,x,!0),C0(d,he,x,!1),function cp(d,h,m,x,T){const A=T?d.residualClasses:d.residualStyles;null!=A&&"string"==typeof h&&c(A,h)>=0&&(m[x+1]=bc(m[x+1]))}(h,he,d,x,A),N=Mm(Z,X),A?h.classBindings=N:h.styleBindings=N}(T,A,h,m,N,x)}}function Oe(d,h,m,x,T){let A=null;const N=m.directiveEnd;let Z=m.directiveStylingLast;for(-1===Z?Z=m.directiveStart:Z++;Z<N&&(A=h[Z],x=me(x,A.hostAttrs,T),A!==d);)Z++;return null!==d&&(m.directiveStylingLast=Z),x}function me(d,h,m){const x=m?1:2;let T=-1;if(null!==h)for(let A=0;A<h.length;A++){const N=h[A];"number"==typeof N?T=N:T===x&&(Array.isArray(d)||(d=void 0===d?[]:["",d]),Mi(d,N,!!m||h[++A]))}return void 0===d?null:d}function lt(d,h,m,x,T,A,N,Z){if(!(3&h.type))return;const X=d.data,oe=X[Z+1],he=function qd(d){return 1==(1&d)}(oe)?tt(X,h,m,T,zl(oe),N):void 0;wt(he)||(wt(A)||function dC(d){return 2==(2&d)}(oe)&&(A=tt(X,null,m,T,Z,N)),function Fh(d,h,m,x,T){if(h)T?d.addClass(m,x):d.removeClass(m,x);else{let A=-1===x.indexOf("-")?void 0:Fi.DashCase;null==T?d.removeStyle(m,x,A):("string"==typeof T&&T.endsWith("!important")&&(T=T.slice(0,-10),A|=Fi.Important),d.setStyle(m,x,T,A))}}(x,N,xl(vs(),m),T,A))}function tt(d,h,m,x,T,A){const N=null===h;let Z;for(;T>0;){const X=d[T],oe=Array.isArray(X),he=oe?X[1]:X,Ie=null===he;let Ze=m[T+1];Ze===Bi&&(Ze=Ie?pe:void 0);let ut=Ie?v(Ze,x):he===x?Ze:void 0;if(oe&&!wt(ut)&&(ut=v(X,x)),wt(ut)&&(Z=ut,N))return Z;const Lt=d[T+1];T=N?ja(Lt):zl(Lt)}if(null!==h){let X=A?h.residualClasses:h.residualStyles;null!=X&&(Z=v(X,x))}return Z}function wt(d){return void 0!==d}function ht(d,h){return 0!=(d.flags&(h?8:16))}function Tt(d,h=""){const m=qt(),x=ji(),T=d+yi,A=x.firstCreatePass?gc(x,T,1,h,null):x.data[T],N=m[T]=function ri(d,h){return d.createText(h)}(m[bi],h);Rh(x,m,N,A),Ya(A,!1)}function At(d){return Et("",d,""),At}function Et(d,h,m){const x=qt(),T=jd(x,d,h,m);return T!==Bi&&function Xu(d,h,m){const x=xl(h,d);!function zi(d,h,m){d.setValue(h,m)}(d[bi],x,m)}(x,vs(),T),Et}function Li(d,h,m){!function W(d,h,m,x){const T=ji(),A=Ka(2);T.firstUpdatePass&&Q(T,null,A,x);const N=qt();if(m!==Bi&&Ho(N,A,m)){const Z=T.data[vs()];if(ht(Z,x)&&!V(T,A)){let X=x?Z.classesWithoutHost:Z.stylesWithoutHost;null!==X&&(m=It(X,m||"")),h0(T,Z,N,m,x)}else!function Re(d,h,m,x,T,A,N,Z){T===Bi&&(T=pe);let X=0,oe=0,he=0<T.length?T[0]:null,Ie=0<A.length?A[0]:null;for(;null!==he||null!==Ie;){const Ze=X<T.length?T[X+1]:void 0,ut=oe<A.length?A[oe+1]:void 0;let hn,Lt=null;he===Ie?(X+=2,oe+=2,Ze!==ut&&(Lt=Ie,hn=ut)):null===Ie||null!==he&&he<Ie?(X+=2,Lt=he):(oe+=2,Lt=Ie,hn=ut),null!==Lt&&lt(d,h,m,x,Lt,hn,N,Z),he=X<T.length?T[X]:null,Ie=oe<A.length?A[oe]:null}}(T,Z,N,N[bi],N[A+1],N[A+1]=function Ae(d,h,m){if(null==m||""===m)return pe;const x=[],T=Ks(m);if(Array.isArray(T))for(let A=0;A<T.length;A++)d(x,T[A],!0);else if("object"==typeof T)for(const A in T)T.hasOwnProperty(A)&&d(x,A,T[A]);else"string"==typeof T&&h(x,T);return x}(d,h,m),x,A)}}(Mi,F,jd(qt(),d,h,m),!0)}function cu(d,h,m){const x=qt();return Ho(x,Cl(),h)&&Ar(ji(),pr(),x,d,h,x[bi],m,!0),cu}const cl=void 0;var I0=["en",[["a","p"],["AM","PM"],cl],[["AM","PM"],cl,cl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],cl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],cl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",cl,"{1} 'at' {0}",cl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function dp(d){const m=Math.floor(Math.abs(d)),x=d.toString().replace(/^[^.]*\.?/,"").length;return 1===m&&0===x?1:5}];let Jh={};function ef(d){const h=function Py(d){return d.toLowerCase().replace(/_/g,"-")}(d);let m=Zg(h);if(m)return m;const x=h.split("-")[0];if(m=Zg(x),m)return m;if("en"===x)return I0;throw new vt(701,!1)}function Bl(d){return ef(d)[fi.PluralCase]}function Zg(d){return d in Jh||(Jh[d]=hi.ng&&hi.ng.common&&hi.ng.common.locales&&hi.ng.common.locales[d]),Jh[d]}var fi=(()=>((fi=fi||{})[fi.LocaleId=0]="LocaleId",fi[fi.DayPeriodsFormat=1]="DayPeriodsFormat",fi[fi.DayPeriodsStandalone=2]="DayPeriodsStandalone",fi[fi.DaysFormat=3]="DaysFormat",fi[fi.DaysStandalone=4]="DaysStandalone",fi[fi.MonthsFormat=5]="MonthsFormat",fi[fi.MonthsStandalone=6]="MonthsStandalone",fi[fi.Eras=7]="Eras",fi[fi.FirstDayOfWeek=8]="FirstDayOfWeek",fi[fi.WeekendRange=9]="WeekendRange",fi[fi.DateFormat=10]="DateFormat",fi[fi.TimeFormat=11]="TimeFormat",fi[fi.DateTimeFormat=12]="DateTimeFormat",fi[fi.NumberSymbols=13]="NumberSymbols",fi[fi.NumberFormats=14]="NumberFormats",fi[fi.CurrencyCode=15]="CurrencyCode",fi[fi.CurrencySymbol=16]="CurrencySymbol",fi[fi.CurrencyName=17]="CurrencyName",fi[fi.Currencies=18]="Currencies",fi[fi.Directionality=19]="Directionality",fi[fi.PluralCase=20]="PluralCase",fi[fi.ExtraData=21]="ExtraData",fi))();const hp="en-US";let ed=hp;function IC(d,h,m,x,T){if(d=Ke(d),Array.isArray(d))for(let A=0;A<d.length;A++)IC(d[A],h,m,x,T);else{const A=ji(),N=qt();let Z=iu(d)?d:Ke(d.provide),X=Hf(d);const oe=Fo(),he=1048575&oe.providerIndexes,Ie=oe.directiveStart,Ze=oe.providerIndexes>>20;if(iu(d)||!d.multi){const ut=new Au(X,T,_m),Lt=sf(Z,h,T?he:he+Ze,Ie);-1===Lt?(Pu(Dl(oe,N),A,Z),SC(A,d,h.length),h.push(Z),oe.directiveStart++,oe.directiveEnd++,T&&(oe.providerIndexes+=1048576),m.push(ut),N.push(ut)):(m[Lt]=ut,N[Lt]=ut)}else{const ut=sf(Z,h,he+Ze,Ie),Lt=sf(Z,h,he,he+Ze),Fn=Lt>=0&&m[Lt];if(T&&!Fn||!T&&!(ut>=0&&m[ut])){Pu(Dl(oe,N),A,Z);const Kn=function Vy(d,h,m,x,T){const A=new Au(d,m,_m);return A.multi=[],A.index=h,A.componentProviders=0,By(A,T,x&&!m),A}(T?gI:mI,m.length,T,x,X);!T&&Fn&&(m[Lt].providerFactory=Kn),SC(A,d,h.length,0),h.push(Z),oe.directiveStart++,oe.directiveEnd++,T&&(oe.providerIndexes+=1048576),m.push(Kn),N.push(Kn)}else SC(A,d,ut>-1?ut:Lt,By(m[T?Lt:ut],X,!T&&x));!T&&x&&Fn&&m[Lt].componentProviders++}}}function SC(d,h,m,x){const T=iu(h),A=function cm(d){return!!d.useClass}(h);if(T||A){const X=(A?Ke(h.useClass):h).prototype.ngOnDestroy;if(X){const oe=d.destroyHooks||(d.destroyHooks=[]);if(!T&&h.multi){const he=oe.indexOf(m);-1===he?oe.push(m,[x,X]):oe[he+1].push(x,X)}else oe.push(m,X)}}}function By(d,h,m){return m&&d.componentProviders++,d.multi.push(h)-1}function sf(d,h,m,x){for(let T=m;T<x;T++)if(h[T]===d)return T;return-1}function mI(d,h,m,x){return mw(this.multi,[])}function gI(d,h,m,x){const T=this.multi;let A;if(this.providerFactory){const N=this.providerFactory.componentProviders,Z=da(m,m[Mn],this.providerFactory.index,x);A=Z.slice(0,N),mw(T,A);for(let X=N;X<Z.length;X++)A.push(Z[X])}else A=[],mw(T,A);return A}function mw(d,h){for(let m=0;m<d.length;m++)h.push((0,d[m])());return h}function _I(d,h=[]){return m=>{m.providersResolver=(x,T)=>function cA(d,h,m){const x=ji();if(x.firstCreatePass){const T=Br(d);IC(m,x.data,x.blueprint,T,!0),IC(h,x.data,x.blueprint,T,!1)}}(x,T?T(d):d,h)}}class Uy{}class MC{}function uA(d,h){return new DC(d,h??null)}class DC extends Uy{constructor(h,m){super(),this._parent=m,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Vx(this);const x=ur(h);this._bootstrapComponents=Va(x.bootstrap),this._r3Injector=X1(h,m,[{provide:Uy,useValue:this},{provide:Od,useValue:this.componentFactoryResolver}],yt(h),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(h)}get injector(){return this._r3Injector}destroy(){const h=this._r3Injector;!h.destroyed&&h.destroy(),this.destroyCbs.forEach(m=>m()),this.destroyCbs=null}onDestroy(h){this.destroyCbs.push(h)}}class U0 extends MC{constructor(h){super(),this.moduleType=h}create(h){return new DC(this.moduleType,h)}}class AC extends Uy{constructor(h,m,x){super(),this.componentFactoryResolver=new Vx(this),this.instance=null;const T=new $v([...h,{provide:Uy,useValue:this},{provide:Od,useValue:this.componentFactoryResolver}],m||um(),x,new Set(["environment"]));this.injector=T,T.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(h){this.injector.onDestroy(h)}}function gw(d,h,m=null){return new AC(d,h,m).injector}let yI=(()=>{class d{constructor(m){this._injector=m,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(m){if(!m.standalone)return null;if(!this.cachedInjectors.has(m.id)){const x=rx(0,m.type),T=x.length>0?gw([x],this._injector,`Standalone[${m.type.name}]`):null;this.cachedInjectors.set(m.id,T)}return this.cachedInjectors.get(m.id)}ngOnDestroy(){try{for(const m of this.cachedInjectors.values())null!==m&&m.destroy()}finally{this.cachedInjectors.clear()}}}return d.\u0275prov=vn({token:d,providedIn:"environment",factory:()=>new d(cn(Bh))}),d})();function _w(d){d.getStandaloneInjector=h=>h.get(yI).getOrCreateStandaloneInjector(d)}function kC(d,h,m){const x=Jo()+d,T=qt();return T[x]===Bi?ks(T,x,m?h.call(m):h()):function Lg(d,h){return d[h]}(T,x)}function RC(d,h,m,x){return function H0(d,h,m,x,T,A){const N=h+m;return Ho(d,N,T)?ks(d,N+1,A?x.call(A,T):x(T)):Xg(d,N+1)}(qt(),Jo(),d,h,m,x)}function Xg(d,h){const m=d[h];return m===Bi?void 0:m}function LC(d,h,m,x,T,A,N){const Z=h+m;return function qh(d,h,m,x){const T=Ho(d,h,m);return Ho(d,h+1,x)||T}(d,Z,T,A)?ks(d,Z+2,N?x.call(N,T,A):x(T,A)):Xg(d,Z+2)}function Gy(d,h){const m=ji();let x;const T=d+yi;m.firstCreatePass?(x=function DI(d,h){if(h)for(let m=h.length-1;m>=0;m--){const x=h[m];if(d===x.name)return x}}(h,m.pipeRegistry),m.data[T]=x,x.onDestroy&&(m.destroyHooks??(m.destroyHooks=[])).push(T,x.onDestroy)):x=m.data[T];const A=x.factory||(x.factory=Xl(x.type)),N=wo(_m);try{const Z=Da(!1),X=A();return Da(Z),function Jx(d,h,m,x){m>=d.data.length&&(d.data[m]=null,d.blueprint[m]=null),h[m]=x}(m,qt(),T,X),X}finally{wo(N)}}function bw(d,h,m,x){const T=d+yi,A=qt(),N=la(A,T);return function Hy(d,h){return d[Mn].data[h].pure}(A,T)?LC(A,Jo(),h,N.transform,m,x,N):N.transform(m,x)}function ww(d){return h=>{setTimeout(d,void 0,h)}}const Wd=class Qg extends u.x{constructor(h=!1){super(),this.__isAsync=h}emit(h){super.next(h)}subscribe(h,m,x){let T=h,A=m||(()=>null),N=x;if(h&&"object"==typeof h){const X=h;T=X.next?.bind(X),A=X.error?.bind(X),N=X.complete?.bind(X)}this.__isAsync&&(A=ww(A),T&&(T=ww(T)),N&&(N=ww(N)));const Z=super.subscribe({next:T,error:A,complete:N});return h instanceof Ne.w0&&h.add(Z),Z}};function OI(){return this._results[Symbol.iterator]()}class Z0{get changes(){return this._changes||(this._changes=new Wd)}constructor(h=!1){this._emitDistinctChangesOnly=h,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const m=Z0.prototype;m[Symbol.iterator]||(m[Symbol.iterator]=OI)}get(h){return this._results[h]}map(h){return this._results.map(h)}filter(h){return this._results.filter(h)}find(h){return this._results.find(h)}reduce(h,m){return this._results.reduce(h,m)}forEach(h){this._results.forEach(h)}some(h){return this._results.some(h)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(h,m){const x=this;x.dirty=!1;const T=function pa(d){return d.flat(Number.POSITIVE_INFINITY)}(h);(this._changesDetected=!function Ch(d,h,m){if(d.length!==h.length)return!1;for(let x=0;x<d.length;x++){let T=d[x],A=h[x];if(m&&(T=m(T),A=m(A)),A!==T)return!1}return!0}(x._results,T,m))&&(x._results=T,x.length=T.length,x.last=T[this.length-1],x.first=T[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Om=(()=>{class d{}return d.__NG_ELEMENT_ID__=RI,d})();const uu=Om,kI=class extends uu{constructor(h,m,x){super(),this._declarationLView=h,this._declarationTContainer=m,this.elementRef=x}createEmbeddedView(h,m){const x=this._declarationTContainer.tView,T=ny(this._declarationLView,x,h,16,null,x.declTNode,null,null,null,null,m||null);T[Vs]=this._declarationLView[this._declarationTContainer.index];const N=this._declarationLView[Co];return null!==N&&(T[Co]=N.createEmbeddedView(x)),o0(x,T,h),new yc(T)}};function RI(){return gp(Fo(),qt())}function gp(d,h){return 4&d.type?new kI(h,d,kd(d,h)):null}let Cw=(()=>{class d{}return d.__NG_ELEMENT_ID__=mA,d})();function mA(){return NI(Fo(),qt())}const BC=Cw,FI=class extends BC{constructor(h,m,x){super(),this._lContainer=h,this._hostTNode=m,this._hostLView=x}get element(){return kd(this._hostTNode,this._hostLView)}get injector(){return new Wc(this._hostTNode,this._hostLView)}get parentInjector(){const h=Aa(this._hostTNode,this._hostLView);if(Qa(h)){const m=Hc(h,this._hostLView),x=xd(h);return new Wc(m[Mn].data[x+8],m)}return new Wc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(h){const m=LI(this._lContainer);return null!==m&&m[h]||null}get length(){return this._lContainer.length-Er}createEmbeddedView(h,m,x){let T,A;"number"==typeof x?T=x:null!=x&&(T=x.index,A=x.injector);const N=h.createEmbeddedView(m||{},A);return this.insert(N,T),N}createComponent(h,m,x,T,A){const N=h&&!function fa(d){return"function"==typeof d}(h);let Z;if(N)Z=m;else{const Ie=m||{};Z=Ie.index,x=Ie.injector,T=Ie.projectableNodes,A=Ie.environmentInjector||Ie.ngModuleRef}const X=N?h:new fy(Zi(h)),oe=x||this.parentInjector;if(!A&&null==X.ngModule){const Ze=(N?oe:this.parentInjector).get(Bh,null);Ze&&(A=Ze)}const he=X.create(oe,T,void 0,A);return this.insert(he.hostView,Z),he}insert(h,m){const x=h._lView,T=x[Mn];if(function Jm(d){return Ji(d[Ft])}(x)){const he=this.indexOf(h);if(-1!==he)this.detach(he);else{const Ie=x[Ft],Ze=new FI(Ie,Ie[Qi],Ie[Ft]);Ze.detach(Ze.indexOf(h))}}const A=this._adjustIndex(m),N=this._lContainer;!function Jc(d,h,m,x){const T=Er+x,A=m.length;x>0&&(m[T-1][oi]=h),x<A-Er?(h[oi]=m[T],Gp(m,Er+x,h)):(m.push(h),h[oi]=null),h[Ft]=m;const N=h[Vs];null!==N&&m!==N&&function eu(d,h){const m=d[Eo];h[cs]!==h[Ft][Ft][cs]&&(d[to]=!0),null===m?d[Eo]=[h]:m.push(h)}(N,h);const Z=h[Co];null!==Z&&Z.insertView(d),h[Ti]|=64}(T,x,N,A);const Z=Kp(A,N),X=x[bi],oe=Oh(X,N[yl]);return null!==oe&&function nl(d,h,m,x,T,A){x[Ms]=T,x[Qi]=h,Qp(d,x,m,1,T,A)}(T,N[Qi],X,x,oe,Z),h.attachToViewContainerRef(),Gp(Ew(N),A,h),h}move(h,m){return this.insert(h,m)}indexOf(h){const m=LI(this._lContainer);return null!==m?m.indexOf(h):-1}remove(h){const m=this._adjustIndex(h,-1),x=Mh(this._lContainer,m);x&&(Xc(Ew(this._lContainer),m),Dh(x[Mn],x))}detach(h){const m=this._adjustIndex(h,-1),x=Mh(this._lContainer,m);return x&&null!=Xc(Ew(this._lContainer),m)?new yc(x):null}_adjustIndex(h,m=0){return h??this.length+m}};function LI(d){return d[Kl]}function Ew(d){return d[Kl]||(d[Kl]=[])}function NI(d,h){let m;const x=h[d.index];if(Ji(x))m=x;else{let T;if(8&d.type)T=io(x);else{const A=h[bi];T=A.createComment("");const N=po(d,h);Ph(A,Oh(A,N),T,function La(d,h){return d.nextSibling(h)}(A,N),!1)}h[d.index]=m=cy(x,h,T,d),Ld(h,m)}return new FI(m,d,h)}class qy{constructor(h){this.queryList=h,this.matches=null}clone(){return new qy(this.queryList)}setDirty(){this.queryList.setDirty()}}class VC{constructor(h=[]){this.queries=h}createEmbeddedView(h){const m=h.queries;if(null!==m){const x=null!==h.contentQueries?h.contentQueries[0]:m.length,T=[];for(let A=0;A<x;A++){const N=m.getByIndex(A);T.push(this.queries[N.indexInDeclarationView].clone())}return new VC(T)}return null}insertView(h){this.dirtyQueriesWithMatches(h)}detachView(h){this.dirtyQueriesWithMatches(h)}dirtyQueriesWithMatches(h){for(let m=0;m<this.queries.length;m++)null!==$C(h,m).matches&&this.queries[m].setDirty()}}class UC{constructor(h,m,x=null){this.predicate=h,this.flags=m,this.read=x}}class qs{constructor(h=[]){this.queries=h}elementStart(h,m){for(let x=0;x<this.queries.length;x++)this.queries[x].elementStart(h,m)}elementEnd(h){for(let m=0;m<this.queries.length;m++)this.queries[m].elementEnd(h)}embeddedTView(h){let m=null;for(let x=0;x<this.length;x++){const T=null!==m?m.length:0,A=this.getByIndex(x).embeddedTView(h,T);A&&(A.indexInDeclarationView=x,null!==m?m.push(A):m=[A])}return null!==m?new qs(m):null}template(h,m){for(let x=0;x<this.queries.length;x++)this.queries[x].template(h,m)}getByIndex(h){return this.queries[h]}get length(){return this.queries.length}track(h){this.queries.push(h)}}class km{constructor(h,m=-1){this.metadata=h,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=m}elementStart(h,m){this.isApplyingToNode(m)&&this.matchTNode(h,m)}elementEnd(h){this._declarationNodeIndex===h.index&&(this._appliesToNextNode=!1)}template(h,m){this.elementStart(h,m)}embeddedTView(h,m){return this.isApplyingToNode(h)?(this.crossesNgTemplate=!0,this.addMatch(-h.index,m),new km(this.metadata)):null}isApplyingToNode(h){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const m=this._declarationNodeIndex;let x=h.parent;for(;null!==x&&8&x.type&&x.index!==m;)x=x.parent;return m===(null!==x?x.index:-1)}return this._appliesToNextNode}matchTNode(h,m){const x=this.metadata.predicate;if(Array.isArray(x))for(let T=0;T<x.length;T++){const A=x[T];this.matchTNodeWithReadOption(h,m,Rm(m,A)),this.matchTNodeWithReadOption(h,m,Ou(m,h,A,!1,!1))}else x===Om?4&m.type&&this.matchTNodeWithReadOption(h,m,-1):this.matchTNodeWithReadOption(h,m,Ou(m,h,x,!1,!1))}matchTNodeWithReadOption(h,m,x){if(null!==x){const T=this.metadata.read;if(null!==T)if(T===Qs||T===Cw||T===Om&&4&m.type)this.addMatch(m.index,-2);else{const A=Ou(m,h,T,!1,!1);null!==A&&this.addMatch(m.index,A)}else this.addMatch(m.index,x)}}addMatch(h,m){null===this.matches?this.matches=[h,m]:this.matches.push(h,m)}}function Rm(d,h){const m=d.localNames;if(null!==m)for(let x=0;x<m.length;x+=2)if(m[x]===h)return m[x+1];return null}function gA(d,h,m,x){return-1===m?function jC(d,h){return 11&d.type?kd(d,h):4&d.type?gp(d,h):null}(h,d):-2===m?function sn(d,h,m){return m===Qs?kd(h,d):m===Om?gp(h,d):m===Cw?NI(h,d):void 0}(d,h,x):da(d,d[Mn],m,h)}function Cs(d,h,m,x){const T=h[Co].queries[x];if(null===T.matches){const A=d.data,N=m.matches,Z=[];for(let X=0;X<N.length;X+=2){const oe=N[X];Z.push(oe<0?null:gA(h,A[oe],N[X+1],m.metadata.read))}T.matches=Z}return T.matches}function td(d,h,m,x){const T=d.queries.getByIndex(m),A=T.matches;if(null!==A){const N=Cs(d,h,T,m);for(let Z=0;Z<A.length;Z+=2){const X=A[Z];if(X>0)x.push(N[Z/2]);else{const oe=A[Z+1],he=h[-X];for(let Ie=Er;Ie<he.length;Ie++){const Ze=he[Ie];Ze[Vs]===Ze[Ft]&&td(Ze[Mn],Ze,oe,x)}if(null!==he[Eo]){const Ie=he[Eo];for(let Ze=0;Ze<Ie.length;Ze++){const ut=Ie[Ze];td(ut[Mn],ut,oe,x)}}}}}return x}function Tw(d){const h=qt(),m=ji(),x=Su();Lp(x+1);const T=$C(m,x);if(d.dirty&&function zc(d){return 4==(4&d[Ti])}(h)===(2==(2&T.metadata.flags))){if(null===T.matches)d.reset([]);else{const A=T.crossesNgTemplate?td(m,h,x,[]):Cs(m,h,T,x);d.reset(A,Ba),d.notifyOnChanges()}return!0}return!1}function Hn(d,h,m){const x=ji();x.firstCreatePass&&(Wt(x,new UC(d,h,m),-1),2==(2&h)&&(x.staticViewQueries=!0)),Ct(x,qt(),h)}function ai(d,h,m,x){const T=ji();if(T.firstCreatePass){const A=Fo();Wt(T,new UC(h,m,x),A.index),function na(d,h){const m=d.contentQueries||(d.contentQueries=[]);h!==(m.length?m[m.length-1]:-1)&&m.push(d.queries.length-1,h)}(T,d),2==(2&m)&&(T.staticContentQueries=!0)}Ct(T,qt(),m)}function zI(){return function Rn(d,h){return d[Co].queries[h].queryList}(qt(),Su())}function Ct(d,h,m){const x=new Z0(4==(4&m));Jf(d,h,x,x.destroy),null===h[Co]&&(h[Co]=new VC),h[Co].queries.push(new qy(x))}function Wt(d,h,m){null===d.queries&&(d.queries=new qs),d.queries.track(new km(h,m))}function $C(d,h){return d.queries.getByIndex(h)}function BI(d,h){return gp(d,h)}function GC(d){return!!ur(d)}function Sw(...d){}const KI=new xr("Application Initializer");let Mw=(()=>{class d{constructor(m){this.appInits=m,this.resolve=Sw,this.reject=Sw,this.initialized=!1,this.done=!1,this.donePromise=new Promise((x,T)=>{this.resolve=x,this.reject=T})}runInitializers(){if(this.initialized)return;const m=[],x=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let T=0;T<this.appInits.length;T++){const A=this.appInits[T]();if(Xh(A))m.push(A);else if(p0(A)){const N=new Promise((Z,X)=>{A.subscribe({complete:Z,error:X})});m.push(N)}}Promise.all(m).then(()=>{x()}).catch(T=>{this.reject(T)}),0===m.length&&x(),this.initialized=!0}}return d.\u0275fac=function(m){return new(m||d)(cn(KI,8))},d.\u0275prov=vn({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();const XI=new xr("AppId",{providedIn:"root",factory:function QI(){return`${XC()}${XC()}${XC()}`}});function XC(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const JI=new xr("Platform Initializer"),SA=new xr("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),MA=new xr("AnimationModuleType");let eS=(()=>{class d{log(m){console.log(m)}warn(m){console.warn(m)}}return d.\u0275fac=function(m){return new(m||d)},d.\u0275prov=vn({token:d,factory:d.\u0275fac,providedIn:"platform"}),d})();const Q0=new xr("LocaleId",{providedIn:"root",factory:()=>Sn(Q0,In.Optional|In.SkipSelf)||function DA(){return typeof $localize<"u"&&$localize.locale||hp}()}),tS=new xr("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class iS{constructor(h,m){this.ngModuleFactory=h,this.componentFactories=m}}let t_=(()=>{class d{compileModuleSync(m){return new U0(m)}compileModuleAsync(m){return Promise.resolve(this.compileModuleSync(m))}compileModuleAndAllComponentsSync(m){const x=this.compileModuleSync(m),A=Va(ur(m).declarations).reduce((N,Z)=>{const X=Zi(Z);return X&&N.push(new fy(X)),N},[]);return new iS(x,A)}compileModuleAndAllComponentsAsync(m){return Promise.resolve(this.compileModuleAndAllComponentsSync(m))}clearCache(){}clearCacheFor(m){}getModuleId(m){}}return d.\u0275fac=function(m){return new(m||d)},d.\u0275prov=vn({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();const Ec=(()=>Promise.resolve(0))();function QC(d){typeof Zone>"u"?Ec.then(()=>{d&&d.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",d)}class id{constructor({enableLongStackTrace:h=!1,shouldCoalesceEventChangeDetection:m=!1,shouldCoalesceRunChangeDetection:x=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Wd(!1),this.onMicrotaskEmpty=new Wd(!1),this.onStable=new Wd(!1),this.onError=new Wd(!1),typeof Zone>"u")throw new vt(908,!1);Zone.assertZonePatched();const T=this;T._nesting=0,T._outer=T._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(T._inner=T._inner.fork(new Zone.TaskTrackingZoneSpec)),h&&Zone.longStackTraceZoneSpec&&(T._inner=T._inner.fork(Zone.longStackTraceZoneSpec)),T.shouldCoalesceEventChangeDetection=!x&&m,T.shouldCoalesceRunChangeDetection=x,T.lastRequestAnimationFrameId=-1,T.nativeRequestAnimationFrame=function PA(){let d=hi.requestAnimationFrame,h=hi.cancelAnimationFrame;if(typeof Zone<"u"&&d&&h){const m=d[Zone.__symbol__("OriginalDelegate")];m&&(d=m);const x=h[Zone.__symbol__("OriginalDelegate")];x&&(h=x)}return{nativeRequestAnimationFrame:d,nativeCancelAnimationFrame:h}}().nativeRequestAnimationFrame,function JC(d){const h=()=>{!function n_(d){d.isCheckStableRunning||-1!==d.lastRequestAnimationFrameId||(d.lastRequestAnimationFrameId=d.nativeRequestAnimationFrame.call(hi,()=>{d.fakeTopEventTask||(d.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{d.lastRequestAnimationFrameId=-1,Aw(d),d.isCheckStableRunning=!0,ns(d),d.isCheckStableRunning=!1},void 0,()=>{},()=>{})),d.fakeTopEventTask.invoke()}),Aw(d))}(d)};d._inner=d._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(m,x,T,A,N,Z)=>{try{return Qy(d),m.invokeTask(T,A,N,Z)}finally{(d.shouldCoalesceEventChangeDetection&&"eventTask"===A.type||d.shouldCoalesceRunChangeDetection)&&h(),oS(d)}},onInvoke:(m,x,T,A,N,Z,X)=>{try{return Qy(d),m.invoke(T,A,N,Z,X)}finally{d.shouldCoalesceRunChangeDetection&&h(),oS(d)}},onHasTask:(m,x,T,A)=>{m.hasTask(T,A),x===T&&("microTask"==A.change?(d._hasPendingMicrotasks=A.microTask,Aw(d),ns(d)):"macroTask"==A.change&&(d.hasPendingMacrotasks=A.macroTask))},onHandleError:(m,x,T,A)=>(m.handleError(T,A),d.runOutsideAngular(()=>d.onError.emit(A)),!1)})}(T)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!id.isInAngularZone())throw new vt(909,!1)}static assertNotInAngularZone(){if(id.isInAngularZone())throw new vt(909,!1)}run(h,m,x){return this._inner.run(h,m,x)}runTask(h,m,x,T){const A=this._inner,N=A.scheduleEventTask("NgZoneEvent: "+T,h,Nm,Sw,Sw);try{return A.runTask(N,m,x)}finally{A.cancelTask(N)}}runGuarded(h,m,x){return this._inner.runGuarded(h,m,x)}runOutsideAngular(h){return this._outer.run(h)}}const Nm={};function ns(d){if(0==d._nesting&&!d.hasPendingMicrotasks&&!d.isStable)try{d._nesting++,d.onMicrotaskEmpty.emit(null)}finally{if(d._nesting--,!d.hasPendingMicrotasks)try{d.runOutsideAngular(()=>d.onStable.emit(null))}finally{d.isStable=!0}}}function Aw(d){d.hasPendingMicrotasks=!!(d._hasPendingMicrotasks||(d.shouldCoalesceEventChangeDetection||d.shouldCoalesceRunChangeDetection)&&-1!==d.lastRequestAnimationFrameId)}function Qy(d){d._nesting++,d.isStable&&(d.isStable=!1,d.onUnstable.emit(null))}function oS(d){d._nesting--,ns(d)}class zm{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Wd,this.onMicrotaskEmpty=new Wd,this.onStable=new Wd,this.onError=new Wd}run(h,m,x){return h.apply(m,x)}runGuarded(h,m,x){return h.apply(m,x)}runOutsideAngular(h){return h()}runTask(h,m,x,T){return h.apply(m,x)}}const vp=new xr(""),J0=new xr("");let lf,i_=(()=>{class d{constructor(m,x,T){this._ngZone=m,this.registry=x,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,lf||(function eb(d){lf=d}(T),T.addToWindow(x)),this._watchAngularEvents(),m.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{id.assertNotInAngularZone(),QC(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())QC(()=>{for(;0!==this._callbacks.length;){let m=this._callbacks.pop();clearTimeout(m.timeoutId),m.doneCb(this._didWork)}this._didWork=!1});else{let m=this.getPendingTasks();this._callbacks=this._callbacks.filter(x=>!x.updateCb||!x.updateCb(m)||(clearTimeout(x.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(m=>({source:m.source,creationLocation:m.creationLocation,data:m.data})):[]}addCallback(m,x,T){let A=-1;x&&x>0&&(A=setTimeout(()=>{this._callbacks=this._callbacks.filter(N=>N.timeoutId!==A),m(this._didWork,this.getPendingTasks())},x)),this._callbacks.push({doneCb:m,timeoutId:A,updateCb:T})}whenStable(m,x,T){if(T&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(m,x,T),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(m){this.registry.registerApplication(m,this)}unregisterApplication(m){this.registry.unregisterApplication(m)}findProviders(m,x,T){return[]}}return d.\u0275fac=function(m){return new(m||d)(cn(id),cn(Yd),cn(J0))},d.\u0275prov=vn({token:d,factory:d.\u0275fac}),d})(),Yd=(()=>{class d{constructor(){this._applications=new Map}registerApplication(m,x){this._applications.set(m,x)}unregisterApplication(m){this._applications.delete(m)}unregisterAllApplications(){this._applications.clear()}getTestability(m){return this._applications.get(m)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(m,x=!0){return lf?.findTestabilityInTree(this,m,x)??null}}return d.\u0275fac=function(m){return new(m||d)},d.\u0275prov=vn({token:d,factory:d.\u0275fac,providedIn:"platform"}),d})();const cf=!1;let du=null;const Pw=new xr("AllowMultipleToken"),bp=new xr("PlatformDestroyListeners"),Ow=new xr("appBootstrapListener");class kw{constructor(h,m){this.name=h,this.token=m}}function eE(d,h,m=[]){const x=`Platform: ${h}`,T=new xr(x);return(A=[])=>{let N=Ao();if(!N||N.injector.get(Pw,!1)){const Z=[...m,...A,{provide:T,useValue:!0}];d?d(Z):function nb(d){if(du&&!du.get(Pw,!1))throw new vt(400,!1);du=d;const h=d.get(xp);(function lS(d){const h=d.get(JI,null);h&&h.forEach(m=>m())})(d)}(function ia(d=[],h){return hm.create({name:h,providers:[{provide:U_,useValue:"platform"},{provide:bp,useValue:new Set([()=>du=null])},...d]})}(Z,x))}return function cS(d){const h=Ao();if(!h)throw new vt(401,!1);return h}()}}function Ao(){return du?.get(xp)??null}let xp=(()=>{class d{constructor(m){this._injector=m,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(m,x){const T=function nE(d,h){let m;return m="noop"===d?new zm:("zone.js"===d?void 0:d)||new id(h),m}(x?.ngZone,function tE(d){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!d||!d.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!d||!d.ngZoneRunCoalescing)||!1}}(x)),A=[{provide:id,useValue:T}];return T.run(()=>{const N=hm.create({providers:A,parent:this.injector,name:m.moduleType.name}),Z=m.create(N),X=Z.injector.get(_g,null);if(!X)throw new vt(402,!1);return T.runOutsideAngular(()=>{const oe=T.onError.subscribe({next:he=>{X.handleError(he)}});Z.onDestroy(()=>{gr(this._modules,Z),oe.unsubscribe()})}),function r_(d,h,m){try{const x=m();return Xh(x)?x.catch(T=>{throw h.runOutsideAngular(()=>d.handleError(T)),T}):x}catch(x){throw h.runOutsideAngular(()=>d.handleError(x)),x}}(X,T,()=>{const oe=Z.injector.get(Mw);return oe.runInitializers(),oe.donePromise.then(()=>(function ta(d){wn(d,"Expected localeId to be defined"),"string"==typeof d&&(ed=d.toLowerCase().replace(/_/g,"-"))}(Z.injector.get(Q0,hp)||hp),this._moduleDoBootstrap(Z),Z))})})}bootstrapModule(m,x=[]){const T=uS({},x);return function tb(d,h,m){const x=new U0(m);return Promise.resolve(x)}(0,0,m).then(A=>this.bootstrapModuleFactory(A,T))}_moduleDoBootstrap(m){const x=m.injector.get(ib);if(m._bootstrapComponents.length>0)m._bootstrapComponents.forEach(T=>x.bootstrap(T));else{if(!m.instance.ngDoBootstrap)throw new vt(-403,!1);m.instance.ngDoBootstrap(x)}this._modules.push(m)}onDestroy(m){this._destroyListeners.push(m)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new vt(404,!1);this._modules.slice().forEach(x=>x.destroy()),this._destroyListeners.forEach(x=>x());const m=this._injector.get(bp,null);m&&(m.forEach(x=>x()),m.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return d.\u0275fac=function(m){return new(m||d)(cn(hm))},d.\u0275prov=vn({token:d,factory:d.\u0275fac,providedIn:"platform"}),d})();function uS(d,h){return Array.isArray(h)?h.reduce(uS,d):{...d,...h}}let ib=(()=>{class d{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(m,x,T){this._zone=m,this._injector=x,this._exceptionHandler=T,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const A=new Se.y(Z=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{Z.next(this._stable),Z.complete()})}),N=new Se.y(Z=>{let X;this._zone.runOutsideAngular(()=>{X=this._zone.onStable.subscribe(()=>{id.assertNotInAngularZone(),QC(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,Z.next(!0))})})});const oe=this._zone.onUnstable.subscribe(()=>{id.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{Z.next(!1)}))});return()=>{X.unsubscribe(),oe.unsubscribe()}});this.isStable=(0,_.T)(A,N.pipe((0,$e.B)()))}bootstrap(m,x){const T=m instanceof lx;if(!this._injector.get(Mw).done){!T&&ko(m);throw new vt(405,cf)}let N;N=T?m:this._injector.get(Od).resolveComponentFactory(m),this.componentTypes.push(N.componentType);const Z=function sS(d){return d.isBoundToModule}(N)?void 0:this._injector.get(Uy),oe=N.create(hm.NULL,[],x||N.selector,Z),he=oe.location.nativeElement,Ie=oe.injector.get(vp,null);return Ie?.registerApplication(he),oe.onDestroy(()=>{this.detachView(oe.hostView),gr(this.components,oe),Ie?.unregisterApplication(he)}),this._loadComponent(oe),oe}tick(){if(this._runningTick)throw new vt(101,!1);try{this._runningTick=!0;for(let m of this._views)m.detectChanges()}catch(m){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(m))}finally{this._runningTick=!1}}attachView(m){const x=m;this._views.push(x),x.attachToAppRef(this)}detachView(m){const x=m;gr(this._views,x),x.detachFromAppRef()}_loadComponent(m){this.attachView(m.hostView),this.tick(),this.components.push(m);const x=this._injector.get(Ow,[]);x.push(...this._bootstrapListeners),x.forEach(T=>T(m))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(m=>m()),this._views.slice().forEach(m=>m.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(m){return this._destroyListeners.push(m),()=>gr(this._destroyListeners,m)}destroy(){if(this._destroyed)throw new vt(406,!1);const m=this._injector;m.destroy&&!m.destroyed&&m.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return d.\u0275fac=function(m){return new(m||d)(cn(id),cn(Bh),cn(_g))},d.\u0275prov=vn({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();function gr(d,h){const m=d.indexOf(h);m>-1&&d.splice(m,1)}function iE(){return!1}let fS=(()=>{class d{}return d.__NG_ELEMENT_ID__=pS,d})();function pS(d){return function FA(d,h,m){if(Oc(d)&&!m){const x=di(d.index,h);return new yc(x,x)}return 47&d.type?new yc(h[cs],h):null}(Fo(),qt(),16==(16&d))}class Vm{constructor(){}supports(h){return Vd(h)}create(h){return new aE(h)}}const $l=(d,h)=>h;class aE{constructor(h){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=h||$l}forEachItem(h){let m;for(m=this._itHead;null!==m;m=m._next)h(m)}forEachOperation(h){let m=this._itHead,x=this._removalsHead,T=0,A=null;for(;m||x;){const N=!x||m&&m.currentIndex<zw(x,T,A)?m:x,Z=zw(N,T,A),X=N.currentIndex;if(N===x)T--,x=x._nextRemoved;else if(m=m._next,null==N.previousIndex)T++;else{A||(A=[]);const oe=Z-T,he=X-T;if(oe!=he){for(let Ze=0;Ze<oe;Ze++){const ut=Ze<A.length?A[Ze]:A[Ze]=0,Lt=ut+Ze;he<=Lt&&Lt<oe&&(A[Ze]=ut+1)}A[N.previousIndex]=he-oe}}Z!==X&&h(N,Z,X)}}forEachPreviousItem(h){let m;for(m=this._previousItHead;null!==m;m=m._nextPrevious)h(m)}forEachAddedItem(h){let m;for(m=this._additionsHead;null!==m;m=m._nextAdded)h(m)}forEachMovedItem(h){let m;for(m=this._movesHead;null!==m;m=m._nextMoved)h(m)}forEachRemovedItem(h){let m;for(m=this._removalsHead;null!==m;m=m._nextRemoved)h(m)}forEachIdentityChange(h){let m;for(m=this._identityChangesHead;null!==m;m=m._nextIdentityChange)h(m)}diff(h){if(null==h&&(h=[]),!Vd(h))throw new vt(900,!1);return this.check(h)?this:null}onDestroy(){}check(h){this._reset();let T,A,N,m=this._itHead,x=!1;if(Array.isArray(h)){this.length=h.length;for(let Z=0;Z<this.length;Z++)A=h[Z],N=this._trackByFn(Z,A),null!==m&&Object.is(m.trackById,N)?(x&&(m=this._verifyReinsertion(m,A,N,Z)),Object.is(m.item,A)||this._addIdentityChange(m,A)):(m=this._mismatch(m,A,N,Z),x=!0),m=m._next}else T=0,function Em(d,h){if(Array.isArray(d))for(let m=0;m<d.length;m++)h(d[m]);else{const m=d[Symbol.iterator]();let x;for(;!(x=m.next()).done;)h(x.value)}}(h,Z=>{N=this._trackByFn(T,Z),null!==m&&Object.is(m.trackById,N)?(x&&(m=this._verifyReinsertion(m,Z,N,T)),Object.is(m.item,Z)||this._addIdentityChange(m,Z)):(m=this._mismatch(m,Z,N,T),x=!0),m=m._next,T++}),this.length=T;return this._truncate(m),this.collection=h,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let h;for(h=this._previousItHead=this._itHead;null!==h;h=h._next)h._nextPrevious=h._next;for(h=this._additionsHead;null!==h;h=h._nextAdded)h.previousIndex=h.currentIndex;for(this._additionsHead=this._additionsTail=null,h=this._movesHead;null!==h;h=h._nextMoved)h.previousIndex=h.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(h,m,x,T){let A;return null===h?A=this._itTail:(A=h._prev,this._remove(h)),null!==(h=null===this._unlinkedRecords?null:this._unlinkedRecords.get(x,null))?(Object.is(h.item,m)||this._addIdentityChange(h,m),this._reinsertAfter(h,A,T)):null!==(h=null===this._linkedRecords?null:this._linkedRecords.get(x,T))?(Object.is(h.item,m)||this._addIdentityChange(h,m),this._moveAfter(h,A,T)):h=this._addAfter(new Nw(m,x),A,T),h}_verifyReinsertion(h,m,x,T){let A=null===this._unlinkedRecords?null:this._unlinkedRecords.get(x,null);return null!==A?h=this._reinsertAfter(A,h._prev,T):h.currentIndex!=T&&(h.currentIndex=T,this._addToMoves(h,T)),h}_truncate(h){for(;null!==h;){const m=h._next;this._addToRemovals(this._unlink(h)),h=m}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(h,m,x){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(h);const T=h._prevRemoved,A=h._nextRemoved;return null===T?this._removalsHead=A:T._nextRemoved=A,null===A?this._removalsTail=T:A._prevRemoved=T,this._insertAfter(h,m,x),this._addToMoves(h,x),h}_moveAfter(h,m,x){return this._unlink(h),this._insertAfter(h,m,x),this._addToMoves(h,x),h}_addAfter(h,m,x){return this._insertAfter(h,m,x),this._additionsTail=null===this._additionsTail?this._additionsHead=h:this._additionsTail._nextAdded=h,h}_insertAfter(h,m,x){const T=null===m?this._itHead:m._next;return h._next=T,h._prev=m,null===T?this._itTail=h:T._prev=h,null===m?this._itHead=h:m._next=h,null===this._linkedRecords&&(this._linkedRecords=new lE),this._linkedRecords.put(h),h.currentIndex=x,h}_remove(h){return this._addToRemovals(this._unlink(h))}_unlink(h){null!==this._linkedRecords&&this._linkedRecords.remove(h);const m=h._prev,x=h._next;return null===m?this._itHead=x:m._next=x,null===x?this._itTail=m:x._prev=m,h}_addToMoves(h,m){return h.previousIndex===m||(this._movesTail=null===this._movesTail?this._movesHead=h:this._movesTail._nextMoved=h),h}_addToRemovals(h){return null===this._unlinkedRecords&&(this._unlinkedRecords=new lE),this._unlinkedRecords.put(h),h.currentIndex=null,h._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=h,h._prevRemoved=null):(h._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=h),h}_addIdentityChange(h,m){return h.item=m,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=h:this._identityChangesTail._nextIdentityChange=h,h}}class Nw{constructor(h,m){this.item=h,this.trackById=m,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class ob{constructor(){this._head=null,this._tail=null}add(h){null===this._head?(this._head=this._tail=h,h._nextDup=null,h._prevDup=null):(this._tail._nextDup=h,h._prevDup=this._tail,h._nextDup=null,this._tail=h)}get(h,m){let x;for(x=this._head;null!==x;x=x._nextDup)if((null===m||m<=x.currentIndex)&&Object.is(x.trackById,h))return x;return null}remove(h){const m=h._prevDup,x=h._nextDup;return null===m?this._head=x:m._nextDup=x,null===x?this._tail=m:x._prevDup=m,null===this._head}}class lE{constructor(){this.map=new Map}put(h){const m=h.trackById;let x=this.map.get(m);x||(x=new ob,this.map.set(m,x)),x.add(h)}get(h,m){const T=this.map.get(h);return T?T.get(h,m):null}remove(h){const m=h.trackById;return this.map.get(m).remove(h)&&this.map.delete(m),h}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function zw(d,h,m){const x=d.previousIndex;if(null===x)return x;let T=0;return m&&x<m.length&&(T=m[x]),x+h+T}class tv{constructor(){}supports(h){return h instanceof Map||c0(h)}create(){return new yS}}class yS{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(h){let m;for(m=this._mapHead;null!==m;m=m._next)h(m)}forEachPreviousItem(h){let m;for(m=this._previousMapHead;null!==m;m=m._nextPrevious)h(m)}forEachChangedItem(h){let m;for(m=this._changesHead;null!==m;m=m._nextChanged)h(m)}forEachAddedItem(h){let m;for(m=this._additionsHead;null!==m;m=m._nextAdded)h(m)}forEachRemovedItem(h){let m;for(m=this._removalsHead;null!==m;m=m._nextRemoved)h(m)}diff(h){if(h){if(!(h instanceof Map||c0(h)))throw new vt(900,!1)}else h=new Map;return this.check(h)?this:null}onDestroy(){}check(h){this._reset();let m=this._mapHead;if(this._appendAfter=null,this._forEach(h,(x,T)=>{if(m&&m.key===T)this._maybeAddToChanges(m,x),this._appendAfter=m,m=m._next;else{const A=this._getOrCreateRecordForKey(T,x);m=this._insertBeforeOrAppend(m,A)}}),m){m._prev&&(m._prev._next=null),this._removalsHead=m;for(let x=m;null!==x;x=x._nextRemoved)x===this._mapHead&&(this._mapHead=null),this._records.delete(x.key),x._nextRemoved=x._next,x.previousValue=x.currentValue,x.currentValue=null,x._prev=null,x._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(h,m){if(h){const x=h._prev;return m._next=h,m._prev=x,h._prev=m,x&&(x._next=m),h===this._mapHead&&(this._mapHead=m),this._appendAfter=h,h}return this._appendAfter?(this._appendAfter._next=m,m._prev=this._appendAfter):this._mapHead=m,this._appendAfter=m,null}_getOrCreateRecordForKey(h,m){if(this._records.has(h)){const T=this._records.get(h);this._maybeAddToChanges(T,m);const A=T._prev,N=T._next;return A&&(A._next=N),N&&(N._prev=A),T._next=null,T._prev=null,T}const x=new vS(h);return this._records.set(h,x),x.currentValue=m,this._addToAdditions(x),x}_reset(){if(this.isDirty){let h;for(this._previousMapHead=this._mapHead,h=this._previousMapHead;null!==h;h=h._next)h._nextPrevious=h._next;for(h=this._changesHead;null!==h;h=h._nextChanged)h.previousValue=h.currentValue;for(h=this._additionsHead;null!=h;h=h._nextAdded)h.previousValue=h.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(h,m){Object.is(m,h.currentValue)||(h.previousValue=h.currentValue,h.currentValue=m,this._addToChanges(h))}_addToAdditions(h){null===this._additionsHead?this._additionsHead=this._additionsTail=h:(this._additionsTail._nextAdded=h,this._additionsTail=h)}_addToChanges(h){null===this._changesHead?this._changesHead=this._changesTail=h:(this._changesTail._nextChanged=h,this._changesTail=h)}_forEach(h,m){h instanceof Map?h.forEach(m):Object.keys(h).forEach(x=>m(h[x],x))}}class vS{constructor(h){this.key=h,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function bS(){return new uf([new Vm])}let uf=(()=>{class d{constructor(m){this.factories=m}static create(m,x){if(null!=x){const T=x.factories.slice();m=m.concat(T)}return new d(m)}static extend(m){return{provide:d,useFactory:x=>d.create(m,x||bS()),deps:[[d,new ve,new _e]]}}find(m){const x=this.factories.find(T=>T.supports(m));if(null!=x)return x;throw new vt(901,!1)}}return d.\u0275prov=vn({token:d,providedIn:"root",factory:bS}),d})();function Gl(){return new Bw([new tv])}let Bw=(()=>{class d{constructor(m){this.factories=m}static create(m,x){if(x){const T=x.factories.slice();m=m.concat(T)}return new d(m)}static extend(m){return{provide:d,useFactory:x=>d.create(m,x||Gl()),deps:[[d,new ve,new _e]]}}find(m){const x=this.factories.find(T=>T.supports(m));if(x)return x;throw new vt(901,!1)}}return d.\u0275prov=vn({token:d,providedIn:"root",factory:Gl}),d})();const ab=eE(null,"core",[]);let jA=(()=>{class d{constructor(m){}}return d.\u0275fac=function(m){return new(m||d)(cn(ib))},d.\u0275mod=Ci({type:d}),d.\u0275inj=Ai({}),d})();function $A(d){return"boolean"==typeof d?d:null!=d&&"false"!==d}},3942:(ui,Kt,De)=>{"use strict";De.d(Kt,{Z:()=>bn});var u=De(2090),Ne=De(4859),Se=De(9681),_=De(1877);class $e{constructor(vt,Ye){this._delegate=vt,this.firebase=Ye,(0,Se._addComponent)(vt,new Ne.wA("app-compat",()=>this,"PUBLIC")),this.container=vt.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(vt){this._delegate.automaticDataCollectionEnabled=vt}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(vt=>{this._delegate.checkDestroyed(),vt()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,Se.deleteApp)(this._delegate)))}_getService(vt,Ye=Se._DEFAULT_ENTRY_NAME){var kt;this._delegate.checkDestroyed();const Jt=this._delegate.container.getProvider(vt);return!Jt.isInitialized()&&"EXPLICIT"===(null===(kt=Jt.getComponent())||void 0===kt?void 0:kt.instantiationMode)&&Jt.initialize(),Jt.getImmediate({identifier:Ye})}_removeServiceInstance(vt,Ye=Se._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(vt).clearInstance(Ye)}_addComponent(vt){(0,Se._addComponent)(this._delegate,vt)}_addOrOverwriteComponent(vt){(0,Se._addOrOverwriteComponent)(this._delegate,vt)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const on=new u.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),Ve=function It(){const An=function yt(An){const vt={},Ye={__esModule:!0,initializeApp:function Xt(nt,pt={}){const Nt=Se.initializeApp(nt,pt);if((0,u.r3)(vt,Nt.name))return vt[Nt.name];const zt=new An(Nt,Ye);return vt[Nt.name]=zt,zt},app:Jt,registerVersion:Se.registerVersion,setLogLevel:Se.setLogLevel,onLog:Se.onLog,apps:null,SDK_VERSION:Se.SDK_VERSION,INTERNAL:{registerComponent:function Pt(nt){const pt=nt.name,Nt=pt.replace("-compat","");if(Se._registerComponent(nt)&&"PUBLIC"===nt.type){const zt=(an=Jt())=>{if("function"!=typeof an[Nt])throw on.create("invalid-app-argument",{appName:pt});return an[Nt]()};void 0!==nt.serviceProps&&(0,u.ZB)(zt,nt.serviceProps),Ye[Nt]=zt,An.prototype[Nt]=function(...an){return this._getService.bind(this,pt).apply(this,nt.multipleInstances?an:[])}}return"PUBLIC"===nt.type?Ye[Nt]:null},removeApp:function kt(nt){delete vt[nt]},useAsService:function un(nt,pt){return"serverAuth"===pt?null:pt},modularAPIs:Se}};function Jt(nt){if(!(0,u.r3)(vt,nt=nt||Se._DEFAULT_ENTRY_NAME))throw on.create("no-app",{appName:nt});return vt[nt]}return Ye.default=Ye,Object.defineProperty(Ye,"apps",{get:function xt(){return Object.keys(vt).map(nt=>vt[nt])}}),Jt.App=An,Ye}($e);return An.INTERNAL=Object.assign(Object.assign({},An.INTERNAL),{createFirebaseNamespace:It,extendNamespace:function vt(Ye){(0,u.ZB)(An,Ye)},createSubscribe:u.ne,ErrorFactory:u.LL,deepExtend:u.ZB}),An}(),je=new _.Yd("@firebase/app-compat");if((0,u.jU)()&&void 0!==self.firebase){je.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const An=self.firebase.SDK_VERSION;An&&An.indexOf("LITE")>=0&&je.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const bn=Ve;!function nn(An){(0,Se.registerVersion)("@firebase/app-compat","0.2.7",An)}()},9681:(ui,Kt,De)=>{"use strict";De.r(Kt),De.d(Kt,{FirebaseError:()=>_.ZR,SDK_VERSION:()=>lo,_DEFAULT_ENTRY_NAME:()=>rn,_addComponent:()=>ir,_addOrOverwriteComponent:()=>qn,_apps:()=>wn,_clearComponents:()=>Ai,_components:()=>Cn,_getProvider:()=>vn,_registerComponent:()=>Bn,_removeServiceInstance:()=>Xi,deleteApp:()=>gs,getApp:()=>co,getApps:()=>Ss,initializeApp:()=>Is,onLog:()=>In,registerVersion:()=>$r,setLogLevel:()=>Uo});var u=De(5861),Ne=De(4859),Se=De(1877),_=De(2090),$e=De(8766);class ft{constructor(Bt){this.container=Bt}getPlatformInfoString(){return this.container.getProviders().map(Sn=>{if(function on(cn){return"VERSION"===cn.getComponent()?.type}(Sn)){const Zn=Sn.getImmediate();return`${Zn.library}/${Zn.version}`}return null}).filter(Sn=>Sn).join(" ")}}const yt="@firebase/app",Ve=new Se.Yd("@firebase/app"),rn="[DEFAULT]",en={[yt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},wn=new Map,Cn=new Map;function ir(cn,Bt){try{cn.container.addComponent(Bt)}catch(Sn){Ve.debug(`Component ${Bt.name} failed to register with FirebaseApp ${cn.name}`,Sn)}}function qn(cn,Bt){cn.container.addOrOverwriteComponent(Bt)}function Bn(cn){const Bt=cn.name;if(Cn.has(Bt))return Ve.debug(`There were multiple attempts to register component ${Bt}.`),!1;Cn.set(Bt,cn);for(const Sn of wn.values())ir(Sn,cn);return!0}function vn(cn,Bt){const Sn=cn.container.getProvider("heartbeat").getImmediate({optional:!0});return Sn&&Sn.triggerHeartbeat(),cn.container.getProvider(Bt)}function Xi(cn,Bt,Sn=rn){vn(cn,Bt).clearInstance(Sn)}function Ai(){Cn.clear()}const Un=new _.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class kr{constructor(Bt,Sn,Zn){this._isDeleted=!1,this._options=Object.assign({},Bt),this._config=Object.assign({},Sn),this._name=Sn.name,this._automaticDataCollectionEnabled=Sn.automaticDataCollectionEnabled,this._container=Zn,this.container.addComponent(new Ne.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Bt){this.checkDestroyed(),this._automaticDataCollectionEnabled=Bt}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Bt){this._isDeleted=Bt}checkDestroyed(){if(this.isDeleted)throw Un.create("app-deleted",{appName:this._name})}}const lo="9.19.1";function Is(cn,Bt={}){let Sn=cn;"object"!=typeof Bt&&(Bt={name:Bt});const Zn=Object.assign({name:rn,automaticDataCollectionEnabled:!1},Bt),ti=Zn.name;if("string"!=typeof ti||!ti)throw Un.create("bad-app-name",{appName:String(ti)});if(Sn||(Sn=(0,_.aH)()),!Sn)throw Un.create("no-options");const Oi=wn.get(ti);if(Oi){if((0,_.vZ)(Sn,Oi.options)&&(0,_.vZ)(Zn,Oi.config))return Oi;throw Un.create("duplicate-app",{appName:ti})}const eo=new Ne.H0(ti);for(const ne of Cn.values())eo.addComponent(ne);const ze=new kr(Sn,Zn,eo);return wn.set(ti,ze),ze}function co(cn=rn){const Bt=wn.get(cn);if(!Bt&&cn===rn)return Is();if(!Bt)throw Un.create("no-app",{appName:cn});return Bt}function Ss(){return Array.from(wn.values())}function gs(cn){return Sr.apply(this,arguments)}function Sr(){return(Sr=(0,u.Z)(function*(cn){const Bt=cn.name;wn.has(Bt)&&(wn.delete(Bt),yield Promise.all(cn.container.getProviders().map(Sn=>Sn.delete())),cn.isDeleted=!0)})).apply(this,arguments)}function $r(cn,Bt,Sn){var Zn;let ti=null!==(Zn=en[cn])&&void 0!==Zn?Zn:cn;Sn&&(ti+=`-${Sn}`);const Oi=ti.match(/\s|\//),eo=Bt.match(/\s|\//);if(Oi||eo){const ze=[`Unable to register library "${ti}" with version "${Bt}":`];return Oi&&ze.push(`library name "${ti}" contains illegal characters (whitespace or "/")`),Oi&&eo&&ze.push("and"),eo&&ze.push(`version name "${Bt}" contains illegal characters (whitespace or "/")`),void Ve.warn(ze.join(" "))}Bn(new Ne.wA(`${ti}-version`,()=>({library:ti,version:Bt}),"VERSION"))}function In(cn,Bt){if(null!==cn&&"function"!=typeof cn)throw Un.create("invalid-log-argument");(0,Se.Am)(cn,Bt)}function Uo(cn){(0,Se.Ub)(cn)}const ss="firebase-heartbeat-database",wo=1,Gr="firebase-heartbeat-store";let as=null;function hi(){return as||(as=(0,$e.X3)(ss,wo,{upgrade:(cn,Bt)=>{0===Bt&&cn.createObjectStore(Gr)}}).catch(cn=>{throw Un.create("idb-open",{originalErrorMessage:cn.message})})),as}function Xn(){return(Xn=(0,u.Z)(function*(cn){try{return(yield hi()).transaction(Gr).objectStore(Gr).get(Jr(cn))}catch(Bt){if(Bt instanceof _.ZR)Ve.warn(Bt.message);else{const Sn=Un.create("idb-get",{originalErrorMessage:Bt?.message});Ve.warn(Sn.message)}}})).apply(this,arguments)}function zr(cn,Bt){return Mr.apply(this,arguments)}function Mr(){return(Mr=(0,u.Z)(function*(cn,Bt){try{const Zn=(yield hi()).transaction(Gr,"readwrite");return yield Zn.objectStore(Gr).put(Bt,Jr(cn)),Zn.done}catch(Sn){if(Sn instanceof _.ZR)Ve.warn(Sn.message);else{const Zn=Un.create("idb-set",{originalErrorMessage:Sn?.message});Ve.warn(Zn.message)}}})).apply(this,arguments)}function Jr(cn){return`${cn.name}!${cn.options.appId}`}class _s{constructor(Bt){this.container=Bt,this._heartbeatsCache=null;const Sn=this.container.getProvider("app").getImmediate();this._storage=new Ei(Sn),this._heartbeatsCachePromise=this._storage.read().then(Zn=>(this._heartbeatsCache=Zn,Zn))}triggerHeartbeat(){var Bt=this;return(0,u.Z)(function*(){const Zn=Bt.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),ti=wi();if(null===Bt._heartbeatsCache&&(Bt._heartbeatsCache=yield Bt._heartbeatsCachePromise),Bt._heartbeatsCache.lastSentHeartbeatDate!==ti&&!Bt._heartbeatsCache.heartbeats.some(Oi=>Oi.date===ti))return Bt._heartbeatsCache.heartbeats.push({date:ti,agent:Zn}),Bt._heartbeatsCache.heartbeats=Bt._heartbeatsCache.heartbeats.filter(Oi=>{const eo=new Date(Oi.date).valueOf();return Date.now()-eo<=2592e6}),Bt._storage.overwrite(Bt._heartbeatsCache)})()}getHeartbeatsHeader(){var Bt=this;return(0,u.Z)(function*(){if(null===Bt._heartbeatsCache&&(yield Bt._heartbeatsCachePromise),null===Bt._heartbeatsCache||0===Bt._heartbeatsCache.heartbeats.length)return"";const Sn=wi(),{heartbeatsToSend:Zn,unsentEntries:ti}=function Bs(cn,Bt=1024){const Sn=[];let Zn=cn.slice();for(const ti of cn){const Oi=Sn.find(eo=>eo.agent===ti.agent);if(Oi){if(Oi.dates.push(ti.date),ho(Sn)>Bt){Oi.dates.pop();break}}else if(Sn.push({agent:ti.agent,dates:[ti.date]}),ho(Sn)>Bt){Sn.pop();break}Zn=Zn.slice(1)}return{heartbeatsToSend:Sn,unsentEntries:Zn}}(Bt._heartbeatsCache.heartbeats),Oi=(0,_.L)(JSON.stringify({version:2,heartbeats:Zn}));return Bt._heartbeatsCache.lastSentHeartbeatDate=Sn,ti.length>0?(Bt._heartbeatsCache.heartbeats=ti,yield Bt._storage.overwrite(Bt._heartbeatsCache)):(Bt._heartbeatsCache.heartbeats=[],Bt._storage.overwrite(Bt._heartbeatsCache)),Oi})()}}function wi(){return(new Date).toISOString().substring(0,10)}class Ei{constructor(Bt){this.app=Bt,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,u.Z)(function*(){return!!(0,_.hl)()&&(0,_.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Bt=this;return(0,u.Z)(function*(){return(yield Bt._canUseIndexedDBPromise)&&(yield function jn(cn){return Xn.apply(this,arguments)}(Bt.app))||{heartbeats:[]}})()}overwrite(Bt){var Sn=this;return(0,u.Z)(function*(){var Zn;if(yield Sn._canUseIndexedDBPromise){const Oi=yield Sn.read();return zr(Sn.app,{lastSentHeartbeatDate:null!==(Zn=Bt.lastSentHeartbeatDate)&&void 0!==Zn?Zn:Oi.lastSentHeartbeatDate,heartbeats:Bt.heartbeats})}})()}add(Bt){var Sn=this;return(0,u.Z)(function*(){var Zn;if(yield Sn._canUseIndexedDBPromise){const Oi=yield Sn.read();return zr(Sn.app,{lastSentHeartbeatDate:null!==(Zn=Bt.lastSentHeartbeatDate)&&void 0!==Zn?Zn:Oi.lastSentHeartbeatDate,heartbeats:[...Oi.heartbeats,...Bt.heartbeats]})}})()}}function ho(cn){return(0,_.L)(JSON.stringify({version:2,heartbeats:cn})).length}!function qr(cn){Bn(new Ne.wA("platform-logger",Bt=>new ft(Bt),"PRIVATE")),Bn(new Ne.wA("heartbeat",Bt=>new _s(Bt),"PRIVATE")),$r(yt,"0.9.7",cn),$r(yt,"0.9.7","esm2017"),$r("fire-js","")}("")},4859:(ui,Kt,De)=>{"use strict";De.d(Kt,{H0:()=>yt,wA:()=>Se});var u=De(5861),Ne=De(2090);class Se{constructor(Ve,je,Ke){this.name=Ve,this.instanceFactory=je,this.type=Ke,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(Ve){return this.instantiationMode=Ve,this}setMultipleInstances(Ve){return this.multipleInstances=Ve,this}setServiceProps(Ve){return this.serviceProps=Ve,this}setInstanceCreatedCallback(Ve){return this.onInstanceCreated=Ve,this}}const _="[DEFAULT]";class $e{constructor(Ve,je){this.name=Ve,this.container=je,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(Ve){const je=this.normalizeInstanceIdentifier(Ve);if(!this.instancesDeferred.has(je)){const Ke=new Ne.BH;if(this.instancesDeferred.set(je,Ke),this.isInitialized(je)||this.shouldAutoInitialize())try{const pn=this.getOrInitializeService({instanceIdentifier:je});pn&&Ke.resolve(pn)}catch{}}return this.instancesDeferred.get(je).promise}getImmediate(Ve){var je;const Ke=this.normalizeInstanceIdentifier(Ve?.identifier),pn=null!==(je=Ve?.optional)&&void 0!==je&&je;if(!this.isInitialized(Ke)&&!this.shouldAutoInitialize()){if(pn)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Ke})}catch(nn){if(pn)return null;throw nn}}getComponent(){return this.component}setComponent(Ve){if(Ve.name!==this.name)throw Error(`Mismatching Component ${Ve.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=Ve,this.shouldAutoInitialize()){if(function on(It){return"EAGER"===It.instantiationMode}(Ve))try{this.getOrInitializeService({instanceIdentifier:_})}catch{}for(const[je,Ke]of this.instancesDeferred.entries()){const pn=this.normalizeInstanceIdentifier(je);try{const nn=this.getOrInitializeService({instanceIdentifier:pn});Ke.resolve(nn)}catch{}}}}clearInstance(Ve=_){this.instancesDeferred.delete(Ve),this.instancesOptions.delete(Ve),this.instances.delete(Ve)}delete(){var Ve=this;return(0,u.Z)(function*(){const je=Array.from(Ve.instances.values());yield Promise.all([...je.filter(Ke=>"INTERNAL"in Ke).map(Ke=>Ke.INTERNAL.delete()),...je.filter(Ke=>"_delete"in Ke).map(Ke=>Ke._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(Ve=_){return this.instances.has(Ve)}getOptions(Ve=_){return this.instancesOptions.get(Ve)||{}}initialize(Ve={}){const{options:je={}}=Ve,Ke=this.normalizeInstanceIdentifier(Ve.instanceIdentifier);if(this.isInitialized(Ke))throw Error(`${this.name}(${Ke}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const pn=this.getOrInitializeService({instanceIdentifier:Ke,options:je});for(const[nn,bn]of this.instancesDeferred.entries())Ke===this.normalizeInstanceIdentifier(nn)&&bn.resolve(pn);return pn}onInit(Ve,je){var Ke;const pn=this.normalizeInstanceIdentifier(je),nn=null!==(Ke=this.onInitCallbacks.get(pn))&&void 0!==Ke?Ke:new Set;nn.add(Ve),this.onInitCallbacks.set(pn,nn);const bn=this.instances.get(pn);return bn&&Ve(bn,pn),()=>{nn.delete(Ve)}}invokeOnInitCallbacks(Ve,je){const Ke=this.onInitCallbacks.get(je);if(Ke)for(const pn of Ke)try{pn(Ve,je)}catch{}}getOrInitializeService({instanceIdentifier:Ve,options:je={}}){let Ke=this.instances.get(Ve);if(!Ke&&this.component&&(Ke=this.component.instanceFactory(this.container,{instanceIdentifier:(It=Ve,It===_?void 0:It),options:je}),this.instances.set(Ve,Ke),this.instancesOptions.set(Ve,je),this.invokeOnInitCallbacks(Ke,Ve),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,Ve,Ke)}catch{}var It;return Ke||null}normalizeInstanceIdentifier(Ve=_){return this.component?this.component.multipleInstances?Ve:_:Ve}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class yt{constructor(Ve){this.name=Ve,this.providers=new Map}addComponent(Ve){const je=this.getProvider(Ve.name);if(je.isComponentSet())throw new Error(`Component ${Ve.name} has already been registered with ${this.name}`);je.setComponent(Ve)}addOrOverwriteComponent(Ve){this.getProvider(Ve.name).isComponentSet()&&this.providers.delete(Ve.name),this.addComponent(Ve)}getProvider(Ve){if(this.providers.has(Ve))return this.providers.get(Ve);const je=new $e(Ve,this);return this.providers.set(Ve,je),je}getProviders(){return Array.from(this.providers.values())}}},1877:(ui,Kt,De)=>{"use strict";De.d(Kt,{Am:()=>It,Ub:()=>yt,Yd:()=>on,in:()=>Ne});const u=[];var Ne=(()=>{return(Ve=Ne||(Ne={}))[Ve.DEBUG=0]="DEBUG",Ve[Ve.VERBOSE=1]="VERBOSE",Ve[Ve.INFO=2]="INFO",Ve[Ve.WARN=3]="WARN",Ve[Ve.ERROR=4]="ERROR",Ve[Ve.SILENT=5]="SILENT",Ne;var Ve})();const Se={debug:Ne.DEBUG,verbose:Ne.VERBOSE,info:Ne.INFO,warn:Ne.WARN,error:Ne.ERROR,silent:Ne.SILENT},_=Ne.INFO,$e={[Ne.DEBUG]:"log",[Ne.VERBOSE]:"log",[Ne.INFO]:"info",[Ne.WARN]:"warn",[Ne.ERROR]:"error"},ft=(Ve,je,...Ke)=>{if(je<Ve.logLevel)return;const pn=(new Date).toISOString(),nn=$e[je];if(!nn)throw new Error(`Attempted to log a message with an invalid logType (value: ${je})`);console[nn](`[${pn}]  ${Ve.name}:`,...Ke)};class on{constructor(je){this.name=je,this._logLevel=_,this._logHandler=ft,this._userLogHandler=null,u.push(this)}get logLevel(){return this._logLevel}set logLevel(je){if(!(je in Ne))throw new TypeError(`Invalid value "${je}" assigned to \`logLevel\``);this._logLevel=je}setLogLevel(je){this._logLevel="string"==typeof je?Se[je]:je}get logHandler(){return this._logHandler}set logHandler(je){if("function"!=typeof je)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=je}get userLogHandler(){return this._userLogHandler}set userLogHandler(je){this._userLogHandler=je}debug(...je){this._userLogHandler&&this._userLogHandler(this,Ne.DEBUG,...je),this._logHandler(this,Ne.DEBUG,...je)}log(...je){this._userLogHandler&&this._userLogHandler(this,Ne.VERBOSE,...je),this._logHandler(this,Ne.VERBOSE,...je)}info(...je){this._userLogHandler&&this._userLogHandler(this,Ne.INFO,...je),this._logHandler(this,Ne.INFO,...je)}warn(...je){this._userLogHandler&&this._userLogHandler(this,Ne.WARN,...je),this._logHandler(this,Ne.WARN,...je)}error(...je){this._userLogHandler&&this._userLogHandler(this,Ne.ERROR,...je),this._logHandler(this,Ne.ERROR,...je)}}function yt(Ve){u.forEach(je=>{je.setLogLevel(Ve)})}function It(Ve,je){for(const Ke of u){let pn=null;je&&je.level&&(pn=Se[je.level]),Ke.userLogHandler=null===Ve?null:(nn,bn,...An)=>{const vt=An.map(Ye=>{if(null==Ye)return null;if("string"==typeof Ye)return Ye;if("number"==typeof Ye||"boolean"==typeof Ye)return Ye.toString();if(Ye instanceof Error)return Ye.message;try{return JSON.stringify(Ye)}catch{return null}}).filter(Ye=>Ye).join(" ");bn>=(pn??nn.logLevel)&&Ve({level:Ne[bn].toLowerCase(),message:vt,args:An,type:nn.name})}}}},9260:(ui,Kt,De)=>{"use strict";De.d(Kt,{Z:()=>u.Z});var u=De(3942);u.Z.registerVersion("firebase","9.19.1","app-compat")},9568:(ui,Kt,De)=>{"use strict";De.r(Kt);var u=De(5861),Ne=De(3942),Se=De(3432),_=De(2090),on=(De(9681),De(1877),De(4859));function yt(){return window}const It=2e3;function je(){return je=(0,u.Z)(function*($,H,Y){var ae;const{BuildInfo:pe}=yt();(0,Se.ar)(H.sessionId,"AuthEvent did not contain a session ID");const ke=yield function Ye($){return kt.apply(this,arguments)}(H.sessionId),Be={};return(0,Se.as)()?Be.ibi=pe.packageName:(0,Se.at)()?Be.apn=pe.packageName:(0,Se.au)($,"operation-not-supported-in-this-environment"),pe.displayName&&(Be.appDisplayName=pe.displayName),Be.sessionId=ke,(0,Se.av)($,Y,H.type,void 0,null!==(ae=H.eventId)&&void 0!==ae?ae:void 0,Be)}),je.apply(this,arguments)}function pn(){return(pn=(0,u.Z)(function*($){const{BuildInfo:H}=yt(),Y={};(0,Se.as)()?Y.iosBundleId=H.packageName:(0,Se.at)()?Y.androidPackageName=H.packageName:(0,Se.au)($,"operation-not-supported-in-this-environment"),yield(0,Se.aw)($,Y)})).apply(this,arguments)}function An(){return(An=(0,u.Z)(function*($,H,Y){const{cordova:ae}=yt();let pe=()=>{};try{yield new Promise((ke,Be)=>{let Pe=null;function He(){var _t;ke();const En=null===(_t=ae.plugins.browsertab)||void 0===_t?void 0:_t.close;"function"==typeof En&&En(),"function"==typeof Y?.close&&Y.close()}function rt(){Pe||(Pe=window.setTimeout(()=>{Be((0,Se.ay)($,"redirect-cancelled-by-user"))},It))}function $t(){"visible"===document?.visibilityState&&rt()}H.addPassiveListener(He),document.addEventListener("resume",rt,!1),(0,Se.at)()&&document.addEventListener("visibilitychange",$t,!1),pe=()=>{H.removePassiveListener(He),document.removeEventListener("resume",rt,!1),document.removeEventListener("visibilitychange",$t,!1),Pe&&window.clearTimeout(Pe)}})}finally{pe()}})).apply(this,arguments)}function kt(){return(kt=(0,u.Z)(function*($){const H=function Jt($){if((0,Se.ar)(/[0-9a-zA-Z]+/.test($),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode($);const H=new ArrayBuffer($.length),Y=new Uint8Array(H);for(let ae=0;ae<$.length;ae++)Y[ae]=$.charCodeAt(ae);return Y}($),Y=yield crypto.subtle.digest("SHA-256",H);return Array.from(new Uint8Array(Y)).map(pe=>pe.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}const Xt=20;class xt extends Se.aA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(H=>{this.resolveInialized=H})}addPassiveListener(H){this.passiveListeners.add(H)}removePassiveListener(H){this.passiveListeners.delete(H)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(H){return this.resolveInialized(),this.passiveListeners.forEach(Y=>Y(H)),super.onEvent(H)}initialized(){var H=this;return(0,u.Z)(function*(){yield H.initPromise})()}}function nt($){return pt.apply(this,arguments)}function pt(){return(pt=(0,u.Z)(function*($){const H=yield an()._get(si($));return H&&(yield an()._remove(si($))),H})).apply(this,arguments)}function zt(){const $=[],H="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let Y=0;Y<Xt;Y++){const ae=Math.floor(Math.random()*H.length);$.push(H.charAt(ae))}return $.join("")}function an(){return(0,Se.aB)(Se.b)}function si($){return(0,Se.aC)("authEvent",$.config.apiKey,$.name)}function gt($){if(!$?.includes("?"))return{};const[H,...Y]=$.split("?");return(0,_.zd)(Y.join("?"))}const rn=class Ht{constructor(){this._redirectPersistence=Se.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Se.aD,this._overrideRedirectResult=Se.aE}_initialize(H){var Y=this;return(0,u.Z)(function*(){const ae=H._key();let pe=Y.eventManagers.get(ae);return pe||(pe=new xt(H),Y.eventManagers.set(ae,pe),Y.attachCallbackListeners(H,pe)),pe})()}_openPopup(H){(0,Se.au)(H,"operation-not-supported-in-this-environment")}_openRedirect(H,Y,ae,pe){var ke=this;return(0,u.Z)(function*(){!function vt($){var H,Y,ae,pe,ke,Be,Pe,He,rt,$t;const _t=yt();(0,Se.az)("function"==typeof(null===(H=_t?.universalLinks)||void 0===H?void 0:H.subscribe),$,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,Se.az)(typeof(null===(Y=_t?.BuildInfo)||void 0===Y?void 0:Y.packageName)<"u",$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,Se.az)("function"==typeof(null===(ke=null===(pe=null===(ae=_t?.cordova)||void 0===ae?void 0:ae.plugins)||void 0===pe?void 0:pe.browsertab)||void 0===ke?void 0:ke.openUrl),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,Se.az)("function"==typeof(null===(He=null===(Pe=null===(Be=_t?.cordova)||void 0===Be?void 0:Be.plugins)||void 0===Pe?void 0:Pe.browsertab)||void 0===He?void 0:He.isAvailable),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,Se.az)("function"==typeof(null===($t=null===(rt=_t?.cordova)||void 0===rt?void 0:rt.InAppBrowser)||void 0===$t?void 0:$t.open),$,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(H);const Be=yield ke._initialize(H);yield Be.initialized(),Be.resetRedirect(),(0,Se.aF)(),yield ke._originValidation(H);const Pe=function Pt($,H,Y=null){return{type:H,eventId:Y,urlResponse:null,sessionId:zt(),postBody:null,tenantId:$.tenantId,error:(0,Se.ay)($,"no-auth-event")}}(H,ae,pe);yield function un($,H){return an()._set(si($),H)}(H,Pe);const He=yield function Ve($,H,Y){return je.apply(this,arguments)}(H,Pe,Y),rt=yield function nn($){const{cordova:H}=yt();return new Promise(Y=>{H.plugins.browsertab.isAvailable(ae=>{let pe=null;ae?H.plugins.browsertab.openUrl($):pe=H.InAppBrowser.open($,(0,Se.ax)()?"_blank":"_system","location=yes"),Y(pe)})})}(He);return function bn($,H,Y){return An.apply(this,arguments)}(H,Be,rt)})()}_isIframeWebStorageSupported(H,Y){throw new Error("Method not implemented.")}_originValidation(H){const Y=H._key();return this.originValidationPromises[Y]||(this.originValidationPromises[Y]=function Ke($){return pn.apply(this,arguments)}(H)),this.originValidationPromises[Y]}attachCallbackListeners(H,Y){const{universalLinks:ae,handleOpenURL:pe,BuildInfo:ke}=yt(),Be=setTimeout((0,u.Z)(function*(){yield nt(H),Y.onEvent(en())}),500),Pe=function(){var $t=(0,u.Z)(function*(_t){clearTimeout(Be);const En=yield nt(H);let Nn=null;En&&_t?.url&&(Nn=function Nt($,H){var Y,ae;const pe=function mt($){const H=gt($),Y=H.link?decodeURIComponent(H.link):void 0,ae=gt(Y).link,pe=H.deep_link_id?decodeURIComponent(H.deep_link_id):void 0;return gt(pe).link||pe||ae||Y||$}(H);if(pe.includes("/__/auth/callback")){const ke=gt(pe),Be=ke.firebaseError?function On($){try{return JSON.parse($)}catch{return null}}(decodeURIComponent(ke.firebaseError)):null,Pe=null===(ae=null===(Y=Be?.code)||void 0===Y?void 0:Y.split("auth/"))||void 0===ae?void 0:ae[1],He=Pe?(0,Se.ay)(Pe):null;return He?{type:$.type,eventId:$.eventId,tenantId:$.tenantId,error:He,urlResponse:null,sessionId:null,postBody:null}:{type:$.type,eventId:$.eventId,tenantId:$.tenantId,sessionId:$.sessionId,urlResponse:pe,postBody:null}}return null}(En,_t.url)),Y.onEvent(Nn||en())});return function(En){return $t.apply(this,arguments)}}();typeof ae<"u"&&"function"==typeof ae.subscribe&&ae.subscribe(null,Pe);const He=pe,rt=`${ke.packageName.toLowerCase()}://`;yt().handleOpenURL=function(){var $t=(0,u.Z)(function*(_t){if(_t.toLowerCase().startsWith(rt)&&Pe({url:_t}),"function"==typeof He)try{He(_t)}catch(En){console.error(En)}});return function(_t){return $t.apply(this,arguments)}}()}};function en(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,Se.ay)("no-auth-event")}}const qn=1e3;function Bn(){var $;return(null===($=self?.location)||void 0===$?void 0:$.protocol)||null}function Xi($=(0,_.z$)()){return!("file:"!==Bn()&&"ionic:"!==Bn()&&"capacitor:"!==Bn()||!$.toLowerCase().match(/iphone|ipad|ipod|android/))}function lo(){try{const $=self.localStorage,H=Se.aK();if($)return $.setItem(H,"1"),$.removeItem(H),!function kr($=(0,_.z$)()){return function dr(){return(0,_.w1)()&&11===document?.documentMode}()||function Un($=(0,_.z$)()){return/Edge\/\d+/.test($)}($)}()||(0,_.hl)()}catch{return Is()&&(0,_.hl)()}return!1}function Is(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function co(){return(function vn(){return"http:"===Bn()||"https:"===Bn()}()||(0,_.ru)()||Xi())&&!function Ai(){return(0,_.b$)()||(0,_.UG)()}()&&lo()&&!Is()}function Ss(){return Xi()&&typeof document<"u"}function Sr(){return(Sr=(0,u.Z)(function*(){return!!Ss()&&new Promise($=>{const H=setTimeout(()=>{$(!1)},qn);document.addEventListener("deviceready",()=>{clearTimeout(H),$(!0)})})})).apply(this,arguments)}const In={LOCAL:"local",NONE:"none",SESSION:"session"},Uo=Se.az,ss="persistence";function Gr($){return as.apply(this,arguments)}function as(){return(as=(0,u.Z)(function*($){yield $._initializationPromise;const H=jn(),Y=Se.aC(ss,$.config.apiKey,$.name);H&&H.setItem(Y,$._getPersistence())})).apply(this,arguments)}function jn(){var $;try{return(null===($=function $r(){return typeof window<"u"?window:null}())||void 0===$?void 0:$.sessionStorage)||null}catch{return null}}const Xn=Se.az;class zr{constructor(){this.browserResolver=Se.aB(Se.k),this.cordovaResolver=Se.aB(rn),this.underlyingResolver=null,this._redirectPersistence=Se.a,this._completeRedirectFn=Se.aD,this._overrideRedirectResult=Se.aE}_initialize(H){var Y=this;return(0,u.Z)(function*(){return yield Y.selectUnderlyingResolver(),Y.assertedUnderlyingResolver._initialize(H)})()}_openPopup(H,Y,ae,pe){var ke=this;return(0,u.Z)(function*(){return yield ke.selectUnderlyingResolver(),ke.assertedUnderlyingResolver._openPopup(H,Y,ae,pe)})()}_openRedirect(H,Y,ae,pe){var ke=this;return(0,u.Z)(function*(){return yield ke.selectUnderlyingResolver(),ke.assertedUnderlyingResolver._openRedirect(H,Y,ae,pe)})()}_isIframeWebStorageSupported(H,Y){this.assertedUnderlyingResolver._isIframeWebStorageSupported(H,Y)}_originValidation(H){return this.assertedUnderlyingResolver._originValidation(H)}get _shouldInitProactively(){return Ss()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Xn(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var H=this;return(0,u.Z)(function*(){if(H.underlyingResolver)return;const Y=yield function gs(){return Sr.apply(this,arguments)}();H.underlyingResolver=Y?H.cordovaResolver:H.browserResolver})()}}function Mr($){return $.unwrap()}function Oo($){return _s($)}function _s($){const{_tokenResponse:H}=$ instanceof _.ZR?$.customData:$;if(!H)return null;if(!($ instanceof _.ZR)&&"temporaryProof"in H&&"phoneNumber"in H)return Se.P.credentialFromResult($);const Y=H.providerId;if(!Y||Y===Se.p.PASSWORD)return null;let ae;switch(Y){case Se.p.GOOGLE:ae=Se.U;break;case Se.p.FACEBOOK:ae=Se.Q;break;case Se.p.GITHUB:ae=Se.V;break;case Se.p.TWITTER:ae=Se.Y;break;default:const{oauthIdToken:pe,oauthAccessToken:ke,oauthTokenSecret:Be,pendingToken:Pe,nonce:He}=H;return ke||Be||pe||Pe?Pe?Y.startsWith("saml.")?Se.aN._create(Y,Pe):Se.K._fromParams({providerId:Y,signInMethod:Y,pendingToken:Pe,idToken:pe,accessToken:ke}):new Se.W(Y).credential({idToken:pe,accessToken:ke,rawNonce:He}):null}return $ instanceof _.ZR?ae.credentialFromError($):ae.credentialFromResult($)}function wi($,H){return H.catch(Y=>{throw Y instanceof _.ZR&&function uo($,H){var Y;const ae=null===(Y=H.customData)||void 0===Y?void 0:Y._tokenResponse;if("auth/multi-factor-auth-required"===H?.code)H.resolver=new ho($,Se.ap($,H));else if(ae){const pe=_s(H),ke=H;pe&&(ke.credential=pe,ke.tenantId=ae.tenantId||void 0,ke.email=ae.email||void 0,ke.phoneNumber=ae.phoneNumber||void 0)}}($,Y),Y}).then(Y=>{const pe=Y.user;return{operationType:Y.operationType,credential:Oo(Y),additionalUserInfo:Se.an(Y),user:qr.getOrCreate(pe)}})}function Bs($,H){return Ei.apply(this,arguments)}function Ei(){return(Ei=(0,u.Z)(function*($,H){const Y=yield H;return{verificationId:Y.verificationId,confirm:ae=>wi($,Y.confirm(ae))}})).apply(this,arguments)}class ho{constructor(H,Y){this.resolver=Y,this.auth=function Jr($){return $.wrapped()}(H)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(H){return wi(Mr(this.auth),this.resolver.resolveSignIn(H))}}class qr{constructor(H){this._delegate=H,this.multiFactor=Se.aq(H)}static getOrCreate(H){return qr.USER_MAP.has(H)||qr.USER_MAP.set(H,new qr(H)),qr.USER_MAP.get(H)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(H){return this._delegate.getIdTokenResult(H)}getIdToken(H){return this._delegate.getIdToken(H)}linkAndRetrieveDataWithCredential(H){return this.linkWithCredential(H)}linkWithCredential(H){var Y=this;return(0,u.Z)(function*(){return wi(Y.auth,Se.$(Y._delegate,H))})()}linkWithPhoneNumber(H,Y){var ae=this;return(0,u.Z)(function*(){return Bs(ae.auth,Se.l(ae._delegate,H,Y))})()}linkWithPopup(H){var Y=this;return(0,u.Z)(function*(){return wi(Y.auth,Se.d(Y._delegate,H,zr))})()}linkWithRedirect(H){var Y=this;return(0,u.Z)(function*(){return yield Gr(Se.aG(Y.auth)),Se.g(Y._delegate,H,zr)})()}reauthenticateAndRetrieveDataWithCredential(H){return this.reauthenticateWithCredential(H)}reauthenticateWithCredential(H){var Y=this;return(0,u.Z)(function*(){return wi(Y.auth,Se.a0(Y._delegate,H))})()}reauthenticateWithPhoneNumber(H,Y){return Bs(this.auth,Se.r(this._delegate,H,Y))}reauthenticateWithPopup(H){return wi(this.auth,Se.e(this._delegate,H,zr))}reauthenticateWithRedirect(H){var Y=this;return(0,u.Z)(function*(){return yield Gr(Se.aG(Y.auth)),Se.h(Y._delegate,H,zr)})()}sendEmailVerification(H){return Se.ad(this._delegate,H)}unlink(H){var Y=this;return(0,u.Z)(function*(){return yield Se.am(Y._delegate,H),Y})()}updateEmail(H){return Se.ai(this._delegate,H)}updatePassword(H){return Se.aj(this._delegate,H)}updatePhoneNumber(H){return Se.u(this._delegate,H)}updateProfile(H){return Se.ah(this._delegate,H)}verifyBeforeUpdateEmail(H,Y){return Se.ae(this._delegate,H,Y)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}qr.USER_MAP=new WeakMap;const cn=Se.az;let Bt=(()=>{class ${constructor(Y,ae){if(this.app=Y,ae.isInitialized())return this._delegate=ae.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:pe}=Y.options;cn(pe,"invalid-api-key",{appName:Y.name}),cn(pe,"invalid-api-key",{appName:Y.name});const ke=typeof window<"u"?zr:void 0;this._delegate=ae.initialize({options:{persistence:Zn(pe,Y.name),popupRedirectResolver:ke}}),this._delegate._updateErrorMap(Se.C),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?qr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(Y){this._delegate.languageCode=Y}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(Y){this._delegate.tenantId=Y}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(Y,ae){Se.H(this._delegate,Y,ae)}applyActionCode(Y){return Se.a4(this._delegate,Y)}checkActionCode(Y){return Se.a5(this._delegate,Y)}confirmPasswordReset(Y,ae){return Se.a3(this._delegate,Y,ae)}createUserWithEmailAndPassword(Y,ae){var pe=this;return(0,u.Z)(function*(){return wi(pe._delegate,Se.a7(pe._delegate,Y,ae))})()}fetchProvidersForEmail(Y){return this.fetchSignInMethodsForEmail(Y)}fetchSignInMethodsForEmail(Y){return Se.ac(this._delegate,Y)}isSignInWithEmailLink(Y){return Se.aa(this._delegate,Y)}getRedirectResult(){var Y=this;return(0,u.Z)(function*(){cn(co(),Y._delegate,"operation-not-supported-in-this-environment");const ae=yield Se.j(Y._delegate,zr);return ae?wi(Y._delegate,Promise.resolve(ae)):{credential:null,user:null}})()}addFrameworkForLogging(Y){!function wn($,H){(0,Se.aG)($)._logFramework(H)}(this._delegate,Y)}onAuthStateChanged(Y,ae,pe){const{next:ke,error:Be,complete:Pe}=Sn(Y,ae,pe);return this._delegate.onAuthStateChanged(ke,Be,Pe)}onIdTokenChanged(Y,ae,pe){const{next:ke,error:Be,complete:Pe}=Sn(Y,ae,pe);return this._delegate.onIdTokenChanged(ke,Be,Pe)}sendSignInLinkToEmail(Y,ae){return Se.a9(this._delegate,Y,ae)}sendPasswordResetEmail(Y,ae){return Se.a2(this._delegate,Y,ae||void 0)}setPersistence(Y){var ae=this;return(0,u.Z)(function*(){let pe;switch(function wo($,H){Uo(Object.values(In).includes(H),$,"invalid-persistence-type"),(0,_.b$)()?Uo(H!==In.SESSION,$,"unsupported-persistence-type"):(0,_.UG)()?Uo(H===In.NONE,$,"unsupported-persistence-type"):Is()?Uo(H===In.NONE||H===In.LOCAL&&(0,_.hl)(),$,"unsupported-persistence-type"):Uo(H===In.NONE||lo(),$,"unsupported-persistence-type")}(ae._delegate,Y),Y){case In.SESSION:pe=Se.a;break;case In.LOCAL:pe=(yield Se.aB(Se.i)._isAvailable())?Se.i:Se.b;break;case In.NONE:pe=Se.M;break;default:return Se.au("argument-error",{appName:ae._delegate.name})}return ae._delegate.setPersistence(pe)})()}signInAndRetrieveDataWithCredential(Y){return this.signInWithCredential(Y)}signInAnonymously(){return wi(this._delegate,Se.Z(this._delegate))}signInWithCredential(Y){return wi(this._delegate,Se._(this._delegate,Y))}signInWithCustomToken(Y){return wi(this._delegate,Se.a1(this._delegate,Y))}signInWithEmailAndPassword(Y,ae){return wi(this._delegate,Se.a8(this._delegate,Y,ae))}signInWithEmailLink(Y,ae){return wi(this._delegate,Se.ab(this._delegate,Y,ae))}signInWithPhoneNumber(Y,ae){return Bs(this._delegate,Se.s(this._delegate,Y,ae))}signInWithPopup(Y){var ae=this;return(0,u.Z)(function*(){return cn(co(),ae._delegate,"operation-not-supported-in-this-environment"),wi(ae._delegate,Se.c(ae._delegate,Y,zr))})()}signInWithRedirect(Y){var ae=this;return(0,u.Z)(function*(){return cn(co(),ae._delegate,"operation-not-supported-in-this-environment"),yield Gr(ae._delegate),Se.f(ae._delegate,Y,zr)})()}updateCurrentUser(Y){return this._delegate.updateCurrentUser(Y)}verifyPasswordResetCode(Y){return Se.a6(this._delegate,Y)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return $.Persistence=In,$})();function Sn($,H,Y){let ae=$;"function"!=typeof $&&({next:ae,error:H,complete:Y}=$);const pe=ae;return{next:Be=>pe(Be&&qr.getOrCreate(Be)),error:H,complete:Y}}function Zn($,H){const Y=function hi($,H){const Y=jn();if(!Y)return[];const ae=Se.aC(ss,$,H);switch(Y.getItem(ae)){case In.NONE:return[Se.M];case In.LOCAL:return[Se.i,Se.a];case In.SESSION:return[Se.a];default:return[]}}($,H);if(typeof self<"u"&&!Y.includes(Se.i)&&Y.push(Se.i),typeof window<"u")for(const ae of[Se.b,Se.a])Y.includes(ae)||Y.push(ae);return Y.includes(Se.M)||Y.push(Se.M),Y}class ti{constructor(){this.providerId="phone",this._delegate=new Se.P(Mr(Ne.Z.auth()))}static credential(H,Y){return Se.P.credential(H,Y)}verifyPhoneNumber(H,Y){return this._delegate.verifyPhoneNumber(H,Y)}unwrap(){return this._delegate}}ti.PHONE_SIGN_IN_METHOD=Se.P.PHONE_SIGN_IN_METHOD,ti.PROVIDER_ID=Se.P.PROVIDER_ID;const Oi=Se.az;class eo{constructor(H,Y,ae=Ne.Z.app()){var pe;Oi(null===(pe=ae.options)||void 0===pe?void 0:pe.apiKey,"invalid-api-key",{appName:ae.name}),this._delegate=new Se.R(H,Y,ae.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function ne($){$.INTERNAL.registerComponent(new on.wA("auth-compat",H=>{const Y=H.getProvider("app-compat").getImmediate(),ae=H.getProvider("auth");return new Bt(Y,ae)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Se.A.EMAIL_SIGNIN,PASSWORD_RESET:Se.A.PASSWORD_RESET,RECOVER_EMAIL:Se.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Se.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Se.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Se.A.VERIFY_EMAIL}},EmailAuthProvider:Se.N,FacebookAuthProvider:Se.Q,GithubAuthProvider:Se.V,GoogleAuthProvider:Se.U,OAuthProvider:Se.W,SAMLAuthProvider:Se.X,PhoneAuthProvider:ti,PhoneMultiFactorGenerator:Se.m,RecaptchaVerifier:eo,TwitterAuthProvider:Se.Y,Auth:Bt,AuthCredential:Se.I,Error:_.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),$.registerVersion("@firebase/auth-compat","0.3.7")}(Ne.Z)},8766:(ui,Kt,De)=>{"use strict";De.d(Kt,{Lj:()=>Xt,X3:()=>Jt});var u=De(5861);const Ne=(pt,Nt)=>Nt.some(zt=>pt instanceof zt);let Se,_;const on=new WeakMap,yt=new WeakMap,It=new WeakMap,Ve=new WeakMap,je=new WeakMap;let nn={get(pt,Nt,zt){if(pt instanceof IDBTransaction){if("done"===Nt)return yt.get(pt);if("objectStoreNames"===Nt)return pt.objectStoreNames||It.get(pt);if("store"===Nt)return zt.objectStoreNames[1]?void 0:zt.objectStore(zt.objectStoreNames[0])}return Ye(pt[Nt])},set:(pt,Nt,zt)=>(pt[Nt]=zt,!0),has:(pt,Nt)=>pt instanceof IDBTransaction&&("done"===Nt||"store"===Nt)||Nt in pt};function vt(pt){return"function"==typeof pt?function An(pt){return pt!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ft(){return _||(_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(pt)?function(...Nt){return pt.apply(kt(this),Nt),Ye(on.get(this))}:function(...Nt){return Ye(pt.apply(kt(this),Nt))}:function(Nt,...zt){const an=pt.call(kt(this),Nt,...zt);return It.set(an,Nt.sort?Nt.sort():[Nt]),Ye(an)}}(pt):(pt instanceof IDBTransaction&&function pn(pt){if(yt.has(pt))return;const Nt=new Promise((zt,an)=>{const si=()=>{pt.removeEventListener("complete",On),pt.removeEventListener("error",mt),pt.removeEventListener("abort",mt)},On=()=>{zt(),si()},mt=()=>{an(pt.error||new DOMException("AbortError","AbortError")),si()};pt.addEventListener("complete",On),pt.addEventListener("error",mt),pt.addEventListener("abort",mt)});yt.set(pt,Nt)}(pt),Ne(pt,function $e(){return Se||(Se=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(pt,nn):pt)}function Ye(pt){if(pt instanceof IDBRequest)return function Ke(pt){const Nt=new Promise((zt,an)=>{const si=()=>{pt.removeEventListener("success",On),pt.removeEventListener("error",mt)},On=()=>{zt(Ye(pt.result)),si()},mt=()=>{an(pt.error),si()};pt.addEventListener("success",On),pt.addEventListener("error",mt)});return Nt.then(zt=>{zt instanceof IDBCursor&&on.set(zt,pt)}).catch(()=>{}),je.set(Nt,pt),Nt}(pt);if(Ve.has(pt))return Ve.get(pt);const Nt=vt(pt);return Nt!==pt&&(Ve.set(pt,Nt),je.set(Nt,pt)),Nt}const kt=pt=>je.get(pt);function Jt(pt,Nt,{blocked:zt,upgrade:an,blocking:si,terminated:On}={}){const mt=indexedDB.open(pt,Nt),gt=Ye(mt);return an&&mt.addEventListener("upgradeneeded",Dt=>{an(Ye(mt.result),Dt.oldVersion,Dt.newVersion,Ye(mt.transaction))}),zt&&mt.addEventListener("blocked",()=>zt()),gt.then(Dt=>{On&&Dt.addEventListener("close",()=>On()),si&&Dt.addEventListener("versionchange",()=>si())}).catch(()=>{}),gt}function Xt(pt,{blocked:Nt}={}){const zt=indexedDB.deleteDatabase(pt);return Nt&&zt.addEventListener("blocked",()=>Nt()),Ye(zt).then(()=>{})}const xt=["get","getKey","getAll","getAllKeys","count"],Pt=["put","add","delete","clear"],un=new Map;function nt(pt,Nt){if(!(pt instanceof IDBDatabase)||Nt in pt||"string"!=typeof Nt)return;if(un.get(Nt))return un.get(Nt);const zt=Nt.replace(/FromIndex$/,""),an=Nt!==zt,si=Pt.includes(zt);if(!(zt in(an?IDBIndex:IDBObjectStore).prototype)||!si&&!xt.includes(zt))return;const On=function(){var mt=(0,u.Z)(function*(gt,...Dt){const Ht=this.transaction(gt,si?"readwrite":"readonly");let rn=Ht.store;return an&&(rn=rn.index(Dt.shift())),(yield Promise.all([rn[zt](...Dt),si&&Ht.done]))[0]});return function(Dt){return mt.apply(this,arguments)}}();return un.set(Nt,On),On}!function bn(pt){nn=pt(nn)}(pt=>({...pt,get:(Nt,zt,an)=>nt(Nt,zt)||pt.get(Nt,zt,an),has:(Nt,zt)=>!!nt(Nt,zt)||pt.has(Nt,zt)}))},5861:(ui,Kt,De)=>{"use strict";function u(Se,_,$e,ft,on,yt,It){try{var Ve=Se[yt](It),je=Ve.value}catch(Ke){return void $e(Ke)}Ve.done?_(je):Promise.resolve(je).then(ft,on)}function Ne(Se){return function(){var _=this,$e=arguments;return new Promise(function(ft,on){var yt=Se.apply(_,$e);function It(je){u(yt,ft,on,It,Ve,"next",je)}function Ve(je){u(yt,ft,on,It,Ve,"throw",je)}It(void 0)})}}De.d(Kt,{Z:()=>Ne})}},ui=>{ui(ui.s=6696)}]);